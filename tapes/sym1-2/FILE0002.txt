./  ADD  SSI=40391476,NAME=IEAVEAC0
         TITLE 'IEAVEAC0 - ASCB DISPATCHING QUEUE CHAINER              *00001000
                        '                                               00002000
IEAVEAC0 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IEAVEAC0  74.039'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  DS    0H                                                  0002 00010000
*   STM(REG8,REG1,ACSAVEA);         /* SAVE REGISTERS 8-1 INCLUDING     00011000
*                                      EP                            */ 00012000
         STM   REG8,REG1,ACSAVEA(REG13)                            0060 00013000
*   RFY                                                            0061 00014000
*     REG0 UNRSTD;                                                 0061 00015000
*   REG9=CVTPTR;                    /* ADDRESS OF THE CVT            */ 00016000
         L     REG9,CVTPTR                                         0062 00017000
*   RFY                                                            0063 00018000
*     CVTMAP BASED(REG9);                                          0063 00019000
*                                                                  0063 00020000
*/* P  ESTABLISH BASE REGISTER                                       */ 00021000
*                                                                  0064 00022000
*   REG10=R15WORK;                  /* INITIALIZE BASE REGISTER AT 0064 00023000
*                                      EXECUTION TIME                */ 00024000
         LR    REG10,R15WORK                                       0064 00025000
*   GEN(USING IEAVEAC0,REG10);      /* SPECIFY BASE REGISTER         */ 00026000
         USING IEAVEAC0,REG10                                           00027000
*/* S LOCK: OBTAIN GLOBAL DISPATCHER LOCK                            */ 00028000
*                                                                  0066 00029000
*   CALL LOCK;                      /* UNCONDITIONALLY REQUEST LOCK  */ 00030000
         BAL   @14,LOCK                                            0066 00031000
*   REG8->FRR6LOCK=R15WORK;         /* SAVE SETLOCK RETURN CODE      */ 00032000
         STC   R15WORK,FRR6LOCK(,REG8)                             0067 00033000
*   ACLOCKRC=R15WORK;               /* SAVE SETLOCK RETURN CODE      */ 00034000
         STC   R15WORK,ACLOCKRC(,REG13)                            0068 00035000
*   RFY                                                            0069 00036000
*     R15WORK UNRSTD;                                              0069 00037000
*   RFY                                                            0070 00038000
*     REG8 UNRSTD;                                                 0070 00039000
*                                                                  0070 00040000
*/* P INITIALIZE RETURN CODE TO ZERO                                 */ 00041000
*                                                                  0071 00042000
*   ACRETCOD=RC0;                   /* SET CODE 0                  0071 00043000
*                                                                    */ 00044000
         MVI   ACRETCOD(REG13),X'00'                               0071 00045000
*                                                                  0072 00046000
*/* D (NO,%AC3,YES,) WAS MOVE OPTION SPECIFIED ?                     */ 00047000
*                                                                  0072 00048000
*   IF ACECODE=CODE0MOV THEN        /* WAS ENTRY CODE 0 SPECIFIED ?  */ 00049000
         CLI   ACECODE(REG13),0                                    0072 00050000
         BNE   @RF00072                                            0072 00051000
*     DO;                           /* MOVE OPTION                   */ 00052000
*                                                                  0073 00053000
*       /*************************************************************/ 00054000
*       /*                                                           */ 00055000
*       /* MOVE OPTION                                               */ 00056000
*       /*                                                           */ 00057000
*       /*************************************************************/ 00058000
*                                                                  0074 00059000
*AC000300:                                                         0074 00060000
*       DO;                         /* PROCESS ALL PARAMETER LIST  0074 00061000
*                                      ENTRIES                       */ 00062000
AC000300 DS    0H                                                  0075 00063000
*/* AC000300: D (YES,%AC8,NO,) IS GIVEN ASCB TOP ON QUEUE ?          */ 00064000
*                                                                  0075 00065000
*         R11PARM=MOVEASCB;         /* ADDRESS OF ASCB               */ 00066000
         L     R11PARM,MOVEASCB(,REG1)                             0075 00067000
*         IF R11PARMÂ¬=CVTASCBH THEN /* IF NOT TOP ASCB       @YM03475*/ 00068000
         L     @08,CVTASCBH(,REG9)                                 0076 00069000
         CR    R11PARM,@08                                         0076 00070000
         BE    @RF00076                                            0076 00071000
*           DO;                     /* CHAP THIS ASCB                */ 00072000
*/* S DEQUEUE:  DEQUEUE GIVEN ASCB                                   */ 00073000
*                                                                  0078 00074000
*             DO;                   /* INVOKE DEQUEUE                */ 00075000
*               R12SCAN=CVTASCBH;   /* START SCANNING FROM TOP OF  0079 00076000
*                                      QUEUE                         */ 00077000
         LR    R12SCAN,@08                                         0079 00078000
*               CALL DEQUEUE;       /* DEQUEUE ASCB                  */ 00079000
         BAL   @14,DEQUEUE                                         0080 00080000
*             END;                  /* DEQUEUE INVOKED               */ 00081000
*/* P SAVE OLD, SET NEW PRIORITY INTO THE DEQUEUED ASCB              */ 00082000
*                                                                  0082 00083000
*             RFY                                                  0082 00084000
*               REG0 RSTD;                                         0082 00085000
*             REG0=R11PARM->ASCBDP; /* SAVE                  @YM01849*/ 00086000
         SLR   REG0,REG0                                           0083 00087000
         IC    REG0,ASCBDP(,R11PARM)                               0083 00088000
*             R11PARM->ASCBDP=MOVEDP;/* PASS NEW DISPATCHING PRIORITY   00089000
*                                                            @YM01849*/ 00090000
         MVC   ASCBDP(1,R11PARM),MOVEDP+1(REG1)                    0084 00091000
*             RFY                                                  0085 00092000
*               R15WORK RSTD;                                      0085 00093000
*                                                                  0085 00094000
*/* D (YES,%AC7,NO,) WAS ASCB ON THE QUEUE ?                         */ 00095000
*                                                                  0086 00096000
*             IF R15WORK>ZERO THEN  /* IF ASCB NOT DEQUEUED THEN     */ 00097000
         LTR   R15WORK,R15WORK                                     0086 00098000
         BNP   @RF00086                                            0086 00099000
*               DO;                 /* NOTIFY INVOKER                */ 00100000
*                 RFY                                              0088 00101000
*                   R15WORK UNRSTD;                                0088 00102000
*                                                                  0088 00103000
*/* P (,%AC8) SET INDICATOR IN PARM LIST AND RETURN CODE 4           */ 00104000
*                                                                  0089 00105000
*                 MOVEOFF='1'B;     /* NOTE ASCB NOT FOUND OR ONLY 0089 00106000
*                                      ASCB ON QUEUE                 */ 00107000
         OI    MOVEOFF(REG1),B'01000000'                           0089 00108000
*                 ACRETCOD=RC4;     /* RETURN CODE                   */ 00109000
         MVI   ACRETCOD(REG13),X'04'                               0090 00110000
*                 RFY                                              0091 00111000
*                   R15WORK UNRSTD;                                0091 00112000
*               END;                /* INVOKER NOTIFIED              */ 00113000
*/* %AC7: S ENQUEUE:  ENQUEUE ASCB AT GIVEN PRIORITY                 */ 00114000
*                                                                  0093 00115000
*             ELSE                  /* IF ASCB SUCCESSFULLY DEQUEUED    00116000
*                                      THEN                          */ 00117000
*               DO;                 /* INVOKE ENQUEUE                */ 00118000
         B     @RC00086                                            0093 00119000
@RF00086 DS    0H                                                  0094 00120000
*                 IF(MOVEDP>REG0)|(R11PARM->ASCBBWDP=ZERO) THEN/* IF    00121000
*                                      ASCB GOES HIGHER ON THE QUEUE */ 00122000
         CH    REG0,MOVEDP(,REG1)                                  0094 00123000
         BL    @RT00094                                            0094 00124000
         ICM   @08,15,ASCBBWDP(R11PARM)                            0094 00125000
         BNZ   @RF00094                                            0094 00126000
@RT00094 DS    0H                                                  0095 00127000
*                   R12SCAN=CVTASCBH;/* START SCANNING FROM TOP OF 0095 00128000
*                                      QUEUE                         */ 00129000
         L     R12SCAN,CVTASCBH(,REG9)                             0095 00130000
*                 ELSE              /* IF ASCB GOES LOWER ON QUEUE 0096 00131000
*                                      THEN                          */ 00132000
*                   R12SCAN=R11PARM->ASCBBWDP;/* START SCANNING FROM    00133000
*                                      LAST ASCB POSITION            */ 00134000
         B     @RC00094                                            0096 00135000
@RF00094 L     R12SCAN,ASCBBWDP(,R11PARM)                          0096 00136000
*                 R11PARM=R11PARM;  /* PASS DEQUEUED ASCB            */ 00137000
@RC00094 DS    0H                                                  0098 00138000
*                 CALL ENQUEUE;     /* REENQUEUE ASCB                */ 00139000
         BAL   @14,ENQUEUE                                         0098 00140000
*               END;                /* ENQUEUE INVOKED               */ 00141000
*             RFY                                                  0100 00142000
*               REG0 UNRSTD;                                       0100 00143000
@RC00086 DS    0H                                                  0101 00144000
*           END;                    /* ASCB NOW CHAPPED              */ 00145000
*/* %AC8: D (NO,AC000300,YES,) ALL INPUT ASCB'S CHAPPED ?            */ 00146000
*                                                                  0102 00147000
*         IF MOVELAST='0'B THEN     /* IF LAST VECTOR ENTRY NOT YET     00148000
*                                      PROCESSED THEN                */ 00149000
@RF00076 TM    MOVELAST(REG1),B'10000000'                          0102 00150000
         BNZ   @RF00102                                            0102 00151000
*           DO;                                                    0103 00152000
*             REG1=ADDR(MOVENEXT);  /* INCREMENT PARAMETER VECTOR  0104 00153000
*                                      POINTER                       */ 00154000
         LA    @08,MOVENEXT(,REG1)                                 0104 00155000
         LR    REG1,@08                                            0104 00156000
*             GOTO AC000300;        /* REPEAT LOOP                   */ 00157000
         B     AC000300                                            0105 00158000
*           END;                                                   0106 00159000
*       END AC000300;               /* ALL PARAMETER VECTOR ENTRIES     00160000
*                                      PROCESSED                     */ 00161000
@RF00102 DS    0H                                                  0108 00162000
*/* S SEQUENCE:  REORDER ASCB SEQUENCE NUMBERS                       */ 00163000
*                                                                  0108 00164000
*       DO;                         /* INVOKE SEQUENCE               */ 00165000
*         RFY                                                      0109 00166000
*           R15WORK RSTD;                                          0109 00167000
*         R15WORK=TWO;              /* SEQUENCE NUMBER OF SECOND   0110 00168000
*                                      ELEMENT ON QUEUE      @YM03475*/ 00169000
         LA    R15WORK,2                                           0110 00170000
*         R12SCAN=CVTASCBH->ASCBFWDP;/* START SCANNING AT NEXT FROM     00171000
*                                      TOP OF QUEUE          @YM03475*/ 00172000
         L     @14,CVTASCBH(,REG9)                                 0111 00173000
         L     R12SCAN,ASCBFWDP(,@14)                              0111 00174000
*         CALL SEQUENCE;            /* REORDER ASCB SEQUENCE NUMBERS */ 00175000
         BAL   @14,SEQUENCE                                        0112 00176000
*         RFY                                                      0113 00177000
*           R15WORK UNRSTD;                                        0113 00178000
*       END;                        /* SEQUENCE INVOKED              */ 00179000
*/* P (,%AC6) SET MEMORY SWITCH CODE TO DISPATCH FROM TOP OF QUEUE   */ 00180000
*                                                                  0115 00181000
*       REG1=ZERO;                  /* PASS ENTRY CODE FOR RESET TO     00182000
*                                      TOP OF DISPATCHING QUEUE      */ 00183000
         SLR   REG1,REG1                                           0115 00184000
*     END;                          /* END MOVE                    0116 00185000
*                                                                    */ 00186000
*                                                                  0117 00187000
*   /*****************************************************************/ 00188000
*   /*                                                               */ 00189000
*   /* CHECK FOR ADD OR DELETE AT TOP OF QUEUE                       */ 00190000
*   /*                                                               */ 00191000
*   /*****************************************************************/ 00192000
*                                                                  0117 00193000
*/* %AC3: D (YES,AC000400,NO,) IS INPUT ASCB TOP ON QUEUE ?          */ 00194000
*                                                                  0117 00195000
*   ELSE                                                           0117 00196000
*     IF REG1=CVTASCBH THEN         /* IF TOP OF QUEUE       @YM03475*/ 00197000
         B     @RC00072                                            0117 00198000
@RF00072 L     @08,CVTASCBH(,REG9)                                 0117 00199000
         CR    REG1,@08                                            0117 00200000
         BE    @RT00117                                            0117 00201000
*       GOTO AC000400;              /* IGNORE REQUEST        @YM03475*/ 00202000
*/* D (NO,AC000100,YES,) WAS ADD OPTION SPECIFIED ?                  */ 00203000
*                                                                  0119 00204000
*     ELSE                          /* NOT MOVE OPTION               */ 00205000
*       IF ACECODE=CODE1ADD THEN    /* WAS ENTRY CODE 1 SPECIFIED ?  */ 00206000
         CLI   ACECODE(REG13),1                                    0119 00207000
         BNE   @RF00119                                            0119 00208000
*         DO;                       /* ADD OPTION                    */ 00209000
*                                                                  0120 00210000
*           /*********************************************************/ 00211000
*           /*                                                       */ 00212000
*           /* ADD OPTION                                            */ 00213000
*           /*                                                       */ 00214000
*           /*********************************************************/ 00215000
*                                                                  0121 00216000
*/* S ENQUEUE:  ENQUEUE ASCB AT GIVEN PRIORITY                       */ 00217000
*                                                                  0121 00218000
*           DO;                     /* INVOKE ENQUEUE                */ 00219000
*             R11PARM=REG1;         /* PASS ASCB ADDRESS             */ 00220000
         LR    R11PARM,REG1                                        0122 00221000
*             R12SCAN=CVTASCBH;     /* START SCANNING AT TOP OF QUEUE*/ 00222000
         LR    R12SCAN,@08                                         0123 00223000
*             CALL ENQUEUE;         /* ENQUEUE ASCB                  */ 00224000
         BAL   @14,ENQUEUE                                         0124 00225000
*           END;                    /* ENQUEUE INVOKED               */ 00226000
*/* S SEQUENCE:  REORDER ASCB SEQUENCE NUMBERS                       */ 00227000
*                                                                  0126 00228000
*           DO;                     /* INVOKE SEQUENCE               */ 00229000
*             RFY                                                  0127 00230000
*               R15WORK RSTD;                                      0127 00231000
*             R15WORK=REG1->ASCBBWDP->ASCBSEQN+ONE;/* FIRST NUMBER TO   00232000
*                                      BE ASSIGNED           @YM03475*/ 00233000
         L     @08,ASCBBWDP(,REG1)                                 0128 00234000
         LA    R15WORK,1                                           0128 00235000
         AH    R15WORK,ASCBSEQN(,@08)                              0128 00236000
*             R12SCAN=REG1;         /* START SCANNING AT THIS ASCB   */ 00237000
         LR    R12SCAN,REG1                                        0129 00238000
*             CALL SEQUENCE;        /* REORDER ASCB SEQUENCE NUMBERS */ 00239000
         BAL   @14,SEQUENCE                                        0130 00240000
*             RFY                                                  0131 00241000
*               R15WORK UNRSTD;                                    0131 00242000
*           END;                    /* SEQUENCE INVOKED              */ 00243000
*/* P (,%AC6) SET MEMORY SWITCH CODE TO RESET ASCB NEW               */ 00244000
*                                                                  0133 00245000
*           REG1=REG1;              /* PASS ASCB ADDRESS             */ 00246000
*         END;                      /* END ADD OPTION              0134 00247000
*                                                                    */ 00248000
*       ELSE                        /* ASSUME ENTRY CODE 2           */ 00249000
*         DO;                       /* DELETE OPTION                 */ 00250000
*                                                                  0135 00251000
         B     @RC00119                                            0135 00252000
@RF00119 DS    0H                                                  0136 00253000
*           /*********************************************************/ 00254000
*           /*                                                       */ 00255000
*           /* DELETE OPTION                                         */ 00256000
*           /*                                                       */ 00257000
*           /*********************************************************/ 00258000
*                                                                  0136 00259000
*/* AC000100: D (NO,AC000200,YES,) IS A TASK ACTIVE IN THE MEMORY ?  */ 00260000
*                                                                  0136 00261000
*AC000100:                          /*                       @YM02483*/ 00262000
*           IF REG1->ASCBCPUS<=ZERO THEN/* IF NO ACTIVE TASKS      0136 00263000
*                                                            @YM01849*/ 00264000
AC000100 SLR   @08,@08                                             0136 00265000
         C     @08,ASCBCPUS(,REG1)                                 0136 00266000
         BNL   @RT00136                                            0136 00267000
*             GOTO AC000200;        /* GO UNCHAIN ASCB       @YM01849*/ 00268000
*/* S UNLOCK: RELEASE GLOBAL DISP LOCK                               */ 00269000
*                                                                  0138 00270000
*           RFY                                                    0138 00271000
*             REG0 RSTD;                                           0138 00272000
*           REG0=LOCK0;             /* SPECIFY RELEASE GLOBAL      0139 00273000
*                                      DISPATCHER LOCK       @YM01849*/ 00274000
         LR    REG0,@08                                            0139 00275000
*           CALL UNLOCK;            /* RELEASE LOCK FOR SPIN @YM01849*/ 00276000
         BAL   @14,UNLOCK                                          0140 00277000
*           RFY                                                    0141 00278000
*             REG0 UNRSTD;                                         0141 00279000
*                                                                  0142 00280000
*           /*********************************************************/ 00281000
*           /*                                                       */ 00282000
*           /* CHECK IF ALTERNATE CPU RECOVERY (ACR) HAS BEEN        */ 00283000
*           /* ENTERED. IF SO, BRANCH TO ACR DISABLED TO ALLOW ACR   */ 00284000
*           /* PROCESSING TO COMPLETE. THIS IS REQUIRED, BECAUSE THIS*/ 00285000
*           /* ROUTINE RUNS IN SRB MODE WHILE SPINNING ON ASCBCPUS.  */ 00286000
*           /*                                                       */ 00287000
*           /*********************************************************/ 00288000
*                                                                  0142 00289000
*/* %AC1: D (NO,%AC2,YES,) HAS ACR BEEN ENTERED ?                    */ 00290000
*                                                                  0142 00291000
*           IF LCCAACR='1'B THEN    /* ACR IN PROCESS ?      @YM01849*/ 00292000
         L     @08,PSALCCAV                                        0142 00293000
         TM    LCCAACR(@08),B'10000000'                            0142 00294000
         BNO   @RF00142                                            0142 00295000
*             DO;                   /* CALL ACR              @YM01849*/ 00296000
*/* P DISABLE EXTERNAL AND I/O INTERRUPTS                            */ 00297000
*                                                                  0144 00298000
*               GEN(STNSM ACOMASK(REG13),DMASK);/* DISABLE   @YM01849*/ 00299000
         STNSM ACOMASK(REG13),DMASK                                     00300000
*               R15WORK=REG10;      /* SAVE BASE REGISTER    @YM01849*/ 00301000
         LR    R15WORK,REG10                                       0145 00302000
*/* L ACR: ALLOW ALTERNATE CPU RECOVERY TO COMPLETE                  */ 00303000
*                                                                  0146 00304000
*               REG10=PSALCCAV;     /* ADDRESS OF CURRENT LCCA     0146 00305000
*                                                            @YM01849*/ 00306000
         L     REG10,PSALCCAV                                      0146 00307000
*               GENERATE REFS(LCCA,LCCACPUS,WSAC,WSACACR,CVTMAP,   0147 00308000
*                   CVTBTERM);                                     0147 00309000
         CALLRTM TYPE=ACRLM,CCA=(REG10) INVOKE ACR             @YM01849 00310000
*               REG10=R15WORK;      /* RESTORE BASE REG      @YM01849*/ 00311000
         LR    REG10,R15WORK                                       0148 00312000
*/* P  RESET PSW MASK                                                */ 00313000
*                                                                  0149 00314000
*               R15WORK=ACOMASK;    /* ORIGINAL PSW MASK     @YM01849*/ 00315000
         SLR   R15WORK,R15WORK                                     0149 00316000
         IC    R15WORK,ACOMASK(,REG13)                             0149 00317000
*               GEN(EX    R15WORK,ACENABLE);/* ENABLE        @YM01849*/ 00318000
         EX    R15WORK,ACENABLE                                         00319000
*             END;                  /* END ACR CALL          @YM01849*/ 00320000
*                                                                  0151 00321000
*           /*********************************************************/ 00322000
*           /*                                                       */ 00323000
*           /* REOBTAIN DISP LOCK TO CHECK FOR ACTIVE TASK           */ 00324000
*           /*                                                       */ 00325000
*           /*********************************************************/ 00326000
*                                                                  0152 00327000
*/* %AC2: S (,AC000100) LOCK: OBTAIN GLOBAL DISP LOCK                */ 00328000
*                                                                  0152 00329000
*           RFY                                                    0152 00330000
*             REG8 RSTD;                                           0152 00331000
@RF00142 DS    0H                                                  0153 00332000
*           CALL LOCK;              /* REOBTAIN DISPATCHER LOCK    0153 00333000
*                                                            @YM01849*/ 00334000
         BAL   @14,LOCK                                            0153 00335000
*           REG8->FRR6LOCK=ACLOCKRC;/* RESET ORIGINAL SETLOCK RETURN    00336000
*                                      CODE                  @YM01849*/ 00337000
         MVC   FRR6LOCK(1,REG8),ACLOCKRC(REG13)                    0154 00338000
*           RFY                                                    0155 00339000
*             REG8 UNRSTD;                                         0155 00340000
*           GOTO AC000100;          /* CONTINUE WAIT LOOP    @YM01849   00341000
*                                                                    */ 00342000
         B     AC000100                                            0156 00343000
*                                                                  0157 00344000
*           /*********************************************************/ 00345000
*           /*                                                       */ 00346000
*           /* ALL TASKS IN THE ADDRESS SPACE STOPPED, UNCHAIN ASCB  */ 00347000
*           /*                                                       */ 00348000
*           /*********************************************************/ 00349000
*                                                                  0157 00350000
*/* AC000200: S DEQUEUE: UNCHAIN INPUT ASCB                          */ 00351000
*                                                                  0157 00352000
*AC000200:                          /*                       @YM02483*/ 00353000
*           DO;                     /* INVOKE DEQUEUE                */ 00354000
AC000200 DS    0H                                                  0158 00355000
*             R11PARM=REG1;         /* PASS ADDRESS OF ASCB TO     0158 00356000
*                                      DEQUEUE                       */ 00357000
         LR    R11PARM,REG1                                        0158 00358000
*             R12SCAN=CVTASCBH;     /* START SCANNING AT TOP OF QUEUE*/ 00359000
         L     R12SCAN,CVTASCBH(,REG9)                             0159 00360000
*             CALL DEQUEUE;         /* DEQUEUE ASCB                  */ 00361000
         BAL   @14,DEQUEUE                                         0160 00362000
*           END;                    /* DEQUEUE INVOKED               */ 00363000
*/* P  IF DEQUEUE FAILED THEN SET RETURN CODE                        */ 00364000
*                                                                  0162 00365000
*           IF R15WORK>ZERO THEN    /* IF ASCB NOT DEQUEUED THEN     */ 00366000
         LTR   R15WORK,R15WORK                                     0162 00367000
         BNP   @RF00162                                            0162 00368000
*             ACRETCOD=RC4;         /* RETURN ERROR CODE             */ 00369000
         MVI   ACRETCOD(REG13),X'04'                               0163 00370000
*/* P SET CODE TO DISPATCH FROM TOP OF QUEUE                         */ 00371000
*                                                                  0164 00372000
*           REG1=ZERO;              /* MEMORY SWITCH ENTRY CODE    0164 00373000
*                                                            @YM02483*/ 00374000
@RF00162 SLR   REG1,REG1                                           0164 00375000
*         END;                      /* END DELETE OPTION           0165 00376000
*                                                                    */ 00377000
*                                                                  0166 00378000
*   /*****************************************************************/ 00379000
*   /*                                                               */ 00380000
*   /* EXIT LINKAGE                                                  */ 00381000
*   /*                                                               */ 00382000
*   /*****************************************************************/ 00383000
*                                                                  0166 00384000
*/* %AC6: L IEAVEMS0: MEMORY SWITCH                                  */ 00385000
*                                                                  0166 00386000
*   CALL IEAVEMS0;                  /* CALL MEMORY SWITCH WITH CODE     00387000
*                                      AS SET IN REG1        @YM02483*/ 00388000
@RC00119 DS    0H                                                  0166 00389000
@RC00072 L     @15,@CV01750                                        0166 00390000
         BALR  @14,@15                                             0166 00391000
*/* AC000400: P SET UNLOCK ENTRY CODE TO SETLOCK RETURN CODE         */ 00392000
*                                                                  0167 00393000
*   RFY                                                            0167 00394000
*     REG0 RSTD;                                                   0167 00395000
*AC000400:                                                         0168 00396000
*   REG0=ACLOCKRC;                  /* DETERMINES WHETHER LOCK IS  0168 00397000
*                                      FREED                         */ 00398000
AC000400 SLR   REG0,REG0                                           0168 00399000
         IC    REG0,ACLOCKRC(,REG13)                               0168 00400000
*/* S UNLOCK: CANCEL FRR AND COND FREE LOCK                          */ 00401000
*                                                                  0169 00402000
*   CALL UNLOCK;                    /* INVOKE SUBROUTINE             */ 00403000
         BAL   @14,UNLOCK                                          0169 00404000
*/* P RESTORE REGS, SET RETURN CODE                                  */ 00405000
*                                                                  0170 00406000
*   RFY                                                            0170 00407000
*     REG8 RSTD;                                                   0170 00408000
*   RFY                                                            0171 00409000
*     REG14 RSTD;                                                  0171 00410000
*   ACSAVE13=REG13;                 /* SET SAVE AREA ADDRESS INTO  0172 00411000
*                                      SAVE AREA                     */ 00412000
         ST    REG13,ACSAVE13(,REG13)                              0172 00413000
*   LM(REG8,REG1,ACSAVEA);          /* RESTORE REGS 8 - 1            */ 00414000
         LM    REG8,REG1,ACSAVEA(REG13)                            0173 00415000
*   R15WORK=ACRETCOD;               /* RETURN CODE                   */ 00416000
         SLR   R15WORK,R15WORK                                     0174 00417000
         IC    R15WORK,ACRETCOD(,REG13)                            0174 00418000
*/* R () RETURN TO CALLER                                            */ 00419000
*                                                                  0175 00420000
*   GOTO REG14;                     /* RETURN                        */ 00421000
         BR    REG14                                               0175 00422000
*   RFY                                                            0176 00423000
*     REG0 UNRSTD;                                                 0176 00424000
*   RFY                                                            0177 00425000
*     REG8 UNRSTD;                                                 0177 00426000
*   RFY                                                            0178 00427000
*     REG14 UNRSTD;                                                0178 00428000
*   RFY                                                            0179 00429000
*     R15WORK UNRSTD;                                              0179 00430000
*                                                                  0179 00431000
*/* IEAVEAC0: END FLOWCHART                                          */ 00432000
*                                                                  0180 00433000
*                                                                  0180 00434000
*/* ENQUEUE: CHART                                                   */ 00435000
*/* FOOTING                                                        0180 00436000
*/* SUBROUTINE CHAINS ASCB ONTO DISPATCHING QUEUE                    */ 00437000
*                                                                  0180 00438000
*ENQUEUE:                                                          0180 00439000
*   PROC                            /* ENQUEUE ASCB TO QUEUE AT GIVEN   00440000
*                                      PRIORITY                      */ 00441000
*       OPTIONS(NOSAVEAREA,NOSAVE); /* REG14 ADDRESSES RETURN POINT  */ 00442000
@EL00001 DS    0H                                                  0180 00443000
@EF00001 DS    0H                                                  0180 00444000
@ER00001 BR    @14                                                 0180 00445000
@PB00001 DS    0H                                                  0180 00446000
ENQUEUE  DS    0H                                                  0181 00447000
*   RFY                                                            0181 00448000
*     REG14 RSTD;                   /* PRESERVE RETURN REGISTER      */ 00449000
*                                                                  0181 00450000
*   /*****************************************************************/ 00451000
*   /*                                                               */ 00452000
*   /* ENQUEUE SUBROUTINE. AT ENTRY AND EXIT R11PARM->ASCB FOR       */ 00453000
*   /* ENQUEUEING, AND R12SCAN->ASCB FROM WHICH DOWNWARD QUEUE SCAN  */ 00454000
*   /* STARTS. FOR EXAMPLE R12SCAN=CVTASCBH SCANS ENTIRE QUEUE.      */ 00455000
*   /* R12SCAN AND R15WORK CLOBBERED. THIS SUBROUTINE ASSUMES THAT   */ 00456000
*   /* THE INPUT ASCB IS NOT THE TOP ASCB ON THE QUEUE, AND THAT THE */ 00457000
*   /* TOP ASCB ALWAYS HAS DISPATCHING PRIORITY 255.                 */ 00458000
*   /*                                                               */ 00459000
*   /*****************************************************************/ 00460000
*                                                                  0182 00461000
*/* E  BEGIN ENQUEUE                                                 */ 00462000
*/* P  MARK ASCB ENQUEUED                                            */ 00463000
*                                                                  0182 00464000
*   R11PARM->ASCBNOQ='0'B;          /* MARK ASCB ENQUEUED            */ 00465000
         NI    ASCBNOQ(R11PARM),B'01111111'                        0182 00466000
*/* P  FIND QUEUE POSITION FOR ENQUEUEING                            */ 00467000
*                                                                  0183 00468000
*   DO WHILE(R12SCAN>ZERO           /* FIND END OF QUEUE             */ 00469000
*         &R12SCAN->ASCBDP>=R11PARM->ASCBDP);/* OR A LOWER PRIORITY     00470000
*                                      ASCB                  @YM01849*/ 00471000
         B     @DE00183                                            0183 00472000
@DL00183 DS    0H                                                  0184 00473000
*     R12SCAN=R12SCAN->ASCBFWDP;    /* SCAN ASCB QUEUE               */ 00474000
         L     R12SCAN,ASCBFWDP(,R12SCAN)                          0184 00475000
*   END;                            /* END OF QUEUE OR LOWER PRIORITY   00476000
*                                      ASCB FOUND                    */ 00477000
@DE00183 LTR   R12SCAN,R12SCAN                                     0185 00478000
         BNP   @DC00183                                            0185 00479000
         CLC   ASCBDP(1,R12SCAN),ASCBDP(R11PARM)                   0185 00480000
         BNL   @DL00183                                            0185 00481000
@DC00183 DS    0H                                                  0186 00482000
*/* P  ENQUEUE ASCB                                                  */ 00483000
*                                                                  0186 00484000
*   /*****************************************************************/ 00485000
*   /*                                                               */ 00486000
*   /* CHAIN TOP POINTERS TO NEXT HIGHER PRIORITY ASCB               */ 00487000
*   /*                                                               */ 00488000
*   /*****************************************************************/ 00489000
*                                                                  0186 00490000
*   DO;                             /* CHAIN PRECEEDING TO SUBJECT 0186 00491000
*                                      ASCB                          */ 00492000
*     DO;                           /* FIND NEXT HIGHER PRIORITY ASCB*/ 00493000
*       RFY                                                        0188 00494000
*         R15WORK RSTD;                                            0188 00495000
*       IF R12SCAN=ZERO THEN        /* IF ENQUEUEING TO BOTTOM OF  0189 00496000
*                                      QUEUE THEN                    */ 00497000
         LTR   R12SCAN,R12SCAN                                     0189 00498000
         BNZ   @RF00189                                            0189 00499000
*         DO;                       /* CHAIN BOTTOM POINTERS TO    0190 00500000
*                                      BOTTOM OF QUEUE               */ 00501000
*           R15WORK=CVTASCBL;       /* ENQUEUE AFTER LAST ASCB ON  0191 00502000
*                                      QUEUE                         */ 00503000
         L     R15WORK,CVTASCBL(,REG9)                             0191 00504000
*           CVTASCBL=R11PARM;       /* CHAIN BOTTOM BACKWARD POINTER */ 00505000
         ST    R11PARM,CVTASCBL(,REG9)                             0192 00506000
*         END;                      /* BOTTOM POINTERS CHAINED TO  0193 00507000
*                                      BOTTOM OF QUEUE               */ 00508000
*       ELSE                        /* IF NOT ENQUEUEING TO BOTTOM OF   00509000
*                                      QUEUE THEN                    */ 00510000
*         DO;                       /* CHAIN BOTTOM POINTERS TO NEXT    00511000
*                                      LOWER PRIORITY ASCB           */ 00512000
         B     @RC00189                                            0194 00513000
@RF00189 DS    0H                                                  0195 00514000
*           R15WORK=R12SCAN->ASCBBWDP;/* ENQUEUE AFTER LAST ASCB   0195 00515000
*                                      SCANNED                       */ 00516000
         L     R15WORK,ASCBBWDP(,R12SCAN)                          0195 00517000
*           R12SCAN->ASCBBWDP=R11PARM;/* CHAIN BOTTOM BACKWARD     0196 00518000
*                                      POINTER                       */ 00519000
         ST    R11PARM,ASCBBWDP(,R12SCAN)                          0196 00520000
*         END;                      /* BOTTOM POINTERS CHAINED TO  0197 00521000
*                                      NEXT LOWER PRIORITY ASCB      */ 00522000
*     END;                          /* NEXT HIGHER PRIORITY ASCB   0198 00523000
*                                      FOUND                         */ 00524000
*                                                                  0198 00525000
@RC00189 DS    0H                                                  0199 00526000
*     /***************************************************************/ 00527000
*     /*                                                             */ 00528000
*     /* CHAIN TOP POINTERS TO NEXT HIGHER PRIORITY ASCB             */ 00529000
*     /*                                                             */ 00530000
*     /***************************************************************/ 00531000
*                                                                  0199 00532000
*     R15WORK->ASCBFWDP=R11PARM;    /* CHAIN TOP FOREWARD POINTER    */ 00533000
         ST    R11PARM,ASCBFWDP(,R15WORK)                          0199 00534000
*     R11PARM->ASCBBWDP=R15WORK;    /* CHAIN TOP BACKWARD POINTER    */ 00535000
*                                                                  0200 00536000
         ST    R15WORK,ASCBBWDP(,R11PARM)                          0200 00537000
*     /***************************************************************/ 00538000
*     /*                                                             */ 00539000
*     /* CHAIN BOTTOM POINTER                                        */ 00540000
*     /*                                                             */ 00541000
*     /***************************************************************/ 00542000
*                                                                  0201 00543000
*     R11PARM->ASCBFWDP=R12SCAN;    /* CHAIN BOTTOM FORWARD POINTER  */ 00544000
         ST    R12SCAN,ASCBFWDP(,R11PARM)                          0201 00545000
*   END;                            /* SUBJECT CHAINED TO PRECEEDING    00546000
*                                      ASCB                          */ 00547000
*/* R () END ENQUEUE                                                 */ 00548000
*                                                                  0203 00549000
*   RFY                                                            0203 00550000
*     REG14 UNRSTD;                 /* RELEASE RETURN REGISTER       */ 00551000
*   RFY                                                            0204 00552000
*     R15WORK UNRSTD;                                              0204 00553000
*   END ENQUEUE;                    /* ASCB ENQUEUED TO QUEUE AT   0205 00554000
*                                      GIVEN PRIORITY                */ 00555000
@EL00002 DS    0H                                                  0205 00556000
@EF00002 DS    0H                                                  0205 00557000
@ER00002 BR    @14                                                 0205 00558000
*/* ENQUEUE: END FLOWCHART                                           */ 00559000
*                                                                  0206 00560000
*                                                                  0206 00561000
*/* DEQUEUE: CHART                                                   */ 00562000
*/* FOOTING                                                        0206 00563000
*/* SUBROUTINE UNCHAINS ASCB FROM THE DISPATCHING QUEUE              */ 00564000
*                                                                  0206 00565000
*DEQUEUE:                                                          0206 00566000
*   PROC                            /* DEQUEUE GIVEN ASCB FROM QUEUE */ 00567000
*       OPTIONS(NOSAVEAREA,NOSAVE); /* REG14 ADDRESSES RETURN POINT  */ 00568000
DEQUEUE  DS    0H                                                  0207 00569000
*   RFY                                                            0207 00570000
*     REG14 RSTD;                   /* PRESERVE RETURN REGISTER      */ 00571000
*                                                                  0207 00572000
*   /*****************************************************************/ 00573000
*   /*                                                               */ 00574000
*   /* DEQUEUE SUBROUTINE. AT ENTRY AND EXIT R11PARM->ASCB GIVEN FOR */ 00575000
*   /* DELETION, AND R12SCAN->ASCB FROM WHICH DOWNWARD QUEUE SCANNING*/ 00576000
*   /* STARTS. FOR EXAMPLE R12SCAN=CVTASCBH SCANS ENTIRE QUEUE.      */ 00577000
*   /* R12SCAN CLOBBERED AND R15WORK SET TO RETURN CODE. THIS        */ 00578000
*   /* SUBROUTINE ASSUMES THAT THE INPUT ASCB IS NOT THE TOP ASCB ON */ 00579000
*   /* THE QUEUE.                                                    */ 00580000
*   /*                                                               */ 00581000
*   /*****************************************************************/ 00582000
*                                                                  0208 00583000
*/* E  BEGIN DEQUEUE                                                 */ 00584000
*/* P  MARK ASCB DEQUEUED                                            */ 00585000
*                                                                  0208 00586000
*   R11PARM->ASCBNOQ='1'B;          /* MARK ASCB DEQUEUED            */ 00587000
         OI    ASCBNOQ(R11PARM),B'10000000'                        0208 00588000
*/* P  FIND GIVEN ASCB OR BOTTOM OF QUEUE                            */ 00589000
*                                                                  0209 00590000
*   DO WHILE(R12SCAN>ZERO           /* UNTIL BOTTOM OF QUEUE REACHED */ 00591000
*         &R12SCANÂ¬=R11PARM);       /* OR GIVEN ASCB FOUND           */ 00592000
         B     @DE00209                                            0209 00593000
@DL00209 DS    0H                                                  0210 00594000
*     R12SCAN=R12SCAN->ASCBFWDP;    /* SCAN ASCB QUEUE               */ 00595000
         L     R12SCAN,ASCBFWDP(,R12SCAN)                          0210 00596000
*   END;                            /* GIVEN ASCB FOUND OR END OF  0211 00597000
*                                      QUEUE REACHED                 */ 00598000
@DE00209 LTR   R12SCAN,R12SCAN                                     0211 00599000
         BNP   @DC00209                                            0211 00600000
         CR    R12SCAN,R11PARM                                     0211 00601000
         BNE   @DL00209                                            0211 00602000
@DC00209 DS    0H                                                  0212 00603000
*/* P  SET RETURN CODE DEPENDING UPON RESULT OF SEARCH               */ 00604000
*                                                                  0212 00605000
*   RFY                                                            0212 00606000
*     R15WORK RSTD;                                                0212 00607000
*   IF R12SCAN=ZERO THEN            /* IF QUEUE DOES NOT CONTAIN   0213 00608000
*                                      GIVEN ASCB THEN               */ 00609000
         LTR   R12SCAN,R12SCAN                                     0213 00610000
         BNZ   @RF00213                                            0213 00611000
*     R15WORK=RC4;                  /* NOTIFY INVOKER                */ 00612000
         LA    R15WORK,4                                           0214 00613000
*   ELSE                            /* IF NOTHING UNTOWARD HAPPENED     00614000
*                                      THEN                          */ 00615000
*     DO;                           /* ACCEPT REQUEST                */ 00616000
         B     @RC00213                                            0215 00617000
@RF00213 DS    0H                                                  0216 00618000
*       R15WORK=RC0;                /* RETURN CODE FOR DEQUEUE     0216 00619000
*                                      PERFORMED                     */ 00620000
         SLR   R15WORK,R15WORK                                     0216 00621000
*/* P  DEQUEUE ASCB IF OK                                            */ 00622000
*                                                                  0217 00623000
*       /*************************************************************/ 00624000
*       /*                                                           */ 00625000
*       /* RECHAIN TOP POINTER                                       */ 00626000
*       /*                                                           */ 00627000
*       /*************************************************************/ 00628000
*                                                                  0217 00629000
*       R12SCAN->ASCBBWDP->ASCBFWDP=R12SCAN->ASCBFWDP;/* CHAIN TOP 0217 00630000
*                                      POINTER SO                    */ 00631000
*                                                                  0217 00632000
         L     @08,ASCBBWDP(,R12SCAN)                              0217 00633000
         MVC   ASCBFWDP(4,@08),ASCBFWDP(R12SCAN)                   0217 00634000
*       /*************************************************************/ 00635000
*       /*                                                           */ 00636000
*       /* RECHAIN BOTTOM POINTER                                    */ 00637000
*       /*                                                           */ 00638000
*       /*************************************************************/ 00639000
*                                                                  0218 00640000
*       IF R12SCAN=CVTASCBL THEN    /* IF DEQUEUEING FROM BOTTOM OF     00641000
*                                      QUEUE THEN                    */ 00642000
         C     R12SCAN,CVTASCBL(,REG9)                             0218 00643000
         BNE   @RF00218                                            0218 00644000
*         CVTASCBL=R12SCAN->ASCBBWDP;/* CHAIN BOTTOM POINTER THUS    */ 00645000
         ST    @08,CVTASCBL(,REG9)                                 0219 00646000
*       ELSE                        /* IF NOT DEQUEUEING FROM BOTTOM    00647000
*                                      OF QUEUE THEN                 */ 00648000
*         R12SCAN->ASCBFWDP->ASCBBWDP=R12SCAN->ASCBBWDP;/* CHAIN   0220 00649000
*                                      BOTTOM POINTER SO             */ 00650000
         B     @RC00218                                            0220 00651000
@RF00218 L     @08,ASCBFWDP(,R12SCAN)                              0220 00652000
         MVC   ASCBBWDP(4,@08),ASCBBWDP(R12SCAN)                   0220 00653000
*     END;                                                         0221 00654000
*                                                                  0221 00655000
*/* R () END DEQUEUE                                                 */ 00656000
*                                                                  0222 00657000
*   RFY                                                            0222 00658000
*     REG14 UNRSTD;                 /* RELEASE RETURN REGISTER       */ 00659000
*   RFY                                                            0223 00660000
*     R15WORK UNRSTD;                                              0223 00661000
*   END DEQUEUE;                    /* GIVEN ASCB DEQUEUED FROM QUEUE*/ 00662000
@EL00003 DS    0H                                                  0224 00663000
@EF00003 DS    0H                                                  0224 00664000
@ER00003 BR    @14                                                 0224 00665000
*   RFY                                                            0225 00666000
*     R15WORK UNRSTD;                                              0225 00667000
*                                                                  0225 00668000
*/* DEQUEUE: END FLOWCHART                                           */ 00669000
*                                                                  0226 00670000
*                                                                  0226 00671000
*/* SEQUENCE: CHART                                                  */ 00672000
*/* FOOTING                                                        0226 00673000
*/* SUBROUTINE RENUMBERS THE ASCB SEQUENCING                         */ 00674000
*                                                                  0226 00675000
*SEQUENCE:                                                         0226 00676000
*   PROC                            /* REORDER THE ASCB QUEUE      0226 00677000
*                                      PRIORITY SEQUENCE NUMBERS     */ 00678000
*       OPTIONS(NOSAVEAREA,NOSAVE); /* REG14 ADDRESSES RETURN POINT  */ 00679000
SEQUENCE DS    0H                                                  0227 00680000
*   RFY                                                            0227 00681000
*     REG14 RSTD;                   /* PRESERVE RETURN REGISTER      */ 00682000
*   RFY                                                            0228 00683000
*     R15WORK RSTD;                                                0228 00684000
*                                                                  0228 00685000
*   /*****************************************************************/ 00686000
*   /*                                                               */ 00687000
*   /* SEQUENCE SUBROUTINE. AT ENTRY R12SCAN->ASCB FOR START OF      */ 00688000
*   /* DOWNWARD SCAN -- FOR EXAMPLE R12SCAN=CVTASCBH SCANS ENTIRE    */ 00689000
*   /* QUEUE. R15WORK ON ENTRY CONTAINS THE FIRST SEQUENCE NUMBER TO */ 00690000
*   /* BE ASSIGNED. R12SCAN AND R15WORK CLOBBERED.                   */ 00691000
*   /*                                                               */ 00692000
*   /*****************************************************************/ 00693000
*                                                                  0229 00694000
*/* E  BEGIN SEQUENCE                                                */ 00695000
*/* P  PLACE SEQUENCE NUMBERS IN REMAINDER OF QUEUE                  */ 00696000
*                                                                  0229 00697000
*   DO WHILE(R12SCAN>ZERO);         /* UNTIL END OF QUEUE REACHED    */ 00698000
         B     @DE00229                                            0229 00699000
@DL00229 DS    0H                                                  0230 00700000
*     R12SCAN->ASCBSEQN=R15WORK;    /* NUMBER THIS ASCB              */ 00701000
         STH   R15WORK,ASCBSEQN(,R12SCAN)                          0230 00702000
*     R12SCAN=R12SCAN->ASCBFWDP;    /* FIND NEXT ASCB                */ 00703000
         L     R12SCAN,ASCBFWDP(,R12SCAN)                          0231 00704000
*     R15WORK=R15WORK+ONE;          /* FIND NEXT ORDINAL             */ 00705000
         AH    R15WORK,@CH00088                                    0232 00706000
*   END;                            /* ENTIRE QUEUE RENUMBERED       */ 00707000
@DE00229 LTR   R12SCAN,R12SCAN                                     0233 00708000
         BP    @DL00229                                            0233 00709000
*/* R () END SEQUENCE                                                */ 00710000
*                                                                  0234 00711000
*   RFY                                                            0234 00712000
*     REG14 UNRSTD;                 /* RELEASE RETURN REGISTER       */ 00713000
*   RFY                                                            0235 00714000
*     R15WORK UNRSTD;                                              0235 00715000
*   END SEQUENCE;                   /* ASCB QUEUE PRIORITY SEQUENCE     00716000
*                                      NUMBERS REORDERED             */ 00717000
@EL00004 DS    0H                                                  0236 00718000
@EF00004 DS    0H                                                  0236 00719000
@ER00004 BR    @14                                                 0236 00720000
*/* SEQUENCE: END FLOWCHART                                          */ 00721000
*                                                                  0237 00722000
*                                                                  0237 00723000
*/* LOCK: CHART                                                      */ 00724000
*/* FOOTING                                                        0237 00725000
*/* SUBROUTINE OBTAINS THE GLOBAL DISPATCHER LOCK                    */ 00726000
*                                                                  0237 00727000
*LOCK:                                                             0237 00728000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0237 00729000
*                                                                  0237 00730000
LOCK     DS    0H                                                  0238 00731000
*   /*****************************************************************/ 00732000
*   /*                                                               */ 00733000
*   /* REG8 SET TO ADDRESS OF FRR 6-WORD WORK AREA. R15WORK SET TO   */ 00734000
*   /* SETLOCK RETURN CODE. REG0, R11PARM, R12SCAN ALTERED.          */ 00735000
*   /*                                                               */ 00736000
*   /*****************************************************************/ 00737000
*                                                                  0238 00738000
*/* E ENTER LOCK                                                     */ 00739000
*                                                                  0238 00740000
*   RFY                                                            0238 00741000
*     REG0 RSTD;                                                   0238 00742000
*   RFY                                                            0239 00743000
*     REG14 RSTD;                                                  0239 00744000
*   REG0=REG14;                     /* SAVE RETURN ADDRESS           */ 00745000
         LR    REG0,REG14                                          0240 00746000
*/* L SETLOCK: OBTAIN DISPATCHER LOCK                                */ 00747000
*                                                                  0241 00748000
*   RFY                                                            0241 00749000
*     REG8 RSTD;                    /* RESTRICT FROM COMPILER        */ 00750000
*   REG8=REG13;                     /* SAVE SAVEAREA ADDRESS @YM00864*/ 00751000
         LR    REG8,REG13                                          0242 00752000
*   GEN REFS(PSALITA) SETS(R11PARM,R12SCAN,REG13,REG14);           0243 00753000
*                                                                  0243 00754000
  SETLOCK OBTAIN,TYPE=DISP,MODE=UNCOND,RELATED=(DISP,IEAVEAC0,UNLOCK)   00755000
*/* P  SAVE RETURN CODE                                              */ 00756000
*                                                                  0244 00757000
*   RFY                                                            0244 00758000
*     R15WORK RSTD;                                                0244 00759000
*   R15WORK=REG13;                  /* SAVE RETURN CODE              */ 00760000
         LR    R15WORK,REG13                                       0245 00761000
*   REG13=REG8;                     /* RESTORE SAVEAREA ADDRESS    0246 00762000
*                                                            @YM00864*/ 00763000
         LR    REG13,REG8                                          0246 00764000
*/* L SETFRR:  ADD FRR                                               */ 00765000
*                                                                  0247 00766000
*   REG14=ADDR(IEAVEAC3);           /* PASS ADDRESS OF FRR    @Y02753*/ 00767000
         LA    REG14,IEAVEAC3                                      0247 00768000
*   GENERATE;                                                      0248 00769000
         SETFRR A,FRRAD=(REG14),PARMAD=(REG8),                         *00770000
               WRKREGS=(R12SCAN,REG8)                           @Y02753 00771000
*   ACFRR6AD=REG8;                  /* SAVE ADDRESS OF FRR6WORD    0249 00772000
*                                                             @Y02753*/ 00773000
         ST    REG8,ACFRR6AD(,REG13)                               0249 00774000
*   RFY                                                            0250 00775000
*     R15WORK UNRSTD;                                              0250 00776000
*   RFY                                                            0251 00777000
*     REG8 UNRSTD;                                                 0251 00778000
*   REG14=REG0;                     /* RESTORE RETURN ADDRESS        */ 00779000
         LR    REG14,REG0                                          0252 00780000
*   RFY                                                            0253 00781000
*     REG0 UNRSTD;                                                 0253 00782000
*   RFY                                                            0254 00783000
*     REG14 UNRSTD;                                                0254 00784000
*                                                                  0254 00785000
*/* R () RETURN                                                      */ 00786000
*                                                                  0255 00787000
*   END LOCK;                       /* END SUBROUTINE                */ 00788000
@EL00005 DS    0H                                                  0255 00789000
@EF00005 DS    0H                                                  0255 00790000
@ER00005 BR    @14                                                 0255 00791000
*/* LOCK: END FLOWCHART                                              */ 00792000
*                                                                  0256 00793000
*                                                                  0256 00794000
*/* UNLOCK: CHART                                                    */ 00795000
*/* FOOTING                                                        0256 00796000
*/* SUBROUTINE RELEASES GLOBAL DISP LOCK                             */ 00797000
*                                                                  0256 00798000
*UNLOCK:                                                           0256 00799000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0256 00800000
*                                                                  0256 00801000
UNLOCK   DS    0H                                                  0257 00802000
*   /*****************************************************************/ 00803000
*   /*                                                               */ 00804000
*   /* INPUT: REG0 CONTAINS ENTRY CODE, 0 - FREE THE GLOBAL          */ 00805000
*   /* DISPATCHER LOCK. 4 - DO NOT FREE LOCK. REG0, R11PARM, R12SCAN,*/ 00806000
*   /* REG8 ALTERED.                                                 */ 00807000
*   /*                                                               */ 00808000
*   /*****************************************************************/ 00809000
*                                                                  0257 00810000
*/* E ENTER UNLOCK                                                   */ 00811000
*                                                                  0257 00812000
*   RFY                                                            0257 00813000
*     REG0 RSTD;                                                   0257 00814000
*   RFY                                                            0258 00815000
*     REG14 RSTD;                                                  0258 00816000
*                                                                  0258 00817000
*/* L SETFRR:  DELETE FRR                                            */ 00818000
*                                                                  0259 00819000
*   GENERATE;                                                      0259 00820000
*                                                                  0259 00821000
        SETFRR D,WRKREGS=(R12SCAN,R15WORK)                      @Y02753 00822000
*/* D (NO,%AC5,YES,) IS LOCK TO BE FREED ?                           */ 00823000
*                                                                  0260 00824000
*   IF REG0Â¬=LOCK4 THEN             /* SETLOCK RET CODE 4 IS LOCK  0260 00825000
*                                      HELD ON ENTRY TO ASCBCHAP     */ 00826000
         CH    REG0,@CH00065                                       0260 00827000
         BE    @RF00260                                            0260 00828000
*     DO;                           /* RELEASE LOCK                  */ 00829000
*/* L SETLOCK: RELEASE GLOBAL DISP LOCK                              */ 00830000
*                                                                  0262 00831000
*       REG0=REG14;                 /* SAVE RETURN ADDRESS           */ 00832000
         LR    REG0,REG14                                          0262 00833000
*       RFY                                                        0263 00834000
*         REG8 RSTD;                /* RESTRICT FROM COMPILER        */ 00835000
*       REG8=REG13;                 /* SAVE SAVEAREA ADDRESS @YM00864*/ 00836000
         LR    REG8,REG13                                          0264 00837000
*       GEN REFS(PSALITA) SETS(R11PARM,R12SCAN,REG13,REG14);       0265 00838000
  SETLOCK RELEASE,TYPE=DISP,RELATED=(DISP,IEAVEAC0,LOCK)                00839000
*       REG13=REG8;                 /* RESTORE SAVEAREA ADDRESS    0266 00840000
*                                                            @YM00864*/ 00841000
         LR    REG13,REG8                                          0266 00842000
*       REG14=REG0;                 /* RESTORE RETURN ADDRESS        */ 00843000
         LR    REG14,REG0                                          0267 00844000
*       RFY                                                        0268 00845000
*         REG8 UNRSTD;              /* RELEASE FOR COMPILER          */ 00846000
*     END;                          /* SETLOCK INVOKED               */ 00847000
*/* %AC5: R () RETURN                                                */ 00848000
*                                                                  0270 00849000
*   END UNLOCK;                     /* RETURN TO CALLING POINT       */ 00850000
@EL00006 DS    0H                                                  0270 00851000
@EF00006 DS    0H                                                  0270 00852000
@ER00006 BR    @14                                                 0270 00853000
*/* UNLOCK: END FLOWCHART                                            */ 00854000
*                                                                  0271 00855000
*   RFY                                                            0271 00856000
*     REG0 UNRSTD;                                                 0271 00857000
*   RFY                                                            0272 00858000
*     REG14 UNRSTD;                                                0272 00859000
*                                                                  0273 00860000
*/* IEAVEAC3: CHART                                                  */ 00861000
*/* FOOTING                                                        0273 00862000
*/* FRR FOR ASCBCHAP                                                 */ 00863000
*                                                                  0273 00864000
*IEAVEAC3:                                                         0273 00865000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* FRR                      */ 00866000
*                                                                  0273 00867000
IEAVEAC3 DS    0H                                                  0274 00868000
*   /*****************************************************************/ 00869000
*   /*                                                               */ 00870000
*   /* THIS ROUTINE IS A FUNCTIONAL RECOVERY ROUTINE FOR ASCBCHAP. IT*/ 00871000
*   /* INVOKES QUEUE VERIFIER (IEAVEQV0 AT ENTRY POINT IEAVEQV3) TO  */ 00872000
*   /* VALIDATE THE ASCB DISPATCHING QUEUE, AND THEN PERCOLATES THE  */ 00873000
*   /* ERROR. REGISTER USAGE: 0 - INPUT, ADDRESS OF A 200 BYTE WORK  */ 00874000
*   /* AREA. 1 - ADDRESS OF THE SDWA.                                */ 00875000
*   /*                                                               */ 00876000
*   /*****************************************************************/ 00877000
*                                                                  0274 00878000
*/* E ENTER IEAVEAC3                                                 */ 00879000
*                                                                  0274 00880000
*   RFY                                                            0274 00881000
*     REG14 RSTD;                                                  0274 00882000
*   RFY                                                            0275 00883000
*     R15WORK RSTD;                                                0275 00884000
*   REG10=R15WORK;                  /* FRR ENTRY POINT ADDRESS     0276 00885000
*                                                             @Y02753*/ 00886000
         LR    REG10,R15WORK                                       0276 00887000
*   GEN(USING IEAVEAC3,REG10);      /* FRR ADDRESSABILITY     @Y02753*/ 00888000
         USING IEAVEAC3,REG10                                           00889000
*   RFY                                                            0278 00890000
*     REG0 RSTD;                                                   0278 00891000
*   RFY                                                            0279 00892000
*     REG1 RSTD;                                                   0279 00893000
*   RFY                                                            0280 00894000
*     CVTMAP BASED(CVTPTR);                                        0280 00895000
*   RFY                                                            0281 00896000
*     REG9 RSTD;                                                   0281 00897000
*   REG9=REG0;                      /* ADDRESS OF 200 BYTE WORKAREA     00898000
*                                                             @Y02753*/ 00899000
         LR    REG9,REG0                                           0282 00900000
*   REG6=REG14;                     /* SAVE RETURN ADDRESS    @Y02753*/ 00901000
         LR    REG6,REG14                                          0283 00902000
*   RFY                                                            0284 00903000
*     REG14 UNRSTD;                                                0284 00904000
*                                                                  0284 00905000
*/* P SET RECORDING PARMS AND REQUEST RECORDING                      */ 00906000
*                                                                  0285 00907000
*   DO;                             /* SETRP                       0285 00908000
*                                      RECORD(YES)RC(0)RECPARM(IDFRR)*/ 00909000
*     RESPECIFY                                                    0286 00910000
*      (GPR00P,                                                    0286 00911000
*       GPR01P,                                                    0286 00912000
*       GPR14P,                                                    0286 00913000
*       GPR15P) RSTD;                                              0286 00914000
*     GPR01P->SDWARCDE=0;           /* SAVE RC VALUE                 */ 00915000
         MVI   SDWARCDE(GPR01P),X'00'                              0287 00916000
*     GPR01P->SDWARCRD='1'B;        /* TURN ON RECORD INDICATOR      */ 00917000
         OI    SDWARCRD(GPR01P),B'10000000'                        0288 00918000
*     GPR15P=ADDR(IDFRR);           /* ACCESS RECORD PARAMETER LIST  */ 00919000
         LA    GPR15P,IDFRR                                        0289 00920000
*     GPR01P->SDWARECP=GPR15P->I256C(1:24);/* COPY RECORD PARAMETERS */ 00921000
         MVC   SDWARECP(24,GPR01P),I256C(GPR15P)                   0290 00922000
*     RESPECIFY                                                    0291 00923000
*      (GPR00P,                                                    0291 00924000
*       GPR01P,                                                    0291 00925000
*       GPR14P,                                                    0291 00926000
*       GPR15P) UNRSTD;                                            0291 00927000
*   END;                            /*                        @Y02753*/ 00928000
*   REG7=REG1;                      /* SAVE SDWA ADDRESS      @Y02753*/ 00929000
         LR    REG7,REG1                                           0293 00930000
*   REG13=ADDR(QVSAVEA);            /* ADDRESS OF SAVE AREA   @Y02753*/ 00931000
         LA    REG13,QVSAVEA(,REG9)                                0294 00932000
*   R15WORK=ZERO;                   /* SPECIFY CURRENT ADDRESS SPACE    00933000
*                                      FOR DUMP TASK          @Y02753*/ 00934000
         SLR   R15WORK,R15WORK                                     0295 00935000
*/* L SDUMP: REQUEST DUMP OF THE TRACE TABLE                         */ 00936000
*                                                                  0296 00937000
*   GENERATE;                                                      0296 00938000
*             /* NOTE: MACRO REQUIRES COMPILER ADEFS OPTION */          00939000
         LA    REG1,QVWORKA(,REG9)      ADDRESS OF LIST AREA    @Y02753 00940000
         MVC   0(SDUMPLNG,REG1),SDUMPLST MOVE LIST FORM         @Y02753 00941000
         SDUMP ASID=(R15WORK),BRANCH=YES,MF=(E,(1)) DUMP TRACE  @Y02753 00942000
*   RFY                                                            0297 00943000
*     R15WORK UNRSTD;                                              0297 00944000
*   REG0=REG7;                      /* ADDRESS OF SDWA INTO 0 FOR  0298 00945000
*                                      IEAVEQV3               @Y02753*/ 00946000
         LR    REG0,REG7                                           0298 00947000
*   REG1=REG9;                      /* ADDRESS OF FRRWORKA    @Y02753*/ 00948000
         LR    REG1,REG9                                           0299 00949000
*   RFY                                                            0300 00950000
*     REG8 RSTD;                                                   0300 00951000
*   REG8=ADDR(REG7->SDWARA);        /* ADDRESS OF OUTPUT DATA AREA 0301 00952000
*                                                             @Y02753*/ 00953000
         LA    REG8,SDWARA(,REG7)                                  0301 00954000
*/* P BUILD PARAMETER LIST FOR IEAVEQV3                              */ 00955000
*                                                                  0302 00956000
*   FRRWORKA=FRRWORKA&&FRRWORKA;    /* CLEAR WORKAREA         @Y02753*/ 00957000
         XC    FRRWORKA(152,REG9),FRRWORKA(REG9)                   0302 00958000
*   RFY                                                            0303 00959000
*     QVPL BASED(REG1);                                            0303 00960000
*   QVPLODA=REG8;                   /* OUTPUT DATA AREA ADDRESS    0304 00961000
*                                                             @Y02753*/ 00962000
         ST    REG8,QVPLODA(,REG1)                                 0304 00963000
*   RFY                                                            0305 00964000
*     REG8 UNRSTD;                                                 0305 00965000
*   QVPLEVR=ADDR(IEAVEAC4);         /* ASCB VERIFICATION ROUTINE   0306 00966000
*                                                            @YM06720*/ 00967000
         LA    @08,IEAVEAC4                                        0306 00968000
         ST    @08,QVPLEVR(,REG1)                                  0306 00969000
*   QVPLWKA=ADDR(QVWORKA);          /* WORKAREA ADDRESS       @Y02753*/ 00970000
         LA    @08,QVWORKA(,REG9)                                  0307 00971000
         ST    @08,QVPLWKA(,REG1)                                  0307 00972000
*   QVPLHDR=ADDR(CVTASCBH);         /* QUEUE HEADER           @Y02753*/ 00973000
         L     @08,CVTPTR                                          0308 00974000
         LA    @15,CVTASCBH(,@08)                                  0308 00975000
         ST    @15,QVPLHDR(,REG1)                                  0308 00976000
*   QVPLTRLR=ADDR(CVTASCBL);        /* QUEUE TRAILER          @Y02753*/ 00977000
         LA    @08,CVTASCBL(,@08)                                  0309 00978000
         ST    @08,QVPLTRLR(,REG1)                                 0309 00979000
*   RFY                                                            0310 00980000
*     REG8 RSTD;                                                   0310 00981000
*   GEN(LA    REG8,ASCBFWDP-ASCB);  /* OFFSET IN ASCB TO FORWARD   0311 00982000
*                                      POINTER                @Y02753*/ 00983000
         LA    REG8,ASCBFWDP-ASCB                                       00984000
*   QVPLFPTR=REG8;                  /* INTO PARM LIST         @Y02753*/ 00985000
         STH   REG8,QVPLFPTR(,REG1)                                0312 00986000
*   GEN(LA    REG8,ASCBBWDP-ASCB);  /* OFFSET IN ASCB TO BACK POINTER   00987000
*                                                             @Y02753*/ 00988000
         LA    REG8,ASCBBWDP-ASCB                                       00989000
*   QVPLBPTR=REG8;                  /* INTO PARAMETER LIST. NOTE:  0314 00990000
*                                      FIELDS QVPLLELM, QVPLNOEL,  0314 00991000
*                                      QVPLFELM ARE INPUT, REMAIN SET   00992000
*                                      TO ZERO.               @Y02753*/ 00993000
         STH   REG8,QVPLBPTR(,REG1)                                0314 00994000
*/* L IEAVEQV3: VALIDATE ASCB DISPATCHING QUEUE                      */ 00995000
*                                                                  0315 00996000
*   CALL IEAVEQV3;                  /* INVOKE QUEUE VERIFIER  @Y02753*/ 00997000
         L     @15,@CV01752                                        0315 00998000
         BALR  @14,@15                                             0315 00999000
*/* R () RETURN TO RTM, RC=0                                         */ 01000000
*                                                                  0316 01001000
*   REG1=REG7;                      /* ADDRESS OF SDWA        @Y02753*/ 01002000
         LR    REG1,REG7                                           0316 01003000
*   REG9=REG1->SDWAPARM;            /* FRR 6-WORD WORKAREA    @Y02753*/ 01004000
         L     REG9,SDWAPARM(,REG1)                                0317 01005000
*   IF REG9->FRR6LOCKÂ¬=LOCK4 THEN   /* WAS LOCK HELD ON ENTRY ?    0318 01006000
*                                                             @Y02753*/ 01007000
         CLI   FRR6LOCK(REG9),4                                    0318 01008000
         BE    @RF00318                                            0318 01009000
*     DO;                           /* SETRP RC(0)FRELOCK(DISP)      */ 01010000
*       RESPECIFY                                                  0320 01011000
*        (GPR00P,                                                  0320 01012000
*         GPR01P,                                                  0320 01013000
*         GPR14P,                                                  0320 01014000
*         GPR15P) RSTD;                                            0320 01015000
*       GPR01P->SDWARCDE=0;         /* SAVE RC VALUE                 */ 01016000
         MVI   SDWARCDE(GPR01P),X'00'                              0321 01017000
*       GPR01P->SDWAACF3=GPR01P->SDWAACF3|'00010000'B;/* INITIALIZE     01018000
*                                      LOCK FLAGS                    */ 01019000
         OI    SDWAACF3(GPR01P),B'00010000'                        0322 01020000
*       RESPECIFY                                                  0323 01021000
*        (GPR00P,                                                  0323 01022000
*         GPR01P,                                                  0323 01023000
*         GPR14P,                                                  0323 01024000
*         GPR15P) UNRSTD;                                          0323 01025000
*     END;                          /* GLOBAL DISP LOCK TO BE FREED     01026000
*                                                             @Y02753*/ 01027000
*   RFY                                                            0325 01028000
*     REG14 RSTD;                                                  0325 01029000
@RF00318 DS    0H                                                  0326 01030000
*   REG14=REG6;                     /* RESTORE RETURN ADDRESS @Y02753*/ 01031000
         LR    REG14,REG6                                          0326 01032000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 01033000
*     GPR00P PTR(31) REG(0),                                       0327 01034000
*     GPR01P PTR(31) REG(1),                                       0327 01035000
*     GPR14P PTR(31) REG(14),                                      0327 01036000
*     GPR15P PTR(31) REG(15);                                      0327 01037000
*   DECLARE                         /* COMMON VARIABLES              */ 01038000
*     I256C CHAR(256) BASED,                                       0328 01039000
*     I031F FIXED(31) BASED,                                       0328 01040000
*     I031P PTR(31) BASED,                                         0328 01041000
*     I015F FIXED(15) BASED,                                       0328 01042000
*     I015P PTR(15) BASED,                                         0328 01043000
*     I008P PTR(8) BASED,                                          0328 01044000
*     I001C CHAR(1) BASED;          /*                        @Y02753*/ 01045000
*   END IEAVEAC3;                   /* END FRR                @Y02753*/ 01046000
@EL00007 DS    0H                                                  0329 01047000
@EF00007 DS    0H                                                  0329 01048000
@ER00007 BR    @14                                                 0329 01049000
*/* IEAVEAC3: END FLOWCHART                                          */ 01050000
*                                                                  0330 01051000
*                                                                  0330 01052000
*/* IEAVEAC4: CHART                                                  */ 01053000
*/* FOOTING                                                        0330 01054000
*/* ASCB VERIFICATION ROUTINE                                        */ 01055000
*                                                                  0330 01056000
*IEAVEAC4:                                                         0330 01057000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ASCB VERIFICATION ROUTINE   01058000
*                                                            @YM06720*/ 01059000
IEAVEAC4 DS    0H                                                  0331 01060000
*/********************************************************************/ 01061000
*/*                                                                  */ 01062000
*/*    THIS ROUTINE IS PART OF ASCBCHAP'S RECOVERY. IT IS            */ 01063000
*/*    INVOKED BY THE QUEUE VERIFIER ROUTINE TO VALIDATE             */ 01064000
*/*    THE ASCB DISPATCHING QUEUE. TO HANDLE THE ERROR WHERE         */ 01065000
*/*    ASCBCHAP WAS IN THE PROCESS OF REMOVING AN ASCB FROM          */ 01066000
*/*    ITS DISPATCHING QUEUE (ASCBNOQ BIT ON), RETURN CODE 4         */ 01067000
*/*    WILL BE SET SO THAT THE ASCB GETS DEQUEUED.                   */ 01068000
*/*                                                                  */ 01069000
*/*    SYSTEM ROUTINES CALLED / MACROS ISSUED:                       */ 01070000
*/*    IEAVEGAS - GENERAL ASCB CONTROL BLOCK VERIFICATION ROUTINE    */ 01071000
*/*          INPUT REGISTERS: 0 - ASCB ADDRESS                       */ 01072000
*/*                           1 - SDWA ADDRESS                       */ 01073000
*/*                          14 - RETURN ADDRESS                     */ 01074000
*/*                          15 - ENTRY POINT ADDRESS                */ 01075000
*/*                                                                  */ 01076000
*/*          OUTPUT REGISTERS: 0,1,8-14 - UNCHANGED                  */ 01077000
*/*                            2-7 - UNPREDICTABLE                   */ 01078000
*/*                            15 - RETURN CODE                      */ 01079000
*/*                                 0, IF THE ASCB IS VALID          */ 01080000
*/*                                 4, IF IT IS AN ASCB BUT INVALID  */ 01081000
*/*                                 8, IF IT IS NOT AN ASCB          */ 01082000
*/*                                                                  */ 01083000
*/*    REGISTER USAGE:                                               */ 01084000
*/*             INPUT: 0 - ADDRESS TO BE VERIFIED                    */ 01085000
*/*                    1 - SDWA ADDRESS                              */ 01086000
*/*                   14 - RETURN ADDRESS                            */ 01087000
*/*                   15 - ENTRY POINT ADDRESS                       */ 01088000
*/*                                                                  */ 01089000
*/*             REGISTERS 8 - 14 ARE SAVED FOR QUEUE VERIFIER.       */ 01090000
*/*                                                                  */ 01091000
*/*             WORK:  2 - ADDRESS OF DISPATCHER'S SAVE AREA         */ 01092000
*/*                    8 - ADDRESS OF DISPATCHER'S SAVE AREA         */ 01093000
*/*                   10 - BASE REGISTER                             */ 01094000
*/*                   12 - ASCB ADDRESS                              */ 01095000
*/*                                                                  */ 01096000
*/*             OUTPUT: 8 - 14 ARE RESTORED                          */ 01097000
*/*                    15 - RETURN CODE                              */ 01098000
*/*                       0, IF THE ASCB IS VALID                    */ 01099000
*/*                       4, IF IT IS AN ASCB BUT INVALID OR         */ 01100000
*/*                          IN THE PROCESS OF BEING DEQUEUED        */ 01101000
*/*                       8, IF IT IS NOT AN ASCB                    */ 01102000
*/*                                                                  */ 01103000
*/********************************************************************/ 01104000
*/* E ENTER IEAVEAC4                                                 */ 01105000
*                                                                  0331 01106000
*   RFY                                                            0331 01107000
*    (REG0,                                                        0331 01108000
*     REG1,                                                        0331 01109000
*     REG2,                                                        0331 01110000
*     REG8,                                                        0331 01111000
*     REG9,                                                        0331 01112000
*     REG10,                                                       0331 01113000
*     R11PARM,                                                     0331 01114000
*     R12SCAN,                                                     0331 01115000
*     REG13,                                                       0331 01116000
*     REG14,                                                       0331 01117000
*     R15WORK) RSTD;                /*                       @YM06720*/ 01118000
*/* P SAVE QUEUE VERIFIER'S REGISTERS                                */ 01119000
*                                                                  0332 01120000
*   REG2=PSALCCAV->LCCACPUS->WSACEDS0;/* OBTAIN ADDR OF DISPATCHER'S    01121000
*                                      SAVE AREA             @YM06720*/ 01122000
         L     REG2,PSALCCAV                                       0332 01123000
         L     REG2,LCCACPUS(,REG2)                                0332 01124000
         L     REG2,WSACEDS0(,REG2)                                0332 01125000
*   RFY                                                            0333 01126000
*     DSPSAVEA BASED(REG2);         /* ESTABLISH ADDRESSABILITY TO 0333 01127000
*                                      DISPATCHER'S SAVE AREA      0333 01128000
*                                                            @YM06720*/ 01129000
*   STM(REG8,REG14,DSPSAVEA);       /* SAVE QUEUE VERIFIER'S REGS 8 -   01130000
*                                      14                    @YM06720*/ 01131000
         STM   REG8,REG14,DSPSAVEA(REG2)                           0334 01132000
*   RFY                                                            0335 01133000
*    (REG9,                                                        0335 01134000
*     R11PARM,                                                     0335 01135000
*     REG13) UNRSTD;                /*                       @YM06720*/ 01136000
*/* P ESTABLISH ADDRESSABILITY                                       */ 01137000
*                                                                  0336 01138000
*   REG10=R15WORK;                  /* OBTAIN ENTRY POINT ADDRESS  0336 01139000
*                                                            @YM06720*/ 01140000
         LR    REG10,R15WORK                                       0336 01141000
*   GEN(USING IEAVEAC4,REG10);      /* ESTABLISH BASE REG    @YM06720*/ 01142000
         USING IEAVEAC4,REG10                                           01143000
*   R12SCAN=REG0;                   /* OBTAIN ASCB ADDR      @YM06720*/ 01144000
         LR    R12SCAN,REG0                                        0338 01145000
*   REG8=REG2;                      /* GET ADDR OF DISPATCHER'S SAVE    01146000
*                                      AREA INTO A REG NOT DESTROYED    01147000
*                                                            @YM06720*/ 01148000
         LR    REG8,REG2                                           0339 01149000
*   RFY                                                            0340 01150000
*     DSPSAVEA BASED(REG8);         /* RE-ESTABLISH ADDRESSABILITY TO   01151000
*                                      DISPATCHER'S SAVE AREA      0340 01152000
*                                                            @YM06720*/ 01153000
*/* L IEAVEGAS: VERIFY EACH ASCB                                     */ 01154000
*                                                                  0341 01155000
*   CALL IEAVEGAS;                  /* INVOKE ASCB CONTROL BLOCK   0341 01156000
*                                      VERIFIER ROUTINE      @YM06720*/ 01157000
         L     @15,@CV01751                                        0341 01158000
         BALR  @14,@15                                             0341 01159000
*/* D (NO,%NOTZERO,YES,) VALID ASCB ?                                */ 01160000
*                                                                  0342 01161000
*   IF R15WORK=ZERO THEN            /* WAS ASCB VALID - RETURN CODE 0   01162000
*                                                            @YM06720*/ 01163000
         LTR   R15WORK,R15WORK                                     0342 01164000
         BNZ   @RF00342                                            0342 01165000
*/* D (NO,%RETURN,YES,) ASCB MARKED NOT ON QUEUE ?                   */ 01166000
*                                                                  0343 01167000
*     IF R12SCAN->ASCBNOQ='1'B THEN /* WAS ASCB MARKED NOT ON      0343 01168000
*                                      DISPATCHING QUEUE     @YM06720*/ 01169000
         TM    ASCBNOQ(R12SCAN),B'10000000'                        0343 01170000
         BNO   @RF00343                                            0343 01171000
*/* P (,%RETURN) SET RETURN CODE FOUR                                */ 01172000
*                                                                  0344 01173000
*       R15WORK=FOUR;               /* MARKED NOT ON QUEUE - SET   0344 01174000
*                                      RETURN CODE 4 TO GET ASCB   0344 01175000
*                                      DEQUEUED              @YM06720*/ 01176000
         LA    R15WORK,4                                           0344 01177000
*     ELSE                                                         0345 01178000
*       ;                           /*                       @YM06720*/ 01179000
@RF00343 DS    0H                                                  0346 01180000
*   ELSE                            /* NOT VALID ASCB        @YM06720*/ 01181000
*/* %NOTZERO: D (NO,%RETURN,YES,) ASCB WITH INVALID DATA ?           */ 01182000
*                                                                  0346 01183000
*     IF R15WORK=FOUR THEN          /* WAS IT AN ASCB WITH INVALID 0346 01184000
*                                      DATA - RETURN CODE 4  @YM06720*/ 01185000
         B     @RC00342                                            0346 01186000
@RF00342 CH    R15WORK,@CH00065                                    0346 01187000
         BNE   @RF00346                                            0346 01188000
*/* P MARK ASCB AS NOT ON QUEUE                                      */ 01189000
*                                                                  0347 01190000
*       R12SCAN->ASCBNOQ='1'B;      /* INVALID ASCB - INDICATE NOT ON   01191000
*                                      QUEUE                 @YM06720*/ 01192000
         OI    ASCBNOQ(R12SCAN),B'10000000'                        0347 01193000
*/* %RETURN: P RESTORE QUEUE VERIFIER'S REGISTERS                    */ 01194000
*                                                                  0348 01195000
*   RFY                                                            0348 01196000
*    (REG9,                                                        0348 01197000
*     R11PARM,                                                     0348 01198000
*     REG13) RSTD;                  /*                       @YM06720*/ 01199000
@RF00346 DS    0H                                                  0348 01200000
@RC00342 DS    0H                                                  0349 01201000
*   LM(REG8,REG14,DSPSAVEA);        /* RESTORE REGS 8 - 14 FOR RETURN   01202000
*                                      TO QUEUE VERIFIER     @YM06720*/ 01203000
         LM    REG8,REG14,DSPSAVEA(REG8)                           0349 01204000
*/* R RETURN TO QUEUE VERIFIER                                       */ 01205000
*                                                                  0350 01206000
*   END IEAVEAC4;                   /* END ASCB VERIFICATION ROUTINE    01207000
*                                                            @YM06720*/ 01208000
@EL00008 DS    0H                                                  0350 01209000
@EF00008 DS    0H                                                  0350 01210000
@ER00008 BR    @14                                                 0350 01211000
*/* IEAVEAC4: END FLOWCHART                                          */ 01212000
*                                                                  0351 01213000
*   END IEAVEAC0                    /* END PROCEDURE               0351 01214000
*                                                                    */ 01215000
*                                                                  0351 01216000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01217000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 01218000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 01219000
*/*%INCLUDE SYSLIB  (IHALCCA )                                       */ 01220000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 01221000
*/*%INCLUDE SYSLIB  (IHAWSAVT)                                       */ 01222000
*/*%INCLUDE SYSLIB  (IHAQVPL )                                       */ 01223000
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */ 01224000
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */ 01225000
*                                                                  0351 01226000
*       ;                                                          0351 01227000
@DATA    DS    0H                                                       01228000
@CH00088 DC    H'1'                                                     01229000
@CH00065 DC    H'4'                                                     01230000
@DATD    DSECT                                                          01231000
         DS    0F                                                       01232000
IEAVEAC0 CSECT                                                          01233000
         DS    0F                                                       01234000
@DATD    DSECT                                                          01235000
         DS    0D                                                       01236000
IEAVEAC0 CSECT                                                          01237000
         NOPR  ((@ENDDATD-@DATD)*16)                                    01238000
         DS    0F                                                       01239000
@SIZDATD DC    AL1(0)                                                   01240000
         DC    AL3(@ENDDATD-@DATD)                                      01241000
@CV01750 DC    V(IEAVEMS0)                                              01242000
@CV01751 DC    V(IEAVEGAS)                                              01243000
@CV01752 DC    V(IEAVEQV3)                                              01244000
         DS    0D                                                       01245000
IDSDUMP  DS    CL25                                                     01246000
         ORG   IDSDUMP                                                  01247000
IDLNGTH  DC    AL1(24)                                                  01248000
IDFRR    DS    CL24                                                     01249000
         ORG   IDFRR                                                    01250000
IDPROGMN DC    CL8'IEAVEAC0'                                            01251000
IDCSECT  DC    CL8'IEAVEAC0'                                            01252000
IDFRRENT DC    CL8'IEAVEAC3'                                            01253000
         ORG   IDSDUMP+25                                               01254000
IEAVEAC0 CSECT                                                          01255000
*                              /* ASSEMBLER DATA */                     01256000
ACENABLE STOSM ACOMASK(REG13),0         EXECUTE TARGET INSTRUCTION      01257000
SDUMPLST SDUMP HDRAD=IDSDUMP,SDATA=(TRT),MF=L SDUMP FOR FRR             01258000
SDUMPLNG EQU   *-SDUMPLST               LENGTH OF SDUMP LIST FORM       01259000
DMASK    EQU   X'FC'                    PSW MASK TO DISABLE             01260000
@DATD    DSECT                                                          01261000
@ENDDATD EQU   *                                                        01262000
IEAVEAC0 CSECT                                                          01263000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01264000
@01      EQU   01                                                       01265000
@02      EQU   02                                                       01266000
@03      EQU   03                                                       01267000
@04      EQU   04                                                       01268000
@05      EQU   05                                                       01269000
@06      EQU   06                                                       01270000
@07      EQU   07                                                       01271000
@08      EQU   08                                                       01272000
@09      EQU   09                                                       01273000
@10      EQU   10                                                       01274000
@11      EQU   11                                                       01275000
@12      EQU   12                                                       01276000
@13      EQU   13                                                       01277000
@14      EQU   14                                                       01278000
@15      EQU   15                                                       01279000
REG8     EQU   @08                                                      01280000
REG9     EQU   @09                                                      01281000
REG10    EQU   @10                                                      01282000
R11PARM  EQU   @11                                                      01283000
R12SCAN  EQU   @12                                                      01284000
REG13    EQU   @13                                                      01285000
REG14    EQU   @14                                                      01286000
R15WORK  EQU   @15                                                      01287000
REG0     EQU   @00                                                      01288000
REG1     EQU   @01                                                      01289000
REG2     EQU   @02                                                      01290000
REG3     EQU   @03                                                      01291000
REG4     EQU   @04                                                      01292000
REG5     EQU   @05                                                      01293000
REG6     EQU   @06                                                      01294000
REG7     EQU   @07                                                      01295000
GPR00P   EQU   @00                                                      01296000
GPR01P   EQU   @01                                                      01297000
GPR14P   EQU   @14                                                      01298000
GPR15P   EQU   @15                                                      01299000
CVTPTR   EQU   16                                                       01300000
PSA      EQU   0                                                        01301000
FLCRNPSW EQU   PSA                                                      01302000
FLCROPSW EQU   PSA+8                                                    01303000
FLCICCW2 EQU   PSA+16                                                   01304000
PSAEEPSW EQU   PSA+132                                                  01305000
PSAESPSW EQU   PSA+136                                                  01306000
FLCSVILC EQU   PSAESPSW+1                                               01307000
PSAEPPSW EQU   PSA+140                                                  01308000
FLCPIILC EQU   PSAEPPSW+1                                               01309000
FLCPICOD EQU   PSAEPPSW+2                                               01310000
PSAPICOD EQU   FLCPICOD+1                                               01311000
FLCTEA   EQU   PSAEPPSW+4                                               01312000
FLCPER   EQU   PSA+152                                                  01313000
FLCMCLA  EQU   PSA+168                                                  01314000
FLCIOEL  EQU   FLCMCLA+4                                                01315000
FLCIOA   EQU   FLCMCLA+16                                               01316000
FLCFSA   EQU   FLCMCLA+80                                               01317000
PSALCCAV EQU   PSA+528                                                  01318000
PSASUPER EQU   PSA+552                                                  01319000
PSASUP1  EQU   PSASUPER                                                 01320000
PSASUP2  EQU   PSASUPER+1                                               01321000
PSASUP3  EQU   PSASUPER+2                                               01322000
PSASUP4  EQU   PSASUPER+3                                               01323000
PSACLHT  EQU   PSA+640                                                  01324000
PSALKSA  EQU   PSA+696                                                  01325000
PSAHLHI  EQU   PSA+760                                                  01326000
PSALITA  EQU   PSA+764                                                  01327000
PSADSSFL EQU   PSA+836                                                  01328000
PSADSSF1 EQU   PSADSSFL                                                 01329000
PSADSSF3 EQU   PSADSSFL+2                                               01330000
PSADSSF4 EQU   PSADSSFL+3                                               01331000
PSARSVT  EQU   PSA+896                                                  01332000
QVPLPTR  EQU   0                                                        01333000
FRRSPTR  EQU   0                                                        01334000
FRREPTR  EQU   0                                                        01335000
SDWAPTR  EQU   0                                                        01336000
CVTMAP   EQU   0                                                        01337000
CVTBTERM EQU   CVTMAP+52                                                01338000
CVTDAR   EQU   CVTMAP+72                                                01339000
CVTFLGS1 EQU   CVTDAR                                                   01340000
CVTDCB   EQU   CVTMAP+116                                               01341000
CVTIERLC EQU   CVTMAP+144                                               01342000
CVTOPTA  EQU   CVTMAP+182                                               01343000
CVTOPTB  EQU   CVTMAP+183                                               01344000
CVTGTF   EQU   CVTMAP+236                                               01345000
CVTGTFST EQU   CVTGTF                                                   01346000
CVTGTFS  EQU   CVTGTFST                                                 01347000
CVTSTATE EQU   CVTGTFST                                                 01348000
CVTTMODE EQU   CVTGTFST                                                 01349000
CVTFORM  EQU   CVTGTFST                                                 01350000
CVTUSR   EQU   CVTGTFST                                                 01351000
CVTAQAVT EQU   CVTMAP+240                                               01352000
CVTTCMFG EQU   CVTAQAVT                                                 01353000
CVTVOLM2 EQU   CVTMAP+244                                               01354000
CVTTATA  EQU   CVTVOLM2                                                 01355000
CVTTSKS  EQU   CVTTATA                                                  01356000
CVTVOLF2 EQU   CVTTSKS                                                  01357000
CVTTAT   EQU   CVTTATA+1                                                01358000
CVTATER  EQU   CVTMAP+248                                               01359000
CVTEXT1  EQU   CVTMAP+252                                               01360000
CVTPURG  EQU   CVTMAP+260                                               01361000
CVTQMSG  EQU   CVTMAP+268                                               01362000
CVTDMSR  EQU   CVTMAP+272                                               01363000
CVTERPV  EQU   CVTMAP+316                                               01364000
CVTINTLA EQU   CVTMAP+320                                               01365000
CVTAPF   EQU   CVTMAP+324                                               01366000
CVTEXT2  EQU   CVTMAP+328                                               01367000
CVTHJES  EQU   CVTMAP+332                                               01368000
CVTPGSIA EQU   CVTMAP+348                                               01369000
CVTA1F1  EQU   CVTMAP+356                                               01370000
CVTSYSK  EQU   CVTMAP+357                                               01371000
CVTVOLM1 EQU   CVTMAP+380                                               01372000
CVTVOLF1 EQU   CVTVOLM1                                                 01373000
CVTATMCT EQU   CVTMAP+388                                               01374000
CVTXTNT1 EQU   0                                                        01375000
CVTXTNT2 EQU   0                                                        01376000
CVTDSSV  EQU   CVTXTNT2                                                 01377000
CVTRSV90 EQU   CVTXTNT2+5                                               01378000
CVTQID   EQU   CVTXTNT2+24                                              01379000
CVTRV400 EQU   CVTXTNT2+52                                              01380000
CVTRV409 EQU   CVTXTNT2+53                                              01381000
CVTATCVT EQU   CVTXTNT2+64                                              01382000
CVTRV429 EQU   CVTXTNT2+84                                              01383000
CVTRV438 EQU   CVTXTNT2+85                                              01384000
CVTRV457 EQU   CVTXTNT2+112                                             01385000
CVTRV466 EQU   CVTXTNT2+113                                             01386000
CVTFIX   EQU   0                                                        01387000
CVTRELNO EQU   CVTFIX+252                                               01388000
LCCA     EQU   0                                                        01389000
LCCAIHRC EQU   LCCA+520                                                 01390000
LCCAIHR1 EQU   LCCAIHRC                                                 01391000
LCCAIHR2 EQU   LCCAIHRC+1                                               01392000
LCCAIHR3 EQU   LCCAIHRC+2                                               01393000
LCCAIHR4 EQU   LCCAIHRC+3                                               01394000
LCCASPIN EQU   LCCA+524                                                 01395000
LCCASPN1 EQU   LCCASPIN                                                 01396000
LCCASPN2 EQU   LCCASPIN+1                                               01397000
LCCASPN3 EQU   LCCASPIN+2                                               01398000
LCCASPN4 EQU   LCCASPIN+3                                               01399000
LCCACPUS EQU   LCCA+536                                                 01400000
LCCADSF1 EQU   LCCA+540                                                 01401000
LCCAACR  EQU   LCCADSF1                                                 01402000
LCCADSF2 EQU   LCCA+541                                                 01403000
LCCASPSA EQU   LCCA+544                                                 01404000
LCCACRFL EQU   LCCA+692                                                 01405000
LCCACREX EQU   LCCA+693                                                 01406000
LCCALKFG EQU   LCCA+694                                                 01407000
LCCASRBF EQU   LCCA+720                                                 01408000
ASCB     EQU   0                                                        01409000
ASCBFWDP EQU   ASCB+4                                                   01410000
ASCBBWDP EQU   ASCB+8                                                   01411000
ASCBCPUS EQU   ASCB+32                                                  01412000
ASCBSEQN EQU   ASCB+38                                                  01413000
ASCBDP   EQU   ASCB+43                                                  01414000
ASCBFW1  EQU   ASCB+100                                                 01415000
ASCBRCTF EQU   ASCBFW1+2                                                01416000
ASCBFLG1 EQU   ASCBFW1+3                                                01417000
ASCBDSP1 EQU   ASCB+114                                                 01418000
ASCBNOQ  EQU   ASCBDSP1                                                 01419000
ASCBFLG2 EQU   ASCB+115                                                 01420000
WSAC     EQU   0                                                        01421000
WSACACR  EQU   WSAC+16                                                  01422000
WSACEDS0 EQU   WSAC+28                                                  01423000
QVPL     EQU   0                                                        01424000
QVPLTYP3 EQU   QVPL                                                     01425000
QVPLTYP2 EQU   QVPLTYP3                                                 01426000
QVPLTYP1 EQU   QVPLTYP2                                                 01427000
QVPLEVR  EQU   QVPLTYP1                                                 01428000
QVPLODA  EQU   QVPLTYP1+4                                               01429000
QVPLWKA  EQU   QVPLTYP1+8                                               01430000
QVPLHDR  EQU   QVPLTYP1+16                                              01431000
QVPLHF   EQU   QVPLTYP1+20                                              01432000
QVPLFLGH EQU   QVPLHF                                                   01433000
QVPLFLGF EQU   QVPLHF+1                                                 01434000
QVPLFPTR EQU   QVPLHF+2                                                 01435000
QVPLTRLR EQU   QVPLTYP2+28                                              01436000
QVPLTB   EQU   QVPLTYP2+32                                              01437000
QVPLFLGT EQU   QVPLTB                                                   01438000
QVPLFLGB EQU   QVPLTB+1                                                 01439000
QVPLBPTR EQU   QVPLTB+2                                                 01440000
FRRS     EQU   0                                                        01441000
FRRSHEAD EQU   FRRS                                                     01442000
FRRSENTR EQU   0                                                        01443000
FRRSFLGS EQU   FRRSENTR+4                                               01444000
FRRSFLG1 EQU   FRRSFLGS                                                 01445000
SDWA     EQU   0                                                        01446000
SDWAPARM EQU   SDWA                                                     01447000
SDWAFIOB EQU   SDWA+4                                                   01448000
SDWAABCC EQU   SDWAFIOB                                                 01449000
SDWACMPF EQU   SDWAABCC                                                 01450000
SDWACTL1 EQU   SDWA+8                                                   01451000
SDWACMKA EQU   SDWACTL1                                                 01452000
SDWAMWPA EQU   SDWACTL1+1                                               01453000
SDWAPMKA EQU   SDWACTL1+4                                               01454000
SDWACTL2 EQU   SDWA+16                                                  01455000
SDWACMKP EQU   SDWACTL2                                                 01456000
SDWAMWPP EQU   SDWACTL2+1                                               01457000
SDWAPMKP EQU   SDWACTL2+4                                               01458000
SDWAGRSV EQU   SDWA+24                                                  01459000
SDWANAME EQU   SDWA+88                                                  01460000
SDWAEC1  EQU   SDWA+104                                                 01461000
SDWAEMK1 EQU   SDWAEC1                                                  01462000
SDWAMWP1 EQU   SDWAEC1+1                                                01463000
SDWAINT1 EQU   SDWAEC1+2                                                01464000
SDWANXT1 EQU   SDWAEC1+4                                                01465000
SDWAAEC1 EQU   SDWA+112                                                 01466000
SDWAILC1 EQU   SDWAAEC1+1                                               01467000
SDWAINC1 EQU   SDWAAEC1+2                                               01468000
SDWAICD1 EQU   SDWAINC1+1                                               01469000
SDWAEC2  EQU   SDWA+120                                                 01470000
SDWAEMK2 EQU   SDWAEC2                                                  01471000
SDWAMWP2 EQU   SDWAEC2+1                                                01472000
SDWAINT2 EQU   SDWAEC2+2                                                01473000
SDWANXT2 EQU   SDWAEC2+4                                                01474000
SDWAAEC2 EQU   SDWA+128                                                 01475000
SDWAILC2 EQU   SDWAAEC2+1                                               01476000
SDWAINC2 EQU   SDWAAEC2+2                                               01477000
SDWAICD2 EQU   SDWAINC2+1                                               01478000
SDWASRSV EQU   SDWA+136                                                 01479000
SDWAIDNT EQU   SDWA+200                                                 01480000
SDWAMCH  EQU   SDWA+204                                                 01481000
SDWASTCK EQU   SDWAMCH                                                  01482000
SDWAMCHI EQU   SDWAMCH+8                                                01483000
SDWAMCHS EQU   SDWAMCHI                                                 01484000
SDWAMCHD EQU   SDWAMCHI+1                                               01485000
SDWARSR1 EQU   SDWAMCH+12                                               01486000
SDWARSR2 EQU   SDWAMCH+13                                               01487000
SDWAFLGS EQU   SDWA+232                                                 01488000
SDWAERRA EQU   SDWAFLGS                                                 01489000
SDWAERRB EQU   SDWAFLGS+1                                               01490000
SDWAERRC EQU   SDWAFLGS+2                                               01491000
SDWAERRD EQU   SDWAFLGS+3                                               01492000
SDWAIOFS EQU   SDWA+238                                                 01493000
SDWACPUA EQU   SDWA+248                                                 01494000
SDWAPARQ EQU   SDWA+252                                                 01495000
SDWARCDE EQU   SDWAPARQ                                                 01496000
SDWAACF2 EQU   SDWAPARQ+1                                               01497000
SDWARCRD EQU   SDWAACF2                                                 01498000
SDWAACF3 EQU   SDWAPARQ+2                                               01499000
SDWAACF4 EQU   SDWAPARQ+3                                               01500000
SDWALKWA EQU   SDWA+256                                                 01501000
SDWALKWS EQU   SDWALKWA                                                 01502000
SDWARECP EQU   SDWA+292                                                 01503000
SDWASNPA EQU   SDWA+320                                                 01504000
SDWADUMP EQU   SDWASNPA                                                 01505000
SDWADPFS EQU   SDWADUMP+1                                               01506000
SDWADDAT EQU   SDWASNPA+4                                               01507000
SDWASDAT EQU   SDWADDAT                                                 01508000
SDWAPDAT EQU   SDWADDAT+2                                               01509000
SDWADPSA EQU   SDWA+328                                                 01510000
SDWADPSL EQU   SDWADPSA                                                 01511000
SDWARA   EQU   SDWA+400                                                 01512000
SDWADPVA EQU   SDWARA+2                                                 01513000
MOVELIST EQU   0                                                        01514000
MOVENTRY EQU   MOVELIST                                                 01515000
MOVEBITS EQU   MOVENTRY                                                 01516000
MOVELAST EQU   MOVEBITS                                                 01517000
MOVEOFF  EQU   MOVEBITS                                                 01518000
MOVEDP   EQU   MOVENTRY+2                                               01519000
MOVEASCB EQU   MOVENTRY+4                                               01520000
MOVENEXT EQU   MOVELIST+8                                               01521000
FRRWORKA EQU   0                                                        01522000
QVSAVEA  EQU   FRRWORKA+40                                              01523000
QVWORKA  EQU   FRRWORKA+112                                             01524000
FRR6WORD EQU   0                                                        01525000
FRR6WD1  EQU   FRR6WORD                                                 01526000
FRR6LOCK EQU   FRR6WD1                                                  01527000
ACSAVEA  EQU   0                                                        01528000
ACSAVE13 EQU   ACSAVEA+20                                               01529000
ACFRR6AD EQU   ACSAVE13                                                 01530000
ACSAVE15 EQU   ACSAVEA+28                                               01531000
ACOMASK  EQU   ACSAVE15                                                 01532000
ACLOCKRC EQU   ACSAVE15+1                                               01533000
ACRETCOD EQU   ACSAVE15+3                                               01534000
ACSAVE01 EQU   ACSAVEA+32                                               01535000
ACSAVE0  EQU   ACSAVE01                                                 01536000
ACECODE  EQU   ACSAVE0+3                                                01537000
DSPSAVEA EQU   0                                                        01538000
I256C    EQU   0                                                        01539000
I001C    EQU   0                                                        01540000
I008P    EQU   0                                                        01541000
I015F    EQU   0                                                        01542000
I015P    EQU   0                                                        01543000
I031F    EQU   0                                                        01544000
I031P    EQU   0                                                        01545000
PSARSVTE EQU   PSARSVT                                                  01546000
CVTS01   EQU   CVTPGSIA                                                 01547000
CVTLPDIA EQU   CVTS01+12                                                01548000
CVTDIRST EQU   CVTLPDIA                                                 01549000
CVTSLIDA EQU   CVTS01+24                                                01550000
CVTCTLFG EQU   CVTS01+50                                                01551000
CVTASCBH EQU   CVTS01+216                                               01552000
CVTASCBL EQU   CVTS01+220                                               01553000
CVTRV210 EQU   CVTS01+424                                               01554000
CVTRV219 EQU   CVTS01+425                                               01555000
CVTRV228 EQU   CVTS01+426                                               01556000
CVTRV237 EQU   CVTS01+427                                               01557000
CVTMFRTR EQU   CVTS01+452                                               01558000
CVTRV262 EQU   CVTS01+468                                               01559000
CVTRV271 EQU   CVTS01+469                                               01560000
CVTRV280 EQU   CVTS01+470                                               01561000
CVTRV289 EQU   CVTS01+471                                               01562000
CVTGSDA  EQU   CVTS01+600                                               01563000
FLC      EQU   PSA                                                      01564000
*                                      START UNREFERENCED COMPONENTS    01565000
CVTTPIO  EQU   CVTS01+608                                               01566000
CVTADV   EQU   CVTS01+604                                               01567000
CVTGSDAB EQU   CVTGSDA                                                  01568000
CVTQV3   EQU   CVTS01+596                                               01569000
CVTQV2   EQU   CVTS01+592                                               01570000
CVTQV1   EQU   CVTS01+588                                               01571000
CVTRPT   EQU   CVTS01+584                                               01572000
CVTSSRB  EQU   CVTS01+580                                               01573000
CVTCSDRL EQU   CVTS01+576                                               01574000
CVTEXP1  EQU   CVTS01+572                                               01575000
CVTRMPMT EQU   CVTS01+568                                               01576000
CVTRMPTT EQU   CVTS01+564                                               01577000
CVTVPSA  EQU   CVTS01+560                                               01578000
CVTVSTOP EQU   CVTS01+556                                               01579000
CVTGTFR8 EQU   CVTS01+552                                               01580000
CVTQUIT  EQU   CVTS01+548                                               01581000
CVTVACR  EQU   CVTS01+544                                               01582000
CVTWTCB  EQU   CVTS01+540                                               01583000
CVTSTPRS EQU   CVTS01+536                                               01584000
CVT0PT02 EQU   CVTS01+532                                               01585000
CVTDARCM EQU   CVTS01+528                                               01586000
CVTIRECM EQU   CVTS01+524                                               01587000
CVTJRECM EQU   CVTS01+520                                               01588000
CVTVEMS0 EQU   CVTS01+516                                               01589000
CVTSPFRR EQU   CVTS01+512                                               01590000
CVTRLSTG EQU   CVTS01+508                                               01591000
CVT0TC0A EQU   CVTS01+504                                               01592000
CVTGMBR  EQU   CVTS01+500                                               01593000
CVTLFRM  EQU   CVTS01+496                                               01594000
CVTRMBR  EQU   CVTS01+492                                               01595000
CVTVIOP  EQU   CVTS01+488                                               01596000
CVTRV307 EQU   CVTS01+486                                               01597000
CVTRV306 EQU   CVTS01+484                                               01598000
CVTRV305 EQU   CVTS01+482                                               01599000
CVTRV304 EQU   CVTS01+480                                               01600000
CVTRV303 EQU   CVTS01+478                                               01601000
CVTRV302 EQU   CVTS01+476                                               01602000
CVTRV301 EQU   CVTS01+475                                               01603000
CVTRV300 EQU   CVTS01+474                                               01604000
CVTRV299 EQU   CVTS01+473                                               01605000
CVTRV298 EQU   CVTS01+472                                               01606000
CVTRV297 EQU   CVTRV289                                                 01607000
CVTRV296 EQU   CVTRV289                                                 01608000
CVTRV295 EQU   CVTRV289                                                 01609000
CVTRV294 EQU   CVTRV289                                                 01610000
CVTRV293 EQU   CVTRV289                                                 01611000
CVTRV292 EQU   CVTRV289                                                 01612000
CVTRV291 EQU   CVTRV289                                                 01613000
CVTRV290 EQU   CVTRV289                                                 01614000
CVTRV288 EQU   CVTRV280                                                 01615000
CVTRV287 EQU   CVTRV280                                                 01616000
CVTRV286 EQU   CVTRV280                                                 01617000
CVTRV285 EQU   CVTRV280                                                 01618000
CVTRV284 EQU   CVTRV280                                                 01619000
CVTRV283 EQU   CVTRV280                                                 01620000
CVTRV282 EQU   CVTRV280                                                 01621000
CVTRV281 EQU   CVTRV280                                                 01622000
CVTRV279 EQU   CVTRV271                                                 01623000
CVTRV278 EQU   CVTRV271                                                 01624000
CVTRV277 EQU   CVTRV271                                                 01625000
CVTRV276 EQU   CVTRV271                                                 01626000
CVTRV275 EQU   CVTRV271                                                 01627000
CVTRV274 EQU   CVTRV271                                                 01628000
CVTRV273 EQU   CVTRV271                                                 01629000
CVTRV272 EQU   CVTRV271                                                 01630000
CVTRV270 EQU   CVTRV262                                                 01631000
CVTRV269 EQU   CVTRV262                                                 01632000
CVTRV268 EQU   CVTRV262                                                 01633000
CVTRV267 EQU   CVTRV262                                                 01634000
CVTRV266 EQU   CVTRV262                                                 01635000
CVTRV265 EQU   CVTRV262                                                 01636000
CVTRV264 EQU   CVTRV262                                                 01637000
CVTRV263 EQU   CVTRV262                                                 01638000
CVTVFP   EQU   CVTS01+464                                               01639000
CVTVSI   EQU   CVTS01+460                                               01640000
CVTVPSIB EQU   CVTS01+456                                               01641000
CVTMFACT EQU   CVTMFRTR                                                 01642000
CVTMFCTL EQU   CVTS01+448                                               01643000
CVTPVBP  EQU   CVTS01+444                                               01644000
CVTPWI   EQU   CVTS01+440                                               01645000
CVTRV254 EQU   CVTS01+438                                               01646000
CVTRV253 EQU   CVTS01+436                                               01647000
CVTRV252 EQU   CVTS01+434                                               01648000
CVTRV251 EQU   CVTS01+433                                               01649000
CVTRV250 EQU   CVTS01+432                                               01650000
CVTRV249 EQU   CVTS01+431                                               01651000
CVTRV248 EQU   CVTS01+430                                               01652000
CVTRV247 EQU   CVTS01+429                                               01653000
CVTRV246 EQU   CVTS01+428                                               01654000
CVTRV245 EQU   CVTRV237                                                 01655000
CVTRV244 EQU   CVTRV237                                                 01656000
CVTRV243 EQU   CVTRV237                                                 01657000
CVTRV242 EQU   CVTRV237                                                 01658000
CVTRV241 EQU   CVTRV237                                                 01659000
CVTRV240 EQU   CVTRV237                                                 01660000
CVTRV239 EQU   CVTRV237                                                 01661000
CVTRV238 EQU   CVTRV237                                                 01662000
CVTRV236 EQU   CVTRV228                                                 01663000
CVTRV235 EQU   CVTRV228                                                 01664000
CVTRV234 EQU   CVTRV228                                                 01665000
CVTRV233 EQU   CVTRV228                                                 01666000
CVTRV232 EQU   CVTRV228                                                 01667000
CVTRV231 EQU   CVTRV228                                                 01668000
CVTRV230 EQU   CVTRV228                                                 01669000
CVTRV229 EQU   CVTRV228                                                 01670000
CVTRV227 EQU   CVTRV219                                                 01671000
CVTRV226 EQU   CVTRV219                                                 01672000
CVTRV225 EQU   CVTRV219                                                 01673000
CVTRV224 EQU   CVTRV219                                                 01674000
CVTRV223 EQU   CVTRV219                                                 01675000
CVTRV222 EQU   CVTRV219                                                 01676000
CVTRV221 EQU   CVTRV219                                                 01677000
CVTRV220 EQU   CVTRV219                                                 01678000
CVTRV218 EQU   CVTRV210                                                 01679000
CVTRV217 EQU   CVTRV210                                                 01680000
CVTRV216 EQU   CVTRV210                                                 01681000
CVTRV215 EQU   CVTRV210                                                 01682000
CVTRV214 EQU   CVTRV210                                                 01683000
CVTRV213 EQU   CVTRV210                                                 01684000
CVTRV212 EQU   CVTRV210                                                 01685000
CVTRV211 EQU   CVTRV210                                                 01686000
CVTLCCAT EQU   CVTS01+420                                               01687000
CVTPCCAT EQU   CVTS01+416                                               01688000
CVTIPCRP EQU   CVTS01+412                                               01689000
CVTIPCRI EQU   CVTS01+408                                               01690000
CVTIPCDS EQU   CVTS01+404                                               01691000
CVTAIDVT EQU   CVTS01+400                                               01692000
CVTSSAP  EQU   CVTS01+396                                               01693000
CVTEHCIR EQU   CVTS01+392                                               01694000
CVTEHDEF EQU   CVTS01+388                                               01695000
CVTDAIR  EQU   CVTS01+384                                               01696000
CVTPERFM EQU   CVTS01+380                                               01697000
CVT044R2 EQU   CVTS01+376                                               01698000
CVTFETCH EQU   CVTS01+372                                               01699000
CVTRSTWD EQU   CVTS01+368                                               01700000
CVTSPOST EQU   CVTS01+364                                               01701000
CVTIOBP  EQU   CVTS01+360                                               01702000
CVTASMVT EQU   CVTS01+356                                               01703000
CVTRECRQ EQU   CVTS01+352                                               01704000
CVTWSAC  EQU   CVTS01+348                                               01705000
CVTRV149 EQU   CVTS01+344                                               01706000
CVTWSAL  EQU   CVTS01+340                                               01707000
CVTSPSA  EQU   CVTS01+336                                               01708000
CVTGLMN  EQU   CVTS01+332                                               01709000
CVTVEAC0 EQU   CVTS01+328                                               01710000
CVT062R1 EQU   CVTS01+324                                               01711000
CVTRPOST EQU   CVTS01+320                                               01712000
CVTDQIQE EQU   CVTS01+316                                               01713000
CVTCSD   EQU   CVTS01+312                                               01714000
CVTLKRMA EQU   CVTS01+308                                               01715000
CVTRSPIE EQU   CVTS01+304                                               01716000
CVTRENQ  EQU   CVTS01+300                                               01717000
CVTLQCB  EQU   CVTS01+296                                               01718000
CVTFQCB  EQU   CVTS01+292                                               01719000
CVTQCS01 EQU   CVTS01+288                                               01720000
CVTAPFT  EQU   CVTS01+284                                               01721000
CVTPARRL EQU   CVTS01+280                                               01722000
CVTVWAIT EQU   CVTS01+276                                               01723000
CVTGSPL  EQU   CVTS01+272                                               01724000
CVTLSMQ  EQU   CVTS01+268                                               01725000
CVTGSMQ  EQU   CVTS01+264                                               01726000
CVTEXPRO EQU   CVTS01+260                                               01727000
CVTOPCTP EQU   CVTS01+256                                               01728000
CVTSIC   EQU   CVTS01+252                                               01729000
CVTTPIOS EQU   CVTS01+248                                               01730000
CVTRTMS  EQU   CVTS01+244                                               01731000
CVTSDBF  EQU   CVTS01+240                                               01732000
CVTSCBP  EQU   CVTS01+236                                               01733000
CVTSDMP  EQU   CVTS01+232                                               01734000
CVTSV60  EQU   CVTS01+228                                               01735000
CVTRTMCT EQU   CVTS01+224                                               01736000
CVTGDA   EQU   CVTS01+212                                               01737000
CVTASVT  EQU   CVTS01+208                                               01738000
CVTVVMDI EQU   CVTS01+204                                               01739000
CVTAQTOP EQU   CVTS01+200                                               01740000
CVTIOSCS EQU   CVTS01+196                                               01741000
CVTSDRM  EQU   CVTS01+192                                               01742000
CVTOPTE  EQU   CVTS01+188                                               01743000
CVTSTXU  EQU   CVTS01+184                                               01744000
CVTQUIS  EQU   CVTS01+180                                               01745000
CVTPARS  EQU   CVTS01+176                                               01746000
CVTS1EE  EQU   CVTS01+172                                               01747000
CVTFRAS  EQU   CVTS01+168                                               01748000
CVTQSAS  EQU   CVTS01+164                                               01749000
CVTCRAS  EQU   CVTS01+160                                               01750000
CVTCRMN  EQU   CVTS01+156                                               01751000
CVTDELCP EQU   CVTS01+152                                               01752000
CVTFRECL EQU   CVTS01+148                                               01753000
CVTGETCL EQU   CVTS01+144                                               01754000
CVTBLDCP EQU   CVTS01+140                                               01755000
CVTAUTHL EQU   CVTS01+136                                               01756000
CVTSCAN  EQU   CVTS01+132                                               01757000
CVTRV144 EQU   CVTS01+130                                               01758000
CVTMAXMP EQU   CVTS01+128                                               01759000
CVTSTCK  EQU   CVTS01+124                                               01760000
CVTRV139 EQU   CVTS01+123                                               01761000
CVTDSSAC EQU   CVTS01+122                                               01762000
CVTRV513 EQU   CVTS01+121                                               01763000
CVTIOSPL EQU   CVTS01+120                                               01764000
CVTPTGT  EQU   CVTS01+116                                               01765000
CVTCSPIE EQU   CVTS01+112                                               01766000
CVTSMFEX EQU   CVTS01+108                                               01767000
CVTOLT0A EQU   CVTS01+104                                               01768000
CVTSRBRT EQU   CVTS01+100                                               01769000
CVTPUTL  EQU   CVTS01+96                                                01770000
CVTRV519 EQU   CVTS01+92                                                01771000
CVTRV327 EQU   CVTS01+88                                                01772000
CVTRV326 EQU   CVTS01+84                                                01773000
CVTRV325 EQU   CVTS01+80                                                01774000
CVTRV324 EQU   CVTS01+76                                                01775000
CVT0VL01 EQU   CVTS01+72                                                01776000
CVTSHRVM EQU   CVTS01+68                                                01777000
CVTRV332 EQU   CVTS01+64                                                01778000
CVTTAS   EQU   CVTS01+60                                                01779000
CVTRSCN  EQU   CVTS01+56                                                01780000
CVTTRAC2 EQU   CVTS01+54                                                01781000
CVTTRACE EQU   CVTS01+52                                                01782000
CVTAPG   EQU   CVTS01+51                                                01783000
CVTSDTRC EQU   CVTCTLFG                                                 01784000
CVTGTRCE EQU   CVTCTLFG                                                 01785000
CVTNOMP  EQU   CVTCTLFG                                                 01786000
CVTRSV79 EQU   CVTCTLFG                                                 01787000
CVTDSTAT EQU   CVTCTLFG                                                 01788000
CVTRSV78 EQU   CVTCTLFG                                                 01789000
CVTRV333 EQU   CVTCTLFG                                                 01790000
CVTRV323 EQU   CVTCTLFG                                                 01791000
CVTSPVLK EQU   CVTS01+49                                                01792000
CVTRSV77 EQU   CVTS01+48                                                01793000
CVTRV331 EQU   CVTS01+44                                                01794000
CVTRV330 EQU   CVTS01+40                                                01795000
CVTRV329 EQU   CVTS01+36                                                01796000
CVTRV328 EQU   CVTS01+32                                                01797000
CVTRV322 EQU   CVTS01+28                                                01798000
CVTSLID  EQU   CVTSLIDA+1                                               01799000
CVTSYLK  EQU   CVTSLIDA                                                 01800000
CVTRV321 EQU   CVTS01+20                                                01801000
CVTRV320 EQU   CVTS01+16                                                01802000
CVTLPDIR EQU   CVTLPDIA+1                                               01803000
CVTRSV69 EQU   CVTDIRST                                                 01804000
CVTRSV68 EQU   CVTDIRST                                                 01805000
CVTRSV67 EQU   CVTDIRST                                                 01806000
CVTRSV66 EQU   CVTDIRST                                                 01807000
CVTRSV65 EQU   CVTDIRST                                                 01808000
CVTRSV64 EQU   CVTDIRST                                                 01809000
CVTRSV63 EQU   CVTDIRST                                                 01810000
CVTDICOM EQU   CVTDIRST                                                 01811000
CVTPVTP  EQU   CVTS01+8                                                 01812000
CVTLPDSR EQU   CVTS01+4                                                 01813000
CVTGETL  EQU   CVTS01                                                   01814000
PSARSAV  EQU   PSARSVTE+60                                              01815000
PSARSTK  EQU   PSARSVTE+56                                              01816000
PSAESAV3 EQU   PSARSVTE+52                                              01817000
PSAESTK3 EQU   PSARSVTE+48                                              01818000
PSAESAV2 EQU   PSARSVTE+44                                              01819000
PSAESTK2 EQU   PSARSVTE+40                                              01820000
PSAESAV1 EQU   PSARSVTE+36                                              01821000
PSAESTK1 EQU   PSARSVTE+32                                              01822000
PSAPSAV  EQU   PSARSVTE+28                                              01823000
PSAPSTK  EQU   PSARSVTE+24                                              01824000
PSAMSAV  EQU   PSARSVTE+20                                              01825000
PSAMSTK  EQU   PSARSVTE+16                                              01826000
PSASSAV  EQU   PSARSVTE+12                                              01827000
PSASSTK  EQU   PSARSVTE+8                                               01828000
PSANSTK  EQU   PSARSVTE+4                                               01829000
PSACSTK  EQU   PSARSVTE                                                 01830000
DSPS$E14 EQU   DSPSAVEA+24                                              01831000
DSPS$E13 EQU   DSPSAVEA+20                                              01832000
DSPS$E12 EQU   DSPSAVEA+16                                              01833000
DSPS$E11 EQU   DSPSAVEA+12                                              01834000
DSPS$E10 EQU   DSPSAVEA+8                                               01835000
DSPSAVE9 EQU   DSPSAVEA+4                                               01836000
DSPSAVE8 EQU   DSPSAVEA                                                 01837000
ACSAVE1  EQU   ACSAVE01+4                                               01838000
@NM00081 EQU   ACSAVE0                                                  01839000
@NM00080 EQU   ACSAVE15+2                                               01840000
ACSAVE14 EQU   ACSAVEA+24                                               01841000
ACSAVE12 EQU   ACSAVEA+16                                               01842000
ACSAVE11 EQU   ACSAVEA+12                                               01843000
ACSAVE10 EQU   ACSAVEA+8                                                01844000
ACSAVE9  EQU   ACSAVEA+4                                                01845000
ACSAVE8  EQU   ACSAVEA                                                  01846000
@NM00079 EQU   FRR6WORD+4                                               01847000
@NM00078 EQU   FRR6WD1+1                                                01848000
QVPARMS  EQU   FRRWORKA                                                 01849000
@NM00077 EQU   MOVEBITS                                                 01850000
@NM00076 EQU   SDWA+512                                                 01851000
SDWAVRA  EQU   SDWARA+4                                                 01852000
SDWAURAL EQU   SDWARA+3                                                 01853000
@NM00075 EQU   SDWADPVA                                                 01854000
SDWAEBC  EQU   SDWADPVA                                                 01855000
SDWAHEX  EQU   SDWADPVA                                                 01856000
SDWAVRAL EQU   SDWARA                                                   01857000
@NM00074 EQU   SDWA+396                                                 01858000
SDWACOMP EQU   SDWA+392                                                 01859000
SDWARCPL EQU   SDWA+364                                                 01860000
@NM00073 EQU   SDWADPSA+32                                              01861000
SDWATO4  EQU   SDWADPSL+28                                              01862000
SDWAFRM4 EQU   SDWADPSL+24                                              01863000
SDWATO3  EQU   SDWADPSL+20                                              01864000
SDWAFRM3 EQU   SDWADPSL+16                                              01865000
SDWATO2  EQU   SDWADPSL+12                                              01866000
SDWAFRM2 EQU   SDWADPSL+8                                               01867000
SDWATO1  EQU   SDWADPSL+4                                               01868000
SDWAFRM1 EQU   SDWADPSL                                                 01869000
@NM00072 EQU   SDWADDAT+3                                               01870000
@NM00071 EQU   SDWAPDAT                                                 01871000
SDWAUSPL EQU   SDWAPDAT                                                 01872000
SDWADPSW EQU   SDWAPDAT                                                 01873000
SDWATJPA EQU   SDWAPDAT                                                 01874000
SDWATLPA EQU   SDWAPDAT                                                 01875000
SDWADREG EQU   SDWAPDAT                                                 01876000
SDWADSAH EQU   SDWAPDAT                                                 01877000
SDWADSAS EQU   SDWAPDAT                                                 01878000
@NM00070 EQU   SDWADDAT+1                                               01879000
@NM00069 EQU   SDWASDAT                                                 01880000
SDWAQQS  EQU   SDWASDAT                                                 01881000
SDWACBS  EQU   SDWASDAT                                                 01882000
SDWAGTF  EQU   SDWASDAT                                                 01883000
SDWASWA  EQU   SDWASDAT                                                 01884000
SDWALSQA EQU   SDWASDAT                                                 01885000
SDWASQA  EQU   SDWASDAT                                                 01886000
SDWANUC  EQU   SDWASDAT                                                 01887000
@NM00068 EQU   SDWADUMP+2                                               01888000
@NM00067 EQU   SDWADPFS                                                 01889000
SDWASLST EQU   SDWADPFS                                                 01890000
@NM00066 EQU   SDWADPFS                                                 01891000
SDWADLST EQU   SDWADPFS                                                 01892000
SDWADPT  EQU   SDWADPFS                                                 01893000
SDWADPID EQU   SDWADUMP                                                 01894000
SDWADPLA EQU   SDWA+316                                                 01895000
SDWAREXN EQU   SDWARECP+16                                              01896000
SDWACSCT EQU   SDWARECP+8                                               01897000
SDWAMODN EQU   SDWARECP                                                 01898000
@NM00065 EQU   SDWALKWA+32                                              01899000
SDWATALW EQU   SDWALKWS+28                                              01900000
SDWATDLW EQU   SDWALKWS+24                                              01901000
SDWATNLW EQU   SDWALKWS+20                                              01902000
SDWAAPLW EQU   SDWALKWS+16                                              01903000
SDWAIPLW EQU   SDWALKWS+12                                              01904000
SDWAILLW EQU   SDWALKWS+8                                               01905000
SDWAIULW EQU   SDWALKWS+4                                               01906000
SDWAICLW EQU   SDWALKWS                                                 01907000
SDWAFLLK EQU   SDWAACF4                                                 01908000
SDWACMS  EQU   SDWAACF4                                                 01909000
SDWAOPTM EQU   SDWAACF4                                                 01910000
SDWATADB EQU   SDWAACF4                                                 01911000
SDWATDNB EQU   SDWAACF4                                                 01912000
SDWATNCB EQU   SDWAACF4                                                 01913000
SDWAILCH EQU   SDWAACF4                                                 01914000
SDWAIUCB EQU   SDWAACF4                                                 01915000
SDWAICAT EQU   SDWAACF3                                                 01916000
SDWAIPRG EQU   SDWAACF3                                                 01917000
SDWASALL EQU   SDWAACF3                                                 01918000
SDWAASMP EQU   SDWAACF3                                                 01919000
SDWADISP EQU   SDWAACF3                                                 01920000
@NM00064 EQU   SDWAACF3                                                 01921000
@NM00063 EQU   SDWAACF2                                                 01922000
SDWAFREE EQU   SDWAACF2                                                 01923000
SDWAUPRG EQU   SDWAACF2                                                 01924000
@NM00062 EQU   SDWAACF2                                                 01925000
SDWASPIN EQU   SDWAACF2                                                 01926000
@NM00061 EQU   SDWAACF2                                                 01927000
SDWALCPU EQU   SDWACPUA+2                                               01928000
@NM00060 EQU   SDWACPUA                                                 01929000
SDWARECA EQU   SDWA+244                                                 01930000
SDWARTYA EQU   SDWA+240                                                 01931000
@NM00059 EQU   SDWA+239                                                 01932000
@NM00058 EQU   SDWAIOFS                                                 01933000
SDWANIOP EQU   SDWAIOFS                                                 01934000
SDWANOIO EQU   SDWAIOFS                                                 01935000
SDWAIOHT EQU   SDWAIOFS                                                 01936000
SDWAIOQR EQU   SDWAIOFS                                                 01937000
SDWAFMID EQU   SDWA+236                                                 01938000
@NM00057 EQU   SDWAERRD                                                 01939000
SDWAMCIV EQU   SDWAERRD                                                 01940000
SDWARPIV EQU   SDWAERRD                                                 01941000
SDWAMABD EQU   SDWAERRD                                                 01942000
SDWACTS  EQU   SDWAERRD                                                 01943000
SDWASTAE EQU   SDWAERRD                                                 01944000
SDWANRBE EQU   SDWAERRD                                                 01945000
SDWACLUP EQU   SDWAERRD                                                 01946000
@NM00056 EQU   SDWAERRC                                                 01947000
SDWAEAS  EQU   SDWAERRC                                                 01948000
SDWAPERC EQU   SDWAERRC                                                 01949000
SDWAIRB  EQU   SDWAERRC                                                 01950000
SDWASTAI EQU   SDWAERRC                                                 01951000
SDWASTAF EQU   SDWAERRC                                                 01952000
SDWASRBM EQU   SDWAERRB                                                 01953000
SDWALDIS EQU   SDWAERRB                                                 01954000
SDWAENRB EQU   SDWAERRB                                                 01955000
SDWATYP1 EQU   SDWAERRB                                                 01956000
@NM00055 EQU   SDWAERRB                                                 01957000
SDWAPGIO EQU   SDWAERRA                                                 01958000
SDWATEXC EQU   SDWAERRA                                                 01959000
SDWASVCE EQU   SDWAERRA                                                 01960000
SDWAABTM EQU   SDWAERRA                                                 01961000
SDWASVCD EQU   SDWAERRA                                                 01962000
SDWARKEY EQU   SDWAERRA                                                 01963000
SDWAPCHK EQU   SDWAERRA                                                 01964000
SDWAMCHK EQU   SDWAERRA                                                 01965000
SDWATIME EQU   SDWAMCH+20                                               01966000
SDWARFSA EQU   SDWAMCH+16                                               01967000
@NM00054 EQU   SDWAMCH+14                                               01968000
SDWAVEQR EQU   SDWARSR2                                                 01969000
SDWAPGFX EQU   SDWARSR2                                                 01970000
SDWAFLSQ EQU   SDWARSR2                                                 01971000
SDWAFSQA EQU   SDWARSR2                                                 01972000
SDWANUCL EQU   SDWARSR2                                                 01973000
SDWASPER EQU   SDWARSR2                                                 01974000
SDWAINTC EQU   SDWARSR2                                                 01975000
SDWAOFLN EQU   SDWARSR2                                                 01976000
SDWACHNG EQU   SDWARSR1                                                 01977000
SDWAMSER EQU   SDWARSR1                                                 01978000
@NM00053 EQU   SDWARSR1                                                 01979000
SDWACPID EQU   SDWAMCH+10                                               01980000
SDWATERR EQU   SDWAMCHD                                                 01981000
SDWAFPRX EQU   SDWAMCHD                                                 01982000
SDWAINSF EQU   SDWAMCHD                                                 01983000
SDWAACR  EQU   SDWAMCHD                                                 01984000
SDWASCK  EQU   SDWAMCHD                                                 01985000
SDWAPSWU EQU   SDWAMCHD                                                 01986000
SDWAREGU EQU   SDWAMCHD                                                 01987000
SDWASKYF EQU   SDWAMCHD                                                 01988000
@NM00052 EQU   SDWAMCHS                                                 01989000
SDWARSRF EQU   SDWAMCHS                                                 01990000
SDWARSRC EQU   SDWAMCHS                                                 01991000
SDWAINVP EQU   SDWAMCHS                                                 01992000
SDWATSVL EQU   SDWAMCHS                                                 01993000
SDWARCDF EQU   SDWAMCHS                                                 01994000
SDWASRVL EQU   SDWAMCHS                                                 01995000
SDWASCKE EQU   SDWASTCK+4                                               01996000
SDWASCKB EQU   SDWASTCK                                                 01997000
SDWALNTH EQU   SDWAIDNT+1                                               01998000
SDWASPID EQU   SDWAIDNT                                                 01999000
SDWASR15 EQU   SDWASRSV+60                                              02000000
SDWASR14 EQU   SDWASRSV+56                                              02001000
SDWASR13 EQU   SDWASRSV+52                                              02002000
SDWASR12 EQU   SDWASRSV+48                                              02003000
SDWASR11 EQU   SDWASRSV+44                                              02004000
SDWASR10 EQU   SDWASRSV+40                                              02005000
SDWASR09 EQU   SDWASRSV+36                                              02006000
SDWASR08 EQU   SDWASRSV+32                                              02007000
SDWASR07 EQU   SDWASRSV+28                                              02008000
SDWASR06 EQU   SDWASRSV+24                                              02009000
SDWASR05 EQU   SDWASRSV+20                                              02010000
SDWASR04 EQU   SDWASRSV+16                                              02011000
SDWASR03 EQU   SDWASRSV+12                                              02012000
SDWASR02 EQU   SDWASRSV+8                                               02013000
SDWASR01 EQU   SDWASRSV+4                                               02014000
SDWASR00 EQU   SDWASRSV                                                 02015000
SDWATRN2 EQU   SDWAAEC2+4                                               02016000
SDWAIPC2 EQU   SDWAICD2                                                 02017000
SDWAIMC2 EQU   SDWAICD2                                                 02018000
SDWAIPR2 EQU   SDWAICD2                                                 02019000
@NM00051 EQU   SDWAINC2                                                 02020000
@NM00050 EQU   SDWAILC2                                                 02021000
SDWAIL2  EQU   SDWAILC2                                                 02022000
@NM00049 EQU   SDWAILC2                                                 02023000
@NM00048 EQU   SDWAAEC2                                                 02024000
SDWAADD2 EQU   SDWANXT2+1                                               02025000
@NM00047 EQU   SDWANXT2                                                 02026000
@NM00046 EQU   SDWAEC2+3                                                02027000
SDWASGN2 EQU   SDWAINT2                                                 02028000
SDWAEXP2 EQU   SDWAINT2                                                 02029000
SDWADEC2 EQU   SDWAINT2                                                 02030000
SDWAFPO2 EQU   SDWAINT2                                                 02031000
SDWACC2  EQU   SDWAINT2                                                 02032000
@NM00045 EQU   SDWAINT2                                                 02033000
SDWAPGM2 EQU   SDWAMWP2                                                 02034000
SDWAWAT2 EQU   SDWAMWP2                                                 02035000
SDWAMCK2 EQU   SDWAMWP2                                                 02036000
SDWAECT2 EQU   SDWAMWP2                                                 02037000
SDWAKEY2 EQU   SDWAMWP2                                                 02038000
SDWAEXT2 EQU   SDWAEMK2                                                 02039000
SDWAIO2  EQU   SDWAEMK2                                                 02040000
SDWATRM2 EQU   SDWAEMK2                                                 02041000
@NM00044 EQU   SDWAEMK2                                                 02042000
SDWAPER2 EQU   SDWAEMK2                                                 02043000
@NM00043 EQU   SDWAEMK2                                                 02044000
SDWATRAN EQU   SDWAAEC1+4                                               02045000
SDWAIPC1 EQU   SDWAICD1                                                 02046000
SDWAIMC1 EQU   SDWAICD1                                                 02047000
SDWAIPR1 EQU   SDWAICD1                                                 02048000
@NM00042 EQU   SDWAINC1                                                 02049000
@NM00041 EQU   SDWAILC1                                                 02050000
SDWAIL1  EQU   SDWAILC1                                                 02051000
@NM00040 EQU   SDWAILC1                                                 02052000
@NM00039 EQU   SDWAAEC1                                                 02053000
SDWAADD1 EQU   SDWANXT1+1                                               02054000
@NM00038 EQU   SDWANXT1                                                 02055000
@NM00037 EQU   SDWAEC1+3                                                02056000
SDWASGN1 EQU   SDWAINT1                                                 02057000
SDWAEXP1 EQU   SDWAINT1                                                 02058000
SDWADEC1 EQU   SDWAINT1                                                 02059000
SDWAFPO1 EQU   SDWAINT1                                                 02060000
SDWACC1  EQU   SDWAINT1                                                 02061000
@NM00036 EQU   SDWAINT1                                                 02062000
SDWAPGM1 EQU   SDWAMWP1                                                 02063000
SDWAWAT1 EQU   SDWAMWP1                                                 02064000
SDWAMCK1 EQU   SDWAMWP1                                                 02065000
SDWAECT1 EQU   SDWAMWP1                                                 02066000
SDWAKEY1 EQU   SDWAMWP1                                                 02067000
SDWAEXT1 EQU   SDWAEMK1                                                 02068000
SDWAIO1  EQU   SDWAEMK1                                                 02069000
SDWATRM1 EQU   SDWAEMK1                                                 02070000
@NM00035 EQU   SDWAEMK1                                                 02071000
SDWAPER1 EQU   SDWAEMK1                                                 02072000
@NM00034 EQU   SDWAEMK1                                                 02073000
SDWAIOBR EQU   SDWA+100                                                 02074000
SDWAEPA  EQU   SDWA+96                                                  02075000
@NM00033 EQU   SDWANAME+4                                               02076000
SDWARBAD EQU   SDWANAME                                                 02077000
SDWAGR15 EQU   SDWAGRSV+60                                              02078000
SDWAGR14 EQU   SDWAGRSV+56                                              02079000
SDWAGR13 EQU   SDWAGRSV+52                                              02080000
SDWAGR12 EQU   SDWAGRSV+48                                              02081000
SDWAGR11 EQU   SDWAGRSV+44                                              02082000
SDWAGR10 EQU   SDWAGRSV+40                                              02083000
SDWAGR09 EQU   SDWAGRSV+36                                              02084000
SDWAGR08 EQU   SDWAGRSV+32                                              02085000
SDWAGR07 EQU   SDWAGRSV+28                                              02086000
SDWAGR06 EQU   SDWAGRSV+24                                              02087000
SDWAGR05 EQU   SDWAGRSV+20                                              02088000
SDWAGR04 EQU   SDWAGRSV+16                                              02089000
SDWAGR03 EQU   SDWAGRSV+12                                              02090000
SDWAGR02 EQU   SDWAGRSV+8                                               02091000
SDWAGR01 EQU   SDWAGRSV+4                                               02092000
SDWAGR00 EQU   SDWAGRSV                                                 02093000
SDWANXTP EQU   SDWACTL2+5                                               02094000
SDWASGP  EQU   SDWAPMKP                                                 02095000
SDWAEUP  EQU   SDWAPMKP                                                 02096000
SDWADOP  EQU   SDWAPMKP                                                 02097000
SDWAFPP  EQU   SDWAPMKP                                                 02098000
SDWACCP  EQU   SDWAPMKP                                                 02099000
SDWAILP  EQU   SDWAPMKP                                                 02100000
SDWAINTP EQU   SDWACTL2+2                                               02101000
SDWASPVP EQU   SDWAMWPP                                                 02102000
SDWAWATP EQU   SDWAMWPP                                                 02103000
SDWAMCKP EQU   SDWAMWPP                                                 02104000
@NM00032 EQU   SDWAMWPP                                                 02105000
SDWAKEYP EQU   SDWAMWPP                                                 02106000
SDWAEXTP EQU   SDWACMKP                                                 02107000
SDWAIOP  EQU   SDWACMKP                                                 02108000
SDWANXTA EQU   SDWACTL1+5                                               02109000
SDWASGA  EQU   SDWAPMKA                                                 02110000
SDWAEUA  EQU   SDWAPMKA                                                 02111000
SDWADOA  EQU   SDWAPMKA                                                 02112000
SDWAFPA  EQU   SDWAPMKA                                                 02113000
SDWACCA  EQU   SDWAPMKA                                                 02114000
SDWAILA  EQU   SDWAPMKA                                                 02115000
SDWAINTA EQU   SDWACTL1+2                                               02116000
SDWASPVA EQU   SDWAMWPA                                                 02117000
SDWAWATA EQU   SDWAMWPA                                                 02118000
SDWAMCKA EQU   SDWAMWPA                                                 02119000
@NM00031 EQU   SDWAMWPA                                                 02120000
SDWAKEYA EQU   SDWAMWPA                                                 02121000
SDWAEXTA EQU   SDWACMKA                                                 02122000
SDWAIOA  EQU   SDWACMKA                                                 02123000
SDWACMPC EQU   SDWAABCC+1                                               02124000
@NM00030 EQU   SDWACMPF                                                 02125000
SDWASTCC EQU   SDWACMPF                                                 02126000
@NM00029 EQU   SDWACMPF                                                 02127000
SDWASTEP EQU   SDWACMPF                                                 02128000
SDWAREQ  EQU   SDWACMPF                                                 02129000
FRRSPARM EQU   FRRSENTR+8                                               02130000
@NM00028 EQU   FRRSFLGS+1                                               02131000
@NM00027 EQU   FRRSFLG1                                                 02132000
FRRSNEST EQU   FRRSFLG1                                                 02133000
FRRSRCUR EQU   FRRSFLG1                                                 02134000
FRRSFRRA EQU   FRRSENTR                                                 02135000
FRRSENTS EQU   FRRS+84                                                  02136000
FRRSRTMW EQU   FRRS+16                                                  02137000
FRRSCURR EQU   FRRSHEAD+12                                              02138000
FRRSELEN EQU   FRRSHEAD+8                                               02139000
FRRSLAST EQU   FRRSHEAD+4                                               02140000
FRRSEMP  EQU   FRRSHEAD                                                 02141000
QVPLFELM EQU   QVPLTYP2+36                                              02142000
QVPLRES4 EQU   QVPLFLGB                                                 02143000
QVPLBP3  EQU   QVPLFLGB                                                 02144000
QVPLRES3 EQU   QVPLFLGT                                                 02145000
QVPLTR3  EQU   QVPLFLGT                                                 02146000
QVPLLELM EQU   QVPLTYP1+24                                              02147000
QVPLRES2 EQU   QVPLFLGF                                                 02148000
QVPLFP3  EQU   QVPLFLGF                                                 02149000
QVPLRES1 EQU   QVPLFLGH                                                 02150000
QVPLHD3  EQU   QVPLFLGH                                                 02151000
QVPLNOEL EQU   QVPLTYP1+12                                              02152000
WSACCCH  EQU   WSAC+52                                                  02153000
WSACRRSA EQU   WSAC+48                                                  02154000
WSACREST EQU   WSAC+44                                                  02155000
WSACRSTI EQU   WSAC+40                                                  02156000
WSACABTM EQU   WSAC+36                                                  02157000
WSACMF1  EQU   WSAC+32                                                  02158000
WSACIOS  EQU   WSAC+24                                                  02159000
WSACRTMK EQU   WSAC+20                                                  02160000
WSACTIME EQU   WSAC+12                                                  02161000
WSACOPTM EQU   WSAC+8                                                   02162000
WSACGTF  EQU   WSAC+4                                                   02163000
WSACCWSA EQU   WSAC                                                     02164000
ASCBEND  EQU   ASCB+208                                                 02165000
ASCBSRBT EQU   ASCB+200                                                 02166000
ASCBSWTL EQU   ASCB+196                                                 02167000
ASCBRS14 EQU   ASCB+195                                                 02168000
ASCBSMCT EQU   ASCB+194                                                 02169000
ASCBRS12 EQU   ASCB+192                                                 02170000
ASCBPCTT EQU   ASCB+188                                                 02171000
ASCBVGTT EQU   ASCB+184                                                 02172000
ASCBLGCB EQU   ASCB+180                                                 02173000
ASCBJBNS EQU   ASCB+176                                                 02174000
ASCBJBNI EQU   ASCB+172                                                 02175000
ASCBMCC  EQU   ASCB+168                                                 02176000
ASCBRTWA EQU   ASCB+164                                                 02177000
ASCBIQEA EQU   ASCB+160                                                 02178000
ASCBXMPQ EQU   ASCB+156                                                 02179000
ASCBRS01 EQU   ASCB+154                                                 02180000
ASCBFMCT EQU   ASCB+152                                                 02181000
ASCBOUXB EQU   ASCB+148                                                 02182000
ASCBOUCB EQU   ASCB+144                                                 02183000
ASCBMECB EQU   ASCB+140                                                 02184000
ASCBQECB EQU   ASCB+136                                                 02185000
ASCBCMSB EQU   ASCB+132                                                 02186000
ASCBCMSF EQU   ASCB+128                                                 02187000
ASCBTCBS EQU   ASCB+124                                                 02188000
ASCBNVSC EQU   ASCB+122                                                 02189000
ASCBVSC  EQU   ASCB+120                                                 02190000
ASCBSRBS EQU   ASCB+118                                                 02191000
ASCBSSRB EQU   ASCB+116                                                 02192000
ASCBRV06 EQU   ASCBFLG2                                                 02193000
ASCBRV05 EQU   ASCBFLG2                                                 02194000
ASCBRV04 EQU   ASCBFLG2                                                 02195000
ASCBSNQS EQU   ASCBFLG2                                                 02196000
ASCBS2S  EQU   ASCBFLG2                                                 02197000
ASCBCEXT EQU   ASCBFLG2                                                 02198000
ASCBPXMT EQU   ASCBFLG2                                                 02199000
ASCBXMPT EQU   ASCBFLG2                                                 02200000
ASCBRF07 EQU   ASCBDSP1                                                 02201000
ASCBRF06 EQU   ASCBDSP1                                                 02202000
ASCBRF05 EQU   ASCBDSP1                                                 02203000
ASCBRF04 EQU   ASCBDSP1                                                 02204000
ASCBRF03 EQU   ASCBDSP1                                                 02205000
ASCBRF02 EQU   ASCBDSP1                                                 02206000
ASCBFAIL EQU   ASCBDSP1                                                 02207000
ASCBSWCT EQU   ASCB+112                                                 02208000
ASCBASXB EQU   ASCB+108                                                 02209000
ASCBTMCH EQU   ASCB+104                                                 02210000
ASCBNSWP EQU   ASCBFLG1                                                 02211000
ASCBTYP1 EQU   ASCBFLG1                                                 02212000
ASCBSTND EQU   ASCBFLG1                                                 02213000
ASCBABNT EQU   ASCBFLG1                                                 02214000
ASCBTERM EQU   ASCBFLG1                                                 02215000
ASCBS3S  EQU   ASCBFLG1                                                 02216000
ASCBCMSH EQU   ASCBFLG1                                                 02217000
ASCBTOFF EQU   ASCBFLG1                                                 02218000
ASCBRF01 EQU   ASCBRCTF                                                 02219000
ASCBTMLW EQU   ASCBRCTF                                                 02220000
ASCBOUT  EQU   ASCBRCTF                                                 02221000
ASCBWAIT EQU   ASCBRCTF                                                 02222000
ASCBRV08 EQU   ASCBRCTF                                                 02223000
ASCBFQU  EQU   ASCBRCTF                                                 02224000
ASCBFRS  EQU   ASCBRCTF                                                 02225000
ASCBTMNO EQU   ASCBRCTF                                                 02226000
ASCBAFFN EQU   ASCBFW1                                                  02227000
ASCBDUMP EQU   ASCB+96                                                  02228000
ASCBQSVC EQU   ASCB+92                                                  02229000
ASCBUBET EQU   ASCB+88                                                  02230000
ASCBECB  EQU   ASCB+84                                                  02231000
ASCBJSTL EQU   ASCB+80                                                  02232000
ASCBEWST EQU   ASCB+72                                                  02233000
ASCBEJST EQU   ASCB+64                                                  02234000
ASCBTSB  EQU   ASCB+60                                                  02235000
ASCBCSCB EQU   ASCB+56                                                  02236000
ASCBRSM  EQU   ASCB+52                                                  02237000
ASCBLDA  EQU   ASCB+48                                                  02238000
ASCBSTOR EQU   ASCB+44                                                  02239000
ASCBRV07 EQU   ASCB+42                                                  02240000
ASCBIOSM EQU   ASCB+40                                                  02241000
ASCBASID EQU   ASCB+36                                                  02242000
ASCBSPL  EQU   ASCB+28                                                  02243000
ASCBLSLQ EQU   ASCB+24                                                  02244000
ASCBFSLQ EQU   ASCB+20                                                  02245000
ASCBIOSP EQU   ASCB+16                                                  02246000
ASCBLOCK EQU   ASCB+12                                                  02247000
ASCBASCB EQU   ASCB                                                     02248000
ASCBEGIN EQU   ASCB                                                     02249000
LCCAR125 EQU   LCCA+964                                                 02250000
LCCAR124 EQU   LCCA+960                                                 02251000
LCCAR123 EQU   LCCA+956                                                 02252000
LCCAR122 EQU   LCCA+952                                                 02253000
LCCAR121 EQU   LCCA+948                                                 02254000
LCCAR120 EQU   LCCA+944                                                 02255000
LCCAR119 EQU   LCCA+940                                                 02256000
LCCAR118 EQU   LCCA+936                                                 02257000
LCCAR117 EQU   LCCA+932                                                 02258000
LCCAR116 EQU   LCCA+928                                                 02259000
LCCAR115 EQU   LCCA+924                                                 02260000
LCCAR114 EQU   LCCA+920                                                 02261000
LCCAR113 EQU   LCCA+916                                                 02262000
LCCAR112 EQU   LCCA+912                                                 02263000
LCCAR111 EQU   LCCA+908                                                 02264000
LCCAR110 EQU   LCCA+904                                                 02265000
LCCAR109 EQU   LCCA+900                                                 02266000
LCCAR108 EQU   LCCA+896                                                 02267000
LCCADRT2 EQU   LCCA+888                                                 02268000
LCCADRT1 EQU   LCCA+880                                                 02269000
LCCAR103 EQU   LCCA+876                                                 02270000
LCCAESS2 EQU   LCCA+872                                                 02271000
LCCASPLJ EQU   LCCA+868                                                 02272000
LCCASMQJ EQU   LCCA+864                                                 02273000
LCCAIRT  EQU   LCCA+736                                                 02274000
LCCARV90 EQU   LCCA+732                                                 02275000
LCCARV89 EQU   LCCA+728                                                 02276000
LCCAPGTA EQU   LCCASRBF+2                                               02277000
LCCASAFN EQU   LCCASRBF                                                 02278000
LCCAECSA EQU   LCCA+716                                                 02279000
LCCAICR0 EQU   LCCA+712                                                 02280000
LCCALWTM EQU   LCCA+704                                                 02281000
LCCARV78 EQU   LCCA+700                                                 02282000
LCCAPINV EQU   LCCA+696                                                 02283000
LCCARV88 EQU   LCCA+695                                                 02284000
LCCARV87 EQU   LCCALKFG                                                 02285000
LCCARV86 EQU   LCCALKFG                                                 02286000
LCCARV85 EQU   LCCALKFG                                                 02287000
LCCARV84 EQU   LCCALKFG                                                 02288000
LCCALKRD EQU   LCCALKFG                                                 02289000
LCCALKAQ EQU   LCCALKFG                                                 02290000
LCCALKSA EQU   LCCALKFG                                                 02291000
LCCALKDP EQU   LCCALKFG                                                 02292000
LCCACRST EQU   LCCACREX                                                 02293000
LCCACRDP EQU   LCCACREX                                                 02294000
LCCACRLM EQU   LCCACREX                                                 02295000
LCCACRIN EQU   LCCACREX                                                 02296000
LCCACRRT EQU   LCCACREX                                                 02297000
LCCACRLE EQU   LCCACREX                                                 02298000
LCCACRRM EQU   LCCACREX                                                 02299000
LCCACREF EQU   LCCACREX                                                 02300000
LCCAVARY EQU   LCCACRFL                                                 02301000
LCCARV73 EQU   LCCACRFL                                                 02302000
LCCARV72 EQU   LCCACRFL                                                 02303000
LCCARV71 EQU   LCCACRFL                                                 02304000
LCCARV70 EQU   LCCACRFL                                                 02305000
LCCARV69 EQU   LCCACRFL                                                 02306000
LCCACLMS EQU   LCCACRFL                                                 02307000
LCCACRTM EQU   LCCACRFL                                                 02308000
LCCALCR0 EQU   LCCA+688                                                 02309000
LCCACRLC EQU   LCCA+684                                                 02310000
LCCARCPU EQU   LCCA+680                                                 02311000
LCCADCPU EQU   LCCA+676                                                 02312000
LCCASRBJ EQU   LCCA+672                                                 02313000
LCCADSSR EQU   LCCA+668                                                 02314000
LCCADSSC EQU   LCCA+660                                                 02315000
LCCADSS3 EQU   LCCA+648                                                 02316000
LCCADSS2 EQU   LCCA+636                                                 02317000
LCCADSS1 EQU   LCCA+624                                                 02318000
LCCAWTIM EQU   LCCA+616                                                 02319000
LCCAITOD EQU   LCCA+608                                                 02320000
LCCADTOD EQU   LCCA+600                                                 02321000
LCCASTOD EQU   LCCA+592                                                 02322000
LCCARIR5 EQU   LCCASPSA+44                                              02323000
LCCARIR4 EQU   LCCASPSA+40                                              02324000
LCCARIR3 EQU   LCCASPSA+36                                              02325000
LCCARIR2 EQU   LCCASPSA+32                                              02326000
LCCARPR5 EQU   LCCASPSA+28                                              02327000
LCCARPR4 EQU   LCCASPSA+24                                              02328000
LCCARPR3 EQU   LCCASPSA+20                                              02329000
LCCARPR2 EQU   LCCASPSA+16                                              02330000
LCCADSR5 EQU   LCCASPSA+12                                              02331000
LCCADSR4 EQU   LCCASPSA+8                                               02332000
LCCADSR3 EQU   LCCASPSA+4                                               02333000
LCCADSR2 EQU   LCCASPSA                                                 02334000
LCCARV68 EQU   LCCA+543                                                 02335000
LCCAPSMK EQU   LCCA+542                                                 02336000
LCCARV67 EQU   LCCADSF2                                                 02337000
LCCARV66 EQU   LCCADSF2                                                 02338000
LCCARV65 EQU   LCCADSF2                                                 02339000
LCCARV64 EQU   LCCADSF2                                                 02340000
LCCADSRW EQU   LCCADSF2                                                 02341000
LCCADSPL EQU   LCCADSF2                                                 02342000
LCCAGSRB EQU   LCCADSF2                                                 02343000
LCCASRBM EQU   LCCADSF2                                                 02344000
LCCARV61 EQU   LCCADSF1                                                 02345000
LCCARV60 EQU   LCCADSF1                                                 02346000
LCCARV59 EQU   LCCADSF1                                                 02347000
LCCARV58 EQU   LCCADSF1                                                 02348000
LCCATIMR EQU   LCCADSF1                                                 02349000
LCCADSS  EQU   LCCADSF1                                                 02350000
LCCAVCPU EQU   LCCADSF1                                                 02351000
LCCAASCP EQU   LCCA+532                                                 02352000
LCCAESSA EQU   LCCA+528                                                 02353000
LCCARV55 EQU   LCCASPN4                                                 02354000
LCCARV54 EQU   LCCASPN4                                                 02355000
LCCARV53 EQU   LCCASPN4                                                 02356000
LCCARV52 EQU   LCCASPN4                                                 02357000
LCCARV51 EQU   LCCASPN4                                                 02358000
LCCARV50 EQU   LCCASPN4                                                 02359000
LCCARV49 EQU   LCCASPN4                                                 02360000
LCCARV48 EQU   LCCASPN4                                                 02361000
LCCARV47 EQU   LCCASPN3                                                 02362000
LCCARV46 EQU   LCCASPN3                                                 02363000
LCCARV45 EQU   LCCASPN3                                                 02364000
LCCARV44 EQU   LCCASPN3                                                 02365000
LCCARV43 EQU   LCCASPN3                                                 02366000
LCCARV42 EQU   LCCASPN3                                                 02367000
LCCARV41 EQU   LCCASPN3                                                 02368000
LCCARV40 EQU   LCCASPN3                                                 02369000
LCCARV39 EQU   LCCASPN2                                                 02370000
LCCARV38 EQU   LCCASPN2                                                 02371000
LCCARV37 EQU   LCCASPN2                                                 02372000
LCCARV36 EQU   LCCASPN2                                                 02373000
LCCARV35 EQU   LCCASPN2                                                 02374000
LCCARV34 EQU   LCCASPN2                                                 02375000
LCCARV33 EQU   LCCASPN2                                                 02376000
LCCARV32 EQU   LCCASPN2                                                 02377000
LCCARV31 EQU   LCCASPN1                                                 02378000
LCCARV30 EQU   LCCASPN1                                                 02379000
LCCAMFIO EQU   LCCASPN1                                                 02380000
LCCARSTR EQU   LCCASPN1                                                 02381000
LCCATSPN EQU   LCCASPN1                                                 02382000
LCCALOCK EQU   LCCASPN1                                                 02383000
LCCASIGP EQU   LCCASPN1                                                 02384000
LCCAPTLB EQU   LCCASPN1                                                 02385000
LCCARV27 EQU   LCCAIHR4                                                 02386000
LCCARV26 EQU   LCCAIHR4                                                 02387000
LCCARV25 EQU   LCCAIHR4                                                 02388000
LCCARV24 EQU   LCCAIHR4                                                 02389000
LCCARV23 EQU   LCCAIHR4                                                 02390000
LCCARV22 EQU   LCCAIHR4                                                 02391000
LCCARV21 EQU   LCCAIHR4                                                 02392000
LCCARV20 EQU   LCCAIHR4                                                 02393000
LCCARV19 EQU   LCCAIHR3                                                 02394000
LCCARV18 EQU   LCCAIHR3                                                 02395000
LCCARV17 EQU   LCCAIHR3                                                 02396000
LCCARV16 EQU   LCCAIHR3                                                 02397000
LCCARV15 EQU   LCCAIHR3                                                 02398000
LCCARV14 EQU   LCCAIHR3                                                 02399000
LCCARV13 EQU   LCCAIHR3                                                 02400000
LCCARV12 EQU   LCCAIHR3                                                 02401000
LCCARV11 EQU   LCCAIHR2                                                 02402000
LCCARV10 EQU   LCCAIHR2                                                 02403000
LCCARV09 EQU   LCCAIHR2                                                 02404000
LCCARV08 EQU   LCCAIHR2                                                 02405000
LCCARV07 EQU   LCCAIHR2                                                 02406000
LCCARV06 EQU   LCCAIHR2                                                 02407000
LCCARV05 EQU   LCCAIHR2                                                 02408000
LCCARV04 EQU   LCCAIHR2                                                 02409000
LCCARV03 EQU   LCCAIHR1                                                 02410000
LCCARV02 EQU   LCCAIHR1                                                 02411000
LCCARV01 EQU   LCCAIHR1                                                 02412000
LCCAPPIE EQU   LCCAIHR1                                                 02413000
LCCAPSG1 EQU   LCCAIHR1                                                 02414000
LCCAPDAT EQU   LCCAIHR1                                                 02415000
LCCAXRC2 EQU   LCCAIHR1                                                 02416000
LCCAXRC1 EQU   LCCAIHR1                                                 02417000
LCCAIOPS EQU   LCCA+512                                                 02418000
LCCAGPGR EQU   LCCA+448                                                 02419000
LCCARSFP EQU   LCCA+416                                                 02420000
LCCARSGR EQU   LCCA+352                                                 02421000
LCCAXGR3 EQU   LCCA+288                                                 02422000
LCCAXGR2 EQU   LCCA+224                                                 02423000
LCCAXGR1 EQU   LCCA+160                                                 02424000
LCCACR0  EQU   LCCA+156                                                 02425000
LCCAMCR1 EQU   LCCA+152                                                 02426000
LCCAPVAD EQU   LCCA+148                                                 02427000
LCCAPINT EQU   LCCA+144                                                 02428000
LCCAPPSW EQU   LCCA+136                                                 02429000
LCCAPGR2 EQU   LCCA+72                                                  02430000
LCCAPGR1 EQU   LCCA+8                                                   02431000
LCCARV77 EQU   LCCA+6                                                   02432000
LCCACPUA EQU   LCCA+4                                                   02433000
LCCALCCA EQU   LCCA                                                     02434000
CVTLEVL  EQU   CVTRELNO+2                                               02435000
CVTNUMB  EQU   CVTRELNO                                                 02436000
CVTMDL   EQU   CVTFIX+250                                               02437000
@NM00026 EQU   CVTFIX+248                                               02438000
@NM00025 EQU   CVTFIX                                                   02439000
CVTRV482 EQU   CVTXTNT2+128                                             02440000
CVTRV481 EQU   CVTXTNT2+124                                             02441000
CVTRV480 EQU   CVTXTNT2+120                                             02442000
CVTRV479 EQU   CVTXTNT2+118                                             02443000
CVTRV478 EQU   CVTXTNT2+117                                             02444000
CVTRV477 EQU   CVTXTNT2+116                                             02445000
CVTRV476 EQU   CVTXTNT2+115                                             02446000
CVTRV475 EQU   CVTXTNT2+114                                             02447000
CVTRV474 EQU   CVTRV466                                                 02448000
CVTRV473 EQU   CVTRV466                                                 02449000
CVTRV472 EQU   CVTRV466                                                 02450000
CVTRV471 EQU   CVTRV466                                                 02451000
CVTRV470 EQU   CVTRV466                                                 02452000
CVTRV469 EQU   CVTRV466                                                 02453000
CVTRV468 EQU   CVTRV466                                                 02454000
CVTRV467 EQU   CVTRV466                                                 02455000
CVTRV465 EQU   CVTRV457                                                 02456000
CVTRV464 EQU   CVTRV457                                                 02457000
CVTRV463 EQU   CVTRV457                                                 02458000
CVTRV462 EQU   CVTRV457                                                 02459000
CVTRV461 EQU   CVTRV457                                                 02460000
CVTRV460 EQU   CVTRV457                                                 02461000
CVTRV459 EQU   CVTRV457                                                 02462000
CVTRV458 EQU   CVTRV457                                                 02463000
CVTRV456 EQU   CVTXTNT2+108                                             02464000
CVTRV455 EQU   CVTXTNT2+104                                             02465000
CVTRV454 EQU   CVTXTNT2+100                                             02466000
CVTRV453 EQU   CVTXTNT2+96                                              02467000
CVTRV452 EQU   CVTXTNT2+94                                              02468000
CVTRV451 EQU   CVTXTNT2+92                                              02469000
CVTRV450 EQU   CVTXTNT2+90                                              02470000
CVTRV449 EQU   CVTXTNT2+88                                              02471000
CVTRV448 EQU   CVTXTNT2+87                                              02472000
CVTRV447 EQU   CVTXTNT2+86                                              02473000
CVTRV446 EQU   CVTRV438                                                 02474000
CVTRV445 EQU   CVTRV438                                                 02475000
CVTRV444 EQU   CVTRV438                                                 02476000
CVTRV443 EQU   CVTRV438                                                 02477000
CVTRV442 EQU   CVTRV438                                                 02478000
CVTRV441 EQU   CVTRV438                                                 02479000
CVTRV440 EQU   CVTRV438                                                 02480000
CVTRV439 EQU   CVTRV438                                                 02481000
CVTRV437 EQU   CVTRV429                                                 02482000
CVTRV436 EQU   CVTRV429                                                 02483000
CVTRV435 EQU   CVTRV429                                                 02484000
CVTRV434 EQU   CVTRV429                                                 02485000
CVTRV433 EQU   CVTRV429                                                 02486000
CVTRV432 EQU   CVTRV429                                                 02487000
CVTRV431 EQU   CVTRV429                                                 02488000
CVTRV430 EQU   CVTRV429                                                 02489000
CVTRV428 EQU   CVTXTNT2+80                                              02490000
CVTRV427 EQU   CVTXTNT2+76                                              02491000
CVTRV426 EQU   CVTXTNT2+72                                              02492000
CVTRV425 EQU   CVTXTNT2+68                                              02493000
CVTATACT EQU   CVTATCVT                                                 02494000
CVTRV423 EQU   CVTXTNT2+62                                              02495000
CVTRV422 EQU   CVTXTNT2+60                                              02496000
CVTRV421 EQU   CVTXTNT2+58                                              02497000
CVTRV420 EQU   CVTXTNT2+56                                              02498000
CVTRV419 EQU   CVTXTNT2+55                                              02499000
CVTRV418 EQU   CVTXTNT2+54                                              02500000
CVTRV417 EQU   CVTRV409                                                 02501000
CVTRV416 EQU   CVTRV409                                                 02502000
CVTRV415 EQU   CVTRV409                                                 02503000
CVTRV414 EQU   CVTRV409                                                 02504000
CVTRV413 EQU   CVTRV409                                                 02505000
CVTRV412 EQU   CVTRV409                                                 02506000
CVTRV411 EQU   CVTRV409                                                 02507000
CVTRV410 EQU   CVTRV409                                                 02508000
CVTRV408 EQU   CVTRV400                                                 02509000
CVTRV407 EQU   CVTRV400                                                 02510000
CVTRV406 EQU   CVTRV400                                                 02511000
CVTRV405 EQU   CVTRV400                                                 02512000
CVTRV404 EQU   CVTRV400                                                 02513000
CVTRV403 EQU   CVTRV400                                                 02514000
CVTRV402 EQU   CVTRV400                                                 02515000
CVTRV401 EQU   CVTRV400                                                 02516000
CVTRSVA1 EQU   CVTXTNT2+48                                              02517000
CVTRSVA0 EQU   CVTXTNT2+44                                              02518000
CVTRSV99 EQU   CVTXTNT2+40                                              02519000
CVTRSV98 EQU   CVTXTNT2+36                                              02520000
CVTRSV97 EQU   CVTXTNT2+34                                              02521000
CVTRSV96 EQU   CVTXTNT2+32                                              02522000
CVTOLTEP EQU   CVTXTNT2+28                                              02523000
CVTQIDA  EQU   CVTQID+1                                                 02524000
CVTRSV95 EQU   CVTQID                                                   02525000
CVTRSV94 EQU   CVTXTNT2+20                                              02526000
CVTRSV93 EQU   CVTXTNT2+16                                              02527000
CVTRSV92 EQU   CVTXTNT2+12                                              02528000
CVTDEBVR EQU   CVTXTNT2+8                                               02529000
CVTRSV91 EQU   CVTXTNT2+6                                               02530000
CVTRSV9H EQU   CVTRSV90                                                 02531000
CVTRSV9G EQU   CVTRSV90                                                 02532000
CVTRSV9F EQU   CVTRSV90                                                 02533000
CVTRSV9E EQU   CVTRSV90                                                 02534000
CVTRSV9D EQU   CVTRSV90                                                 02535000
CVTRSV9C EQU   CVTRSV90                                                 02536000
CVTRSV9B EQU   CVTRSV90                                                 02537000
CVTRSV9A EQU   CVTRSV90                                                 02538000
CVTNUCLS EQU   CVTXTNT2+4                                               02539000
CVTDSSVA EQU   CVTDSSV+1                                                02540000
CVTRSV89 EQU   CVTDSSV                                                  02541000
CVTRSV88 EQU   CVTXTNT1+8                                               02542000
CVTRSV87 EQU   CVTXTNT1+4                                               02543000
CVTFACHN EQU   CVTXTNT1                                                 02544000
CVTRV488 EQU   CVTMAP+412                                               02545000
CVTRV487 EQU   CVTMAP+408                                               02546000
CVTRV486 EQU   CVTMAP+404                                               02547000
CVTRV485 EQU   CVTMAP+400                                               02548000
CVTRV484 EQU   CVTMAP+396                                               02549000
CVTAUTH  EQU   CVTMAP+392                                               02550000
CVTATMCA EQU   CVTATMCT+1                                               02551000
CVTATMST EQU   CVTATMCT                                                 02552000
CVTRSV61 EQU   CVTMAP+384                                               02553000
CVTVOLT1 EQU   CVTVOLM1+1                                               02554000
CVTVOLI1 EQU   CVTVOLF1                                                 02555000
CVTSTOA  EQU   CVTMAP+376                                               02556000
CVTRSV58 EQU   CVTMAP+374                                               02557000
CVTRSV57 EQU   CVTMAP+372                                               02558000
CVTDDCE  EQU   CVTMAP+368                                               02559000
CVTPNWFR EQU   CVTMAP+364                                               02560000
CVTSMF   EQU   CVTMAP+360                                               02561000
CVTSULK  EQU   CVTMAP+358                                               02562000
CVTSLKO  EQU   CVTSYSK                                                  02563000
CVTSLKP  EQU   CVTSYSK                                                  02564000
CVTSLKQ  EQU   CVTSYSK                                                  02565000
CVTSLKR  EQU   CVTSYSK                                                  02566000
CVTRSV56 EQU   CVTSYSK                                                  02567000
CVTRSV55 EQU   CVTSYSK                                                  02568000
CVTRSV54 EQU   CVTSYSK                                                  02569000
CVTRSV53 EQU   CVTSYSK                                                  02570000
CVTRSV52 EQU   CVTA1F1                                                  02571000
CVTRSV51 EQU   CVTA1F1                                                  02572000
CVTRSV50 EQU   CVTA1F1                                                  02573000
CVTRSV49 EQU   CVTA1F1                                                  02574000
CVTRSV48 EQU   CVTA1F1                                                  02575000
CVTRSV47 EQU   CVTA1F1                                                  02576000
CVTSRSW  EQU   CVTA1F1                                                  02577000
CVTPFSW  EQU   CVTA1F1                                                  02578000
CVTPCVT  EQU   CVTMAP+352                                               02579000
CVTRSV46 EQU   CVTMAP+344                                               02580000
CVTRSV45 EQU   CVTMAP+340                                               02581000
CVTRSV44 EQU   CVTMAP+338                                               02582000
CVTRSV43 EQU   CVTMAP+336                                               02583000
CVTHJESA EQU   CVTHJES+1                                                02584000
CVTRSV42 EQU   CVTHJES                                                  02585000
CVTEXT2A EQU   CVTEXT2+1                                                02586000
CVTRSV41 EQU   CVTEXT2                                                  02587000
CVTAPFA  EQU   CVTAPF+1                                                 02588000
CVTRSV40 EQU   CVTAPF                                                   02589000
CVTRV518 EQU   CVTINTLA                                                 02590000
CVTRV517 EQU   CVTERPV                                                  02591000
CVTEORM  EQU   CVTMAP+312                                               02592000
CVTMCHPR EQU   CVTMAP+308                                               02593000
CVTTZ    EQU   CVTMAP+304                                               02594000
CVTJEPS  EQU   CVTMAP+300                                               02595000
CVTJESCT EQU   CVTMAP+296                                               02596000
CVTMODE  EQU   CVTMAP+292                                               02597000
CVTPTRV  EQU   CVTMAP+288                                               02598000
CVTREAL  EQU   CVTMAP+284                                               02599000
CVTRSV39 EQU   CVTMAP+280                                               02600000
CVTRSV38 EQU   CVTMAP+276                                               02601000
CVTDMSRA EQU   CVTDMSR+1                                                02602000
CVTRSV37 EQU   CVTDMSR                                                  02603000
CVTQMSGA EQU   CVTQMSG+1                                                02604000
CVTRSV36 EQU   CVTQMSG                                                  02605000
CVTAMFF  EQU   CVTMAP+264                                               02606000
CVTPURGA EQU   CVTPURG+1                                                02607000
CVTRSV35 EQU   CVTPURG                                                  02608000
CVTCBSP  EQU   CVTMAP+256                                               02609000
CVTATERA EQU   CVTATER+1                                                02610000
CVTSYST  EQU   CVTATER                                                  02611000
CVTVOLT2 EQU   CVTTAT                                                   02612000
CVTVOLI2 EQU   CVTVOLF2                                                 02613000
CVTAQAVB EQU   CVTAQAVT+1                                               02614000
CVTRSV34 EQU   CVTTCMFG                                                 02615000
CVTRSV33 EQU   CVTTCMFG                                                 02616000
CVTRSV32 EQU   CVTTCMFG                                                 02617000
CVTRSV31 EQU   CVTTCMFG                                                 02618000
CVTRSV30 EQU   CVTTCMFG                                                 02619000
CVTRSV29 EQU   CVTTCMFG                                                 02620000
CVTRSV28 EQU   CVTTCMFG                                                 02621000
CVTTCRDY EQU   CVTTCMFG                                                 02622000
CVTGTFA  EQU   CVTGTF+1                                                 02623000
CVTRSV27 EQU   CVTGTFST                                                 02624000
CVTRNIO  EQU   CVTGTFST                                                 02625000
CVTRV319 EQU   CVTUSR                                                   02626000
CVTRV318 EQU   CVTFORM                                                  02627000
CVTRV317 EQU   CVTTMODE                                                 02628000
CVTRV316 EQU   CVTSTATE                                                 02629000
CVTRV315 EQU   CVTGTFS                                                  02630000
CVTGTFAV EQU   CVTGTFS                                                  02631000
CVT0SCR1 EQU   CVTMAP+232                                               02632000
CVTRV515 EQU   CVTMAP+228                                               02633000
CVTRMS   EQU   CVTMAP+224                                               02634000
CVTPATCH EQU   CVTMAP+220                                               02635000
CVTTSCE  EQU   CVTMAP+216                                               02636000
CVTLNKSC EQU   CVTMAP+214                                               02637000
CVTQABST EQU   CVTMAP+212                                               02638000
CVTMDLDS EQU   CVTMAP+208                                               02639000
CVTUSER  EQU   CVTMAP+204                                               02640000
CVTABEND EQU   CVTMAP+200                                               02641000
CVTSMCA  EQU   CVTMAP+196                                               02642000
CVTRSV18 EQU   CVTMAP+192                                               02643000
CVTQLPAQ EQU   CVTMAP+188                                               02644000
CVTQCDSR EQU   CVTMAP+184                                               02645000
CVTRSV17 EQU   CVTOPTB                                                  02646000
CVTRSV16 EQU   CVTOPTB                                                  02647000
CVTFP    EQU   CVTOPTB                                                  02648000
CVTAPTHR EQU   CVTOPTB                                                  02649000
CVTNLOG  EQU   CVTOPTB                                                  02650000
CVTTOD   EQU   CVTOPTB                                                  02651000
CVTCTIMS EQU   CVTOPTB                                                  02652000
CVTPROT  EQU   CVTOPTB                                                  02653000
CVTXPFP  EQU   CVTOPTA                                                  02654000
CVTASCII EQU   CVTOPTA                                                  02655000
CVTRSV13 EQU   CVTOPTA                                                  02656000
CVTRSV12 EQU   CVTOPTA                                                  02657000
CVTNIP   EQU   CVTOPTA                                                  02658000
CVTDDR   EQU   CVTOPTA                                                  02659000
CVTAPR   EQU   CVTOPTA                                                  02660000
CVTCCH   EQU   CVTOPTA                                                  02661000
CVTSNCTR EQU   CVTMAP+180                                               02662000
CVTQMWR  EQU   CVTMAP+176                                               02663000
CVTQOCR  EQU   CVTMAP+172                                               02664000
CVT1EF00 EQU   CVTMAP+168                                               02665000
CVTMZ00  EQU   CVTMAP+164                                               02666000
CVTHEAD  EQU   CVTMAP+160                                               02667000
CVTRSV11 EQU   CVTMAP+156                                               02668000
CVT0PT01 EQU   CVTMAP+152                                               02669000
CVTMSER  EQU   CVTMAP+148                                               02670000
CVTRV516 EQU   CVTIERLC                                                 02671000
CVTILCH  EQU   CVTMAP+140                                               02672000
CVT0DS   EQU   CVTMAP+136                                               02673000
CVTFBOSV EQU   CVTMAP+132                                               02674000
CVTNUCB  EQU   CVTMAP+128                                               02675000
CVTIXAVL EQU   CVTMAP+124                                               02676000
CVTIOQET EQU   CVTMAP+120                                               02677000
CVTDCBA  EQU   CVTMAP+117                                               02678000
CVTMVS2  EQU   CVTDCB                                                   02679000
CVT6DAT  EQU   CVTDCB                                                   02680000
CVT4MPS  EQU   CVTDCB                                                   02681000
CVTRSV09 EQU   CVTDCB                                                   02682000
CVT4MS1  EQU   CVTDCB                                                   02683000
CVT2SPS  EQU   CVTDCB                                                   02684000
CVT1SSS  EQU   CVTDCB                                                   02685000
CVTRSV08 EQU   CVTDCB                                                   02686000
CVTSTB   EQU   CVTMAP+112                                               02687000
CVTQTD00 EQU   CVTMAP+108                                               02688000
CVTQTE00 EQU   CVTMAP+104                                               02689000
CVTCUCB  EQU   CVTMAP+100                                               02690000
CVTSJQ   EQU   CVTMAP+96                                                02691000
CVTPBLDL EQU   CVTMAP+92                                                02692000
CVTTPC   EQU   CVTMAP+88                                                02693000
CVTSVDCB EQU   CVTMAP+84                                                02694000
CVTBRET  EQU   CVTMAP+82                                                02695000
CVTEXIT  EQU   CVTMAP+80                                                02696000
CVT0FN00 EQU   CVTMAP+76                                                02697000
CVTDARA  EQU   CVTDAR+1                                                 02698000
CVTRSV07 EQU   CVTFLGS1                                                 02699000
CVTRSV06 EQU   CVTFLGS1                                                 02700000
CVTRSV05 EQU   CVTFLGS1                                                 02701000
CVTRSV04 EQU   CVTFLGS1                                                 02702000
CVTRSV03 EQU   CVTFLGS1                                                 02703000
CVTRSV02 EQU   CVTFLGS1                                                 02704000
CVTRSV01 EQU   CVTFLGS1                                                 02705000
CVTDMPLK EQU   CVTFLGS1                                                 02706000
CVTXITP  EQU   CVTMAP+68                                                02707000
CVTZDTAB EQU   CVTMAP+64                                                02708000
CVTMSLT  EQU   CVTMAP+60                                                02709000
CVTDATE  EQU   CVTMAP+56                                                02710000
CVTSYSAD EQU   CVTMAP+48                                                02711000
CVTXTLER EQU   CVTMAP+44                                                02712000
CVTILK2  EQU   CVTMAP+40                                                02713000
CVTILK1  EQU   CVTMAP+36                                                02714000
CVTPRLTV EQU   CVTMAP+32                                                02715000
CVTPCNVT EQU   CVTMAP+28                                                02716000
CVT0VL00 EQU   CVTMAP+24                                                02717000
CVTXAPG  EQU   CVTMAP+20                                                02718000
CVTBUF   EQU   CVTMAP+16                                                02719000
CVTJOB   EQU   CVTMAP+12                                                02720000
CVTLINK  EQU   CVTMAP+8                                                 02721000
CVT0EF00 EQU   CVTMAP+4                                                 02722000
CVTTCBP  EQU   CVTMAP                                                   02723000
CVT      EQU   CVTMAP                                                   02724000
@NM00024 EQU   PSA+3412                                                 02725000
PSASTAK  EQU   PSA+3072                                                 02726000
@NM00023 EQU   PSA+1032                                                 02727000
PSAUSEND EQU   PSA+1032                                                 02728000
PSAPCPSW EQU   PSA+1024                                                 02729000
PSARV060 EQU   PSA+1020                                                 02730000
PSARV059 EQU   PSA+1018                                                 02731000
PSASVC13 EQU   PSA+1016                                                 02732000
PSALSFCC EQU   PSA+1012                                                 02733000
PSASFACC EQU   PSA+1008                                                 02734000
PSASTOP  EQU   PSA+992                                                  02735000
PSASTART EQU   PSA+976                                                  02736000
PSARSPSW EQU   PSA+968                                                  02737000
PSASRPSW EQU   PSA+960                                                  02738000
PSARV045 EQU   PSA+892                                                  02739000
PSARV044 EQU   PSA+888                                                  02740000
PSARV043 EQU   PSA+884                                                  02741000
PSARV042 EQU   PSA+880                                                  02742000
PSARV041 EQU   PSA+876                                                  02743000
PSARV040 EQU   PSA+872                                                  02744000
PSARV025 EQU   PSA+868                                                  02745000
PSADSSED EQU   PSA+868                                                  02746000
PSADSSPR EQU   PSA+864                                                  02747000
PSADSSFW EQU   PSA+860                                                  02748000
PSADSS14 EQU   PSA+856                                                  02749000
PSADSSPP EQU   PSA+848                                                  02750000
PSADSSRP EQU   PSA+840                                                  02751000
PSADSS05 EQU   PSADSSF4                                                 02752000
PSADSS10 EQU   PSADSSF4                                                 02753000
PSADSSVE EQU   PSADSSF4                                                 02754000
PSADSSDE EQU   PSADSSF4                                                 02755000
PSADSSC0 EQU   PSADSSF4                                                 02756000
PSADSSIE EQU   PSADSSF4                                                 02757000
PSADSS12 EQU   PSADSSF4                                                 02758000
PSADSSRC EQU   PSADSSF4                                                 02759000
PSARV057 EQU   PSADSSF3                                                 02760000
PSARV056 EQU   PSADSSF3                                                 02761000
PSARV055 EQU   PSADSSF3                                                 02762000
PSADSSMC EQU   PSADSSF3                                                 02763000
PSADSSRW EQU   PSADSSF3                                                 02764000
PSADSSNM EQU   PSADSSF3                                                 02765000
PSADSSES EQU   PSADSSF3                                                 02766000
PSADSSGP EQU   PSADSSF3                                                 02767000
PSADSSF2 EQU   PSADSSFL+1                                               02768000
PSADSSPI EQU   PSADSSF1                                                 02769000
PSADSSOI EQU   PSADSSF1                                                 02770000
PSADSSSP EQU   PSADSSF1                                                 02771000
PSADSSTP EQU   PSADSSF1                                                 02772000
PSADSSDW EQU   PSADSSF1                                                 02773000
PSADSSDD EQU   PSADSSF1                                                 02774000
PSADSSDM EQU   PSADSSF1                                                 02775000
PSADSSMV EQU   PSADSSF1                                                 02776000
PSADSSTS EQU   PSA+816                                                  02777000
PSADSSWK EQU   PSA+812                                                  02778000
PSADSSR3 EQU   PSA+808                                                  02779000
PSADSSR2 EQU   PSA+804                                                  02780000
PSADSSRS EQU   PSA+800                                                  02781000
PSASTOR  EQU   PSA+796                                                  02782000
PSACPUSA EQU   PSA+794                                                  02783000
PSAVSTAP EQU   PSA+792                                                  02784000
PSAWKVAP EQU   PSA+788                                                  02785000
PSAWKRAP EQU   PSA+784                                                  02786000
PSAMCHIC EQU   PSA+783                                                  02787000
PSARV061 EQU   PSA+782                                                  02788000
PSASYMSK EQU   PSA+781                                                  02789000
PSAMCHFL EQU   PSA+780                                                  02790000
PSACR0   EQU   PSA+776                                                  02791000
PSAPSWSV EQU   PSA+768                                                  02792000
PSACLHS  EQU   PSAHLHI                                                  02793000
PSALKR15 EQU   PSALKSA+60                                               02794000
PSALKR14 EQU   PSALKSA+56                                               02795000
PSALKR13 EQU   PSALKSA+52                                               02796000
PSALKR12 EQU   PSALKSA+48                                               02797000
PSALKR11 EQU   PSALKSA+44                                               02798000
PSALKR10 EQU   PSALKSA+40                                               02799000
PSALKR9  EQU   PSALKSA+36                                               02800000
PSALKR8  EQU   PSALKSA+32                                               02801000
PSALKR7  EQU   PSALKSA+28                                               02802000
PSALKR6  EQU   PSALKSA+24                                               02803000
PSALKR5  EQU   PSALKSA+20                                               02804000
PSALKR4  EQU   PSALKSA+16                                               02805000
PSALKR3  EQU   PSALKSA+12                                               02806000
PSALKR2  EQU   PSALKSA+8                                                02807000
PSALKR1  EQU   PSALKSA+4                                                02808000
PSALKR0  EQU   PSALKSA                                                  02809000
PSARV023 EQU   PSACLHT+52                                               02810000
PSALOCAL EQU   PSACLHT+48                                               02811000
PSACMSL  EQU   PSACLHT+44                                               02812000
PSAOPTL  EQU   PSACLHT+40                                               02813000
PSATPACL EQU   PSACLHT+36                                               02814000
PSATPDNL EQU   PSACLHT+32                                               02815000
PSATPNCL EQU   PSACLHT+28                                               02816000
PSAIOSLL EQU   PSACLHT+24                                               02817000
PSAIOSUL EQU   PSACLHT+20                                               02818000
PSAIOSCL EQU   PSACLHT+16                                               02819000
PSAIOSSL EQU   PSACLHT+12                                               02820000
PSASALCL EQU   PSACLHT+8                                                02821000
PSAASML  EQU   PSACLHT+4                                                02822000
PSADISPL EQU   PSACLHT                                                  02823000
PSASRSA  EQU   PSA+636                                                  02824000
PSARV050 EQU   PSA+634                                                  02825000
PSADSSGO EQU   PSA+633                                                  02826000
PSARECUR EQU   PSA+632                                                  02827000
PSAHLHIS EQU   PSA+628                                                  02828000
PSAIPCSA EQU   PSA+624                                                  02829000
@NM00022 EQU   PSA+621                                                  02830000
PSAIPCDM EQU   PSA+620                                                  02831000
PSAIPCD  EQU   PSA+616                                                  02832000
@NM00021 EQU   PSA+613                                                  02833000
PSAIPCRM EQU   PSA+612                                                  02834000
PSAIPCR  EQU   PSA+608                                                  02835000
PSAMCHEX EQU   PSA+600                                                  02836000
PSAMPSW  EQU   PSA+592                                                  02837000
PSAEXPS2 EQU   PSA+584                                                  02838000
PSAEXPS1 EQU   PSA+576                                                  02839000
PSAPIREG EQU   PSA+572                                                  02840000
PSARSREG EQU   PSA+568                                                  02841000
PSAGPREG EQU   PSA+556                                                  02842000
PSARV022 EQU   PSASUP4                                                  02843000
PSARV021 EQU   PSASUP4                                                  02844000
PSARV020 EQU   PSASUP4                                                  02845000
PSARV019 EQU   PSASUP4                                                  02846000
PSARV018 EQU   PSASUP4                                                  02847000
PSARV017 EQU   PSASUP4                                                  02848000
PSARV016 EQU   PSASUP4                                                  02849000
PSARV015 EQU   PSASUP4                                                  02850000
PSARV014 EQU   PSASUP3                                                  02851000
PSARV013 EQU   PSASUP3                                                  02852000
PSARV012 EQU   PSASUP3                                                  02853000
PSARV011 EQU   PSASUP3                                                  02854000
PSARV010 EQU   PSASUP3                                                  02855000
PSARV009 EQU   PSASUP3                                                  02856000
PSARV008 EQU   PSASUP3                                                  02857000
PSAIOSUP EQU   PSASUP3                                                  02858000
PSALCR   EQU   PSASUP2                                                  02859000
PSARTM   EQU   PSASUP2                                                  02860000
PSAACR   EQU   PSASUP2                                                  02861000
PSAIPCE2 EQU   PSASUP2                                                  02862000
PSAIPCES EQU   PSASUP2                                                  02863000
PSAIPCEC EQU   PSASUP2                                                  02864000
PSAGTF   EQU   PSASUP2                                                  02865000
PSAIPCRI EQU   PSASUP2                                                  02866000
PSAIPCRP EQU   PSASUP1                                                  02867000
PSAIPCDR EQU   PSASUP1                                                  02868000
PSADISP  EQU   PSASUP1                                                  02869000
PSALOCK  EQU   PSASUP1                                                  02870000
PSAPI    EQU   PSASUP1                                                  02871000
PSAEXT   EQU   PSASUP1                                                  02872000
PSASVC   EQU   PSASUP1                                                  02873000
PSAIO    EQU   PSASUP1                                                  02874000
PSAAOLD  EQU   PSA+548                                                  02875000
PSAANEW  EQU   PSA+544                                                  02876000
PSATOLD  EQU   PSA+540                                                  02877000
PSATNEW  EQU   PSA+536                                                  02878000
PSALCCAR EQU   PSA+532                                                  02879000
PSAPCCAR EQU   PSA+524                                                  02880000
PSAPCCAV EQU   PSA+520                                                  02881000
PSACPULA EQU   PSA+518                                                  02882000
PSACPUPA EQU   PSA+516                                                  02883000
PSAPSA   EQU   PSA+512                                                  02884000
FLCHDEND EQU   PSA+512                                                  02885000
FLCCRSAV EQU   FLCMCLA+280                                              02886000
FLCGRSAV EQU   FLCMCLA+216                                              02887000
FLCFPSAV EQU   FLCMCLA+184                                              02888000
FLCFLA   EQU   FLCMCLA+88                                               02889000
FLCRGNCD EQU   FLCMCLA+84                                               02890000
FLCFSAA  EQU   FLCFSA+1                                                 02891000
@NM00020 EQU   FLCFSA                                                   02892000
@NM00019 EQU   FLCMCLA+72                                               02893000
FLCMCIC  EQU   FLCMCLA+64                                               02894000
@NM00018 EQU   FLCMCLA+20                                               02895000
FLCIOAA  EQU   FLCIOA+1                                                 02896000
@NM00017 EQU   FLCIOA                                                   02897000
@NM00016 EQU   FLCMCLA+15                                               02898000
@NM00015 EQU   FLCMCLA+14                                               02899000
@NM00014 EQU   FLCMCLA+12                                               02900000
FLCLCL   EQU   FLCMCLA+8                                                02901000
FLCIOELA EQU   FLCIOEL+1                                                02902000
@NM00013 EQU   FLCIOEL                                                  02903000
FLCCHNID EQU   FLCMCLA                                                  02904000
@NM00012 EQU   PSA+160                                                  02905000
FLCMTRCD EQU   PSA+157                                                  02906000
@NM00011 EQU   PSA+156                                                  02907000
FLCPERA  EQU   FLCPER+1                                                 02908000
@NM00010 EQU   FLCPER                                                   02909000
@NM00009 EQU   PSA+151                                                  02910000
FLCPERCD EQU   PSA+150                                                  02911000
FLCMCNUM EQU   PSA+149                                                  02912000
@NM00008 EQU   PSA+148                                                  02913000
FLCTEAA  EQU   FLCTEA+1                                                 02914000
@NM00007 EQU   FLCTEA                                                   02915000
PSAPIPC  EQU   PSAPICOD                                                 02916000
PSAPIMC  EQU   PSAPICOD                                                 02917000
PSAPIPER EQU   PSAPICOD                                                 02918000
PSARV049 EQU   FLCPICOD                                                 02919000
FLCPILCB EQU   FLCPIILC                                                 02920000
@NM00006 EQU   FLCPIILC                                                 02921000
@NM00005 EQU   PSAEPPSW                                                 02922000
FLCSVCN  EQU   PSAESPSW+2                                               02923000
FLCSILCB EQU   FLCSVILC                                                 02924000
@NM00004 EQU   FLCSVILC                                                 02925000
@NM00003 EQU   PSAESPSW                                                 02926000
FLCEICOD EQU   PSAEEPSW+2                                               02927000
PSASPAD  EQU   PSAEEPSW                                                 02928000
@NM00002 EQU   PSA+128                                                  02929000
FLCINPSW EQU   PSA+120                                                  02930000
FLCMNPSW EQU   PSA+112                                                  02931000
FLCPNPSW EQU   PSA+104                                                  02932000
FLCSNPSW EQU   PSA+96                                                   02933000
FLCENPSW EQU   PSA+88                                                   02934000
FLCTRACE EQU   PSA+84                                                   02935000
FLCTIMER EQU   PSA+80                                                   02936000
FLCCVT2  EQU   PSA+76                                                   02937000
FLCCAW   EQU   PSA+72                                                   02938000
FLCCSW   EQU   PSA+64                                                   02939000
FLCIOPSW EQU   PSA+56                                                   02940000
FLCMOPSW EQU   PSA+48                                                   02941000
FLCPOPSW EQU   PSA+40                                                   02942000
FLCSOPSW EQU   PSA+32                                                   02943000
FLCEOPSW EQU   PSA+24                                                   02944000
@NM00001 EQU   FLCICCW2+4                                               02945000
FLCCVT   EQU   FLCICCW2                                                 02946000
FLCICCW1 EQU   FLCROPSW                                                 02947000
FLCIPPSW EQU   FLCRNPSW                                                 02948000
*                                      END UNREFERENCED COMPONENTS      02949000
@RT00117 EQU   AC000400                                                 02950000
@RT00136 EQU   AC000200                                                 02951000
@RC00213 EQU   @EL00003                                                 02952000
@RC00218 EQU   @EL00003                                                 02953000
@RF00260 EQU   @EL00006                                                 02954000
@PB00008 EQU   @EL00001                                                 02955000
@PB00007 EQU   @PB00008                                                 02956000
@PB00006 EQU   @PB00007                                                 02957000
@PB00005 EQU   @PB00006                                                 02958000
@PB00004 EQU   @PB00005                                                 02959000
@PB00003 EQU   @PB00004                                                 02960000
@PB00002 EQU   @PB00003                                                 02961000
@ENDDATA EQU   *                                                        02962000
         END   IEAVEAC0                                                 02963000
./  ADD  SSI=80950246,NAME=IEAVEAT0
         TITLE ' IEAVEAT0 - ATTACH - SVC 42 - IGC0004B                 *00001000
                        '                                               00002000
IGC0004B CSECT ,                                                   0001 00003000
@PROLOG  DS    0H                                                  0002 00004000
RBPRFXLN EQU 64                                                         00005000
RBPRFLNA EQU 32                                                         00006000
PRBLEN   EQU 136                                                        00007000
SIRBLEN  EQU 200                                                        00008000
TIRBLEN  EQU 136                                                        00009000
IRBLEN   EQU 128                                                        00010000
SVRBLEN  EQU 224                                                        00011000
         SPACE 2                                                        00012000
C0       EQU   0                       CONSTANT 0             @ZA25845  00013000
C7       EQU   7                       CONSTANT 7                       00014000
C8       EQU   8                       CONSTANT 8                       00015000
X1       EQU   X'01'                   DISPLACEMENT ONE                 00016000
XFFF     EQU   X'FFF'                  DISPLACEMENT 4095                00017000
SP250EQU EQU   250                     SUBPOOL 250                      00018000
SP253EQU EQU   253                     SUBPOOL 253                      00019000
SP255EQU EQU   255                     SUBPOOL 255                      00020000
SALENGTH EQU   72                      LENGTH OF PROBLEM PGM SAVE AREA  00021000
SVRBDWDS EQU   (SVRBLEN+7)/8           LENGTH OF SVRB IN DWORDS         00022000
IRBDWDS  EQU   (IRBLEN+7)/8            LENGTH OF IRB IN DWORDS          00023000
MASKPDSL EQU   B'00011111'             MASK FOR DIRECTORY ENTRY LENGTH  00024000
         SPACE                                                          00025000
         USING IGC0004B,R6BASE                                          00026000
         MODID BR=YES                                                   00027000
         SPACE                                                          00028000
*                                   /* ESTABLISH ADDRESSABILITY      */ 00029000
         SPACE                                                          00030000
         LA    R9BASE,XFFF(,R6BASE)    INCREMENT ENTRY POINT ADDRESS    00031000
         LA    R9BASE,X1(,R9BASE)        BY 4096 FOR SECOND BASE REG    00032000
         USING IGC0004B,R6BASE,R9BASE  ESTABLISH ADDRESSABILITY         00033000
         SPACE                                                          00034000
*   R12SVRB=ADDR(R5CURRB->RBEXSAVE);/* ADDR OF PERM WORKAREA         */ 00035000
         LA    R12SVRB,RBEXSAVE(,R5CURRB)                          0147 00036000
*   RFY                                                            0148 00037000
*    (R2WORK) RSTD;                 /*                       @Z40FPYB*/ 00038000
*   R2WORK=R5CURRB-LENGTH(RBPRFX);  /* RBPRFX PTR FOR FESTAE @Z40FPYB*/ 00039000
         LR    R2WORK,R5CURRB                                      0149 00040000
         SH    R2WORK,@CH00168                                     0149 00041000
*   R5NEWTCB=ZERO;                  /* INDICATE NO NEW TCB YET       */ 00042000
         SLR   R5NEWTCB,R5NEWTCB                                   0150 00043000
*   RFY                                                            0151 00044000
*     R1AREA RSTD;                                                 0151 00045000
*   R1AREA=R12SVRB;                 /* ADDRESS TO CLEAR              */ 00046000
         LR    R1AREA,R12SVRB                                      0152 00047000
*   AREA(1:LENGTH(RBEXSAVE))=AREA(1:LENGTH(RBEXSAVE))&&AREA(1:LENGTH(   00048000
*       RBEXSAVE));                 /* CLEAR                         */ 00049000
         XC    AREA(48,R1AREA),AREA(R1AREA)                        0153 00050000
*   RFY                                                            0154 00051000
*     R1AREA UNRSTD;                                               0154 00052000
*   WKNOAREA='1'B;                  /* NO WORKAREA STORAGE YET       */ 00053000
         OI    WKNOAREA(R12SVRB),B'00001000'                       0155 00054000
*   WKCURTCB=R4CURTCB;              /* JOURNAL CURRENT TCB ADDR      */ 00055000
         ST    R4CURTCB,WKCURTCB(,R12SVRB)                         0156 00056000
*/* D (NO,%FL01010,YES,)  CALLED BY A STAE EXIT ?                    */ 00057000
*                                                                  0157 00058000
*   IF R4CURTCB->TCBSTABE='1'B THEN                                0157 00059000
         TM    TCBSTABE(R4CURTCB),B'10000000'                      0157 00060000
         BNO   @RF00157                                            0157 00061000
*     DO;                           /* DO000001                      */ 00062000
*/* P  (,AT001000) SET RETURN CODE X'04'                             */ 00063000
*                                                                  0159 00064000
*       R15RETCD=X04STAE;           /* RETURN CODE 4, ATTACH IN STAE */ 00065000
         LA    R15RETCD,4                                          0159 00066000
*       GOTO AT001000;              /* EXIT NOT ALLOWED. RETURN.     */ 00067000
         B     AT001000                                            0160 00068000
*     END;                          /* END00001                      */ 00069000
*   RFY                                                            0162 00070000
*     R10INPRM RSTD;                                               0162 00071000
@RF00157 DS    0H                                                  0163 00072000
*   R10INPRM=R15INPRM;              /* SAVE INPUT PARM ADDRESS       */ 00073000
         LR    R10INPRM,R15INPRM                                   0163 00074000
*   RFY                                                            0164 00075000
*     R15INPRM UNRSTD;                                             0164 00076000
*                                                                  0165 00077000
*   /*****************************************************************/ 00078000
*   /*                                                               */ 00079000
*   /* IGC042ES IS THE ENTRY POINT ADDRESS OF AN ESTAE EXIT WHICH    */ 00080000
*   /* PROVIDES RECOVERY CAPABILITY DURING THOSE PERIODS OF ATTACH   */ 00081000
*   /* PROCESSING WHEN THE LOCAL LOCK IS NOT HELD.                   */ 00082000
*   /*                                                               */ 00083000
*   /*****************************************************************/ 00084000
*                                                                  0165 00085000
*/* %FL01010: L ESTAE: ESTABLISH ESTAE ENVIRONMENT                   */ 00086000
*                                                                  0165 00087000
*   RFY                                                            0165 00088000
*    (R1WORK) RSTD;                 /*                       @Z40FPYB*/ 00089000
*   R1WORK=ADDR(IGC042ES);          /* SET ESTAE EP FOR FESTAE     0166 00090000
*                                                            @Z40FPYB*/ 00091000
         LA    R1WORK,IGC042ES                                     0166 00092000
*   RFY                                                            0167 00093000
*     R15RETCD RSTD;                                               0167 00094000
*   GENERATE;                                                      0168 00095000
*                                                                  0168 00096000
         SPACE                                                          00097000
      FESTAE EXITADR=(R1WORK),RBADDR=(R2WORK),TCBADDR=(R4CURTCB),      C00098000
               TERM=YES,PARAM=(R12SVRB),RECORD=YES,ASYNCH=NO            00099000
         SPACE                                                          00100000
*/* D (NO,%FL01020,YES,) RETURN CODE Â¬= 0 ?                          */ 00101000
*                                                                  0169 00102000
*   IF R15RETCDÂ¬=X00NOERR THEN      /* FOR ERROR INDICATION,         */ 00103000
         LTR   R15RETCD,R15RETCD                                   0169 00104000
         BZ    @RF00169                                            0169 00105000
*     DO;                           /* DO000002                      */ 00106000
*/* P (,AT001000) INDICATE ABEND 92A                                 */ 00107000
*                                                                  0171 00108000
*       R15RETCD=ABEND92A;          /* INDICATE ABEND CODE, LEAVE  0171 00109000
*                                      REASON CODE 0                 */ 00110000
         LA    R15RETCD,2346                                       0171 00111000
*       GOTO AT001000;              /* GO CLEAN UP.                  */ 00112000
         B     AT001000                                            0172 00113000
*     END;                          /* END00002                      */ 00114000
*   RFY                                                            0174 00115000
*    (R1WORK,                                                      0174 00116000
*     R2WORK) UNRSTD;               /*                       @Z40FPYB*/ 00117000
@RF00169 DS    0H                                                  0175 00118000
*   WKESTAEL=WKESTAEL&&WKESTAEL;    /* CLEAR LIST AREA               */ 00119000
         XC    WKESTAEL(16,R12SVRB),WKESTAEL(R12SVRB)              0175 00120000
*   RFY                                                            0176 00121000
*     R15RETCD UNRSTD;                                             0176 00122000
*ATFP10:                                                           0177 00123000
*   WKFCODE=FCODE10;                /* TRACE                         */ 00124000
ATFP10   MVI   WKFCODE(R12SVRB),X'0A'                              0177 00125000
*                                                                  0178 00126000
*/********************************************************************/ 00127000
*/*                                                                  */ 00128000
*/*    OBTAIN LOCAL LOCK FOR PARAMETER PROCESSING AND IRB PROCESSING */ 00129000
*/*    (LOCK ALTERS REGISTERS 0,1,11,13,15)                          */ 00130000
*/*                                                                  */ 00131000
*/********************************************************************/ 00132000
*/* %FL01020: S LOCK: GET LOCAL LOCK                                 */ 00133000
*                                                                  0178 00134000
*   RFY                                                            0178 00135000
*     R15RETCD RSTD;                                               0178 00136000
*   CALL LOCK;                      /* GET LOCAL LOCK                */ 00137000
         BAL   @14,LOCK                                            0179 00138000
*/* D (YES,AT001000,NO,) ANY ERRORS ?                                */ 00139000
*                                                                  0180 00140000
*   IF R15RETCDÂ¬=X00NOERR THEN      /* FOR ERROR INDICATION          */ 00141000
         LTR   R15RETCD,R15RETCD                                   0180 00142000
         BNZ   @RT00180                                            0180 00143000
*     GOTO AT001000;                /* GO CLEAN UP                   */ 00144000
*   RFY                                                            0182 00145000
*     R15RETCD UNRSTD;                                             0182 00146000
*ATFP20:                                                           0183 00147000
*   WKFCODE=FCODE20;                /* TRACE                         */ 00148000
ATFP20   MVI   WKFCODE(R12SVRB),X'14'                              0183 00149000
*                                                                  0184 00150000
*   /*****************************************************************/ 00151000
*   /*                                                               */ 00152000
*   /* SUBROUTINE CHKPARM OBTAINS A BLOCK OF STORAGE FROM SUBPOOL    */ 00153000
*   /* 255. THE STORAGE IS USED FOR THE NEW SVRB AND THE DE SAVE (IF */ 00154000
*   /* REQUIRED). THE NEW SVRB STORAGE IS FIRST USED AS A WORKAREA,  */ 00155000
*   /* AND THE ATTACH PARAMETER LIST IS MOVED INTO THIS AREA BY      */ 00156000
*   /* CHKPARM. IF THERE IS A DIRECTORY ENTRY, IT IS MOVED INTO THE  */ 00157000
*   /* DE SAVE AREA. CONTROL FIELDS ARE SET IN THE TEMPORARY SAVE    */ 00158000
*   /* AREA (THAT IS,THE NEW SVRB STORAGE), AND THE PERMANENT SAVE   */ 00159000
*   /* AREA (THE RBEXSAVE FIELD OF THE CURRENT SVRB).                */ 00160000
*   /*                                                               */ 00161000
*   /*****************************************************************/ 00162000
*                                                                  0184 00163000
*/* S CHKPARM: OBTAIN STORAGE, VALIDITY CHECK AND MOVE PARMS         */ 00164000
*                                                                  0184 00165000
*   RFY                                                            0184 00166000
*     R15RETCD RSTD;                                               0184 00167000
*   CALL CHKPARM;                   /* PROCESS PARAMETER LIST        */ 00168000
         BAL   @14,CHKPARM                                         0185 00169000
*/* D (YES,AT001000,NO,)  ANY ERRORS ?                               */ 00170000
*                                                                  0186 00171000
*   IF R15RETCDÂ¬=X00NOERR THEN      /* IN CASE OF ERROR,             */ 00172000
         LTR   R15RETCD,R15RETCD                                   0186 00173000
         BNZ   @RT00186                                            0186 00174000
*     GOTO AT001000;                /* GO CLEAN UP                   */ 00175000
*   RFY                                                            0188 00176000
*     R15RETCD UNRSTD;                                             0188 00177000
*   RFY                                                            0189 00178000
*     R10INPRM UNRSTD;                                             0189 00179000
*   RFY                                                            0190 00180000
*     ATTCHLST BASED(R3WORKAD);     /* REG 3 SET BY CHKPARM          */ 00181000
*   RFY                                                            0191 00182000
*     WKAREA BASED(R3WORKAD);                                      0191 00183000
*                                                                  0192 00184000
*   /*****************************************************************/ 00185000
*   /*                                                               */ 00186000
*   /* THIS PROCESSING INSURES THAT JOB STEP TCB'S AND NON-JOB STEP  */ 00187000
*   /* TCB'S ARE NOT MIXED ON ANY LEVEL, AND ALSO THAT A NON-JOB STEP*/ 00188000
*   /* TASK HAS NO JOB STEP SUBTASKS.                                */ 00189000
*   /*                                                               */ 00190000
*   /*****************************************************************/ 00191000
*                                                                  0192 00192000
*/* D (NO,%FL01030,YES,) IS CALLER A JOB STEP TASK ?                 */ 00193000
*                                                                  0192 00194000
*   GENERATE REFS(R4CURTCB) SETS(R4CURTCB) NOFLOWS;                0192 00195000
         SPACE                                                          00196000
         LA    R4CURTCB,0(,R4CURTCB)   INSURE HIGH ORDER BYTE ZERO      00197000
         SPACE                                                          00198000
*   RFY                                                            0193 00199000
*     R0WORK RSTD;                                                 0193 00200000
*   R0WORK=R4CURTCB->TCBJSTCA;      /* ADDR OF THIS TASK'S JSTCB     */ 00201000
         SLR   R0WORK,R0WORK                                       0194 00202000
         ICM   R0WORK,7,TCBJSTCA(R4CURTCB)                         0194 00203000
*   IF R4CURTCB=R0WORK THEN         /* IS CALLER A JOB STEP TASK     */ 00204000
*                                                                  0195 00205000
         CR    R4CURTCB,R0WORK                                     0195 00206000
         BNE   @RF00195                                            0195 00207000
*     /***************************************************************/ 00208000
*     /*                                                             */ 00209000
*     /* FOR JOB STEP TASK CALLER, DETERMINE WHETHER A MIX OF JOB    */ 00210000
*     /* STEP AND NON-JOB STEP SUBTASKS RESULTS FROM THIS REQUEST. IF*/ 00211000
*     /* SO, SET RETURN CODE X'18' AND BRANCH TO CLEAN UP.           */ 00212000
*     /*                                                             */ 00213000
*     /***************************************************************/ 00214000
*                                                                  0196 00215000
*     DO;                           /* DO000003                      */ 00216000
*       RFY                                                        0197 00217000
*         R7WORK RSTD;                                             0197 00218000
*       R7WORK=R4CURTCB->TCBLTC;    /* ADDR OF FIRST SUBTASK, IF ANY */ 00219000
         L     R7WORK,TCBLTC(,R4CURTCB)                            0198 00220000
*/* D (NO,%FL01040,YES,) DOES THE CURRENT TASK HAVE ANY SUBTASKS ?   */ 00221000
*                                                                  0199 00222000
*       IF R7WORKÂ¬=ZERO THEN        /* IS THERE A SUBTASK ?          */ 00223000
         LTR   R7WORK,R7WORK                                       0199 00224000
         BZ    @RF00199                                            0199 00225000
*         DO;                       /* DO000004: YES, CHECK ATTACH 0200 00226000
*                                      JSTCB PARM                    */ 00227000
*           R0WORK=R7WORK->TCBJSTCA;/* JSTCB ADDRESS                 */ 00228000
         SLR   R0WORK,R0WORK                                       0201 00229000
         ICM   R0WORK,7,TCBJSTCA(R7WORK)                           0201 00230000
*/* D (NO,%FL01050,YES,) WAS JSTCB=YES SPECIFIED ?                   */ 00231000
*/*                        IF JSTCB=YES WAS SPECIFIED, THEN THE FIRST*/ 00232000
*/*                        SUBTASK MUST BE A JOB STEP SUBTASK. IF    */ 00233000
*/*                        JSTCB=NO WAS SPECIFIED, THEN THE FIRST    */ 00234000
*/*                        SUBTASK MUST BE A NON-JOB STEP SUBTASK.   */ 00235000
*/*                        THIS CHECK INSURES THAT IF THE FIRST SUB- */ 00236000
*/*                        TASK IS A JOB STEP TASK, ALL OTHER SUB-   */ 00237000
*/*                        TASKS ARE ALSO JOB STEP TASKS, AND THAT IF*/ 00238000
*/*                        THE FIRST TASK IS NOT A JOB STEP TASK, ALL*/ 00239000
*/*                        OTHER SUBTASKS ARE NOT JOB STEP TASKS.    */ 00240000
*                                                                  0202 00241000
*           IF ATJSTCB='1'B THEN    /* JSTCB PARM                    */ 00242000
         TM    ATJSTCB(R3WORKAD),B'00000010'                       0202 00243000
         BNO   @RF00202                                            0202 00244000
*             DO;                   /* DO000091                      */ 00245000
*/*                 JSTCB=YES WAS SPECIFIED                          */ 00246000
*/* D (YES,%FL01040,NO,) IS FIRST SUBTASK A JOB STEP TASK ?          */ 00247000
*                                                                  0204 00248000
*               IF R7WORKÂ¬=R0WORK THEN/* JOB STEP ?                  */ 00249000
         CR    R7WORK,R0WORK                                       0204 00250000
         BE    @RF00204                                            0204 00251000
*                 DO;               /* DO000005: NO, INVALID         */ 00252000
*/* P (,AT001000) SET RETURN CODE X'18'                              */ 00253000
*                                                                  0206 00254000
*                   RFY                                            0206 00255000
*                     R15RETCD RSTD;                               0206 00256000
*                   R15RETCD=X18JSTCB;/* RETURN CODE                 */ 00257000
         LA    R15RETCD,24                                         0207 00258000
*                   GOTO AT001000;  /* EXIT                          */ 00259000
         B     AT001000                                            0208 00260000
*                   RFY                                            0209 00261000
*                     R15RETCD UNRSTD;                             0209 00262000
*                 END;              /* END00005                      */ 00263000
*             END;                  /* END00091                      */ 00264000
*                                                                  0211 00265000
*           /*********************************************************/ 00266000
*           /*                                                       */ 00267000
*           /* JSTCB=NO WAS SPECIFIED                                */ 00268000
*           /*                                                       */ 00269000
*           /*********************************************************/ 00270000
*                                                                  0212 00271000
*/* %FL01050: D (NO,%FL01040,YES,) IS FIRST SUBTASK A JOB STEP TASK ?*/ 00272000
*                                                                  0212 00273000
*           ELSE                                                   0212 00274000
*             IF R7WORK=R0WORK THEN /* JOB STEP ?                    */ 00275000
         B     @RC00202                                            0212 00276000
@RF00202 CR    R7WORK,R0WORK                                       0212 00277000
         BNE   @RF00212                                            0212 00278000
*               DO;                 /* DO000006: YES, INVALID        */ 00279000
*/* P (,AT001000) SET RETURN CODE X'18'                              */ 00280000
*                                                                  0214 00281000
*                 RFY                                              0214 00282000
*                   R15RETCD RSTD;                                 0214 00283000
*                 R15RETCD=X18JSTCB;                               0215 00284000
         LA    R15RETCD,24                                         0215 00285000
*                 GOTO AT001000;    /* EXIT                          */ 00286000
         B     AT001000                                            0216 00287000
*                 RFY                                              0217 00288000
*                   R15RETCD UNRSTD;                               0217 00289000
*               END;                /* END00006                      */ 00290000
*         END;                      /* END00004                      */ 00291000
*     END;                          /* END00003                      */ 00292000
*                                                                  0220 00293000
*   /*****************************************************************/ 00294000
*   /*                                                               */ 00295000
*   /* FOR NON-JOB STEP CALLER INSURE THAT THE NEW SUBTASK IS NOT    */ 00296000
*   /* MADE A JOB STEP TASK. IF REQUEST IS FOR A JSTCB, SET RETURN   */ 00297000
*   /* CODE X'14' AND BRANCH TO CLEAN UP.                            */ 00298000
*   /*                                                               */ 00299000
*   /*****************************************************************/ 00300000
*                                                                  0221 00301000
*/* %FL01030: D (NO,%FL01040,YES,) WAS JSTCB=YES SPECIFIED ?         */ 00302000
*                                                                  0221 00303000
*   ELSE                                                           0221 00304000
*     IF ATJSTCB='1'B THEN          /* IF JSTCB=YES SPECIFIED,       */ 00305000
         B     @RC00195                                            0221 00306000
@RF00195 TM    ATJSTCB(R3WORKAD),B'00000010'                       0221 00307000
         BNO   @RF00221                                            0221 00308000
*       DO;                         /* DO000007                      */ 00309000
*/* P (,AT001000) SET RETURN CODE X'14'                              */ 00310000
*                                                                  0223 00311000
*         RFY                                                      0223 00312000
*           R15RETCD RSTD;                                         0223 00313000
*         R15RETCD=X14JSTCB;        /* SET RETURN CODE               */ 00314000
         LA    R15RETCD,20                                         0224 00315000
*         GOTO AT001000;            /* GO CLEAN UP                   */ 00316000
         B     AT001000                                            0225 00317000
*         RFY                                                      0226 00318000
*           R15RETCD UNRSTD;                                       0226 00319000
*       END;                        /* END00007                      */ 00320000
*   RFY                                                            0228 00321000
*     R7WORK UNRSTD;                                               0228 00322000
@RF00221 DS    0H                                                  0228 00323000
@RC00195 DS    0H                                                  0229 00324000
*   RFY                                                            0229 00325000
*     R0WORK UNRSTD;                                               0229 00326000
*                                                                  0230 00327000
*   /*****************************************************************/ 00328000
*   /*                                                               */ 00329000
*   /* SUBROUTINE GETCBS OBTAINS STORAGE FOR THE NEW TCB, AND CLEARS */ 00330000
*   /* IT TO ZERO. AN IQE, AND IF NECESSARY AN IRB, ARE OBTAINED AND */ 00331000
*   /* INITIALIZED, AND PROPERLY CHAINED OFF THE NEW TCB, IF ETXR WAS*/ 00332000
*   /* SPECIFIED. THE LOCAL LOCK IS RELEASED BY GETCBS.              */ 00333000
*   /*                                                               */ 00334000
*   /*****************************************************************/ 00335000
*                                                                  0230 00336000
*/* %FL01040: S GETCBS: OBTAIN NEW TCB STORAGE, PROCESS ETXR         */ 00337000
*                                                                  0230 00338000
*   RFY                                                            0230 00339000
*     R15RETCD RSTD;                                               0230 00340000
*                                                                  0230 00341000
*/*    REG R5NEWTCB IS SET IN SUBROUTINE                             */ 00342000
*                                                                  0231 00343000
*   CALL GETCBS;                    /* GET CONTROL BLOCKS            */ 00344000
         BAL   @14,GETCBS                                          0231 00345000
*/* D (YES,AT001000,NO,) ANY ERRORS ?                                */ 00346000
*                                                                  0232 00347000
*   IF R15RETCDÂ¬=X00NOERR THEN                                     0232 00348000
         LTR   R15RETCD,R15RETCD                                   0232 00349000
         BNZ   @RT00232                                            0232 00350000
*     GOTO AT001000;                /* GO CLEAN UP                   */ 00351000
*   RFY                                                            0234 00352000
*     R15RETCD UNRSTD;                                             0234 00353000
*                                                                  0235 00354000
*   /*****************************************************************/ 00355000
*   /*                                                               */ 00356000
*   /* SUBROUTINE STAIRTN PROCESSES THE STAI/ESTAI OPERANDS, AND     */ 00357000
*   /* PROPAGATES ANY STAI/ESTAI SCB'S FROM THE CURRENT (ATTACHING   */ 00358000
*   /* TASK'S) TCB TO THE NEW TCB.                                   */ 00359000
*   /*                                                               */ 00360000
*   /*****************************************************************/ 00361000
*                                                                  0235 00362000
*/* P SET TCBTCBID = C'TCB '                                         */ 00363000
*                                                                  0235 00364000
*   R5NEWTCB->TCBTCBID=CHARTCB;     /* EBCDIC 'TCB ', TCB IDENTIFIER */ 00365000
         MVC   TCBTCBID(4,R5NEWTCB),CHARTCB                        0235 00366000
*/* S STAIRTN: STAI/ESTAI PROCESSING                                 */ 00367000
*                                                                  0236 00368000
*   RFY                                                            0236 00369000
*     R15RETCD RSTD;                                               0236 00370000
*   CALL STAIRTN;                   /* STAI/ESTAI PARMS & PROPAGATE  */ 00371000
         BAL   @14,STAIRTN                                         0237 00372000
*/* D (YES,AT001000,NO,) ANY ERRORS ?                                */ 00373000
*                                                                  0238 00374000
*   IF R15RETCDÂ¬=X00NOERR THEN                                     0238 00375000
         LTR   R15RETCD,R15RETCD                                   0238 00376000
         BNZ   @RT00238                                            0238 00377000
*     GOTO AT001000;                /* GO CLEAN UP                   */ 00378000
*   RFY                                                            0240 00379000
*     R15RETCD UNRSTD;                                             0240 00380000
*ATFP90:                                                           0241 00381000
*   WKFCODE=FCODE90;                /* TRACE                         */ 00382000
ATFP90   MVI   WKFCODE(R12SVRB),X'5A'                              0241 00383000
*                                                                  0242 00384000
*   /*****************************************************************/ 00385000
*   /*                                                               */ 00386000
*   /* PROPAGATE INVARIANT FIELDS FROM CURRENT TCB TO NEW TCB        */ 00387000
*   /*                                                               */ 00388000
*   /*****************************************************************/ 00389000
*                                                                  0242 00390000
*/* P PROPAGATE TCBTIO, TCBPQE, TCBTCT, AND BIT TCBRV                */ 00391000
*                                                                  0242 00392000
*   R5NEWTCB->TCBTIO=R4CURTCB->TCBTIO;/* TIOT ADDRESS                */ 00393000
         MVC   TCBTIO(4,R5NEWTCB),TCBTIO(R4CURTCB)                 0242 00394000
*   R5NEWTCB->TCBPQE=R4CURTCB->TCBPQE;/* DPQE PTR                    */ 00395000
         MVC   TCBPQE(4,R5NEWTCB),TCBPQE(R4CURTCB)                 0243 00396000
*   R5NEWTCB->TCBTCT=R4CURTCB->TCBTCT;/* TIMING CONTROL TABLE        */ 00397000
         MVC   TCBTCT(4,R5NEWTCB),TCBTCT(R4CURTCB)                 0244 00398000
*   IF R4CURTCB->TCBRV='1'B THEN    /* PROPAGATE                     */ 00399000
         TM    TCBRV(R4CURTCB),B'10000000'                         0245 00400000
         BNO   @RF00245                                            0245 00401000
*     R5NEWTCB->TCBRV='1'B;         /* VIRTUAL = REAL FLAG           */ 00402000
         OI    TCBRV(R5NEWTCB),B'10000000'                         0246 00403000
*/* P PROPAGATE TCBSTPCT AND BIT TCBSTPPR FOR STATUS                 */ 00404000
*                                                                  0247 00405000
*   IF R4CURTCB->TCBSTPPR='1'B THEN                                0247 00406000
@RF00245 TM    TCBSTPPR(R4CURTCB),B'01000000'                      0247 00407000
         BNO   @RF00247                                            0247 00408000
*     DO;                           /* DO000097                      */ 00409000
*       R5NEWTCB->TCBSTPCT=R4CURTCB->TCBSTPCT;/* COUNT OF STATUS   0249 00410000
*                                      STOPS ISSUED AGAINST CURRENT     00411000
*                                      TCB                           */ 00412000
         MVC   TCBSTPCT(1,R5NEWTCB),TCBSTPCT(R4CURTCB)             0249 00413000
*       R5NEWTCB->TCBSTPPR='1'B;    /* STATUS STOP TCB PENDING       */ 00414000
         OI    TCBSTPPR(R5NEWTCB),B'01000000'                      0250 00415000
*     END;                          /* END00097                      */ 00416000
*                                                                  0251 00417000
*   /*****************************************************************/ 00418000
*   /*                                                               */ 00419000
*   /* THE FOLLOWING FIELDS MAY BE RESET IN ACCORDANCE WITH ATTACH   */ 00420000
*   /* PARAMETERS SPECIFIED BY CALLER.                               */ 00421000
*   /*                                                               */ 00422000
*   /*****************************************************************/ 00423000
*                                                                  0252 00424000
*/* P PROPAGATE TCBJLB, TCBJSCB, TCBJSTCB (MAY BE RESET LATER)       */ 00425000
*                                                                  0252 00426000
*   R5NEWTCB->TCBJLB=R4CURTCB->TCBJLB;/* JOBLIB DCB ADDR             */ 00427000
@RF00247 MVC   TCBJLB(4,R5NEWTCB),TCBJLB(R4CURTCB)                 0252 00428000
*   R5NEWTCB->TCBJSCBB=R4CURTCB->TCBJSCBB;/* JOBSTEP CNTL BLOCK      */ 00429000
         MVC   TCBJSCBB(3,R5NEWTCB),TCBJSCBB(R4CURTCB)             0253 00430000
*   R5NEWTCB->TCBJSTCB=R4CURTCB->TCBJSTCB;/* JOBSTEP TCB PTR         */ 00431000
         MVC   TCBJSTCB(4,R5NEWTCB),TCBJSTCB(R4CURTCB)             0254 00432000
*/* P PROPAGATE ASCBAFFN TO NEW TCBAFFN                              */ 00433000
*                                                                  0255 00434000
*   RFY                                                            0255 00435000
*     R7ASCB RSTD;                                                 0255 00436000
*   R7ASCB=PSAAOLD;                 /* ADDRESS OF CURRENT ASCB       */ 00437000
         L     R7ASCB,PSAAOLD                                      0256 00438000
*   R5NEWTCB->TCBAFFN=R7ASCB->ASCBAFFN;/* CPU AFFINITY BITS          */ 00439000
         MVC   TCBAFFN(2,R5NEWTCB),ASCBAFFN(R7ASCB)                0257 00440000
*   RFY                                                            0258 00441000
*     R7ASCB UNRSTD;                                               0258 00442000
*                                                                  0259 00443000
*   /*****************************************************************/ 00444000
*   /*                                                               */ 00445000
*   /* SET INVARIANT FIELDS IN NEW TCB                               */ 00446000
*   /*                                                               */ 00447000
*   /*****************************************************************/ 00448000
*                                                                  0259 00449000
*/* P SET TCBEXT2 IN NEW TCB TO ADDR OF TCBXTNT2 IN NEW TCB          */ 00450000
*                                                                  0259 00451000
*   R5NEWTCB->TCBEXT2=R5NEWTCB+LENGTH(TCB);/* THE COMMON EXTENSION 0259 00452000
*                                      (TCBXTNT2) FOLLOWS THE TCB  0259 00453000
*                                      PROPER                        */ 00454000
         LA    @08,296                                             0259 00455000
         ALR   @08,R5NEWTCB                                        0259 00456000
         ST    @08,TCBEXT2(,R5NEWTCB)                              0259 00457000
*/* P SET TCBATT = 1 IN NEW TCB                                      */ 00458000
*                                                                  0260 00459000
*   R5NEWTCB->TCBATT='1'B;          /* NEW TASK RUNS FIRST UNDER   0260 00460000
*                                      SVRB, NO ATTENTION INTRUPTS.  */ 00461000
         OI    TCBATT(R5NEWTCB),B'00100000'                        0260 00462000
*                                                                  0261 00463000
*   /*****************************************************************/ 00464000
*   /*                                                               */ 00465000
*   /* SET FIELDS IN NEW TCB AS SPECIFIED BY ATTACH PARAMETER LIST   */ 00466000
*   /*                                                               */ 00467000
*   /*****************************************************************/ 00468000
*                                                                  0261 00469000
*/* D (NO,%FL01200,YES,) WAS JSTCB=YES SPECIFIED ?                   */ 00470000
*                                                                  0261 00471000
*   IF ATJSTCB='1'B THEN                                           0261 00472000
*                                                                  0261 00473000
         TM    ATJSTCB(R3WORKAD),B'00000010'                       0261 00474000
         BNO   @RF00261                                            0261 00475000
*/* P RESET TCBJSTCB TO ADDR NEW TCB                                 */ 00476000
*                                                                  0262 00477000
*     DO;                           /* DO000039                      */ 00478000
*       R5NEWTCB->TCBJSTCB=R5NEWTCB;/* JOB STEP TCB POINTS TO ITSELF    00479000
*                                      (ONLY INDICATOR OF A JOB STEP    00480000
*                                      TASK)                         */ 00481000
         ST    R5NEWTCB,TCBJSTCB(,R5NEWTCB)                        0263 00482000
*       R5NEWTCB->TCBECBNV='1'B;    /* IF THERE IS AN END OF TASK  0264 00483000
*                                      ECB, IT NEED NOT BE VALIDITY     00484000
*                                      CHECKED BY DETACH             */ 00485000
         OI    TCBECBNV(R5NEWTCB),B'00000100'                      0264 00486000
*     END;                          /* END00039                      */ 00487000
*/* %FL01200: D (NO,%FL01210,YES,) WAS SM=SUPV SPECIFIED ?           */ 00488000
*                                                                  0266 00489000
*   IF ATMODE='1'B THEN                                            0266 00490000
*                                                                  0266 00491000
@RF00261 TM    ATMODE(R3WORKAD),B'00000001'                        0266 00492000
         BNO   @RF00266                                            0266 00493000
*/* P SET TCBFSM = 1                                                 */ 00494000
*                                                                  0267 00495000
*     R5NEWTCB->TCBFSM='1'B;        /* INDICATE SUPERVISOR MODE TASK */ 00496000
         OI    TCBFSM(R5NEWTCB),B'10000000'                        0267 00497000
*/* %FL01210: D (NO,%FL01220,YES,) WAS KEY=PROP SPECIFIED ?          */ 00498000
*                                                                  0268 00499000
*   IF ATKEY='0'B THEN              /* IF KEY=PROP, THEN             */ 00500000
@RF00266 TM    ATKEY(R3WORKAD),B'00010000'                         0268 00501000
         BNZ   @RF00268                                            0268 00502000
*/* P PROPAGATE PROTECT KEY FIELD TCBPKF                             */ 00503000
*                                                                  0269 00504000
*     R5NEWTCB->TCBPKF=R4CURTCB->TCBPKF;/* PROPAGATE PROTECT KEY TO     00505000
*                                      NEW TCB                       */ 00506000
         MVC   TCBPKF(1,R5NEWTCB),TCBPKF(R4CURTCB)                 0269 00507000
*/* %FL01220: D (NO,%FL01230,YES,) WAS DISP=NO SPECIFIED ?           */ 00508000
*                                                                  0270 00509000
*   IF ATDISP='1'B THEN                                            0270 00510000
*                                                                  0270 00511000
@RF00268 TM    ATDISP(R3WORKAD),B'10000000'                        0270 00512000
         BNO   @RF00270                                            0270 00513000
*/* P SET TCBANDSP = 1                                               */ 00514000
*                                                                  0271 00515000
*     R5NEWTCB->TCBANDSP='1'B;      /* SET SPECIAL PRIMARY NON-DIS-     00516000
*                                      PATCHABILITY FLAG ON          */ 00517000
         OI    TCBANDSP(R5NEWTCB),B'00010000'                      0271 00518000
*/* %FL01230: D (NO,%FL01240,YES,) IS TCBTCP = 0 IN  CURRENT TCB ?   */ 00519000
*                                                                  0272 00520000
*   IF R4CURTCB->TCBTCP='0'B THEN                                  0272 00521000
*                                                                  0272 00522000
@RF00270 TM    TCBTCP(R4CURTCB),B'00000100'                        0272 00523000
         BNZ   @RF00272                                            0272 00524000
*/* P (,%FL01250) PROPAGATE FLAG BYTE TCBABF FROM WORD TCBTRN        */ 00525000
*                                                                  0273 00526000
*     R5NEWTCB->TCBABF=R4CURTCB->TCBABF;/* PROPAGATE 1 BYTE          */ 00527000
*                                                                  0273 00528000
         MVC   TCBABF(1,R5NEWTCB),TCBABF(R4CURTCB)                 0273 00529000
*   /*****************************************************************/ 00530000
*   /*                                                               */ 00531000
*   /* LOW ORDER THREE BYTES OF TCBTRN USED BY TSO TEST COMMAND      */ 00532000
*   /*                                                               */ 00533000
*   /*****************************************************************/ 00534000
*                                                                  0274 00535000
*/* %FL01240: P PROPAGATE WORD TCBTRN                                */ 00536000
*                                                                  0274 00537000
*   ELSE                                                           0274 00538000
*     R5NEWTCB->TCBTRN=R4CURTCB->TCBTRN;/* PROPAGATE 1 WORD          */ 00539000
         B     @RC00272                                            0274 00540000
@RF00272 MVC   TCBTRN(4,R5NEWTCB),TCBTRN(R4CURTCB)                 0274 00541000
*/* %FL01250: P SET TCBECB TO ATTACH PARM ECB=ADDR (MAY BE 0)        */ 00542000
*                                                                  0275 00543000
*   R5NEWTCB->TCBECB=ATECBADB;      /* ECB PARM                      */ 00544000
@RC00272 SLR   @08,@08                                             0275 00545000
         ICM   @08,7,ATECBADB(R3WORKAD)                            0275 00546000
         ST    @08,TCBECB(,R5NEWTCB)                               0275 00547000
*/* P SET TCBTID TO ATTACH PARM VALUE (MAY BE 0)                     */ 00548000
*                                                                  0276 00549000
*   R5NEWTCB->TCBTID=ATTID;         /* SET TASK ID                   */ 00550000
         MVC   TCBTID(1,R5NEWTCB),ATTID(R3WORKAD)                  0276 00551000
*/* D (NO,%FL01260,YES,) WAS TASKLIB SPECIFIED AND NOT ZERO?         */ 00552000
*                                                                  0277 00553000
*   IF ATTSKLB='1'B&ATTASKLBÂ¬=0 THEN/*                       @YA01016*/ 00554000
         TM    ATTSKLB(R3WORKAD),B'00000010'                       0277 00555000
         BNO   @RF00277                                            0277 00556000
         L     @08,ATTASKLB(,R3WORKAD)                             0277 00557000
         LTR   @08,@08                                             0277 00558000
         BZ    @RF00277                                            0277 00559000
*/* P RESET TCBJLB TO PARM SPECIFIED                                 */ 00560000
*                                                                  0278 00561000
*     R5NEWTCB->TCBJLB=ATTASKLB;    /* JOBLIB PTR = TASKLIB PARM     */ 00562000
         ST    @08,TCBJLB(,R5NEWTCB)                               0278 00563000
*/* %FL01260: D (NO,%FL01270,YES,) WAS JSCB SPECIFIED ?              */ 00564000
*                                                                  0279 00565000
*   IF ATJSCB='1'B THEN                                            0279 00566000
*                                                                  0279 00567000
@RF00277 TM    ATJSCB(R3WORKAD),B'01000000'                        0279 00568000
         BNO   @RF00279                                            0279 00569000
*/* P RESET TCBJSCB TO PARM SPECIFIED                                */ 00570000
*                                                                  0280 00571000
*     R5NEWTCB->TCBJSCB=ATJSCBA;    /* JSCB PTR = JSCB PARM          */ 00572000
         SLR   @08,@08                                             0280 00573000
         ICM   @08,7,ATJSCBA(R3WORKAD)                             0280 00574000
         ST    @08,TCBJSCB(,R5NEWTCB)                              0280 00575000
*/* %FL01270: S LOCK: OBTAIN LOCAL LOCK                              */ 00576000
*                                                                  0281 00577000
*   RFY                                                            0281 00578000
*     R15RETCD RSTD;                                               0281 00579000
@RF00279 DS    0H                                                  0282 00580000
*   CALL LOCK;                      /* GET LOCAL LOCK (ALTERS REGS 0282 00581000
*                                      0,1,11,13,15)                 */ 00582000
         BAL   @14,LOCK                                            0282 00583000
*/* D (YES,AT001000,NO,) ANY ERRORS ?                                */ 00584000
*                                                                  0283 00585000
*   IF R15RETCDÂ¬=X00NOERR THEN                                     0283 00586000
         LTR   R15RETCD,R15RETCD                                   0283 00587000
         BNZ   @RT00283                                            0283 00588000
*     GOTO AT001000;                /* GO CLEAN UP ON ERROR          */ 00589000
*   RFY                                                            0285 00590000
*     R15RETCD UNRSTD;                                             0285 00591000
*ATFP100:                                                          0286 00592000
*   WKFCODE=FCODE100;               /* TRACE                         */ 00593000
ATFP100  MVI   WKFCODE(R12SVRB),X'64'                              0286 00594000
*                                                                  0287 00595000
*   /*****************************************************************/ 00596000
*   /*                                                               */ 00597000
*   /* SUBROUTINE PRIORITY SETS THE NEW TCB'S LIMIT AND DISPATCHING  */ 00598000
*   /* PRIORITIES.                                                   */ 00599000
*   /*                                                               */ 00600000
*   /*****************************************************************/ 00601000
*                                                                  0287 00602000
*/* S PRIORITY: PROCESS NEW TASK PRIORITY                            */ 00603000
*                                                                  0287 00604000
*   CALL PRIORITY;                  /* SET TCBLMP AND TCBDSP         */ 00605000
*                                                                  0287 00606000
         BAL   @14,PRIORITY                                        0287 00607000
*   /*****************************************************************/ 00608000
*   /*                                                               */ 00609000
*   /* GIVE AND SHARE SUBPOOL PROCESSING                             */ 00610000
*   /*                                                               */ 00611000
*   /*****************************************************************/ 00612000
*                                                                  0288 00613000
*ATFP110:                                                          0288 00614000
*   WKFCODE=FCODE110;               /* TRACE                         */ 00615000
ATFP110  MVI   WKFCODE(R12SVRB),X'6E'                              0288 00616000
*/* %FL01310: D (NO,%FL01320,YES,) GIVE SUBPOOL ?                    */ 00617000
*                                                                  0289 00618000
*   IF ATGSFLDBÂ¬=ZERO THEN                                         0289 00619000
         ICM   @08,7,ATGSFLDB(R3WORKAD)                            0289 00620000
         BZ    @RF00289                                            0289 00621000
*     DO;                           /* DO000018                      */ 00622000
*/* P SET GIVE SUBPOOL ENTRY CODE                                    */ 00623000
*                                                                  0291 00624000
*       RFY                                                        0291 00625000
*         R1WORK RSTD;                                             0291 00626000
*       RFY                                                        0292 00627000
*         R15RETCD RSTD;                                           0292 00628000
*       R1WORK=ENTCD0;              /* CALL IS FOR GIVE SP           */ 00629000
         SLR   R1WORK,R1WORK                                       0293 00630000
*/* S SPCONTRL: PROCESS GSPV/GSPL REQUEST                            */ 00631000
*                                                                  0294 00632000
*       CALL SPCONTRL;              /* GIVE SP                       */ 00633000
         BAL   @14,SPCONTRL                                        0294 00634000
*/* D (YES,AT001000,NO,) ANY ERRORS ?                                */ 00635000
*                                                                  0295 00636000
*       IF R15RETCDÂ¬=X00NOERR THEN                                 0295 00637000
         LTR   R15RETCD,R15RETCD                                   0295 00638000
         BNZ   @RT00295                                            0295 00639000
*         GOTO AT001000;            /* GO CLEAN UP                   */ 00640000
*     END;                          /* END00018                      */ 00641000
*/* %FL01320: D (NO,%FL01330,YES,) WAS SHSPV OR SHSPL SPECIFIED ?    */ 00642000
*                                                                  0298 00643000
*   IF ATSHFLDBÂ¬=ZERO THEN                                         0298 00644000
@RF00289 ICM   @14,7,ATSHFLDB(R3WORKAD)                            0298 00645000
         BZ    @RF00298                                            0298 00646000
*     DO;                           /* DO000019                      */ 00647000
*ATFP120:                                                          0300 00648000
*       WKFCODE=FCODE120;           /* TRACE                         */ 00649000
ATFP120  MVI   WKFCODE(R12SVRB),X'78'                              0300 00650000
*/* P SET SHARE SUBPOOL ENTRY CODE                                   */ 00651000
*                                                                  0301 00652000
*       R1WORK=ENTCD1;              /* CALL IS FOR SHARE SP          */ 00653000
         LA    R1WORK,1                                            0301 00654000
*/* S SPCONTRL: PROCESS SHARE REQUEST                                */ 00655000
*                                                                  0302 00656000
*       CALL SPCONTRL;              /* SHARE SP                      */ 00657000
         BAL   @14,SPCONTRL                                        0302 00658000
*/* D (YES,AT001000,NO,) ANY ERRORS ?                                */ 00659000
*                                                                  0303 00660000
*       IF R15RETCDÂ¬=X00NOERR THEN                                 0303 00661000
         LTR   R15RETCD,R15RETCD                                   0303 00662000
         BNZ   @RT00303                                            0303 00663000
*         GOTO AT001000;            /* GO CLEAN UP                   */ 00664000
*     END;                          /* END00019                      */ 00665000
*ATFP130:                                                          0306 00666000
*   WKFCODE=FCODE130;               /* TRACE                         */ 00667000
@RF00298 DS    0H                                                  0306 00668000
ATFP130  MVI   WKFCODE(R12SVRB),X'82'                              0306 00669000
*/* %FL01330: D (NO,%FL01340,YES,) WAS SZERO=YES SPECIFIED?          */ 00670000
*                                                                  0307 00671000
*   IF ATSZERO='0'B THEN                                           0307 00672000
         TM    ATSZERO(R3WORKAD),B'00001000'                       0307 00673000
         BNZ   @RF00307                                            0307 00674000
*     DO;                           /* DO000020                      */ 00675000
*/* P SET SHARE ZERO ENTRY CODE                                      */ 00676000
*                                                                  0309 00677000
*       R1WORK=ENTCD2;              /* SHARE 0 (THE DEFAULT)         */ 00678000
         LA    R1WORK,2                                            0309 00679000
*/* S SPCONTRL: SHARE SUBPOOL ZERO                                   */ 00680000
*                                                                  0310 00681000
*       CALL SPCONTRL;              /* SHARE 0                       */ 00682000
         BAL   @14,SPCONTRL                                        0310 00683000
*/* D (YES,AT001000,NO,) ANY ERRORS ?                                */ 00684000
*                                                                  0311 00685000
*       IF R15RETCDÂ¬=X00NOERR THEN                                 0311 00686000
         LTR   R15RETCD,R15RETCD                                   0311 00687000
         BNZ   @RT00311                                            0311 00688000
*         GOTO AT001000;            /* GO CLEAN UP                   */ 00689000
*     END;                          /* END00020                      */ 00690000
*   RFY                                                            0314 00691000
*     R1WORK UNRSTD;                                               0314 00692000
@RF00307 DS    0H                                                  0315 00693000
*   RFY                                                            0315 00694000
*     R15RETCD UNRSTD;                                             0315 00695000
*                                                                  0316 00696000
*   /*****************************************************************/ 00697000
*   /*                                                               */ 00698000
*   /* SPECIAL SHARE SUBPOOL PROCESSING FOR SWA : SUBPOOLS 236, 237  */ 00699000
*   /*                                                               */ 00700000
*   /*****************************************************************/ 00701000
*                                                                  0316 00702000
*/* %FL01340: S SWARTN: PROCESS SWA, SP 236 AND 237                  */ 00703000
*                                                                  0316 00704000
*   RFY                                                            0316 00705000
*     R15RETCD RSTD;                                               0316 00706000
*   CALL SWARTN;                    /* SUBRTN HANDLES 236, 237 SHARE */ 00707000
         BAL   @14,SWARTN                                          0317 00708000
*/* D (YES,AT001000,NO,) ANY ERRORS ?                                */ 00709000
*                                                                  0318 00710000
*   IF R15RETCDÂ¬=X00NOERR THEN                                     0318 00711000
         LTR   R15RETCD,R15RETCD                                   0318 00712000
         BNZ   @RT00318                                            0318 00713000
*     GOTO AT001000;                /* GO CLEAN UP                   */ 00714000
*   RFY                                                            0320 00715000
*     R15RETCD UNRSTD;                                             0320 00716000
*ATFP140:                                                          0321 00717000
*   WKFCODE=FCODE140;               /* TRACE                         */ 00718000
*                                                                  0321 00719000
ATFP140  MVI   WKFCODE(R12SVRB),X'8C'                              0321 00720000
*   /*****************************************************************/ 00721000
*   /*                                                               */ 00722000
*   /* CHAIN SPQES TO CURRENT TCB                                    */ 00723000
*   /*                                                               */ 00724000
*   /*****************************************************************/ 00725000
*                                                                  0322 00726000
*/* D (NO,%FL01440,YES,) ANY SPQES FOR CURRENT TCB ?                 */ 00727000
*                                                                  0322 00728000
*   IF WKTCBMSSÂ¬=ZERO THEN          /*                       @Z30ENVB*/ 00729000
         SLR   @08,@08                                             0322 00730000
         L     @07,WKTCBMSS(,R12SVRB)                              0322 00731000
         CR    @07,@08                                             0322 00732000
         BE    @RF00322                                            0322 00733000
*     DO;                           /* DO000028                      */ 00734000
*/* P CHAIN SPQES TO CURRENT TCB                                     */ 00735000
*                                                                  0324 00736000
*       RFY                                                        0324 00737000
*         R8WORK RSTD;                                             0324 00738000
*       R8WORK=WKTCBMSS;            /* GET DUMMY TCBMSS QUEUE PTR  0325 00739000
*                                                            @Z30ENVB*/ 00740000
         LR    R8WORK,@07                                          0325 00741000
*       WKTCBMSS=ZERO;              /* CLEAR WORKAREA'S DUMMY TCBMSS    00742000
*                                      QUEUE PTR             @Z30ENVB*/ 00743000
         SLR   @07,@07                                             0326 00744000
         ST    @07,WKTCBMSS(,R12SVRB)                              0326 00745000
*       IF R4CURTCB->TCBMSSB=ZERO THEN/* IS CURRENT TCB'S TCBMSS   0327 00746000
*                                      QUEUE EMPTY ?         @Z30ENVB*/ 00747000
         ICM   @07,7,TCBMSSB(R4CURTCB)                             0327 00748000
         BNZ   @RF00327                                            0327 00749000
*         WKSPQE1->LASTSPQE='1'B;   /* YES - SET END OF QUEUE BIT  0328 00750000
*                                                            @Z30ENVB*/ 00751000
         L     @07,WKSPQE1(,R3WORKAD)                              0328 00752000
         OI    LASTSPQE(@07),B'01000000'                           0328 00753000
*       ELSE                        /* NO                    @Z30ENVB*/ 00754000
*         WKSPQE1->SPQEPTR=R4CURTCB->TCBMSSB;/* CHAIN CURRENT TCB'S     00755000
*                                      SPQES TO END OF DUMMY TCBMSS     00756000
*                                      QUEUE                 @Z30ENVB*/ 00757000
         B     @RC00327                                            0329 00758000
@RF00327 L     @07,WKSPQE1(,R3WORKAD)                              0329 00759000
         SLR   @02,@02                                             0329 00760000
         ICM   @02,7,TCBMSSB(R4CURTCB)                             0329 00761000
         ST    @02,SPQEPTR(,@07)                                   0329 00762000
*       R4CURTCB->TCBMSSB=R8WORK;   /* CHAIN SPQES TO CURRENT TCB  0330 00763000
*                                                            @Z30ENVB*/ 00764000
@RC00327 STCM  R8WORK,7,TCBMSSB(R4CURTCB)                          0330 00765000
*       RFY                                                        0331 00766000
*         R8WORK UNRSTD;                                           0331 00767000
*     END;                          /* END00028                      */ 00768000
*/* %FL01440: P SET NEW TCB'S TCBRBP TO ADDR NEW SVRB                */ 00769000
*                                                                  0333 00770000
*   RFY                                                            0333 00771000
*     R1AREA RSTD;                                                 0333 00772000
@RF00322 DS    0H                                                  0334 00773000
*   R1AREA=R3WORKAD;                /* TOP OF SVRB (PREFIX)          */ 00774000
         LR    R1AREA,R3WORKAD                                     0334 00775000
*   GENERATE REFS(RBPRFXND,RBPRFXST) NOFLOWS;                      0335 00776000
         SPACE                                                          00777000
         LA    R3WORKAD,RBPRFXND-RBPRFXST(,R3WORKAD)                    00778000
         SPACE                                                          00779000
*   R5NEWTCB->TCBRBP=R3WORKAD;      /* NEW TCB'S RB PTR              */ 00780000
         ST    R3WORKAD,TCBRBP(,R5NEWTCB)                          0336 00781000
*/* P CLEAR WORKAREA IN SVRB TO ZERO                                 */ 00782000
*                                                                  0337 00783000
*   RFY                                                            0337 00784000
*     R7WORK RSTD;                                                 0337 00785000
*   R7WORK=ADDR(SVRBLEN);           /* LENGTH OF SVRB                */ 00786000
         LA    R7WORK,SVRBLEN                                      0338 00787000
*   AREA(1:R7WORK)=AREA(1:R7WORK)&&AREA(1:R7WORK);/* CLEAR SVRB      */ 00788000
         LR    @08,R7WORK                                          0339 00789000
         BCTR  @08,0                                               0339 00790000
         EX    @08,@SX03144                                        0339 00791000
*   RFY                                                            0340 00792000
*     R1AREA UNRSTD;                                               0340 00793000
*   RFY                                                            0341 00794000
*     R7WORK UNRSTD;                                               0341 00795000
*                                                                  0342 00796000
*   /*****************************************************************/ 00797000
*   /*                                                               */ 00798000
*   /* SVRB STORAGE, USED AS A WORK AREA UP TO THIS POINT, IS        */ 00799000
*   /* INITIALIZED AS AN SVRB BY ATTACH,AND IS USED BY ATTACH REENTRY*/ 00800000
*   /* AND LINK RUNNING UNDER THE NEW TCB. THE PSW IS SET SO THAT    */ 00801000
*   /* ATTACH GAINS CONTROL AT ENTRY POINT IGC042R1 WHEN THE NEW TASK*/ 00802000
*   /* IS DISPATCHED.                                                */ 00803000
*   /*                                                               */ 00804000
*   /*****************************************************************/ 00805000
*                                                                  0342 00806000
*/* P SET RBLINK = ADDR NEW TCB                                      */ 00807000
*                                                                  0342 00808000
*   RFY                                                            0342 00809000
*     RBSECT BASED(R3WORKAD);                                      0342 00810000
*   RFY                                                            0343 00811000
*     RBBASIC BASED(R3WORKAD);                                     0343 00812000
*   RBLINKB=R5NEWTCB;               /* FIRST RB POINTS TO TCB        */ 00813000
         STCM  R5NEWTCB,7,RBLINKB(R3WORKAD)                        0344 00814000
*/* P SET RBSIZE                                                     */ 00815000
*                                                                  0345 00816000
*   GENERATE REFS(RBSIZE) NOFLOWS;                                 0345 00817000
*                                                                  0345 00818000
         SPACE                                                          00819000
         MVI   RBSIZE+X1(R3WORKAD),SVRBDWDS SIZE OF SVRB IN DOUBLEWORDS 00820000
         SPACE                                                          00821000
*/* P SET SVRB INDICATOR BITS IN RBSTAB                              */ 00822000
*                                                                  0346 00823000
*   RBFTP='110'B;                   /* THIS IS AN SVRB               */ 00824000
         NI    RBFTP(R3WORKAD),B'11011111'                         0346 00825000
         OI    RBFTP(R3WORKAD),B'11000000'                         0346 00826000
*/* P SET RBTCBNXT=1, RBATTN=1, RBFDYN=1, RBNOCELL=1                 */ 00827000
*                                                                  0347 00828000
*   RBTCBNXT='1'B;                  /* THIS IS FIRST RB              */ 00829000
         OI    RBTCBNXT(R3WORKAD),B'10000000'                      0347 00830000
*   RBATTN='1'B;                    /* NO ATTENTIONS ALLOWED, SVC    */ 00831000
         OI    RBATTN(R3WORKAD),B'00100000'                        0348 00832000
*   RBFDYN='1'B;                    /* RB SHOULD BE FREED AT EXIT  0349 00833000
*                                                            @YM03499*/ 00834000
         OI    RBFDYN(R3WORKAD),B'00000010'                        0349 00835000
*   RBNOCELL='1'B;                  /* RB SHOULD BE FREEMAINED, NOT     00836000
*                                      FREECELLED            @YM03499*/ 00837000
         OI    RBNOCELL(R3WORKAD),B'10000000'                      0350 00838000
*/* P SET RBOPSW TO REENTER AT IGC042R1 WHEN NEW TASK DISPATCHED     */ 00839000
*                                                                  0351 00840000
*   RBOPSW=NEWPSW;                  /* SET EC MODE, ENABLED PSW      */ 00841000
         MVC   RBOPSW(8,R3WORKAD),NEWPSW                           0351 00842000
*/* P STORE REGISTERS INTO RBGRSAVE                                  */ 00843000
*                                                                  0352 00844000
*   RBGRSAVE=R4CURTCB->TCBRBP->RBGRSAVE;/* REGISTERS FOR ATTACHED  0352 00845000
*                                      PROGRAM               @YM00058*/ 00846000
         L     @08,TCBRBP(,R4CURTCB)                               0352 00847000
         MVC   RBGRSAVE(64,R3WORKAD),RBGRSAVE(@08)                 0352 00848000
*/* P ESTABLISH RBEXSAVE FOR LINK                                    */ 00849000
*                                                                  0353 00850000
*   RBEXSAVE=WKEXSAVE;              /* PASS TO REENTRY RTN           */ 00851000
         MVC   RBEXSAVE(48,R3WORKAD),WKEXSAVE(R12SVRB)             0353 00852000
*/* P ESTABLISH REGISTERS FOR REENTRY ROUTINE                        */ 00853000
*                                                                  0354 00854000
*   R5NEWTCB->TCBGRS3=R3WORKAD;     /* FOR REENTRY ROUTINE           */ 00855000
         ST    R3WORKAD,TCBGRS3(,R5NEWTCB)                         0354 00856000
*   R5NEWTCB->TCBGRS4=R5NEWTCB;     /* NEW TCB WILL BE CURRENT TCB 0355 00857000
*                                      WHEN REENTRY RTN IS DISPATCHED*/ 00858000
         ST    R5NEWTCB,TCBGRS4(,R5NEWTCB)                         0355 00859000
*   R5NEWTCB->TCBGRS5=ADDR(RBSECT); /* SVRB BECOMES CURRENT RB IN  0356 00860000
*                                      REENTRY ROUTINE               */ 00861000
         ST    R3WORKAD,TCBGRS5(,R5NEWTCB)                         0356 00862000
*   R5NEWTCB->TCBGRS6=R6BASE;       /* ADDRESSABILITY FOR REENTRY RTN*/ 00863000
         ST    R6BASE,TCBGRS6(,R5NEWTCB)                           0357 00864000
*   R5NEWTCB->TCBGRS9=R9BASE;       /* ADDRESSABILITY FOR REENTRY RTN*/ 00865000
         ST    R9BASE,TCBGRS9(,R5NEWTCB)                           0358 00866000
*   R5NEWTCB->TCBGRS10=WKGRS10;     /* ADDR OF DE OR ENTRY POINT     */ 00867000
         MVC   TCBGRS10(4,R5NEWTCB),WKGRS10(R12SVRB)               0359 00868000
*   R5NEWTCB->TCBGRS11=WKGRS11;     /* DCB ADDR OR 0                 */ 00869000
         MVC   TCBGRS11(4,R5NEWTCB),WKGRS11(R12SVRB)               0360 00870000
*   R5NEWTCB->TCBGRS12=ADDR(RBEXSAVE);/* ADDRESSABILITY FOR WKEXSAVE    00871000
*                                      (NOW IN NEW SVRB RBEXSAVE)    */ 00872000
*                                                                  0361 00873000
         LA    @08,RBEXSAVE(,R3WORKAD)                             0361 00874000
         ST    @08,TCBGRS12(,R5NEWTCB)                             0361 00875000
*   /*****************************************************************/ 00876000
*   /*                                                               */ 00877000
*   /* SUBROUTINE CHAIN PLACES NEW TCB ONTO READY QUEUE, PLACES NEW  */ 00878000
*   /* TCB ONTO FAMILY QUEUE, AND UPDATES TCB COUNTS IN ASCB, ASXB.  */ 00879000
*   /*                                                               */ 00880000
*   /*****************************************************************/ 00881000
*                                                                  0362 00882000
*ATFP150:                                                          0362 00883000
*   WKFCODE=FCODE150;               /* TRACE                         */ 00884000
ATFP150  MVI   WKFCODE(R12SVRB),X'96'                              0362 00885000
*/* S CHAIN: CHAIN NEW TCB ON DISPATCHING, FAMILY QUEUES             */ 00886000
*                                                                  0363 00887000
*   RFY                                                            0363 00888000
*     R15RETCD RSTD;                                               0363 00889000
*   CALL CHAIN;                     /* CHAIN NEW TCB                 */ 00890000
*                                                                  0364 00891000
         BAL   @14,CHAIN                                           0364 00892000
*   /*****************************************************************/ 00893000
*   /*                                                               */ 00894000
*   /* RETURN TO CALLER                                              */ 00895000
*   /*                                                               */ 00896000
*   /*****************************************************************/ 00897000
*                                                                  0365 00898000
*/* S UNLOCK: RELEASE LOCAL LOCK                                     */ 00899000
*                                                                  0365 00900000
*   CALL UNLOCK;                    /* RELEASE LOCK AND CANCEL FRR 0365 00901000
*                                      (ALTERS REGS 0,1,11,13,15)    */ 00902000
         BAL   @14,UNLOCK                                          0365 00903000
*/* AT001730: L FESTAE: CANCEL ESTAE EXIT                            */ 00904000
*                                                                  0366 00905000
*AT001730:                                                         0366 00906000
*   GEN(FESTAE 0,WRKREG=(R1WORK));  /* CANCEL ESTAE          @Z40FPYB*/ 00907000
AT001730 FESTAE 0,WRKREG=(R1WORK)                                       00908000
*/* P SET RETURN CODE = 0 FOR NORMAL EXIT                            */ 00909000
*                                                                  0367 00910000
*   R15RETCD=X00NOERR;              /* SET RETURN CODE = 0           */ 00911000
         SLR   R15RETCD,R15RETCD                                   0367 00912000
*/* P SET ADDRESS OF NEW TCB INTO REG 1 FOR RETURN TO CALLER         */ 00913000
*                                                                  0368 00914000
*   RFY                                                            0368 00915000
*     R1WORK RSTD;                                                 0368 00916000
*   R1WORK=R5NEWTCB;                /* RETURN NEW TCB ADDR IN REG 1  */ 00917000
         LR    R1WORK,R5NEWTCB                                     0369 00918000
*/* AT001710: P RESTORE REGS 0 AND 14                                */ 00919000
*                                                                  0370 00920000
*   RFY                                                            0370 00921000
*     R0WORK RSTD;                                                 0370 00922000
*   RFY                                                            0371 00923000
*     R14RET RSTD;                                                 0371 00924000
*AT001710:                                                         0372 00925000
*   R5CURRB=R4CURTCB->TCBRBP;       /* CURRENT RB ADDRESS            */ 00926000
AT001710 L     R5CURRB,TCBRBP(,R4CURTCB)                           0372 00927000
*   R0WORK=R5CURRB->RBGRS0;         /* RESTORE REG 0 FOR CALLER      */ 00928000
         L     R0WORK,RBGRS0(,R5CURRB)                             0373 00929000
*   R14RET=CVTEXPRO;                /* RESTORE REG 14 RETURN ADDRESS */ 00930000
*                                                                  0374 00931000
         L     @08,CVTPTR                                          0374 00932000
         L     R14RET,CVTEXPRO(,@08)                               0374 00933000
*   /*****************************************************************/ 00934000
*   /*                                                               */ 00935000
*   /* EXIT PROLOGUE RETURNS REGS 0,1, AND 15, AS RECEIVED FROM      */ 00936000
*   /* ATTACH, TO THE CALLER OF ATTACH                               */ 00937000
*   /*                                                               */ 00938000
*   /*****************************************************************/ 00939000
*                                                                  0375 00940000
*/* R RETURN TO CALLER VIA EXIT PROLOGUE                             */ 00941000
*                                                                  0375 00942000
*   GOTO R14RET;                    /* RETURN TO CALLER              */ 00943000
         BR    R14RET                                              0375 00944000
*   RFY                                                            0376 00945000
*     R0WORK UNRSTD;                                               0376 00946000
*   RFY                                                            0377 00947000
*     R14RET UNRSTD;                                               0377 00948000
*   RFY                                                            0378 00949000
*     R15RETCD UNRSTD;                                             0378 00950000
*                                                                  0379 00951000
*   /*****************************************************************/ 00952000
*   /*                                                               */ 00953000
*   /* ERROR PROCESSING                                              */ 00954000
*   /*                                                               */ 00955000
*   /*****************************************************************/ 00956000
*                                                                  0379 00957000
*/*  AT001000: S RTN1: PERFORM CLEAN UP                              */ 00958000
*                                                                  0379 00959000
*AT001000:                                                         0379 00960000
*   RFY                                                            0379 00961000
*     R7WORK RSTD;                                                 0379 00962000
AT001000 DS    0H                                                  0380 00963000
*   RFY                                                            0380 00964000
*     R15RETCD RSTD;                                               0380 00965000
*   R7WORK=R4CURTCB->TCBRBP;        /* ADDRESS OF CURRENT SVRB       */ 00966000
         L     R7WORK,TCBRBP(,R4CURTCB)                            0381 00967000
*   R7WORK->RBGRS15=R15RETCD;       /* SAVE ERROR CODE               */ 00968000
         ST    R15RETCD,RBGRS15(,R7WORK)                           0382 00969000
*   CALL RTN1;                      /* GO TO CLEAN UP ROUTINE        */ 00970000
         BAL   @14,RTN1                                            0383 00971000
*/* L FESTAE: CANCEL ESTAE EXIT                                      */ 00972000
*                                                                  0384 00973000
*   GEN(FESTAE 0,WRKREG=(R7WORK));  /* CANCEL ESTAE          @Z40FPYB*/ 00974000
         FESTAE 0,WRKREG=(R7WORK)                                       00975000
*   R7WORK=R4CURTCB->TCBRBP;        /* ADDRESS OF CURRENT SVRB       */ 00976000
         L     R7WORK,TCBRBP(,R4CURTCB)                            0385 00977000
*   R15RETCD=R7WORK->RBGRS15;       /* RESTORE ERROR CODE            */ 00978000
         L     R15RETCD,RBGRS15(,R7WORK)                           0386 00979000
*   RFY                                                            0387 00980000
*     R7WORK UNRSTD;                                               0387 00981000
*                                                                  0387 00982000
*/* D (NO,%FL01460,YES,) IS AN ABEND ERROR INDICATED ?               */ 00983000
*                                                                  0388 00984000
*   IF R15RETCD>=ABEND12A THEN                                     0388 00985000
         CH    R15RETCD,@CH02700                                   0388 00986000
         BL    @RF00388                                            0388 00987000
*     DO;                           /* DO000030                      */ 00988000
*/* L () ABEND: TERMINATE CURRENT TASK                               */ 00989000
*                                                                  0390 00990000
*       R1WORK=R15RETCD;            /* ABEND CODE                    */ 00991000
         LR    R1WORK,R15RETCD                                     0390 00992000
*       R15RETCD=WKREASON;          /* REASON CODE OR ZERO           */ 00993000
         SLR   R15RETCD,R15RETCD                                   0391 00994000
         IC    R15RETCD,WKREASON(,R12SVRB)                         0391 00995000
*       GENERATE EXIT NOSEQFLOW;                                   0392 00996000
         SPACE                                                          00997000
         ABEND (1),DUMP,,SYSTEM        ISSUE ABEND                      00998000
         SPACE                                                          00999000
*     END;                          /* END00030: END ABEND PROCESSING*/ 01000000
*/* %FL01460: P (,AT001710) SET REG 1 = 0, NO NEW TCB                */ 01001000
*                                                                  0394 01002000
*   R1WORK=ZERO;                    /* CLEAR REG 1, NO NEW TCB       */ 01003000
@RF00388 SLR   R1WORK,R1WORK                                       0394 01004000
*   GOTO AT001710;                  /* GO EXIT FROM ATTACH, WITH   0395 01005000
*                                      RETURN CODE AS ALREADY SET    */ 01006000
         B     AT001710                                            0395 01007000
*   RFY                                                            0396 01008000
*     R1WORK UNRSTD;                                               0396 01009000
*   RFY                                                            0397 01010000
*     R15RETCD UNRSTD;                                             0397 01011000
*                                                                  0397 01012000
*/* ATTACH: END FLOWCHART FOR IGC0004B - SVC ATTACH - MAINLINE       */ 01013000
*                                                                  0398 01014000
*IGC042R1:                                                         0398 01015000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0398 01016000
*                                                                  0398 01017000
IGC042R1 DS    0H                                                  0399 01018000
*/* IGC042R1: CHART FOR ATTACH REENTRY ROUTINE                       */ 01019000
*/* FOOTING                                                        0399 01020000
*/* REENTRY ROUTINE                                                  */ 01021000
*/********************************************************************/ 01022000
*/*                                                                  */ 01023000
*/*    THIS ROUTINE IS THE FIRST CODE EXECUTED UNDER THE NEW TASK.   */ 01024000
*/*    IF SVAREA=YES WAS SPECIFIED, A PROBLEM PROGRAM SAVE AREA IS   */ 01025000
*/*    OBTAINED, FROM SUBPOOL 250, AND CHAINED OFF TCBFSA. THE SVRB  */ 01026000
*/*    AND REGISTERS ARE SET UP FOR LINK, AND THE LINK SERVICE       */ 01027000
*/*    ROUTINE IS ENTERED AT BRANCH ENTRY POINT IEAQCS01. CONTROL IS */ 01028000
*/*    NOT RETURNED TO ATTACH.                                       */ 01029000
*/*                                                                  */ 01030000
*/*    REGISTER USAGE - REGISTERS UPON ENTRY ARE AS IN THE SVRB'S    */ 01031000
*/*                     RBGRSAVE FIELD, AS SET IN ATTACH MAINLINE:   */ 01032000
*/*                                                                  */ 01033000
*/*    R0WORK   - OUTPUT, ADDRESS OF ENTRY POINT NAME, OR            */ 01034000
*/*               COMPLEMENTED ADDRESS OF DE.                        */ 01035000
*/*    R1AREA   - OUTPUT, ADDRESS OF DCB AS SPECIFIED ON ATTACH      */ 01036000
*/*               MACRO, OR ZERO                                     */ 01037000
*/*    R3WORKAD - INPUT, ADDRESS OF NEW (CURRENT) SVRB               */ 01038000
*/*             - OUTPUT, ADDRESS OF CVT (INPUT CONTENTS SWITCHES)   */ 01039000
*/*    R4CURTCB - ADDRESS OF THE NEW TCB, NOW THE CURRENT TCB        */ 01040000
*/*    R5CURRB  - ADDRESS OF THE NEW SVRB, NOW THE CURRENT RB        */ 01041000
*/*    R6BASE   - ADDRESS OF IGC0004B, ENTRY POINT TO SVC ATTACH     */ 01042000
*/*             - OUTPUT, ADDRESS OF IEAQCS01, LINK BRANCH ENTRY     */ 01043000
*/*    R9BASE   - INPUT, R6BASE + 4096                               */ 01044000
*/*    R10WORK  - INPUT, SAME AS R0WORK OUTPUT                       */ 01045000
*/*    R11WORK  - INPUT, SAME AS R1AREA OUTPUT                       */ 01046000
*/*    R12SVRB  - INPUT, ADDRESS OF RBEXSAVE                         */ 01047000
*/*                                                                  */ 01048000
*/********************************************************************/ 01049000
*/* IGC042R1: E REENTRY FROM DISPATCHER                              */ 01050000
*                                                                  0399 01051000
*   RFY                                                            0399 01052000
*     R10WORK RSTD;                                                0399 01053000
*   RFY                                                            0400 01054000
*     R11WORK RSTD;                                                0400 01055000
*                                                                  0400 01056000
*/* D (NO,%FL01500,YES,) WAS SVAREA=YES SPECIFIED ?                  */ 01057000
*                                                                  0401 01058000
*   IF WKSVAREA='0'B THEN                                          0401 01059000
         TM    WKSVAREA(R12SVRB),B'10000000'                       0401 01060000
         BNZ   @RF00401                                            0401 01061000
*     DO;                           /* DO000040                      */ 01062000
*       RFY                                                        0403 01063000
*         R1AREA RSTD;                                             0403 01064000
*       RFY                                                        0404 01065000
*         R0WORK RSTD;                                             0404 01066000
*       GENERATE SETS(R0WORK,R1AREA) NOFLOWS;                      0405 01067000
         SPACE                                                          01068000
*/* L (,%FL01510) GETMAIN: OBTAIN PROBLEM PGM SAVE AREA, SP 250      */ 01069000
         SPACE                                                          01070000
         GETMAIN R,LV=SALENGTH,SP=SP250EQU OBTAIN SAVE AREA             01071000
         USING TCB,R4CURTCB ADDRESSABILITY FOR TCB KEY         @ZA30792 01072000
         MODESET  EXTKEY=TCB,WORKREG=2 GET IN SAME KEY AS TCB  @ZA30792 01073000
         XC   C0(SALENGTH,R1AREA),C0(R1AREA)    CLEAR AREA     @ZA25845 01074000
         MODESET  EXTKEY=ZERO,WORKREG=2 RETURN TO KEY ZERO     @ZA30792 01075000
         DROP R4CURTCB          DROP ADDRESSIBILITY            @ZA30792 01076000
*     END;                          /* END00040                      */ 01077000
*/* %FL01500: P SET REG 1 = 0, NO PP SAVE AREA                       */ 01078000
*                                                                  0407 01079000
*   ELSE                                                           0407 01080000
*     R1AREA=ZERO;                  /* CLEAR POINTER, NO SAVE AREA   */ 01081000
         B     @RC00401                                            0407 01082000
@RF00401 SLR   R1AREA,R1AREA                                       0407 01083000
*/* %FL01510: P SET TCBFSA = REG 1, RBGRS13 = REG 1                  */ 01084000
*                                                                  0408 01085000
*   R4CURTCB->TCBFSAB=R1AREA;       /* SAVE AREA ADDR OR ZERO        */ 01086000
@RC00401 STCM  R1AREA,7,TCBFSAB(R4CURTCB)                          0408 01087000
*   R5CURRB->RBGRS13=R1AREA;        /* SAVE AREA ADDR, OR ZERO       */ 01088000
         ST    R1AREA,RBGRS13(,R5CURRB)                            0409 01089000
*/* P CLEAR RESERVED PORTION OF SVRB EXTENDED SAVE AREA              */ 01090000
*                                                                  0410 01091000
*   R1AREA=ADDR(RBEXSAVE)+LENGTH(WKNEWXSA);/* ADDR RESERVED          */ 01092000
         LA    R1AREA,RBEXSAVE(,R3WORKAD)                          0410 01093000
         AH    R1AREA,@CH02795                                     0410 01094000
*   RFY                                                            0411 01095000
*     R7WORK RSTD;                                                 0411 01096000
*   R7WORK=LENGTH(RBEXSAVE)-LENGTH(WKNEWXSA);/* LENGTH               */ 01097000
         LA    R7WORK,39                                           0412 01098000
*   AREA(1:R7WORK)=AREA(1:R7WORK)&&AREA(1:R7WORK);/* CLEAR           */ 01099000
         LR    @08,R7WORK                                          0413 01100000
         BCTR  @08,0                                               0413 01101000
         EX    @08,@SX03144                                        0413 01102000
*   RFY                                                            0414 01103000
*     R7WORK UNRSTD;                                               0414 01104000
*                                                                  0414 01105000
*/* P ESTABLISH REGISTERS FOR LINK BRANCH ENTRY                      */ 01106000
*                                                                  0415 01107000
*   R0WORK=R10WORK;                 /* ESTABLISH REG 0, ADDRESS OF EP   01108000
*                                      NAME OR COMPLEMENTED ADDRESS     01109000
*                                      OF DE                         */ 01110000
         LR    R0WORK,R10WORK                                      0415 01111000
*   R1AREA=R11WORK;                 /* ESTABLISH REG 1, 0 OR DCB   0416 01112000
*                                      ADDRESS, FROM DCB PARAMETER   */ 01113000
         LR    R1AREA,R11WORK                                      0416 01114000
*   R3WORK=CVTPTR;                  /* ADDRESS OF CVT                */ 01115000
         L     R3WORK,CVTPTR                                       0417 01116000
*   RFY                                                            0418 01117000
*     R7ASCB RSTD;                                                 0418 01118000
*   R7ASCB=PSAAOLD;                 /* ASCB ADDRESS                  */ 01119000
*                                                                  0419 01120000
         L     R7ASCB,PSAAOLD                                      0419 01121000
*   /*****************************************************************/ 01122000
*   /*                                                               */ 01123000
*   /* REGS 4, AND 5 ALREADY PROPERLY SET                            */ 01124000
*   /*                                                               */ 01125000
*   /*****************************************************************/ 01126000
*                                                                  0420 01127000
*   R6BASE=R3WORK->CVTQCS01;        /* LINK BRANCH ENTRY ADDRESS   0420 01128000
*                                      IEAQCS01                      */ 01129000
         L     R6BASE,CVTQCS01(,R3WORK)                            0420 01130000
*/* R BRANCH TO LINK ENTRY POINT IEAQCS01                            */ 01131000
*                                                                  0421 01132000
*   GOTO R6BASE;                    /* PASS CONTROL TO LINK          */ 01133000
         BR    R6BASE                                              0421 01134000
*/* IGC042R1: END FLOWCHART FOR REENTRY ROUTINE                      */ 01135000
*                                                                  0422 01136000
*   RFY                                                            0422 01137000
*     R0WORK UNRSTD;                                               0422 01138000
*   RFY                                                            0423 01139000
*     R1AREA UNRSTD;                                               0423 01140000
*   RFY                                                            0424 01141000
*     R7ASCB UNRSTD;                                               0424 01142000
*   RFY                                                            0425 01143000
*     R10WORK UNRSTD;                                              0425 01144000
*   RFY                                                            0426 01145000
*     R11WORK UNRSTD;                                              0426 01146000
*   END IGC042R1;                   /* END REENTRY ROUTINE           */ 01147000
*   RFY                                                            0428 01148000
*     RBSECT BASED(RBSECPTR);                                      0428 01149000
*   RFY                                                            0429 01150000
*     RBBASIC BASED(RBSECPTR);                                     0429 01151000
*                                                                  0430 01152000
*   /*****************************************************************/ 01153000
*   /*                                                               */ 01154000
*   /* GETCBS SUBROUTINE                                             */ 01155000
*   /*                                                               */ 01156000
*   /*****************************************************************/ 01157000
*                                                                  0430 01158000
*GETCBS:                                                           0430 01159000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0430 01160000
*                                                                  0430 01161000
GETCBS   DS    0H                                                  0431 01162000
*/* GETCBS: CHART (AREF) FLOWCHART SUBROUTINE GETCBS                 */ 01163000
*/* FOOTING                                                        0431 01164000
*/* SUBROUTINE OBTAINS TCB IQE IRB                                   */ 01165000
*/********************************************************************/ 01166000
*/*                                                                  */ 01167000
*/*    THIS SUBROUTINE OBTAINS STORAGE FOR THE NEW TCB,AND ALSO FOR  */ 01168000
*/*    AN IQE, AND AN IRB, IF NECESSARY. THE STORAGE IS CLEARED TO   */ 01169000
*/*    ZERO BEFORE USE. IF ACQUIRED, THE IRB AND IQE ARE INITIALIZED */ 01170000
*/*    AND CHAINED OFF THE NEW TCB.                                  */ 01171000
*/*                                                                  */ 01172000
*/* SUBROUTINES CALLED: UNLOCK                                       */ 01173000
*/*                                                                  */ 01174000
*/* SYSTEM ROUTINES CALLED / MACROS ISSUED:                          */ 01175000
*/*                                 GETMAIN SVC                      */ 01176000
*/*                                 CIRB SVC                         */ 01177000
*/*                                                                  */ 01178000
*/* RETURN CODES SET: X00NOERR, AND THE ERROR CODE FROM UNLOCK       */ 01179000
*/*                                                                  */ 01180000
*/* REGISTER USAGE: R5NEWTCB - OUTPUT, ADDRESS OF THE NEW TCB        */ 01181000
*/*                                                                  */ 01182000
*/********************************************************************/ 01183000
*/* E ENTER GETCBS                                                   */ 01184000
*                                                                  0431 01185000
*   RFY                                                            0431 01186000
*     R14RET RSTD;                                                 0431 01187000
*   WKRTSAVE=R14RET;                /* SAVE AROUND MACROS, UNLOCK    */ 01188000
         ST    R14RET,WKRTSAVE(,R3WORKAD)                          0432 01189000
*   RFY                                                            0433 01190000
*     R14RET UNRSTD;                                               0433 01191000
*                                                                  0433 01192000
*/* D (NO,%FL01060,YES,) WAS ETXR SPECIFIED ?                        */ 01193000
*                                                                  0434 01194000
*   IF ATETXRBÂ¬=ZERO THEN           /* IF ETXR ADDR PARM SPECIFIED,  */ 01195000
         ICM   @08,7,ATETXRB(R3WORKAD)                             0434 01196000
         BZ    @RF00434                                            0434 01197000
*     DO;                           /* DO000008: AN IQE AND POSSIBLY    01198000
*                                      IRB NEEDED                    */ 01199000
*                                                                  0435 01200000
*       /*************************************************************/ 01201000
*       /*                                                           */ 01202000
*       /* CHECK FOR A SUBTASK HAVING AN IQE WHICH POINTS TO AN IRB  */ 01203000
*       /* WHICH CAN ALSO BE USED FOR THIS REQUEST.                  */ 01204000
*       /*                                                           */ 01205000
*       /*************************************************************/ 01206000
*                                                                  0436 01207000
*       RFY                                                        0436 01208000
*         R2WORK RSTD;                                             0436 01209000
*       RFY                                                        0437 01210000
*         R7IQE RSTD;                                              0437 01211000
*       RFY                                                        0438 01212000
*         R8IRB RSTD;                                              0438 01213000
*       R2WORK=R4CURTCB->TCBLTC;    /* ADDR OF FIRST SUBTASK         */ 01214000
         L     R2WORK,TCBLTC(,R4CURTCB)                            0439 01215000
*       DO WHILE(R2WORKÂ¬=0);        /* DO000010: CHECK ALL SUBTASKS  */ 01216000
         B     @DE00440                                            0440 01217000
@DL00440 DS    0H                                                  0441 01218000
*/* %FL01080: D (NO,%FL01070,YES,) IS THERE A SUBTASK ?              */ 01219000
*                                                                  0441 01220000
*         R7IQE=R2WORK->TCBIQE;     /* ETXR IQE ADDR                 */ 01221000
         L     R7IQE,TCBIQE(,R2WORK)                               0441 01222000
*/* D (NO,AT001090,YES,) IS THERE AN ETXR IQE ?                      */ 01223000
*                                                                  0442 01224000
*         IF R7IQE=ZERO THEN        /* IS THERE AN IQE ?             */ 01225000
         LTR   R7IQE,R7IQE                                         0442 01226000
         BZ    @RT00442                                            0442 01227000
*           GOTO AT001090;          /* NO, CHECK NEXT SUBTASK        */ 01228000
*         R8IRB=R7IQE->IQEIRB;      /* ETXR IRB ADDR                 */ 01229000
         L     R8IRB,IQEIRB(,R7IQE)                                0444 01230000
*/* D (NO,AT001090,YES,) IS IRB'S ENTRY ADDR = ETXR ADDR ?           */ 01231000
*                                                                  0445 01232000
*         IF ATETXRB=R8IRB->RBEP THEN/* IRB FOR SAME EXIT RTN ?      */ 01233000
         SLR   @15,@15                                             0445 01234000
         ICM   @15,7,ATETXRB(R3WORKAD)                             0445 01235000
         C     @15,RBEP(,R8IRB)                                    0445 01236000
         BNE   @RF00445                                            0445 01237000
*           DO;                     /* DO000009: YES, REUSE THIS IRB */ 01238000
*/* P INCREMENT IRB USE COUNT BY 1                                   */ 01239000
*                                                                  0447 01240000
*             R8IRB->RBUSE=R8IRB->RBUSE+ONE;/* USE COUNT             */ 01241000
         LA    @15,1                                               0447 01242000
         SLR   @14,@14                                             0447 01243000
         IC    @14,RBUSE(,R8IRB)                                   0447 01244000
         ALR   @15,@14                                             0447 01245000
         STC   @15,RBUSE(,R8IRB)                                   0447 01246000
*/* S UNLOCK: RELEASE LOCAL LOCK                                     */ 01247000
*                                                                  0448 01248000
*             RFY                                                  0448 01249000
*               R15RETCD RSTD;                                     0448 01250000
*             CALL UNLOCK;          /* RELEASE LOCAL LOCK (ALTERS  0449 01251000
*                                      REGS 0,1,11,13,15)            */ 01252000
         BAL   @14,UNLOCK                                          0449 01253000
*/* D (YES,AT001390,NO,) ANY ERRORS ?                                */ 01254000
*                                                                  0450 01255000
*             IF R15RETCDÂ¬=X00NOERR THEN/* IF ERROR OCCURRED         */ 01256000
         LTR   R15RETCD,R15RETCD                                   0450 01257000
         BNZ   @RT00450                                            0450 01258000
*               GOTO AT001390;      /* GO TO EXIT                    */ 01259000
*             RFY                                                  0452 01260000
*               R15RETCD UNRSTD;                                   0452 01261000
*ATFP50:                                                           0453 01262000
*             WKFCODE=FCODE50;      /* LOCK RELEASED                 */ 01263000
*                                                                  0453 01264000
ATFP50   MVI   WKFCODE(R12SVRB),X'32'                              0453 01265000
*             /*******************************************************/ 01266000
*             /*                                                     */ 01267000
*             /* OBTAIN STORAGE FOR TCB AND IQE                      */ 01268000
*             /*                                                     */ 01269000
*             /*******************************************************/ 01270000
*                                                                  0454 01271000
*/* L (,AT001100) GETMAIN FOR TCB, IQE, FROM SUBPOOL 253             */ 01272000
*                                                                  0454 01273000
*             RFY                                                  0454 01274000
*               R0WORK RSTD;                                       0454 01275000
*             RFY                                                  0455 01276000
*               R1AREA RSTD;                                       0455 01277000
*             R0WORK=LENGTH(TCBFIX)+LENGTH(TCB)+LENGTH(TCBXTNT2)+LENGTH 01278000
*                 (IQESECT);        /* GETMAIN LENGTH                */ 01279000
         LA    R0WORK,384                                          0456 01280000
*             GENERATE SETS(R1AREA) REFS(R0WORK,SPID253) NOFLOWS;  0457 01281000
         SPACE                                                          01282000
         ICM   R0WORK,8,SPID253        SET SP ID INTO HIGH ORDER BYTE   01283000
         GETMAIN R,LV=(0)              GET STORAGE FOR TCB, IQE         01284000
         SPACE                                                          01285000
*             RFY                                                  0458 01286000
*               R0WORK UNRSTD;                                     0458 01287000
*             R7IQE=R1AREA;         /* IQE ADDR                      */ 01288000
         LR    R7IQE,R1AREA                                        0459 01289000
*             RFY                                                  0460 01290000
*               R1AREA UNRSTD;                                     0460 01291000
*             GOTO AT001100;        /* GO PROCESS TCB, IQE           */ 01292000
         B     AT001100                                            0461 01293000
*           END;                    /* END00009                      */ 01294000
*/* AT001090: P (,%FL01080) GET NEXT SUBTASK PTR                     */ 01295000
*                                                                  0463 01296000
*AT001090:                                                         0463 01297000
*         R2WORK=R2WORK->TCBNTC;    /* ADDR NEXT SUBTASK             */ 01298000
@RF00445 DS    0H                                                  0463 01299000
AT001090 L     R2WORK,TCBNTC(,R2WORK)                              0463 01300000
*       END;                        /* END00010                      */ 01301000
@DE00440 LTR   R2WORK,R2WORK                                       0464 01302000
         BNZ   @DL00440                                            0464 01303000
*       RFY                                                        0465 01304000
*         R2WORK UNRSTD;                                           0465 01305000
*       RFY                                                        0466 01306000
*         R7IQE UNRSTD;                                            0466 01307000
*       RFY                                                        0467 01308000
*         R8IRB UNRSTD;                                            0467 01309000
*                                                                  0467 01310000
*       /*************************************************************/ 01311000
*       /*                                                           */ 01312000
*       /* NO REUSABLE IRB EXISTS, NEED STORAGE FOR TCB, IRB, IQE    */ 01313000
*       /*                                                           */ 01314000
*       /*************************************************************/ 01315000
*                                                                  0468 01316000
*/* %FL01070: S UNLOCK: RELEASE LOCAL LOCK                           */ 01317000
*                                                                  0468 01318000
*       RFY                                                        0468 01319000
*         R15RETCD RSTD;                                           0468 01320000
*       CALL UNLOCK;                /* RELEASE LOCAL LOCK            */ 01321000
         BAL   @14,UNLOCK                                          0469 01322000
*/* D (YES,AT001390,NO,) ANY ERRORS ?                                */ 01323000
*                                                                  0470 01324000
*       IF R15RETCDÂ¬=X00NOERR THEN  /* CHECK FOR ERROR IN UNLOCK     */ 01325000
         LTR   R15RETCD,R15RETCD                                   0470 01326000
         BNZ   @RT00470                                            0470 01327000
*         GOTO AT001390;            /* ON ERROR, GO EXIT             */ 01328000
*       RFY                                                        0472 01329000
*         R15RETCD UNRSTD;                                         0472 01330000
*ATFP60:                                                           0473 01331000
*       WKFCODE=FCODE60;            /* LOCK RELEASED                 */ 01332000
ATFP60   MVI   WKFCODE(R12SVRB),X'3C'                              0473 01333000
*/* L CIRB: BUILD IRB AND GET STORAGE FOR TCB,IQE FROM SUBPOOL 253   */ 01334000
*/*       CIRB SVC BUILDS AN IRB,WITH PROBLEM PROGRAM SAVE AREA IN   */ 01335000
*/*       SUBPOOL 250. STORAGE FOR A TCB AND AN IQE IS OBTAINED.     */ 01336000
*/*       THE IRB AND THE STORAGE FOR THE TCB AND IQE ARE IN SUB-    */ 01337000
*/*       POOL 253.                                                  */ 01338000
*                                                                  0474 01339000
*       RFY                                                        0474 01340000
*         R0WORK RSTD;                                             0474 01341000
*       RFY                                                        0475 01342000
*         R1AREA RSTD;                                             0475 01343000
*       R0WORK=ATETXRB;             /* ENTRY POINT ADDR              */ 01344000
         SLR   R0WORK,R0WORK                                       0476 01345000
         ICM   R0WORK,7,ATETXRB(R3WORKAD)                          0476 01346000
*       R1WORK=(LENGTH(CIRBAREA)/EIGHT);/* NEW TCB AND IQE IN      0477 01347000
*                                      WORKAREA                      */ 01348000
         LA    R1WORK,48                                           0477 01349000
*       GENERATE REFS(R0WORK,R1AREA) SETS(R1AREA) NOFLOWS;         0478 01350000
         SPACE                                                          01351000
         CIRB  EP=(0),STAB=(DYN),SVAREA=YES,RETIQE=NO,                 *01352000
               WKAREA=(1)                                               01353000
         SPACE                                                          01354000
*       RFY                                                        0479 01355000
*         R0WORK UNRSTD;                                           0479 01356000
*       RFY                                                        0480 01357000
*         R8IRB RSTD;                                              0480 01358000
*       RFY                                                        0481 01359000
*         R7IQE RSTD;                                              0481 01360000
*       R8IRB=R1AREA;               /* ADDRESS OF THE NEW IRB        */ 01361000
         LR    R8IRB,R1AREA                                        0482 01362000
*       R7IQE=R1AREA+ADDR(IRBLEN)-ADDR(RBPRFLNA);/* IQE ADDR         */ 01363000
         LA    R7IQE,IRBLEN                                        0483 01364000
         ALR   R7IQE,R1AREA                                        0483 01365000
         LA    @02,RBPRFLNA                                        0483 01366000
         SLR   R7IQE,@02                                           0483 01367000
*       RFY                                                        0484 01368000
*         R1AREA UNRSTD;                                           0484 01369000
*                                                                  0484 01370000
*/* P SET RBETXR=1 RBIQETP=RBIQENR RBUSE=1 AND RBSIZE                */ 01371000
*                                                                  0485 01372000
*       R8IRB->RBETXR='1'B;         /* INDICATE ETXR IRB             */ 01373000
         OI    RBETXR(R8IRB),B'00010000'                           0485 01374000
*       R8IRB->RBIQETP='10'B;       /* FREE IQE UPON EXIT            */ 01375000
         NI    RBIQETP(R8IRB),B'11111011'                          0486 01376000
         OI    RBIQETP(R8IRB),B'00001000'                          0486 01377000
*       R8IRB->RBUSE=ONE;           /* SET INITIAL USE COUNT = 1     */ 01378000
         MVI   RBUSE(R8IRB),X'01'                                  0487 01379000
*       RFY                                                        0488 01380000
*         R0WORK RSTD;                                             0488 01381000
*       GENERATE REFS(R0WORK,R8IRB,RBSIZE) NOFLOWS;                0489 01382000
         SPACE                                                          01383000
         LA    R0WORK,IRBDWDS          SIZE OF IRB IN DOUBLEWORDS       01384000
         STH   R0WORK,RBSIZE(,R8IRB)     INTO IRB                       01385000
         SPACE                                                          01386000
*       RFY                                                        0490 01387000
*         R0WORK UNRSTD;                                           0490 01388000
*                                                                  0490 01389000
*/* AT001100: P CLEAR TCB AND IQE STORAGE TO ZERO                    */ 01390000
*                                                                  0491 01391000
*AT001100:                          /* PROCESS TCB, IQE              */ 01392000
*       RFY                                                        0491 01393000
*         R1AREA RSTD;                                             0491 01394000
AT001100 DS    0H                                                  0492 01395000
*       R1AREA=R7IQE;               /* ADDRESSING REGISTER           */ 01396000
         LR    R1AREA,R7IQE                                        0492 01397000
*       AREA=AREA&&AREA;            /* CLEAR 256 BYTES CLEAR       0493 01398000
*                                      REMAINING PORTION             */ 01399000
         XC    AREA(256,R1AREA),AREA(R1AREA)                       0493 01400000
*       EVAL(R1AREA+LENGTH(AREA))->AREA(1:LENGTH(TCBFIX)+LENGTH(TCB)+   01401000
*           LENGTH(TCBXTNT2)+LENGTH(IQESECT)-LENGTH(AREA))=EVAL(R1AREA+ 01402000
*           LENGTH(AREA))->AREA(1:LENGTH(TCBFIX)+LENGTH(TCB)+LENGTH(    01403000
*           TCBXTNT2)+LENGTH(IQESECT)-LENGTH(AREA))&&EVAL(R1AREA+LENGTH 01404000
*           (AREA))->AREA(1:LENGTH(TCBFIX)+LENGTH(TCB)+LENGTH(TCBXTNT2) 01405000
*           +LENGTH(IQESECT)-LENGTH(AREA));                        0494 01406000
         LA    @02,256                                             0494 01407000
         ALR   @02,R1AREA                                          0494 01408000
         XC    AREA(128,@02),AREA(@02)                             0494 01409000
*       RFY                                                        0495 01410000
*         R1AREA UNRSTD;                                           0495 01411000
*       R5NEWTCB=R7IQE+LENGTH(IQESECT)+LENGTH(TCBFIX);/* ADDR NEW TCB*/ 01412000
         LA    R5NEWTCB,56                                         0496 01413000
         ALR   R5NEWTCB,R7IQE                                      0496 01414000
*/* P SET TCBIQE = IQE ADDR, TCBETXR = 1                             */ 01415000
*                                                                  0497 01416000
*       R5NEWTCB->TCBIQE=R7IQE;     /* IQE ADDR INTO NEW TCB         */ 01417000
         ST    R7IQE,TCBIQE(,R5NEWTCB)                             0497 01418000
*       R5NEWTCB->TCBFETXR='1'B;    /* ETXR FLAG ON                  */ 01419000
         OI    TCBFETXR(R5NEWTCB),B'00000010'                      0498 01420000
*/* P (,%FL01390) INITIALIZE NEW IQE                                 */ 01421000
*                                                                  0499 01422000
*       R7IQE->IQEIRB=R8IRB;        /* IRB ADDR INTO NEW IQE         */ 01423000
         ST    R8IRB,IQEIRB(,R7IQE)                                0499 01424000
*       RFY                                                        0500 01425000
*         R8IRB UNRSTD;                                            0500 01426000
*       R7IQE->IQETCB=R4CURTCB;     /* CURRENT TCB ADDR INTO NEW IQE */ 01427000
         ST    R4CURTCB,IQETCB(,R7IQE)                             0501 01428000
*       R7IQE->IQEPARAM=R5NEWTCB;   /* NEW TCB ADDR INTO NEW IQE     */ 01429000
         ST    R5NEWTCB,IQEPARAM(,R7IQE)                           0502 01430000
*       RFY                                                        0503 01431000
*         R7IQE UNRSTD;                                            0503 01432000
*     END;                          /* END00008: END ETXR PROCESSING */ 01433000
*                                                                  0504 01434000
*   /*****************************************************************/ 01435000
*   /*                                                               */ 01436000
*   /* ETXR NOT SPECIFIED, ONLY NEED NEW TCB                         */ 01437000
*   /*                                                               */ 01438000
*   /*****************************************************************/ 01439000
*                                                                  0505 01440000
*   ELSE                                                           0505 01441000
*     DO;                           /* DO000011: ONLY NEW TCB      0505 01442000
*                                      REQUIRED                      */ 01443000
         B     @RC00434                                            0505 01444000
@RF00434 DS    0H                                                  0506 01445000
*/* %FL01060: S UNLOCK: RELEASE LOCAL LOCK                           */ 01446000
*                                                                  0506 01447000
*       RFY                                                        0506 01448000
*         R15RETCD RSTD;                                           0506 01449000
*       CALL UNLOCK;                /* RELEASE LOCAL LOCK (ALTERS  0507 01450000
*                                      REGS 0,1,11,13,15)            */ 01451000
         BAL   @14,UNLOCK                                          0507 01452000
*/* D (YES,AT001390,NO,) ANY ERRORS ?                                */ 01453000
*                                                                  0508 01454000
*       IF R15RETCDÂ¬=ZERO THEN      /* ANY ERRORS                    */ 01455000
         LTR   R15RETCD,R15RETCD                                   0508 01456000
         BNZ   @RT00508                                            0508 01457000
*         GOTO AT001390;            /* GO CLEAN UP                   */ 01458000
*       RFY                                                        0510 01459000
*         R15RETCD UNRSTD;                                         0510 01460000
*ATFP70:                                                           0511 01461000
*       WKFCODE=FCODE70;            /* LOCK RELEASED                 */ 01462000
ATFP70   MVI   WKFCODE(R12SVRB),X'46'                              0511 01463000
*/* L GETMAIN: OBTAIN TCB STORAGE                                    */ 01464000
*                                                                  0512 01465000
*       RFY                                                        0512 01466000
*         R0WORK RSTD;                                             0512 01467000
*       RFY                                                        0513 01468000
*         R1AREA RSTD;                                             0513 01469000
*       R0WORK=LENGTH(TCBFIX)+LENGTH(TCB)+LENGTH(TCBXTNT2);/* GETMAIN   01470000
*                                      LENGTH                        */ 01471000
         LA    R0WORK,360                                          0514 01472000
*       GENERATE REFS(R0WORK,SPID253) SETS(R1AREA) NOFLOWS;        0515 01473000
*                                                                  0515 01474000
         SPACE                                                          01475000
         ICM   R0WORK,8,SPID253        SET SP ID INTO HIGH ORDER BYTE   01476000
         GETMAIN R,LV=(0)              GET TCB STORAGE                  01477000
         SPACE                                                          01478000
*/* P CLEAR TCB STORAGE TO ZERO                                      */ 01479000
*                                                                  0516 01480000
*       AREA=AREA&&AREA;            /* CLEAR 256 BYTES CLEAR       0516 01481000
*                                      REMAINING PORTION             */ 01482000
         XC    AREA(256,R1AREA),AREA(R1AREA)                       0516 01483000
*       EVAL(R1AREA+LENGTH(AREA))->AREA(1:LENGTH(TCBFIX)+LENGTH(TCB)+   01484000
*           LENGTH(TCBXTNT2)-LENGTH(AREA))=EVAL(R1AREA+LENGTH(AREA))->  01485000
*           AREA(1:LENGTH(TCBFIX)+LENGTH(TCB)+LENGTH(TCBXTNT2)-LENGTH(  01486000
*           AREA))&&EVAL(R1AREA+LENGTH(AREA))->AREA(1:LENGTH(TCBFIX)+   01487000
*           LENGTH(TCB)+LENGTH(TCBXTNT2)-LENGTH(AREA));            0517 01488000
         LA    @08,256                                             0517 01489000
         ALR   @08,R1AREA                                          0517 01490000
         XC    AREA(104,@08),AREA(@08)                             0517 01491000
*       RFY                                                        0518 01492000
*         R0WORK UNRSTD;                                           0518 01493000
*       R5NEWTCB=R1AREA+LENGTH(TCBFIX);/* NEW TCB ADDR               */ 01494000
         LA    R5NEWTCB,32                                         0519 01495000
         ALR   R5NEWTCB,R1AREA                                     0519 01496000
*     END;                          /* END00011: END TCB-ONLY      0520 01497000
*                                      PROCESSING                    */ 01498000
*   RFY                                                            0521 01499000
*     R1AREA UNRSTD;                                               0521 01500000
*                                                                  0521 01501000
@RC00434 DS    0H                                                  0522 01502000
*/* %FL01390: P JOURNAL NEW TCB ADDRESS                              */ 01503000
*                                                                  0522 01504000
*   WKNEWTCB=R5NEWTCB;              /* FOR RECOVERY                  */ 01505000
         ST    R5NEWTCB,WKNEWTCB(,R12SVRB)                         0522 01506000
*ATFP80:                                                           0523 01507000
*   WKFCODE=FCODE80;                /* TRACE                         */ 01508000
ATFP80   MVI   WKFCODE(R12SVRB),X'50'                              0523 01509000
*/* P SET RETURN CODE ZERO                                           */ 01510000
*                                                                  0524 01511000
*   RFY                                                            0524 01512000
*     R15RETCD RSTD;                                               0524 01513000
*   R15RETCD=X00NOERR;              /* RETURN CODE 0                 */ 01514000
         SLR   R15RETCD,R15RETCD                                   0525 01515000
*/* AT001390: R RETURN TO CALLING POINT                              */ 01516000
*                                                                  0526 01517000
*   RFY                                                            0526 01518000
*     R14RET RSTD;                                                 0526 01519000
*AT001390:                                                         0527 01520000
*   R14RET=WKRTSAVE;                /* RETURN ADDRESS                */ 01521000
AT001390 L     R14RET,WKRTSAVE(,R3WORKAD)                          0527 01522000
*/* GETCBS: END  FLOWCHART                                           */ 01523000
*                                                                  0528 01524000
*   END GETCBS;                     /* END OF SUBROUTINE             */ 01525000
@EL00003 DS    0H                                                  0528 01526000
@EF00003 DS    0H                                                  0528 01527000
@ER00003 BR    @14                                                 0528 01528000
*   RFY                                                            0529 01529000
*     R14RET UNRSTD;                                               0529 01530000
*   RFY                                                            0530 01531000
*     R15RETCD UNRSTD;                                             0530 01532000
*                                                                  0531 01533000
*   /*****************************************************************/ 01534000
*   /*                                                               */ 01535000
*   /* CHKPARM SUBROUTINE                                            */ 01536000
*   /*                                                               */ 01537000
*   /*****************************************************************/ 01538000
*                                                                  0531 01539000
*CHKPARM:                                                          0531 01540000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 01541000
CHKPARM  DS    0H                                                  0532 01542000
*/* CHKPARM: CHART  BEGIN FLOWCHART                                  */ 01543000
*/* FOOTING                                                        0532 01544000
*/* SUBROUTINE OBTAINS STORAGE FOR SVRB AND DE SAVE AREA, AND      0532 01545000
*/* PROCESSES INPUT PARAMETER LIST                                   */ 01546000
*/********************************************************************/ 01547000
*/*                                                                  */ 01548000
*/* SUBROUTINE CHKPARM OBTAINS SUFFICIENT STORAGE FROM SUBPOOL       */ 01549000
*/* 255 FOR A NEW SVRB, AND FOR A DE SAVE AREA, IF THE DE            */ 01550000
*/* PARAMETER WAS SPECIFIED ON THE ATTACH MACRO.                     */ 01551000
*/*                                                                  */ 01552000
*/* THE ATTACH PARAMETER LIST IS MOVED INTO THE AREA TO BE USED FOR  */ 01553000
*/* THE NEW SVRB (THIS AREA IS USED AS A TEMPORARY WORK AREA THROUGH */ 01554000
*/* MOST OF ATTACH PROCESSING), THE DIRECTORY ENTRY, IF DE WAS       */ 01555000
*/* SPECIFIED, IS MOVED INTO THE DE SAVE AREA, AND CONTROL FIELDS    */ 01556000
*/* ARE SET IN THE TEMPORARY WORKAREA AND THE PERMANENT WORKAREA     */ 01557000
*/* (WHICH IS IN THE RBEXSAVE FIELD OF THE CURRENT SVRB).            */ 01558000
*/*                                                                  */ 01559000
*/*    SUBROUTINES CALLED: MOVELIST                                  */ 01560000
*/*                                                                  */ 01561000
*/*    SYSTEM MACROS ISSUED: GETMAIN (RC-FORM BRANCH ENTRY)          */ 01562000
*/*                          TESTAUTH                                */ 01563000
*/*                                                                  */ 01564000
*/*    RETURN CODES SET: X00NOERR, ABEND42A, ABEND92A                */ 01565000
*/*                                                                  */ 01566000
*/*    REGISTER USAGE: R3WORKAD - OUTPUT, ADDRESS OF TEMP WORKAREA   */ 01567000
*/*                               (NEW SVRB STORAGE)                 */ 01568000
*/*                    R10INPRM - ADDRESS OF INPUT ATTACH PARM LIST  */ 01569000
*/*                    R12SVRB - ADDRESS OF ATTACH WORKAREA (CURRENT */ 01570000
*/*                              SVRB RBEXSAVE)                      */ 01571000
*/*                                                                  */ 01572000
*/********************************************************************/ 01573000
*/* E ENTER CHKPARM                                                  */ 01574000
*                                                                  0532 01575000
*   RFY                                                            0532 01576000
*     R7WORK RSTD;                                                 0532 01577000
*   RFY                                                            0533 01578000
*     R10INPRM RSTD;                                               0533 01579000
*   RFY                                                            0534 01580000
*     R14RET RSTD;                                                 0534 01581000
*   R7WORK=R14RET;                  /* SAVE RETURN ADDRESS           */ 01582000
         LR    R7WORK,R14RET                                       0535 01583000
*   RFY                                                            0536 01584000
*     R14RET UNRSTD;                                               0536 01585000
*                                                                  0536 01586000
*/* L TESTAUTH: CHECK CALLER FOR SYS KEY, SUPV STATE                 */ 01587000
*                                                                  0537 01588000
*   GENERATE SETS(R2WORK,R3WORKAD,R15RETCD) REFS(CVT) NOFLOWS;     0537 01589000
         SPACE                                                          01590000
         TESTAUTH STATE=YES,KEY=YES,RBLEVEL=2,BRANCH=YES                01591000
         SPACE                                                          01592000
*   RFY                                                            0538 01593000
*     R2WORK RSTD;                                                 0538 01594000
*   R2WORK=R7WORK;                  /* SAVE RETURN ADDRESS           */ 01595000
         LR    R2WORK,R7WORK                                       0539 01596000
*   RFY                                                            0540 01597000
*     R7WORK UNRSTD;                                               0540 01598000
*                                                                  0540 01599000
*/* D (NO,%FL02020,YES,) AUTHORIZED ?                                */ 01600000
*                                                                  0541 01601000
*   RFY                                                            0541 01602000
*     R15RETCD RSTD;                                               0541 01603000
*   IF R15RETCD=X00NOERR THEN       /* IF RETURN CODE = 0            */ 01604000
         LTR   R15RETCD,R15RETCD                                   0542 01605000
         BNZ   @RF00542                                            0542 01606000
*/* P (,%FL02030) SET SYSTEM TASK INDICATOR                          */ 01607000
*                                                                  0543 01608000
*     WKSYSTSK='1'B;                /* ATTACHING TASK IS SYSTEM TASK */ 01609000
         OI    WKSYSTSK(R12SVRB),B'10000000'                       0543 01610000
*   ELSE                            /* OTHERWISE, NOT                */ 01611000
*/* %FL02020: P STORE CALLER'S PROTECT KEY IN WORKAREA               */ 01612000
*                                                                  0544 01613000
*     WKPKEY=(R4CURTCB->TCBRBP->RBLINK->KEYCMWP)&KEYMASK;          0544 01614000
         B     @RC00542                                            0544 01615000
@RF00542 L     @14,TCBRBP(,R4CURTCB)                               0544 01616000
         L     @14,RBLINK(,@14)                                    0544 01617000
         LA    @11,240                                             0544 01618000
         SLR   @08,@08                                             0544 01619000
         IC    @08,KEYCMWP(,@14)                                   0544 01620000
         NR    @11,@08                                             0544 01621000
         STC   @11,WKPKEY(,R12SVRB)                                0544 01622000
*   RFY                                                            0545 01623000
*     R15RETCD UNRSTD;                                             0545 01624000
@RC00542 DS    0H                                                  0546 01625000
*ATFP30:                                                           0546 01626000
*   WKFCODE=FCODE30;                /* TRACE                         */ 01627000
ATFP30   MVI   WKFCODE(R12SVRB),X'1E'                              0546 01628000
*   RFY                                                            0547 01629000
*     R11LNGTH RSTD;                                               0547 01630000
*                                                                  0547 01631000
*/* %FL02030: P SET GETMAIN LENGTH TO LENGTH OF NEW SVRB             */ 01632000
*                                                                  0548 01633000
*   R11LNGTH=ADDR(SVRBLEN);         /* STORAGE FOR NEW SVRB  @Z30ENVB*/ 01634000
         LA    R11LNGTH,SVRBLEN                                    0548 01635000
*/* D (NO,%FL01680,YES,) WAS DE SPECIFIED ?                          */ 01636000
*                                                                  0549 01637000
*   IF R10INPRM->ATDENTRY='1'B THEN                                0549 01638000
*                                                                  0549 01639000
         TM    ATDENTRY(R10INPRM),B'10000000'                      0549 01640000
         BNO   @RF00549                                            0549 01641000
*/* P ADD MAX DE LENGTH TO GETMAIN LENGTH                            */ 01642000
*                                                                  0550 01643000
*     R11LNGTH=R11LNGTH+DELNG;      /* MAX AREA IS OBTAINED FOR DIR     01644000
*                                      ENTRY, REGARDLESS OF LENGTH,     01645000
*                                      AS PER LINK BR ENTRY INTERFACE*/ 01646000
         AH    R11LNGTH,@CH00168                                   0550 01647000
*/* %FL01680: L GETMAIN: OBTAIN SVRB DE STORAGE                      */ 01648000
*                                                                  0551 01649000
*   RFY                                                            0551 01650000
*     R0WORK RSTD;                                                 0551 01651000
@RF00549 DS    0H                                                  0552 01652000
*   RFY                                                            0552 01653000
*     R1AREA RSTD;                                                 0552 01654000
*   RFY                                                            0553 01655000
*     R7ASCB RSTD;                                                 0553 01656000
*   RFY                                                            0554 01657000
*     R15RETCD RSTD;                                               0554 01658000
*   R0WORK=R11LNGTH;                /* LENGTH FOR GETMAIN            */ 01659000
         LR    R0WORK,R11LNGTH                                     0555 01660000
*   R7ASCB=PSAAOLD;                 /* ASCB ADDR, FOR GETMAIN        */ 01661000
         L     R7ASCB,PSAAOLD                                      0556 01662000
*   GENERATE REFS(R0WORK,R4CURTCB,R7ASCB,CVTCRMN) SETS(R3WORKAD,R14RET, 01663000
*       R15RETCD) NOFLOWS;                                         0557 01664000
         SPACE                                                          01665000
         GETMAIN RC,LV=(0),SP=SP255EQU,KEY=0,BRANCH=YES                 01666000
         SPACE                                                          01667000
*   RFY                                                            0558 01668000
*     R0WORK UNRSTD;                                               0558 01669000
*   RFY                                                            0559 01670000
*     R7ASCB UNRSTD;                                               0559 01671000
*                                                                  0559 01672000
*/* D (YES,%FL01690,NO,) WAS STORAGE OBTAINED ?                      */ 01673000
*                                                                  0560 01674000
*   IF R15RETCDÂ¬=X00NOERR THEN                                     0560 01675000
         LTR   R15RETCD,R15RETCD                                   0560 01676000
         BZ    @RF00560                                            0560 01677000
*     DO;                           /* DO000053                      */ 01678000
*/* P (,AT001690) INDICATE ABEND CODE 92A                            */ 01679000
*                                                                  0562 01680000
*       WKREASON=RCODE4;            /* SET REASON CODE               */ 01681000
         MVI   WKREASON(R12SVRB),X'04'                             0562 01682000
*       R15RETCD=ABEND92A;          /* ERROR CODE                    */ 01683000
         LA    R15RETCD,2346                                       0563 01684000
*       GOTO AT001690;              /* GO EXIT SUBROUTINE            */ 01685000
         B     AT001690                                            0564 01686000
*     END;                          /* END00053                      */ 01687000
*   RFY                                                            0566 01688000
*     R15RETCD UNRSTD;                                             0566 01689000
*                                                                  0566 01690000
@RF00560 DS    0H                                                  0567 01691000
*/* %FL01690: P SET AREA SIZE, ADDRESS, IN PERM WORKAREA             */ 01692000
*                                                                  0567 01693000
*   WK255LNG=R11LNGTH;              /* LENGTH                        */ 01694000
         STH   R11LNGTH,WK255LNG(,R12SVRB)                         0567 01695000
*   WK255PTR=R1AREA;                /* ADDRESS                       */ 01696000
*                                                                  0568 01697000
         ST    R1AREA,WK255PTR(,R12SVRB)                           0568 01698000
*   /*****************************************************************/ 01699000
*   /*                                                               */ 01700000
*   /* INITIALIZE WORKAREA                                           */ 01701000
*   /*                                                               */ 01702000
*   /*****************************************************************/ 01703000
*                                                                  0569 01704000
*/* P CLEAR ENTIRE WORKAREA TO ZERO                                  */ 01705000
*                                                                  0569 01706000
*   RFY                                                            0569 01707000
*     R0WORK RSTD;                                                 0569 01708000
*   R3WORKAD=R1AREA;                /* WORKAREA ADDRESS              */ 01709000
         LR    R3WORKAD,R1AREA                                     0570 01710000
*   R0WORK=R11LNGTH;                /* LENGTH OF AREA                */ 01711000
         LR    R0WORK,R11LNGTH                                     0571 01712000
*   DO WHILE(R0WORK>=LENGTH(AREA)); /* DO000031: LOOP TO CLEAR 256 0572 01713000
*                                      BYTES/PASS                    */ 01714000
         B     @DE00572                                            0572 01715000
@DL00572 DS    0H                                                  0573 01716000
*     AREA=AREA&&AREA;              /* ZERO 256 BYTES                */ 01717000
         XC    AREA(256,R1AREA),AREA(R1AREA)                       0573 01718000
*     R0WORK=R0WORK-LENGTH(AREA);   /* DECREMENT COUNT OF BYTES LEFT */ 01719000
         LA    @08,256                                             0574 01720000
         SLR   R0WORK,@08                                          0574 01721000
*     R1AREA=R1AREA+LENGTH(AREA);   /* ADDRESS NEXT BYTE TO CLEAR    */ 01722000
         ALR   R1AREA,@08                                          0575 01723000
*   END;                            /* END00031: END LOOP            */ 01724000
@DE00572 CH    R0WORK,@CH01366                                     0576 01725000
         BNL   @DL00572                                            0576 01726000
*   IF R0WORKÂ¬=ZERO THEN            /* ANY BYTES REMAINING TO CLEAR?    01727000
*                                      YES, CLEAR REMAINER TO ZERO   */ 01728000
         LTR   R0WORK,R0WORK                                       0577 01729000
         BZ    @RF00577                                            0577 01730000
*     AREA(1:R0WORK)=AREA(1:R0WORK)&&AREA(1:R0WORK);/* CLEAR         */ 01731000
         LR    @08,R0WORK                                          0578 01732000
         BCTR  @08,0                                               0578 01733000
         EX    @08,@SX03144                                        0578 01734000
*   WKNOAREA='0'B;                  /* INDICATE AREA OBTAINED        */ 01735000
@RF00577 NI    WKNOAREA(R12SVRB),B'11110111'                       0579 01736000
*   RFY                                                            0580 01737000
*     R1AREA UNRSTD;                                               0580 01738000
*                                                                  0580 01739000
*/* DETERMINE LENGTH OF PARAMETER LIST                               */ 01740000
*/* D (YES,%FL01620,NO,) IS PARM LIST OSVS2 R2 LEVEL ?               */ 01741000
*                                                                  0581 01742000
*   IF R10INPRM->ATEXTN2='0'B THEN                                 0581 01743000
*                                                                  0581 01744000
         TM    ATEXTN2(R10INPRM),B'00001000'                       0581 01745000
         BNZ   @RF00581                                            0581 01746000
*/* D (NO,%FL01630,YES,) IS PARM LIST OS/MVT REL 21 LEVEL ?          */ 01747000
*                                                                  0582 01748000
*     IF R10INPRM->ATJSCB='1'B|     /* JSCB ?, OR                    */ 01749000
*         R10INPRM->ATTSKLB='1'B|   /* TASKLIB ?, OR                 */ 01750000
*         R10INPRM->ATTSTAI='1'B|   /* STAI OR ESTAI ?, OR           */ 01751000
*         R10INPRM->ATEXTN='1'B THEN/* OS/VS2 REL 1 ?                */ 01752000
         TM    ATJSCB(R10INPRM),B'01000000'                        0582 01753000
         BO    @RT00582                                            0582 01754000
         TM    ATTSKLB(R10INPRM),B'00000011'                       0582 01755000
         BNZ   @RT00582                                            0582 01756000
         TM    ATEXTN(R10INPRM),B'00100000'                        0582 01757000
         BNO   @RF00582                                            0582 01758000
@RT00582 DS    0H                                                  0583 01759000
*/* P (,%FL01640) SET PARM LIST LENGTH TO 52 BYTES                   */ 01760000
*                                                                  0583 01761000
*       R11LNGTH=EXTLISTL;          /* SET PARM LIST TO EXTENDED, 52 */ 01762000
         LA    R11LNGTH,52                                         0583 01763000
*/* %FL01630: P (,%FL01640) SET LIST LENGTH TO 36 BYTES              */ 01764000
*                                                                  0584 01765000
*     ELSE                                                         0584 01766000
*       R11LNGTH=OLDLISTL;          /* SET PARM LIST TO ORIGINAL, 36 */ 01767000
         B     @RC00582                                            0584 01768000
@RF00582 LA    R11LNGTH,36                                         0584 01769000
*   ELSE                            /* LIST CONTAINS LENGTH          */ 01770000
*     DO;                           /* DO000032                      */ 01771000
         B     @RC00581                                            0585 01772000
@RF00581 DS    0H                                                  0586 01773000
*/* %FL01620: S MOVELIST: MOVE LENGTH FIELD TO WORKAREA              */ 01774000
*                                                                  0586 01775000
*       RFY                                                        0586 01776000
*         R0WORK RSTD;                                             0586 01777000
*       RFY                                                        0587 01778000
*         R7WORK RSTD;                                             0587 01779000
*       RFY                                                        0588 01780000
*         R8WORK RSTD;                                             0588 01781000
*       R0WORK=LENGTH(WKTHWORD);    /* LENGTH                        */ 01782000
         LA    R0WORK,2                                            0589 01783000
*       R7WORK=ADDR(R10INPRM->ATTPLNG);/* ADDRESS OF LENGTH FIELD    */ 01784000
         LA    R7WORK,ATTPLNG(,R10INPRM)                           0590 01785000
*       R8WORK=ADDR(WKTHWORD);      /* MOVE TO ADDRESS               */ 01786000
         LA    R8WORK,WKTHWORD(,R3WORKAD)                          0591 01787000
*       CALL MOVELIST;              /* VALIDITY CHECKING MOVE        */ 01788000
         BAL   @14,MOVELIST                                        0592 01789000
*       RFY                                                        0593 01790000
*         R0WORK UNRSTD;                                           0593 01791000
*       RFY                                                        0594 01792000
*         R7WORK UNRSTD;                                           0594 01793000
*       RFY                                                        0595 01794000
*         R8WORK UNRSTD;                                           0595 01795000
*                                                                  0595 01796000
*/* P SET PARM LIST LENGTH TO LIST LENGTH FIELD (ATTPLNG)            */ 01797000
*                                                                  0596 01798000
*       R11LNGTH=WKTHWORD;          /* LENGTH OF LIST SET BY MACRO   */ 01799000
         LH    R11LNGTH,WKTHWORD(,R3WORKAD)                        0596 01800000
*       IF(R11LNGTH>LENGTH(ATTCHLST))|(R11LNGTH<OSVS2R2L) THEN/*   0597 01801000
*                                      VALID ?                       */ 01802000
         LA    @08,60                                              0597 01803000
         CR    R11LNGTH,@08                                        0597 01804000
         BH    @RT00597                                            0597 01805000
         CR    R11LNGTH,@08                                        0597 01806000
         BNL   @RF00597                                            0597 01807000
@RT00597 DS    0H                                                  0598 01808000
*         DO;                       /* DO000033                      */ 01809000
*           RFY                                                    0599 01810000
*             R15RETCD RSTD;                                       0599 01811000
*           R15RETCD=ABEND72A;      /* INVALID PARM LIST             */ 01812000
         LA    R15RETCD,1834                                       0600 01813000
*           GOTO AT001690;          /* GO EXIT SUBROUTINE            */ 01814000
         B     AT001690                                            0601 01815000
*           RFY                                                    0602 01816000
*             R15RETCD UNRSTD;                                     0602 01817000
*         END;                      /* END00033                      */ 01818000
*     END;                          /* END00032                      */ 01819000
@RF00597 DS    0H                                                  0605 01820000
*ATFP40:                                                           0605 01821000
*   WKFCODE=FCODE40;                /* TRACE                         */ 01822000
@RC00581 DS    0H                                                  0605 01823000
ATFP40   MVI   WKFCODE(R12SVRB),X'28'                              0605 01824000
*/* %FL01640: S MOVELIST: MOVE PARM LIST TO WORKAREA                 */ 01825000
*                                                                  0606 01826000
*   RFY                                                            0606 01827000
*     R0WORK RSTD;                                                 0606 01828000
*   RFY                                                            0607 01829000
*     R7WORK RSTD;                                                 0607 01830000
*   RFY                                                            0608 01831000
*     R8WORK RSTD;                                                 0608 01832000
*   R0WORK=R11LNGTH;                /* LENGTH OF LIST                */ 01833000
         LR    R0WORK,R11LNGTH                                     0609 01834000
*   R7WORK=R10INPRM;                /* MOVE-FROM ADDR = INPUT PARM 0610 01835000
*                                      LIST ADDR                     */ 01836000
         LR    R7WORK,R10INPRM                                     0610 01837000
*   R8WORK=R3WORKAD;                /* MOVE-TO ADDR                  */ 01838000
         LR    R8WORK,R3WORKAD                                     0611 01839000
*   CALL MOVELIST;                  /* PARM LIST TO WORKAREA         */ 01840000
         BAL   @14,MOVELIST                                        0612 01841000
*   RFY                                                            0613 01842000
*     R10INPRM UNRSTD;                                             0613 01843000
*   RFY                                                            0614 01844000
*     R11LNGTH UNRSTD;                                             0614 01845000
*   RFY                                                            0615 01846000
*     R0WORK UNRSTD;                                               0615 01847000
*   RFY                                                            0616 01848000
*     R7WORK UNRSTD;                                               0616 01849000
*   RFY                                                            0617 01850000
*     R8WORK UNRSTD;                                               0617 01851000
*                                                                  0617 01852000
*/* COMMENT SINCE WORKAREA WAS CLEARED TO 0, ALL FIELDS OF EXTENDED  */ 01853000
*/* PARM LIST CAN BE REFERENCED, WITHOUT REGARD TO ACTUAL PARM LIST  */ 01854000
*/* LENGTH                                                           */ 01855000
*/* P MOVE DCB PARM TO WORKAREA                                      */ 01856000
*                                                                  0618 01857000
*   WKGRS11=ATDCBADB;               /* DCB PARM SPECIFIED, OR 0      */ 01858000
         SLR   @08,@08                                             0618 01859000
         ICM   @08,7,ATDCBADB(R3WORKAD)                            0618 01860000
         ST    @08,WKGRS11(,R12SVRB)                               0618 01861000
*/* D (YES,%RSAP,NO,)  IS CALLER A SYSTEM TASK ?                     */ 01862000
*                                                                  0619 01863000
*   IF WKSYSTSK='0'B THEN                                          0619 01864000
         TM    WKSYSTSK(R12SVRB),B'10000000'                       0619 01865000
         BNZ   @RF00619                                            0619 01866000
*     DO;                           /* DO000057                      */ 01867000
*/* P SET 'PRIVILEGED' PARAMETERS TO THEIR DEFAULTS                  */ 01868000
*                                                                  0621 01869000
*       ATDISP='0'B;                /* DISP=YES (SET TCBANDSP=0)     */ 01870000
*       ATJSCB='0'B;                /* NO JSCB ADDR (PROPAGATE     0622 01871000
*                                      TCBJSCB)                      */ 01872000
*       ATKEY='0'B;                 /* KEY=PROP (PROPAGATE TCBPKF)   */ 01873000
*       ATSVAREA='0'B;              /* SVAREA=YES (GET PROBLEM PGM 0624 01874000
*                                      SAVE AREA, PTR IN TCBFSA)     */ 01875000
*       ATJSTCB='0'B;               /* JSTCB=NO (PROPAGATE TCBJSTCB) */ 01876000
*       ATMODE='0'B;                /* SM=PROB (SET TCBFSM=0)        */ 01877000
*                                                                  0626 01878000
         NI    ATDISP(R3WORKAD),B'00101000'                        0626 01879000
*       /*************************************************************/ 01880000
*       /*                                                           */ 01881000
*       /* SZERO=YES/NO IS NOT PRIVILEGED.                           */ 01882000
*       /*                                                           */ 01883000
*       /*************************************************************/ 01884000
*                                                                  0627 01885000
*       ATTID=ZERO;                 /* TID=0 (SET TCBTID=0)          */ 01886000
         MVI   ATTID(R3WORKAD),X'00'                               0627 01887000
*       ATNSHRSP='0'B;              /* NSHSPL NOT SPECIFIED (PROP- 0628 01888000
*                                      AGATE SWA, SUBPOOLS 236, 237) */ 01889000
         NI    ATNSHRSP(R3WORKAD),B'01111111'                      0628 01890000
*       ATTNSHLV=ZERO;              /* NSHSPV NOT SPECIFIED          */ 01891000
         SLR   @08,@08                                             0629 01892000
         ST    @08,ATTNSHLV(,R3WORKAD)                             0629 01893000
*       ATRSAPF='0'B;               /* RSAPF=NO              @Z40RPYB*/ 01894000
*                                                                  0630 01895000
         NI    ATRSAPF(R3WORKAD),B'10111111'                       0630 01896000
*       /*************************************************************/ 01897000
*       /*                                                           */ 01898000
*       /* AS OF OS/VS2 REL 2, THE FOLLOWING ONCE PRIVILEGED         */ 01899000
*       /* PARAMETERS ARE IGNORED: GIVEJPQ=YES/NO TSLOGON=YES/NO     */ 01900000
*       /* LSQA=VALUE                                                */ 01901000
*       /*                                                           */ 01902000
*       /*************************************************************/ 01903000
*                                                                  0631 01904000
*     END;                          /* END00057                      */ 01905000
*/*%RSAP: D (YES,,NO,%FL01760) RSAPF=YES SPECIFIED? (ATRSAPF =1)     */ 01906000
*/* D (YES,%RSAQ,NO,) SM=SUPV SPCIFIED: (ATMODE=1)                   */ 01907000
*/* D (YES,%RSAQ,NO,) KEY =ZERO SPECIFIED? (ATKEY =1)                */ 01908000
*/* D (YES,,NO,%RSAR) TCB PRO TECT KEY (TCBPKF) <8)                  */ 01909000
*/*%RSAQ: P (,%FL01760) FORCE RSAPF=NO (SET ATRSAPF=0)               */ 01910000
*/*%RSAR: L TESTAUTH: CHECK APF AUTHORIZATION MODE                   */ 01911000
*/* D (YES,%RSAS,NO,) CALLER APF AUTHORIZED? (R15 =0)                */ 01912000
*/* P (,%FL01760) INDICATE RSAPF=YES FOR PGM MGR (SET WKRSAPF =1)    */ 01913000
*/* COMMENT (13,2) WKRSAPF WHEN MOVED TO                             */ 01914000
*/* COMMENT (14,2) RBEXSAVE IS USED BY LINK                          */ 01915000
*/*%RSAS: P FORCE RSAPF=NO (SET ATRSAPF=0)                           */ 01916000
*                                                                  0632 01917000
*   ELSE                            /* HERE IF SYSTEM RQST   @Z40RPYB*/ 01918000
*     DO;                           /* CK FOR RESET APF      @Z40RPYB*/ 01919000
         B     @RC00619                                            0632 01920000
@RF00619 DS    0H                                                  0633 01921000
*       IF ATRSAPF='1'B THEN        /* IF RSAPF=YES ENSURE   @Z40RPYB*/ 01922000
         TM    ATRSAPF(R3WORKAD),B'01000000'                       0633 01923000
         BNO   @RF00633                                            0633 01924000
*         DO;                       /* CONDITIONS ARE MET.   @Z40RPYB*/ 01925000
*           IF ATMODE='1'B|         /* IF SM=SUPV OR         @Z40RPYB*/ 01926000
*               ATKEY='1'B|         /* KEY=ZERO OR           @Z40RPYB*/ 01927000
*               R4CURTCB->TCBPKF<'80'X THEN/* TCB KEY <8 THEN      0635 01928000
*                                                            @ZA24297*/ 01929000
         TM    ATMODE(R3WORKAD),B'00010001'                        0635 01930000
         BNZ   @RT00635                                            0635 01931000
         CLI   TCBPKF(R4CURTCB),X'80'                              0635 01932000
         BNL   @RF00635                                            0635 01933000
@RT00635 DS    0H                                                  0636 01934000
*             ATRSAPF='0'B;         /* FORCE RSAPF=NO.       @Z40RPYB*/ 01935000
         NI    ATRSAPF(R3WORKAD),B'10111111'                       0636 01936000
*           ELSE                    /* HERE IF NEW TCB IS    @Z40RPYB*/ 01937000
*             DO;                   /* PP STATE+ KEY > 7.    @Z40RPYB*/ 01938000
         B     @RC00635                                            0637 01939000
@RF00635 DS    0H                                                  0638 01940000
*               RESPECIFY                                          0638 01941000
*                (R7WORK,                                          0638 01942000
*                 R8WORK) RSTD;     /* NOW TEST APF          @Z40RPYB*/ 01943000
*               R7WORK=R2WORK;      /* SAVE ACROSS TESTAUTH  @Z40RPYB*/ 01944000
         LR    R7WORK,R2WORK                                       0639 01945000
*               R8WORK=R3WORK;      /* SAVE ACROSS TESTAUTH  @Z40RPYB*/ 01946000
         LR    R8WORK,R3WORK                                       0640 01947000
*               GENERATE REFS(CVT,CVTAPF);                         0641 01948000
               TESTAUTH FCTN=1,RBLEVEL=2,BRANCH=YES                     01949000
*               RESPECIFY                                          0642 01950000
*                (R15RETCD) RSTD;   /*                       @Z40RPYB*/ 01951000
*               R2WORK=R7WORK;      /* RESTORE R2WORK        @Z40RPYB*/ 01952000
         LR    R2WORK,R7WORK                                       0643 01953000
*               R3WORK=R8WORK;      /* RESTORE R3WORK        @Z40RPYB*/ 01954000
         LR    R3WORK,R8WORK                                       0644 01955000
*               RESPECIFY                                          0645 01956000
*                (R7WORK,                                          0645 01957000
*                 R8WORK) UNRSTD;   /*                       @Z40RPYB*/ 01958000
*               IF R15RETCD=X00NOERR THEN/* IF APF AUTHORIZED      0646 01959000
*                                                            @Z40RPYB*/ 01960000
         LTR   R15RETCD,R15RETCD                                   0646 01961000
         BNZ   @RF00646                                            0646 01962000
*                 ATRSAPF='0'B;     /* FORCE RSAPF=NO        @Z40RPYB*/ 01963000
         NI    ATRSAPF(R3WORKAD),B'10111111'                       0647 01964000
*               ELSE                /* IF NOT APF AUTH.      @Z40RPYB*/ 01965000
*                 WKRSAPF='1'B;     /* INDICATE RSAPF=YES    @Z40RPYB*/ 01966000
         B     @RC00646                                            0648 01967000
@RF00646 OI    WKRSAPF(R12SVRB),B'01000000'                        0648 01968000
*               RESPECIFY                                          0649 01969000
*                (R15RETCD) UNRSTD; /*                       @Z40RPYB*/ 01970000
@RC00646 DS    0H                                                  0650 01971000
*             END;                  /*                       @Z40FPYB*/ 01972000
*         END;                      /*                       @Z40FPYB*/ 01973000
@RC00635 DS    0H                                                  0652 01974000
*     END;                          /*                       @Z40FPYB*/ 01975000
@RF00633 DS    0H                                                  0653 01976000
*/* %FL01760: P SET SVAREA=YES/NO FLAG IN WORKAREA                   */ 01977000
*                                                                  0653 01978000
*   IF ATSVAREA='1'B THEN                                          0653 01979000
@RC00619 TM    ATSVAREA(R3WORKAD),B'00000100'                      0653 01980000
         BNO   @RF00653                                            0653 01981000
*     WKSVAREA='1'B;                                               0654 01982000
*                                                                  0654 01983000
         OI    WKSVAREA(R12SVRB),B'10000000'                       0654 01984000
*/* D (NO,%FL01770,YES,) WAS EP OR EPLOC SPECIFIED ?                 */ 01985000
*                                                                  0655 01986000
*   IF ATDENTRY='0'B THEN                                          0655 01987000
@RF00653 TM    ATDENTRY(R3WORKAD),B'10000000'                      0655 01988000
         BNZ   @RF00655                                            0655 01989000
*     DO;                           /* DO000058                      */ 01990000
*/* P SET ADDRESS OF EP NAME TO RBEXSAVE                             */ 01991000
*                                                                  0657 01992000
*       RFY                                                        0657 01993000
*         R8WORK RSTD;                                             0657 01994000
*                                                                  0657 01995000
*       /*************************************************************/ 01996000
*       /*                                                           */ 01997000
*       /* EP NAME WILL OCCUPY FIRST EIGHT BYTES OF RBEXSAVE         */ 01998000
*       /*                                                           */ 01999000
*       /*************************************************************/ 02000000
*                                                                  0658 02001000
*       GENERATE REFS(RBPRFXND,RBPRFXST,RBEXSAVE,RBBASIC,R8WORK)   0658 02002000
*           NOFLOWS;                                               0658 02003000
         SPACE                                                          02004000
         LA    R8WORK,RBPRFXND-RBPRFXST+RBEXSAVE-RBBASIC(,R3WORKAD)     02005000
         SPACE                                                          02006000
*       WKGRS10=R8WORK;             /* SAVE ADDRESS                  */ 02007000
         ST    R8WORK,WKGRS10(,R12SVRB)                            0659 02008000
*/* S (,%FL01530) MOVELIST: MOVE ENTRY POINT NAME INTO WORKAREA      */ 02009000
*                                                                  0660 02010000
*       RFY                                                        0660 02011000
*         R0WORK RSTD;                                             0660 02012000
*       RFY                                                        0661 02013000
*         R7WORK RSTD;                                             0661 02014000
*       R0WORK=LENGTH(ATPRGNM);     /* NAME REQUIRED TO BE 8 BYTES,     02015000
*                                      PADDED WITH BLANKS IF NECESS  */ 02016000
         LA    R0WORK,8                                            0662 02017000
*       R7WORK=ATPGNADB;            /* ADDR OF EP NAME (MOVE-FROM)   */ 02018000
         SLR   R7WORK,R7WORK                                       0663 02019000
         ICM   R7WORK,7,ATPGNADB(R3WORKAD)                         0663 02020000
*       R8WORK=ADDR(WKEPNAME);      /* MOVE-TO POSITION IN WORKAREA  */ 02021000
         LR    R8WORK,R12SVRB                                      0664 02022000
*       CALL MOVELIST;              /* MOVE EP NAME INTO WORKAREA    */ 02023000
         BAL   @14,MOVELIST                                        0665 02024000
*     END;                          /* END00058                      */ 02025000
*/* %FL01770: P DETERMINE DIRECTORY ENTRY LENGTH                     */ 02026000
*                                                                  0667 02027000
*   ELSE                            /* DE WAS SPECIFIED              */ 02028000
*     DO;                           /* DO000059                      */ 02029000
         B     @RC00655                                            0667 02030000
@RF00655 DS    0H                                                  0668 02031000
*       RFY                                                        0668 02032000
*         R1WORK RSTD;                                             0668 02033000
*       R0WORK=ONE;                 /* TO MOVE ONE BYTE              */ 02034000
         LA    R0WORK,1                                            0669 02035000
*       R1WORK=ATPGNADB;            /* DIRECTORY ENTRY ADDR          */ 02036000
         SLR   R1WORK,R1WORK                                       0670 02037000
         ICM   R1WORK,7,ATPGNADB(R3WORKAD)                         0670 02038000
*       R7WORK=ADDR(R1WORK->PDS2INDC);/* NUMBER HALFWORDS IN 'USER'     02039000
*                                      DATA AREA, SET BY LINK EDIT   */ 02040000
         LA    R7WORK,PDS2INDC(,R1WORK)                            0671 02041000
*       R8WORK=ADDR(WKTEMP1);       /* MOVE-TO ADDRESS               */ 02042000
         LA    R8WORK,WKTEMP1(,R3WORKAD)                           0672 02043000
*       CALL MOVELIST;              /* VALIDITY CHECK AND MOVE BYTE  */ 02044000
         BAL   @14,MOVELIST                                        0673 02045000
*       RFY                                                        0674 02046000
*         R7WORK UNRSTD;                                           0674 02047000
*       GENERATE REFS(PDS2,PDS2USRD) NOFLOWS;                      0675 02048000
         SPACE                                                          02049000
         IC    R8WORK,0(,R8WORK)       USER LENGTH BYTE (SET BY         02050000
*                                      LINKAGE EDITOR)                  02051000
         LA    R0WORK,MASKPDSL         MASK                             02052000
         NR    R8WORK,R0WORK           USER AREA LENGTH IN HALFWORDS    02053000
         LA    R0WORK,PDS2USRD-PDS2(R8WORK,R8WORK) TOTAL LENGTH OF DE   02054000
         SPACE                                                          02055000
*       RFY                                                        0676 02056000
*         R1WORK UNRSTD;                                           0676 02057000
*       RFY                                                        0677 02058000
*         R1AREA RSTD;                                             0677 02059000
*       RFY                                                        0678 02060000
*         R7WORK RSTD;                                             0678 02061000
*                                                                  0678 02062000
*/* P SET ACTUAL DE LENGTH INTO DE SAVE AREA                         */ 02063000
*                                                                  0679 02064000
*       R1AREA=R3WORKAD+ADDR(SVRBLEN);/* ADDR OF DE SAVE AREA      0679 02065000
*                                                            @ZA10793*/ 02066000
         LA    R1AREA,SVRBLEN                                      0679 02067000
         ALR   R1AREA,R3WORKAD                                     0679 02068000
*       R1AREA->ZWORD=R0WORK;       /* MOVE DE LNGTH INTO DE AREA  0680 02069000
*                                                            @ZA10793*/ 02070000
         ST    R0WORK,ZWORD(,R1AREA)                               0680 02071000
*/* S MOVELIST: MOVE DE INTO DE SAVE AREA (60 BYTES ONLY)            */ 02072000
*                                                                  0681 02073000
*       IF R0WORK>DEMAX THEN        /*                       @ZA10793*/ 02074000
         LA    @15,60                                              0681 02075000
         CR    R0WORK,@15                                          0681 02076000
         BNH   @RF00681                                            0681 02077000
*         R0WORK=DEMAX;             /* MOVE 60 BYTES ONLY    @ZA10793*/ 02078000
         LR    R0WORK,@15                                          0682 02079000
*       R7WORK=ATPGNADB;            /* MOVE-FROM ADDR = DE ADDR      */ 02080000
@RF00681 SLR   R7WORK,R7WORK                                       0683 02081000
         ICM   R7WORK,7,ATPGNADB(R3WORKAD)                         0683 02082000
*       R8WORK=R1AREA+LENGTH(ZWORD);/* MOVE-TO ADDR IN GETMAINED AREA*/ 02083000
         LA    R8WORK,4                                            0684 02084000
         ALR   R8WORK,R1AREA                                       0684 02085000
*       CALL MOVELIST;              /* VALIDITY CHECKING MOVE        */ 02086000
         BAL   @14,MOVELIST                                        0685 02087000
*       RFY                                                        0686 02088000
*         R7WORK UNRSTD;                                           0686 02089000
*       RFY                                                        0687 02090000
*         R8WORK UNRSTD;                                           0687 02091000
*                                                                  0687 02092000
*/* P SAVE COMPLEMENTED ADDR OF DE SAVE AREA FOR LINK BR ENTRY       */ 02093000
*                                                                  0688 02094000
*       WKGRS10=-R1AREA;            /* SAVE COMPLEMENT ADDR FOR LINK */ 02095000
         LCR   @08,R1AREA                                          0688 02096000
         ST    @08,WKGRS10(,R12SVRB)                               0688 02097000
*       RFY                                                        0689 02098000
*         R0WORK UNRSTD;                                           0689 02099000
*       RFY                                                        0690 02100000
*         R1AREA UNRSTD;                                           0690 02101000
*     END;                          /* END00059                      */ 02102000
*/* %FL01530: P SET RETURN CODE = 0                                  */ 02103000
*                                                                  0692 02104000
*   RFY                                                            0692 02105000
*     R15RETCD RSTD;                                               0692 02106000
@RC00655 DS    0H                                                  0693 02107000
*   R15RETCD=X00NOERR;              /* SET RETURN CODE               */ 02108000
         SLR   R15RETCD,R15RETCD                                   0693 02109000
*/* D (NO,AT001690,YES,) WAS ECB SPECIFIED ?                         */ 02110000
*                                                                  0694 02111000
*   IF ATECBADBÂ¬=ZERO THEN                                         0694 02112000
*                                                                  0694 02113000
         SLR   @14,@14                                             0694 02114000
         ICM   @14,7,ATECBADB(R3WORKAD)                            0694 02115000
         LTR   @14,@14                                             0694 02116000
         BZ    @RF00694                                            0694 02117000
*/* D (YES,AT001690,NO,) IS CALLER A SYSTEM TASK ?                   */ 02118000
*                                                                  0695 02119000
*     IF WKSYSTSK='0'B THEN                                        0695 02120000
         TM    WKSYSTSK(R12SVRB),B'10000000'                       0695 02121000
         BNZ   @RF00695                                            0695 02122000
*       DO;                         /* DO000060                      */ 02123000
*/* D (NO,%FL01700,YES,) IS ECB ADDRESS ON A FULLWORD BOUNDARY ?     */ 02124000
*                                                                  0697 02125000
*         IF ECBTEST(31:32)='00'B THEN                             0697 02126000
         TM    ECBTEST+3(R3WORKAD),B'00000011'                     0697 02127000
         BNZ   @RF00697                                            0697 02128000
*           DO;                     /* DO000088                      */ 02129000
*/* P (,AT001690) VALIDITY CHECK ECB ADDRESS                         */ 02130000
*                                                                  0699 02131000
*             RFY                                                  0699 02132000
*               R1WORK RSTD;                                       0699 02133000
*             WKECBSW='1'B;         /* ALLOWS FRR TO DETECT BAD ECB  */ 02134000
         OI    WKECBSW(R12SVRB),B'00100000'                        0700 02135000
*             WKRTSAVE=R2WORK;      /* SAVE                          */ 02136000
         ST    R2WORK,WKRTSAVE(,R3WORKAD)                          0701 02137000
*             R2WORK=WKPKEY;                                       0702 02138000
         SLR   R2WORK,R2WORK                                       0702 02139000
         IC    R2WORK,WKPKEY(,R12SVRB)                             0702 02140000
*             R1WORK=ATECBADB;      /* ADDRESS OF ECB                */ 02141000
         LR    R1WORK,@14                                          0703 02142000
*             GENERATE REFS(R2WORK) NOFLOWS SETS(R2WORK);          0704 02143000
         SPACE                                                          02144000
         MODESET KEYADDR=(2)           SET USER PROTECT KEY             02145000
         SPACE                                                          02146000
         L     R2WORK,0(,R1WORK)       FETCH ECB (FETCH PROTECT CHECK)  02147000
         ST    R2WORK,0(,R1WORK)       STORE ECB (STORE PROTECT CHECK)  02148000
         SPACE                                                          02149000
         MODESET EXTKEY=SUPR           RESET PROTECT KEY TO 0           02150000
         SPACE                                                          02151000
*             RFY                                                  0705 02152000
*               R1WORK UNRSTD;                                     0705 02153000
*             R2WORK=WKRTSAVE;      /* RESTORE                       */ 02154000
         L     R2WORK,WKRTSAVE(,R3WORKAD)                          0706 02155000
*             WKECBSW='0'B;         /* INVALID ECB SWITCH OFF        */ 02156000
         NI    WKECBSW(R12SVRB),B'11011111'                        0707 02157000
*           END;                    /* END00088                      */ 02158000
*/* %FL01700: P INDICATE ABEND CODE 42A                              */ 02159000
*                                                                  0709 02160000
*         ELSE                                                     0709 02161000
*           R15RETCD=ABEND42A;      /* ERROR, ECB ADDR NOT FULLWORD  */ 02162000
         B     @RC00697                                            0709 02163000
@RF00697 LA    R15RETCD,1066                                       0709 02164000
*       END;                        /* END00060                      */ 02165000
@RC00697 DS    0H                                                  0711 02166000
*/* AT001690: R RETURN TO CALLING POINT                              */ 02167000
*                                                                  0711 02168000
*AT001690:                                                         0711 02169000
*   RFY                                                            0711 02170000
*     R14RET RSTD;                                                 0711 02171000
@RF00695 DS    0H                                                  0711 02172000
@RF00694 DS    0H                                                  0711 02173000
AT001690 DS    0H                                                  0712 02174000
*   R14RET=R2WORK;                  /* RESTORE RETURN ADDRESS        */ 02175000
         LR    R14RET,R2WORK                                       0712 02176000
*/* CHKPARM: END FLOWCHART                                           */ 02177000
*                                                                  0713 02178000
*   END CHKPARM;                    /* END OF SUBROUTINE             */ 02179000
@EL00004 DS    0H                                                  0713 02180000
@EF00004 DS    0H                                                  0713 02181000
@ER00004 BR    @14                                                 0713 02182000
*   RFY                                                            0714 02183000
*     R14RET UNRSTD;                                               0714 02184000
*   RFY                                                            0715 02185000
*     R15RETCD UNRSTD;                                             0715 02186000
*   RFY                                                            0716 02187000
*     R2WORK UNRSTD;                                               0716 02188000
*                                                                  0717 02189000
*   /*****************************************************************/ 02190000
*   /*                                                               */ 02191000
*   /* STAIRTN SUBROUTINE                                            */ 02192000
*   /*                                                               */ 02193000
*   /*****************************************************************/ 02194000
*                                                                  0717 02195000
*STAIRTN:                                                          0717 02196000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0717 02197000
*                                                                  0717 02198000
STAIRTN  DS    0H                                                  0718 02199000
*/* STAIRTN: CHART BEGIN SUBROUTINE FLOWCHART                        */ 02200000
*/* FOOTING                                                        0718 02201000
*/* STAI/ESTAI PROCESSING FOR NEW TCB                                */ 02202000
*/********************************************************************/ 02203000
*/*                                                                  */ 02204000
*/*    PROCESS THE STAI/ESTAI PARAMETERS:                            */ 02205000
*/*                                                                  */ 02206000
*/*      IF THE STAI PARM WAS SPECIFIED, A STAI SCB IS BUILT AND     */ 02207000
*/*      CHAINED OFF THE NEW TCB, AND ANY STAI/ESTAI SCB'S ON THE    */ 02208000
*/*      CURRENT TCB ARE COPIED TO THE NEW TCB.                      */ 02209000
*/*                                                                  */ 02210000
*/*      IF THE ESTAI PARM WAS SPECIFIED, AN ESTAI SCB IS BUILT AND  */ 02211000
*/*      CHAINED OFF THE NEW TCB, AND ANY STAI/ESTAI SCB'S ON THE    */ 02212000
*/*      CURRENT TCB ARE COPIED TO THE NEW TCB.                      */ 02213000
*/*                                                                  */ 02214000
*/*      IF NEITHER STAI NOR ESTAI WAS SPECIFIED, AN ESTAI REQUEST   */ 02215000
*/*      IS ISSUED SPECIFYING THE PROP OPTION, WHICH CAUSES ANY      */ 02216000
*/*      STAI/ESTAI SCB'S ON THE CURRENT TCB TO BE COPIED TO THE NEW */ 02217000
*/*      TCB. IF NO SUCH SCB'S EXIST, THE NEW TCB'S TCBSTAB FIELD    */ 02218000
*/*      WILL BE ZERO UPON RETURN FROM SVC 60.                       */ 02219000
*/*                                                                  */ 02220000
*/* SUBROUTINES CALLED: NONE                                         */ 02221000
*/*                                                                  */ 02222000
*/* SYSTEM ROUTINES CALLED / MACROS ISSUED: SVC 60 (STAI/ESTAI)      */ 02223000
*/*                                                                  */ 02224000
*/* RETURN CODES SET: X08STAI, ABEND52A, ABEND92A (X'00' AND X'0C'   */ 02225000
*/*                   SET BY SVC 60)                                 */ 02226000
*/*                                                                  */ 02227000
*/* REGISTER USAGE: R15RETCD - OUTPUT, RETURN CODE                   */ 02228000
*/*                                                                  */ 02229000
*/* LEVEL - 1                                                        */ 02230000
*/*                                                                  */ 02231000
*/********************************************************************/ 02232000
*/* E ENTER STAIRTN                                                  */ 02233000
*                                                                  0718 02234000
*   RFY                                                            0718 02235000
*     R14RET RSTD;                                                 0718 02236000
*   WKRTSAVE=R14RET;                /* SAVE AROUND SVC               */ 02237000
         ST    R14RET,WKRTSAVE(,R3WORKAD)                          0719 02238000
*   RFY                                                            0720 02239000
*     R14RET UNRSTD;                                               0720 02240000
*                                                                  0720 02241000
*/* P CLEAR THE SVC 60 PARM LIST TO ZERO                             */ 02242000
*                                                                  0721 02243000
*   RFY                                                            0721 02244000
*     R1ESTAE RSTD;                                                0721 02245000
*   R1ESTAE=ADDR(WKTEMP1);          /* ADDR OF SVC 60 PARM LIST      */ 02246000
         LA    R1ESTAE,WKTEMP1(,R3WORKAD)                          0722 02247000
*   AREA(1:LENGTH(ESTA))=AREA(1:LENGTH(ESTA))&&AREA(1:LENGTH(ESTA));    02248000
*                                                                  0723 02249000
         XC    AREA(16,R1AREA),AREA(R1AREA)                        0723 02250000
*/* P INDICATE STAI/ESTAI REQUEST IN PARM LIST                       */ 02251000
*                                                                  0724 02252000
*   ESTASTAI='1'B;                  /* INDICATE STAI/ESTAI           */ 02253000
         OI    ESTASTAI(ESTAPTR),B'10000000'                       0724 02254000
*/* P SET ADDR NEW TCB IN PARM LIST                                  */ 02255000
*                                                                  0725 02256000
*   ESTAOWNR=R5NEWTCB;              /* NEW TCB ADDR USED FOR       0725 02257000
*                                      STAI/ESTAI (I.E., FOR ATTACH     02258000
*                                      PROCESSING).                  */ 02259000
         ST    R5NEWTCB,ESTAOWNR(,ESTAPTR)                         0725 02260000
*/* D (NO,%FL01120,YES,) WAS STAI OR ESTAI SPECIFIED ?               */ 02261000
*                                                                  0726 02262000
*   IF ATTSTAI='1'B THEN                                           0726 02263000
         TM    ATTSTAI(R3WORKAD),B'00000001'                       0726 02264000
         BNO   @RF00726                                            0726 02265000
*     DO;                           /* DO000012: BUILD CREATE-TYPE 0727 02266000
*                                      LIST                          */ 02267000
*/* D (NO,%FL01130,YES,) WAS ESTAI SPECIFIED ?                       */ 02268000
*                                                                  0728 02269000
*       IF ATESTAI='1'B THEN                                       0728 02270000
         TM    ATESTAI(R3WORKAD),B'00001000'                       0728 02271000
         BNO   @RF00728                                            0728 02272000
*         DO;                       /* DO000013: PROCESS ESTAI PARMS    02273000
*                                      SPECIFIED ON ATTACH MACRO     */ 02274000
*/* P INDICATE ESTAI REQUEST IN PARM LIST                            */ 02275000
*                                                                  0730 02276000
*           ESTAESTA='1'B;          /* CREATE ESTAI-SCB PARM         */ 02277000
         OI    ESTAESTA(ESTAPTR),B'00010000'                       0730 02278000
*           WKESTAI='1'B;           /* INDICATE ESTAI SPECIFIED      */ 02279000
         OI    WKESTAI(R12SVRB),B'00010000'                        0731 02280000
*/* D (NO,%FL01130,YES,) WAS TERM=YES SPECIFIED ON ATTACH?           */ 02281000
*                                                                  0732 02282000
*           IF ATTERM='1'B THEN                                    0732 02283000
*                                                                  0732 02284000
         TM    ATTERM(R3WORKAD),B'00010000'                        0732 02285000
         BNO   @RF00732                                            0732 02286000
*/* P INDICATE TERM OPTION IN PARM LIST                              */ 02287000
*                                                                  0733 02288000
*             ESTATERM='1'B;        /* SPECIFY TERM OPTION           */ 02289000
         OI    ESTATERM(ESTAPTR),B'01000000'                       0733 02290000
*         END;                      /* END00013: END ESTAI PARM    0734 02291000
*                                      PROCESSING                    */ 02292000
*                                                                  0734 02293000
@RF00732 DS    0H                                                  0735 02294000
*       /*************************************************************/ 02295000
*       /*                                                           */ 02296000
*       /* PROCESS PARAMETERS COMMON TO STAI AND ESTAI               */ 02297000
*       /*                                                           */ 02298000
*       /*************************************************************/ 02299000
*                                                                  0735 02300000
*/* %FL01130: D (NO,%FL01140,YES,)    ASYNC=YES SPECIFIED ?          */ 02301000
*                                                                  0735 02302000
*       IF ATSYNCH='1'B THEN                                       0735 02303000
*                                                                  0735 02304000
@RF00728 TM    ATSYNCH(R3WORKAD),B'00000100'                       0735 02305000
         BNO   @RF00735                                            0735 02306000
*/* P INDICATE ASYNCHRONOUS INTERRUPTS ALLOWED                       */ 02307000
*                                                                  0736 02308000
*         ESTASYNC='1'B;            /* SPECIFY ALLOW ASYNCHRONOUS  0736 02309000
*                                      INTERRUPTS                    */ 02310000
         OI    ESTASYNC(ESTAPTR),B'00000100'                       0736 02311000
*/* %FL01140: P SET FLAGS IN ACCORDANCE WITH PURGE SUBPARAMETER      */ 02312000
*                                                                  0737 02313000
*       ESTAFLG1=ESTAFLG1|(ATSTAIF&PURGMASK);/* PURGE FLAGS          */ 02314000
@RF00735 LA    @08,3                                               0737 02315000
         SLR   @07,@07                                             0737 02316000
         IC    @07,ATSTAIF(,R3WORKAD)                              0737 02317000
         NR    @08,@07                                             0737 02318000
         SLR   @07,@07                                             0737 02319000
         IC    @07,ESTAFLG1(,ESTAPTR)                              0737 02320000
         OR    @08,@07                                             0737 02321000
         STC   @08,ESTAFLG1(,ESTAPTR)                              0737 02322000
*/* P SET USER PARM LIST ADDR                                        */ 02323000
*                                                                  0738 02324000
*       ESTAPARM=ATSTAIA;           /* PARM LIST ADDR FOR EXIT RTN   */ 02325000
         SLR   @08,@08                                             0738 02326000
         ICM   @08,7,ATSTAIA(R3WORKAD)                             0738 02327000
         ST    @08,ESTAPARM(,ESTAPTR)                              0738 02328000
*/* P SET EXIT ROUTINE ADDRESS                                       */ 02329000
*                                                                  0739 02330000
*       ESTAEXIT=ATSTAIXT;          /* EXIT RTN ADDR                 */ 02331000
         MVC   ESTAEXIT(3,ESTAPTR),ATSTAIXT(R3WORKAD)              0739 02332000
*/* P (,%FL01150) SET REG0=0 FOR CREATE                              */ 02333000
*                                                                  0740 02334000
*       RFY                                                        0740 02335000
*         R0WORK RSTD;                                             0740 02336000
*       R0WORK=CTSTAI;              /* ZERO: CREATE REQUEST          */ 02337000
         SLR   R0WORK,R0WORK                                       0741 02338000
*     END;                          /* END00012: END OF BUILDING   0742 02339000
*                                      CREATE LIST                   */ 02340000
*                                                                  0742 02341000
*   /*****************************************************************/ 02342000
*   /*                                                               */ 02343000
*   /* NEITHER STAI NOR ESTAI SPECIFIED, ISSUE ESTAI PROP REQUEST TO */ 02344000
*   /* PROPAGATE ANY EXISTING STAI/ESTAI SCB'S.                      */ 02345000
*   /*                                                               */ 02346000
*   /*****************************************************************/ 02347000
*                                                                  0743 02348000
*   ELSE                            /* PROPAGATE                     */ 02349000
*     DO;                           /* DO000014: BUILD PROPAGATE-TYPE   02350000
*                                      LIST                          */ 02351000
         B     @RC00726                                            0743 02352000
@RF00726 DS    0H                                                  0744 02353000
*/* %FL01120: P SET ESTAESTA=1, ESTASTAI=1, REG0 =2 FOR PROP         */ 02354000
*                                                                  0744 02355000
*       ESTAESTA='1'B;              /* INDICATE ESTAI REQUEST        */ 02356000
         OI    ESTAESTA(ESTAPTR),B'00010000'                       0744 02357000
*       WKESTAI='1'B;               /* INDICATE ESTAI SPECIFIED      */ 02358000
         OI    WKESTAI(R12SVRB),B'00010000'                        0745 02359000
*       R0WORK=PROPSTAI;            /* CODE 2: PROPAGATE REQUEST     */ 02360000
         LA    R0WORK,2                                            0746 02361000
*     END;                          /* END00014: END OF BUILDING PROP   02362000
*                                      LIST                          */ 02363000
*/* %FL01150: L STAI/ESTAI: PROCESS REQUEST                          */ 02364000
*                                                                  0748 02365000
*   RFY                                                            0748 02366000
*     R15RETCD RSTD;                                               0748 02367000
@RC00726 DS    0H                                                  0749 02368000
*   SVC(SIXTY);                     /* ISSUE STAI/ESTAI SVC          */ 02369000
         SVC   60                                                  0749 02370000
*   RFY                                                            0750 02371000
*     R0WORK UNRSTD;                                               0750 02372000
*                                                                  0750 02373000
*/* D (NO,AT001400,YES,) ANY ERRORS ?                                */ 02374000
*                                                                  0751 02375000
*   IF R15RETCDÂ¬=X00NOERR THEN                                     0751 02376000
         LTR   R15RETCD,R15RETCD                                   0751 02377000
         BZ    @RF00751                                            0751 02378000
*     DO;                           /* DO000015: DETERMINE ERROR   0752 02379000
*                                      INDICATION                    */ 02380000
*                                                                  0752 02381000
*       /*************************************************************/ 02382000
*       /*                                                           */ 02383000
*       /* STAI/ESTAI ERROR DETERMINATION: THE APPROPRIATE RETURN    */ 02384000
*       /* CODE OR ABEND CODE IS DETERMINED BEFORE CLEANING UP.      */ 02385000
*       /*                                                           */ 02386000
*       /*************************************************************/ 02387000
*                                                                  0753 02388000
*/* D (STAI,%FL01170,E.,) WAS STAI OR ESTAI PERFORMED ?              */ 02389000
*                                                                  0753 02390000
*       IF WKESTAI='1'B THEN                                       0753 02391000
         TM    WKESTAI(R12SVRB),B'00010000'                        0753 02392000
         BNO   @RF00753                                            0753 02393000
*         DO;                       /* DO000094: ESTAI RETURN CODE   */ 02394000
*/* D (NO,%FL01180,YES,) WAS PROP SPECIFIED ?                        */ 02395000
*                                                                  0755 02396000
*           IF ATTSTAI='0'B THEN                                   0755 02397000
*                                                                  0755 02398000
         TM    ATTSTAI(R3WORKAD),B'00000001'                       0755 02399000
         BNZ   @RF00755                                            0755 02400000
*/* P (,AT001400) INDICATE ABEND CODE 52A                            */ 02401000
*                                                                  0756 02402000
*             DO;                   /* DO000016: SET CODE            */ 02403000
*               R15RETCD=ABEND52A;  /* INDICATE ABEND CODE 52A       */ 02404000
         LA    R15RETCD,1322                                       0757 02405000
*               GOTO AT001400;      /* GO EXIT SUBROUTINE            */ 02406000
         B     AT001400                                            0758 02407000
*             END;                  /* END00016: CODE SET            */ 02408000
*/* %FL01180: D (YES,AT001410,NO,) WAS RETURN CODE X'14' ?           */ 02409000
*                                                                  0760 02410000
*           ELSE                                                   0760 02411000
*             IF R15RETCD=STAICD14 THEN/* ELSE IF X'14'              */ 02412000
@RF00755 CH    R15RETCD,@CH02683                                   0760 02413000
         BE    @RT00760                                            0760 02414000
*               GOTO AT001410;      /* GO SET RETURN CODE X'08'      */ 02415000
*         END;                      /* END00094: END ESTAI CODE CHECK*/ 02416000
*                                                                  0762 02417000
*       /*************************************************************/ 02418000
*       /*                                                           */ 02419000
*       /* STAI ERROR, VERSES ESTAI                                  */ 02420000
*       /*                                                           */ 02421000
*       /*************************************************************/ 02422000
*                                                                  0763 02423000
*       ELSE                                                       0763 02424000
*         DO;                       /* DO000096: STAI RETURN CODE    */ 02425000
         B     @RC00753                                            0763 02426000
@RF00753 DS    0H                                                  0764 02427000
*/* %FL01170: D (NO,%FL01160,YES,) WAS RETURN CODE X'04' ?           */ 02428000
*                                                                  0764 02429000
*           IF R15RETCD=STAICD04 THEN                              0764 02430000
*                                                                  0764 02431000
         CH    R15RETCD,@CH02677                                   0764 02432000
         BNE   @RF00764                                            0764 02433000
*/* AT001410: P (,AT001400) SET RETURN CODE X'08'                    */ 02434000
*                                                                  0765 02435000
*AT001410:                                                         0765 02436000
*             DO;                   /* DO000017: SET CODE,         0765 02437000
*                                      INSUFFICIENT CORE             */ 02438000
AT001410 DS    0H                                                  0766 02439000
*               R15RETCD=X08STAI;   /* SET CODE X'08'                */ 02440000
         LA    R15RETCD,8                                          0766 02441000
*               GOTO AT001400;      /* GO EXIT SUBROUTINE            */ 02442000
         B     AT001400                                            0767 02443000
*             END;                  /* END00017: CODE SET            */ 02444000
*/* %FL01160: D (YES,AT001400,NO,) WAS RETURN CODE X'0C' ?           */ 02445000
*                                                                  0769 02446000
*           IF R15RETCD=STAICD0C THEN                              0769 02447000
@RF00764 CH    R15RETCD,@CH02681                                   0769 02448000
         BE    @RT00769                                            0769 02449000
*             GOTO AT001400;        /* GO CLEAN UP (SAME RET CODE)   */ 02450000
*         END;                      /* END00096: END STAI CODE CHECK */ 02451000
*/* FOR OTHER THAN THE SPECIFIC CODES CHECKED, INDICATE ABEND 92A    */ 02452000
*/* %FL01190: P INDICATE ABEND CODE 92A                              */ 02453000
*                                                                  0772 02454000
*       WKREASON=RCODE8;            /* SET REASON CODE               */ 02455000
@RC00753 MVI   WKREASON(R12SVRB),X'08'                             0772 02456000
*       R15RETCD=ABEND92A;          /* ABEND: INDETERMINANT ERROR    */ 02457000
         LA    R15RETCD,2346                                       0773 02458000
*     END;                          /* END00015: END STAI/ESTAI ERROR   02459000
*                                      CHECK                         */ 02460000
*/* AT001400: R RETURN TO CALLING POINT                              */ 02461000
*                                                                  0775 02462000
*   RFY                                                            0775 02463000
*     R14RET RSTD;                                                 0775 02464000
@RF00751 DS    0H                                                  0776 02465000
*AT001400:                                                         0776 02466000
*   R14RET=WKRTSAVE;                /* RETURN ADDRESS                */ 02467000
AT001400 L     R14RET,WKRTSAVE(,R3WORKAD)                          0776 02468000
*/* STAIRTN: END  FLOWCHART                                          */ 02469000
*                                                                  0777 02470000
*   END STAIRTN;                    /* END OF SUBROUTINE             */ 02471000
@EL00005 DS    0H                                                  0777 02472000
@EF00005 DS    0H                                                  0777 02473000
@ER00005 BR    @14                                                 0777 02474000
*   RFY                                                            0778 02475000
*     R14RET UNRSTD;                                               0778 02476000
*   RFY                                                            0779 02477000
*     R1ESTAE UNRSTD;                                              0779 02478000
*   RFY                                                            0780 02479000
*     R15RETCD UNRSTD;                                             0780 02480000
*                                                                  0781 02481000
*   /*****************************************************************/ 02482000
*   /*                                                               */ 02483000
*   /* PRIORITY SUBROUTINE                                           */ 02484000
*   /*                                                               */ 02485000
*   /*****************************************************************/ 02486000
*                                                                  0781 02487000
*PRIORITY:                                                         0781 02488000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 02489000
PRIORITY DS    0H                                                  0782 02490000
*/* PRIORITY: CHART BEGIN SUBROUTINE FLOWCHART                       */ 02491000
*/* FOOTING                                                        0782 02492000
*/* SUBROUTINE WHICH SETS NEW TASK PRIORITIES                        */ 02493000
*/********************************************************************/ 02494000
*/*                                                                  */ 02495000
*/*    SUBROUTINE PROCESSES LIMIT AND DISPATCHING PRIORITIES.        */ 02496000
*/* SUBROUTINES CALLED: NONE                                         */ 02497000
*/*                                                                  */ 02498000
*/* SYSTEM ROUTINES CALLED/MACROS ISSUED: NONE                       */ 02499000
*/*                                                                  */ 02500000
*/* RETURN CODES SET: NONE                                           */ 02501000
*/*                                                                  */ 02502000
*/* REGISTER USAGE: NORMAL                                           */ 02503000
*/*                                                                  */ 02504000
*/* LEVEL - 1                                                        */ 02505000
*/*                                                                  */ 02506000
*/********************************************************************/ 02507000
*/* E ENTER PRIORITY                                                 */ 02508000
*/* P CALCULATE NEW LIMIT PRIORITY                                   */ 02509000
*                                                                  0782 02510000
*   RFY                                                            0782 02511000
*     R0WORK RSTD;                                                 0782 02512000
*   R0WORK=R4CURTCB->TCBLMP;        /* CURRENT TASK LIMIT            */ 02513000
         SLR   R0WORK,R0WORK                                       0783 02514000
         IC    R0WORK,TCBLMP(,R4CURTCB)                            0783 02515000
*   R0WORK=R0WORK-ATLPMOD;          /* NEW LIMIT = OLD - PARM VALUE  */ 02516000
         SLR   @08,@08                                             0784 02517000
         IC    @08,ATLPMOD(,R3WORKAD)                              0784 02518000
         SLR   R0WORK,@08                                          0784 02519000
*/* D (NO,%FL01280,YES,) IS NEW LIMIT > 0 ?                          */ 02520000
*                                                                  0785 02521000
*   IF R0WORK>ZERO THEN                                            0785 02522000
*                                                                  0785 02523000
         LTR   R0WORK,R0WORK                                       0785 02524000
         BNP   @RF00785                                            0785 02525000
*/* P SET NEW TCB'S TCBLP = CALC VALUE                               */ 02526000
*                                                                  0786 02527000
*     R5NEWTCB->TCBLMP=R0WORK;      /* STORE NEW LIMIT INTO NEW TCB     02528000
*                                      OR LEAVE FIELD ZERO IF NEG    */ 02529000
         STC   R0WORK,TCBLMP(,R5NEWTCB)                            0786 02530000
*/* %FL01280: P CALCULATE NEW DISPATCHING PRIORITY                   */ 02531000
*                                                                  0787 02532000
*   RFY                                                            0787 02533000
*     R7WORK RSTD;                                                 0787 02534000
@RF00785 DS    0H                                                  0788 02535000
*   R7WORK=R4CURTCB->TCBDSP;        /* CURRENT DISPATCHING           */ 02536000
         SLR   R7WORK,R7WORK                                       0788 02537000
         IC    R7WORK,TCBDSP(,R4CURTCB)                            0788 02538000
*   R7WORK=R7WORK+ATDPMOD;          /* PLUS PARM VALUE = NEW DISP    */ 02539000
         AH    R7WORK,ATDPMOD(,R3WORKAD)                           0789 02540000
*/* D (NO,%FL01290,YES,) IS NEW DISP > 0 ?                           */ 02541000
*                                                                  0790 02542000
*   IF R7WORK>ZERO THEN                                            0790 02543000
*                                                                  0790 02544000
         LTR   R7WORK,R7WORK                                       0790 02545000
         BNP   @RF00790                                            0790 02546000
*/* D (YES,%FL01300,NO,) IS NEW DISP > NEW LIMIT ?                   */ 02547000
*                                                                  0791 02548000
*     DO;                           /* DO000099                      */ 02549000
*       IF R7WORK<R0WORK THEN       /* COMPARE                       */ 02550000
         CR    R7WORK,R0WORK                                       0792 02551000
         BNL   @RF00792                                            0792 02552000
*/* P (,%FL01290) SET NEW TCB'S TCBDSP = DISP VALUE                  */ 02553000
*                                                                  0793 02554000
*         R5NEWTCB->TCBDSP=R7WORK;  /* NEW DISP = CALC VALUE         */ 02555000
         STC   R7WORK,TCBDSP(,R5NEWTCB)                            0793 02556000
*/* %FL01300: P SET NEW TCB'S TCBDSP = NEW TCB'S TCBLMP              */ 02557000
*                                                                  0794 02558000
*       ELSE                                                       0794 02559000
*         R5NEWTCB->TCBDSP=R5NEWTCB->TCBLMP;/* NEW DISP = NEW LIMIT  */ 02560000
         B     @RC00792                                            0794 02561000
@RF00792 MVC   TCBDSP(1,R5NEWTCB),TCBLMP(R5NEWTCB)                 0794 02562000
*     END;                          /* END00099: LEAVE NEW TCB'S   0795 02563000
*                                      TCBLMP = 0 IF CALC VALUE    0795 02564000
*                                      NEGITIVE                      */ 02565000
*/* %FL01290: R RETURN TO CALLING POINT                              */ 02566000
*/* PRIORITY: END  FLOWCHART                                         */ 02567000
*                                                                  0796 02568000
*   END PRIORITY;                   /* END OF SUBROUTINE             */ 02569000
@EL00006 DS    0H                                                  0796 02570000
@EF00006 DS    0H                                                  0796 02571000
@ER00006 BR    @14                                                 0796 02572000
*   RFY                                                            0797 02573000
*     R0WORK UNRSTD;                                               0797 02574000
*   RFY                                                            0798 02575000
*     R7WORK UNRSTD;                                               0798 02576000
*                                                                  0799 02577000
*   /*****************************************************************/ 02578000
*   /*                                                               */ 02579000
*   /* SPCONTRL SUBROUTINE                                           */ 02580000
*   /*                                                               */ 02581000
*   /*****************************************************************/ 02582000
*                                                                  0799 02583000
*SPCONTRL:                                                         0799 02584000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 02585000
SPCONTRL DS    0H                                                  0800 02586000
*/* SPCONTRL: CHART GIVE-SHARE SUBPOOL CONTROL ROUTINE               */ 02587000
*/* FOOTING                                                        0800 02588000
*/* SUBROUTINE WHICH PROCESSES GIVE AND SHARE REQUESTS               */ 02589000
*/********************************************************************/ 02590000
*/*                                                                  */ 02591000
*/*    SUBROUTINE SPCONTRL HANDLES THE GSPV, GSPL, SHSPV, SHSPL, AND */ 02592000
*/*    SZERO=YES PARAMETERS.                                         */ 02593000
*/*                                                                  */ 02594000
*/* SUBROUTINES CALLED: GIVESP, SHARESP, MOVELIST                    */ 02595000
*/*                                                                  */ 02596000
*/* SYSTEM ROUTINES CALLED / MACROS ISSUED: NONE                     */ 02597000
*/*                                                                  */ 02598000
*/* RETURN CODES SET: NONE (RETURN CODE FROM GIVESP OR SHARESP IS    */ 02599000
*/*                   RETURNED BY THIS SUBROUTINE)                   */ 02600000
*/*                                                                  */ 02601000
*/* REGISTER USAGE: R1WORK - ENTRY CODE:                             */ 02602000
*/*                                 0 - GSPV/GSPL                    */ 02603000
*/*                                 1 - SHSPV/SHSPL                  */ 02604000
*/*                                 2 - SHARE SUBPOOL ZERO           */ 02605000
*/*                                                                  */ 02606000
*/* LEVEL - 1                                                        */ 02607000
*/*                                                                  */ 02608000
*/********************************************************************/ 02609000
*/* E ENTER SPCONTRL                                                 */ 02610000
*                                                                  0800 02611000
*   RFY                                                            0800 02612000
*     R14RET RSTD;                                                 0800 02613000
*   WKRTSAVE=R14RET;                /* SAVE                          */ 02614000
         ST    R14RET,WKRTSAVE(,R3WORKAD)                          0801 02615000
*   RFY                                                            0802 02616000
*     R14RET UNRSTD;                                               0802 02617000
*   RFY                                                            0803 02618000
*     R1WORK RSTD;                                                 0803 02619000
*   RFY                                                            0804 02620000
*     R11PTR RSTD;                                                 0804 02621000
*                                                                  0804 02622000
*/* D (NO,%FL01350,YES,) SHARE ENTRY CODE                            */ 02623000
*                                                                  0805 02624000
*   IF R1WORKÂ¬=ENTCD0 THEN                                         0805 02625000
         LTR   R1WORK,R1WORK                                       0805 02626000
         BZ    @RF00805                                            0805 02627000
*     DO;                           /* DO000021                      */ 02628000
*/* P SET BRANCH REGISTER TO ADDR OF SHARESP                         */ 02629000
*                                                                  0807 02630000
*       R11PTR=ADDR(SHARESP);       /* SHARE SUBPOOL ENTRY CODES     */ 02631000
         LA    R11PTR,SHARESP                                      0807 02632000
*/* D (2,AT001350,1,) CHECK ENTRY CODE                               */ 02633000
*                                                                  0808 02634000
*       IF R1WORK=ENTCD1 THEN                                      0808 02635000
*                                                                  0808 02636000
         CH    R1WORK,@CH00061                                     0808 02637000
         BNE   @RF00808                                            0808 02638000
*/* P (,%FL01370) SET LIST ADDRESS TO SHSPV/SHSPL PARM ADDR          */ 02639000
*                                                                  0809 02640000
*         R1WORK=ADDR(ATSHFLDA);    /* ADDR OF SHARE LIST - VALUE    */ 02641000
         LA    R1WORK,ATSHFLDA(,R3WORKAD)                          0809 02642000
*       ELSE                                                       0810 02643000
*         GOTO AT001350;            /* GO SHARE SP 0, ENTRY CODE=2   */ 02644000
*     END;                          /* END00021: ENTRY CODE=0, GIVE     02645000
*                                      SUBPOOL                       */ 02646000
*/* %FL01350: P SET BRANCH REGISTER TO ADDR OF GIVESP                */ 02647000
*                                                                  0812 02648000
*   ELSE                                                           0812 02649000
*     DO;                           /* DO000092                      */ 02650000
         B     @RC00805                                            0812 02651000
@RF00805 DS    0H                                                  0813 02652000
*       R11PTR=ADDR(GIVESP);        /* GIVE SUBPOOL ENTRY CODE       */ 02653000
         LA    R11PTR,GIVESP                                       0813 02654000
*/* P SET LIST ADDRESS TO GSPV/GSPL PARM ADDR                        */ 02655000
*                                                                  0814 02656000
*       R1WORK=ADDR(ATGSFLDA);      /* ADDRESS OF GIVE LIST - VALUE  */ 02657000
         LA    R1WORK,ATGSFLDA(,R3WORKAD)                          0814 02658000
*     END;                          /* END00092                      */ 02659000
*                                                                  0816 02660000
*   /*****************************************************************/ 02661000
*   /*                                                               */ 02662000
*   /* COMMON PROCESSING FOR GIVE/SHARE PARAMETERS.IF GSPV OR SHSPV  */ 02663000
*   /* WAS SPECIFIED, THE APPROPRIATE SUBROUTINE, GIVESP OR SHARESP, */ 02664000
*   /* RESPECTIVELY, IS CALLED TO PROCESS THE SINGLE REQUEST, BY     */ 02665000
*   /* BRANCHING ON THE BRANCH REGISTER SET ABOVE. IF GSPL OR SHSPL  */ 02666000
*   /* WAS SPECIFIED, THE LIST IS VALIDITY CHECKED AND MOVED INTO    */ 02667000
*   /* ATTACH'S WORKAREA, BY SUBROUTINE MOVELIST, AND THE REQUESTS   */ 02668000
*   /* ARE PROCESSED INDIVIDUALLY, IN A LOOP.                        */ 02669000
*   /*                                                               */ 02670000
*   /*****************************************************************/ 02671000
*                                                                  0816 02672000
*/* %FL01370: D (NO,%FL01380,YES,) WAS A VALUE SPECIFIED ?           */ 02673000
*                                                                  0816 02674000
*   IF R1WORK->FLAGBIT7='0'B THEN   /* BIT 7 OF PARM WORD =0,VALUE   */ 02675000
@RC00805 TM    FLAGBIT7(R1WORK),B'00000001'                        0816 02676000
         BNZ   @RF00816                                            0816 02677000
*     DO;                           /* DO000023: PROCESS SINGLE    0817 02678000
*                                      REQUEST                       */ 02679000
*/* P GET VALUE FROM PARM LIST                                       */ 02680000
*                                                                  0818 02681000
*       RFY                                                        0818 02682000
*         R0WORK RSTD;                                             0818 02683000
*       R0WORK=R1WORK->BYTE3;       /* VALUE FROM LOW ORDER PARM BYTE*/ 02684000
         SLR   R0WORK,R0WORK                                       0819 02685000
         IC    R0WORK,BYTE3(,R1WORK)                               0819 02686000
*/* S (,AT001150)  : PROCESS SINGLE REQUEST                          */ 02687000
*                                                                  0820 02688000
*       CALL R11PTR->SUBRTINE;      /* PROCESS REQUEST               */ 02689000
         LR    @15,R11PTR                                          0820 02690000
         BALR  @14,@15                                             0820 02691000
*       GOTO AT001150;              /* GOTO SUBROUTINE EXIT POINT    */ 02692000
         B     AT001150                                            0821 02693000
*     END;                          /* END00023: END VALUE PROCESSING*/ 02694000
*                                                                  0822 02695000
*   /*****************************************************************/ 02696000
*   /*                                                               */ 02697000
*   /* LIST ADRESS WAS SPECIFIED, PROCESS ALL REQUESTS               */ 02698000
*   /*                                                               */ 02699000
*   /*****************************************************************/ 02700000
*                                                                  0823 02701000
*/* %FL01380: S MOVELIST: VALID CHK AND FETCH LIST LENGTH            */ 02702000
*                                                                  0823 02703000
*   RFY                                                            0823 02704000
*     R7WORK RSTD;                                                 0823 02705000
@RF00816 DS    0H                                                  0824 02706000
*   RFY                                                            0824 02707000
*     R8WORK RSTD;                                                 0824 02708000
*   R7WORK=R1WORK->BYTES123;        /* ADDRESS OF LIST               */ 02709000
         SLR   R7WORK,R7WORK                                       0825 02710000
         ICM   R7WORK,7,BYTES123(R1WORK)                           0825 02711000
*   R0WORK=ONE;                     /* FIRST BYTE = LENGTH REMAINING */ 02712000
         LA    R0WORK,1                                            0826 02713000
*   R8WORK=ADDR(WKTEMP1);           /* ADDRESS OF SUBLIST            */ 02714000
         LA    R8WORK,WKTEMP1(,R3WORKAD)                           0827 02715000
*   CALL MOVELIST;                  /* GET FIRST BYTE = LENGTH       */ 02716000
         BAL   @14,MOVELIST                                        0828 02717000
*   R7WORK=R7WORK+ONE;              /* ADDRESS OF FIRST LIST ENTRY,     02718000
*                                      IF ANY                        */ 02719000
         AH    R7WORK,@CH00061                                     0829 02720000
*   RFY                                                            0830 02721000
*     R2WORK RSTD;                                                 0830 02722000
*   RFY                                                            0831 02723000
*     R1WORK UNRSTD;                                               0831 02724000
*                                                                  0831 02725000
*/* P SET LENGTH REG TO NUMBER ENTRIES IN SUBLIST                    */ 02726000
*                                                                  0832 02727000
*   R2WORK=R8WORK->BYTE0;           /* GET LENGTH REMAINDER OF LIST  */ 02728000
         SLR   R2WORK,R2WORK                                       0832 02729000
         IC    R2WORK,BYTE0(,R8WORK)                               0832 02730000
*   RFY                                                            0833 02731000
*     R10LOOPC RSTD;                                               0833 02732000
*   DO WHILE R2WORKÂ¬=ZERO;          /* DO000025: PROCESS ENTIRE LIST */ 02733000
         B     @DE00834                                            0834 02734000
@DL00834 DS    0H                                                  0835 02735000
*     R8WORK=ADDR(WKTEMP1);         /* REINITIALIZE SUBLIST ADDR     */ 02736000
         LA    R8WORK,WKTEMP1(,R3WORKAD)                           0835 02737000
*/* %FL01430: D (YES,%FL01390,NO,) LENGTH REMAINING < MAX ?          */ 02738000
*                                                                  0836 02739000
*     IF R2WORK>LENGTH(WKTEMPS) THEN                               0836 02740000
         LA    @01,32                                              0836 02741000
         CR    R2WORK,@01                                          0836 02742000
         BNH   @RF00836                                            0836 02743000
*       DO;                         /* DO000024: MOVE MAX NUMBER   0837 02744000
*                                      ENTRIES                       */ 02745000
*/* S MOVELIST: MOVE MAX LIST ENTRIES TO SUBLIST                     */ 02746000
*                                                                  0838 02747000
*         R0WORK=LENGTH(WKTEMPS);   /* MAXIMUN LENGTH                */ 02748000
         LR    R0WORK,@01                                          0838 02749000
*         CALL MOVELIST;            /* VALID CHK AND MOVE MAX ENTRIES*/ 02750000
         BAL   @14,MOVELIST                                        0839 02751000
*         R7WORK=R7WORK+LENGTH(WKTEMPS);/* UPDATE PTR TO NEXT IN LIST*/ 02752000
         LA    @01,32                                              0840 02753000
         ALR   R7WORK,@01                                          0840 02754000
*/* P LENGTH REG = LENGTH REG - MAX                                  */ 02755000
*                                                                  0841 02756000
*         R2WORK=R2WORK-LENGTH(WKTEMPS);/* NUMBER REMAINING LIST   0841 02757000
*                                      ENTRIES                       */ 02758000
         SLR   R2WORK,@01                                          0841 02759000
*/* P (,%FL01420) LOOP CONTROL REG = MAX                             */ 02760000
*                                                                  0842 02761000
*         R10LOOPC=LENGTH(WKTEMPS); /* NUMBER ENTRIES IN SUBLIST     */ 02762000
         LR    R10LOOPC,@01                                        0842 02763000
*       END;                        /* END00024: END MAX MOVE        */ 02764000
*     ELSE                          /* MOVE REMAINING BYTES          */ 02765000
*       DO;                         /* DO000026: MOVE REMAINDER      */ 02766000
         B     @RC00836                                            0844 02767000
@RF00836 DS    0H                                                  0845 02768000
*/* %FL01390: S MOVELIST: MOVE REMAINDER OF LIST ENTRIES TO SUBLIST  */ 02769000
*                                                                  0845 02770000
*         R0WORK=R2WORK;            /* LENGTH REMAINING IN LIST      */ 02771000
         LR    R0WORK,R2WORK                                       0845 02772000
*         CALL MOVELIST;            /* MOVE LAST OF LIST TO SUBLIST  */ 02773000
         BAL   @14,MOVELIST                                        0846 02774000
*/* P SET LOOP CONTROL TO NUMBER ENTRIES IN SUBLIST                  */ 02775000
*                                                                  0847 02776000
*         R10LOOPC=R2WORK;          /* NUMBER OF ENTRIES IN SUBLIST  */ 02777000
         LR    R10LOOPC,R2WORK                                     0847 02778000
*/* P SET LENGTH REG TO ZERO                                         */ 02779000
*                                                                  0848 02780000
*         R2WORK=ZERO;              /* NO MORE ENTRIES TO PROCESS    */ 02781000
         SLR   R2WORK,R2WORK                                       0848 02782000
*       END;                        /* END00026: END REMAINDER MOVE  */ 02783000
*     DO R10LOOPC=R10LOOPC TO 1 BY-1;/* DO000027: SUBLIST LOOP       */ 02784000
@RC00836 B     @DE00850                                            0850 02785000
@DL00850 DS    0H                                                  0851 02786000
*/* %FL01420: S : PROCESS ONE ENTRY                                  */ 02787000
*                                                                  0851 02788000
*       R0WORK=R8WORK->ZBYTE;       /* GET SUBPOOL ID                */ 02789000
         SLR   R0WORK,R0WORK                                       0851 02790000
         IC    R0WORK,ZBYTE(,R8WORK)                               0851 02791000
*       CALL R11PTR->SUBRTINE;      /* CALL APPROPRIATE SUBROUTINE   */ 02792000
         LR    @15,R11PTR                                          0852 02793000
         BALR  @14,@15                                             0852 02794000
*       RFY                                                        0853 02795000
*         R15RETCD RSTD;                                           0853 02796000
*                                                                  0853 02797000
*/* D (YES,AT001150,NO,) ANY ERRORS ?                                */ 02798000
*                                                                  0854 02799000
*       IF R15RETCDÂ¬=X00NOERR THEN                                 0854 02800000
         LTR   R15RETCD,R15RETCD                                   0854 02801000
         BNZ   @RT00854                                            0854 02802000
*         GOTO AT001150;            /* GO TO EXIT FROM SUBROUTINE    */ 02803000
*       RFY                                                        0856 02804000
*         R15RETCD UNRSTD;                                         0856 02805000
*                                                                  0856 02806000
*/* P ENTRY PTR = ENTRY PTR + 1                                      */ 02807000
*                                                                  0857 02808000
*       R8WORK=R8WORK+ONE;          /* ADDRESS NEXT ENTRY IN SUBLIST */ 02809000
         AH    R8WORK,@CH00061                                     0857 02810000
*/* D (YES,%FL01420,NO,) MORE ENTRIES IN SUBLIST TO PROCESS ?        */ 02811000
*                                                                  0858 02812000
*     END;                          /* END00027: END SUBLIST LOOP    */ 02813000
         BCTR  R10LOOPC,0                                          0858 02814000
@DE00850 LTR   R10LOOPC,R10LOOPC                                   0858 02815000
         BP    @DL00850                                            0858 02816000
*/* D (YES,%FL01430,NO,AT001150) MORE ENTRIES IN LIST TO PROCESS ?   */ 02817000
*                                                                  0859 02818000
*   END;                            /* END00025: END LIST LOOP       */ 02819000
@DE00834 LTR   R2WORK,R2WORK                                       0859 02820000
         BNZ   @DL00834                                            0859 02821000
*   GOTO AT001150;                  /* GO EXIT SUBROUTINE            */ 02822000
         B     AT001150                                            0860 02823000
*   RFY                                                            0861 02824000
*     R10LOOPC UNRSTD;                                             0861 02825000
*                                                                  0861 02826000
*   /*****************************************************************/ 02827000
*   /*                                                               */ 02828000
*   /* PROCESS SHARING OF SUBPOOL ZERO, DONE AUTOMATICALLY, EXCEPT IN*/ 02829000
*   /* THE CASE WHERE A SYSTEM PROGRAM SPECIFIED SZERO=NO.           */ 02830000
*   /*                                                               */ 02831000
*   /*****************************************************************/ 02832000
*                                                                  0862 02833000
*/* AT001350: S SHARESP: SHARE SUBPOOL 0                             */ 02834000
*                                                                  0862 02835000
*AT001350:                                                         0862 02836000
*   R0WORK=ZERO;                    /* SUBPOOL ID = 0                */ 02837000
AT001350 SLR   R0WORK,R0WORK                                       0862 02838000
*   CALL R11PTR->SUBRTINE;          /* BRANCH REG CONTAINS ADDRESS OF   02839000
*                                      SHARESP SUBROUTINE            */ 02840000
         LR    @15,R11PTR                                          0863 02841000
         BALR  @14,@15                                             0863 02842000
*/* AT001150: R RETURN TO CALLING POINT                              */ 02843000
*                                                                  0864 02844000
*   RFY                                                            0864 02845000
*     R14RET RSTD;                                                 0864 02846000
*AT001150:                                                         0865 02847000
*   R14RET=WKRTSAVE;                /* RETURN ADDRESS                */ 02848000
AT001150 L     R14RET,WKRTSAVE(,R3WORKAD)                          0865 02849000
*/* SPCONTRL: END SUBROUTINE FLOWCHART                               */ 02850000
*                                                                  0866 02851000
*   END SPCONTRL;                   /* END SUBROUTINE SPCONTRL       */ 02852000
@EL00007 DS    0H                                                  0866 02853000
@EF00007 DS    0H                                                  0866 02854000
@ER00007 BR    @14                                                 0866 02855000
*   RFY                                                            0867 02856000
*     R14RET UNRSTD;                                               0867 02857000
*   RFY                                                            0868 02858000
*     R2WORK UNRSTD;                                               0868 02859000
*   RFY                                                            0869 02860000
*     R7WORK UNRSTD;                                               0869 02861000
*   RFY                                                            0870 02862000
*     R8WORK UNRSTD;                                               0870 02863000
*   RFY                                                            0871 02864000
*     R11PTR UNRSTD;                                               0871 02865000
*   RFY                                                            0872 02866000
*     R0WORK UNRSTD;                                               0872 02867000
*                                                                  0873 02868000
*   /*****************************************************************/ 02869000
*   /*                                                               */ 02870000
*   /* SHARESP SUBROUTINE                                            */ 02871000
*   /*                                                               */ 02872000
*   /*****************************************************************/ 02873000
*                                                                  0873 02874000
*SHARESP:                                                          0873 02875000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 02876000
SHARESP  DS    0H                                                  0874 02877000
*/* SHARESP: CHART  BEGIN FLOWCHART                                  */ 02878000
*/* FOOTING                                                        0874 02879000
*/* SUBROUTINE SHARES ONE SUBPOOL                                    */ 02880000
*/********************************************************************/ 02881000
*/*                                                                  */ 02882000
*/*    SUBROUTINE SHARES A SINGLE SUBPOOL WITH 0 <= ID <= 127        */ 02883000
*/*                                                                  */ 02884000
*/*    SUBROUTINES CALLED: SPQESRCH, GETSPQE                         */ 02885000
*/*                                                                  */ 02886000
*/*    SYSTEM MACROS ISSUED: NONE                                    */ 02887000
*/*                                                                  */ 02888000
*/*    RETURN CODES: X00NOERR, ABEND22A, ABEND92A (RETURN CODE       */ 02889000
*/*                  FROM SUBROUTINE GETSPQE)                        */ 02890000
*/*                                                                  */ 02891000
*/*    REGISTER USAGE: R0WORK - INPUT SUBPOOL ID                     */ 02892000
*/*                    R1AREA - SPQE ADDR FROM GETSPQE               */ 02893000
*/*                    R15WORK - RETURN ADDR FROM SPQESRCH           */ 02894000
*/*                                                                  */ 02895000
*/*    LEVEL - 2                                                     */ 02896000
*/*                                                                  */ 02897000
*/********************************************************************/ 02898000
*/* E ENTER SHARESP                                                  */ 02899000
*                                                                  0874 02900000
*   RFY                                                            0874 02901000
*     R0WORK RSTD;                                                 0874 02902000
*   RFY                                                            0875 02903000
*     R7WORK RSTD;                                                 0875 02904000
*   RFY                                                            0876 02905000
*     R8WORK RSTD;                                                 0876 02906000
*   RFY                                                            0877 02907000
*     R10LOOPC RSTD;                                               0877 02908000
*   RFY                                                            0878 02909000
*     R2WORK RSTD;                                                 0878 02910000
*   RFY                                                            0879 02911000
*     R11PTR RSTD;                                                 0879 02912000
*   RFY                                                            0880 02913000
*     R14RET RSTD;                                                 0880 02914000
*   WKSAVEA=R7WORK;                 /* SAVE                          */ 02915000
         ST    R7WORK,WKSAVEA(,R3WORKAD)                           0881 02916000
*   WKSAVEB=R8WORK;                 /* SAVE                          */ 02917000
         ST    R8WORK,WKSAVEB(,R3WORKAD)                           0882 02918000
*   WKSAVEC=R10LOOPC;               /* SAVE                          */ 02919000
         ST    R10LOOPC,WKSAVEC(,R3WORKAD)                         0883 02920000
*   WKSAVED=R2WORK;                 /* SAVE                          */ 02921000
         ST    R2WORK,WKSAVED(,R3WORKAD)                           0884 02922000
*   WKSAVEE=R11PTR;                 /* SAVE                          */ 02923000
         ST    R11PTR,WKSAVEE(,R3WORKAD)                           0885 02924000
*   WKRTSAV2=R14RET;                /* SAVE RETURN ADDRESS           */ 02925000
         ST    R14RET,WKRTSAV2(,R3WORKAD)                          0886 02926000
*   RFY                                                            0887 02927000
*     R8WORK UNRSTD;                                               0887 02928000
*   RFY                                                            0888 02929000
*     R7WORK UNRSTD;                                               0888 02930000
*   RFY                                                            0889 02931000
*     R10LOOPC UNRSTD;                                             0889 02932000
*   RFY                                                            0890 02933000
*     R2WORK UNRSTD;                                               0890 02934000
*   RFY                                                            0891 02935000
*     R11PTR UNRSTD;                                               0891 02936000
*   RFY                                                            0892 02937000
*     R14RET UNRSTD;                                               0892 02938000
*                                                                  0892 02939000
*/* D (NO,%FL01850,YES,) IS INPUT SP ID > 127 ?                      */ 02940000
*                                                                  0893 02941000
*   IF R0WORK>SP127 THEN                                           0893 02942000
*                                                                  0893 02943000
         CH    R0WORK,@CH02714                                     0893 02944000
         BNH   @RF00893                                            0893 02945000
*/* P (,AT001600) SET ABEND CODE 22A                                 */ 02946000
*                                                                  0894 02947000
*     DO;                           /* DO000063                      */ 02948000
*       RFY                                                        0895 02949000
*         R15RETCD RSTD;                                           0895 02950000
*       R15RETCD=ABEND22A;          /* INVALID ID                    */ 02951000
         LA    R15RETCD,554                                        0896 02952000
*       GOTO AT001600;              /* GO EXIT SUBROUTINE            */ 02953000
         B     AT001600                                            0897 02954000
*       RFY                                                        0898 02955000
*         R15RETCD UNRSTD;                                         0898 02956000
*     END;                          /* END00063                      */ 02957000
*/* %FL01850: S SPQESRCH: SEARCH NEW TCB FOR SPQE                    */ 02958000
*                                                                  0900 02959000
*   RFY                                                            0900 02960000
*     R1WORK RSTD;                                                 0900 02961000
@RF00893 DS    0H                                                  0901 02962000
*   RFY                                                            0901 02963000
*     R15WORK RSTD;                                                0901 02964000
*   R1WORK=R5NEWTCB;                /* SEARCH NEW TCB                */ 02965000
         LR    R1WORK,R5NEWTCB                                     0902 02966000
*   CALL SPQESRCH;                  /* CHECK NEW TCB FOR THIS SP ID  */ 02967000
         BAL   @14,SPQESRCH                                        0903 02968000
*   RFY                                                            0904 02969000
*     R1WORK UNRSTD;                                               0904 02970000
*                                                                  0904 02971000
*/* D (YES,AT001610,NO,) FOUND ?                                     */ 02972000
*                                                                  0905 02973000
*   IF R15WORKÂ¬=ZERO THEN                                          0905 02974000
         LTR   R15WORK,R15WORK                                     0905 02975000
         BNZ   @RT00905                                            0905 02976000
*     GOTO AT001610;                /* SUBPOOL HAS ALREADY BEEN GIVEN   02977000
*                                      OR SHARED, GO EXIT            */ 02978000
*   RFY                                                            0907 02979000
*     R15WORK UNRSTD;                                              0907 02980000
*                                                                  0907 02981000
*/* S GETSPQE: OBTAIN SPQE STORAGE                                   */ 02982000
*                                                                  0908 02983000
*   RFY                                                            0908 02984000
*     R1AREA RSTD;                  /*                       @Z30ENVB*/ 02985000
*   RFY                                                            0909 02986000
*     R15RETCD RSTD;                /*                       @Z30ENVB*/ 02987000
*   CALL GETSPQE;                   /* GET SPQE STORAGE FOR NEW TCB     02988000
*                                                            @Z30ENVB*/ 02989000
         BAL   @14,GETSPQE                                         0910 02990000
*/* D (YES,AT001600,NO,) ANY ERRORS?                                 */ 02991000
*                                                                  0911 02992000
*   IF R15RETCDÂ¬=X00NOERR THEN      /*                       @Z30ENVB*/ 02993000
         LTR   R15RETCD,R15RETCD                                   0911 02994000
         BNZ   @RT00911                                            0911 02995000
*     GO TO AT001600;               /* GO EXIT SUBROUTINE    @Z30ENVB*/ 02996000
*   RFY                                                            0913 02997000
*     R15RETCD UNRSTD;              /*                       @Z30ENVB*/ 02998000
*/* P BUILD SHARED SPQE AND CHAIN OFF NEW TCB                        */ 02999000
*                                                                  0914 03000000
*   IF R5NEWTCB->TCBMSSBÂ¬=ZERO THEN /* IF QUEUE NOT EMPTY            */ 03001000
         SLR   @08,@08                                             0914 03002000
         ICM   @08,7,TCBMSSB(R5NEWTCB)                             0914 03003000
         LTR   @08,@08                                             0914 03004000
         BZ    @RF00914                                            0914 03005000
*     R1AREA->SPQEPTR=R5NEWTCB->TCBMSSB;/* CHAIN NEW TO NEXT @Z30ENVB*/ 03006000
         ST    @08,SPQEPTR(,R1AREA)                                0915 03007000
*   ELSE                            /* ELSE                          */ 03008000
*     R1AREA->LASTSPQE='1'B;        /* SET END-OF- QUEUE FLAG IN NEW    03009000
*                                                            @Z30ENVB*/ 03010000
         B     @RC00914                                            0916 03011000
@RF00914 OI    LASTSPQE(R1AREA),B'01000000'                        0916 03012000
*   R5NEWTCB->TCBMSSB=R1AREA;       /* CHAIN NEW SPQE OFF NEW TCB  0917 03013000
*                                                            @Z30ENVB*/ 03014000
@RC00914 STCM  R1AREA,7,TCBMSSB(R5NEWTCB)                          0917 03015000
*   R1AREA->SPSHARE='1'B;           /* SP NOT OWNED BY NEW TCB     0918 03016000
*                                                            @Z30ENVB*/ 03017000
         OI    SPSHARE(R1AREA),B'10000000'                         0918 03018000
*   R1AREA->SPQEID=R0WORK;          /* SET ID                @Z30ENVB*/ 03019000
         STC   R0WORK,SPQEID(,R1AREA)                              0919 03020000
*   RFY                                                            0920 03021000
*     R1AREA UNRSTD;                /*                       @Z30ENVB*/ 03022000
*/* S SPQESRCH: SEARCH CURRENT TCB FOR SPQE                          */ 03023000
*                                                                  0921 03024000
*   RFY                                                            0921 03025000
*     R1WORK RSTD;                                                 0921 03026000
*   RFY                                                            0922 03027000
*     R15WORK RSTD;                                                0922 03028000
*   R1WORK=R4CURTCB;                /* SEARCH ATTACHOR'S TCB         */ 03029000
         LR    R1WORK,R4CURTCB                                     0923 03030000
*   CALL SPQESRCH;                  /* CHECK CURRENT TCB FOR SP ID   */ 03031000
         BAL   @14,SPQESRCH                                        0924 03032000
*   RFY                                                            0925 03033000
*     R1WORK UNRSTD;                                               0925 03034000
*                                                                  0925 03035000
*/* D (YES,%FL01860,NO,) FOUND ?                                     */ 03036000
*                                                                  0926 03037000
*   IF R15WORK=ZERO THEN                                           0926 03038000
         LTR   R15WORK,R15WORK                                     0926 03039000
         BNZ   @RF00926                                            0926 03040000
*     DO;                           /* DO000064                      */ 03041000
*       RFY                                                        0928 03042000
*         R15WORK UNRSTD;                                          0928 03043000
*                                                                  0928 03044000
*/* S GETSPQE: OBTAIN SPQE STORAGE                                   */ 03045000
*                                                                  0929 03046000
*       RFY                                                        0929 03047000
*         R1AREA RSTD;              /*                       @Z30ENVB*/ 03048000
*       RFY                                                        0930 03049000
*         R15RETCD RSTD;            /*                       @Z30ENVB*/ 03050000
*       CALL GETSPQE;               /* GET SPQE STORAGE FOR CURRENT     03051000
*                                      TCB                   @Z30ENVB*/ 03052000
         BAL   @14,GETSPQE                                         0931 03053000
*/* D (YES,AT001600,NO,) ANY ERRORS ?                                */ 03054000
*                                                                  0932 03055000
*       IF R15RETCDÂ¬=X00NOERR THEN  /*                       @Z30ENVB*/ 03056000
         LTR   R15RETCD,R15RETCD                                   0932 03057000
         BNZ   @RT00932                                            0932 03058000
*         GO TO AT001600;           /* GO EXIT SUBROUTINE    @Z30ENVB*/ 03059000
*       RFY                                                        0934 03060000
*         R15RETCD UNRSTD;          /*                       @Z30ENVB*/ 03061000
*/* P BUILD OWNED-SHARED SPQE AND CHAIN OFF DUMMY TCBMSS QUEUE       */ 03062000
*                                                                  0935 03063000
*       IF WKTCBMSS=ZERO THEN       /* IS QUEUE EMPTY ?      @Z30ENVB*/ 03064000
         ICM   @08,15,WKTCBMSS(R12SVRB)                            0935 03065000
         BNZ   @RF00935                                            0935 03066000
*         WKSPQE1=R1AREA;           /* YES - SAVE PTR TO FIRST     0936 03067000
*                                      (OLDEST) SPQE ON DUMMY TCBMSS    03068000
*                                      QUEUE                 @Z30ENVB*/ 03069000
         ST    R1AREA,WKSPQE1(,R3WORKAD)                           0936 03070000
*       ELSE                        /* NO                    @Z30ENVB*/ 03071000
*         R1AREA->SPQEPTR=WKTCBMSS; /* CHAIN NEW TO OLD      @Z30ENVB*/ 03072000
         B     @RC00935                                            0937 03073000
@RF00935 MVC   SPQEPTR(4,R1AREA),WKTCBMSS(R12SVRB)                 0937 03074000
*       WKTCBMSS=R1AREA;            /* CHAIN NEW SPQE AT TOP OF DUMMY   03075000
*                                      TCBMSS QUEUE          @Z30ENVB*/ 03076000
@RC00935 ST    R1AREA,WKTCBMSS(,R12SVRB)                           0938 03077000
*       R1AREA->SPQEOWN='1'B;       /* SUBPOOL IS OWNED-AND-SHARED BY   03078000
*                                      CURRENT TASK          @Z30ENVB*/ 03079000
         OI    SPQEOWN(R1AREA),B'00100000'                         0939 03080000
*       R1AREA->SPQEID=R0WORK;      /* SET SUBPOOL ID        @Z30ENVB*/ 03081000
         STC   R0WORK,SPQEID(,R1AREA)                              0940 03082000
*       R1AREA->SPQEKEY=R4CURTCB->TCBPKF;/* SET PROTECT KEY  @Z30ENVB*/ 03083000
         MVC   SPQEKEY(1,R1AREA),TCBPKF(R4CURTCB)                  0941 03084000
*/* P PROPAGATE SPQEKEY TO NEW SPQE                                  */ 03085000
*                                                                  0942 03086000
*       R5NEWTCB->TCBMSSB->SPQEKEY=R4CURTCB->TCBPKF;/* KEY           */ 03087000
         SLR   @08,@08                                             0942 03088000
         ICM   @08,7,TCBMSSB(R5NEWTCB)                             0942 03089000
         MVC   SPQEKEY(1,@08),TCBPKF(R4CURTCB)                     0942 03090000
*/* P (,AT001610) SET NEW SPDQEAD TO ADDRESS OF THIS SPQE            */ 03091000
*                                                                  0943 03092000
*       R5NEWTCB->TCBMSSB->SPDQEAD=R1AREA;/* 'DQE' PTR       @Z30ENVB*/ 03093000
         ST    R1AREA,SPDQEAD(,@08)                                0943 03094000
*     END;                          /* END00064                      */ 03095000
*                                                                  0944 03096000
*   /*****************************************************************/ 03097000
*   /*                                                               */ 03098000
*   /* SPQE FOR SUBPOOL BEING SHARED ALREADY EXISTS FOR CURRENT TASK */ 03099000
*   /*                                                               */ 03100000
*   /*****************************************************************/ 03101000
*                                                                  0945 03102000
*   ELSE                                                           0945 03103000
*     DO;                           /* DO000067                      */ 03104000
         B     @RC00926                                            0945 03105000
@RF00926 DS    0H                                                  0946 03106000
*       RFY                                                        0946 03107000
*         R0WORK UNRSTD;                                           0946 03108000
*       RFY                                                        0947 03109000
*         R1AREA UNRSTD;            /*                       @Z30ENVB*/ 03110000
*       RFY                                                        0948 03111000
*         R7WORK UNRSTD;                                           0948 03112000
*       RFY                                                        0949 03113000
*         R15WORK RSTD;                                            0949 03114000
*                                                                  0949 03115000
*/* %FL01860: P PROPAGATE SPQEKEY FROM OLD SPQE TO NEW               */ 03116000
*                                                                  0950 03117000
*       R5NEWTCB->TCBMSSB->SPQEKEY=R15WORK->SPQEKEY;/* KEY           */ 03118000
         SLR   @14,@14                                             0950 03119000
         ICM   @14,7,TCBMSSB(R5NEWTCB)                             0950 03120000
         MVC   SPQEKEY(1,@14),SPQEKEY(R15WORK)                     0950 03121000
*/* D (YES,%FL01870,NO,) DOES CURRENT TASK OWN SUBPOOL ?             */ 03122000
*                                                                  0951 03123000
*       IF R15WORK->SPSHARE='1'B THEN                              0951 03124000
*                                                                  0951 03125000
         TM    SPSHARE(R15WORK),B'10000000'                        0951 03126000
         BNO   @RF00951                                            0951 03127000
*/* P (,AT001610) PROPAGATE SPDQEAD FROM OLD TO NEW                  */ 03128000
*                                                                  0952 03129000
*         R5NEWTCB->TCBMSSB->SPDQEAD=R15WORK->SPDQEAD;/* ADDRESS OF     03130000
*                                      OWNING SPQE                   */ 03131000
         MVC   SPDQEAD(4,@14),SPDQEAD(R15WORK)                     0952 03132000
*       ELSE                        /* SHARED SUBPOOL                */ 03133000
*         DO;                       /* DO000066                      */ 03134000
         B     @RC00951                                            0953 03135000
@RF00951 DS    0H                                                  0954 03136000
*/* %FL01870: P SET CURRENT TCB'S SPQE'S OWNED-SHARED FLAG           */ 03137000
*                                                                  0954 03138000
*           R15WORK->SPQEOWN='1'B;                                 0954 03139000
*                                                                  0954 03140000
         OI    SPQEOWN(R15WORK),B'00100000'                        0954 03141000
*/* P SET NEW SPDQEAD TO ADDRESS OF OLD SPQE                         */ 03142000
*                                                                  0955 03143000
*           R5NEWTCB->TCBMSSB->SPDQEAD=R15WORK;/* 'DQE' PTR          */ 03144000
         ICM   @14,7,TCBMSSB(R5NEWTCB)                             0955 03145000
         ST    R15WORK,SPDQEAD(,@14)                               0955 03146000
*         END;                      /* END00066                      */ 03147000
*     END;                          /* END00067                      */ 03148000
@RC00951 DS    0H                                                  0958 03149000
*   RFY                                                            0958 03150000
*     R15WORK UNRSTD;                                              0958 03151000
*                                                                  0958 03152000
@RC00926 DS    0H                                                  0959 03153000
*/* AT001610: P SET RETURN CODE = 0                                  */ 03154000
*                                                                  0959 03155000
*   RFY                                                            0959 03156000
*     R15RETCD RSTD;                                               0959 03157000
*AT001610:                                                         0960 03158000
*   R15RETCD=X00NOERR;              /* PROCESSING SUCCESSFUL         */ 03159000
AT001610 SLR   R15RETCD,R15RETCD                                   0960 03160000
*/* AT001600: R RETURN TO CALLING POINT                              */ 03161000
*                                                                  0961 03162000
*   RFY                                                            0961 03163000
*     R2WORK RSTD;                                                 0961 03164000
*   RFY                                                            0962 03165000
*     R7WORK RSTD;                                                 0962 03166000
*   RFY                                                            0963 03167000
*     R8WORK RSTD;                                                 0963 03168000
*   RFY                                                            0964 03169000
*     R10LOOPC RSTD;                                               0964 03170000
*   RFY                                                            0965 03171000
*     R11PTR RSTD;                                                 0965 03172000
*   RFY                                                            0966 03173000
*     R14RET RSTD;                                                 0966 03174000
*AT001600:                                                         0967 03175000
*   R7WORK=WKSAVEA;                 /* RESTORE                       */ 03176000
AT001600 L     R7WORK,WKSAVEA(,R3WORKAD)                           0967 03177000
*   R8WORK=WKSAVEB;                 /* RESTORE                       */ 03178000
         L     R8WORK,WKSAVEB(,R3WORKAD)                           0968 03179000
*   R10LOOPC=WKSAVEC;               /* RESTORE                       */ 03180000
         L     R10LOOPC,WKSAVEC(,R3WORKAD)                         0969 03181000
*   R2WORK=WKSAVED;                 /* RESTORE                       */ 03182000
         L     R2WORK,WKSAVED(,R3WORKAD)                           0970 03183000
*   R11PTR=WKSAVEE;                 /* RESTORE                       */ 03184000
         L     R11PTR,WKSAVEE(,R3WORKAD)                           0971 03185000
*   R14RET=WKRTSAV2;                /* RESTORE RETURN ADDRESS        */ 03186000
         L     R14RET,WKRTSAV2(,R3WORKAD)                          0972 03187000
*/* SHARESP: END FLOWCHART                                           */ 03188000
*                                                                  0973 03189000
*   END SHARESP;                    /* END OF SUBROUTINE             */ 03190000
@EL00008 DS    0H                                                  0973 03191000
@EF00008 DS    0H                                                  0973 03192000
@ER00008 BR    @14                                                 0973 03193000
*   RFY                                                            0974 03194000
*     R15RETCD UNRSTD;                                             0974 03195000
*   RFY                                                            0975 03196000
*     R7WORK UNRSTD;                                               0975 03197000
*   RFY                                                            0976 03198000
*     R8WORK UNRSTD;                                               0976 03199000
*   RFY                                                            0977 03200000
*     R10LOOPC UNRSTD;                                             0977 03201000
*   RFY                                                            0978 03202000
*     R2WORK UNRSTD;                                               0978 03203000
*   RFY                                                            0979 03204000
*     R11PTR UNRSTD;                                               0979 03205000
*   RFY                                                            0980 03206000
*     R14RET UNRSTD;                                               0980 03207000
*                                                                  0981 03208000
*   /*****************************************************************/ 03209000
*   /*                                                               */ 03210000
*   /* GETSPQE SUBROUTINE                                            */ 03211000
*   /*                                                               */ 03212000
*   /*****************************************************************/ 03213000
*                                                                  0981 03214000
*GETSPQE:                                                          0981 03215000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT      @Z30ENVB*/ 03216000
GETSPQE  DS    0H                                                  0982 03217000
*/* GETSPQE: CHART BEGIN FLOWCHART                                   */ 03218000
*/* FOOTING                                                        0982 03219000
*/* SUBROUTINE GETS SPQE STORAGE                                     */ 03220000
*/********************************************************************/ 03221000
*/*                                                                  */ 03222000
*/*    SUBROUTINE GETS STORAGE FOR ONE SPQE                          */ 03223000
*/*                                                                  */ 03224000
*/*    SUBROUTINES CALLED: NONE                                      */ 03225000
*/*                                                                  */ 03226000
*/*    CALLED BY: SHARESP, SHARESWA                                  */ 03227000
*/*                                                                  */ 03228000
*/*    SYSTEM MACROS ISSUED: GETMAIN                                 */ 03229000
*/*                                                                  */ 03230000
*/*    RETURN CODES: X00NOERR, ABEND92A                              */ 03231000
*/*                                                                  */ 03232000
*/*    REGISTER USAGE: R1AREA - ADDR OF SPQE OBTAINED                */ 03233000
*/*                    R7ASCB - ASCB ADDR                            */ 03234000
*/*                    R2WORK - SAVE RETURN ADDR                     */ 03235000
*/*                    R8WORK - SAVE REGISTER 0 FOR GETMAIN          */ 03236000
*/*                             INTERFACE                            */ 03237000
*/*                    R11WORK - SAVE REGISTER 7 FOR GETMAIN         */ 03238000
*/*                              INTERFACE                           */ 03239000
*/*                                                                  */ 03240000
*/*    LEVEL - 3                                                     */ 03241000
*/*                                                                  */ 03242000
*/*    NOTES - GETMAIN MACRO DESTROYS REGISTERS 0,1,14,15.           */ 03243000
*/*                                                                  */ 03244000
*/********************************************************************/ 03245000
*/* E ENTER GETSPQE                                                  */ 03246000
*                                                                  0982 03247000
*   RFY                                                            0982 03248000
*     R0WORK RSTD;                  /*                       @Z30ENVB*/ 03249000
*   RFY                                                            0983 03250000
*     R1AREA RSTD;                  /*                       @Z30ENVB*/ 03251000
*   RFY                                                            0984 03252000
*     R2WORK RSTD;                  /*                       @Z30ENVB*/ 03253000
*   RFY                                                            0985 03254000
*     R7ASCB RSTD;                  /*                       @Z30ENVB*/ 03255000
*   RFY                                                            0986 03256000
*     R8WORK RSTD;                  /*                       @Z30ENVB*/ 03257000
*   RFY                                                            0987 03258000
*     R11WORK RSTD;                 /*                       @Z30ENVB*/ 03259000
*   RFY                                                            0988 03260000
*     R14RET RSTD;                  /*                       @Z30ENVB*/ 03261000
*   RFY                                                            0989 03262000
*     R15RETCD RSTD;                /*                       @Z30ENVB*/ 03263000
*   R2WORK=R14RET;                  /* SAVE RETURN ADDR      @Z30ENVB*/ 03264000
         LR    R2WORK,R14RET                                       0990 03265000
*/* L GETMAIN: OBTAIN SPQE STORAGE                                   */ 03266000
*                                                                  0991 03267000
*   R11WORK=R7ASCB;                 /* SAVE REGISTER 7 ACROSS GETMAIN   03268000
*                                                            @Z30ENVB*/ 03269000
         LR    R11WORK,R7ASCB                                      0991 03270000
*   R8WORK=R0WORK;                  /* SAVE REGISTER 0 ACROSS GETMAIN   03271000
*                                                            @Z30ENVB*/ 03272000
         LR    R8WORK,R0WORK                                       0992 03273000
*   R7ASCB=PSAAOLD;                 /* ASCB ADDR, FOR GETMAIN      0993 03274000
*                                                            @Z30ENVB*/ 03275000
         L     R7ASCB,PSAAOLD                                      0993 03276000
*   GENERATE REFS(R4CURTCB,R7ASCB,CVTCBBR);                        0994 03277000
       SPACE                                                            03278000
       GETMAIN P,SP=SP255EQU,BRANCH=YES                      @Z30ENVB   03279000
       SPACE                                                            03280000
*   R0WORK=R8WORK;                  /* RESTORE REGISTER 0    @Z30ENVB*/ 03281000
         LR    R0WORK,R8WORK                                       0995 03282000
*   R7ASCB=R11WORK;                 /* RESTORE REGISTER 7    @Z30ENVB*/ 03283000
         LR    R7ASCB,R11WORK                                      0996 03284000
*   RFY                                                            0997 03285000
*     R11WORK UNRSTD;               /*                       @Z30ENVB*/ 03286000
*   RFY                                                            0998 03287000
*     R8WORK UNRSTD;                /*                       @Z30ENVB*/ 03288000
*/* D (YES,AT001780,NO,) WAS STORAGE OBTAINED ?                      */ 03289000
*                                                                  0999 03290000
*   IF R15RETCDÂ¬=X00NOERR THEN      /*                       @Z30ENVB*/ 03291000
         LTR   R15RETCD,R15RETCD                                   0999 03292000
         BZ    @RF00999                                            0999 03293000
*     DO;                           /* DO000120: NO STORAGE  @Z30ENVB*/ 03294000
*/* P (,AT001780) INDICATE ABEND CODE 92A                            */ 03295000
*                                                                  1001 03296000
*       WKREASON=RCODE4;            /* SET REASON CODE       @Z30ENVB*/ 03297000
         MVI   WKREASON(R12SVRB),X'04'                             1001 03298000
*       R15RETCD=ABEND92A;          /* ERROR CODE            @Z30ENVB*/ 03299000
         LA    R15RETCD,2346                                       1002 03300000
*     END;                          /* END00120              @Z30ENVB*/ 03301000
*/* AT001780: R RETURN TO CALLING POINT                              */ 03302000
*                                                                  1004 03303000
*AT001780:                                                         1004 03304000
*   R14RET=R2WORK;                  /* RESTORE RETURN ADDR   @Z30ENVB*/ 03305000
@RF00999 DS    0H                                                  1004 03306000
AT001780 LR    R14RET,R2WORK                                       1004 03307000
*/* GETSPQE: END FLOWCHART                                           */ 03308000
*                                                                  1005 03309000
*   END GETSPQE;                    /* END OF SUBROUTINE     @Z30ENVB*/ 03310000
@EL00009 DS    0H                                                  1005 03311000
@EF00009 DS    0H                                                  1005 03312000
@ER00009 BR    @14                                                 1005 03313000
*   RFY                                                            1006 03314000
*     R0WORK UNRSTD;                /*                       @Z30ENVB*/ 03315000
*   RFY                                                            1007 03316000
*     R1AREA UNRSTD;                /*                       @Z30ENVB*/ 03317000
*   RFY                                                            1008 03318000
*     R2WORK UNRSTD;                /*                       @Z30ENVB*/ 03319000
*   RFY                                                            1009 03320000
*     R7ASCB UNRSTD;                /*                       @Z30ENVB*/ 03321000
*   RFY                                                            1010 03322000
*     R14RET UNRSTD;                /*                       @Z30ENVB*/ 03323000
*   RFY                                                            1011 03324000
*     R15RETCD UNRSTD;              /*                       @Z30ENVB*/ 03325000
*                                                                  1012 03326000
*   /*****************************************************************/ 03327000
*   /*                                                               */ 03328000
*   /* GIVESP SUBROUTINE                                             */ 03329000
*   /*                                                               */ 03330000
*   /*****************************************************************/ 03331000
*                                                                  1012 03332000
*GIVESP:                                                           1012 03333000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 03334000
GIVESP   DS    0H                                                  1013 03335000
*/* GIVESP: CHART  BEGIN FLOWCHART                                   */ 03336000
*/* FOOTING                                                        1013 03337000
*/* SUBROUTINE PROCESSES ONE GIVE SUBPOOL REQUEST                    */ 03338000
*/********************************************************************/ 03339000
*/*                                                                  */ 03340000
*/*    SUBROUTINE GIVESP PROCESSES A SINGLE GIVE SUBPOOL REQUEST,    */ 03341000
*/*    0 < ID <= 127                                                 */ 03342000
*/*                                                                  */ 03343000
*/*    SUBROUTINES CALLED: SPQESRCH                                  */ 03344000
*/*                                                                  */ 03345000
*/*    RETURN CODES SET: X00NOERR, ABEND12A, ABEND22A                */ 03346000
*/*                                                                  */ 03347000
*/*    REGISTER USAGE: R0WORK - INPUT SUBPOOL ID                     */ 03348000
*/*                                                                  */ 03349000
*/*    NOTES: THIS IS A SECOND LEVEL SUBROUTINE, CALLED BY SPCONTRL. */ 03350000
*/*                                                                  */ 03351000
*/********************************************************************/ 03352000
*/* E ENTER GIVESP                                                   */ 03353000
*                                                                  1013 03354000
*   RFY                                                            1013 03355000
*     R0WORK RSTD;                                                 1013 03356000
*   RFY                                                            1014 03357000
*     R2WORK RSTD;                                                 1014 03358000
*   RFY                                                            1015 03359000
*     R7WORK RSTD;                                                 1015 03360000
*   RFY                                                            1016 03361000
*     R8WORK RSTD;                                                 1016 03362000
*   RFY                                                            1017 03363000
*     R10LOOPC RSTD;                                               1017 03364000
*   RFY                                                            1018 03365000
*     R11PTR RSTD;                                                 1018 03366000
*   RFY                                                            1019 03367000
*     R14RET RSTD;                                                 1019 03368000
*   WKSAVEA=R2WORK;                 /* SAVE                          */ 03369000
         ST    R2WORK,WKSAVEA(,R3WORKAD)                           1020 03370000
*   WKSAVEB=R7WORK;                 /* SAVE                          */ 03371000
         ST    R7WORK,WKSAVEB(,R3WORKAD)                           1021 03372000
*   WKSAVEC=R8WORK;                 /* SAVE                          */ 03373000
         ST    R8WORK,WKSAVEC(,R3WORKAD)                           1022 03374000
*   WKSAVED=R10LOOPC;               /* SAVE                          */ 03375000
         ST    R10LOOPC,WKSAVED(,R3WORKAD)                         1023 03376000
*   WKSAVEE=R11PTR;                 /* SAVE                          */ 03377000
         ST    R11PTR,WKSAVEE(,R3WORKAD)                           1024 03378000
*   WKRTSAV2=R14RET;                /* SAVE RETURN ADDRESS           */ 03379000
         ST    R14RET,WKRTSAV2(,R3WORKAD)                          1025 03380000
*   RFY                                                            1026 03381000
*     R2WORK UNRSTD;                                               1026 03382000
*   RFY                                                            1027 03383000
*     R7WORK UNRSTD;                                               1027 03384000
*   RFY                                                            1028 03385000
*     R8WORK UNRSTD;                                               1028 03386000
*   RFY                                                            1029 03387000
*     R10LOOPC UNRSTD;                                             1029 03388000
*   RFY                                                            1030 03389000
*     R11PTR UNRSTD;                                               1030 03390000
*   RFY                                                            1031 03391000
*     R14RET UNRSTD;                                               1031 03392000
*                                                                  1031 03393000
*/* D (YES,%FL01920,NO,) IS SP ID = 0 ?                              */ 03394000
*                                                                  1032 03395000
*   IF R0WORKÂ¬=ZERO THEN                                           1032 03396000
         LTR   R0WORK,R0WORK                                       1032 03397000
         BZ    @RF01032                                            1032 03398000
*     DO;                           /* DO000069                      */ 03399000
*/* D (NO,%FL01900,YES,) IS SP ID > 127 ?                            */ 03400000
*                                                                  1034 03401000
*       IF R0WORK>SP127 THEN                                       1034 03402000
         CH    R0WORK,@CH02714                                     1034 03403000
         BNH   @RF01034                                            1034 03404000
*         DO;                       /* DO000070                      */ 03405000
*/* P (,AT001630) INDICATE ABEND CODE 22A                            */ 03406000
*                                                                  1036 03407000
*           RFY                                                    1036 03408000
*             R15RETCD RSTD;                                       1036 03409000
*           R15RETCD=ABEND22A;      /* INVALID ID                    */ 03410000
         LA    R15RETCD,554                                        1037 03411000
*           GOTO AT001630;          /* GO EXIT SUBROUTINE            */ 03412000
         B     AT001630                                            1038 03413000
*         END;                      /* END00070                      */ 03414000
*/* %FL01900: S SPQESRCH: SEARCH CURRENT TCB FOR SPQE HAVING THIS ID */ 03415000
*                                                                  1040 03416000
*       RFY                                                        1040 03417000
*         R1WORK RSTD;                                             1040 03418000
@RF01034 DS    0H                                                  1041 03419000
*       R1WORK=R4CURTCB;            /* ADDRESS OF CURRENT TCB        */ 03420000
         LR    R1WORK,R4CURTCB                                     1041 03421000
*       CALL SPQESRCH;              /* CHECK FOR EXISTING SPQE       */ 03422000
         BAL   @14,SPQESRCH                                        1042 03423000
*/* D (NO,%FL01920,YES,) FOUND ?                                     */ 03424000
*                                                                  1043 03425000
*       IF R15WORKÂ¬=ZERO THEN                                      1043 03426000
         LTR   R15WORK,R15WORK                                     1043 03427000
         BZ    @RF01043                                            1043 03428000
*         DO;                       /* DO000071                      */ 03429000
*/* D (NO,%FL01910,YES,) IS SPQE FLAGED OWNED-AND- SHARED ?          */ 03430000
*                                                                  1045 03431000
*           IF R15WORK->SPQEOWN='1'B THEN                          1045 03432000
         TM    SPQEOWN(R15WORK),B'00100000'                        1045 03433000
         BNO   @RF01045                                            1045 03434000
*             DO;                   /* DO000072                      */ 03435000
*/* P (,AT001630) INDICATE ABEND 12A                                 */ 03436000
*                                                                  1047 03437000
*               R15RETCD=ABEND12A;  /* INVALID GIVE-REQUEST          */ 03438000
         LA    R15RETCD,298                                        1047 03439000
*               GOTO AT001630;      /* GO EXIT SUBROUTINE            */ 03440000
         B     AT001630                                            1048 03441000
*             END;                  /* END00072                      */ 03442000
*/* %FL01910: P RECHAIN SPQE OFF NEW TCB'S TCBMSS QUEUE              */ 03443000
*                                                                  1050 03444000
*           /*********************************************************/ 03445000
*           /*                                                       */ 03446000
*           /* REMOVE SPQE FROM CURRENT TCB'S TCBMSS QUEUE, USING    */ 03447000
*           /* R1WORK AS SET BY SUBROUTINE SPQESRCH                  */ 03448000
*           /*                                                       */ 03449000
*           /*********************************************************/ 03450000
*                                                                  1050 03451000
*           R1WORK->BYTES123=R15WORK->SPQEPTR;/* UNCHAIN             */ 03452000
@RF01045 MVC   BYTES123(3,R1WORK),SPQEPTR+1(R15WORK)               1050 03453000
*           IF R15WORK->LASTSPQE='1'B THEN/* LAST SPQE ?             */ 03454000
         TM    LASTSPQE(R15WORK),B'01000000'                       1051 03455000
         BNO   @RF01051                                            1051 03456000
*             IF R1WORKÂ¬=ADDR(R4CURTCB->TCBMSS) THEN/* YES, MOTHER 1052 03457000
*                                      QUEUE EMPTY ?                 */ 03458000
         LA    @14,TCBMSS(,R4CURTCB)                               1052 03459000
         CR    R1WORK,@14                                          1052 03460000
         BE    @RF01052                                            1052 03461000
*               R1WORK->LASTSPQE='1'B;/* INSURE END-OF-QUEUE PROPERLY   03462000
*                                      FLAGGED                       */ 03463000
         OI    LASTSPQE(R1WORK),B'01000000'                        1053 03464000
*           RFY                                                    1054 03465000
*             R1WORK UNRSTD;                                       1054 03466000
*                                                                  1054 03467000
@RF01052 DS    0H                                                  1054 03468000
@RF01051 DS    0H                                                  1055 03469000
*           /*********************************************************/ 03470000
*           /*                                                       */ 03471000
*           /* RESET CHAIN FIELD TO CONTENTS OF NEW TCBMSSB, EITHER  */ 03472000
*           /* ZERO OR ADDRESS OF PRECEEDING SPQE ON QUEUE           */ 03473000
*           /*                                                       */ 03474000
*           /*********************************************************/ 03475000
*                                                                  1055 03476000
*           R15WORK->SPQEPTR=R5NEWTCB->TCBMSSB;/*            @YM05452*/ 03477000
*                                                                  1055 03478000
         SLR   @14,@14                                             1055 03479000
         ICM   @14,7,TCBMSSB(R5NEWTCB)                             1055 03480000
         ST    @14,SPQEPTR(,R15WORK)                               1055 03481000
*           /*********************************************************/ 03482000
*           /*                                                       */ 03483000
*           /* IF NEW TCB HAS AN SPQE ON ITS TCBMSS QUEUE, INSURE    */ 03484000
*           /* THAT THE END-OF-QUEUE BIT IS OFF IN THE SPQE BEING    */ 03485000
*           /* GIVEN.                                                */ 03486000
*           /*                                                       */ 03487000
*           /*********************************************************/ 03488000
*                                                                  1056 03489000
*           IF R5NEWTCB->TCBMSSBÂ¬=ZERO THEN                        1056 03490000
         LTR   @14,@14                                             1056 03491000
         BZ    @RF01056                                            1056 03492000
*             DO;                   /* DO000073                      */ 03493000
*               R15WORK->LASTSPQE='0'B;                            1058 03494000
         NI    LASTSPQE(R15WORK),B'10111111'                       1058 03495000
*             END;                  /* END00073                      */ 03496000
*                                                                  1059 03497000
*           /*********************************************************/ 03498000
*           /*                                                       */ 03499000
*           /* OTHERWISE, SET END-OF-QUEUE BIT ON IN SPQE BEING      */ 03500000
*           /* GIVEN.                                                */ 03501000
*           /*                                                       */ 03502000
*           /*********************************************************/ 03503000
*                                                                  1060 03504000
*           ELSE                                                   1060 03505000
*             R15WORK->LASTSPQE='1'B;                              1060 03506000
*                                                                  1060 03507000
         B     @RC01056                                            1060 03508000
@RF01056 OI    LASTSPQE(R15WORK),B'01000000'                       1060 03509000
*           /*********************************************************/ 03510000
*           /*                                                       */ 03511000
*           /* CHAIN SPQE BEING GIVEN OFF NEW TCB'S TCBMSS QUEUE     */ 03512000
*           /*                                                       */ 03513000
*           /*********************************************************/ 03514000
*                                                                  1061 03515000
*           R5NEWTCB->TCBMSSB=R15WORK;                             1061 03516000
*                                                                  1061 03517000
@RC01056 STCM  R15WORK,7,TCBMSSB(R5NEWTCB)                         1061 03518000
*/* THE SHARED-NOT-OWNED FLAG REMAINS ON IN THE GIVEN SPQE IF        */ 03519000
*/* IT WAS ON ORIGINALLY                                             */ 03520000
*                                                                  1062 03521000
*         END;                      /* END00071                      */ 03522000
*     END;                          /* END00069                      */ 03523000
@RF01043 DS    0H                                                  1064 03524000
*/* %FL01920: P SET RETURN CODE = 0                                  */ 03525000
*                                                                  1064 03526000
*   R15RETCD=X00NOERR;                                             1064 03527000
*                                                                  1064 03528000
@RF01032 SLR   R15RETCD,R15RETCD                                   1064 03529000
*/* AT001630: R RETURN TO CALLING POINT                              */ 03530000
*                                                                  1065 03531000
*   RFY                                                            1065 03532000
*     R14RET RSTD;                                                 1065 03533000
*   RFY                                                            1066 03534000
*     R2WORK RSTD;                                                 1066 03535000
*   RFY                                                            1067 03536000
*     R7WORK RSTD;                                                 1067 03537000
*   RFY                                                            1068 03538000
*     R8WORK RSTD;                                                 1068 03539000
*   RFY                                                            1069 03540000
*     R10LOOPC RSTD;                                               1069 03541000
*   RFY                                                            1070 03542000
*     R11PTR RSTD;                                                 1070 03543000
*AT001630:                                                         1071 03544000
*   R14RET=WKRTSAV2;                /* RESTORE RETURN ADDRESS        */ 03545000
AT001630 L     R14RET,WKRTSAV2(,R3WORKAD)                          1071 03546000
*   R2WORK=WKSAVEA;                 /* RESTORE                       */ 03547000
         L     R2WORK,WKSAVEA(,R3WORKAD)                           1072 03548000
*   R7WORK=WKSAVEB;                 /* RESTORE                       */ 03549000
         L     R7WORK,WKSAVEB(,R3WORKAD)                           1073 03550000
*   R8WORK=WKSAVEC;                 /* RESTORE                       */ 03551000
         L     R8WORK,WKSAVEC(,R3WORKAD)                           1074 03552000
*   R10LOOPC=WKSAVED;               /* RESTORE                       */ 03553000
         L     R10LOOPC,WKSAVED(,R3WORKAD)                         1075 03554000
*   R11PTR=WKSAVEE;                 /* RESTORE                       */ 03555000
         L     R11PTR,WKSAVEE(,R3WORKAD)                           1076 03556000
*/* GIVESP: END FLOWCHART                                            */ 03557000
*                                                                  1077 03558000
*   END GIVESP;                     /* END OF SUBROUTINE             */ 03559000
@EL00010 DS    0H                                                  1077 03560000
@EF00010 DS    0H                                                  1077 03561000
@ER00010 BR    @14                                                 1077 03562000
*   RFY                                                            1078 03563000
*     R0WORK UNRSTD;                                               1078 03564000
*   RFY                                                            1079 03565000
*     R2WORK UNRSTD;                                               1079 03566000
*   RFY                                                            1080 03567000
*     R7WORK UNRSTD;                                               1080 03568000
*   RFY                                                            1081 03569000
*     R8WORK UNRSTD;                                               1081 03570000
*   RFY                                                            1082 03571000
*     R10LOOPC UNRSTD;                                             1082 03572000
*   RFY                                                            1083 03573000
*     R11PTR UNRSTD;                                               1083 03574000
*   RFY                                                            1084 03575000
*     R14RET UNRSTD;                                               1084 03576000
*   RFY                                                            1085 03577000
*     R15RETCD UNRSTD;                                             1085 03578000
*                                                                  1086 03579000
*   /*****************************************************************/ 03580000
*   /*                                                               */ 03581000
*   /* SPQESRCH SUBROUTINE                                           */ 03582000
*   /*                                                               */ 03583000
*   /*****************************************************************/ 03584000
*                                                                  1086 03585000
*SPQESRCH:                                                         1086 03586000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 03587000
SPQESRCH DS    0H                                                  1087 03588000
*/* SPQESRCH: CHART  BEGIN FLOWCHART                                 */ 03589000
*/* FOOTING                                                        1087 03590000
*/* SEARCHES INPUT TCB FOR A PARTICULAR SPQE                         */ 03591000
*/********************************************************************/ 03592000
*/*                                                                  */ 03593000
*/*    SUBROUTINE SPQESRCH SEARCHES A SPECIFIED TCB'S TCBMSS QUEUE   */ 03594000
*/*    FOR AN SPQE HAVING A SPECIFIED SUBPOOL ID.                    */ 03595000
*/*                                                                  */ 03596000
*/*    SUBROUTINES CALLED: NONE                                      */ 03597000
*/*                                                                  */ 03598000
*/*    SYSTEM MACROS ISSUED: NONE                                    */ 03599000
*/*                                                                  */ 03600000
*/*    REGISTER USAGE: R0WORK - INPUT SUBPOOL ID                     */ 03601000
*/*                    R1WORK - INPUT TCB ADDRESS - OUTPUT, THE ADDR */ 03602000
*/*                             OF  THE PRECEEDING CHAINING FIELD,   */ 03603000
*/*                             EITHER TCBMSS OF THE SEARCH TCB, OR  */ 03604000
*/*                             SPQEPTR OF THE PRECEEDING SPQE, USED */ 03605000
*/*                             IN UNCHAINING THE SEARCH SPQE        */ 03606000
*/*                    R15WORK - OUTPUT, ADDRESS OF THE SPQE IF      */ 03607000
*/*                              FOUND, OTHERWISE ZERO               */ 03608000
*/*                                                                  */ 03609000
*/*    LEVEL - 3                                                     */ 03610000
*/*                                                                  */ 03611000
*/********************************************************************/ 03612000
*/* E ENTER SPQESRCH                                                 */ 03613000
*                                                                  1087 03614000
*   RFY                                                            1087 03615000
*     R0WORK RSTD;                                                 1087 03616000
*   RFY                                                            1088 03617000
*     R1WORK RSTD;                                                 1088 03618000
*   RFY                                                            1089 03619000
*     R14RET RSTD;                                                 1089 03620000
*   RFY                                                            1090 03621000
*     R15WORK RSTD;                                                1090 03622000
*                                                                  1090 03623000
*/* P GET QUEUE CHAINING FIELD ADDRESS (ADDRESS OF TCBMSS)           */ 03624000
*                                                                  1091 03625000
*   R1WORK=ADDR(R1WORK->TCBMSS);    /* MAINTAIN PRECEEDING CHAINING     03626000
*                                      FIELD ADDRESS                 */ 03627000
         LA    @08,TCBMSS(,R1WORK)                                 1091 03628000
         LR    R1WORK,@08                                          1091 03629000
*/* P GET SEARCH TCB'S TCBMSS POINTER (FIRST SPQE PTR)               */ 03630000
*                                                                  1092 03631000
*   R15WORK=R1WORK->BYTES123;       /* TOP OF QUEUE PTR              */ 03632000
         SLR   R15WORK,R15WORK                                     1092 03633000
         ICM   R15WORK,7,BYTES123(R1WORK)                          1092 03634000
*   DO WHILE(R15WORKÂ¬=ZERO);        /* DO000068: CHECK ALL SPQE'S ON    03635000
*                                      QUEUE                         */ 03636000
         B     @DE01093                                            1093 03637000
@DL01093 DS    0H                                                  1094 03638000
*/* %FL01880:  D (YES,AT001620,NO,) IS SPQE POINTER = 0 ?            */ 03639000
*/* D (YES,AT001620,NO,) DOES ADDRESSED SPQE HAVE CORRECT ID ?       */ 03640000
*                                                                  1094 03641000
*     IF R15WORK->SPQEID=R0WORK THEN                               1094 03642000
         SLR   @08,@08                                             1094 03643000
         IC    @08,SPQEID(,R15WORK)                                1094 03644000
         CR    R0WORK,@08                                          1094 03645000
         BE    @RT01094                                            1094 03646000
*       GOTO AT001620;              /* SPQE FOUND, RETURN ITS ADDR   */ 03647000
*/* P UPDATE QUEUE CHAINING FIELD ADDRESS (ADDRESS OF SPQEPTR)       */ 03648000
*                                                                  1096 03649000
*     R1WORK=ADDR(R15WORK->SPQEPTR);/* PRECEEDING CHAINING FIELD     */ 03650000
         LR    R1WORK,R15WORK                                      1096 03651000
*/* P (,%FL01880) GET NEXT SPQE PTR                                  */ 03652000
*                                                                  1097 03653000
*     R15WORK=R15WORK->SPQEPTR;     /* NEXT SPQE PTR                 */ 03654000
         L     R15WORK,SPQEPTR(,R15WORK)                           1097 03655000
*   END;                            /* END00068                      */ 03656000
*                                                                  1098 03657000
@DE01093 LTR   R15WORK,R15WORK                                     1098 03658000
         BNZ   @DL01093                                            1098 03659000
*   /*****************************************************************/ 03660000
*   /*                                                               */ 03661000
*   /* FALL THROUGH LOOP MEANS SPQE NOT ON QUEUE. R15WORK WILL BE 0. */ 03662000
*   /* RETURN SPQE PTR TO CALLER - ZERO OR ADDR CORRECT SPQE. RETURN */ 03663000
*   /* ADDR OF FIELD FROM WHICH THIS SPQE CHAINED, IF ANY.           */ 03664000
*   /*                                                               */ 03665000
*   /*****************************************************************/ 03666000
*                                                                  1099 03667000
*/* AT001620: R RETURN TO CALLING POINT                              */ 03668000
*                                                                  1099 03669000
*AT001620:                                                         1099 03670000
*   END SPQESRCH;                   /* END OF SUBROUTINE             */ 03671000
@EL00011 DS    0H                                                  1099 03672000
@EF00011 DS    0H                                                  1099 03673000
@ER00011 BR    @14                                                 1099 03674000
*   RFY                                                            1100 03675000
*     R0WORK UNRSTD;                                               1100 03676000
*   RFY                                                            1101 03677000
*     R1WORK UNRSTD;                                               1101 03678000
*   RFY                                                            1102 03679000
*     R14RET UNRSTD;                                               1102 03680000
*   RFY                                                            1103 03681000
*     R15WORK UNRSTD;                                              1103 03682000
*                                                                  1103 03683000
*/* SPQESRCH: END FLOWCHART                                          */ 03684000
*                                                                  1104 03685000
*                                                                  1104 03686000
*   /*****************************************************************/ 03687000
*   /*                                                               */ 03688000
*   /* SWARTN SUBROUTINE                                             */ 03689000
*   /*                                                               */ 03690000
*   /*****************************************************************/ 03691000
*                                                                  1104 03692000
*SWARTN:                                                           1104 03693000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 03694000
SWARTN   DS    0H                                                  1105 03695000
*/* SWARTN: CHART  BEGIN FLOWCHART                                   */ 03696000
*/* FOOTING                                                        1105 03697000
*/* SUBROUTINE SHARES SP 236, 237                                    */ 03698000
*/********************************************************************/ 03699000
*/*                                                                  */ 03700000
*/*    SUBROUTINE SWARTN HANDLES SHARING OF SWA, SUBPOOLS 236 AND    */ 03701000
*/*    237. THE SPQE'S FOR THESE SUBPOOLS ARE QUEUED OFF TCBSWA,     */ 03702000
*/*    WHEREAS THE OTHER SPQE'S ARE CHAINED OFF TCBMSS.              */ 03703000
*/*                                                                  */ 03704000
*/*    SUBROUTINES CALLED: SHARESWA, MOVELIST                        */ 03705000
*/*                                                                  */ 03706000
*/*    SYSTEM MACROS INVOKED: NONE                                   */ 03707000
*/*                                                                  */ 03708000
*/*    RETURN CODES: X00NOERR, ABEND82A, ABEND92A (RETURN CODE       */ 03709000
*/*                  FROM SUBROUTINE SHARESWA)                       */ 03710000
*/*                                                                  */ 03711000
*/*    REGISTER USAGE: NORMAL                                        */ 03712000
*/*                                                                  */ 03713000
*/*    LEVEL - 1                                                     */ 03714000
*/*                                                                  */ 03715000
*/********************************************************************/ 03716000
*/* E ENTER SWARTN                                                   */ 03717000
*                                                                  1105 03718000
*   RFY                                                            1105 03719000
*     R14RET RSTD;                                                 1105 03720000
*   WKRTSAVE=R14RET;                /* SAVE RETURN ADDRESS AROUND  1106 03721000
*                                      SUBROUTINE CALLS.             */ 03722000
         ST    R14RET,WKRTSAVE(,R3WORKAD)                          1106 03723000
*   RFY                                                            1107 03724000
*     R14RET UNRSTD;                                               1107 03725000
*   RFY                                                            1108 03726000
*     R15RETCD RSTD;                /*                       @Z30ENVB*/ 03727000
*/* D (NO,AT001490,YES,) WAS NSHSPV OR NSHSPL SPECIFIED ?            */ 03728000
*                                                                  1109 03729000
*   IF ATTNSHLVÂ¬=ZERO THEN                                         1109 03730000
         L     @14,ATTNSHLV(,R3WORKAD)                             1109 03731000
         LTR   @14,@14                                             1109 03732000
         BZ    @RF01109                                            1109 03733000
*     DO;                           /* DO000043: PROCESS 'DON'T    1110 03734000
*                                      SHARE' REQUEST                */ 03735000
*/* D (NO,%FL01540,YES,) WAS NSHSPV SPECIFIED ?                      */ 03736000
*                                                                  1111 03737000
*       IF ATNSHRSP='0'B THEN                                      1111 03738000
         TM    ATNSHRSP(R3WORKAD),B'10000000'                      1111 03739000
         BNZ   @RF01111                                            1111 03740000
*         DO;                       /* DO000044: PROCESS VALUE     1112 03741000
*                                      PARAMETER                     */ 03742000
*/* D (YES,%FL01550,NO,AT001460) IS SPECIFIED VALUE VALID ?          */ 03743000
*/*    ONLY SUBPOOLS 236 AND 237 MAY BE SPECIFIED FOR 'DON'T SHARE'  */ 03744000
*                                                                  1113 03745000
*           RFY                                                    1113 03746000
*             R1WORK RSTD;                                         1113 03747000
*           R1WORK=SP237;           /* FIRST POSSIBLE SHARE ID       */ 03748000
         LA    @08,237                                             1114 03749000
         LR    R1WORK,@08                                          1114 03750000
*           IF ATTNSHLVÂ¬=SP236 THEN /* 236 ?                         */ 03751000
         LA    @07,236                                             1115 03752000
         CR    @14,@07                                             1115 03753000
         BE    @RF01115                                            1115 03754000
*             DO;                   /* DO000046                      */ 03755000
*               R1WORK=SP236;       /* OTHER POSSIBLE SHARE ID       */ 03756000
         LR    R1WORK,@07                                          1117 03757000
*               IF ATTNSHLVÂ¬=SP237 THEN/* 237 ?                      */ 03758000
         CR    @14,@08                                             1118 03759000
         BNE   @RT01118                                            1118 03760000
*                 GOTO AT001460;    /* GO SET ABEND CODE             */ 03761000
*             END;                  /* END00046                      */ 03762000
*/* %FL01550: S  SHARESWA: SHARE THE OTHER SUBPOOL                   */ 03763000
*                                                                  1121 03764000
*           CALL SHARESWA;          /* SHARE 236 OR 237, WHICH- EVER    03765000
*                                      NOT SPECIFIED                 */ 03766000
@RF01115 BAL   @14,SHARESWA                                        1121 03767000
*/* D (YES,AT001480,NO,AT001450) ANY ERRORS ?                        */ 03768000
*                                                                  1122 03769000
*           IF R15RETCDÂ¬=X00NOERR THEN/*                     @Z30ENVB*/ 03770000
         LTR   R15RETCD,R15RETCD                                   1122 03771000
         BNZ   @RT01122                                            1122 03772000
*             GO TO AT001480;       /* GO EXIT SUBROUTINE    @Z30ENVB*/ 03773000
*         END;                      /* END00044: END VALUE PARM    1124 03774000
*                                      PROCESSING                    */ 03775000
*       ELSE                        /* OTHERWISE, PROCESS LIST       */ 03776000
*         DO;                       /* DO000045: PROCESS LIST      1125 03777000
*                                      PARAMETER                     */ 03778000
         B     @RC01111                                            1125 03779000
@RF01111 DS    0H                                                  1126 03780000
*/* %FL01540: S MOVELIST: GET LENGTH OF LIST                         */ 03781000
*                                                                  1126 03782000
*           RFY                                                    1126 03783000
*             R0WORK RSTD;                                         1126 03784000
*           RFY                                                    1127 03785000
*             R7WORK RSTD;                                         1127 03786000
*           RFY                                                    1128 03787000
*             R8WORK RSTD;                                         1128 03788000
*           R0WORK=ONE;             /* MOVE ONE BYTE                 */ 03789000
         LA    R0WORK,1                                            1129 03790000
*           R8WORK=ADDR(WKTEMP1);   /* SUBLIST (MOVE-TO) ADDRESS     */ 03791000
         LA    R8WORK,WKTEMP1(,R3WORKAD)                           1130 03792000
*           R7WORK=ATTNSHLV;        /* ADDRESS OF LIST (MOVE-FROM)   */ 03793000
         L     R7WORK,ATTNSHLV(,R3WORKAD)                          1131 03794000
*           CALL MOVELIST;          /* FIRST BYTE OF LIST IS LENGTH     03795000
*                                      OF REMAINDER OF LIST          */ 03796000
         BAL   @14,MOVELIST                                        1132 03797000
*/* D (YES,AT001490,NO,) IS LENGTH = 0 ?                             */ 03798000
*                                                                  1133 03799000
*           R0WORK=R8WORK->ZBYTE;   /* LENGTH OF LIST                */ 03800000
         SLR   R0WORK,R0WORK                                       1133 03801000
         IC    R0WORK,ZBYTE(,R8WORK)                               1133 03802000
*           IF R0WORK=ZERO THEN     /* IF NO ENTRIES                 */ 03803000
         LTR   R0WORK,R0WORK                                       1134 03804000
         BZ    @RT01134                                            1134 03805000
*             GOTO AT001490;        /* NO ENTRIES, SHARE BOTH 236,237*/ 03806000
*/* D (NO,%FL01570,YES,) IS LIST LENGTH > MAX SUBLIST LENGTH ?       */ 03807000
*                                                                  1136 03808000
*           IF R0WORK>LENGTH(WKTEMPS) THEN                         1136 03809000
*                                                                  1136 03810000
         LA    @14,32                                              1136 03811000
         CR    R0WORK,@14                                          1136 03812000
         BNH   @RF01136                                            1136 03813000
*/* P MOVE LENGTH = MAX                                              */ 03814000
*                                                                  1137 03815000
*             R0WORK=LENGTH(WKTEMPS);/* RESET TO MAX LENGTH          */ 03816000
         LR    R0WORK,@14                                          1137 03817000
*/* %FL01570: S MOVELIST: MOVE LIST INTO WORKAREA                    */ 03818000
*/* LIST LENGTH SHOULD NEVER EXCEED 2. IN ANY CASE, NO MORE THAN THE */ 03819000
*/* NUMBER OF ENTRIES THAT WILL FIT INTO THE MAX LENGTH SUBLIST ARE  */ 03820000
*/* PROCESSED.                                                       */ 03821000
*                                                                  1138 03822000
*           R7WORK=R7WORK+ONE;      /* ADDR OF FIRST ENTRY           */ 03823000
@RF01136 AH    R7WORK,@CH00061                                     1138 03824000
*           CALL MOVELIST;          /* MOVE ENTRIES TO BE CHECKED    */ 03825000
         BAL   @14,MOVELIST                                        1139 03826000
*/* D (NO,AT001460,YES,) ARE ALL LIST ENTRIES VALID ?                */ 03827000
*                                                                  1140 03828000
*           WKSWASWS=ZERO;          /* CLEAR FLAGS                   */ 03829000
         MVI   WKSWASWS(R3WORKAD),X'00'                            1140 03830000
*           DO R0WORK=R0WORK TO 1 BY-1;/* DO000047: CHECK ENTIRE   1141 03831000
*                                      SUBLIST                       */ 03832000
         B     @DE01141                                            1141 03833000
@DL01141 DS    0H                                                  1142 03834000
*             IF R8WORK->ZBYTE=SP236 THEN/* 236 ?                    */ 03835000
         CLI   ZBYTE(R8WORK),236                                   1142 03836000
         BNE   @RF01142                                            1142 03837000
*               WK236SW='1'B;       /* SET INDICATOR                 */ 03838000
         OI    WK236SW(R3WORKAD),B'10000000'                       1143 03839000
*             ELSE                  /* NOT 236                       */ 03840000
*               IF R8WORK->ZBYTE=SP237 THEN/* 237 ?                  */ 03841000
         B     @RC01142                                            1144 03842000
@RF01142 CLI   ZBYTE(R8WORK),237                                   1144 03843000
         BNE   @RF01144                                            1144 03844000
*                 WK237SW='1'B;     /* SET INDICATOR                 */ 03845000
         OI    WK237SW(R3WORKAD),B'01000000'                       1145 03846000
*               ELSE                /* NEITHER 236 NOR 237           */ 03847000
*                 GOTO AT001460;    /* GO SET ABEND CODE             */ 03848000
*             R8WORK=R8WORK+ONE;    /* NEXT ENTRY ADDR               */ 03849000
@RC01142 AH    R8WORK,@CH00061                                     1147 03850000
*           END;                    /* END00047: END SUBLIST CHECK   */ 03851000
         BCTR  R0WORK,0                                            1148 03852000
@DE01141 LTR   R0WORK,R0WORK                                       1148 03853000
         BP    @DL01141                                            1148 03854000
*/* D (YES,AT001470,NO,) IS ID 236 IN LIST ?                         */ 03855000
*                                                                  1149 03856000
*           IF WK236SW='0'B THEN                                   1149 03857000
*                                                                  1149 03858000
         TM    WK236SW(R3WORKAD),B'10000000'                       1149 03859000
         BNZ   @RF01149                                            1149 03860000
*/* S SHARESWA: SHARE SUBPOOL 236                                    */ 03861000
*                                                                  1150 03862000
*             DO;                   /* DO000048                      */ 03863000
*               R1WORK=SP236;       /* SWA ID                        */ 03864000
         LA    R1WORK,236                                          1151 03865000
*               CALL SHARESWA;      /* SHARE 236                     */ 03866000
         BAL   @14,SHARESWA                                        1152 03867000
*/* D (YES,AT001480,NO,) ANY ERRORS ?                                */ 03868000
*                                                                  1153 03869000
*               IF R15RETCDÂ¬=X00NOERR THEN/*                 @Z30ENVB*/ 03870000
         LTR   R15RETCD,R15RETCD                                   1153 03871000
         BNZ   @RT01153                                            1153 03872000
*                 GO TO AT001480;   /* GO EXIT SUBROUTINE    @Z30ENVB*/ 03873000
*             END;                  /* END00048: END 236 CHECK       */ 03874000
*           RFY                                                    1156 03875000
*             R7WORK UNRSTD;                                       1156 03876000
*                                                                  1156 03877000
@RF01149 DS    0H                                                  1157 03878000
*/* AT001470: D (YES,AT001450,NO,) IS SP ID 237 IN LIST ?            */ 03879000
*                                                                  1157 03880000
*AT001470:                                                         1157 03881000
*           IF WK237SW='0'B THEN                                   1157 03882000
*                                                                  1157 03883000
AT001470 TM    WK237SW(R3WORKAD),B'01000000'                       1157 03884000
         BNZ   @RF01157                                            1157 03885000
*/* S SHARESWA: SHARE SUBPOOL 237                                    */ 03886000
*                                                                  1158 03887000
*             DO;                   /* DO000049                      */ 03888000
*               R1WORK=SP237;       /* CALL IS FOR SP 237            */ 03889000
         LA    R1WORK,237                                          1159 03890000
*               CALL SHARESWA;      /* SHARE SUBPOOL                 */ 03891000
         BAL   @14,SHARESWA                                        1160 03892000
*/* D (YES,AT001480,NO,AT001450) ANY ERRORS ?                        */ 03893000
*                                                                  1161 03894000
*               IF R15RETCDÂ¬=X00NOERR THEN/*                 @Z30ENVB*/ 03895000
         LTR   R15RETCD,R15RETCD                                   1161 03896000
         BNZ   @RT01161                                            1161 03897000
*                 GO TO AT001480;   /* GO EXIT SUBROUTINE    @Z30ENVB*/ 03898000
*             END;                  /* END00049: END 237 CHECK       */ 03899000
*           RFY                                                    1164 03900000
*             R0WORK UNRSTD;                                       1164 03901000
@RF01157 DS    0H                                                  1165 03902000
*           RFY                                                    1165 03903000
*             R8WORK UNRSTD;                                       1165 03904000
*         END;                      /* END00045: END LIST PROCESSING */ 03905000
*     END;                          /* END00043: END 'DON'T SHARE' 1167 03906000
*                                      SWA PROCESS                   */ 03907000
*                                                                  1167 03908000
*   /*****************************************************************/ 03909000
*   /*                                                               */ 03910000
*   /* NEITHER NSHSPV NOR NSHSPL SPECIFIED, HENCE BOTH SUBPOOLS 236  */ 03911000
*   /* AND 237 ARE TO BE SHARED AUTOMATICALLY.                       */ 03912000
*   /*                                                               */ 03913000
*   /*****************************************************************/ 03914000
*                                                                  1168 03915000
*   ELSE                                                           1168 03916000
*AT001490:                                                         1168 03917000
*     DO;                           /* DO000050: SHARE BOTH 236 AND     03918000
*                                      237                           */ 03919000
         B     @RC01109                                            1168 03920000
@RF01109 DS    0H                                                  1168 03921000
AT001490 DS    0H                                                  1169 03922000
*/* AT001490: S SHARESWA: SHARE SP 236                               */ 03923000
*                                                                  1169 03924000
*       R1WORK=SP236;               /* CALL IS FOR SP 236            */ 03925000
         LA    R1WORK,236                                          1169 03926000
*       CALL SHARESWA;              /* SHARE SUBPOOL                 */ 03927000
         BAL   @14,SHARESWA                                        1170 03928000
*/* D (YES,AT001480,NO,) ANY ERRORS ?                                */ 03929000
*                                                                  1171 03930000
*       IF R15RETCDÂ¬=X00NOERR THEN  /*                       @Z30ENVB*/ 03931000
         LTR   R15RETCD,R15RETCD                                   1171 03932000
         BNZ   @RT01171                                            1171 03933000
*         GO TO AT001480;           /* GO EXIT SUBROUTINE    @Z30ENVB*/ 03934000
*/* S SHARESWA: SHARE SP 237                                         */ 03935000
*                                                                  1173 03936000
*       R1WORK=SP237;               /* CALL IS FOR SP 237            */ 03937000
         LA    R1WORK,237                                          1173 03938000
*       CALL SHARESWA;              /* SHARE SUBPOOL                 */ 03939000
         BAL   @14,SHARESWA                                        1174 03940000
*/* D (YES,AT001480,NO,) ANY ERRORS ?                                */ 03941000
*                                                                  1175 03942000
*       IF R15RETCDÂ¬=X00NOERR THEN  /*                       @Z30ENVB*/ 03943000
         LTR   R15RETCD,R15RETCD                                   1175 03944000
         BNZ   @RT01175                                            1175 03945000
*         GO TO AT001480;           /* GO EXIT SUBROUTINE    @Z30ENVB*/ 03946000
*     END;                          /* END00050: END 'AUTOMATIC'   1177 03947000
*                                      SHARE OF BOTH                 */ 03948000
*/* AT001450: P SET RETURN CODE 0                                    */ 03949000
*                                                                  1178 03950000
*   RFY                                                            1178 03951000
*     R15RETCD RSTD;                                               1178 03952000
@RC01109 DS    0H                                                  1179 03953000
*AT001450:                                                         1179 03954000
*   R15RETCD=X00NOERR;              /* SET RETURN CODE 0             */ 03955000
AT001450 SLR   R15RETCD,R15RETCD                                   1179 03956000
*/* AT001480: R RETURN TO CALLING POINT                              */ 03957000
*                                                                  1180 03958000
*   RFY                                                            1180 03959000
*     R14RET RSTD;                                                 1180 03960000
*AT001480:                                                         1181 03961000
*   R14RET=WKRTSAVE;                /* RETURN ADDRESS                */ 03962000
AT001480 L     R14RET,WKRTSAVE(,R3WORKAD)                          1181 03963000
*   RETURN;                         /* RETURN TO MAINLINE CALLING PT */ 03964000
@EL00012 DS    0H                                                  1182 03965000
@EF00012 DS    0H                                                  1182 03966000
@ER00012 BR    @14                                                 1182 03967000
*/* AT001460: P (,AT001480) INDICATE ABEND CODE 82A                  */ 03968000
*                                                                  1183 03969000
*AT001460:                                                         1183 03970000
*   R15RETCD=ABEND82A;              /* ABEND CODE, INVALID SWA SP ID */ 03971000
AT001460 LA    R15RETCD,2090                                       1183 03972000
*   GOTO AT001480;                  /* GO TO EXIT SUBROUTINE         */ 03973000
         B     AT001480                                            1184 03974000
*/* SWARTN: END FLOWCHART                                            */ 03975000
*                                                                  1185 03976000
*   END SWARTN;                     /* END SUBROUTINE                */ 03977000
*   RFY                                                            1186 03978000
*     R14RET UNRSTD;                                               1186 03979000
*   RFY                                                            1187 03980000
*     R15RETCD UNRSTD;                                             1187 03981000
*   RFY                                                            1188 03982000
*     R1WORK UNRSTD;                                               1188 03983000
*                                                                  1189 03984000
*   /*****************************************************************/ 03985000
*   /*                                                               */ 03986000
*   /* SHARESWA SUBROUTINE                                           */ 03987000
*   /*                                                               */ 03988000
*   /*****************************************************************/ 03989000
*                                                                  1189 03990000
*SHARESWA:                                                         1189 03991000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 03992000
SHARESWA DS    0H                                                  1190 03993000
*/* SHARESWA: CHART BEGIN FLOWCHART                                  */ 03994000
*/* FOOTING                                                        1190 03995000
*/* SUBROUTINE SHARES ONE SWA SUBPOOL                                */ 03996000
*/********************************************************************/ 03997000
*/*                                                                  */ 03998000
*/*    SUBROUTINE SHARESWA WILL SHARE SUBPOOL 236 OR 237, WHICHEVER  */ 03999000
*/*    IS SPECIFIED, IF AND ONLY IF THE SPECIFIED SUBPOOL ALREADY    */ 04000000
*/*    EXISTS FOR THE ATTACHING TASK TCB.                            */ 04001000
*/*                                                                  */ 04002000
*/*    SUBROUTINES CALLED: GETSPQE                                   */ 04003000
*/*                                                                  */ 04004000
*/*    SYSTEM MACROS ISSUED: NONE                                    */ 04005000
*/*                                                                  */ 04006000
*/*    RETURN CODES SET: NONE (RETURN CODES RETURNED FROM            */ 04007000
*/*                      SUBROUTINE GETSPQE)                         */ 04008000
*/*                                                                  */ 04009000
*/*    REGISTER USAGE: R1WORK CONTAINS THE SP ID UPON ENTRY          */ 04010000
*/*                                                                  */ 04011000
*/********************************************************************/ 04012000
*/* E ENTER SHARESWA                                                 */ 04013000
*                                                                  1190 04014000
*   RFY                                                            1190 04015000
*     R0WORK RSTD;                                                 1190 04016000
*   RFY                                                            1191 04017000
*     R1WORK RSTD;                                                 1191 04018000
*   RFY                                                            1192 04019000
*     R14RET RSTD;                                                 1192 04020000
*                                                                  1192 04021000
*/* P SAVE REGISTERS                                                 */ 04022000
*                                                                  1193 04023000
*   RFY                                                            1193 04024000
*     R7WORK RSTD;                                                 1193 04025000
*   RFY                                                            1194 04026000
*     R8WORK RSTD;                                                 1194 04027000
*   RFY                                                            1195 04028000
*     R10WORK RSTD;                                                1195 04029000
*   RFY                                                            1196 04030000
*     R11WORK RSTD;                                                1196 04031000
*   RFY                                                            1197 04032000
*     R15RETCD RSTD;                /*                       @Z30ENVB*/ 04033000
*   WKSAVEA=R7WORK;                                                1198 04034000
         ST    R7WORK,WKSAVEA(,R3WORKAD)                           1198 04035000
*   WKSAVEB=R8WORK;                                                1199 04036000
         ST    R8WORK,WKSAVEB(,R3WORKAD)                           1199 04037000
*   WKSAVEC=R10WORK;                                               1200 04038000
         ST    R10WORK,WKSAVEC(,R3WORKAD)                          1200 04039000
*   WKSAVED=R11WORK;                                               1201 04040000
         ST    R11WORK,WKSAVED(,R3WORKAD)                          1201 04041000
*   WKSAVEE=R1WORK;                 /*                       @Z30ENVB*/ 04042000
         ST    R1WORK,WKSAVEE(,R3WORKAD)                           1202 04043000
*   R15RETCD=R15RETCD-R15RETCD;     /* CLEAR RETURN CODE     @Z30ENVB*/ 04044000
         SLR   R15RETCD,R15RETCD                                   1203 04045000
*   RFY                                                            1204 04046000
*     R7WORK UNRSTD;                                               1204 04047000
*   RFY                                                            1205 04048000
*     R8WORK UNRSTD;                                               1205 04049000
*   RFY                                                            1206 04050000
*     R10WORK UNRSTD;                                              1206 04051000
*   RFY                                                            1207 04052000
*     R11WORK UNRSTD;                                              1207 04053000
*                                                                  1207 04054000
*/* M GET QUEUE PTR (TCBSWA)                                         */ 04055000
*                                                                  1208 04056000
*   RFY                                                            1208 04057000
*     R7WORK RSTD;                                                 1208 04058000
*   R7WORK=R4CURTCB->TCBSWA;        /* PTR TO FIRST SWA SPQE         */ 04059000
         L     R7WORK,TCBSWA(,R4CURTCB)                            1209 04060000
*   DO WHILE(R7WORKÂ¬=ZERO);         /* DO000051: CHECK ALL SPQE'S ON    04061000
*                                      QUEUE                         */ 04062000
         B     @DE01210                                            1210 04063000
@DL01210 DS    0H                                                  1211 04064000
*/* %FL01580: D (YES,AT001500,NO,) IS THIS SPQE PTR = 0 ?            */ 04065000
*/* D (YES,AT001510,NO,) IS SPQEID = INPUT ID ?                      */ 04066000
*                                                                  1211 04067000
*     IF R7WORK->SPQEID=R1WORK THEN                                1211 04068000
         SLR   @08,@08                                             1211 04069000
         IC    @08,SPQEID(,R7WORK)                                 1211 04070000
         CR    R1WORK,@08                                          1211 04071000
         BE    @RT01211                                            1211 04072000
*       GOTO AT001510;              /* GO SHARE SUBPOOL              */ 04073000
*/* P (,%FL01580) GET NEXT SPQE PTR (SPQEPTR)                        */ 04074000
*                                                                  1213 04075000
*     R7WORK=R7WORK->SPQEPTR;       /* NEXT SWA SPQE PTR             */ 04076000
         L     R7WORK,SPQEPTR(,R7WORK)                             1213 04077000
*   END;                            /* END00051: END CHECK OF QUEUE  */ 04078000
*                                                                  1214 04079000
@DE01210 LTR   R7WORK,R7WORK                                       1214 04080000
         BNZ   @DL01210                                            1214 04081000
*   /*****************************************************************/ 04082000
*   /*                                                               */ 04083000
*   /* FALL THROUGH LOOP MEANS SUBPOOL NOT FOUND, HENCE NOT SHARED   */ 04084000
*   /*                                                               */ 04085000
*   /*****************************************************************/ 04086000
*                                                                  1215 04087000
*/* AT001500: P RESTORE REGISTERS                                    */ 04088000
*                                                                  1215 04089000
*   RFY                                                            1215 04090000
*     R8WORK RSTD;                                                 1215 04091000
*   RFY                                                            1216 04092000
*     R10WORK RSTD;                                                1216 04093000
*   RFY                                                            1217 04094000
*     R11WORK RSTD;                                                1217 04095000
*AT001500:                                                         1218 04096000
*   R7WORK=WKSAVEA;                 /* EXIT CODE                     */ 04097000
AT001500 L     R7WORK,WKSAVEA(,R3WORKAD)                           1218 04098000
*   R8WORK=WKSAVEB;                                                1219 04099000
         L     R8WORK,WKSAVEB(,R3WORKAD)                           1219 04100000
*   R10WORK=WKSAVEC;                                               1220 04101000
         L     R10WORK,WKSAVEC(,R3WORKAD)                          1220 04102000
*   R11WORK=WKSAVED;                                               1221 04103000
         L     R11WORK,WKSAVED(,R3WORKAD)                          1221 04104000
*   RFY                                                            1222 04105000
*     R8WORK UNRSTD;                                               1222 04106000
*   RFY                                                            1223 04107000
*     R10WORK UNRSTD;                                              1223 04108000
*   RFY                                                            1224 04109000
*     R11WORK UNRSTD;                                              1224 04110000
*   RFY                                                            1225 04111000
*     R15RETCD UNRSTD;              /*                       @Z30ENVB*/ 04112000
*/* R RETURN TO CALLING POINT                                        */ 04113000
*                                                                  1226 04114000
*   RETURN;                         /* RETURN TO SUBROUTINE CALLER   */ 04115000
*                                                                  1226 04116000
@EL00013 DS    0H                                                  1226 04117000
@EF00013 DS    0H                                                  1226 04118000
@ER00013 BR    @14                                                 1226 04119000
*   /*****************************************************************/ 04120000
*   /*                                                               */ 04121000
*   /* PROCESS SHARE SWA HERE                                        */ 04122000
*   /*                                                               */ 04123000
*   /*****************************************************************/ 04124000
*                                                                  1227 04125000
*/* AT001510: S GETSPQE: OBTAIN STORAGE FOR SPQE                     */ 04126000
*                                                                  1227 04127000
*AT001510:                                                         1227 04128000
*   RFY                                                            1227 04129000
*     R10WORK RSTD;                 /*                       @Z30ENVB*/ 04130000
AT001510 DS    0H                                                  1228 04131000
*   R10WORK=R14RET;                 /* SAVE RETURN ADDR      @Z30ENVB*/ 04132000
         LR    R10WORK,R14RET                                      1228 04133000
*   CALL GETSPQE;                   /* GET SPQE STORAGE FOR NEW TCB     04134000
*                                                            @Z30ENVB*/ 04135000
         BAL   @14,GETSPQE                                         1229 04136000
*   R14RET=R10WORK;                 /* RESTORE RETURN ADDR   @Z30ENVB*/ 04137000
         LR    R14RET,R10WORK                                      1230 04138000
*   RFY                                                            1231 04139000
*     R10WORK UNRSTD;               /*                       @Z30ENVB*/ 04140000
*/* D (YES,AT001500,NO,) ANY ERRORS ?                                */ 04141000
*                                                                  1232 04142000
*   IF R15RETCDÂ¬=X00NOERR THEN      /*                       @Z30ENVB*/ 04143000
         LTR   R15RETCD,R15RETCD                                   1232 04144000
         BNZ   @RT01232                                            1232 04145000
*     GO TO AT001500;               /* GO EXIT SUBROUTINE    @Z30ENVB*/ 04146000
*   RFY                                                            1234 04147000
*     R8WORK RSTD;                  /*                       @Z30ENVB*/ 04148000
*   R8WORK=R1WORK;                  /* ADDRESS SPQE OBTAINED @Z30ENVB*/ 04149000
         LR    R8WORK,R1WORK                                       1235 04150000
*   R1WORK=WKSAVEE;                 /* RESTORE SUBPOOL ID    @Z30ENVB*/ 04151000
         L     R1WORK,WKSAVEE(,R3WORKAD)                           1236 04152000
*/* P PROPAGATE FIELD SPQEKEY                                        */ 04153000
*                                                                  1237 04154000
*   R8WORK->SPQEKEY=R7WORK->SPQEKEY;/* PROPAGATE OWNING KEY          */ 04155000
         MVC   SPQEKEY(1,R8WORK),SPQEKEY(R7WORK)                   1237 04156000
*/* P SET SPQEID TO SPECIFIED ID                                     */ 04157000
*                                                                  1238 04158000
*   R8WORK->SPQEID=R1WORK;          /* SET SUBPOOL ID TO ENTRY VALUE */ 04159000
         STC   R1WORK,SPQEID(,R8WORK)                              1238 04160000
*   RFY                                                            1239 04161000
*     R1WORK UNRSTD;                                               1239 04162000
*                                                                  1239 04163000
*/* D (NO,%FL01590,YES,) DOES CURRENT TASK OWN THIS SUBPOOL ?        */ 04164000
*                                                                  1240 04165000
*   IF R7WORK->SPSHARE='0'B THEN                                   1240 04166000
         TM    SPSHARE(R7WORK),B'10000000'                         1240 04167000
         BNZ   @RF01240                                            1240 04168000
*     DO;                           /* DO000095                      */ 04169000
*/* P SET NEW SPQE DQE PTR TO ADDR CURRENT TCB'S SPQE                */ 04170000
*                                                                  1242 04171000
*       R8WORK->SPDQEPTR=R7WORK;    /* OWNING SPQE ADDR              */ 04172000
         ST    R7WORK,SPDQEPTR(,R8WORK)                            1242 04173000
*/* P (,%FL01620) SET CURRENT TASK SPQE'S OWNED-AND- SHARED FLAG ON  */ 04174000
*                                                                  1243 04175000
*       R7WORK->SPQEOWN='1'B;       /* SET BIT (MAY ALREADY BE ON)   */ 04176000
         OI    SPQEOWN(R7WORK),B'00100000'                         1243 04177000
*     END;                          /* END00095                      */ 04178000
*   ELSE                            /* SHARED SUBPOOL                */ 04179000
*/* %FL01590: P PROPAGATE DQE PTR TO NEW SPQE                        */ 04180000
*                                                                  1245 04181000
*     R8WORK->SPDQEPTR=R7WORK->SPDQEPTR;/* OWNING SPQE ADDR          */ 04182000
         B     @RC01240                                            1245 04183000
@RF01240 MVC   SPDQEPTR(4,R8WORK),SPDQEPTR(R7WORK)                 1245 04184000
*/* %FL01620: P SET NEW SPQE'S SHARED-NOT- OWNED FLAG ON             */ 04185000
*                                                                  1246 04186000
*   R8WORK->SPSHARE='1'B;           /* NEW TASK DOES NOT OWN SUBPOOL */ 04187000
@RC01240 OI    SPSHARE(R8WORK),B'10000000'                         1246 04188000
*/* P GET NEW TCB'S TCBSWA  FIELD (SWA QUEUE PTR)                    */ 04189000
*                                                                  1247 04190000
*   RFY                                                            1247 04191000
*     R10WORK RSTD;                                                1247 04192000
*   R10WORK=R5NEWTCB->TCBSWA;       /* PTR TO FIRST SWA SPQE, IF ANY */ 04193000
         L     R10WORK,TCBSWA(,R5NEWTCB)                           1248 04194000
*/* D (NO,%FL01600,YES,) IS SWA QUEUE PTR Â¬= 0 ?                     */ 04195000
*                                                                  1249 04196000
*   IF R10WORKÂ¬=ZERO THEN                                          1249 04197000
*                                                                  1249 04198000
         LTR   R10WORK,R10WORK                                     1249 04199000
         BZ    @RF01249                                            1249 04200000
*/* P (,%FL01610) SET SPQEPTR (NEXT SWA SPQE) TO TCBSWA              */ 04201000
*                                                                  1250 04202000
*     R8WORK->SPQEPTR=R10WORK;      /* NEW SPQE'S CHAIN PTR          */ 04203000
         ST    R10WORK,SPQEPTR(,R8WORK)                            1250 04204000
*/* %FL01600: P SET NEW SPQE'S LAST-ON-QUEUE FLAG ON                 */ 04205000
*                                                                  1251 04206000
*   ELSE                                                           1251 04207000
*     R8WORK->LASTSPQE='1'B;        /* TCBSWA =0 MEANS THIS IS THE 1251 04208000
*                                      FIRST SPQE ON QUEUE, HENCE  1251 04209000
*                                      WILL ALWAYS BE AT END OF QUEUE*/ 04210000
         B     @RC01249                                            1251 04211000
@RF01249 OI    LASTSPQE(R8WORK),B'01000000'                        1251 04212000
*/* %FL01610: P (,AT001500) SET NEW TCB'S TCBSWA  TO ADDR NEW SPQE   */ 04213000
*                                                                  1252 04214000
*   R5NEWTCB->TCBSWA=R8WORK;        /* RESET TOP-OF-QUEUE PTR        */ 04215000
@RC01249 ST    R8WORK,TCBSWA(,R5NEWTCB)                            1252 04216000
*   GOTO AT001500;                  /* GO EXIT SUBROUTINE            */ 04217000
         B     AT001500                                            1253 04218000
*/* SHARESWA: END FLOWCHART                                          */ 04219000
*                                                                  1254 04220000
*   RFY                                                            1254 04221000
*     R0WORK UNRSTD;                                               1254 04222000
*   RFY                                                            1255 04223000
*     R7WORK UNRSTD;                                               1255 04224000
*   RFY                                                            1256 04225000
*     R8WORK UNRSTD;                                               1256 04226000
*   RFY                                                            1257 04227000
*     R10WORK UNRSTD;                                              1257 04228000
*   RFY                                                            1258 04229000
*     R14RET UNRSTD;                                               1258 04230000
*   END SHARESWA;                   /* END OF SUBROUTINE             */ 04231000
*                                                                  1260 04232000
*   /*****************************************************************/ 04233000
*   /*                                                               */ 04234000
*   /* CHAIN SUBROUTINE                                              */ 04235000
*   /*                                                               */ 04236000
*   /*****************************************************************/ 04237000
*                                                                  1260 04238000
*CHAIN:                                                            1260 04239000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 04240000
CHAIN    DS    0H                                                  1261 04241000
*/* CHAIN: CHART BEGIN FLOWCHART                                     */ 04242000
*/* FOOTING                                                        1261 04243000
*/* SUBROUTINE QUEUES UP NEW TCB                                     */ 04244000
*/********************************************************************/ 04245000
*/*                                                                  */ 04246000
*/*    SUBROUTINE CHAIN PLACES THE NEW TCB ONTO THE READY QUEUE AND  */ 04247000
*/*    FAMILY QUEUE. THE TCB COUNTS IN THE ASCB AND ASXB ARE         */ 04248000
*/*    UPDATED.                                                      */ 04249000
*/*                                                                  */ 04250000
*/* SUBROUTINES CALLED: NONE                                         */ 04251000
*/*                                                                  */ 04252000
*/* SYSTEM ROUTINES CALLED / MACROS ISSUED: NONE                     */ 04253000
*/*                                                                  */ 04254000
*/* RETURN CODES SET: NONE                                           */ 04255000
*/*                                                                  */ 04256000
*/* REGISTER USAGE: NORMAL                                           */ 04257000
*/*                                                                  */ 04258000
*/* LEVEL - 1                                                        */ 04259000
*/*                                                                  */ 04260000
*/********************************************************************/ 04261000
*/* E ENTER CHAIN                                                    */ 04262000
*                                                                  1261 04263000
*   RFY                                                            1261 04264000
*     R1WORK RSTD;                                                 1261 04265000
*   RFY                                                            1262 04266000
*     R7ASCB RSTD;                                                 1262 04267000
*   RFY                                                            1263 04268000
*     R8WORK RSTD;                                                 1263 04269000
*   RFY                                                            1264 04270000
*     R11PTR RSTD;                                                 1264 04271000
*   RFY                                                            1265 04272000
*     R14RET RSTD;                                                 1265 04273000
*                                                                  1265 04274000
*/* M GET PTR TO TOP OF QUEUE (ASXBFTCB) AS 'PRESENT' TCB 0'PREVIOUS'*/ 04275000
*                                                                  1266 04276000
*   R7ASCB=PSAAOLD;                 /* ASCB ADDRESS                  */ 04277000
         L     R7ASCB,PSAAOLD                                      1266 04278000
*   R11PTR=R7ASCB->ASCBASXB;        /* ASXB ADDRESS                  */ 04279000
         L     R11PTR,ASCBASXB(,R7ASCB)                            1267 04280000
*   R8WORK=R11PTR->ASXBFTCB;        /* TOP TCB ON READY QUEUE        */ 04281000
         L     R8WORK,ASXBFTCB(,R11PTR)                            1268 04282000
*   R1WORK=ZERO;                    /* INITIALIZE 'PREVIOUS' PTR     */ 04283000
*                                                                  1269 04284000
         SLR   R1WORK,R1WORK                                       1269 04285000
*   /*****************************************************************/ 04286000
*   /*                                                               */ 04287000
*   /* THE ASSUMPTION IS MADE THAT THE TOP TCB WILL NOT CHANGE       */ 04288000
*   /*                                                               */ 04289000
*   /*****************************************************************/ 04290000
*                                                                  1270 04291000
*   DO WHILE(R8WORKÂ¬=ZERO);         /* DO000042: LOOP THROUGH READY     04292000
*                                      QUEUE                         */ 04293000
         B     @DE01270                                            1270 04294000
@DL01270 DS    0H                                                  1271 04295000
*/* %FL01520: D (YES,%FL01460,NO,) IS 'PRESENT' PTR = 0 ?            */ 04296000
*/* D (YES,AT001430,NO,) IS THIS TCB'S DISP < NEW TCB'S ?            */ 04297000
*                                                                  1271 04298000
*     IF R8WORK->TCBDSP<R5NEWTCB->TCBDSP THEN                      1271 04299000
         CLC   TCBDSP(1,R8WORK),TCBDSP(R5NEWTCB)                   1271 04300000
         BL    @RT01271                                            1271 04301000
*       GOTO AT001430;              /* GO CHAIN NEW ABOVE THIS TCB   */ 04302000
*/* P SET 'PREVIOUS' TCB PTR TO 'PRESENT' TCB PTR                    */ 04303000
*                                                                  1273 04304000
*     R1WORK=R8WORK;                /* SAVE 'PREVIOUS' TCB PTR       */ 04305000
         LR    R1WORK,R8WORK                                       1273 04306000
*/* P (,%FL01520) SET 'PRESENT' TCB PTR TO ADDR OF NEXT TCB ON QUEUE */ 04307000
*                                                                  1274 04308000
*     R8WORK=R8WORK->TCBTCB;        /* GET NEXT TCB ON READY QUEUE   */ 04309000
         L     R8WORK,TCBTCB(,R8WORK)                              1274 04310000
*   END;                            /* END00042: END READY QUEUE LOOP*/ 04311000
*                                                                  1275 04312000
@DE01270 LTR   R8WORK,R8WORK                                       1275 04313000
         BNZ   @DL01270                                            1275 04314000
*   /*****************************************************************/ 04315000
*   /*                                                               */ 04316000
*   /* FALL THROUGH LOOP MEANS TCB GOES AT END OF QUEUE              */ 04317000
*   /*                                                               */ 04318000
*   /*****************************************************************/ 04319000
*                                                                  1276 04320000
*/* %FL01460: P (,AT001440) CHAIN NEW TCB AT END OF READY QUEUE      */ 04321000
*                                                                  1276 04322000
*   R5NEWTCB->TCBBACK=R1WORK;       /* BACK PTR TO PREVIOUSLY LAST   */ 04323000
         ST    R1WORK,TCBBACK(,R5NEWTCB)                           1276 04324000
*   R1WORK->TCBTCB=R5NEWTCB;        /* PREV LAST TCB'S FORWARD PTR TO   04325000
*                                      NEW TCB                       */ 04326000
         ST    R5NEWTCB,TCBTCB(,R1WORK)                            1277 04327000
*   R11PTR->ASXBLTCB=R5NEWTCB;      /* BOTTOM OF QUEUE PTR TO NEW    */ 04328000
         ST    R5NEWTCB,ASXBLTCB(,R11PTR)                          1278 04329000
*   GOTO AT001440;                  /* BYPASS 'POSITION FOUND' CHAIN */ 04330000
*                                                                  1279 04331000
         B     AT001440                                            1279 04332000
*   /*****************************************************************/ 04333000
*   /*                                                               */ 04334000
*   /* CORRECT POSITION FOUND, CHAIN NEW TCB FOLLOWING 'PREVIOUS' TCB*/ 04335000
*   /* ADDRESSED BY REGISTER R1WORK                                  */ 04336000
*   /*                                                               */ 04337000
*   /*****************************************************************/ 04338000
*                                                                  1280 04339000
*/* AT001430: P CHAIN NEW TCB AFTER 'PREVIOUS' TCB, BEFORE 'PRESENT' */ 04340000
*                                                                  1280 04341000
*AT001430:                                                         1280 04342000
*   R5NEWTCB->TCBTCB=R8WORK;        /* NEW TCB'S FORWARD PTR TO    1280 04343000
*                                      'PRESENT' TCB                 */ 04344000
AT001430 ST    R8WORK,TCBTCB(,R5NEWTCB)                            1280 04345000
*   R1WORK->TCBTCB=R5NEWTCB;        /* 'PREVIOUS' TCB'S FORWARD PTR     04346000
*                                      TO NEW TCB                    */ 04347000
         ST    R5NEWTCB,TCBTCB(,R1WORK)                            1281 04348000
*   R8WORK->TCBBACK=R5NEWTCB;       /* 'PRESENT' TCB'S BACKWARD PTR     04349000
*                                      TO NEW TCB                    */ 04350000
         ST    R5NEWTCB,TCBBACK(,R8WORK)                           1282 04351000
*   R5NEWTCB->TCBBACK=R1WORK;       /* NEW TCB'S BACKWARD PTR TO   1283 04352000
*                                      'PREVIOUS' TCB                */ 04353000
         ST    R1WORK,TCBBACK(,R5NEWTCB)                           1283 04354000
*/* AT001440: P SET ON QUEUE INDICATOR                               */ 04355000
*                                                                  1284 04356000
*AT001440:                                                         1284 04357000
*   WKONQUE='1'B;                   /* FLAG AS QUEUED                */ 04358000
AT001440 OI    WKONQUE(R12SVRB),B'00000100'                        1284 04359000
*/* P CHAIN NEW TCB ONTO FAMILY QUEUE                                */ 04360000
*                                                                  1285 04361000
*   R8WORK=R4CURTCB->TCBLTC;        /* ADDR OF MOST RECENT SUBTASK   */ 04362000
         L     R8WORK,TCBLTC(,R4CURTCB)                            1285 04363000
*   R4CURTCB->TCBLTC=R5NEWTCB;      /* NEW TASK BECOMES MOST RECENT  */ 04364000
         ST    R5NEWTCB,TCBLTC(,R4CURTCB)                          1286 04365000
*   R5NEWTCB->TCBNTC=R8WORK;        /* ADDR OF NEXT SISTER TCB, OR 0 */ 04366000
         ST    R8WORK,TCBNTC(,R5NEWTCB)                            1287 04367000
*   R5NEWTCB->TCBOTC=R4CURTCB;      /* ADDR OF MOTHER TCB            */ 04368000
*                                                                  1288 04369000
         ST    R4CURTCB,TCBOTC(,R5NEWTCB)                          1288 04370000
*   /*****************************************************************/ 04371000
*   /*                                                               */ 04372000
*   /* UPDATE TCB COUNTS IN ASCB, ASXB.                              */ 04373000
*   /*                                                               */ 04374000
*   /*****************************************************************/ 04375000
*                                                                  1289 04376000
*/* D (YES,%FL01450,NO,) WAS DISP=NO SPECIFIED ?                     */ 04377000
*                                                                  1289 04378000
*   IF R5NEWTCB->TCBANDSP='0'B THEN /* IF DISP=YES WAS SPECIFIED     */ 04379000
         TM    TCBANDSP(R5NEWTCB),B'00010000'                      1289 04380000
         BNZ   @RF01289                                            1289 04381000
*     DO;                           /* DO000029                      */ 04382000
*/* P INCREMENT TCB READY COUNT (ASCBTCBS) BY 1                      */ 04383000
*                                                                  1291 04384000
*       R8WORK=R7ASCB->ASCBTCBS;    /* CURRENT READY TCB COUNT       */ 04385000
         L     R8WORK,ASCBTCBS(,R7ASCB)                            1291 04386000
*AT001370:                          /* TOP OF COMPARE AND SWAP LOOP  */ 04387000
*       R1WORK=R8WORK+ONE;          /* INCREMENT READY COUNT BY 1    */ 04388000
AT001370 LA    R1WORK,1                                            1292 04389000
         ALR   R1WORK,R8WORK                                       1292 04390000
*       CS(R8WORK,R1WORK,R7ASCB->ASCBTCBS);/* RESET COUNT IF       1293 04391000
*                                      UNCHANGED                     */ 04392000
         CS    R8WORK,@01,ASCBTCBS(R7ASCB)                         1293 04393000
*       BC(7,AT001370);             /* OR GO GET NEW COUNT           */ 04394000
         BC    7,AT001370                                          1294 04395000
*     END;                          /* END00029: END UPDATE OF TCB 1295 04396000
*                                      READY COUNT                   */ 04397000
*/* %FL01450: P INCREMENT TCB COUNT (ASXBTCBS) BY 1                  */ 04398000
*                                                                  1296 04399000
*   R7WORK=R11PTR->ASXBTCBS;        /* COUNT OF TCB'S IN ADDR SPACE,    04400000
*                                      SERIALIZED BY LOCAL LOCK.     */ 04401000
@RF01289 LH    R7WORK,ASXBTCBS(,R11PTR)                            1296 04402000
*   R7WORK=R7WORK+ONE;              /* INCREMENT BY ONE FOR NEW TCB  */ 04403000
         AH    R7WORK,@CH00061                                     1297 04404000
*   R11PTR->ASXBTCBS=R7WORK;        /* SAVE NEW COUNT                */ 04405000
         STH   R7WORK,ASXBTCBS(,R11PTR)                            1298 04406000
*/* R RETURN TO CALLER                                               */ 04407000
*/* CHAIN: END FLOWCHART                                             */ 04408000
*                                                                  1299 04409000
*   RFY                                                            1299 04410000
*     R1WORK UNRSTD;                                               1299 04411000
*   RFY                                                            1300 04412000
*     R7ASCB UNRSTD;                                               1300 04413000
*   RFY                                                            1301 04414000
*     R8WORK UNRSTD;                                               1301 04415000
*   RFY                                                            1302 04416000
*     R11PTR UNRSTD;                                               1302 04417000
*   RFY                                                            1303 04418000
*     R14RET UNRSTD;                                               1303 04419000
*   END CHAIN;                      /* END OF SUBROUTINE             */ 04420000
@EL00014 DS    0H                                                  1304 04421000
@EF00014 DS    0H                                                  1304 04422000
@ER00014 BR    @14                                                 1304 04423000
*                                                                  1305 04424000
*   /*****************************************************************/ 04425000
*   /*                                                               */ 04426000
*   /* MOVELIST SUBROUTINE                                           */ 04427000
*   /*                                                               */ 04428000
*   /*****************************************************************/ 04429000
*                                                                  1305 04430000
*MOVELIST:                                                         1305 04431000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 04432000
MOVELIST DS    0H                                                  1306 04433000
*/* MOVELIST: CHART  BEGIN FLOWCHART                                 */ 04434000
*/* FOOTING                                                        1306 04435000
*/* SUBROUTINE PERFORMS VALIDITY CHECKING MOVE                       */ 04436000
*/********************************************************************/ 04437000
*/*                                                                  */ 04438000
*/*    SUBROUTINE MOVELIST PERFORMS A VALIDITY CHECKING MOVE. IF A   */ 04439000
*/*    SYSTEM TASK IS ATTACHING, ONLY THE MOVE IS PERFORMED.         */ 04440000
*/*    OTHERWISE, THE BEGINNING AND END ADDRESSES OF THE SOURCE      */ 04441000
*/*    (MOVE-FROM) LOCATION ARE REFERENCED IN THE USER'S KEY, FOR A  */ 04442000
*/*    FETCH PROTECTION TEST. AN INVALID ADDRESS THUS CAUSES THE FRR */ 04443000
*/*    OR ESTAE EXIT TO BE ENTERED, WHERE THE ERROR IS DIAGNOSED.    */ 04444000
*/*                                                                  */ 04445000
*/*    SUBROUTINES CALLED: NONE                                      */ 04446000
*/*                                                                  */ 04447000
*/*    RETURN CODES SET: NONE                                        */ 04448000
*/*                                                                  */ 04449000
*/*    REGISTER USAGE: R0WORK - MOVE LENGTH (ASSUMED <= 256)         */ 04450000
*/*                    R7WORK - MOVE-FROM ADDRESS                    */ 04451000
*/*                    R8WORK - MOVE-TO ADDRESS                      */ 04452000
*/*                   R13WORK - DESTROYED                            */ 04453000
*/*                    R14RET - RETURN ADDRESS                       */ 04454000
*/*                                                                  */ 04455000
*/*    LEVEL - 2                                                     */ 04456000
*/*                                                                  */ 04457000
*/********************************************************************/ 04458000
*/* E ENTER MOVELIST                                                 */ 04459000
*                                                                  1306 04460000
*   RFY                                                            1306 04461000
*     R2WORK RSTD;                                                 1306 04462000
*   RFY                                                            1307 04463000
*     R14RET RSTD;                                                 1307 04464000
*   RFY                                                            1308 04465000
*     R0WORK RSTD;                                                 1308 04466000
*   RFY                                                            1309 04467000
*     R1WORK RSTD;                                                 1309 04468000
*   RFY                                                            1310 04469000
*     R5WORK RSTD;                                                 1310 04470000
*   RFY                                                            1311 04471000
*     R7WORK RSTD;                                                 1311 04472000
*   RFY                                                            1312 04473000
*     R8WORK RSTD;                                                 1312 04474000
*   RFY                                                            1313 04475000
*     R10WORK RSTD;                                                1313 04476000
*   RFY                                                            1314 04477000
*     R11WORK RSTD;                                                1314 04478000
*   RFY                                                            1315 04479000
*     R12WORK RSTD;                                                1315 04480000
*   RFY                                                            1316 04481000
*     R13WORK RSTD;                                                1316 04482000
*   RFY                                                            1317 04483000
*     R15WORK RSTD;                                                1317 04484000
*   R13WORK=R2WORK;                 /* SAVE                          */ 04485000
         LR    R13WORK,R2WORK                                      1318 04486000
*   RFY                                                            1319 04487000
*     R2WORK UNRSTD;                                               1319 04488000
*                                                                  1319 04489000
*/* D (YES,%FL01800,NO,) IS ATTACHOR A SYSTEM TASK ?                 */ 04490000
*                                                                  1320 04491000
*   IF WKSYSTSK='0'B THEN                                          1320 04492000
         TM    WKSYSTSK(R12SVRB),B'10000000'                       1320 04493000
         BNZ   @RF01320                                            1320 04494000
*     DO;                           /* DO000061: FETCH PROTECT CHECK */ 04495000
*/* VALIDITY CHECK ADDRESSES                                         */ 04496000
*                                                                  1322 04497000
*       RFY                                                        1322 04498000
*         R2WORK RSTD;                                             1322 04499000
*       R2WORK=WKPKEY;              /* USER'S PROTECT KEY            */ 04500000
         SLR   R2WORK,R2WORK                                       1323 04501000
         IC    R2WORK,WKPKEY(,R12SVRB)                             1323 04502000
*       GENERATE REFS(R2WORK) NOFLOWS SETS(R2WORK);                1324 04503000
         SPACE                                                          04504000
*/* L MODESET: SET USER'S PROTECT KEY                                */ 04505000
         SPACE                                                          04506000
         MODESET KEYADDR=(2)           SET USER'S PROTECT KEY           04507000
         SPACE                                                          04508000
*/* P FETCH FIRST AND LAST BYTE OF SOURCE AREA                       */ 04509000
         SPACE                                                          04510000
         IC    R2WORK,0(,R7WORK)       CHECK FIRST BYTE                 04511000
         LR    R2WORK,R0WORK           OFFSET TO LAST BYTE = MOVE       04512000
         BCTR  R2WORK,0                  LENGTH - 1                     04513000
         IC    R2WORK,0(R2WORK,R7WORK) CHECK LAST BYTE                  04514000
         SPACE                                                          04515000
*/* L MODESET: RESET PROTECT KEY 0                                   */ 04516000
         SPACE                                                          04517000
         MODESET EXTKEY=SUPR           RESET PROTECT KEY TO 0           04518000
*     END;                          /* END00061: END FETCH PROTECT 1325 04519000
*                                      CHECK                         */ 04520000
*   RFY                                                            1326 04521000
*     R2WORK UNRSTD;                                               1326 04522000
*                                                                  1326 04523000
@RF01320 DS    0H                                                  1327 04524000
*/* %FL01800: P PERFORM MOVE AS REQUESTED                            */ 04525000
*                                                                  1327 04526000
*   R8WORK->AREA(1:R0WORK)=R7WORK->AREA(1:R0WORK);/* MOVE            */ 04527000
         LR    @02,R0WORK                                          1327 04528000
         BCTR  @02,0                                               1327 04529000
         EX    @02,@SM03153                                        1327 04530000
*/* R RETURN TO CALLING POINT                                        */ 04531000
*                                                                  1328 04532000
*   RFY                                                            1328 04533000
*     R2WORK RSTD;                                                 1328 04534000
*   R2WORK=R13WORK;                 /* RESTORE                       */ 04535000
         LR    R2WORK,R13WORK                                      1329 04536000
*/* MOVELIST: END FLOWCHART                                          */ 04537000
*                                                                  1330 04538000
*   END MOVELIST;                   /* END OF SUBROUTINE             */ 04539000
@EL00015 DS    0H                                                  1330 04540000
@EF00015 DS    0H                                                  1330 04541000
@ER00015 BR    @14                                                 1330 04542000
*   RFY                                                            1331 04543000
*     R2WORK UNRSTD;                                               1331 04544000
*   RFY                                                            1332 04545000
*     R14RET UNRSTD;                                               1332 04546000
*   RFY                                                            1333 04547000
*     R0WORK UNRSTD;                                               1333 04548000
*   RFY                                                            1334 04549000
*     R1WORK UNRSTD;                                               1334 04550000
*   RFY                                                            1335 04551000
*     R5WORK UNRSTD;                                               1335 04552000
*   RFY                                                            1336 04553000
*     R7WORK UNRSTD;                                               1336 04554000
*   RFY                                                            1337 04555000
*     R8WORK UNRSTD;                                               1337 04556000
*   RFY                                                            1338 04557000
*     R10WORK UNRSTD;                                              1338 04558000
*   RFY                                                            1339 04559000
*     R11WORK UNRSTD;                                              1339 04560000
*   RFY                                                            1340 04561000
*     R12WORK UNRSTD;                                              1340 04562000
*   RFY                                                            1341 04563000
*     R13WORK UNRSTD;                                              1341 04564000
*   RFY                                                            1342 04565000
*     R15WORK UNRSTD;                                              1342 04566000
*                                                                  1343 04567000
*   /*****************************************************************/ 04568000
*   /*                                                               */ 04569000
*   /* LOCK SUBROUTINE                                               */ 04570000
*   /*                                                               */ 04571000
*   /*****************************************************************/ 04572000
*                                                                  1343 04573000
*LOCK:                                                             1343 04574000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 04575000
LOCK     DS    0H                                                  1344 04576000
*/* LOCK: CHART  BEGIN FLOWCHART                                     */ 04577000
*/* FOOTING                                                        1344 04578000
*/* OBTAIN LOCK                                                      */ 04579000
*/********************************************************************/ 04580000
*/*                                                                  */ 04581000
*/*    SUBROUTINE LOCK OBTAINS THE LOCAL LOCK AND ESTABLISHES AN FRR */ 04582000
*/*                                                                  */ 04583000
*/*    SUBROUTINES CALLED: NONE                                      */ 04584000
*/*                                                                  */ 04585000
*/*    SYSTEM MACROS ISSUED: SETLOCK, SETFRR                         */ 04586000
*/*                                                                  */ 04587000
*/*    RETURN CODES SET: X00NOERR, ABEND92A                          */ 04588000
*/*                                                                  */ 04589000
*/*    REGISTER USAGE: R0WORK - DESTROYED (SAVE REG FOR R12SVRB)     */ 04590000
*/* R11WORK - DESTROYED (SAVE REG R14RET)                            */ 04591000
*/* R1WORK - DESTROYED (SAVE REG FOR R14RET)                         */ 04592000
*/* R15RETCD - RETURN CODE                                           */ 04593000
*/*                                                                  */ 04594000
*/*    LEVEL - 2                                                     */ 04595000
*/*                                                                  */ 04596000
*/********************************************************************/ 04597000
*/* E ENTER LOCK                                                     */ 04598000
*                                                                  1344 04599000
*   RFY                                                            1344 04600000
*     R0WORK RSTD;                                                 1344 04601000
*   RFY                                                            1345 04602000
*     R1WORK RSTD;                                                 1345 04603000
*   RFY                                                            1346 04604000
*     R7WORK RSTD;                                                 1346 04605000
*   RFY                                                            1347 04606000
*     R8WORK RSTD;                                                 1347 04607000
*   RFY                                                            1348 04608000
*     R2WORK RSTD;                  /* SAVE FOR ERROR ROUTINES       */ 04609000
*   RFY                                                            1349 04610000
*     R10WORK RSTD;                 /* SAVE ATTACH PARM LIST ADDR    */ 04611000
*                                                                  1349 04612000
*   /*****************************************************************/ 04613000
*   /*                                                               */ 04614000
*   /* SAVE REGISTERS 12, 14, DESTROYED                              */ 04615000
*   /*                                                               */ 04616000
*   /*****************************************************************/ 04617000
*                                                                  1350 04618000
*   RFY                                                            1350 04619000
*     R14RET RSTD;                                                 1350 04620000
*   R0WORK=R12SVRB;                 /* SAVE SVRB-WORKAREA ADDR       */ 04621000
         LR    R0WORK,R12SVRB                                      1351 04622000
*   R1WORK=R14RET;                  /* SAVE                          */ 04623000
         LR    R1WORK,R14RET                                       1352 04624000
*   RFY                                                            1353 04625000
*     R14RET UNRSTD;                                               1353 04626000
*   RFY                                                            1354 04627000
*     R13WORK RSTD;                                                1354 04628000
*                                                                  1354 04629000
*/* L SETLOCK: OBTAIN LOCAL LOCK                                     */ 04630000
*                                                                  1355 04631000
*   GENERATE REFS(PSALITA) NOFLOWS;                                1355 04632000
*                                                                  1355 04633000
         SPACE                                                          04634000
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        *04635000
               RELATED=('RELEASED BY SUBROUTINE UNLOCK')                04636000
* REGISTERS 11 - 14 DESTROYED BY SETLOCK                                04637000
         SPACE                                                          04638000
*/* D (YES,%FL01810,NO,) RETURN CODE = 0 ?                           */ 04639000
*                                                                  1356 04640000
*   R12SVRB=R0WORK;                 /* RESTORE                       */ 04641000
         LR    R12SVRB,R0WORK                                      1356 04642000
*   RFY                                                            1357 04643000
*     R0WORK UNRSTD;                                               1357 04644000
*   RFY                                                            1358 04645000
*     R15RETCD RSTD;                                               1358 04646000
*   IF R13WORKÂ¬=X00NOERR THEN       /* RETURN CODE IN REG 13         */ 04647000
         LTR   R13WORK,R13WORK                                     1359 04648000
         BZ    @RF01359                                            1359 04649000
*/* P (,%FL01820) SET ABEND CODE 92A                                 */ 04650000
*                                                                  1360 04651000
*     DO;                           /* DO000036                      */ 04652000
*       WKREASON=RCODE12;           /* SET REASON CODE               */ 04653000
         MVI   WKREASON(R12SVRB),X'0C'                             1361 04654000
*       R15RETCD=ABEND92A;          /* ONLY RETURN CODE 0 VALID      */ 04655000
         LA    R15RETCD,2346                                       1362 04656000
*     END;                          /* END00036                      */ 04657000
*   ELSE                            /* SETFRR                 @Y02753*/ 04658000
*     DO;                           /* DO000062               @Y02753*/ 04659000
         B     @RC01359                                            1364 04660000
@RF01359 DS    0H                                                  1365 04661000
*       RFY                                                        1365 04662000
*         R15RETCD UNRSTD;                                         1365 04663000
*       RFY                                                        1366 04664000
*         R14FRRAD RSTD;                                           1366 04665000
*       R14FRRAD=ADDR(IGC042R2);    /* FRR ADDRESS            @Y02753*/ 04666000
         LA    R14FRRAD,IGC042R2                                   1367 04667000
*/* %FL01810: L SETFRR: ESTABLISH FRR                                */ 04668000
*                                                                  1368 04669000
*       GENERATE NOFLOWS REFS(PSACSTK,FRRS,FRRSCURR,FRRSLAST,FRRSELEN,  04670000
*           FRRSENTR,FRRSFRRA,FRRSPARM,PSALSFCC);                  1368 04671000
         SPACE                                                          04672000
         SETFRR A,FRRAD=(R14WORK),PARMAD=(R15WORK),                    *04673000
               WRKREGS=(R11WORK,R13WORK)                        @Y02753 04674000
         SPACE                                                          04675000
*       RFY                                                        1369 04676000
*         R14FRRAD UNRSTD;                                         1369 04677000
*                                                                  1369 04678000
*/* P SAVE FRR WORKAREA PTR IN PERM WORKAREA, AND VICE VERSA         */ 04679000
*                                                                  1370 04680000
*       RFY                                                        1370 04681000
*         R15WORK RSTD;                                            1370 04682000
*       R15WORK->ZWORD=R12SVRB;     /* ATTACH WORKAREA ADDR INTO FRR    04683000
*                                      WORKAREA               @Y02753*/ 04684000
         ST    R12SVRB,ZWORD(,R15WORK)                             1371 04685000
*       WKFRRAD=R15WORK;            /* FRR WORKAREA ADDR INTO ATTACH    04686000
*                                      WORKAREA               @Y02753*/ 04687000
         ST    R15WORK,WKFRRAD(,R12SVRB)                           1372 04688000
*       R15RETCD=X00NOERR;          /* RETURN CODE 0          @Y02753*/ 04689000
         SLR   R15RETCD,R15RETCD                                   1373 04690000
*     END;                          /* END00062               @Y02753*/ 04691000
*/* %FL01820: R RETURN TO CALLING POINT                              */ 04692000
*                                                                  1375 04693000
*   RFY                                                            1375 04694000
*     R14RET RSTD;                                                 1375 04695000
@RC01359 DS    0H                                                  1376 04696000
*   R14RET=R1WORK;                  /* RESTORE RETURN ADDRESS        */ 04697000
         LR    R14RET,R1WORK                                       1376 04698000
*/* LOCK: END FLOWCHART                                              */ 04699000
*                                                                  1377 04700000
*   END LOCK;                       /* END OF SUBROUTINE             */ 04701000
@EL00016 DS    0H                                                  1377 04702000
@EF00016 DS    0H                                                  1377 04703000
@ER00016 BR    @14                                                 1377 04704000
*   RFY                                                            1378 04705000
*     R15WORK UNRSTD;                                              1378 04706000
*   RFY                                                            1379 04707000
*     R2WORK UNRSTD;                                               1379 04708000
*   RFY                                                            1380 04709000
*     R10WORK UNRSTD;                                              1380 04710000
*   RFY                                                            1381 04711000
*     R14RET UNRSTD;                                               1381 04712000
*   RFY                                                            1382 04713000
*     R1WORK UNRSTD;                                               1382 04714000
*   RFY                                                            1383 04715000
*     R7WORK UNRSTD;                                               1383 04716000
*   RFY                                                            1384 04717000
*     R8WORK UNRSTD;                                               1384 04718000
*   RFY                                                            1385 04719000
*     R13WORK UNRSTD;                                              1385 04720000
*                                                                  1386 04721000
*   /*****************************************************************/ 04722000
*   /*                                                               */ 04723000
*   /* UNLOCK SUBROUTINE                                             */ 04724000
*   /*                                                               */ 04725000
*   /*****************************************************************/ 04726000
*                                                                  1386 04727000
*UNLOCK:                                                           1386 04728000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 04729000
UNLOCK   DS    0H                                                  1387 04730000
*/* UNLOCK: CHART  BEGIN FLOWCHART                                   */ 04731000
*/* FOOTING                                                        1387 04732000
*/* RELEASES LOCK                                                    */ 04733000
*/********************************************************************/ 04734000
*/*                                                                  */ 04735000
*/*    SUBROUTINE UNLOCK RELEASES THE LOCAL LOCK AND CANCELS THE FRR */ 04736000
*/*                                                                  */ 04737000
*/*    SUBROUTINES CALLED: NONE                                      */ 04738000
*/*                                                                  */ 04739000
*/*    SYSTEM MACROS ISSUED: SETLOCK, SETFRR                         */ 04740000
*/*                                                                  */ 04741000
*/*    RETURN CODES: X00NOERR, ABEND92A                              */ 04742000
*/*                                                                  */ 04743000
*/* REGISTER USAGE:                                                  */ 04744000
*/* R0WORK - DESTROYED (SAVE REG FOR R12SVRB)                        */ 04745000
*/* R1WORK - DESTROYED (SAVE REG FOR R14RET)                         */ 04746000
*/* R11WORK - DESTROYED                                              */ 04747000
*/* R15RETCD - DESTROYED                                             */ 04748000
*/*                                                                  */ 04749000
*/*    LEVEL - 2                                                     */ 04750000
*/*                                                                  */ 04751000
*/********************************************************************/ 04752000
*/* E ENTER UNLOCK                                                   */ 04753000
*                                                                  1387 04754000
*   RFY                                                            1387 04755000
*     R0WORK RSTD;                                                 1387 04756000
*   RFY                                                            1388 04757000
*     R1WORK RSTD;                                                 1388 04758000
*   RFY                                                            1389 04759000
*     R7WORK RSTD;                                                 1389 04760000
*   RFY                                                            1390 04761000
*     R8WORK RSTD;                                                 1390 04762000
*   RFY                                                            1391 04763000
*     R10WORK RSTD;                                                1391 04764000
*   RFY                                                            1392 04765000
*     R2WORK RSTD;                  /* SAVE FOR ERROR ROUTINES       */ 04766000
*                                                                  1392 04767000
*   /*****************************************************************/ 04768000
*   /*                                                               */ 04769000
*   /* SAVE REGISTERS DESTROYED                                      */ 04770000
*   /*                                                               */ 04771000
*   /*****************************************************************/ 04772000
*                                                                  1393 04773000
*   RFY                                                            1393 04774000
*     R11WORK RSTD;                                                1393 04775000
*   RFY                                                            1394 04776000
*     R13WORK RSTD;                                                1394 04777000
*   RFY                                                            1395 04778000
*     R14RET RSTD;                                                 1395 04779000
*   R0WORK=R12SVRB;                 /* SAVE SVRB-WORKAREA ADDRESS    */ 04780000
         LR    R0WORK,R12SVRB                                      1396 04781000
*   R1WORK=R14RET;                  /* SAVE                          */ 04782000
         LR    R1WORK,R14RET                                       1397 04783000
*   RFY                                                            1398 04784000
*     R14RET UNRSTD;                                               1398 04785000
*                                                                  1398 04786000
*/* L SETFRR: CANCEL FRR                                             */ 04787000
*                                                                  1399 04788000
*   GENERATE NOFLOWS REFS(PSACSTK,FRRS,FRRSCURR,FRRSEMP,FRRSELEN); 1399 04789000
         SPACE                                                          04790000
         SETFRR D,WRKREGS=(R11WORK,R13WORK)  CANCEL FRR         @Y02753 04791000
         SPACE                                                          04792000
*   WKFRRAD=ZERO;                   /* CLEAR FRR WORKAREA PTR @Y02753*/ 04793000
         SLR   @15,@15                                             1400 04794000
         ST    @15,WKFRRAD(,R12SVRB)                               1400 04795000
*/* L SETLOCK: RELEASE LOCAL LOCK                                    */ 04796000
*                                                                  1401 04797000
*   GENERATE REFS(PSALITA) NOFLOWS;                                1401 04798000
         SPACE                                                          04799000
         SETLOCK RELEASE,TYPE=LOCAL,                                   *04800000
               RELATED=('OBTAINED BY SUBROUTINE LOCK')                  04801000
         SPACE                                                          04802000
*   RFY                                                            1402 04803000
*     R11WORK UNRSTD;                                              1402 04804000
*                                                                  1402 04805000
*/* D (YES,%FL01830,NO,) RETURN CODE = 0 ?                           */ 04806000
*                                                                  1403 04807000
*   RFY                                                            1403 04808000
*     R15RETCD RSTD;                                               1403 04809000
*   IF R13WORKÂ¬=X00NOERR THEN       /* 0 ?                           */ 04810000
         LTR   R13WORK,R13WORK                                     1404 04811000
         BZ    @RF01404                                            1404 04812000
*/* P (,%FL01840) SET ABEND CODE 92A                                 */ 04813000
*                                                                  1405 04814000
*     DO;                           /* DO000038                      */ 04815000
*       WKREASON=RCODE16;           /* SET REASON CODE               */ 04816000
         MVI   WKREASON(R12SVRB),X'10'                             1406 04817000
*       R15RETCD=ABEND92A;          /* SETLOCK ERROR                 */ 04818000
         LA    R15RETCD,2346                                       1407 04819000
*     END;                          /* END00038                      */ 04820000
*/* %FL01830: P SET RETURN CODE = 0                                  */ 04821000
*                                                                  1409 04822000
*   ELSE                                                           1409 04823000
*     R15RETCD=X00NOERR;            /* RETURN CODE = 0               */ 04824000
         B     @RC01404                                            1409 04825000
@RF01404 SLR   R15RETCD,R15RETCD                                   1409 04826000
*/* %FL01840: R RETURN TO CALLING POINT                              */ 04827000
*                                                                  1410 04828000
*   RFY                                                            1410 04829000
*     R14RET RSTD;                                                 1410 04830000
@RC01404 DS    0H                                                  1411 04831000
*   R12SVRB=R0WORK;                 /* RESTORE WORKAREA ADDRESS      */ 04832000
         LR    R12SVRB,R0WORK                                      1411 04833000
*   R14RET=R1WORK;                  /* RESTORE RETURN ADDRESS        */ 04834000
         LR    R14RET,R1WORK                                       1412 04835000
*/* UNLOCK: END FLOWCHART                                            */ 04836000
*                                                                  1413 04837000
*   END UNLOCK;                     /* END OF SUBROUTINE             */ 04838000
@EL00017 DS    0H                                                  1413 04839000
@EF00017 DS    0H                                                  1413 04840000
@ER00017 BR    @14                                                 1413 04841000
*   RFY                                                            1414 04842000
*     R0WORK UNRSTD;                                               1414 04843000
*   RFY                                                            1415 04844000
*     R13WORK UNRSTD;                                              1415 04845000
*   RFY                                                            1416 04846000
*     R14RET UNRSTD;                                               1416 04847000
*   RFY                                                            1417 04848000
*     R2WORK UNRSTD;                                               1417 04849000
*   RFY                                                            1418 04850000
*     R15RETCD UNRSTD;                                             1418 04851000
*   RFY                                                            1419 04852000
*     R1WORK UNRSTD;                                               1419 04853000
*   RFY                                                            1420 04854000
*     R7WORK UNRSTD;                                               1420 04855000
*   RFY                                                            1421 04856000
*     R8WORK UNRSTD;                                               1421 04857000
*   RFY                                                            1422 04858000
*     R10WORK UNRSTD;                                              1422 04859000
*                                                                  1423 04860000
*   /*****************************************************************/ 04861000
*   /*                                                               */ 04862000
*   /* RTN1 CLEAN UP ROUTINE                                         */ 04863000
*   /*                                                               */ 04864000
*   /*****************************************************************/ 04865000
*                                                                  1423 04866000
*RTN1:                                                             1423 04867000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 04868000
RTN1     DS    0H                                                  1424 04869000
*/* RTN1: CHART  BEGIN FLOWCHART                                     */ 04870000
*/* FOOTING                                                        1424 04871000
*/* MAIN CLEAN UP ROUTINE                                            */ 04872000
*/********************************************************************/ 04873000
*/*                                                                  */ 04874000
*/*    SUBROUTINE RTN1 PERFORMS CLEAN-UP PROCESSING COMMON TO NORMAL */ 04875000
*/*    BACKOUT PROCESSING AND THE ESTAE PROCESSING.                  */ 04876000
*/*                                                                  */ 04877000
*/*    SUBROUTINES CALLED: RTN2, RTN3, LOCK, UNLOCK, FREESPQE        */ 04878000
*/*                                                                  */ 04879000
*/*    SYSTEM MACROS ISSUED: FREEMAIN (BRANCH), SETLOCK (TEST)       */ 04880000
*/*                                                                  */ 04881000
*/*    RETURN CODES SET: NONE                                        */ 04882000
*/*                                                                  */ 04883000
*/*    LEVEL - 1                                                     */ 04884000
*/*                                                                  */ 04885000
*/********************************************************************/ 04886000
*/* E ENTER RTN1                                                     */ 04887000
*                                                                  1424 04888000
*   RFY                                                            1424 04889000
*     R2WORK RSTD;                                                 1424 04890000
*   RFY                                                            1425 04891000
*     R14RET RSTD;                                                 1425 04892000
*   R2WORK=R14RET;                  /* SAVE RETURN ADDRESS           */ 04893000
         LR    R2WORK,R14RET                                       1426 04894000
*   RFY                                                            1427 04895000
*     R14RET UNRSTD;                                               1427 04896000
*                                                                  1427 04897000
*/* D (NO,AT001650,YES,) IS THERE A WORKAREA ?                       */ 04898000
*                                                                  1428 04899000
*   IF WKNOAREA='0'B THEN                                          1428 04900000
*                                                                  1428 04901000
         TM    WKNOAREA(R12SVRB),B'00001000'                       1428 04902000
         BNZ   @RF01428                                            1428 04903000
*/* D (NO,AT001650,YES,) IS NEW TCB NOT YET ON DISP QUEUE ?          */ 04904000
*                                                                  1429 04905000
*     IF WKONQUE='0'B THEN                                         1429 04906000
         TM    WKONQUE(R12SVRB),B'00000100'                        1429 04907000
         BNZ   @RF01429                                            1429 04908000
*       DO;                         /* DO000074                      */ 04909000
*         R3WORKAD=WK255PTR;        /* SET WORKAREA ADDRESS          */ 04910000
         L     R3WORKAD,WK255PTR(,R12SVRB)                         1431 04911000
*         R5NEWTCB=WKNEWTCB;        /* SET ADDRESS OF NEW TCB        */ 04912000
         L     R5NEWTCB,WKNEWTCB(,R12SVRB)                         1432 04913000
*/* D (NO,AT001700,YES,) IS LOCAL LOCK NOT HELD ?                    */ 04914000
*                                                                  1433 04915000
*         GENERATE REFS(PSAHLHI) FLOWS(AT001700);                  1433 04916000
*                                                                  1433 04917000
         SPACE                                                          04918000
         SETLOCK TEST,TYPE=LOCAL,BRANCH=(HELD,AT001700) CHECK LOCK      04919000
         SPACE                                                          04920000
*/* S LOCK: OBTAIN LOCAL LOCK                                        */ 04921000
*                                                                  1434 04922000
*         RFY                                                      1434 04923000
*           R15RETCD RSTD;                                         1434 04924000
*         CALL LOCK;                /* GET LOCK AND SET FRR (ALTERS     04925000
*                                      REGS 0,1,11,13,15)            */ 04926000
         BAL   @14,LOCK                                            1435 04927000
*/* D (NO,AT001650,YES,) WAS LOCK OBTAINED ?                         */ 04928000
*                                                                  1436 04929000
*         IF R15RETCDÂ¬=X00NOERR THEN                               1436 04930000
         LTR   R15RETCD,R15RETCD                                   1436 04931000
         BNZ   @RT01436                                            1436 04932000
*           GOTO AT001650;          /* EXIT SUBROUTINE               */ 04933000
*         RFY                                                      1438 04934000
*           R15RETCD UNRSTD;                                       1438 04935000
*                                                                  1438 04936000
*/* AT001700: D (NO,%FL00000,YES,) IS NEW TCB PTR Â¬= 0 ?             */ 04937000
*                                                                  1439 04938000
*AT001700:                                                         1439 04939000
*         IF R5NEWTCBÂ¬=ZERO THEN                                   1439 04940000
AT001700 LTR   R5NEWTCB,R5NEWTCB                                   1439 04941000
         BZ    @RF01439                                            1439 04942000
*           DO;                     /* DO000041                      */ 04943000
*/* S RTN2: RECONSTRUCT CURRENT TCB'S TCBMSS QUEUE                   */ 04944000
*                                                                  1441 04945000
*             CALL RTN2;            /* PREPARE FOR FREEMAIN OF SPQE     04946000
*                                      STORAGE, RECONSTRUCT TCBMSS Q */ 04947000
         BAL   @14,RTN2                                            1441 04948000
*/* S RTN3: PROCESS (E)STAI SCB'S AND ETXR IRB                       */ 04949000
*                                                                  1442 04950000
*             CALL RTN3;            /* SCB - IRB CLEAN-UP            */ 04951000
         BAL   @14,RTN3                                            1442 04952000
*             RFY                                                  1443 04953000
*               R8WORK RSTD;        /*                       @Z30ENVB*/ 04954000
*/* D (YES,AT001800,NO,) IS DUMMY TCBMSS QUEUE EMPTY ?               */ 04955000
*                                                                  1444 04956000
*             IF WKTCBMSSÂ¬=ZERO THEN/*                       @Z30ENVB*/ 04957000
         L     @07,WKTCBMSS(,R12SVRB)                              1444 04958000
         LTR   @07,@07                                             1444 04959000
         BZ    @RF01444                                            1444 04960000
*               DO;                 /* DO000140: NO          @Z30ENVB*/ 04961000
*/* S FREESPQE: FREE SPQES BUILT FOR CURRENT TCB                     */ 04962000
*                                                                  1446 04963000
*                 R8WORK=WKTCBMSS;  /* GET SPQE PTR FOR SUBROUTINE 1446 04964000
*                                      FREESPQE              @Z30ENVB*/ 04965000
         LR    R8WORK,@07                                          1446 04966000
*                 CALL FREESPQE;    /*                       @Z30ENVB*/ 04967000
         BAL   @14,FREESPQE                                        1447 04968000
*               END;                /* END00140              @Z30ENVB*/ 04969000
*/* AT001800: D (YES,AT001810,NO,) IS NEW TCB TCBMSS QUEUE EMPTY ?   */ 04970000
*                                                                  1449 04971000
*AT001800:                                                         1449 04972000
*             IF R5NEWTCB->TCBMSSBÂ¬=ZERO THEN/*              @Z30ENVB*/ 04973000
@RF01444 DS    0H                                                  1449 04974000
AT001800 SLR   @07,@07                                             1449 04975000
         ICM   @07,7,TCBMSSB(R5NEWTCB)                             1449 04976000
         LTR   @07,@07                                             1449 04977000
         BZ    @RF01449                                            1449 04978000
*               DO;                 /* DO000150: NO          @Z30ENVB*/ 04979000
*/* S FREESPQE: FREE SPQES BUILT FOR NEW TCB                         */ 04980000
*                                                                  1451 04981000
*                 R8WORK=R5NEWTCB->TCBMSSB;/* GET SPQE PTR FOR     1451 04982000
*                                      SUBROUTINE FREESPQE   @Z30ENVB*/ 04983000
         LR    R8WORK,@07                                          1451 04984000
*                 CALL FREESPQE;    /*                       @Z30ENVB*/ 04985000
         BAL   @14,FREESPQE                                        1452 04986000
*               END;                /* END00150              @Z30ENVB*/ 04987000
*/* AT001810: D (YES,%FL00000,NO,) IS NEW TCB TCBSWA QUEUE EMPTY ?   */ 04988000
*                                                                  1454 04989000
*AT001810:                                                         1454 04990000
*             IF R5NEWTCB->TCBSWAÂ¬=ZERO THEN/*               @Z30ENVB*/ 04991000
@RF01449 DS    0H                                                  1454 04992000
AT001810 L     @07,TCBSWA(,R5NEWTCB)                               1454 04993000
         LTR   @07,@07                                             1454 04994000
         BZ    @RF01454                                            1454 04995000
*               DO;                 /* DO000160: NO          @Z30ENVB*/ 04996000
*/* S FREESPQE: FREE SPQES BUILT FOR NEW TCB                         */ 04997000
*                                                                  1456 04998000
*                 R8WORK=R5NEWTCB->TCBSWA;/* GET SPQE PTR FOR      1456 04999000
*                                      SUBROUTINE FREESPQE   @Z30ENVB*/ 05000000
         LR    R8WORK,@07                                          1456 05001000
*                 CALL FREESPQE;    /*                       @Z30ENVB*/ 05002000
         BAL   @14,FREESPQE                                        1457 05003000
*               END;                /* END00160              @Z30ENVB*/ 05004000
*             RFY                                                  1459 05005000
*               R8WORK UNRSTD;      /*                       @Z30ENVB*/ 05006000
@RF01454 DS    0H                                                  1460 05007000
*           END;                    /* END00041                      */ 05008000
*/* %FL00000: L FREEMAIN: FREE SVRB DE STORAGE                       */ 05009000
*                                                                  1461 05010000
*         RFY                                                      1461 05011000
*           R0WORK RSTD;                                           1461 05012000
@RF01439 DS    0H                                                  1462 05013000
*         RFY                                                      1462 05014000
*           R1AREA RSTD;                                           1462 05015000
*         RFY                                                      1463 05016000
*           R7ASCB RSTD;                                           1463 05017000
*         R7ASCB=PSAAOLD;           /* ADDRESS OF CURRENT ASCB       */ 05018000
         L     R7ASCB,PSAAOLD                                      1464 05019000
*         R0WORK=WK255LNG;          /* LENGTH STORAGE                */ 05020000
         LH    R0WORK,WK255LNG(,R12SVRB)                           1465 05021000
*         R1AREA=R3WORKAD;          /* STORAGE ADDRESS               */ 05022000
         LR    R1AREA,R3WORKAD                                     1466 05023000
*         GENERATE NOFLOWS;                                        1467 05024000
*                                                                  1467 05025000
         SPACE                                                          05026000
         FREEMAIN RC,LV=(0),A=(1),SP=SP255EQU,BRANCH=YES                05027000
         SPACE                                                          05028000
*/* L FREEMAIN: FREE TCB/IQE STORAGE, IF ANY                         */ 05029000
*                                                                  1468 05030000
*         IF R5NEWTCBÂ¬=ZERO THEN                                   1468 05031000
         SLR   @08,@08                                             1468 05032000
         CR    R5NEWTCB,@08                                        1468 05033000
         BE    @RF01468                                            1468 05034000
*           DO;                     /* DO000034                      */ 05035000
*             R0WORK=LENGTH(TCBFIX)+LENGTH(TCB)+LENGTH(TCBXTNT2);  1470 05036000
         LA    R0WORK,360                                          1470 05037000
*             IF R5NEWTCB->TCBIQEÂ¬=ZERO THEN/* ETXR IQE ?            */ 05038000
         L     @15,TCBIQE(,R5NEWTCB)                               1471 05039000
         CR    @15,@08                                             1471 05040000
         BE    @RF01471                                            1471 05041000
*               DO;                 /* DO000035                      */ 05042000
*                 R1AREA=R5NEWTCB->TCBIQE;/* IQE/TCB STORAGE         */ 05043000
         LR    R1AREA,@15                                          1473 05044000
*                 R0WORK=R0WORK+LENGTH(IQESECT);/* TOTAL LENGTH      */ 05045000
         AH    R0WORK,@CH00066                                     1474 05046000
*               END;                /* END00035                      */ 05047000
*             ELSE                  /* NO IQE                        */ 05048000
*               R1AREA=R5NEWTCB-LENGTH(TCBFIX);/* TCB ONLY           */ 05049000
         B     @RC01471                                            1476 05050000
@RF01471 LR    R1AREA,R5NEWTCB                                     1476 05051000
         SH    R1AREA,@CH00049                                     1476 05052000
*             GENERATE NOFLOWS;                                    1477 05053000
@RC01471 DS    0H                                                  1477 05054000
         SPACE                                                          05055000
         FREEMAIN RC,LV=(0),A=(1),SP=SP253EQU,BRANCH=YES                05056000
         SPACE                                                          05057000
*           END;                    /* END00034                      */ 05058000
*         RFY                                                      1479 05059000
*           R0WORK UNRSTD;                                         1479 05060000
@RF01468 DS    0H                                                  1480 05061000
*         RFY                                                      1480 05062000
*           R1AREA UNRSTD;                                         1480 05063000
*         RFY                                                      1481 05064000
*           R7ASCB UNRSTD;                                         1481 05065000
*       END;                        /* END00074                      */ 05066000
*/* AT001650: P CONDITIONALLY RELEASE LOCAL LOCK                     */ 05067000
*                                                                  1483 05068000
*AT001650:                                                         1483 05069000
*   GENERATE REFS(PSAHLHI) FLOWS(AT001770);                        1483 05070000
@RF01429 DS    0H                                                  1483 05071000
@RF01428 DS    0H                                                  1483 05072000
AT001650 DS    0H                                                  1483 05073000
         SPACE                                                          05074000
         SETLOCK TEST,TYPE=LOCAL,BRANCH=(NOTHELD,AT001770) CHECK LOCK   05075000
         SPACE                                                          05076000
*   CALL UNLOCK;                    /* RELEASE LOCAL LOCK (ALTERS  1484 05077000
*                                      REGS 0,1,11,13,15)            */ 05078000
         BAL   @14,UNLOCK                                          1484 05079000
*/* AT001770: R RETURN TO CALLING POINT                              */ 05080000
*                                                                  1485 05081000
*   RFY                                                            1485 05082000
*     R14RET RSTD;                                                 1485 05083000
*AT001770:                                                         1486 05084000
*   R14RET=R2WORK;                  /* RESTORE RETURN ADDRESS        */ 05085000
AT001770 LR    R14RET,R2WORK                                       1486 05086000
*/* RTN1: END FLOWCHART                                              */ 05087000
*                                                                  1487 05088000
*   END RTN1;                       /* END OF SUBROUTINE             */ 05089000
@EL00018 DS    0H                                                  1487 05090000
@EF00018 DS    0H                                                  1487 05091000
@ER00018 BR    @14                                                 1487 05092000
*   RFY                                                            1488 05093000
*     R14RET UNRSTD;                                               1488 05094000
*   RFY                                                            1489 05095000
*     R2WORK UNRSTD;                                               1489 05096000
*                                                                  1490 05097000
*   /*****************************************************************/ 05098000
*   /*                                                               */ 05099000
*   /* RTN2 CLEAN UP ROUTINE                                         */ 05100000
*   /*                                                               */ 05101000
*   /*****************************************************************/ 05102000
*                                                                  1490 05103000
*RTN2:                                                             1490 05104000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 05105000
RTN2     DS    0H                                                  1491 05106000
*/* RTN2: CHART  BEGIN FLOWCHART                                     */ 05107000
*/* FOOTING                                                        1491 05108000
*/* RECONSTRUCT CURRENT TASK'S TCBMSS QUEUE                          */ 05109000
*/********************************************************************/ 05110000
*/*                                                                  */ 05111000
*/*    SUBROUTINE RTN2 RECONSTRUCTS THE CURRENT TASK'S (ATTACHOR'S)  */ 05112000
*/*    TCBMSS QUEUE                                                  */ 05113000
*/*                                                                  */ 05114000
*/*    SUBROUTINES CALLED: NONE                                      */ 05115000
*/*                                                                  */ 05116000
*/*    SYSTEM MACROS ISSUED: NONE                                    */ 05117000
*/*                                                                  */ 05118000
*/*    RETURN CODES SET: NONE                                        */ 05119000
*/*                                                                  */ 05120000
*/*    LEVEL - 2                                                     */ 05121000
*/*                                                                  */ 05122000
*/********************************************************************/ 05123000
*/* E ENTER RTN2                                                     */ 05124000
*                                                                  1491 05125000
*   RFY                                                            1491 05126000
*     R2WORK RSTD;                  /* SAVE FOR CALLING ROUTINE      */ 05127000
*   RFY                                                            1492 05128000
*     R14RET RSTD;                                                 1492 05129000
*   RFY                                                            1493 05130000
*     R7WORK RSTD;                                                 1493 05131000
*   RFY                                                            1494 05132000
*     R11WORK RSTD;                 /*                       @Z30ENVB*/ 05133000
*/* P GET QUEUE CHAINING FIELD ADDRESS (ADDRESS OF TCBMSS)           */ 05134000
*                                                                  1495 05135000
*   R11WORK=ADDR(R5NEWTCB->TCBMSSB);/* MAINTAIN PRECEEDING CHAINING     05136000
*                                      FIELD ADDRESS         @ZA10775*/ 05137000
         LA    R11WORK,TCBMSSB(,R5NEWTCB)                          1495 05138000
*/* P GET NEW TCB TCBMSS QUEUE PTR  (FIRST SPQE PTR)                 */ 05139000
*                                                                  1496 05140000
*   R7WORK=R5NEWTCB->TCBMSSB;       /* PTR TO FIRST SPQE             */ 05141000
         SLR   R7WORK,R7WORK                                       1496 05142000
         ICM   R7WORK,7,TCBMSSB(R5NEWTCB)                          1496 05143000
*   DO WHILE(R7WORKÂ¬=ZERO);         /* DO000076: PROCESS ALL SPQE'S  */ 05144000
         B     @DE01497                                            1497 05145000
@DL01497 DS    0H                                                  1498 05146000
*/* %FL01970: D (YES,%FL01960,NO,) IS SPQE PTR ZERO ?                */ 05147000
*/* D (NO,AT001680,YES,) IS SPQE NOT OWNED ?                         */ 05148000
*                                                                  1498 05149000
*     IF R7WORK->SPSHARE='1'B THEN                                 1498 05150000
         TM    SPSHARE(R7WORK),B'10000000'                         1498 05151000
         BNO   @RF01498                                            1498 05152000
*       DO;                         /* DO000078                      */ 05153000
*/* CHECK IF SPQE WAS SHARED BY ATTACHOR, GIVEN TO NEW TASK          */ 05154000
*/* P GET CURRENT TCB'S TCBMSS QUEUE PTR                             */ 05155000
*                                                                  1500 05156000
*         RFY                                                      1500 05157000
*           R15WORK RSTD;                                          1500 05158000
*         R15WORK=R4CURTCB->TCBMSSB;/* PTR TO FIRST SPQE             */ 05159000
         SLR   R15WORK,R15WORK                                     1501 05160000
         ICM   R15WORK,7,TCBMSSB(R4CURTCB)                         1501 05161000
*         DO WHILE(R15WORKÂ¬=ZERO);  /* DO000079: CHECK ALL SPQES     */ 05162000
         B     @DE01502                                            1502 05163000
@DL01502 DS    0H                                                  1503 05164000
*/* %FL02000: D (YES,AT001685,NO,) IS SPQE PTR = 0 ?                 */ 05165000
*/* D (YES,AT001660,NO,) DOES ATTACHOR'S SPQE ID MATCH NEW TCB'S ?   */ 05166000
*                                                                  1503 05167000
*           IF R15WORK->SPQEID=R7WORK->SPQEID THEN                 1503 05168000
         CLC   SPQEID(1,R15WORK),SPQEID(R7WORK)                    1503 05169000
         BE    @RT01503                                            1503 05170000
*             GOTO AT001660;        /* NO RECHAINING NECESSARY       */ 05171000
*/* P (,%FL02000) GET PTR TO NEXT SPQE ON CURRENT TASK'S QUEUE       */ 05172000
*                                                                  1505 05173000
*           R15WORK=R15WORK->SPQEPTR;/* NEXT SPQE                    */ 05174000
         L     R15WORK,SPQEPTR(,R15WORK)                           1505 05175000
*         END;                      /* END00079                      */ 05176000
@DE01502 LTR   R15WORK,R15WORK                                     1506 05177000
         BNZ   @DL01502                                            1506 05178000
*/* AT001685: P GET CURRENT TCB'S DUMMY TCBMSS QUEUE PTR             */ 05179000
*                                                                  1507 05180000
*AT001685:                                                         1507 05181000
*         R15WORK=WKTCBMSS;         /* PTR TO FIRST SPQE     @Z30ENVB*/ 05182000
AT001685 L     R15WORK,WKTCBMSS(,R12SVRB)                          1507 05183000
*         DO WHILE(R15WORKÂ¬=ZERO);  /* DO000077: CHECK ALL SPQES   1508 05184000
*                                                            @Z30ENVB*/ 05185000
         B     @DE01508                                            1508 05186000
@DL01508 DS    0H                                                  1509 05187000
*/* %FL02050: D (YES,AT001680,NO,) IS SPQE PTR = 0 ?                 */ 05188000
*/* D (YES,AT001660,NO,) DOES SPQE ID MATCH NEW TCB'S ?              */ 05189000
*                                                                  1509 05190000
*           IF R15WORK->SPQEID=R7WORK->SPQEID THEN/*         @Z30ENVB*/ 05191000
         CLC   SPQEID(1,R15WORK),SPQEID(R7WORK)                    1509 05192000
         BE    @RT01509                                            1509 05193000
*             GOTO AT001660;        /* NO RECHAINING NECESSARY     1510 05194000
*                                                            @Z30ENVB*/ 05195000
*/* P (,%FL02050) GET PTR TO NEXT SPQE ON DUMMY TCBMSS QUEUE         */ 05196000
*                                                                  1511 05197000
*           R15WORK=R15WORK->SPQEPTR;/* NEXT SPQE            @Z30ENVB*/ 05198000
         L     R15WORK,SPQEPTR(,R15WORK)                           1511 05199000
*         END;                      /* END00077              @Z30ENVB*/ 05200000
@DE01508 LTR   R15WORK,R15WORK                                     1512 05201000
         BNZ   @DL01508                                            1512 05202000
*         RFY                                                      1513 05203000
*           R15WORK UNRSTD;         /*                       @Z30ENVB*/ 05204000
*                                                                  1513 05205000
*         /***********************************************************/ 05206000
*         /*                                                         */ 05207000
*         /* FALL THROUGH LOOP MEANS SPQE ON NEW TASK'S QUEUE WAS    */ 05208000
*         /* RESULT OF GIVE SHARED-NOT-OWNED SUBPOOL REQUEST. THIS   */ 05209000
*         /* SPQE MUST BE RECHAINED OFF CURRENT.                     */ 05210000
*         /*                                                         */ 05211000
*         /***********************************************************/ 05212000
*                                                                  1514 05213000
*       END;                        /* END00078                      */ 05214000
*                                                                  1515 05215000
*     /***************************************************************/ 05216000
*     /*                                                             */ 05217000
*     /* THE NEW TCB'S SPQE WHICH IS BEING PROCESSED WAS GIVEN TO THE*/ 05218000
*     /* NEW TASK. IT MUST BE RECHAINED OFF THE CURRENT TCB'S TCBMSS */ 05219000
*     /* QUEUE. EITHER THE SPQE WAS A RESULT OF GIVING A             */ 05220000
*     /* SHARED-NOT-OWNED SUBPOOL, OR GIVING AN OWNED-NOT-SHARED     */ 05221000
*     /* SUBPOOL.                                                    */ 05222000
*     /*                                                             */ 05223000
*     /***************************************************************/ 05224000
*                                                                  1515 05225000
*/* AT001680: P (,%FL01970) RECHAIN SPQE FROM NEW TCB TO CURRENT TCB,   05226000
*/* GET NEXT OFF NEW TCB                                             */ 05227000
*                                                                  1515 05228000
*     /***************************************************************/ 05229000
*     /*                                                             */ 05230000
*     /* REMOVE SPQE FROM NEW TCB'S TCBMSS QUEUE.                    */ 05231000
*     /*                                                             */ 05232000
*     /***************************************************************/ 05233000
*                                                                  1515 05234000
*AT001680:                          /*                       @Z30ENVB*/ 05235000
*     R11WORK->BYTES123=R7WORK->SPQEPTR;/* UNCHAIN           @Z30ENVB*/ 05236000
@RF01498 DS    0H                                                  1515 05237000
AT001680 MVC   BYTES123(3,R11WORK),SPQEPTR+1(R7WORK)               1515 05238000
*     IF R7WORK->LASTSPQE='1'B THEN /* LAST SPQE ?           @Z30ENVB*/ 05239000
         TM    LASTSPQE(R7WORK),B'01000000'                        1516 05240000
         BNO   @RF01516                                            1516 05241000
*       IF R11WORKÂ¬=ADDR(R5NEWTCB->TCBMSS) THEN/* YES, MOTHER QUEUE     05242000
*                                      EMPTY ?               @Z30ENVB*/ 05243000
         LA    @15,TCBMSS(,R5NEWTCB)                               1517 05244000
         CR    R11WORK,@15                                         1517 05245000
         BE    @RF01517                                            1517 05246000
*         R11WORK->LASTSPQE='1'B;   /* INSURE END OF QUEUE PROPERLY     05247000
*                                      FLAGGED               @Z30ENVB*/ 05248000
*                                                                  1518 05249000
         OI    LASTSPQE(R11WORK),B'01000000'                       1518 05250000
*     /***************************************************************/ 05251000
*     /*                                                             */ 05252000
*     /* RECHAIN OFF CURRENT TCB. IF NEW TCB'S QUEUE IS EMPTY, SET   */ 05253000
*     /* END-OF-QUEUE INDICATOR. OTHERWISE, SET INDICATOR OFF, AND   */ 05254000
*     /* CHAIN TO NEXT SPQE.                                         */ 05255000
*     /*                                                             */ 05256000
*     /***************************************************************/ 05257000
*                                                                  1519 05258000
*     RFY                                                          1519 05259000
*       R8WORK RSTD;                                               1519 05260000
@RF01517 DS    0H                                                  1519 05261000
@RF01516 DS    0H                                                  1520 05262000
*     R8WORK=R7WORK;                /* SAVE ADDRESS OF THIS SPQE     */ 05263000
         LR    R8WORK,R7WORK                                       1520 05264000
*     R7WORK=R8WORK->SPQEPTR;       /* GET ADDR NEXT SPQE OFF NEW TCB*/ 05265000
         L     R7WORK,SPQEPTR(,R8WORK)                             1521 05266000
*     IF R4CURTCB->TCBMSSB=ZERO THEN/* IS QUEUE EMPTY ?              */ 05267000
         ICM   @15,7,TCBMSSB(R4CURTCB)                             1522 05268000
         BNZ   @RF01522                                            1522 05269000
*       DO;                         /* DO000080                      */ 05270000
*         R8WORK->LASTSPQE='1'B;    /* END-OF-QUEUE                  */ 05271000
         OI    LASTSPQE(R8WORK),B'01000000'                        1524 05272000
*         R8WORK->SPQEPTR=ZERO;     /* NO NEXT SPQE ON CURRENT       */ 05273000
         SLR   @15,@15                                             1525 05274000
         ST    @15,SPQEPTR(,R8WORK)                                1525 05275000
*       END;                        /* END00080                      */ 05276000
*     ELSE                          /* QUEUE IS NOT EMPTY            */ 05277000
*       DO;                         /* DO000081                      */ 05278000
         B     @RC01522                                            1527 05279000
@RF01522 DS    0H                                                  1528 05280000
*         R8WORK->LASTSPQE='0'B;    /* NOT END                       */ 05281000
         NI    LASTSPQE(R8WORK),B'10111111'                        1528 05282000
*         R8WORK->SPQEPTR=R4CURTCB->TCBMSSB;/* NEXT SPQE             */ 05283000
         SLR   @15,@15                                             1529 05284000
         ICM   @15,7,TCBMSSB(R4CURTCB)                             1529 05285000
         ST    @15,SPQEPTR(,R8WORK)                                1529 05286000
*       END;                        /* END00081                      */ 05287000
*     R4CURTCB->TCBMSSB=R8WORK;     /* RECHAIN SPQE OFF CURRENT TCB  */ 05288000
@RC01522 STCM  R8WORK,7,TCBMSSB(R4CURTCB)                          1531 05289000
*     GOTO AT001670;                /* PTR TO NEXT AND PRECEEDING  1532 05290000
*                                      SPQE OFF NEW TCB ALREADY SET,    05291000
*                                      BYPASS RESET          @Z30ENVB*/ 05292000
         B     AT001670                                            1532 05293000
*     RFY                                                          1533 05294000
*       R8WORK UNRSTD;                                             1533 05295000
*                                                                  1533 05296000
*/* AT001660: P UPDATE QUEUE CHAINING FIELD ADDRESS                  */ 05297000
*                                                                  1534 05298000
*AT001660:                                                         1534 05299000
*     R11WORK=ADDR(R7WORK->SPQEPTR);/* PRECEEDING CHAINING FIELD   1534 05300000
*                                                            @Z30ENVB*/ 05301000
AT001660 LR    R11WORK,R7WORK                                      1534 05302000
*/* P (,%FL01970) GET PTR TO NEXT SPQE OFF NEW TASK                  */ 05303000
*                                                                  1535 05304000
*     R7WORK=R7WORK->SPQEPTR;       /* NEXT SPQE                     */ 05305000
         L     R7WORK,SPQEPTR(,R7WORK)                             1535 05306000
*AT001670:                          /* REPEAT LOOP                   */ 05307000
*   END;                            /* END00076                      */ 05308000
AT001670 DS    0H                                                  1536 05309000
@DE01497 LTR   R7WORK,R7WORK                                       1536 05310000
         BNZ   @DL01497                                            1536 05311000
*   RFY                                                            1537 05312000
*     R7WORK UNRSTD;                                               1537 05313000
*                                                                  1537 05314000
*/* %FL01960: R RETURN TO CALLING POINT                              */ 05315000
*                                                                  1538 05316000
*   END RTN2;                       /* END OF SUBROUTINE             */ 05317000
@EL00019 DS    0H                                                  1538 05318000
@EF00019 DS    0H                                                  1538 05319000
@ER00019 BR    @14                                                 1538 05320000
*/* RTN2: END FLOWCHART                                              */ 05321000
*                                                                  1539 05322000
*   RFY                                                            1539 05323000
*     R2WORK UNRSTD;                                               1539 05324000
*   RFY                                                            1540 05325000
*     R11WORK UNRSTD;               /*                       @Z30ENVB*/ 05326000
*   RFY                                                            1541 05327000
*     R14RET UNRSTD;                                               1541 05328000
*                                                                  1542 05329000
*   /*****************************************************************/ 05330000
*   /*                                                               */ 05331000
*   /* RTN3 CLEAN UP ROUTINE                                         */ 05332000
*   /*                                                               */ 05333000
*   /*****************************************************************/ 05334000
*                                                                  1542 05335000
*RTN3:                                                             1542 05336000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 05337000
RTN3     DS    0H                                                  1543 05338000
*/* RTN3: CHART  BEGIN FLOWCHART                                     */ 05339000
*/* FOOTING                                                        1543 05340000
*/* SCB / ETXR CLEAN UP                                              */ 05341000
*/********************************************************************/ 05342000
*/*                                                                  */ 05343000
*/*    SUBROUTINE RTN3 CLEANS UP STAI/ESTAI SCB'S BY INVOKING A      */ 05344000
*/*    RESOURCE MANAGER, AND PROCESSES ETXR IRB                      */ 05345000
*/*                                                                  */ 05346000
*/*    SUBROUTINES CALLED: NONE                                      */ 05347000
*/*                                                                  */ 05348000
*/*    SYSTEM MACROS ISSUED / ROUTINES CALLED: FREEMAIN BRANCH ENTRY */ 05349000
*/*                                           TASK RECOVERY RESOURCE */ 05350000
*/*                                           MANAGER                */ 05351000
*/*                                                                  */ 05352000
*/*    REGISTER USAGE: MUST PRESERVE REGISTER 2                      */ 05353000
*/*                                                                  */ 05354000
*/*    LEVEL - 2                                                     */ 05355000
*/*                                                                  */ 05356000
*/********************************************************************/ 05357000
*/* E ENTER RTN3                                                     */ 05358000
*                                                                  1543 05359000
*   RFY                                                            1543 05360000
*     R2WORK RSTD;                                                 1543 05361000
*   RFY                                                            1544 05362000
*     R7ASCB RSTD;                                                 1544 05363000
*   RFY                                                            1545 05364000
*     R11WORK RSTD;                                                1545 05365000
*   RFY                                                            1546 05366000
*     R14RET RSTD;                                                 1546 05367000
*                                                                  1546 05368000
*   /*****************************************************************/ 05369000
*   /*                                                               */ 05370000
*   /* SET REGISTERS FOR BRANCH ENTRY ROUTINES                       */ 05371000
*   /*                                                               */ 05372000
*   /*****************************************************************/ 05373000
*                                                                  1547 05374000
*   R7ASCB=PSAAOLD;                 /* ASCB ADDRESS                  */ 05375000
         L     R7ASCB,PSAAOLD                                      1547 05376000
*   R11WORK=R14RET;                 /* SAVE                          */ 05377000
         LR    R11WORK,R14RET                                      1548 05378000
*   RFY                                                            1549 05379000
*     R14RET UNRSTD;                                               1549 05380000
*                                                                  1549 05381000
*/* D (YES,%FL02000,NO,) IS NEW TCB'S TCBSTABB = 0 ?                 */ 05382000
*                                                                  1550 05383000
*   IF R5NEWTCB->TCBSTABBÂ¬=ZERO THEN                               1550 05384000
         ICM   @10,7,TCBSTABB(R5NEWTCB)                            1550 05385000
         BZ    @RF01550                                            1550 05386000
*     DO;                           /* DO000085                      */ 05387000
*       RFY                                                        1552 05388000
*         R10WORK RSTD;                                            1552 05389000
*       R10WORK=R4CURTCB;           /* SAVE                          */ 05390000
         LR    R10WORK,R4CURTCB                                    1553 05391000
*/* P SET ENTRY REGS FOR TRRM                                        */ 05392000
*                                                                  1554 05393000
*       RFY                                                        1554 05394000
*         R0WORK RSTD;                                             1554 05395000
*       RFY                                                        1555 05396000
*         R13WORK RSTD;                                            1555 05397000
*       R0WORK=ZERO;                /* ENTRY FROM ATTACH             */ 05398000
         SLR   R0WORK,R0WORK                                       1556 05399000
*       R4WORK=R5NEWTCB;            /* CALL IS FOR NEW TCB           */ 05400000
         LR    R4WORK,R5NEWTCB                                     1557 05401000
*       R13WORK=R3WORKAD;           /* 72 BYTE SAVE AREA REQUIRED    */ 05402000
         LR    R13WORK,R3WORKAD                                    1558 05403000
*/* L TASK RECOVERY RESOURCE MANAGER: CLEAN-UP (E)STAI SCB'S         */ 05404000
*                                                                  1559 05405000
*       RFY                                                        1559 05406000
*         R15WORK RSTD;                                            1559 05407000
*       R15WORK=CVTPTR;             /* ADDR OF CVTPTR                */ 05408000
         L     R15WORK,CVTPTR                                      1560 05409000
*       R15WORK=R15WORK->CVTSCBP;   /* ADDR OF TRRM (IEAVTSBP)       */ 05410000
         L     R15WORK,CVTSCBP(,R15WORK)                           1561 05411000
*       CALL R15WORK;               /* INVOKE TRRM                   */ 05412000
         BALR  @14,@15                                             1562 05413000
*       R4CURTCB=R10WORK;           /* RESTORE                       */ 05414000
         LR    R4CURTCB,R10WORK                                    1563 05415000
*       RFY                                                        1564 05416000
*         R0WORK UNRSTD;                                           1564 05417000
*       RFY                                                        1565 05418000
*         R13WORK UNRSTD;                                          1565 05419000
*       RFY                                                        1566 05420000
*         R15WORK UNRSTD;                                          1566 05421000
*     END;                          /* END00085                      */ 05422000
*/* %FL02000: D (NO,%FL02010,YES,) IS NEW TCB'S TCBIQE Â¬= 0 ?        */ 05423000
*                                                                  1568 05424000
*   IF R5NEWTCB->TCBIQEÂ¬=ZERO THEN                                 1568 05425000
@RF01550 L     @08,TCBIQE(,R5NEWTCB)                               1568 05426000
         LTR   @08,@08                                             1568 05427000
         BZ    @RF01568                                            1568 05428000
*     DO;                           /* DO000086                      */ 05429000
*       RFY                                                        1570 05430000
*         R8WORK RSTD;                                             1570 05431000
*       R8WORK=R5NEWTCB->TCBIQE->IQEIRB;/* IRB ADDRESS               */ 05432000
         L     @15,TCBIQE(,R5NEWTCB)                               1571 05433000
         L     R8WORK,IQEIRB(,@15)                                 1571 05434000
*/* D (YES,%FL02020,NO,) IS THE RELATED IRB'S USE COUNT = 1 ?        */ 05435000
*                                                                  1572 05436000
*       IF R8WORK->RBUSEÂ¬=ONE THEN                                 1572 05437000
*                                                                  1572 05438000
         CLI   RBUSE(R8WORK),1                                     1572 05439000
         BE    @RF01572                                            1572 05440000
*/* P (,%FL02010) DECREMENT IRB USE COUNT BY ONE                     */ 05441000
*                                                                  1573 05442000
*         R8WORK->RBUSE=R8WORK->RBUSE-ONE;/* USE COUNT -1            */ 05443000
         SLR   @15,@15                                             1573 05444000
         IC    @15,RBUSE(,R8WORK)                                  1573 05445000
         BCTR  @15,0                                               1573 05446000
         STC   @15,RBUSE(,R8WORK)                                  1573 05447000
*       ELSE                                                       1574 05448000
*         DO;                       /* DO000087                      */ 05449000
         B     @RC01572                                            1574 05450000
@RF01572 DS    0H                                                  1575 05451000
*/* %FL02020: L FREEMAIN: FREE IRB'S PROBLEM PROGRAM SAVE AREA       */ 05452000
*                                                                  1575 05453000
*           RFY                                                    1575 05454000
*             R0WORK RSTD;                                         1575 05455000
*           RFY                                                    1576 05456000
*             R1AREA RSTD;                                         1576 05457000
*           R10WORK=R3WORKAD;       /* SAVE                          */ 05458000
         LR    R10WORK,R3WORKAD                                    1577 05459000
*           R0WORK=SVAREA72;        /* SAVE AREA LENGTH              */ 05460000
         LA    R0WORK,72                                           1578 05461000
*           R1AREA=R8WORK->RBPPSAV1;/* SAVE AREA ADDRESS             */ 05462000
         SLR   R1AREA,R1AREA                                       1579 05463000
         ICM   R1AREA,7,RBPPSAV1(R8WORK)                           1579 05464000
*           GENERATE SETS(R0WORK,R1WORK,R3WORKAD,R14RET,R15RETCD) REFS( 05465000
*               R4WORK,R7ASCB);                                    1580 05466000
*                                                                  1580 05467000
         SPACE                                                          05468000
         FREEMAIN RC,LV=(0),A=(1),SP=SP250EQU,BRANCH=YES  FREE SAVEAREA 05469000
         SPACE                                                          05470000
*/* L FREEMAIN: FREE IRB                                             */ 05471000
*                                                                  1581 05472000
*           R0WORK=ADDR(IRBLEN);    /* IRB LENGTH                    */ 05473000
         LA    R0WORK,IRBLEN                                       1581 05474000
*           R1AREA=R8WORK;          /* IRB ADDRESS                   */ 05475000
         LR    R1AREA,R8WORK                                       1582 05476000
*           R7ASCB=PSAAOLD;         /* ASCB ADDRESS          @Z30ENVB*/ 05477000
         L     R7ASCB,PSAAOLD                                      1583 05478000
*           GENERATE SETS(R3WORKAD,R14RET,R15RETCD) REFS(R0WORK,R1WORK, 05479000
*               R4WORK,R7ASCB) NOFLOWS;                            1584 05480000
         SPACE                                                          05481000
         FREEMAIN RC,LV=(0),A=(1),SP=SP253EQU,BRANCH=YES  FREE IRB      05482000
         SPACE                                                          05483000
*           R3WORKAD=R10WORK;       /* RESTORE                       */ 05484000
         LR    R3WORKAD,R10WORK                                    1585 05485000
*         END;                      /* END00087                      */ 05486000
*     END;                          /* END00086                      */ 05487000
@RC01572 DS    0H                                                  1588 05488000
*/* %FL02010: R RETURN TO CALLING POINT                              */ 05489000
*                                                                  1588 05490000
*   RFY                                                            1588 05491000
*     R14RET RSTD;                                                 1588 05492000
@RF01568 DS    0H                                                  1589 05493000
*   R14RET=R11WORK;                 /* RESTORE                       */ 05494000
         LR    R14RET,R11WORK                                      1589 05495000
*/* RTN3: END FLOWCHART                                              */ 05496000
*                                                                  1590 05497000
*   END RTN3;                       /* END OF SUBROUTINE             */ 05498000
@EL00020 DS    0H                                                  1590 05499000
@EF00020 DS    0H                                                  1590 05500000
@ER00020 BR    @14                                                 1590 05501000
*   RFY                                                            1591 05502000
*     R0WORK UNRSTD;                                               1591 05503000
*   RFY                                                            1592 05504000
*     R1AREA UNRSTD;                                               1592 05505000
*   RFY                                                            1593 05506000
*     R14RET UNRSTD;                                               1593 05507000
*   RFY                                                            1594 05508000
*     R2WORK UNRSTD;                                               1594 05509000
*   RFY                                                            1595 05510000
*     R7ASCB UNRSTD;                                               1595 05511000
*   RFY                                                            1596 05512000
*     R8WORK UNRSTD;                                               1596 05513000
*   RFY                                                            1597 05514000
*     R10WORK UNRSTD;                                              1597 05515000
*   RFY                                                            1598 05516000
*     R11WORK UNRSTD;                                              1598 05517000
*                                                                  1599 05518000
*   /*****************************************************************/ 05519000
*   /*                                                               */ 05520000
*   /* FREESPQE SUBROUTINE                                           */ 05521000
*   /*                                                               */ 05522000
*   /*****************************************************************/ 05523000
*                                                                  1599 05524000
*FREESPQE:                                                         1599 05525000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT      @Z30ENVB*/ 05526000
FREESPQE DS    0H                                                  1600 05527000
*/* FREESPQE: CHART BEGIN FLOWCHART                                  */ 05528000
*/* FOOTING                                                        1600 05529000
*/* SPQE CLEAN UP                                                    */ 05530000
*/********************************************************************/ 05531000
*/*                                                                  */ 05532000
*/*    SUBROUTINE FREESPQE FREES SPQE STORAGE BUILT FOR THE          */ 05533000
*/*    NEW AND/OR CURRENT TCB                                        */ 05534000
*/*                                                                  */ 05535000
*/*    SUBROUTINES CALLED: NONE                                      */ 05536000
*/*                                                                  */ 05537000
*/*    CALLED BY: RTN1                                               */ 05538000
*/*                                                                  */ 05539000
*/*    SYSTEM MACROS ISSUED: FREEMAIN                                */ 05540000
*/*                                                                  */ 05541000
*/*    RETURN CODES SET: NONE                                        */ 05542000
*/*                                                                  */ 05543000
*/*    REGISTER USAGE: R2WORK - RETURN POINT FOR CALLING ROUTINE     */ 05544000
*/*                    R7ASCB - ASCB ADDR                            */ 05545000
*/*                    R8WORK - SPQE PTR                             */ 05546000
*/*                    R10WORK - SPQE TO BE FREED                    */ 05547000
*/*                    R11WORK - RETURN POINT TO CALLING ROUTINE     */ 05548000
*/*                                                                  */ 05549000
*/*    LEVEL - 2                                                     */ 05550000
*/*                                                                  */ 05551000
*/*    NOTES: FREEMAIN MACRO DESTROYS REGISTERS 0,1,14,15            */ 05552000
*/*                                                                  */ 05553000
*/********************************************************************/ 05554000
*/* E ENTER FREESPQE                                                 */ 05555000
*                                                                  1600 05556000
*   RFY                                                            1600 05557000
*     R2WORK RSTD;                  /* SAVE FOR CALLING ROUTINE    1600 05558000
*                                                            @Z30ENVB*/ 05559000
*   RFY                                                            1601 05560000
*     R7ASCB RSTD;                  /*                       @Z30ENVB*/ 05561000
*   RFY                                                            1602 05562000
*     R8WORK RSTD;                  /*                       @Z30ENVB*/ 05563000
*   RFY                                                            1603 05564000
*     R10WORK RSTD;                 /*                       @Z30ENVB*/ 05565000
*   RFY                                                            1604 05566000
*     R11WORK RSTD;                 /*                       @Z30ENVB*/ 05567000
*   RFY                                                            1605 05568000
*     R14RET RSTD;                  /*                       @Z30ENVB*/ 05569000
*   R11WORK=R14RET;                 /* SAVE RETURN ADDR      @Z30ENVB*/ 05570000
         LR    R11WORK,R14RET                                      1606 05571000
*   DO UNTIL(R8WORK=ZERO);          /* DO000130: PROCESS ALL SPQES 1607 05572000
*                                                            @Z30ENVB*/ 05573000
@DL01607 DS    0H                                                  1608 05574000
*/* %FL02040: P UNCHAIN SPQE TO BE FREED                             */ 05575000
*                                                                  1608 05576000
*     R10WORK=R8WORK;               /* SPQE TO BE FREED      @Z30ENVB*/ 05577000
         LR    R10WORK,R8WORK                                      1608 05578000
*     R8WORK=R8WORK->SPQEPTR;       /* GET NEXT SPQE PTR     @Z30ENVB*/ 05579000
         L     R8WORK,SPQEPTR(,R8WORK)                             1609 05580000
*/* S FREEMAIN: FREE SPQE STORAGE                                    */ 05581000
*                                                                  1610 05582000
*     R7ASCB=PSAAOLD;               /* ADDR OF CURRENT ASCB  @Z30ENVB*/ 05583000
         L     R7ASCB,PSAAOLD                                      1610 05584000
*     GENERATE REFS(R7ASCB,R10WORK,CVTCBBR);                       1611 05585000
*                                                                  1611 05586000
      SPACE                                                             05587000
      FREEMAIN P,A=(R10WORK),BRANCH=YES                      @Z30ENVB   05588000
      SPACE                                                             05589000
*/* D (NO,%FL02040,YES,) SPQE PTR ZERO ?                             */ 05590000
*                                                                  1612 05591000
*   END;                            /* END00130              @Z30ENVB*/ 05592000
@DE01607 LTR   R8WORK,R8WORK                                       1612 05593000
         BNZ   @DL01607                                            1612 05594000
*/* R RETURN TO CALLING POINT                                        */ 05595000
*                                                                  1613 05596000
*   R14RET=R11WORK;                 /* RESORE RETURN ADDR    @Z30ENVB*/ 05597000
         LR    R14RET,R11WORK                                      1613 05598000
*/* FREESPQE: END FLOWCHART                                          */ 05599000
*                                                                  1614 05600000
*   END FREESPQE;                   /* END OF SUBROUTINE     @Z30ENVB*/ 05601000
@EL00021 DS    0H                                                  1614 05602000
@EF00021 DS    0H                                                  1614 05603000
@ER00021 BR    @14                                                 1614 05604000
*   RFY                                                            1615 05605000
*     R2WORK UNRSTD;                /*                       @Z30ENVB*/ 05606000
*   RFY                                                            1616 05607000
*     R7ASCB UNRSTD;                /*                       @Z30ENVB*/ 05608000
*   RFY                                                            1617 05609000
*     R8WORK UNRSTD;                /*                       @Z30ENVB*/ 05610000
*   RFY                                                            1618 05611000
*     R10WORK UNRSTD;               /*                       @Z30ENVB*/ 05612000
*   RFY                                                            1619 05613000
*     R11WORK UNRSTD;               /*                       @Z30ENVB*/ 05614000
*   RFY                                                            1620 05615000
*     R14RET UNRSTD;                /*                       @Z30ENVB*/ 05616000
*                                                                  1621 05617000
*   /*****************************************************************/ 05618000
*   /*                                                               */ 05619000
*   /* FRR                                                           */ 05620000
*   /*                                                               */ 05621000
*   /*****************************************************************/ 05622000
*                                                                  1621 05623000
*IGC042R2:                                                         1621 05624000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                   @Y02753*/ 05625000
IGC042R2 DS    0H                                                  1622 05626000
*/* IGC042R2: CHART                                                  */ 05627000
*/* FOOTING                                                        1622 05628000
*/* FUNCTIONAL RECOVERY ROUTINE                                      */ 05629000
*/********************************************************************/ 05630000
*/*                                                                  */ 05631000
*/* IGC042R2 IS AN FRR FOR ATTACH, IN EFFECT WHEN THE LOCAL LOCK IS  */ 05632000
*/* HELD. THE FRR IS ENTERED UNDER NORMAL PROCESSING THROUGH USER    */ 05633000
*/* PARAMETER VALIDITY CHECKING, FOR WHICH CASE IT RESETS THE        */ 05634000
*/* COMPLETION CODE TO 72A (INVALID PARAMETER LIST) OR 42A (INVALID  */ 05635000
*/* ECB), AS APPROPRIATE, AND PERCOLATES.                            */ 05636000
*/*                                                                  */ 05637000
*/* FOR ERROR ENTRY, THE FRR RECORDS THE PERMANENT WORKAREA IN THE   */ 05638000
*/* OUTPUT DATA AREA, VALIDATES THE TCB QUEUES, AND PERCOLATES.      */ 05639000
*/*                                                                  */ 05640000
*/* IN EITHER CASE, THE ESTAE EXIT IS ENTERED TO PERFORM BACKOUT     */ 05641000
*/* PROCESSING.                                                      */ 05642000
*/*                                                                  */ 05643000
*/* SUBROUTINES CALLED: NONE                                         */ 05644000
*/*                                                                  */ 05645000
*/* SYSTEM ROUTINES CALLED / MACROS ISSUED: IGC044R2, SETRP          */ 05646000
*/*                                                                  */ 05647000
*/* RETURN CODES SET: X00NRTRY                                       */ 05648000
*/*                                                                  */ 05649000
*/* REGISTER USAGE: R0WORK - INPUT, ADDRESS OF A 200 BYTE WORKAREA   */ 05650000
*/* R1AREA - INPUT, ADDRESS OF AN SDWA (FIELD SDWAPARM ADDRESSES     */ 05651000
*/*          THE 6 WORD FRR WORKAREA (SEE STRUCTURE ATTFRRWA), WHICH */ 05652000
*/*          IN TURN ADDRESSES WKEXSAVE).                            */ 05653000
*/*                                                                  */ 05654000
*/* NOTE - THIS ROUTINE LOSES ITS ADDRESSABILITY FOLLOWING           */ 05655000
*/*        CALL TO IGC044R2; MUST BE REESTABLISHED IF NEEDED.        */ 05656000
*/*                                                                  */ 05657000
*/********************************************************************/ 05658000
*/* E ENTER IGC042R2                                                 */ 05659000
*                                                                  1622 05660000
*   RFY                                                            1622 05661000
*     R1AREA RSTD;                                                 1622 05662000
*   RFY                                                            1623 05663000
*     R14RET RSTD;                                                 1623 05664000
*   RFY                                                            1624 05665000
*     R15WORK RSTD;                                                1624 05666000
*   RFY                                                            1625 05667000
*     R10WORK RSTD;                                                1625 05668000
*   R10WORK=R15WORK;                /* ENTRY ADDRESS          @Y02753*/ 05669000
         LR    R10WORK,R15WORK                                     1626 05670000
*   GEN(USING IGC042R2,R10WORK);    /* ADDRESSABILITY         @Y02753*/ 05671000
         USING IGC042R2,R10WORK                                         05672000
*   RFY                                                            1628 05673000
*     R15WORK UNRSTD;                                              1628 05674000
*                                                                  1628 05675000
*/* D (NO,AT001740,YES,) DID ERROR OCCUR IN CURRENT ADDRESS SPACE    */ 05676000
*                                                                  1629 05677000
*   IF R1AREA->SDWAFMIDÂ¬=ZERO THEN  /*                        @Y02753*/ 05678000
         SLR   @15,@15                                             1629 05679000
         SLR   @11,@11                                             1629 05680000
         ICM   @11,3,SDWAFMID(R1AREA)                              1629 05681000
         CR    @15,@11                                             1629 05682000
         BNE   @RT01629                                            1629 05683000
*     GOTO AT001740;                /* GO EXIT, PERCOLATING   @Y02753*/ 05684000
*/* D (YES,AT001740,NO,) HAS RECURSION OCCURRED ?                    */ 05685000
*                                                                  1631 05686000
*   R12SVRB=R1AREA->SDWAPARM->ATFRRW1;/* RESET PERM WORKADDR  @Y02753*/ 05687000
         L     @11,SDWAPARM(,R1AREA)                               1631 05688000
         L     R12SVRB,ATFRRW1(,@11)                               1631 05689000
*   IF WKFRRSW='1'B THEN            /* RECURSION ?            @Y02753*/ 05690000
         TM    WKFRRSW(R12SVRB),B'01000000'                        1632 05691000
         BO    @RT01632                                            1632 05692000
*     GOTO AT001740;                /* GO EXIT, PERCOLATING   @Y02753*/ 05693000
*/* P INDICATE FRR HAS BEEN ENTERED                                  */ 05694000
*                                                                  1634 05695000
*   WKFRRSW='1'B;                   /* FOR ESTAE EXIT, AND RECURSION    05696000
*                                      CONTROL                @Y02753*/ 05697000
         OI    WKFRRSW(R12SVRB),B'01000000'                        1634 05698000
*/* D (NO,AT001750,YES,) ENTRY DUE TO VALIDITY CHECK ?               */ 05699000
*                                                                  1635 05700000
*   IF(((R1AREA->SDWAMWP1)&KEYMASK)Â¬=ZERO)&(R1AREA->SDWAPCHK='1'B) THEN 05701000
         LA    @11,240                                             1635 05702000
         SLR   @08,@08                                             1635 05703000
         IC    @08,SDWAMWP1(,R1AREA)                               1635 05704000
         NR    @11,@08                                             1635 05705000
         CR    @11,@15                                             1635 05706000
         BE    @RF01635                                            1635 05707000
         TM    SDWAPCHK(R1AREA),B'01000000'                        1635 05708000
         BNO   @RF01635                                            1635 05709000
*     DO;                           /* DO000101               @Y02753*/ 05710000
*/* P INDICATE NO RECORDING                                          */ 05711000
*                                                                  1637 05712000
*       DO;                         /* SETRP RECORD(NO)DUMP(YES)     */ 05713000
*         RESPECIFY                                                1638 05714000
*          (GPR00P,                                                1638 05715000
*           GPR01P,                                                1638 05716000
*           GPR14P,                                                1638 05717000
*           GPR15P) RSTD;                                          1638 05718000
*         GPR01P->SDWARCDE=0;       /* SAVE RC VALUE                 */ 05719000
         MVI   SDWARCDE(GPR01P),X'00'                              1639 05720000
*         GPR01P->SDWARCRD='0'B;    /* TURN OFF RECORD INDICATOR     */ 05721000
         NI    SDWARCRD(GPR01P),B'01111111'                        1640 05722000
*         GPR01P->SDWAREQ='1'B;     /* TURN ON DUMP INDICATOR        */ 05723000
         OI    SDWAREQ(GPR01P),B'10000000'                         1641 05724000
*         RESPECIFY                                                1642 05725000
*          (GPR00P,                                                1642 05726000
*           GPR01P,                                                1642 05727000
*           GPR14P,                                                1642 05728000
*           GPR15P) UNRSTD;                                        1642 05729000
*       END;                        /*                        @Y02753*/ 05730000
*/* D (NO,%FL06000,YES,) IS ECB INVALID ?                            */ 05731000
*                                                                  1644 05732000
*       IF WKECBSW='1'B THEN        /*                        @Y02753*/ 05733000
         TM    WKECBSW(R12SVRB),B'00100000'                        1644 05734000
         BNO   @RF01644                                            1644 05735000
*/* P (,AT001740) RESET COMP CODE TO 42A                             */ 05736000
*                                                                  1645 05737000
*         R1AREA->SDWACMPC=ABEND42A;/* ABEND, INVALID ECB     @Y02753*/ 05738000
         MVI   SDWACMPC+2(R1AREA),X'00'                            1645 05739000
         MVC   SDWACMPC(2,R1AREA),@CB02704                         1645 05740000
*       ELSE                        /*                        @Y02753*/ 05741000
*/* %FL06000: P (,AT001740) RESET COMP CODE TO 72A                   */ 05742000
*                                                                  1646 05743000
*         R1AREA->SDWACMPC=ABEND72A;/* ABEND, INVALID PARMS   @Y02753*/ 05744000
         B     @RC01644                                            1646 05745000
@RF01644 MVI   SDWACMPC+2(R1AREA),X'00'                            1646 05746000
         MVC   SDWACMPC(2,R1AREA),@CB02708                         1646 05747000
*     END;                          /* END00101               @Y02753*/ 05748000
*   ELSE                            /* NOT VALIDITY CHECK     @Y02753*/ 05749000
*     DO;                           /* DO000102               @Y02753*/ 05750000
         B     @RC01635                                            1648 05751000
@RF01635 DS    0H                                                  1649 05752000
*/* AT001750: P SET RECORDING PARMS                                  */ 05753000
*                                                                  1649 05754000
*AT001750:                                                         1649 05755000
*       DO;                         /* SETRP                       1649 05756000
*                                      RECPARM(ATFRRID)RECORD(YES)   */ 05757000
AT001750 DS    0H                                                  1650 05758000
*         RESPECIFY                                                1650 05759000
*          (GPR00P,                                                1650 05760000
*           GPR01P,                                                1650 05761000
*           GPR14P,                                                1650 05762000
*           GPR15P) RSTD;                                          1650 05763000
*         GPR01P->SDWARCDE=0;       /* SAVE RC VALUE                 */ 05764000
         MVI   SDWARCDE(GPR01P),X'00'                              1651 05765000
*         GPR01P->SDWARCRD='1'B;    /* TURN ON RECORD INDICATOR      */ 05766000
         OI    SDWARCRD(GPR01P),B'10000000'                        1652 05767000
*         GPR15P=ADDR(ATFRRID);     /* ACCESS RECORD PARAMETER LIST  */ 05768000
         LA    GPR15P,ATFRRID                                      1653 05769000
*         GPR01P->SDWARECP=GPR15P->I256C(1:24);/* COPY RECORD      1654 05770000
*                                      PARAMETERS                    */ 05771000
         MVC   SDWARECP(24,GPR01P),I256C(GPR15P)                   1654 05772000
*         RESPECIFY                                                1655 05773000
*          (GPR00P,                                                1655 05774000
*           GPR01P,                                                1655 05775000
*           GPR14P,                                                1655 05776000
*           GPR15P) UNRSTD;                                        1655 05777000
*       END;                        /*                        @Y02753*/ 05778000
*/* P MOVE WORKAREA CONTROL FIELDS INTO OUTPUT DATA AREA             */ 05779000
*                                                                  1657 05780000
*       RFY                                                        1657 05781000
*         R7WORK RSTD;                                             1657 05782000
*       RFY                                                        1658 05783000
*         R8WORK RSTD;                                             1658 05784000
*       R7WORK=R1AREA->SDWAVRAL;    /* LENGTH OF OUTPUT AREA  @Y02753*/ 05785000
         SLR   R7WORK,R7WORK                                       1659 05786000
         ICM   R7WORK,3,SDWAVRAL(R1AREA)                           1659 05787000
*       R8WORK=LENGTH(WKCONTRL);    /* LENGTH PERM WORKAREA   @Y02753*/ 05788000
         LA    R8WORK,24                                           1660 05789000
*       IF R7WORK<R8WORK THEN       /* WILL WORKAREA FIT      @Y02753*/ 05790000
         CR    R7WORK,R8WORK                                       1661 05791000
         BNL   @RF01661                                            1661 05792000
*         R8WORK=R7WORK;            /* LENGTH AVAILABLE       @Y02753*/ 05793000
         LR    R8WORK,R7WORK                                       1662 05794000
*       R1AREA->SDWAVRA(1:R8WORK)=WKCONTRL;/* PERM WORKAREA   @Y02753*/ 05795000
@RF01661 LR    @15,R8WORK                                          1663 05796000
         BCTR  @15,0                                               1663 05797000
         EX    @15,@SM03155                                        1663 05798000
*       R1AREA->SDWAURAL=R8WORK;    /* LENGTH RECORDED        @Y02753*/ 05799000
         STC   R8WORK,SDWAURAL(,R1AREA)                            1664 05800000
*/* L IGC044R2: VALIDATE TCB QUEUES                                  */ 05801000
*                                                                  1665 05802000
*       RFY                                                        1665 05803000
*         R2WORK RSTD;                                             1665 05804000
*       R2WORK=ADDR(ATIDLNG);       /* ADDRESS OF HEADER FOR SVC DUMP   05805000
*                                                             @Y02753*/ 05806000
         LA    R2WORK,ATIDLNG                                      1666 05807000
*       R9SAVE=R14RET;              /* SAVE RETURN ADDRESS    @Y02753*/ 05808000
         LR    R9SAVE,R14RET                                       1667 05809000
*       CALL IGC044R2;              /* INVOKE TCB VALIDATING RTN (ALL   05810000
*                                      REGISTERS EXCEPT 0,1,9,14   1668 05811000
*                                      VOLATILE, MUST REESTABLISH  1668 05812000
*                                      ADDRESSABILITY IF NEEDED)   1668 05813000
*                                                             @Y02753*/ 05814000
         L     @11,CVTPTR                                          1668 05815000
         L     @15,CVT044R2(,@11)                                  1668 05816000
         BALR  @14,@15                                             1668 05817000
*       GEN(DROP  R10WORK);         /* REG 10 CONTENTS CHANGED     1669 05818000
*                                                             @Y02753*/ 05819000
         DROP  R10WORK                                                  05820000
*       R14RET=R9SAVE;              /* RESTORE RETURN ADDRESS @Y02753*/ 05821000
         LR    R14RET,R9SAVE                                       1670 05822000
*       RFY                                                        1671 05823000
*         R2WORK UNRSTD;                                           1671 05824000
*     END;                          /* END00102               @Y02753*/ 05825000
*/* AT001740: R RETURN TO RTM (PERCOLATE ERROR)                      */ 05826000
*                                                                  1673 05827000
*AT001740:                                                         1673 05828000
*   DO;                             /* SETRP RC(0)                   */ 05829000
@RC01635 DS    0H                                                  1673 05830000
AT001740 DS    0H                                                  1674 05831000
*     RESPECIFY                                                    1674 05832000
*      (GPR00P,                                                    1674 05833000
*       GPR01P,                                                    1674 05834000
*       GPR14P,                                                    1674 05835000
*       GPR15P) RSTD;                                              1674 05836000
*     GPR01P->SDWARCDE=0;           /* SAVE RC VALUE                 */ 05837000
         MVI   SDWARCDE(GPR01P),X'00'                              1675 05838000
*     RESPECIFY                                                    1676 05839000
*      (GPR00P,                                                    1676 05840000
*       GPR01P,                                                    1676 05841000
*       GPR14P,                                                    1676 05842000
*       GPR15P) UNRSTD;                                            1676 05843000
*   END;                            /*                        @Y02753*/ 05844000
*   END IGC042R2;                   /*                        @Y02753*/ 05845000
@EL00022 DS    0H                                                  1678 05846000
@EF00022 DS    0H                                                  1678 05847000
@ER00022 BR    @14                                                 1678 05848000
*/* IGC042R2: END FLOWCHART                                          */ 05849000
*                                                                  1679 05850000
*   RFY                                                            1679 05851000
*     R1AREA UNRSTD;                                               1679 05852000
*   RFY                                                            1680 05853000
*     R14RET UNRSTD;                                               1680 05854000
*                                                                  1681 05855000
*   /*****************************************************************/ 05856000
*   /*                                                               */ 05857000
*   /* ESTAE EXIT                                                    */ 05858000
*   /*                                                               */ 05859000
*   /*****************************************************************/ 05860000
*                                                                  1681 05861000
*IGC042ES:                                                         1681 05862000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                   @Y02753*/ 05863000
IGC042ES DS    0H                                                  1682 05864000
*/* IGC042ES: CHART                                                  */ 05865000
*/* FOOTING                                                        1682 05866000
*/* ESTAE EXIT ROUTINE                                               */ 05867000
*/********************************************************************/ 05868000
*/*                                                                  */ 05869000
*/* IGC042ES IS AN ESTAE EXIT ROUTINE IN EFFECT OVER THE ENTIRE      */ 05870000
*/* MAINLINE PROCESSING, BUT NOT IN EFFECT FOR THE REENTRY           */ 05871000
*/* PROCESSING. BECAUSE OF THE ORDER IN WHICH RECOVERY ROUTINES ARE  */ 05872000
*/* SCHEDULED BY RTM (RECOVERY TERMINATION MANAGER), THE FRR         */ 05873000
*/* IGC042R2 WILL RECEIVE CONTROL FIRST IN CASE OF ERROR, WHENEVER   */ 05874000
*/* THE FRR IS IN EFFECT, I.E., WHENEVER THE LOCAL LOCK IS HELD.     */ 05875000
*/*                                                                  */ 05876000
*/* THIS ROUTINE MOVES THE PERMANENT WORKAREA (WKEXSAVE, LOCATED IN  */ 05877000
*/* THE CURRENT SVRB'S RBEXSAVE) INTO THE OUTPUT DATA AREA FOR       */ 05878000
*/* RECORDING, CALLS BACKOUT SUBROUTINE RTN1 FOR CLEAN UP PROCESSING,*/ 05879000
*/* AND RETURNS TO RTM SPECIFYING NO RETRY.                          */ 05880000
*/*                                                                  */ 05881000
*/* IF THE FRR HAS BEEN ENTERED, THIS ROUTINE BYPASSES THE ERROR     */ 05882000
*/* RECORDING PROCESSING, SINCE THIS WILL HAVE BEEN DONE BY THE FRR. */ 05883000
*/*                                                                  */ 05884000
*/* SUBROUTINES CALLED: RTN1, UNLOCK                                 */ 05885000
*/*                                                                  */ 05886000
*/* SYSTEM ROUTINES CALLED / MACROS ISSUED: SETRP, SETLOCK           */ 05887000
*/*                                                                  */ 05888000
*/* RETURN CODES SET: X00NRTRY                                       */ 05889000
*/*                                                                  */ 05890000
*/* REGISTER USAGE:                                                  */ 05891000
*/*                                                                  */ 05892000
*/* R0WORK - INPUT CODE: X'0C' - NO SDWA                             */ 05893000
*/*                      OTHER - AN SDWA IS PROVIDED                 */ 05894000
*/* R1AREA - INPUT, ADDRESS OF SDWA IF THERE IS ONE (FIELD SDWAPARM  */ 05895000
*/*          CONTAINS THE ADDRESS OF WKEXSAVE)                       */ 05896000
*/*        - ABEND COMPLETION CODE OTHERWISE                         */ 05897000
*/* R2WORK - ADDRESS OF WKEXSAVE IF THERE IS NO SDWA                 */ 05898000
*/* R13WORK - ADDRESS OF A SAVE AREA IF THERE IS NO SDWA             */ 05899000
*/*                                                                  */ 05900000
*/********************************************************************/ 05901000
*/* E ENTER IGC042ES                                                 */ 05902000
*                                                                  1682 05903000
*   RFY                                                            1682 05904000
*     R0WORK RSTD;                                                 1682 05905000
*   RFY                                                            1683 05906000
*     R1AREA RSTD;                                                 1683 05907000
*   RFY                                                            1684 05908000
*     R2WORK RSTD;                                                 1684 05909000
*   RFY                                                            1685 05910000
*     R13WORK RSTD;                                                1685 05911000
*   RFY                                                            1686 05912000
*     R14RET RSTD;                                                 1686 05913000
*   GEN(USING IGC042ES,R15WORK);    /*                        @Y02753*/ 05914000
         USING IGC042ES,R15WORK                                         05915000
*   R6BASE=BASEPTR1;                /* ADDRESS OF ATTACH SVC ENTRY 1688 05916000
*                                                             @Y02753*/ 05917000
         L     R6BASE,BASEPTR1                                     1688 05918000
*   R9BASE=BASEPTR2;                /* ATTACH SVC ENTRY PT + 4096  1689 05919000
*                                                             @Y02753*/ 05920000
         L     R9BASE,BASEPTR2                                     1689 05921000
*   GEN(DROP  R15WORK);                                            1690 05922000
*                                                                  1690 05923000
         DROP  R15WORK                                                  05924000
*/* D (NO,%FL06000,YES,) IS THERE AN SDWA ?                          */ 05925000
*                                                                  1691 05926000
*   IF R0WORKÂ¬=X0CSDWA THEN         /*                        @Y02753*/ 05927000
         CH    R0WORK,@CH02681                                     1691 05928000
         BE    @RF01691                                            1691 05929000
*     DO;                           /* DO000100               @Y02753*/ 05930000
*/* P INDICATE RECORDING, NO RETRY                                   */ 05931000
*                                                                  1693 05932000
*       DO;                         /* SETRP RECORD(YES)RC(0)        */ 05933000
*         RESPECIFY                                                1694 05934000
*          (GPR00P,                                                1694 05935000
*           GPR01P,                                                1694 05936000
*           GPR14P,                                                1694 05937000
*           GPR15P) RSTD;                                          1694 05938000
*         GPR01P->SDWARCDE=0;       /* SAVE RC VALUE                 */ 05939000
         MVI   SDWARCDE(GPR01P),X'00'                              1695 05940000
*         GPR01P->SDWARCRD='1'B;    /* TURN ON RECORD INDICATOR      */ 05941000
         OI    SDWARCRD(GPR01P),B'10000000'                        1696 05942000
*         RESPECIFY                                                1697 05943000
*          (GPR00P,                                                1697 05944000
*           GPR01P,                                                1697 05945000
*           GPR14P,                                                1697 05946000
*           GPR15P) UNRSTD;                                        1697 05947000
*       END;                        /*                        @Y02753*/ 05948000
*       R12SVRB=R1AREA->SDWAPARM;   /* RESET PERM WORK ADDR   @Y02753*/ 05949000
         L     R12SVRB,SDWAPARM(,R1AREA)                           1699 05950000
*/* D (NO,%FL06010,YES,) HAS FRR BEEN ENTERED ?                      */ 05951000
*                                                                  1700 05952000
*       IF WKFRRSW='1'B THEN        /*                        @Y02753*/ 05953000
         TM    WKFRRSW(R12SVRB),B'01000000'                        1700 05954000
         BNO   @RF01700                                            1700 05955000
*         DO;                       /* DO000037               @Y02753*/ 05956000
*/* P (,AT001760) INDICATE NO RECORDING                              */ 05957000
*                                                                  1702 05958000
*           DO;                     /* SETRP RECORD(NO)              */ 05959000
*             RESPECIFY                                            1703 05960000
*              (GPR00P,                                            1703 05961000
*               GPR01P,                                            1703 05962000
*               GPR14P,                                            1703 05963000
*               GPR15P) RSTD;                                      1703 05964000
*             GPR01P->SDWARCDE=0;   /* SAVE RC VALUE                 */ 05965000
         MVI   SDWARCDE(GPR01P),X'00'                              1704 05966000
*             GPR01P->SDWARCRD='0'B;/* TURN OFF RECORD INDICATOR     */ 05967000
         NI    SDWARCRD(GPR01P),B'01111111'                        1705 05968000
*             RESPECIFY                                            1706 05969000
*              (GPR00P,                                            1706 05970000
*               GPR01P,                                            1706 05971000
*               GPR14P,                                            1706 05972000
*               GPR15P) UNRSTD;                                    1706 05973000
*           END;                    /*                        @Y02753*/ 05974000
*         END;                      /* END00037               @Y02753*/ 05975000
*       ELSE                        /* FRR HAS NOT BEEN ENTERED    1709 05976000
*                                                             @Y02753*/ 05977000
*         DO;                       /* DO000103               @Y02753*/ 05978000
         B     @RC01700                                            1709 05979000
@RF01700 DS    0H                                                  1710 05980000
*/* %FL06010: P (,AT001760) MOVE RECORDING PARMS INTO OUTPUT AREA    */ 05981000
*                                                                  1710 05982000
*           RFY                                                    1710 05983000
*             R7WORK RSTD;                                         1710 05984000
*           RFY                                                    1711 05985000
*             R8WORK RSTD;                                         1711 05986000
*           R7WORK=R1AREA->SDWAVRAL;/* LENGTH OF OUTPUT AREA  @Y02753*/ 05987000
         SLR   R7WORK,R7WORK                                       1712 05988000
         ICM   R7WORK,3,SDWAVRAL(R1AREA)                           1712 05989000
*           R8WORK=LENGTH(WKCONTRL);/* LENGTH PERM WORKAREA   @Y02753*/ 05990000
         LA    R8WORK,24                                           1713 05991000
*           IF R7WORK<R8WORK THEN   /* WILL ENTIRE WORKAREA FIT ?  1714 05992000
*                                                             @Y02753*/ 05993000
         CR    R7WORK,R8WORK                                       1714 05994000
         BNL   @RF01714                                            1714 05995000
*             R8WORK=R7WORK;        /* RESET TO AVAILABLE LENGTH   1715 05996000
*                                                             @Y02753*/ 05997000
         LR    R8WORK,R7WORK                                       1715 05998000
*           R1AREA->SDWAVRA(1:R8WORK)=WKCONTRL;/* TO OUTPUT DATA AREA   05999000
*                                                             @Y02753*/ 06000000
@RF01714 LR    @15,R8WORK                                          1716 06001000
         BCTR  @15,0                                               1716 06002000
         EX    @15,@SM03155                                        1716 06003000
*           R1AREA->SDWAURAL=R8WORK;/* LENGTH RECORDED        @Y02753*/ 06004000
         STC   R8WORK,SDWAURAL(,R1AREA)                            1717 06005000
*           R1AREA->SDWARECP(1:LENGTH(ATMODZ))=ATMODZ;/* MODULE AND     06006000
*                                      CSECT NAMES            @Y02753*/ 06007000
         MVC   SDWARECP(16,R1AREA),ATMODZ                          1718 06008000
*           R1AREA->SDWAREXN=ATESTAEZ;/* RECOVERY ROUTINE NAME     1719 06009000
*                                                             @Y02753*/ 06010000
         MVC   SDWAREXN(8,R1AREA),ATESTAEZ                         1719 06011000
*         END;                      /* END00103               @Y02753*/ 06012000
*     END;                          /* END00100               @Y02753*/ 06013000
*   ELSE                            /* NO SDWA                @Y02753*/ 06014000
*/* %FL06000: P GET ADDRESS OF PERMANENT WORKAREA                    */ 06015000
*                                                                  1722 06016000
*     R12SVRB=R2WORK;               /* RESET PERM WORK ADDR   @Y02753*/ 06017000
         B     @RC01691                                            1722 06018000
@RF01691 LR    R12SVRB,R2WORK                                      1722 06019000
*/* AT001760: P STORE RETURN ADDRESS IN WORKAREA                     */ 06020000
*                                                                  1723 06021000
*AT001760:                                                         1723 06022000
*   WKRECR14=R14RET;                /* RETURN ADDRESS         @Y02753*/ 06023000
@RC01691 DS    0H                                                  1723 06024000
AT001760 ST    R14RET,WKRECR14(,R12SVRB)                           1723 06025000
*   RFY                                                            1724 06026000
*     R14RET UNRSTD;                                               1724 06027000
*                                                                  1724 06028000
*/* S RTN1: PERFORM CLEAN UP                                         */ 06029000
*                                                                  1725 06030000
*   R4CURTCB=WKCURTCB;              /* CURRENT TCB ADDRESS    @Y02753*/ 06031000
         L     R4CURTCB,WKCURTCB(,R12SVRB)                         1725 06032000
*   CALL RTN1;                      /* CLEAN UP ROUTINE       @Y02753*/ 06033000
         BAL   @14,RTN1                                            1726 06034000
*/* AT001720: R RETURN                                               */ 06035000
*                                                                  1727 06036000
*   RFY                                                            1727 06037000
*     R14RET RSTD;                                                 1727 06038000
*   RFY                                                            1728 06039000
*     R15WORK RSTD;                                                1728 06040000
*AT001720:                                                         1729 06041000
*   R14RET=WKRECR14;                /* RESTORE RETURN ADDRESS @Y02753*/ 06042000
AT001720 L     R14RET,WKRECR14(,R12SVRB)                           1729 06043000
*   R15WORK=X00NRTRY;               /* SPECIFY NO RETRY       @Y02753*/ 06044000
         SLR   R15WORK,R15WORK                                     1730 06045000
*   RFY                                                            1731 06046000
*     R14RET UNRSTD;                                               1731 06047000
*   RFY                                                            1732 06048000
*     R15WORK UNRSTD;                                              1732 06049000
*   END IGC042ES;                   /*                        @Y02753*/ 06050000
@EL00023 DS    0H                                                  1733 06051000
@EF00023 DS    0H                                                  1733 06052000
@ER00023 BR    @14                                                 1733 06053000
*/* IGC042ES: END FLOWCHART                                          */ 06054000
*                                                                  1734 06055000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 06056000
*     GPR00P PTR(31) REG(0),                                       1734 06057000
*     GPR01P PTR(31) REG(1),                                       1734 06058000
*     GPR14P PTR(31) REG(14),                                      1734 06059000
*     GPR15P PTR(31) REG(15);                                      1734 06060000
*   DECLARE                         /* COMMON VARIABLES              */ 06061000
*     I256C CHAR(256) BASED,                                       1735 06062000
*     I031F FIXED(31) BASED,                                       1735 06063000
*     I031P PTR(31) BASED,                                         1735 06064000
*     I015F FIXED(15) BASED,                                       1735 06065000
*     I015P PTR(15) BASED,                                         1735 06066000
*     I008P PTR(8) BASED,                                          1735 06067000
*     I001C CHAR(1) BASED;          /*                        @Y02753*/ 06068000
*   END IGC0004B                    /* END ATTACH MODULE             */ 06069000
*                                                                  1736 06070000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 06071000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */ 06072000
*/*%INCLUDE SYSLIB  (IHAIQE  )                                       */ 06073000
*/*%INCLUDE SYSLIB  (IHASPQE )                                       */ 06074000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 06075000
*/*%INCLUDE SYSLIB  (IHAASXB )                                       */ 06076000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 06077000
*/*%INCLUDE SYSLIB  (IHASCVT )                                       */ 06078000
*/*%INCLUDE SYSLIB  (IHAPDS  )                                       */ 06079000
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */ 06080000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 06081000
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */ 06082000
*/*%INCLUDE SYSLIB  (IHAESTA )                                       */ 06083000
*/*%INCLUDE SYSLIB  (IHARB   )                                       */ 06084000
*/*%INCLUDE SYSLIB  (IKJRB   )                                       */ 06085000
*/*%INCLUDE SYSLIB  (IHASCB  )                                       */ 06086000
*/*%INCLUDE SYSLIB  (IEZATTCH)                                       */ 06087000
*                                                                  1736 06088000
*       ;                                                          1736 06089000
@DATA    DS    0H                                                       06090000
@CH00061 DC    H'1'                                                     06091000
@CH02795 DC    H'9'                                                     06092000
@CH00066 DC    H'24'                                                    06093000
@CH00049 DC    H'32'                                                    06094000
@CH00168 DC    H'64'                                                    06095000
@CH02714 DC    H'127'                                                   06096000
@CH01366 DC    H'256'                                                   06097000
@CH02700 DC    XL2'12A'                                                 06098000
@CH02677 DC    XL2'04'                                                  06099000
@CH02681 DC    XL2'0C'                                                  06100000
@CH02683 DC    XL2'14'                                                  06101000
@SX03144 XC    AREA(0,R1AREA),AREA(R1AREA)                              06102000
@SM03153 MVC   AREA(0,R8WORK),AREA(R7WORK)                              06103000
@SM03155 MVC   SDWAVRA(0,R1AREA),WKCONTRL(R12SVRB)                      06104000
@DATD    DSECT                                                          06105000
         DS    0F                                                       06106000
IGC0004B CSECT                                                          06107000
         DS    0F                                                       06108000
@DATD    DSECT                                                          06109000
         DS    0D                                                       06110000
IGC0004B CSECT                                                          06111000
         NOPR  ((@ENDDATD-@DATD)*16)                                    06112000
         DS    0F                                                       06113000
@SIZDATD DC    AL1(0)                                                   06114000
         DC    AL3(@ENDDATD-@DATD)                                      06115000
         DS    0D                                                       06116000
BASEPTR1 DC    AL4(IGC0004B)                                            06117000
BASEPTR2 DC    AL4(IGC0004B+4096)                                       06118000
SPID253  DC    AL1(253)                                                 06119000
SPID255  DC    AL1(255)                                                 06120000
@CB02704 DC    X'42A0'                                                  06121000
@CB02708 DC    X'72A0'                                                  06122000
         DS    CL2                                                      06123000
NEWPSW   DS    CL8                                                      06124000
         ORG   NEWPSW                                                   06125000
FLAGS    DC    X'070C0000'                                              06126000
INSTADDR DC    AL4(IGC042R1)                                            06127000
         ORG   NEWPSW+8                                                 06128000
CHARTCB  DC    CL4'TCB '                                                06129000
ATRECID  DS    CL33                                                     06130000
         ORG   ATRECID                                                  06131000
ATIDLNG  DC    AL1(24)                                                  06132000
ATFRRID  DS    CL24                                                     06133000
         ORG   ATFRRID                                                  06134000
ATMODZ   DS    CL16                                                     06135000
         ORG   ATMODZ                                                   06136000
ATMODID  DC    CL8'IEAVEAT0'                                            06137000
ATCSECT  DC    CL8'IGC0004B'                                            06138000
         ORG   ATFRRID+16                                               06139000
ATFRRZ   DC    CL8'IGC042R2'                                            06140000
         ORG   ATRECID+25                                               06141000
ATESTAEZ DC    CL8'IGC042ES'                                            06142000
         ORG   ATRECID+33                                               06143000
IGC0004B CSECT                                                          06144000
*                                 /* PATCH AREA - 200 BYTES */          06145000
AT0PATCH DC    50F'0'                  PATCH AREA                       06146000
@DATD    DSECT                                                          06147000
@ENDDATD EQU   *                                                        06148000
IGC0004B CSECT                                                          06149000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       06150000
@01      EQU   01                                                       06151000
@02      EQU   02                                                       06152000
@03      EQU   03                                                       06153000
@04      EQU   04                                                       06154000
@05      EQU   05                                                       06155000
@06      EQU   06                                                       06156000
@07      EQU   07                                                       06157000
@08      EQU   08                                                       06158000
@09      EQU   09                                                       06159000
@10      EQU   10                                                       06160000
@11      EQU   11                                                       06161000
@12      EQU   12                                                       06162000
@13      EQU   13                                                       06163000
@14      EQU   14                                                       06164000
@15      EQU   15                                                       06165000
ESTAPTR  EQU   @01                                                      06166000
R12SVRB  EQU   @12                                                      06167000
R1AREA   EQU   @01                                                      06168000
R0WORK   EQU   @00                                                      06169000
R1ESTAE  EQU   @01                                                      06170000
R1WORK   EQU   @01                                                      06171000
R2WORK   EQU   @02                                                      06172000
R3WORKAD EQU   @03                                                      06173000
R3WORK   EQU   @03                                                      06174000
R4CURTCB EQU   @04                                                      06175000
R4WORK   EQU   @04                                                      06176000
R5NEWTCB EQU   @05                                                      06177000
R5CURRB  EQU   @05                                                      06178000
R5WORK   EQU   @05                                                      06179000
R6BASE   EQU   @06                                                      06180000
R7ASCB   EQU   @07                                                      06181000
R7IQE    EQU   @07                                                      06182000
R7WORK   EQU   @07                                                      06183000
R8IRB    EQU   @08                                                      06184000
R8WORK   EQU   @08                                                      06185000
R9BASE   EQU   @09                                                      06186000
R9SAVE   EQU   @09                                                      06187000
R10WORK  EQU   @10                                                      06188000
R10LOOPC EQU   @10                                                      06189000
R10INPRM EQU   @10                                                      06190000
R11WORK  EQU   @11                                                      06191000
R11PTR   EQU   @11                                                      06192000
R11LNGTH EQU   @11                                                      06193000
R12WORK  EQU   @12                                                      06194000
R13WORK  EQU   @13                                                      06195000
R14RET   EQU   @14                                                      06196000
R14FRRAD EQU   @14                                                      06197000
R15INPRM EQU   @15                                                      06198000
R15RETCD EQU   @15                                                      06199000
R15WORK  EQU   @15                                                      06200000
GPR00P   EQU   @00                                                      06201000
GPR01P   EQU   @01                                                      06202000
GPR14P   EQU   @14                                                      06203000
GPR15P   EQU   @15                                                      06204000
R14WORK  EQU   @14                                                      06205000
R7BRANCH EQU   @07                                                      06206000
CVTPTR   EQU   16                                                       06207000
PSA      EQU   0                                                        06208000
FLCRNPSW EQU   PSA                                                      06209000
FLCROPSW EQU   PSA+8                                                    06210000
FLCICCW2 EQU   PSA+16                                                   06211000
PSAEEPSW EQU   PSA+132                                                  06212000
PSAESPSW EQU   PSA+136                                                  06213000
FLCSVILC EQU   PSAESPSW+1                                               06214000
PSAEPPSW EQU   PSA+140                                                  06215000
FLCPIILC EQU   PSAEPPSW+1                                               06216000
FLCPICOD EQU   PSAEPPSW+2                                               06217000
PSAPICOD EQU   FLCPICOD+1                                               06218000
FLCTEA   EQU   PSAEPPSW+4                                               06219000
FLCPER   EQU   PSA+152                                                  06220000
FLCMCLA  EQU   PSA+168                                                  06221000
FLCIOEL  EQU   FLCMCLA+4                                                06222000
FLCIOA   EQU   FLCMCLA+16                                               06223000
FLCFSA   EQU   FLCMCLA+80                                               06224000
PSAAOLD  EQU   PSA+548                                                  06225000
PSASUPER EQU   PSA+552                                                  06226000
PSASUP1  EQU   PSASUPER                                                 06227000
PSASUP2  EQU   PSASUPER+1                                               06228000
PSASUP3  EQU   PSASUPER+2                                               06229000
PSASUP4  EQU   PSASUPER+3                                               06230000
PSACLHT  EQU   PSA+640                                                  06231000
PSALKSA  EQU   PSA+696                                                  06232000
PSAHLHI  EQU   PSA+760                                                  06233000
PSALITA  EQU   PSA+764                                                  06234000
PSADSSFL EQU   PSA+836                                                  06235000
PSADSSF1 EQU   PSADSSFL                                                 06236000
PSADSSF3 EQU   PSADSSFL+2                                               06237000
PSADSSF4 EQU   PSADSSFL+3                                               06238000
PSARSVT  EQU   PSA+896                                                  06239000
PSALSFCC EQU   PSA+1012                                                 06240000
SCVTSPTR EQU   0                                                        06241000
TCBPTR   EQU   0                                                        06242000
ASCBPTR  EQU   0                                                        06243000
ASXBPTR  EQU   0                                                        06244000
ATTCHPTR EQU   0                                                        06245000
IQEPTR   EQU   0                                                        06246000
PDS2PTR  EQU   0                                                        06247000
PDSPTRV  EQU   0                                                        06248000
RBSECPTR EQU   0                                                        06249000
SPQESPTR EQU   0                                                        06250000
FRRSPTR  EQU   0                                                        06251000
FRREPTR  EQU   0                                                        06252000
SDWAPTR  EQU   0                                                        06253000
TCBFIX   EQU   0                                                        06254000
TCBFRS   EQU   TCBFIX                                                   06255000
TCB      EQU   0                                                        06256000
TCBRBP   EQU   TCB                                                      06257000
TCBPIE   EQU   TCB+4                                                    06258000
TCBPMASK EQU   TCBPIE                                                   06259000
TCBTIO   EQU   TCB+12                                                   06260000
TCBCMP   EQU   TCB+16                                                   06261000
TCBCMPF  EQU   TCBCMP                                                   06262000
TCBCPP   EQU   TCBCMPF                                                  06263000
TCBSTCC  EQU   TCBCMPF                                                  06264000
TCBCDBL  EQU   TCBCMPF                                                  06265000
TCBCWTO  EQU   TCBCMPF                                                  06266000
TCBCIND  EQU   TCBCMPF                                                  06267000
TCBCMSG  EQU   TCBCMPF                                                  06268000
TCBTRN   EQU   TCB+20                                                   06269000
TCBABF   EQU   TCBTRN                                                   06270000
TCBTCP   EQU   TCBABF                                                   06271000
TCBMSS   EQU   TCB+24                                                   06272000
TCBMSSB  EQU   TCBMSS+1                                                 06273000
TCBPKF   EQU   TCB+28                                                   06274000
TCBFLGS  EQU   TCB+29                                                   06275000
TCBFLGS1 EQU   TCBFLGS                                                  06276000
TCBFLGS2 EQU   TCBFLGS+1                                                06277000
TCBFETXR EQU   TCBFLGS2                                                 06278000
TCBFLGS3 EQU   TCBFLGS+2                                                06279000
TCBFSM   EQU   TCBFLGS3                                                 06280000
TCBFLGS4 EQU   TCBFLGS+3                                                06281000
TCBFLGS5 EQU   TCBFLGS+4                                                06282000
TCBABWF  EQU   TCBFLGS5                                                 06283000
TCBANDSP EQU   TCBFLGS5                                                 06284000
TCBLMP   EQU   TCB+34                                                   06285000
TCBDSP   EQU   TCB+35                                                   06286000
TCBJLB   EQU   TCB+40                                                   06287000
TCBJPQ   EQU   TCB+44                                                   06288000
TCBPURGE EQU   TCBJPQ                                                   06289000
TCBGRS   EQU   TCB+48                                                   06290000
TCBGRS3  EQU   TCBGRS+12                                                06291000
TCBGRS4  EQU   TCBGRS+16                                                06292000
TCBGRS5  EQU   TCBGRS+20                                                06293000
TCBGRS6  EQU   TCBGRS+24                                                06294000
TCBGRS9  EQU   TCBGRS+36                                                06295000
TCBGRS10 EQU   TCBGRS+40                                                06296000
TCBGRS11 EQU   TCBGRS+44                                                06297000
TCBGRS12 EQU   TCBGRS+48                                                06298000
TCBFSA   EQU   TCB+112                                                  06299000
TCBFSAB  EQU   TCBFSA+1                                                 06300000
TCBTCB   EQU   TCB+116                                                  06301000
TCBTME   EQU   TCB+120                                                  06302000
TCBJSTCB EQU   TCB+124                                                  06303000
TCBJSTCA EQU   TCBJSTCB+1                                               06304000
TCBNTC   EQU   TCB+128                                                  06305000
TCBOTC   EQU   TCB+132                                                  06306000
TCBLTC   EQU   TCB+136                                                  06307000
TCBIQE   EQU   TCB+140                                                  06308000
TCBECB   EQU   TCB+144                                                  06309000
TCBTSFLG EQU   TCB+148                                                  06310000
TCBTSTSK EQU   TCBTSFLG                                                 06311000
TCBSTPPR EQU   TCBTSFLG                                                 06312000
TCBATT   EQU   TCBTSFLG                                                 06313000
TCBSTPCT EQU   TCB+149                                                  06314000
TCBPQE   EQU   TCB+152                                                  06315000
TCBSTAB  EQU   TCB+160                                                  06316000
TCBNSTAE EQU   TCBSTAB                                                  06317000
TCBSTABE EQU   TCBNSTAE                                                 06318000
TCBSTABB EQU   TCBSTAB+1                                                06319000
TCBTCT   EQU   TCB+164                                                  06320000
TCBTCTGF EQU   TCBTCT                                                   06321000
TCBSCNDY EQU   TCB+172                                                  06322000
TCBNDSP  EQU   TCBSCNDY                                                 06323000
TCBNDSP1 EQU   TCBNDSP+1                                                06324000
TCBNDSP2 EQU   TCBNDSP+2                                                06325000
TCBNDSP3 EQU   TCBNDSP+3                                                06326000
TCBJSCB  EQU   TCB+180                                                  06327000
TCBRECDE EQU   TCBJSCB                                                  06328000
TCBJSCBB EQU   TCBJSCB+1                                                06329000
TCBEXT1  EQU   TCB+196                                                  06330000
TCBBITS  EQU   TCB+200                                                  06331000
TCBNDSP4 EQU   TCBBITS                                                  06332000
TCBNDSP5 EQU   TCBBITS+1                                                06333000
TCBFLGS6 EQU   TCBBITS+2                                                06334000
TCBRV    EQU   TCBFLGS6                                                 06335000
TCBFLGS7 EQU   TCBBITS+3                                                06336000
TCBDAR   EQU   TCB+204                                                  06337000
TCBDARC  EQU   TCBDAR                                                   06338000
TCBEXT2  EQU   TCB+208                                                  06339000
TCBBACK  EQU   TCB+220                                                  06340000
TCBTID   EQU   TCB+238                                                  06341000
TCBXSCT  EQU   TCB+240                                                  06342000
TCBXSCT1 EQU   TCBXSCT                                                  06343000
TCBFOE   EQU   TCB+244                                                  06344000
TCBSWA   EQU   TCB+248                                                  06345000
TCBTCBID EQU   TCB+256                                                  06346000
TCBESTAE EQU   TCB+264                                                  06347000
TCBESTRM EQU   TCBESTAE+1                                               06348000
TCBAFFN  EQU   TCB+274                                                  06349000
TCBFBYT1 EQU   TCB+276                                                  06350000
TCBFBYT2 EQU   TCB+277                                                  06351000
TCBECBNV EQU   TCBFBYT2                                                 06352000
TCBRV124 EQU   TCB+278                                                  06353000
TCBRV133 EQU   TCB+279                                                  06354000
TCBXTNT2 EQU   0                                                        06355000
TCBGTF   EQU   TCBXTNT2                                                 06356000
TCBTFLG  EQU   TCBGTF                                                   06357000
TCBRV146 EQU   TCBXTNT2+28                                              06358000
TCBRV155 EQU   TCBXTNT2+29                                              06359000
TCBRV164 EQU   TCBXTNT2+30                                              06360000
TCBRV173 EQU   TCBXTNT2+31                                              06361000
IQESECT  EQU   0                                                        06362000
IQELNK   EQU   IQESECT                                                  06363000
IQEPARAM EQU   IQESECT+4                                                06364000
IQEIRB   EQU   IQESECT+8                                                06365000
IQEFLAGS EQU   IQEIRB                                                   06366000
IQETCB   EQU   IQESECT+12                                               06367000
SPQESECT EQU   0                                                        06368000
SPQEAD   EQU   SPQESECT                                                 06369000
SPQEPTR  EQU   SPQEAD                                                   06370000
SPDQEPTR EQU   SPQESECT+4                                               06371000
SPDQEAD  EQU   SPDQEPTR                                                 06372000
SPQEFLGS EQU   SPQESECT+8                                               06373000
SPSHARE  EQU   SPQEFLGS                                                 06374000
LASTSPQE EQU   SPQEFLGS                                                 06375000
SPQEOWN  EQU   SPQEFLGS                                                 06376000
SPQEID   EQU   SPQESECT+10                                              06377000
SPQEKEY  EQU   SPQESECT+11                                              06378000
ASCB     EQU   0                                                        06379000
ASCBSUPC EQU   ASCB+16                                                  06380000
ASCBRSM  EQU   ASCB+52                                                  06381000
ASCBRSMF EQU   ASCBRSM                                                  06382000
ASCBFW1  EQU   ASCB+100                                                 06383000
ASCBAFFN EQU   ASCBFW1                                                  06384000
ASCBRCTF EQU   ASCBFW1+2                                                06385000
ASCBFLG1 EQU   ASCBFW1+3                                                06386000
ASCBASXB EQU   ASCB+108                                                 06387000
ASCBDSP1 EQU   ASCB+114                                                 06388000
ASCBFLG2 EQU   ASCB+115                                                 06389000
ASCBTCBS EQU   ASCB+124                                                 06390000
ASCBLKGP EQU   ASCB+128                                                 06391000
ASCBSRQ  EQU   ASCB+180                                                 06392000
ASCBSRQ1 EQU   ASCBSRQ                                                  06393000
ASCBSRQ2 EQU   ASCBSRQ+1                                                06394000
ASCBSRQ3 EQU   ASCBSRQ+2                                                06395000
ASCBSRQ4 EQU   ASCBSRQ+3                                                06396000
ASXB     EQU   0                                                        06397000
ASXBFTCB EQU   ASXB+4                                                   06398000
ASXBLTCB EQU   ASXB+8                                                   06399000
ASXBTCBS EQU   ASXB+12                                                  06400000
ASXBAEQ  EQU   ASXB+168                                                 06401000
ASXBSECR EQU   ASXB+199                                                 06402000
ASCBSFLG EQU   ASXBSECR                                                 06403000
ASXBCASW EQU   ASXB+216                                                 06404000
ASXBCRB1 EQU   ASXBCASW                                                 06405000
CVTMAP   EQU   0                                                        06406000
CVT      EQU   CVTMAP                                                   06407000
CVTDAR   EQU   CVTMAP+72                                                06408000
CVTFLGS1 EQU   CVTDAR                                                   06409000
CVTDCB   EQU   CVTMAP+116                                               06410000
CVTIOQET EQU   CVTMAP+120                                               06411000
CVTIERLC EQU   CVTMAP+144                                               06412000
CVTHEAD  EQU   CVTMAP+160                                               06413000
CVTSV76C EQU   CVTHEAD                                                  06414000
CVTOPTA  EQU   CVTMAP+182                                               06415000
CVTOPTB  EQU   CVTMAP+183                                               06416000
CVTGTF   EQU   CVTMAP+236                                               06417000
CVTGTFST EQU   CVTGTF                                                   06418000
CVTGTFS  EQU   CVTGTFST                                                 06419000
CVTSTATE EQU   CVTGTFST                                                 06420000
CVTTMODE EQU   CVTGTFST                                                 06421000
CVTFORM  EQU   CVTGTFST                                                 06422000
CVTAQAVT EQU   CVTMAP+240                                               06423000
CVTTCMFG EQU   CVTAQAVT                                                 06424000
CVTVOLM2 EQU   CVTMAP+244                                               06425000
CVTTATA  EQU   CVTVOLM2                                                 06426000
CVTTSKS  EQU   CVTTATA                                                  06427000
CVTVOLF2 EQU   CVTTSKS                                                  06428000
CVTTAT   EQU   CVTTATA+1                                                06429000
CVTATER  EQU   CVTMAP+248                                               06430000
CVTEXT1  EQU   CVTMAP+252                                               06431000
CVTPURG  EQU   CVTMAP+260                                               06432000
CVTQMSG  EQU   CVTMAP+268                                               06433000
CVTDMSR  EQU   CVTMAP+272                                               06434000
CVTRSV37 EQU   CVTDMSR                                                  06435000
CVTDMSRF EQU   CVTRSV37                                                 06436000
CVTERPV  EQU   CVTMAP+316                                               06437000
CVTINTLA EQU   CVTMAP+320                                               06438000
CVTAPF   EQU   CVTMAP+324                                               06439000
CVTEXT2  EQU   CVTMAP+328                                               06440000
CVTHJES  EQU   CVTMAP+332                                               06441000
CVTPGSIA EQU   CVTMAP+348                                               06442000
CVTA1F1  EQU   CVTMAP+356                                               06443000
CVTSYSK  EQU   CVTMAP+357                                               06444000
CVTVOLM1 EQU   CVTMAP+380                                               06445000
CVTVOLF1 EQU   CVTVOLM1                                                 06446000
CVTATMCT EQU   CVTMAP+388                                               06447000
CVTXTNT1 EQU   0                                                        06448000
CVTXTNT2 EQU   0                                                        06449000
CVTDSSV  EQU   CVTXTNT2                                                 06450000
CVTFLGBT EQU   CVTXTNT2+5                                               06451000
CVTQID   EQU   CVTXTNT2+24                                              06452000
CVTRV400 EQU   CVTXTNT2+52                                              06453000
CVTRV409 EQU   CVTXTNT2+53                                              06454000
CVTATCVT EQU   CVTXTNT2+64                                              06455000
CVTRV429 EQU   CVTXTNT2+84                                              06456000
CVTRV438 EQU   CVTXTNT2+85                                              06457000
CVTRV457 EQU   CVTXTNT2+112                                             06458000
CVTRV466 EQU   CVTXTNT2+113                                             06459000
CVTFIX   EQU   0                                                        06460000
CVTRELNO EQU   CVTFIX+252                                               06461000
SCVTSECT EQU   0                                                        06462000
PDS2     EQU   0                                                        06463000
PDS2INDC EQU   PDS2+13                                                  06464000
PDS2TTRT EQU   PDS2+14                                                  06465000
PDS2USRD EQU   PDS2TTRT                                                 06466000
PDS2ATR  EQU   PDS2+22                                                  06467000
PDS2ATR1 EQU   PDS2ATR                                                  06468000
PDS2ATR2 EQU   PDS2ATR+1                                                06469000
@NM00041 EQU   PDS2+32                                                  06470000
PDS2FTBO EQU   @NM00041                                                 06471000
PDS2FTB1 EQU   PDS2FTBO                                                 06472000
PDSS01   EQU   0                                                        06473000
PDSS02   EQU   0                                                        06474000
PDSS03   EQU   0                                                        06475000
PDSSSIWD EQU   PDSS03                                                   06476000
PDSSSIFB EQU   PDSSSIWD+1                                               06477000
PDSS04   EQU   0                                                        06478000
PDSAPF   EQU   PDSS04                                                   06479000
SDWA     EQU   0                                                        06480000
SDWAPARM EQU   SDWA                                                     06481000
SDWAFIOB EQU   SDWA+4                                                   06482000
SDWAABCC EQU   SDWAFIOB                                                 06483000
SDWACMPF EQU   SDWAABCC                                                 06484000
SDWAREQ  EQU   SDWACMPF                                                 06485000
SDWACMPC EQU   SDWAABCC+1                                               06486000
SDWACTL1 EQU   SDWA+8                                                   06487000
SDWACMKA EQU   SDWACTL1                                                 06488000
SDWAMWPA EQU   SDWACTL1+1                                               06489000
SDWAPMKA EQU   SDWACTL1+4                                               06490000
SDWACTL2 EQU   SDWA+16                                                  06491000
SDWACMKP EQU   SDWACTL2                                                 06492000
SDWAMWPP EQU   SDWACTL2+1                                               06493000
SDWAPMKP EQU   SDWACTL2+4                                               06494000
SDWAGRSV EQU   SDWA+24                                                  06495000
SDWANAME EQU   SDWA+88                                                  06496000
SDWAEC1  EQU   SDWA+104                                                 06497000
SDWAEMK1 EQU   SDWAEC1                                                  06498000
SDWAMWP1 EQU   SDWAEC1+1                                                06499000
SDWAINT1 EQU   SDWAEC1+2                                                06500000
SDWANXT1 EQU   SDWAEC1+4                                                06501000
SDWAAEC1 EQU   SDWA+112                                                 06502000
SDWAILC1 EQU   SDWAAEC1+1                                               06503000
SDWAINC1 EQU   SDWAAEC1+2                                               06504000
SDWAICD1 EQU   SDWAINC1+1                                               06505000
SDWAEC2  EQU   SDWA+120                                                 06506000
SDWAEMK2 EQU   SDWAEC2                                                  06507000
SDWAMWP2 EQU   SDWAEC2+1                                                06508000
SDWAINT2 EQU   SDWAEC2+2                                                06509000
SDWANXT2 EQU   SDWAEC2+4                                                06510000
SDWAAEC2 EQU   SDWA+128                                                 06511000
SDWAILC2 EQU   SDWAAEC2+1                                               06512000
SDWAINC2 EQU   SDWAAEC2+2                                               06513000
SDWAICD2 EQU   SDWAINC2+1                                               06514000
SDWASRSV EQU   SDWA+136                                                 06515000
SDWAIDNT EQU   SDWA+200                                                 06516000
SDWAMCH  EQU   SDWA+204                                                 06517000
SDWASTCK EQU   SDWAMCH                                                  06518000
SDWAMCHI EQU   SDWAMCH+8                                                06519000
SDWAMCHS EQU   SDWAMCHI                                                 06520000
SDWAMCHD EQU   SDWAMCHI+1                                               06521000
SDWARSR1 EQU   SDWAMCH+12                                               06522000
SDWARSR2 EQU   SDWAMCH+13                                               06523000
SDWAFLGS EQU   SDWA+232                                                 06524000
SDWAERRA EQU   SDWAFLGS                                                 06525000
SDWAPCHK EQU   SDWAERRA                                                 06526000
SDWAERRB EQU   SDWAFLGS+1                                               06527000
SDWAERRC EQU   SDWAFLGS+2                                               06528000
SDWAERRD EQU   SDWAFLGS+3                                               06529000
SDWAFMID EQU   SDWA+236                                                 06530000
SDWAIOFS EQU   SDWA+238                                                 06531000
SDWACPUA EQU   SDWA+248                                                 06532000
SDWAPARQ EQU   SDWA+252                                                 06533000
SDWARCDE EQU   SDWAPARQ                                                 06534000
SDWAACF2 EQU   SDWAPARQ+1                                               06535000
SDWARCRD EQU   SDWAACF2                                                 06536000
SDWAACF3 EQU   SDWAPARQ+2                                               06537000
SDWAACF4 EQU   SDWAPARQ+3                                               06538000
SDWALKWA EQU   SDWA+256                                                 06539000
SDWALKWS EQU   SDWALKWA                                                 06540000
SDWARECP EQU   SDWA+292                                                 06541000
SDWAREXN EQU   SDWARECP+16                                              06542000
SDWASNPA EQU   SDWA+320                                                 06543000
SDWADUMP EQU   SDWASNPA                                                 06544000
SDWADPFS EQU   SDWADUMP+1                                               06545000
SDWADDAT EQU   SDWASNPA+4                                               06546000
SDWASDAT EQU   SDWADDAT                                                 06547000
SDWAPDAT EQU   SDWADDAT+2                                               06548000
SDWADPSA EQU   SDWA+328                                                 06549000
SDWADPSL EQU   SDWADPSA                                                 06550000
SDWARA   EQU   SDWA+400                                                 06551000
SDWAVRAL EQU   SDWARA                                                   06552000
SDWADPVA EQU   SDWARA+2                                                 06553000
SDWAURAL EQU   SDWARA+3                                                 06554000
SDWAVRA  EQU   SDWARA+4                                                 06555000
FRRS     EQU   0                                                        06556000
FRRSHEAD EQU   FRRS                                                     06557000
FRRSEMP  EQU   FRRSHEAD                                                 06558000
FRRSLAST EQU   FRRSHEAD+4                                               06559000
FRRSELEN EQU   FRRSHEAD+8                                               06560000
FRRSCURR EQU   FRRSHEAD+12                                              06561000
FRRSENTR EQU   0                                                        06562000
FRRSFRRA EQU   FRRSENTR                                                 06563000
FRRSFLGS EQU   FRRSENTR+4                                               06564000
FRRSFLG1 EQU   FRRSFLGS                                                 06565000
FRRSPARM EQU   FRRSENTR+8                                               06566000
ESTA     EQU   0                                                        06567000
ESTAEXT  EQU   ESTA                                                     06568000
ESTAFLG1 EQU   ESTAEXT                                                  06569000
ESTASTAI EQU   ESTAFLG1                                                 06570000
ESTAESTA EQU   ESTAFLG1                                                 06571000
ESTASYNC EQU   ESTAFLG1                                                 06572000
ESTAIO   EQU   ESTAFLG1                                                 06573000
ESTAEXIT EQU   ESTAEXT+1                                                06574000
ESTAPARM EQU   ESTA+4                                                   06575000
ESTAOWNR EQU   ESTA+8                                                   06576000
ESTAFGRS EQU   ESTA+12                                                  06577000
ESTAFLG2 EQU   ESTAFGRS                                                 06578000
ESTATERM EQU   ESTAFLG2                                                 06579000
RBPRFX   EQU   0                                                        06580000
RBBASIC  EQU   0                                                        06581000
RBEXRTNM EQU   RBBASIC                                                  06582000
RBTMFLD  EQU   RBEXRTNM                                                 06583000
RBSTAB   EQU   RBBASIC+10                                               06584000
XSTAB    EQU   RBSTAB                                                   06585000
RBSTAB1  EQU   XSTAB                                                    06586000
XSTAB1   EQU   RBSTAB1                                                  06587000
RBFTCKPT EQU   XSTAB1                                                   06588000
RBSTAB2  EQU   XSTAB+1                                                  06589000
XSTAB2   EQU   RBSTAB2                                                  06590000
RBTCBNXT EQU   XSTAB2                                                   06591000
RBFACTV  EQU   XSTAB2                                                   06592000
RBFDYN   EQU   XSTAB2                                                   06593000
RBECBWT  EQU   XSTAB2                                                   06594000
RBOPSW   EQU   RBBASIC+16                                               06595000
XRBPSW   EQU   RBOPSW                                                   06596000
RBOPSWB2 EQU   XRBPSW+1                                                 06597000
RBLINK   EQU   RBBASIC+28                                               06598000
XRBLNK   EQU   RBLINK                                                   06599000
RBWCF    EQU   XRBLNK                                                   06600000
RBLINKB  EQU   XRBLNK+1                                                 06601000
RBGRSAVE EQU   RBBASIC+32                                               06602000
XRBREG   EQU   RBGRSAVE                                                 06603000
RBGRS0   EQU   XRBREG                                                   06604000
RBGRS1   EQU   XRBREG+4                                                 06605000
RBGRS2   EQU   XRBREG+8                                                 06606000
RBGRS3   EQU   XRBREG+12                                                06607000
RBGRS4   EQU   XRBREG+16                                                06608000
RBGRS5   EQU   XRBREG+20                                                06609000
RBGRS6   EQU   XRBREG+24                                                06610000
RBGRS7   EQU   XRBREG+28                                                06611000
RBGRS8   EQU   XRBREG+32                                                06612000
RBGRS9   EQU   XRBREG+36                                                06613000
RBGRS10  EQU   XRBREG+40                                                06614000
RBGRS11  EQU   XRBREG+44                                                06615000
RBGRS12  EQU   XRBREG+48                                                06616000
RBGRS13  EQU   XRBREG+52                                                06617000
RBGRS14  EQU   XRBREG+56                                                06618000
RBGRS15  EQU   XRBREG+60                                                06619000
XRBESA   EQU   RBBASIC+96                                               06620000
RBEXSAVE EQU   XRBESA                                                   06621000
RBPREFIX EQU   0                                                        06622000
RBRSV019 EQU   RBPREFIX+14                                              06623000
RBRSV028 EQU   RBPREFIX+15                                              06624000
RBRSV041 EQU   RBPREFIX+27                                              06625000
RBPRFXST EQU   RBPREFIX+32                                              06626000
RBRSV054 EQU   RBPREFIX+39                                              06627000
RBRTOPSW EQU   RBPREFIX+40                                              06628000
RBRTPSW2 EQU   RBRTOPSW+8                                               06629000
RBRTICIL EQU   RBRTPSW2                                                 06630000
RBFLAGS1 EQU   RBPREFIX+56                                              06631000
RBINTCDA EQU   RBPREFIX+61                                              06632000
RBPRFXND EQU   RBPREFIX+64                                              06633000
RBSECT   EQU   0                                                        06634000
RBPPSAV  EQU   RBSECT                                                   06635000
RBPPSAV1 EQU   RBPPSAV+1                                                06636000
RBSIZE   EQU   RBSECT+8                                                 06637000
@NM00135 EQU   RBSECT+10                                                06638000
@NM00136 EQU   @NM00135                                                 06639000
RBFTP    EQU   @NM00136                                                 06640000
RBTRSVRB EQU   @NM00136                                                 06641000
@NM00138 EQU   @NM00135+1                                               06642000
RBATTN   EQU   @NM00138                                                 06643000
RBETXR   EQU   @NM00138                                                 06644000
RBIQETP  EQU   @NM00138                                                 06645000
RBEP     EQU   RBSECT+12                                                06646000
RBPGMQ   EQU   RBSECT+24                                                06647000
@NM00145 EQU   RBSECT+28                                                06648000
@NM00146 EQU   @NM00145                                                 06649000
IRBEND   EQU   RBSECT+96                                                06650000
@NM00149 EQU   RBSECT+96                                                06651000
RBRSV138 EQU   @NM00149+7                                               06652000
RBSCBB   EQU   RBSECT+144                                               06653000
RBSPARM  EQU   RBSCBB+8                                                 06654000
RBSFLGS1 EQU   RBSPARM                                                  06655000
RBSIOPRC EQU   RBSFLGS1                                                 06656000
RBSOWNR  EQU   RBSCBB+12                                                06657000
RBSFLGS2 EQU   RBSOWNR                                                  06658000
RBSDATA  EQU   RBSCBB+16                                                06659000
RBSFLG3  EQU   RBSDATA                                                  06660000
RBRSV150 EQU   RBSECT+167                                               06661000
SCB      EQU   0                                                        06662000
SCBPARM  EQU   SCB+8                                                    06663000
SCBFLGS1 EQU   SCBPARM                                                  06664000
SCBIOPRC EQU   SCBFLGS1                                                 06665000
SCBOWNR  EQU   SCB+12                                                   06666000
SCBFLGS2 EQU   SCBOWNR                                                  06667000
SCBDATA  EQU   SCB+16                                                   06668000
SCBFLGS3 EQU   SCBDATA                                                  06669000
ATTCHLST EQU   0                                                        06670000
ATPGNADA EQU   ATTCHLST                                                 06671000
ATDEFLAG EQU   ATPGNADA                                                 06672000
ATDENTRY EQU   ATDEFLAG                                                 06673000
ATPGNADB EQU   ATPGNADA+1                                               06674000
ATDCBADA EQU   ATTCHLST+4                                               06675000
ATDCBADB EQU   ATDCBADA+1                                               06676000
ATECBADR EQU   ATTCHLST+8                                               06677000
ATECBFLG EQU   ATECBADR                                                 06678000
ATEXTN2  EQU   ATECBFLG                                                 06679000
ATTSKLB  EQU   ATECBFLG                                                 06680000
ATTSTAI  EQU   ATECBFLG                                                 06681000
ATECBADB EQU   ATECBADR+1                                               06682000
ATGSFLDA EQU   ATTCHLST+12                                              06683000
ATGSFLAG EQU   ATGSFLDA                                                 06684000
ATGSFLDB EQU   ATGSFLDA+1                                               06685000
ATSHFLDA EQU   ATTCHLST+16                                              06686000
ATSHFLAG EQU   ATSHFLDA                                                 06687000
ATSHFLDB EQU   ATSHFLDA+1                                               06688000
ATETXRA  EQU   ATTCHLST+20                                              06689000
ATROLL   EQU   ATETXRA                                                  06690000
ATINDS2  EQU   ATROLL                                                   06691000
ATEXTN   EQU   ATINDS2                                                  06692000
ATETXRB  EQU   ATETXRA+1                                                06693000
ATDPMOD  EQU   ATTCHLST+24                                              06694000
ATLPMOD  EQU   ATTCHLST+26                                              06695000
ATINDS   EQU   ATTCHLST+27                                              06696000
ATDISP   EQU   ATINDS                                                   06697000
ATJSCB   EQU   ATINDS                                                   06698000
ATKEY    EQU   ATINDS                                                   06699000
ATSZERO  EQU   ATINDS                                                   06700000
ATSVAREA EQU   ATINDS                                                   06701000
ATJSTCB  EQU   ATINDS                                                   06702000
ATMODE   EQU   ATINDS                                                   06703000
ATPRGNM  EQU   ATTCHLST+28                                              06704000
ATJSCBAD EQU   ATTCHLST+36                                              06705000
ATJSCBA  EQU   ATJSCBAD+1                                               06706000
ATSTAIAD EQU   ATTCHLST+40                                              06707000
ATTID    EQU   ATSTAIAD                                                 06708000
ATSTAIA  EQU   ATSTAIAD+1                                               06709000
ATSTAIEX EQU   ATTCHLST+44                                              06710000
ATSTAIF  EQU   ATSTAIEX                                                 06711000
ATTERM   EQU   ATSTAIF                                                  06712000
ATESTAI  EQU   ATSTAIF                                                  06713000
ATSYNCH  EQU   ATSTAIF                                                  06714000
ATSTAIXT EQU   ATSTAIEX+1                                               06715000
ATTASKLB EQU   ATTCHLST+48                                              06716000
ATFLAGS1 EQU   ATTCHLST+52                                              06717000
ATNSHRSP EQU   ATFLAGS1                                                 06718000
ATRSAPF  EQU   ATFLAGS1                                                 06719000
ATTPLNG  EQU   ATTCHLST+54                                              06720000
ATTNSHLV EQU   ATTCHLST+56                                              06721000
IGC044R2 EQU   0                                                        06722000
WKAREA   EQU   0                                                        06723000
WKTEMPS  EQU   WKAREA+60                                                06724000
WKTEMP1  EQU   WKTEMPS                                                  06725000
WKSAVEA  EQU   WKAREA+92                                                06726000
WKSAVEB  EQU   WKAREA+96                                                06727000
WKSAVEC  EQU   WKAREA+100                                               06728000
WKSAVED  EQU   WKAREA+104                                               06729000
WKSAVEE  EQU   WKAREA+108                                               06730000
WKSPQE1  EQU   WKAREA+112                                               06731000
WKTHWORD EQU   WKAREA+118                                               06732000
WKFLAGS1 EQU   WKTHWORD                                                 06733000
WKSWASWS EQU   WKFLAGS1                                                 06734000
WK236SW  EQU   WKSWASWS                                                 06735000
WK237SW  EQU   WKSWASWS                                                 06736000
WKRTSAVE EQU   WKAREA+120                                               06737000
WKRTSAV2 EQU   WKAREA+124                                               06738000
WKEXSAVE EQU   0                                                        06739000
WKNEWXSA EQU   WKEXSAVE                                                 06740000
WKEPNAME EQU   WKNEWXSA                                                 06741000
WKSYSBYT EQU   WKNEWXSA+8                                               06742000
WKSYSTSK EQU   WKSYSBYT                                                 06743000
WKRSAPF  EQU   WKSYSBYT                                                 06744000
WKFLAGS2 EQU   WKEXSAVE+9                                               06745000
WKSVAREA EQU   WKFLAGS2                                                 06746000
WKFRRSW  EQU   WKFLAGS2                                                 06747000
WKECBSW  EQU   WKFLAGS2                                                 06748000
WKESTAI  EQU   WKFLAGS2                                                 06749000
WKNOAREA EQU   WKFLAGS2                                                 06750000
WKONQUE  EQU   WKFLAGS2                                                 06751000
WKGRS10  EQU   WKEXSAVE+12                                              06752000
WKGRS11  EQU   WKEXSAVE+16                                              06753000
WKRECR14 EQU   WKGRS11                                                  06754000
WKFRRAD  EQU   WKEXSAVE+20                                              06755000
WKCONTRL EQU   WKEXSAVE+24                                              06756000
WKFCODE  EQU   WKCONTRL                                                 06757000
WKREASON EQU   WKCONTRL+1                                               06758000
WKPKEY   EQU   WKCONTRL+2                                               06759000
WKCURTCB EQU   WKCONTRL+4                                               06760000
WKESTAEL EQU   WKCONTRL+8                                               06761000
WK255PTR EQU   WKESTAEL                                                 06762000
WK255LNG EQU   WKESTAEL+4                                               06763000
WKTCBMSS EQU   WKESTAEL+8                                               06764000
WKNEWTCB EQU   WKESTAEL+12                                              06765000
AREA     EQU   0                                                        06766000
BYTETEST EQU   0                                                        06767000
FLAGBIT7 EQU   BYTETEST                                                 06768000
ZWORD    EQU   0                                                        06769000
BYTE0    EQU   ZWORD                                                    06770000
BYTES123 EQU   ZWORD+1                                                  06771000
BYTE3    EQU   BYTES123+2                                               06772000
ZBYTE    EQU   0                                                        06773000
ATFRRWA  EQU   0                                                        06774000
ATFRRW1  EQU   ATFRRWA                                                  06775000
SUBRTINE EQU   0                                                        06776000
CIRBAREA EQU   0                                                        06777000
I256C    EQU   0                                                        06778000
IEAQCS01 EQU   0                                                        06779000
IQEEND   EQU   0                                                        06780000
I001C    EQU   0                                                        06781000
I008P    EQU   0                                                        06782000
I015F    EQU   0                                                        06783000
I015P    EQU   0                                                        06784000
I031F    EQU   0                                                        06785000
I031P    EQU   0                                                        06786000
CVTS01   EQU   CVTPGSIA                                                 06787000
CVTLPDIA EQU   CVTS01+12                                                06788000
CVTDIRST EQU   CVTLPDIA                                                 06789000
CVTSLIDA EQU   CVTS01+24                                                06790000
CVTCTLFG EQU   CVTS01+50                                                06791000
CVTCRMN  EQU   CVTS01+156                                               06792000
CVTSCBP  EQU   CVTS01+236                                               06793000
CVTEXPRO EQU   CVTS01+260                                               06794000
CVTQCS01 EQU   CVTS01+288                                               06795000
CVT044R2 EQU   CVTS01+376                                               06796000
CVTRV210 EQU   CVTS01+424                                               06797000
CVTRV219 EQU   CVTS01+425                                               06798000
CVTRV228 EQU   CVTS01+426                                               06799000
CVTRV237 EQU   CVTS01+427                                               06800000
CVTMFRTR EQU   CVTS01+452                                               06801000
CVTRV262 EQU   CVTS01+468                                               06802000
CVTRV271 EQU   CVTS01+469                                               06803000
CVTRV280 EQU   CVTS01+470                                               06804000
CVTRV289 EQU   CVTS01+471                                               06805000
CVTGSDA  EQU   CVTS01+600                                               06806000
CVTCBBR  EQU   CVTS01+624                                               06807000
PSARSVTE EQU   PSARSVT                                                  06808000
PSACSTK  EQU   PSARSVTE                                                 06809000
RBSECS03 EQU   RBEP                                                     06810000
RBCDE    EQU   RBSECS03                                                 06811000
RBCDFLGS EQU   RBCDE                                                    06812000
RBNOCELL EQU   RBCDFLGS                                                 06813000
RBSECS05 EQU   RBPGMQ                                                   06814000
RBSQE    EQU   RBSECS05                                                 06815000
RBSECS06 EQU   RBPGMQ                                                   06816000
RBIQE    EQU   RBSECS06                                                 06817000
RBUSE    EQU   RBIQE                                                    06818000
RBSECS07 EQU   RBPGMQ                                                   06819000
RBIQE2   EQU   RBSECS07                                                 06820000
RBSECS08 EQU   IRBEND                                                   06821000
RBSECS09 EQU   IRBEND                                                   06822000
SCBPTR   EQU   TCBSTAB                                                  06823000
PSW      EQU   RBOPSW                                                   06824000
KEYCMWP  EQU   PSW+1                                                    06825000
ECBTEST  EQU   ATECBADR                                                 06826000
FLC      EQU   PSA                                                      06827000
*                                      START UNREFERENCED COMPONENTS    06828000
@NM00166 EQU   PSW+4                                                    06829000
@NM00165 EQU   PSW+2                                                    06830000
CMWP     EQU   KEYCMWP                                                  06831000
PKEY     EQU   KEYCMWP                                                  06832000
SYSMASK  EQU   PSW                                                      06833000
RBRSV161 EQU   RBSECS09+64                                              06834000
RBSIRBWA EQU   RBSECS09                                                 06835000
RBIQEWRK EQU   RBSECS08+4                                               06836000
RBNEXAV  EQU   RBSECS08                                                 06837000
RBIQEA   EQU   RBIQE2                                                   06838000
RBIQE1   EQU   RBIQE+1                                                  06839000
RBSQEA   EQU   RBSQE+1                                                  06840000
@NM00150 EQU   RBSQE                                                    06841000
RBCDE1   EQU   RBCDE+1                                                  06842000
RBCDLOAD EQU   RBCDFLGS                                                 06843000
RBCDXCTL EQU   RBCDFLGS                                                 06844000
RBCDSYNC EQU   RBCDFLGS                                                 06845000
RBCDNODE EQU   RBCDFLGS                                                 06846000
RBCDSAVE EQU   RBCDFLGS                                                 06847000
RBCDATCH EQU   RBCDFLGS                                                 06848000
RBRSV009 EQU   RBCDFLGS                                                 06849000
PSARSAV  EQU   PSARSVTE+60                                              06850000
PSARSTK  EQU   PSARSVTE+56                                              06851000
PSAESAV3 EQU   PSARSVTE+52                                              06852000
PSAESTK3 EQU   PSARSVTE+48                                              06853000
PSAESAV2 EQU   PSARSVTE+44                                              06854000
PSAESTK2 EQU   PSARSVTE+40                                              06855000
PSAESAV1 EQU   PSARSVTE+36                                              06856000
PSAESTK1 EQU   PSARSVTE+32                                              06857000
PSAPSAV  EQU   PSARSVTE+28                                              06858000
PSAPSTK  EQU   PSARSVTE+24                                              06859000
PSAMSAV  EQU   PSARSVTE+20                                              06860000
PSAMSTK  EQU   PSARSVTE+16                                              06861000
PSASSAV  EQU   PSARSVTE+12                                              06862000
PSASSTK  EQU   PSARSVTE+8                                               06863000
PSANSTK  EQU   PSARSVTE+4                                               06864000
CVTRV628 EQU   CVTS01+728                                               06865000
CVTRV627 EQU   CVTS01+724                                               06866000
CVTRV626 EQU   CVTS01+720                                               06867000
CVTRV625 EQU   CVTS01+716                                               06868000
CVTRV624 EQU   CVTS01+712                                               06869000
CVTRV623 EQU   CVTS01+708                                               06870000
CVTRV622 EQU   CVTS01+704                                               06871000
CVTRV621 EQU   CVTS01+700                                               06872000
CVTIHASU EQU   CVTS01+696                                               06873000
CVTSUSP  EQU   CVTS01+692                                               06874000
CVTT6SVC EQU   CVTS01+688                                               06875000
CVTCDAL  EQU   CVTS01+684                                               06876000
CVTTCTL  EQU   CVTS01+680                                               06877000
CVTRSUME EQU   CVTS01+676                                               06878000
CVTJTERM EQU   CVTS01+672                                               06879000
CVTASMRM EQU   CVTS01+668                                               06880000
CVTTCASP EQU   CVTS01+664                                               06881000
CVT0PT03 EQU   CVTS01+660                                               06882000
CVT0PT0E EQU   CVTS01+656                                               06883000
CVTRV609 EQU   CVTS01+652                                               06884000
CVTCGK   EQU   CVTS01+648                                               06885000
CVTRAC   EQU   CVTS01+644                                               06886000
CVTHSM   EQU   CVTS01+640                                               06887000
CVTRV605 EQU   CVTS01+636                                               06888000
CVTRV604 EQU   CVTS01+632                                               06889000
CVTEFF02 EQU   CVTS01+628                                               06890000
CVTSSCR  EQU   CVTS01+620                                               06891000
CVTEVENT EQU   CVTS01+616                                               06892000
CVTCRCA  EQU   CVTS01+612                                               06893000
CVTTPIO  EQU   CVTS01+608                                               06894000
CVTADV   EQU   CVTS01+604                                               06895000
CVTGSDAB EQU   CVTGSDA                                                  06896000
CVTQV3   EQU   CVTS01+596                                               06897000
CVTQV2   EQU   CVTS01+592                                               06898000
CVTQV1   EQU   CVTS01+588                                               06899000
CVTRPT   EQU   CVTS01+584                                               06900000
CVTSSRB  EQU   CVTS01+580                                               06901000
CVTCSDRL EQU   CVTS01+576                                               06902000
CVTEXP1  EQU   CVTS01+572                                               06903000
CVTRMPMT EQU   CVTS01+568                                               06904000
CVTRMPTT EQU   CVTS01+564                                               06905000
CVTVPSA  EQU   CVTS01+560                                               06906000
CVTVSTOP EQU   CVTS01+556                                               06907000
CVTGTFR8 EQU   CVTS01+552                                               06908000
CVTQUIT  EQU   CVTS01+548                                               06909000
CVTVACR  EQU   CVTS01+544                                               06910000
CVTWTCB  EQU   CVTS01+540                                               06911000
CVTSTPRS EQU   CVTS01+536                                               06912000
CVT0PT02 EQU   CVTS01+532                                               06913000
CVTDARCM EQU   CVTS01+528                                               06914000
CVTIRECM EQU   CVTS01+524                                               06915000
CVTJRECM EQU   CVTS01+520                                               06916000
CVTVEMS0 EQU   CVTS01+516                                               06917000
CVTSPFRR EQU   CVTS01+512                                               06918000
CVTRLSTG EQU   CVTS01+508                                               06919000
CVT0TC0A EQU   CVTS01+504                                               06920000
CVTGMBR  EQU   CVTS01+500                                               06921000
CVTLFRM  EQU   CVTS01+496                                               06922000
CVTRMBR  EQU   CVTS01+492                                               06923000
CVTVIOP  EQU   CVTS01+488                                               06924000
CVTRV307 EQU   CVTS01+486                                               06925000
CVTRV306 EQU   CVTS01+484                                               06926000
CVTRV305 EQU   CVTS01+482                                               06927000
CVTRV304 EQU   CVTS01+480                                               06928000
CVTRV303 EQU   CVTS01+478                                               06929000
CVTRV302 EQU   CVTS01+476                                               06930000
CVTTRCA  EQU   CVTS01+472                                               06931000
CVTRV297 EQU   CVTRV289                                                 06932000
CVTRV296 EQU   CVTRV289                                                 06933000
CVTRV295 EQU   CVTRV289                                                 06934000
CVTRV294 EQU   CVTRV289                                                 06935000
CVTRV293 EQU   CVTRV289                                                 06936000
CVTRV292 EQU   CVTRV289                                                 06937000
CVTRV291 EQU   CVTRV289                                                 06938000
CVTRV290 EQU   CVTRV289                                                 06939000
CVTRV288 EQU   CVTRV280                                                 06940000
CVTRV287 EQU   CVTRV280                                                 06941000
CVTRV286 EQU   CVTRV280                                                 06942000
CVTRV285 EQU   CVTRV280                                                 06943000
CVTRV284 EQU   CVTRV280                                                 06944000
CVTRV283 EQU   CVTRV280                                                 06945000
CVTRV282 EQU   CVTRV280                                                 06946000
CVTRV281 EQU   CVTRV280                                                 06947000
CVTRV279 EQU   CVTRV271                                                 06948000
CVTRV278 EQU   CVTRV271                                                 06949000
CVTRV277 EQU   CVTRV271                                                 06950000
CVTRV276 EQU   CVTRV271                                                 06951000
CVTRV275 EQU   CVTRV271                                                 06952000
CVTRV274 EQU   CVTRV271                                                 06953000
CVTRV273 EQU   CVTRV271                                                 06954000
CVTRV272 EQU   CVTRV271                                                 06955000
CVTRV270 EQU   CVTRV262                                                 06956000
CVTRV269 EQU   CVTRV262                                                 06957000
CVTRV268 EQU   CVTRV262                                                 06958000
CVTRV267 EQU   CVTRV262                                                 06959000
CVTRV266 EQU   CVTRV262                                                 06960000
CVTRV265 EQU   CVTRV262                                                 06961000
CVTRV264 EQU   CVTRV262                                                 06962000
CVTRV263 EQU   CVTRV262                                                 06963000
CVTVFP   EQU   CVTS01+464                                               06964000
CVTVSI   EQU   CVTS01+460                                               06965000
CVTVPSIB EQU   CVTS01+456                                               06966000
CVTMFACT EQU   CVTMFRTR                                                 06967000
CVTMFCTL EQU   CVTS01+448                                               06968000
CVTPVBP  EQU   CVTS01+444                                               06969000
CVTPWI   EQU   CVTS01+440                                               06970000
CVTRV254 EQU   CVTS01+438                                               06971000
CVTRV253 EQU   CVTS01+436                                               06972000
CVTRV252 EQU   CVTS01+434                                               06973000
CVTRV251 EQU   CVTS01+433                                               06974000
CVTRV250 EQU   CVTS01+432                                               06975000
CVTRV249 EQU   CVTS01+431                                               06976000
CVTRV248 EQU   CVTS01+430                                               06977000
CVTRV247 EQU   CVTS01+429                                               06978000
CVTRV246 EQU   CVTS01+428                                               06979000
CVTRV245 EQU   CVTRV237                                                 06980000
CVTRV244 EQU   CVTRV237                                                 06981000
CVTRV243 EQU   CVTRV237                                                 06982000
CVTRV242 EQU   CVTRV237                                                 06983000
CVTRV241 EQU   CVTRV237                                                 06984000
CVTRV240 EQU   CVTRV237                                                 06985000
CVTRV239 EQU   CVTRV237                                                 06986000
CVTRV238 EQU   CVTRV237                                                 06987000
CVTRV236 EQU   CVTRV228                                                 06988000
CVTRV235 EQU   CVTRV228                                                 06989000
CVTRV234 EQU   CVTRV228                                                 06990000
CVTRV233 EQU   CVTRV228                                                 06991000
CVTRV232 EQU   CVTRV228                                                 06992000
CVTRV231 EQU   CVTRV228                                                 06993000
CVTRV230 EQU   CVTRV228                                                 06994000
CVTRV229 EQU   CVTRV228                                                 06995000
CVTRV227 EQU   CVTRV219                                                 06996000
CVTRV226 EQU   CVTRV219                                                 06997000
CVTRV225 EQU   CVTRV219                                                 06998000
CVTRV224 EQU   CVTRV219                                                 06999000
CVTRV223 EQU   CVTRV219                                                 07000000
CVTRV222 EQU   CVTRV219                                                 07001000
CVTRV221 EQU   CVTRV219                                                 07002000
CVTRV220 EQU   CVTRV219                                                 07003000
CVTRV218 EQU   CVTRV210                                                 07004000
CVTRV217 EQU   CVTRV210                                                 07005000
CVTRV216 EQU   CVTRV210                                                 07006000
CVTRV215 EQU   CVTRV210                                                 07007000
CVTRV214 EQU   CVTRV210                                                 07008000
CVTRV213 EQU   CVTRV210                                                 07009000
CVTRV212 EQU   CVTRV210                                                 07010000
CVTRV211 EQU   CVTRV210                                                 07011000
CVTLCCAT EQU   CVTS01+420                                               07012000
CVTPCCAT EQU   CVTS01+416                                               07013000
CVTIPCRP EQU   CVTS01+412                                               07014000
CVTIPCRI EQU   CVTS01+408                                               07015000
CVTIPCDS EQU   CVTS01+404                                               07016000
CVTAIDVT EQU   CVTS01+400                                               07017000
CVTSSAP  EQU   CVTS01+396                                               07018000
CVTEHCIR EQU   CVTS01+392                                               07019000
CVTEHDEF EQU   CVTS01+388                                               07020000
CVTDAIR  EQU   CVTS01+384                                               07021000
CVTPERFM EQU   CVTS01+380                                               07022000
CVTFETCH EQU   CVTS01+372                                               07023000
CVTRSTWD EQU   CVTS01+368                                               07024000
CVTSPOST EQU   CVTS01+364                                               07025000
CVTIOBP  EQU   CVTS01+360                                               07026000
CVTASMVT EQU   CVTS01+356                                               07027000
CVTRECRQ EQU   CVTS01+352                                               07028000
CVTWSAC  EQU   CVTS01+348                                               07029000
CVTRV149 EQU   CVTS01+344                                               07030000
CVTWSAL  EQU   CVTS01+340                                               07031000
CVTSPSA  EQU   CVTS01+336                                               07032000
CVTGLMN  EQU   CVTS01+332                                               07033000
CVTVEAC0 EQU   CVTS01+328                                               07034000
CVT062R1 EQU   CVTS01+324                                               07035000
CVTRPOST EQU   CVTS01+320                                               07036000
CVTDQIQE EQU   CVTS01+316                                               07037000
CVTCSD   EQU   CVTS01+312                                               07038000
CVTLKRMA EQU   CVTS01+308                                               07039000
CVTRSPIE EQU   CVTS01+304                                               07040000
CVTRENQ  EQU   CVTS01+300                                               07041000
CVTLQCB  EQU   CVTS01+296                                               07042000
CVTFQCB  EQU   CVTS01+292                                               07043000
CVTAPFT  EQU   CVTS01+284                                               07044000
CVTPARRL EQU   CVTS01+280                                               07045000
CVTVWAIT EQU   CVTS01+276                                               07046000
CVTGSPL  EQU   CVTS01+272                                               07047000
CVTLSMQ  EQU   CVTS01+268                                               07048000
CVTGSMQ  EQU   CVTS01+264                                               07049000
CVTOPCTP EQU   CVTS01+256                                               07050000
CVTSIC   EQU   CVTS01+252                                               07051000
CVTTPIOS EQU   CVTS01+248                                               07052000
CVTRTMS  EQU   CVTS01+244                                               07053000
CVTSDBF  EQU   CVTS01+240                                               07054000
CVTSDMP  EQU   CVTS01+232                                               07055000
CVTSV60  EQU   CVTS01+228                                               07056000
CVTRTMCT EQU   CVTS01+224                                               07057000
CVTASCBL EQU   CVTS01+220                                               07058000
CVTASCBH EQU   CVTS01+216                                               07059000
CVTGDA   EQU   CVTS01+212                                               07060000
CVTASVT  EQU   CVTS01+208                                               07061000
CVTVVMDI EQU   CVTS01+204                                               07062000
CVTAQTOP EQU   CVTS01+200                                               07063000
CVTIOSCS EQU   CVTS01+196                                               07064000
CVTSDRM  EQU   CVTS01+192                                               07065000
CVTOPTE  EQU   CVTS01+188                                               07066000
CVTSTXU  EQU   CVTS01+184                                               07067000
CVTQUIS  EQU   CVTS01+180                                               07068000
CVTPARS  EQU   CVTS01+176                                               07069000
CVTS1EE  EQU   CVTS01+172                                               07070000
CVTFRAS  EQU   CVTS01+168                                               07071000
CVTQSAS  EQU   CVTS01+164                                               07072000
CVTCRAS  EQU   CVTS01+160                                               07073000
CVTDELCP EQU   CVTS01+152                                               07074000
CVTFRECL EQU   CVTS01+148                                               07075000
CVTGETCL EQU   CVTS01+144                                               07076000
CVTBLDCP EQU   CVTS01+140                                               07077000
CVTAUTHL EQU   CVTS01+136                                               07078000
CVTSCAN  EQU   CVTS01+132                                               07079000
CVTRV144 EQU   CVTS01+130                                               07080000
CVTMAXMP EQU   CVTS01+128                                               07081000
CVTSTCK  EQU   CVTS01+124                                               07082000
CVTRV139 EQU   CVTS01+123                                               07083000
CVTDSSAC EQU   CVTS01+122                                               07084000
CVTRV513 EQU   CVTS01+121                                               07085000
CVTIOSPL EQU   CVTS01+120                                               07086000
CVTPTGT  EQU   CVTS01+116                                               07087000
CVTCSPIE EQU   CVTS01+112                                               07088000
CVTSMFEX EQU   CVTS01+108                                               07089000
CVTOLT0A EQU   CVTS01+104                                               07090000
CVTSRBRT EQU   CVTS01+100                                               07091000
CVTPUTL  EQU   CVTS01+96                                                07092000
CVTASCRL EQU   CVTS01+92                                                07093000
CVTASCRF EQU   CVTS01+88                                                07094000
CVTRV326 EQU   CVTS01+84                                                07095000
CVTRV325 EQU   CVTS01+80                                                07096000
CVTRV324 EQU   CVTS01+76                                                07097000
CVT0VL01 EQU   CVTS01+72                                                07098000
CVTSHRVM EQU   CVTS01+68                                                07099000
CVTRV332 EQU   CVTS01+64                                                07100000
CVTTAS   EQU   CVTS01+60                                                07101000
CVTRSCN  EQU   CVTS01+56                                                07102000
CVTTRAC2 EQU   CVTS01+54                                                07103000
CVTTRACE EQU   CVTS01+52                                                07104000
CVTAPG   EQU   CVTS01+51                                                07105000
CVTSDTRC EQU   CVTCTLFG                                                 07106000
CVTGTRCE EQU   CVTCTLFG                                                 07107000
CVTNOMP  EQU   CVTCTLFG                                                 07108000
CVTRSV79 EQU   CVTCTLFG                                                 07109000
CVTDSTAT EQU   CVTCTLFG                                                 07110000
CVTRSV78 EQU   CVTCTLFG                                                 07111000
CVTRV333 EQU   CVTCTLFG                                                 07112000
CVTRV323 EQU   CVTCTLFG                                                 07113000
CVTSPVLK EQU   CVTS01+49                                                07114000
CVTRSV77 EQU   CVTS01+48                                                07115000
CVTRV331 EQU   CVTS01+44                                                07116000
CVTRV330 EQU   CVTS01+40                                                07117000
CVTRV329 EQU   CVTS01+36                                                07118000
CVTRV328 EQU   CVTS01+32                                                07119000
CVTRV322 EQU   CVTS01+28                                                07120000
CVTSLID  EQU   CVTSLIDA+1                                               07121000
CVTSYLK  EQU   CVTSLIDA                                                 07122000
CVTRV321 EQU   CVTS01+20                                                07123000
CVTRV320 EQU   CVTS01+16                                                07124000
CVTLPDIR EQU   CVTLPDIA+1                                               07125000
CVTRSV69 EQU   CVTDIRST                                                 07126000
CVTRSV68 EQU   CVTDIRST                                                 07127000
CVTRSV67 EQU   CVTDIRST                                                 07128000
CVTRSV66 EQU   CVTDIRST                                                 07129000
CVTRSV65 EQU   CVTDIRST                                                 07130000
CVTRSV64 EQU   CVTDIRST                                                 07131000
CVTRSV63 EQU   CVTDIRST                                                 07132000
CVTDICOM EQU   CVTDIRST                                                 07133000
CVTPVTP  EQU   CVTS01+8                                                 07134000
CVTLPDSR EQU   CVTS01+4                                                 07135000
CVTGETL  EQU   CVTS01                                                   07136000
@NM00171 EQU   CIRBAREA+384                                             07137000
@NM00170 EQU   CIRBAREA+352                                             07138000
@NM00169 EQU   CIRBAREA+56                                              07139000
@NM00168 EQU   CIRBAREA+24                                              07140000
@NM00167 EQU   CIRBAREA                                                 07141000
ATFRRW6  EQU   ATFRRWA+20                                               07142000
ATFRRW5  EQU   ATFRRWA+16                                               07143000
ATFRRW4  EQU   ATFRRWA+12                                               07144000
ATFRRW3  EQU   ATFRRWA+8                                                07145000
ATFRRW2  EQU   ATFRRWA+4                                                07146000
BYTE2    EQU   BYTES123+1                                               07147000
BYTE1    EQU   BYTES123                                                 07148000
FLAGBIT6 EQU   BYTETEST                                                 07149000
FLAGBIT5 EQU   BYTETEST                                                 07150000
FLAGBIT4 EQU   BYTETEST                                                 07151000
FLAGBIT3 EQU   BYTETEST                                                 07152000
FLAGBIT2 EQU   BYTETEST                                                 07153000
FLAGBIT1 EQU   BYTETEST                                                 07154000
FLAGBIT0 EQU   BYTETEST                                                 07155000
@NM00164 EQU   WKESTAEL+6                                               07156000
WKTBYTE  EQU   WKCONTRL+3                                               07157000
@NM00163 EQU   WKEXSAVE+10                                              07158000
@NM00162 EQU   WKFLAGS2                                                 07159000
@NM00161 EQU   WKSYSBYT                                                 07160000
@NM00160 EQU   WKAREA+128                                               07161000
@NM00159 EQU   WKAREA+116                                               07162000
WKTEMP8  EQU   WKTEMPS+28                                               07163000
WKTEMP7  EQU   WKTEMPS+24                                               07164000
WKTEMP6  EQU   WKTEMPS+20                                               07165000
WKTEMP5  EQU   WKTEMPS+16                                               07166000
WKTEMP4  EQU   WKTEMPS+12                                               07167000
WKTEMP3  EQU   WKTEMPS+8                                                07168000
WKTEMP2  EQU   WKTEMPS+4                                                07169000
@NM00158 EQU   WKAREA                                                   07170000
ATRSV038 EQU   ATTCHLST+53                                              07171000
ATRSV037 EQU   ATFLAGS1                                                 07172000
ATRSV036 EQU   ATFLAGS1                                                 07173000
ATRSV035 EQU   ATFLAGS1                                                 07174000
ATRSV034 EQU   ATFLAGS1                                                 07175000
ATRSV033 EQU   ATFLAGS1                                                 07176000
ATRSV032 EQU   ATFLAGS1                                                 07177000
ATPURGE  EQU   ATSTAIF                                                  07178000
ATRSV031 EQU   ATSTAIF                                                  07179000
ATRSV030 EQU   ATSTAIF                                                  07180000
ATRSV029 EQU   ATSTAIF                                                  07181000
ATLSQA   EQU   ATJSCBAD                                                 07182000
ATJPQ    EQU   ATINDS                                                   07183000
ATRLLOUT EQU   ATINDS2                                                  07184000
ATRLABLE EQU   ATINDS2                                                  07185000
ATRSV028 EQU   ATINDS2                                                  07186000
ATRSV027 EQU   ATINDS2                                                  07187000
ATRSV026 EQU   ATINDS2                                                  07188000
ATNFPRSA EQU   ATINDS2                                                  07189000
ATNTQE   EQU   ATINDS2                                                  07190000
ATSHARSP EQU   ATSHFLAG                                                 07191000
ATRSV025 EQU   ATSHFLAG                                                 07192000
ATRSV024 EQU   ATSHFLAG                                                 07193000
ATRSV023 EQU   ATSHFLAG                                                 07194000
ATRSV022 EQU   ATSHFLAG                                                 07195000
ATRSV021 EQU   ATSHFLAG                                                 07196000
ATRSV020 EQU   ATSHFLAG                                                 07197000
ATRSV019 EQU   ATSHFLAG                                                 07198000
ATGIVESP EQU   ATGSFLAG                                                 07199000
ATRSV018 EQU   ATGSFLAG                                                 07200000
ATRSV017 EQU   ATGSFLAG                                                 07201000
ATRSV016 EQU   ATGSFLAG                                                 07202000
ATRSV015 EQU   ATGSFLAG                                                 07203000
ATRSV014 EQU   ATGSFLAG                                                 07204000
ATRSV013 EQU   ATGSFLAG                                                 07205000
ATRSV012 EQU   ATGSFLAG                                                 07206000
ATLOGON  EQU   ATECBFLG                                                 07207000
ATRSV011 EQU   ATECBFLG                                                 07208000
ATRSV010 EQU   ATECBFLG                                                 07209000
ATRSV009 EQU   ATECBFLG                                                 07210000
ATRSV008 EQU   ATECBFLG                                                 07211000
ATHARCHY EQU   ATDCBADA                                                 07212000
ATRSV007 EQU   ATDEFLAG                                                 07213000
ATRSV006 EQU   ATDEFLAG                                                 07214000
ATRSV005 EQU   ATDEFLAG                                                 07215000
ATRSV004 EQU   ATDEFLAG                                                 07216000
ATRSV003 EQU   ATDEFLAG                                                 07217000
ATRSV002 EQU   ATDEFLAG                                                 07218000
ATRSV001 EQU   ATDEFLAG                                                 07219000
SCBRSVRE EQU   SCBDATA+3                                                07220000
SCBID    EQU   SCBDATA+2                                                07221000
SCBPKEY  EQU   SCBDATA+1                                                07222000
@NM00157 EQU   SCBFLGS3                                                 07223000
SCBTERMO EQU   SCBFLGS3                                                 07224000
SCBBRNTR EQU   SCBFLGS3                                                 07225000
SCBPRNTR EQU   SCBFLGS3                                                 07226000
SCBCNCEL EQU   SCBFLGS3                                                 07227000
SCBRECRD EQU   SCBFLGS3                                                 07228000
SCBTERMI EQU   SCBFLGS3                                                 07229000
@NM00156 EQU   SCBFLGS3                                                 07230000
SCBOWNRA EQU   SCBOWNR+1                                                07231000
SCBSUPER EQU   SCBFLGS2                                                 07232000
SCBKEY0  EQU   SCBFLGS2                                                 07233000
@NM00155 EQU   SCBFLGS2                                                 07234000
@NM00154 EQU   SCBFLGS2                                                 07235000
SCBINUSE EQU   SCBFLGS2                                                 07236000
@NM00153 EQU   SCBFLGS2                                                 07237000
SCBXCTL2 EQU   SCBFLGS2                                                 07238000
@NM00152 EQU   SCBFLGS2                                                 07239000
SCBPARMA EQU   SCBPARM+1                                                07240000
SCBHALT  EQU   SCBIOPRC                                                 07241000
SCBNOIOP EQU   SCBIOPRC                                                 07242000
SCBASYNC EQU   SCBFLGS1                                                 07243000
@NM00151 EQU   SCBFLGS1                                                 07244000
SCBESTAE EQU   SCBFLGS1                                                 07245000
SCBDUMMY EQU   SCBFLGS1                                                 07246000
SCBSTAR  EQU   SCBFLGS1                                                 07247000
SCBSTAI  EQU   SCBFLGS1                                                 07248000
SCBEXIT  EQU   SCB+4                                                    07249000
SCBCHAIN EQU   SCB                                                      07250000
SVRBEND  EQU   RBSECT+192                                               07251000
RBFEPARM EQU   RBSECT+168                                               07252000
SIRBEND  EQU   RBSECT+168                                               07253000
RBRSV158 EQU   RBRSV150                                                 07254000
RBRSV157 EQU   RBRSV150                                                 07255000
RBRSV156 EQU   RBRSV150                                                 07256000
RBRSV155 EQU   RBRSV150                                                 07257000
RBRSV154 EQU   RBRSV150                                                 07258000
RBRSV153 EQU   RBRSV150                                                 07259000
RBRSV152 EQU   RBRSV150                                                 07260000
RBRSV151 EQU   RBRSV150                                                 07261000
RBRSV149 EQU   RBSECT+166                                               07262000
RBRSV148 EQU   RBSECT+164                                               07263000
RBRSV169 EQU   RBSDATA+3                                                07264000
RBSID    EQU   RBSDATA+2                                                07265000
RBSPKEY  EQU   RBSDATA+1                                                07266000
RBRSV168 EQU   RBSFLG3                                                  07267000
RBSTERMO EQU   RBSFLG3                                                  07268000
RBSBRNTR EQU   RBSFLG3                                                  07269000
RBSPRNTR EQU   RBSFLG3                                                  07270000
RBSCNCEL EQU   RBSFLG3                                                  07271000
RBSRECRD EQU   RBSFLG3                                                  07272000
RBSTERMI EQU   RBSFLG3                                                  07273000
RBRSV167 EQU   RBSFLG3                                                  07274000
RBSOWNRA EQU   RBSOWNR+1                                                07275000
RBSSUPER EQU   RBSFLGS2                                                 07276000
RBSKEY0  EQU   RBSFLGS2                                                 07277000
RBRSV166 EQU   RBSFLGS2                                                 07278000
RBRSV165 EQU   RBSFLGS2                                                 07279000
RBSINUSE EQU   RBSFLGS2                                                 07280000
RBRSV164 EQU   RBSFLGS2                                                 07281000
RBSXCTL2 EQU   RBSFLGS2                                                 07282000
RBRSV163 EQU   RBSFLGS2                                                 07283000
RBSPARMA EQU   RBSPARM+1                                                07284000
RBSHALT  EQU   RBSIOPRC                                                 07285000
RBSNOIOP EQU   RBSIOPRC                                                 07286000
RBSASYNC EQU   RBSFLGS1                                                 07287000
RBRSV162 EQU   RBSFLGS1                                                 07288000
RBSESTAE EQU   RBSFLGS1                                                 07289000
RBSDUMMY EQU   RBSFLGS1                                                 07290000
RBSSTAR  EQU   RBSFLGS1                                                 07291000
RBSSTAI  EQU   RBSFLGS1                                                 07292000
RBSEXIT  EQU   RBSCBB+4                                                 07293000
RBSCHAIN EQU   RBSCBB                                                   07294000
TIRBEND  EQU   @NM00149+8                                               07295000
PRBEND   EQU   @NM00149+8                                               07296000
RBRSV146 EQU   RBRSV138                                                 07297000
RBRSV145 EQU   RBRSV138                                                 07298000
RBRSV144 EQU   RBRSV138                                                 07299000
RBRSV143 EQU   RBRSV138                                                 07300000
RBRSV142 EQU   RBRSV138                                                 07301000
RBRSV141 EQU   RBRSV138                                                 07302000
RBRSV140 EQU   RBRSV138                                                 07303000
RBRSV139 EQU   RBRSV138                                                 07304000
RBRSV137 EQU   @NM00149+6                                               07305000
RBRSV136 EQU   @NM00149+4                                               07306000
RBRSV135 EQU   @NM00149                                                 07307000
@NM00148 EQU   RBSECT+32                                                07308000
@NM00147 EQU   @NM00145+1                                               07309000
RBSCF    EQU   @NM00146                                                 07310000
RBPGMQ1  EQU   RBPGMQ+1                                                 07311000
@NM00144 EQU   RBPGMQ                                                   07312000
@NM00143 EQU   RBSECT+16                                                07313000
@NM00142 EQU   @NM00138                                                 07314000
@NM00141 EQU   @NM00138                                                 07315000
RBUSIQE  EQU   RBETXR                                                   07316000
@NM00140 EQU   @NM00138                                                 07317000
@NM00139 EQU   @NM00138                                                 07318000
RBPMSVRB EQU   @NM00136                                                 07319000
RBATNXIT EQU   @NM00136                                                 07320000
@NM00137 EQU   @NM00136                                                 07321000
RBWAITP  EQU   @NM00136                                                 07322000
RBFNSVRB EQU   RBTRSVRB                                                 07323000
RBABOPSW EQU   RBSECT+4                                                 07324000
@NM00134 EQU   RBPPSAV                                                  07325000
RBINTCOD EQU   RBINTCDA+1                                               07326000
RBINLNTH EQU   RBINTCDA                                                 07327000
RBWCSA   EQU   RBPREFIX+60                                              07328000
RBRSV004 EQU   RBPREFIX+57                                              07329000
RBSSSYN  EQU   RBFLAGS1                                                 07330000
RBSCB    EQU   RBFLAGS1                                                 07331000
RBLONGWT EQU   RBFLAGS1                                                 07332000
RBASIR   EQU   RBFLAGS1                                                 07333000
RBRSV159 EQU   RBFLAGS1                                                 07334000
RBABEND  EQU   RBFLAGS1                                                 07335000
RBXWAIT  EQU   RBFLAGS1                                                 07336000
RBSLOCK  EQU   RBFLAGS1                                                 07337000
RBRTRAN  EQU   RBRTPSW2+4                                               07338000
RBRTINCD EQU   RBRTICIL+2                                               07339000
RBRTILC  EQU   RBRTICIL+1                                               07340000
RBRSV160 EQU   RBRTICIL                                                 07341000
RBRTPSW1 EQU   RBRTOPSW                                                 07342000
RBRSV062 EQU   RBRSV054                                                 07343000
RBRSV061 EQU   RBRSV054                                                 07344000
RBRSV060 EQU   RBRSV054                                                 07345000
RBRSV059 EQU   RBRSV054                                                 07346000
RBRSV058 EQU   RBRSV054                                                 07347000
RBRSV057 EQU   RBRSV054                                                 07348000
RBRSV056 EQU   RBRSV054                                                 07349000
RBRSV055 EQU   RBRSV054                                                 07350000
RBRSV053 EQU   RBPREFIX+38                                              07351000
RBRSV052 EQU   RBPREFIX+36                                              07352000
RBRSV051 EQU   RBPREFIX+32                                              07353000
RBRSV050 EQU   RBPREFIX+28                                              07354000
RBRSV049 EQU   RBRSV041                                                 07355000
RBRSV048 EQU   RBRSV041                                                 07356000
RBRSV047 EQU   RBRSV041                                                 07357000
RBRSV046 EQU   RBRSV041                                                 07358000
RBRSV045 EQU   RBRSV041                                                 07359000
RBRSV044 EQU   RBRSV041                                                 07360000
RBRSV043 EQU   RBRSV041                                                 07361000
RBRSV042 EQU   RBRSV041                                                 07362000
RBRSV040 EQU   RBPREFIX+26                                              07363000
RBRSV039 EQU   RBPREFIX+24                                              07364000
RBRSV038 EQU   RBPREFIX+20                                              07365000
RBRSV037 EQU   RBPREFIX+16                                              07366000
RBRSV036 EQU   RBRSV028                                                 07367000
RBRSV035 EQU   RBRSV028                                                 07368000
RBRSV034 EQU   RBRSV028                                                 07369000
RBRSV033 EQU   RBRSV028                                                 07370000
RBRSV032 EQU   RBRSV028                                                 07371000
RBRSV031 EQU   RBRSV028                                                 07372000
RBRSV030 EQU   RBRSV028                                                 07373000
RBRSV029 EQU   RBRSV028                                                 07374000
RBRSV027 EQU   RBRSV019                                                 07375000
RBRSV026 EQU   RBRSV019                                                 07376000
RBRSV025 EQU   RBRSV019                                                 07377000
RBRSV024 EQU   RBRSV019                                                 07378000
RBRSV023 EQU   RBRSV019                                                 07379000
RBRSV022 EQU   RBRSV019                                                 07380000
RBRSV021 EQU   RBRSV019                                                 07381000
RBRSV020 EQU   RBRSV019                                                 07382000
RBRSV018 EQU   RBPREFIX+13                                              07383000
RBRSV017 EQU   RBPREFIX+12                                              07384000
RBSRV016 EQU   RBPREFIX+11                                              07385000
RBRSV015 EQU   RBPREFIX+10                                              07386000
RBRSV014 EQU   RBPREFIX+8                                               07387000
RBRSV013 EQU   RBPREFIX+4                                               07388000
RBRSV012 EQU   RBPREFIX                                                 07389000
XRBREG15 EQU   RBGRS15                                                  07390000
XRBREG14 EQU   RBGRS14                                                  07391000
XRBREG13 EQU   RBGRS13                                                  07392000
XRBREG12 EQU   RBGRS12                                                  07393000
XRBREG11 EQU   RBGRS11                                                  07394000
XRBREG10 EQU   RBGRS10                                                  07395000
XRBREG9  EQU   RBGRS9                                                   07396000
XRBREG8  EQU   RBGRS8                                                   07397000
XRBREG7  EQU   RBGRS7                                                   07398000
XRBREG6  EQU   RBGRS6                                                   07399000
XRBREG5  EQU   RBGRS5                                                   07400000
XRBREG4  EQU   RBGRS4                                                   07401000
XRBREG3  EQU   RBGRS3                                                   07402000
XRBREG2  EQU   RBGRS2                                                   07403000
XRBREG1  EQU   RBGRS1                                                   07404000
XRBREG0  EQU   RBGRS0                                                   07405000
XRBLNKA  EQU   RBLINKB                                                  07406000
XRBWT    EQU   RBWCF                                                    07407000
@NM00133 EQU   RBBASIC+24                                               07408000
RBOPSWPS EQU   RBOPSWB2                                                 07409000
@NM00132 EQU   RBOPSWB2                                                 07410000
@NM00131 EQU   XRBPSW                                                   07411000
@NM00130 EQU   RBBASIC+12                                               07412000
XRBWAIT  EQU   RBECBWT                                                  07413000
XRBFRRB  EQU   RBFDYN                                                   07414000
@NM00129 EQU   XSTAB2                                                   07415000
XRBACTV  EQU   RBFACTV                                                  07416000
XRBTCBP  EQU   RBTCBNXT                                                 07417000
@NM00128 EQU   XSTAB1                                                   07418000
XRBCKPT  EQU   RBFTCKPT                                                 07419000
@NM00127 EQU   XSTAB1                                                   07420000
@NM00126 EQU   RBBASIC+8                                                07421000
@NM00125 EQU   RBEXRTNM+1                                               07422000
RBTMIND3 EQU   RBTMFLD                                                  07423000
RBTMIND2 EQU   RBTMFLD                                                  07424000
RBTMCMP  EQU   RBTMFLD                                                  07425000
RBWLIM   EQU   RBTMFLD                                                  07426000
RBRSV005 EQU   RBTMFLD                                                  07427000
RBTMTOD  EQU   RBTMFLD                                                  07428000
RBTMQUE  EQU   RBTMFLD                                                  07429000
@NM00124 EQU   RBPRFX                                                   07430000
ESTARSVI EQU   ESTAFGRS+1                                               07431000
@NM00123 EQU   ESTAFLG2                                                 07432000
ESTABRNT EQU   ESTAFLG2                                                 07433000
@NM00122 EQU   ESTAFLG2                                                 07434000
ESTAEREC EQU   ESTAFLG2                                                 07435000
@NM00121 EQU   ESTAFLG2                                                 07436000
ESTAHALT EQU   ESTAIO                                                   07437000
ESTANOIO EQU   ESTAIO                                                   07438000
@NM00120 EQU   ESTAFLG1                                                 07439000
@NM00119 EQU   ESTAFLG1                                                 07440000
ESTASTAR EQU   ESTAFLG1                                                 07441000
@NM00118 EQU   FRRSFLGS+1                                               07442000
@NM00117 EQU   FRRSFLG1                                                 07443000
FRRSNEST EQU   FRRSFLG1                                                 07444000
FRRSRCUR EQU   FRRSFLG1                                                 07445000
FRRSENTS EQU   FRRS+84                                                  07446000
FRRSRTMW EQU   FRRS+16                                                  07447000
@NM00092 EQU   SDWA+512                                                 07448000
@NM00091 EQU   SDWADPVA                                                 07449000
SDWAEBC  EQU   SDWADPVA                                                 07450000
SDWAHEX  EQU   SDWADPVA                                                 07451000
@NM00090 EQU   SDWA+396                                                 07452000
SDWACOMP EQU   SDWA+392                                                 07453000
SDWARCPL EQU   SDWA+364                                                 07454000
@NM00089 EQU   SDWADPSA+32                                              07455000
SDWATO4  EQU   SDWADPSL+28                                              07456000
SDWAFRM4 EQU   SDWADPSL+24                                              07457000
SDWATO3  EQU   SDWADPSL+20                                              07458000
SDWAFRM3 EQU   SDWADPSL+16                                              07459000
SDWATO2  EQU   SDWADPSL+12                                              07460000
SDWAFRM2 EQU   SDWADPSL+8                                               07461000
SDWATO1  EQU   SDWADPSL+4                                               07462000
SDWAFRM1 EQU   SDWADPSL                                                 07463000
@NM00088 EQU   SDWADDAT+3                                               07464000
@NM00087 EQU   SDWAPDAT                                                 07465000
SDWAUSPL EQU   SDWAPDAT                                                 07466000
SDWADPSW EQU   SDWAPDAT                                                 07467000
SDWATJPA EQU   SDWAPDAT                                                 07468000
SDWATLPA EQU   SDWAPDAT                                                 07469000
SDWADREG EQU   SDWAPDAT                                                 07470000
SDWADSAH EQU   SDWAPDAT                                                 07471000
SDWADSAS EQU   SDWAPDAT                                                 07472000
@NM00086 EQU   SDWADDAT+1                                               07473000
@NM00085 EQU   SDWASDAT                                                 07474000
SDWAQQS  EQU   SDWASDAT                                                 07475000
SDWACBS  EQU   SDWASDAT                                                 07476000
SDWAGTF  EQU   SDWASDAT                                                 07477000
SDWASWA  EQU   SDWASDAT                                                 07478000
SDWALSQA EQU   SDWASDAT                                                 07479000
SDWASQA  EQU   SDWASDAT                                                 07480000
SDWANUC  EQU   SDWASDAT                                                 07481000
@NM00084 EQU   SDWADUMP+2                                               07482000
@NM00083 EQU   SDWADPFS                                                 07483000
SDWASLST EQU   SDWADPFS                                                 07484000
@NM00082 EQU   SDWADPFS                                                 07485000
SDWADLST EQU   SDWADPFS                                                 07486000
SDWADPT  EQU   SDWADPFS                                                 07487000
SDWADPID EQU   SDWADUMP                                                 07488000
SDWADPLA EQU   SDWA+316                                                 07489000
SDWACSCT EQU   SDWARECP+8                                               07490000
SDWAMODN EQU   SDWARECP                                                 07491000
@NM00081 EQU   SDWA+290                                                 07492000
SDWAASID EQU   SDWA+288                                                 07493000
SDWATALW EQU   SDWALKWS+28                                              07494000
SDWATDLW EQU   SDWALKWS+24                                              07495000
SDWATNLW EQU   SDWALKWS+20                                              07496000
SDWAAPLW EQU   SDWALKWS+16                                              07497000
SDWAIPLW EQU   SDWALKWS+12                                              07498000
SDWAILLW EQU   SDWALKWS+8                                               07499000
SDWAIULW EQU   SDWALKWS+4                                               07500000
SDWAICLW EQU   SDWALKWS                                                 07501000
SDWAFLLK EQU   SDWAACF4                                                 07502000
SDWACMS  EQU   SDWAACF4                                                 07503000
SDWAOPTM EQU   SDWAACF4                                                 07504000
SDWATADB EQU   SDWAACF4                                                 07505000
SDWATDNB EQU   SDWAACF4                                                 07506000
SDWATNCB EQU   SDWAACF4                                                 07507000
SDWAILCH EQU   SDWAACF4                                                 07508000
SDWAIUCB EQU   SDWAACF4                                                 07509000
SDWAICAT EQU   SDWAACF3                                                 07510000
SDWAIPRG EQU   SDWAACF3                                                 07511000
SDWASALL EQU   SDWAACF3                                                 07512000
SDWAASMP EQU   SDWAACF3                                                 07513000
SDWADISP EQU   SDWAACF3                                                 07514000
@NM00080 EQU   SDWAACF3                                                 07515000
@NM00079 EQU   SDWAACF2                                                 07516000
SDWAFREE EQU   SDWAACF2                                                 07517000
SDWAUPRG EQU   SDWAACF2                                                 07518000
@NM00078 EQU   SDWAACF2                                                 07519000
SDWASPIN EQU   SDWAACF2                                                 07520000
@NM00077 EQU   SDWAACF2                                                 07521000
SDWALCPU EQU   SDWACPUA+2                                               07522000
@NM00076 EQU   SDWACPUA                                                 07523000
SDWARECA EQU   SDWA+244                                                 07524000
SDWARTYA EQU   SDWA+240                                                 07525000
@NM00075 EQU   SDWA+239                                                 07526000
@NM00074 EQU   SDWAIOFS                                                 07527000
SDWANIOP EQU   SDWAIOFS                                                 07528000
SDWANOIO EQU   SDWAIOFS                                                 07529000
SDWAIOHT EQU   SDWAIOFS                                                 07530000
SDWAIOQR EQU   SDWAIOFS                                                 07531000
@NM00073 EQU   SDWAERRD                                                 07532000
SDWAMCIV EQU   SDWAERRD                                                 07533000
SDWARPIV EQU   SDWAERRD                                                 07534000
SDWAMABD EQU   SDWAERRD                                                 07535000
SDWACTS  EQU   SDWAERRD                                                 07536000
SDWASTAE EQU   SDWAERRD                                                 07537000
SDWANRBE EQU   SDWAERRD                                                 07538000
SDWACLUP EQU   SDWAERRD                                                 07539000
@NM00072 EQU   SDWAERRC                                                 07540000
SDWAEAS  EQU   SDWAERRC                                                 07541000
SDWAPERC EQU   SDWAERRC                                                 07542000
SDWAIRB  EQU   SDWAERRC                                                 07543000
SDWASTAI EQU   SDWAERRC                                                 07544000
SDWASTAF EQU   SDWAERRC                                                 07545000
SDWASRBM EQU   SDWAERRB                                                 07546000
SDWALDIS EQU   SDWAERRB                                                 07547000
SDWAENRB EQU   SDWAERRB                                                 07548000
SDWATYP1 EQU   SDWAERRB                                                 07549000
@NM00071 EQU   SDWAERRB                                                 07550000
SDWAPGIO EQU   SDWAERRA                                                 07551000
SDWATEXC EQU   SDWAERRA                                                 07552000
SDWASVCE EQU   SDWAERRA                                                 07553000
SDWAABTM EQU   SDWAERRA                                                 07554000
SDWASVCD EQU   SDWAERRA                                                 07555000
SDWARKEY EQU   SDWAERRA                                                 07556000
SDWAMCHK EQU   SDWAERRA                                                 07557000
SDWATIME EQU   SDWAMCH+20                                               07558000
SDWARFSA EQU   SDWAMCH+16                                               07559000
@NM00070 EQU   SDWAMCH+14                                               07560000
SDWAVEQR EQU   SDWARSR2                                                 07561000
SDWAPGFX EQU   SDWARSR2                                                 07562000
SDWAFLSQ EQU   SDWARSR2                                                 07563000
SDWAFSQA EQU   SDWARSR2                                                 07564000
SDWANUCL EQU   SDWARSR2                                                 07565000
SDWASPER EQU   SDWARSR2                                                 07566000
SDWAINTC EQU   SDWARSR2                                                 07567000
SDWAOFLN EQU   SDWARSR2                                                 07568000
SDWACHNG EQU   SDWARSR1                                                 07569000
SDWAMSER EQU   SDWARSR1                                                 07570000
@NM00069 EQU   SDWARSR1                                                 07571000
SDWACPID EQU   SDWAMCH+10                                               07572000
SDWATERR EQU   SDWAMCHD                                                 07573000
SDWAFPRX EQU   SDWAMCHD                                                 07574000
SDWAINSF EQU   SDWAMCHD                                                 07575000
SDWAACR  EQU   SDWAMCHD                                                 07576000
SDWASCK  EQU   SDWAMCHD                                                 07577000
SDWAPSWU EQU   SDWAMCHD                                                 07578000
SDWAREGU EQU   SDWAMCHD                                                 07579000
SDWASKYF EQU   SDWAMCHD                                                 07580000
@NM00068 EQU   SDWAMCHS                                                 07581000
SDWARSRF EQU   SDWAMCHS                                                 07582000
SDWARSRC EQU   SDWAMCHS                                                 07583000
SDWAINVP EQU   SDWAMCHS                                                 07584000
SDWATSVL EQU   SDWAMCHS                                                 07585000
SDWARCDF EQU   SDWAMCHS                                                 07586000
SDWASRVL EQU   SDWAMCHS                                                 07587000
SDWASCKE EQU   SDWASTCK+4                                               07588000
SDWASCKB EQU   SDWASTCK                                                 07589000
SDWALNTH EQU   SDWAIDNT+1                                               07590000
SDWASPID EQU   SDWAIDNT                                                 07591000
SDWASR15 EQU   SDWASRSV+60                                              07592000
SDWASR14 EQU   SDWASRSV+56                                              07593000
SDWASR13 EQU   SDWASRSV+52                                              07594000
SDWASR12 EQU   SDWASRSV+48                                              07595000
SDWASR11 EQU   SDWASRSV+44                                              07596000
SDWASR10 EQU   SDWASRSV+40                                              07597000
SDWASR09 EQU   SDWASRSV+36                                              07598000
SDWASR08 EQU   SDWASRSV+32                                              07599000
SDWASR07 EQU   SDWASRSV+28                                              07600000
SDWASR06 EQU   SDWASRSV+24                                              07601000
SDWASR05 EQU   SDWASRSV+20                                              07602000
SDWASR04 EQU   SDWASRSV+16                                              07603000
SDWASR03 EQU   SDWASRSV+12                                              07604000
SDWASR02 EQU   SDWASRSV+8                                               07605000
SDWASR01 EQU   SDWASRSV+4                                               07606000
SDWASR00 EQU   SDWASRSV                                                 07607000
SDWATRN2 EQU   SDWAAEC2+4                                               07608000
SDWAIPC2 EQU   SDWAICD2                                                 07609000
SDWAIMC2 EQU   SDWAICD2                                                 07610000
SDWAIPR2 EQU   SDWAICD2                                                 07611000
@NM00067 EQU   SDWAINC2                                                 07612000
@NM00066 EQU   SDWAILC2                                                 07613000
SDWAIL2  EQU   SDWAILC2                                                 07614000
@NM00065 EQU   SDWAILC2                                                 07615000
@NM00064 EQU   SDWAAEC2                                                 07616000
SDWAADD2 EQU   SDWANXT2+1                                               07617000
@NM00063 EQU   SDWANXT2                                                 07618000
@NM00062 EQU   SDWAEC2+3                                                07619000
SDWASGN2 EQU   SDWAINT2                                                 07620000
SDWAEXP2 EQU   SDWAINT2                                                 07621000
SDWADEC2 EQU   SDWAINT2                                                 07622000
SDWAFPO2 EQU   SDWAINT2                                                 07623000
SDWACC2  EQU   SDWAINT2                                                 07624000
@NM00061 EQU   SDWAINT2                                                 07625000
SDWAPGM2 EQU   SDWAMWP2                                                 07626000
SDWAWAT2 EQU   SDWAMWP2                                                 07627000
SDWAMCK2 EQU   SDWAMWP2                                                 07628000
SDWAECT2 EQU   SDWAMWP2                                                 07629000
SDWAKEY2 EQU   SDWAMWP2                                                 07630000
SDWAEXT2 EQU   SDWAEMK2                                                 07631000
SDWAIO2  EQU   SDWAEMK2                                                 07632000
SDWATRM2 EQU   SDWAEMK2                                                 07633000
@NM00060 EQU   SDWAEMK2                                                 07634000
SDWAPER2 EQU   SDWAEMK2                                                 07635000
@NM00059 EQU   SDWAEMK2                                                 07636000
SDWATRAN EQU   SDWAAEC1+4                                               07637000
SDWAIPC1 EQU   SDWAICD1                                                 07638000
SDWAIMC1 EQU   SDWAICD1                                                 07639000
SDWAIPR1 EQU   SDWAICD1                                                 07640000
@NM00058 EQU   SDWAINC1                                                 07641000
@NM00057 EQU   SDWAILC1                                                 07642000
SDWAIL1  EQU   SDWAILC1                                                 07643000
@NM00056 EQU   SDWAILC1                                                 07644000
@NM00055 EQU   SDWAAEC1                                                 07645000
SDWAADD1 EQU   SDWANXT1+1                                               07646000
@NM00054 EQU   SDWANXT1                                                 07647000
@NM00053 EQU   SDWAEC1+3                                                07648000
SDWASGN1 EQU   SDWAINT1                                                 07649000
SDWAEXP1 EQU   SDWAINT1                                                 07650000
SDWADEC1 EQU   SDWAINT1                                                 07651000
SDWAFPO1 EQU   SDWAINT1                                                 07652000
SDWACC1  EQU   SDWAINT1                                                 07653000
@NM00052 EQU   SDWAINT1                                                 07654000
SDWAPGM1 EQU   SDWAMWP1                                                 07655000
SDWAWAT1 EQU   SDWAMWP1                                                 07656000
SDWAMCK1 EQU   SDWAMWP1                                                 07657000
SDWAECT1 EQU   SDWAMWP1                                                 07658000
SDWAKEY1 EQU   SDWAMWP1                                                 07659000
SDWAEXT1 EQU   SDWAEMK1                                                 07660000
SDWAIO1  EQU   SDWAEMK1                                                 07661000
SDWATRM1 EQU   SDWAEMK1                                                 07662000
@NM00051 EQU   SDWAEMK1                                                 07663000
SDWAPER1 EQU   SDWAEMK1                                                 07664000
@NM00050 EQU   SDWAEMK1                                                 07665000
SDWAIOBR EQU   SDWA+100                                                 07666000
SDWAEPA  EQU   SDWA+96                                                  07667000
@NM00049 EQU   SDWANAME+4                                               07668000
SDWARBAD EQU   SDWANAME                                                 07669000
SDWAGR15 EQU   SDWAGRSV+60                                              07670000
SDWAGR14 EQU   SDWAGRSV+56                                              07671000
SDWAGR13 EQU   SDWAGRSV+52                                              07672000
SDWAGR12 EQU   SDWAGRSV+48                                              07673000
SDWAGR11 EQU   SDWAGRSV+44                                              07674000
SDWAGR10 EQU   SDWAGRSV+40                                              07675000
SDWAGR09 EQU   SDWAGRSV+36                                              07676000
SDWAGR08 EQU   SDWAGRSV+32                                              07677000
SDWAGR07 EQU   SDWAGRSV+28                                              07678000
SDWAGR06 EQU   SDWAGRSV+24                                              07679000
SDWAGR05 EQU   SDWAGRSV+20                                              07680000
SDWAGR04 EQU   SDWAGRSV+16                                              07681000
SDWAGR03 EQU   SDWAGRSV+12                                              07682000
SDWAGR02 EQU   SDWAGRSV+8                                               07683000
SDWAGR01 EQU   SDWAGRSV+4                                               07684000
SDWAGR00 EQU   SDWAGRSV                                                 07685000
SDWANXTP EQU   SDWACTL2+5                                               07686000
SDWASGP  EQU   SDWAPMKP                                                 07687000
SDWAEUP  EQU   SDWAPMKP                                                 07688000
SDWADOP  EQU   SDWAPMKP                                                 07689000
SDWAFPP  EQU   SDWAPMKP                                                 07690000
SDWACCP  EQU   SDWAPMKP                                                 07691000
SDWAILP  EQU   SDWAPMKP                                                 07692000
SDWAINTP EQU   SDWACTL2+2                                               07693000
SDWASPVP EQU   SDWAMWPP                                                 07694000
SDWAWATP EQU   SDWAMWPP                                                 07695000
SDWAMCKP EQU   SDWAMWPP                                                 07696000
@NM00048 EQU   SDWAMWPP                                                 07697000
SDWAKEYP EQU   SDWAMWPP                                                 07698000
SDWAEXTP EQU   SDWACMKP                                                 07699000
SDWAIOP  EQU   SDWACMKP                                                 07700000
SDWANXTA EQU   SDWACTL1+5                                               07701000
SDWASGA  EQU   SDWAPMKA                                                 07702000
SDWAEUA  EQU   SDWAPMKA                                                 07703000
SDWADOA  EQU   SDWAPMKA                                                 07704000
SDWAFPA  EQU   SDWAPMKA                                                 07705000
SDWACCA  EQU   SDWAPMKA                                                 07706000
SDWAILA  EQU   SDWAPMKA                                                 07707000
SDWAINTA EQU   SDWACTL1+2                                               07708000
SDWASPVA EQU   SDWAMWPA                                                 07709000
SDWAWATA EQU   SDWAMWPA                                                 07710000
SDWAMCKA EQU   SDWAMWPA                                                 07711000
@NM00047 EQU   SDWAMWPA                                                 07712000
SDWAKEYA EQU   SDWAMWPA                                                 07713000
SDWAEXTA EQU   SDWACMKA                                                 07714000
SDWAIOA  EQU   SDWACMKA                                                 07715000
@NM00046 EQU   SDWACMPF                                                 07716000
SDWASTCC EQU   SDWACMPF                                                 07717000
@NM00045 EQU   SDWACMPF                                                 07718000
SDWASTEP EQU   SDWACMPF                                                 07719000
PDSS04ND EQU   PDSS04+2                                                 07720000
PDSAPFAC EQU   PDSAPF+1                                                 07721000
PDSAPFCT EQU   PDSAPF                                                   07722000
PDSS03ND EQU   PDSS03+4                                                 07723000
PDSMBRSN EQU   PDSSSIWD+2                                               07724000
PDSIBMMB EQU   PDSSSIFB                                                 07725000
PDSSYSGN EQU   PDSSSIFB                                                 07726000
PDSDEPCH EQU   PDSSSIFB                                                 07727000
PDSEMFIX EQU   PDSSSIFB                                                 07728000
PDSUSRCH EQU   PDSSSIFB                                                 07729000
PDSFORCE EQU   PDSSSIFB                                                 07730000
@NM00044 EQU   PDSSSIFB                                                 07731000
PDSCHLVL EQU   PDSSSIWD                                                 07732000
PDSS02ND EQU   PDSS02+11                                                07733000
PDS2MNM  EQU   PDSS02+3                                                 07734000
PDS2EPM  EQU   PDSS02                                                   07735000
PDSS01ND EQU   PDSS01+8                                                 07736000
PDS2ESDC EQU   PDSS01+6                                                 07737000
PDS2ESDT EQU   PDSS01+4                                                 07738000
PDS2TTSZ EQU   PDSS01+2                                                 07739000
PDS2SLSZ EQU   PDSS01                                                   07740000
PDSBCEND EQU   PDS2+35                                                  07741000
PDS2FTB3 EQU   PDS2FTBO+2                                               07742000
PDS2FTB2 EQU   PDS2FTBO+1                                               07743000
@NM00043 EQU   PDS2FTB1                                                 07744000
PDSAPFLG EQU   PDS2FTB1                                                 07745000
PDS2SSI  EQU   PDS2FTB1                                                 07746000
PDS2PAGA EQU   PDS2FTB1                                                 07747000
@NM00042 EQU   PDS2FTB1                                                 07748000
PDSAOSLE EQU   PDS2FTB1                                                 07749000
PDS2EPA  EQU   PDS2+29                                                  07750000
PDS2FTBL EQU   PDS2+27                                                  07751000
PDS2STOR EQU   PDS2+24                                                  07752000
PDS2REFR EQU   PDS2ATR2                                                 07753000
PDS2LEF  EQU   PDS2ATR2                                                 07754000
PDS2TSTN EQU   PDS2ATR2                                                 07755000
PDS2NREP EQU   PDS2ATR2                                                 07756000
PDS2NRLD EQU   PDS2ATR2                                                 07757000
PDS2EP0  EQU   PDS2ATR2                                                 07758000
PDS2ORG0 EQU   PDS2ATR2                                                 07759000
PDS2FLVL EQU   PDS2ATR2                                                 07760000
PDS21BLK EQU   PDS2ATR1                                                 07761000
PDS2EXEC EQU   PDS2ATR1                                                 07762000
PDS2SCTR EQU   PDS2ATR1                                                 07763000
PDS2LOAD EQU   PDS2ATR1                                                 07764000
PDS2TEST EQU   PDS2ATR1                                                 07765000
PDS2OVLY EQU   PDS2ATR1                                                 07766000
PDS2REUS EQU   PDS2ATR1                                                 07767000
PDS2RENT EQU   PDS2ATR1                                                 07768000
PDS2NL   EQU   PDS2+21                                                  07769000
PDS2TTRN EQU   PDS2+18                                                  07770000
PDS2ZERO EQU   PDS2+17                                                  07771000
PDS2LUSR EQU   PDS2INDC                                                 07772000
PDS2NTTR EQU   PDS2INDC                                                 07773000
PDS2ALIS EQU   PDS2INDC                                                 07774000
PDS2LIBF EQU   PDS2+12                                                  07775000
PDS2CNCT EQU   PDS2+11                                                  07776000
PDS2TTRP EQU   PDS2+8                                                   07777000
PDS2NAME EQU   PDS2                                                     07778000
@NM00040 EQU   SCVTSECT+180                                             07779000
@NM00039 EQU   SCVTSECT+176                                             07780000
SCVTPIQE EQU   SCVTSECT+172                                             07781000
@NM00038 EQU   SCVTSECT+168                                             07782000
SCVTPTRM EQU   SCVTSECT+164                                             07783000
@NM00037 EQU   SCVTSECT+160                                             07784000
@NM00036 EQU   SCVTSECT+156                                             07785000
SCVTQCBR EQU   SCVTSECT+152                                             07786000
SCVTSTAT EQU   SCVTSECT+148                                             07787000
@NM00035 EQU   SCVTSECT+144                                             07788000
SCVTTQE  EQU   SCVTSECT+140                                             07789000
@NM00034 EQU   SCVTSECT+136                                             07790000
SCVTSVCT EQU   SCVTSECT+132                                             07791000
@NM00033 EQU   SCVTSECT+128                                             07792000
@NM00032 EQU   SCVTSECT+124                                             07793000
SCVTRXLQ EQU   SCVTSECT+120                                             07794000
@NM00031 EQU   SCVTSECT+116                                             07795000
SCVTCTCB EQU   SCVTSECT+112                                             07796000
@NM00030 EQU   SCVTSECT+108                                             07797000
@NM00029 EQU   SCVTSECT+104                                             07798000
@NM00028 EQU   SCVTSECT+100                                             07799000
@NM00027 EQU   SCVTSECT+96                                              07800000
SCVTCOMM EQU   SCVTSECT+92                                              07801000
@NM00026 EQU   SCVTSECT+88                                              07802000
@NM00025 EQU   SCVTSECT+84                                              07803000
@NM00024 EQU   SCVTSECT+80                                              07804000
@NM00023 EQU   SCVTSECT+76                                              07805000
@NM00022 EQU   SCVTSECT+72                                              07806000
SCVTGMBR EQU   SCVTSECT+68                                              07807000
SCVTRPTR EQU   SCVTSECT+64                                              07808000
SCVTHSKP EQU   SCVTSECT+60                                              07809000
@NM00021 EQU   SCVTSECT+56                                              07810000
@NM00020 EQU   SCVTSECT+52                                              07811000
SCVTLFRM EQU   SCVTSECT+48                                              07812000
SCVTCDCL EQU   SCVTSECT+44                                              07813000
@NM00019 EQU   SCVTSECT+40                                              07814000
SCVTRACE EQU   SCVTSECT+36                                              07815000
@NM00018 EQU   SCVTSECT+32                                              07816000
SCVTRMBR EQU   SCVTSECT+28                                              07817000
@NM00017 EQU   SCVTSECT+24                                              07818000
@NM00016 EQU   SCVTSECT+20                                              07819000
@NM00015 EQU   SCVTSECT+16                                              07820000
@NM00014 EQU   SCVTSECT+14                                              07821000
SCVTBR14 EQU   SCVTSECT+12                                              07822000
SCVTSPET EQU   SCVTSECT+8                                               07823000
SCVTPGWR EQU   SCVTSECT+4                                               07824000
SCVTPGTM EQU   SCVTSECT                                                 07825000
CVTLEVL  EQU   CVTRELNO+2                                               07826000
CVTNUMB  EQU   CVTRELNO                                                 07827000
CVTMDL   EQU   CVTFIX+250                                               07828000
@NM00013 EQU   CVTFIX+248                                               07829000
@NM00012 EQU   CVTFIX                                                   07830000
CVTRV482 EQU   CVTXTNT2+128                                             07831000
CVTRV481 EQU   CVTXTNT2+124                                             07832000
CVTRV480 EQU   CVTXTNT2+120                                             07833000
CVTRV479 EQU   CVTXTNT2+118                                             07834000
CVTRV478 EQU   CVTXTNT2+117                                             07835000
CVTRV477 EQU   CVTXTNT2+116                                             07836000
CVTRV476 EQU   CVTXTNT2+115                                             07837000
CVTRV475 EQU   CVTXTNT2+114                                             07838000
CVTRV474 EQU   CVTRV466                                                 07839000
CVTRV473 EQU   CVTRV466                                                 07840000
CVTRV472 EQU   CVTRV466                                                 07841000
CVTRV471 EQU   CVTRV466                                                 07842000
CVTRV470 EQU   CVTRV466                                                 07843000
CVTRV469 EQU   CVTRV466                                                 07844000
CVTRV468 EQU   CVTRV466                                                 07845000
CVTRV467 EQU   CVTRV466                                                 07846000
CVTRV465 EQU   CVTRV457                                                 07847000
CVTRV464 EQU   CVTRV457                                                 07848000
CVTRV463 EQU   CVTRV457                                                 07849000
CVTRV462 EQU   CVTRV457                                                 07850000
CVTRV461 EQU   CVTRV457                                                 07851000
CVTRV460 EQU   CVTRV457                                                 07852000
CVTRV459 EQU   CVTRV457                                                 07853000
CVTRV458 EQU   CVTRV457                                                 07854000
CVTRV456 EQU   CVTXTNT2+108                                             07855000
CVTRV455 EQU   CVTXTNT2+104                                             07856000
CVTRV454 EQU   CVTXTNT2+100                                             07857000
CVTRV453 EQU   CVTXTNT2+96                                              07858000
CVTRV452 EQU   CVTXTNT2+94                                              07859000
CVTRV451 EQU   CVTXTNT2+92                                              07860000
CVTRV450 EQU   CVTXTNT2+90                                              07861000
CVTRV449 EQU   CVTXTNT2+88                                              07862000
CVTRV448 EQU   CVTXTNT2+87                                              07863000
CVTRV447 EQU   CVTXTNT2+86                                              07864000
CVTRV446 EQU   CVTRV438                                                 07865000
CVTRV445 EQU   CVTRV438                                                 07866000
CVTRV444 EQU   CVTRV438                                                 07867000
CVTRV443 EQU   CVTRV438                                                 07868000
CVTRV442 EQU   CVTRV438                                                 07869000
CVTRV441 EQU   CVTRV438                                                 07870000
CVTRV440 EQU   CVTRV438                                                 07871000
CVTRV439 EQU   CVTRV438                                                 07872000
CVTRV437 EQU   CVTRV429                                                 07873000
CVTRV436 EQU   CVTRV429                                                 07874000
CVTRV435 EQU   CVTRV429                                                 07875000
CVTRV434 EQU   CVTRV429                                                 07876000
CVTRV433 EQU   CVTRV429                                                 07877000
CVTRV432 EQU   CVTRV429                                                 07878000
CVTRV431 EQU   CVTRV429                                                 07879000
CVTRV430 EQU   CVTRV429                                                 07880000
CVTRV428 EQU   CVTXTNT2+80                                              07881000
CVTRV427 EQU   CVTXTNT2+76                                              07882000
CVTRV426 EQU   CVTXTNT2+72                                              07883000
CVTRV425 EQU   CVTXTNT2+68                                              07884000
CVTATACT EQU   CVTATCVT                                                 07885000
CVTRV423 EQU   CVTXTNT2+62                                              07886000
CVTRV422 EQU   CVTXTNT2+60                                              07887000
CVTRV421 EQU   CVTXTNT2+58                                              07888000
CVTRV420 EQU   CVTXTNT2+56                                              07889000
CVTRV419 EQU   CVTXTNT2+55                                              07890000
CVTRV418 EQU   CVTXTNT2+54                                              07891000
CVTRV417 EQU   CVTRV409                                                 07892000
CVTRV416 EQU   CVTRV409                                                 07893000
CVTRV415 EQU   CVTRV409                                                 07894000
CVTRV414 EQU   CVTRV409                                                 07895000
CVTRV413 EQU   CVTRV409                                                 07896000
CVTRV412 EQU   CVTRV409                                                 07897000
CVTRV411 EQU   CVTRV409                                                 07898000
CVTRV410 EQU   CVTRV409                                                 07899000
CVTRV408 EQU   CVTRV400                                                 07900000
CVTRV407 EQU   CVTRV400                                                 07901000
CVTRV406 EQU   CVTRV400                                                 07902000
CVTRV405 EQU   CVTRV400                                                 07903000
CVTRV404 EQU   CVTRV400                                                 07904000
CVTRV403 EQU   CVTRV400                                                 07905000
CVTRV402 EQU   CVTRV400                                                 07906000
CVTRV401 EQU   CVTRV400                                                 07907000
CVTICB   EQU   CVTXTNT2+48                                              07908000
CVTSKTA  EQU   CVTXTNT2+44                                              07909000
CVTCCVT  EQU   CVTXTNT2+40                                              07910000
CVTRSV98 EQU   CVTXTNT2+36                                              07911000
CVTRSV97 EQU   CVTXTNT2+34                                              07912000
CVTRSV96 EQU   CVTXTNT2+32                                              07913000
CVTOLTEP EQU   CVTXTNT2+28                                              07914000
CVTQIDA  EQU   CVTQID+1                                                 07915000
CVTRSV95 EQU   CVTQID                                                   07916000
CVTRSV94 EQU   CVTXTNT2+20                                              07917000
CVTRSV93 EQU   CVTXTNT2+16                                              07918000
CVTRSV92 EQU   CVTXTNT2+12                                              07919000
CVTDEBVR EQU   CVTXTNT2+8                                               07920000
CVTRSV91 EQU   CVTXTNT2+6                                               07921000
CVTRSV9H EQU   CVTFLGBT                                                 07922000
CVTRSV9G EQU   CVTFLGBT                                                 07923000
CVTRSV9F EQU   CVTFLGBT                                                 07924000
CVTRSV9E EQU   CVTFLGBT                                                 07925000
CVTRSV9D EQU   CVTFLGBT                                                 07926000
CVTRSV9C EQU   CVTFLGBT                                                 07927000
CVTVME   EQU   CVTFLGBT                                                 07928000
CVTNPE   EQU   CVTFLGBT                                                 07929000
CVTNUCLS EQU   CVTXTNT2+4                                               07930000
CVTDSSVA EQU   CVTDSSV+1                                                07931000
CVTRSV89 EQU   CVTDSSV                                                  07932000
CVTRSV88 EQU   CVTXTNT1+8                                               07933000
CVTRSV87 EQU   CVTXTNT1+4                                               07934000
CVTFACHN EQU   CVTXTNT1                                                 07935000
CVTRV488 EQU   CVTMAP+412                                               07936000
CVTRV487 EQU   CVTMAP+408                                               07937000
CVTRV486 EQU   CVTMAP+404                                               07938000
CVTRV485 EQU   CVTMAP+400                                               07939000
CVTACTAP EQU   CVTMAP+396                                               07940000
CVTAUTH  EQU   CVTMAP+392                                               07941000
CVTATMCA EQU   CVTATMCT+1                                               07942000
CVTATMST EQU   CVTATMCT                                                 07943000
CVTRSV61 EQU   CVTMAP+384                                               07944000
CVTVOLT1 EQU   CVTVOLM1+1                                               07945000
CVTVOLI1 EQU   CVTVOLF1                                                 07946000
CVTSTOA  EQU   CVTMAP+376                                               07947000
CVTRSV58 EQU   CVTMAP+374                                               07948000
CVTRSV57 EQU   CVTMAP+372                                               07949000
CVTDDCE  EQU   CVTMAP+368                                               07950000
CVTPNWFR EQU   CVTMAP+364                                               07951000
CVTSMF   EQU   CVTMAP+360                                               07952000
CVTSULK  EQU   CVTMAP+358                                               07953000
CVTSLKO  EQU   CVTSYSK                                                  07954000
CVTSLKP  EQU   CVTSYSK                                                  07955000
CVTSLKQ  EQU   CVTSYSK                                                  07956000
CVTSLKR  EQU   CVTSYSK                                                  07957000
CVTRSV56 EQU   CVTSYSK                                                  07958000
CVTRSV55 EQU   CVTSYSK                                                  07959000
CVTRSV54 EQU   CVTSYSK                                                  07960000
CVTRSV53 EQU   CVTSYSK                                                  07961000
CVTRSV52 EQU   CVTA1F1                                                  07962000
CVTRSV51 EQU   CVTA1F1                                                  07963000
CVTRSV50 EQU   CVTA1F1                                                  07964000
CVTRSV49 EQU   CVTA1F1                                                  07965000
CVTRSV48 EQU   CVTA1F1                                                  07966000
CVTRSV47 EQU   CVTA1F1                                                  07967000
CVTSRSW  EQU   CVTA1F1                                                  07968000
CVTPFSW  EQU   CVTA1F1                                                  07969000
CVTPCVT  EQU   CVTMAP+352                                               07970000
CVTRSV46 EQU   CVTMAP+344                                               07971000
CVTRSV45 EQU   CVTMAP+340                                               07972000
CVTRSV44 EQU   CVTMAP+338                                               07973000
CVTRSV43 EQU   CVTMAP+336                                               07974000
CVTHJESA EQU   CVTHJES+1                                                07975000
CVTRSV42 EQU   CVTHJES                                                  07976000
CVTEXT2A EQU   CVTEXT2+1                                                07977000
CVTRSV41 EQU   CVTEXT2                                                  07978000
CVTAPFA  EQU   CVTAPF+1                                                 07979000
CVTRSV40 EQU   CVTAPF                                                   07980000
CVTRV518 EQU   CVTINTLA                                                 07981000
CVTRV517 EQU   CVTERPV                                                  07982000
CVTEORM  EQU   CVTMAP+312                                               07983000
CVTMCHPR EQU   CVTMAP+308                                               07984000
CVTTZ    EQU   CVTMAP+304                                               07985000
CVTJEPS  EQU   CVTMAP+300                                               07986000
CVTJESCT EQU   CVTMAP+296                                               07987000
CVTMODE  EQU   CVTMAP+292                                               07988000
CVTPTRV  EQU   CVTMAP+288                                               07989000
CVTREAL  EQU   CVTMAP+284                                               07990000
CVTRSV39 EQU   CVTMAP+280                                               07991000
CVTRSV38 EQU   CVTMAP+276                                               07992000
CVTDMSRA EQU   CVTDMSR+1                                                07993000
CVTRV634 EQU   CVTDMSRF                                                 07994000
CVTRV633 EQU   CVTDMSRF                                                 07995000
CVTRV632 EQU   CVTDMSRF                                                 07996000
CVTRV631 EQU   CVTDMSRF                                                 07997000
CVTRV630 EQU   CVTDMSRF                                                 07998000
CVTRV629 EQU   CVTDMSRF                                                 07999000
CVTUDUMP EQU   CVTDMSRF                                                 08000000
CVTSDUMP EQU   CVTDMSRF                                                 08001000
CVTQMSGA EQU   CVTQMSG+1                                                08002000
CVTRSV36 EQU   CVTQMSG                                                  08003000
CVTAMFF  EQU   CVTMAP+264                                               08004000
CVTPURGA EQU   CVTPURG+1                                                08005000
CVTRSV35 EQU   CVTPURG                                                  08006000
CVTCBSP  EQU   CVTMAP+256                                               08007000
CVTATERA EQU   CVTATER+1                                                08008000
CVTSYST  EQU   CVTATER                                                  08009000
CVTVOLT2 EQU   CVTTAT                                                   08010000
CVTVOLI2 EQU   CVTVOLF2                                                 08011000
CVTAQAVB EQU   CVTAQAVT+1                                               08012000
CVTRSV34 EQU   CVTTCMFG                                                 08013000
CVTRSV33 EQU   CVTTCMFG                                                 08014000
CVTRSV32 EQU   CVTTCMFG                                                 08015000
CVTRSV31 EQU   CVTTCMFG                                                 08016000
CVTRSV30 EQU   CVTTCMFG                                                 08017000
CVTRSV29 EQU   CVTTCMFG                                                 08018000
CVTLDEV  EQU   CVTTCMFG                                                 08019000
CVTTCRDY EQU   CVTTCMFG                                                 08020000
CVTGTFA  EQU   CVTGTF+1                                                 08021000
CVTRSV27 EQU   CVTGTFST                                                 08022000
CVTRNIO  EQU   CVTGTFST                                                 08023000
CVTUSR   EQU   CVTGTFST                                                 08024000
CVTRV318 EQU   CVTFORM                                                  08025000
CVTRV317 EQU   CVTTMODE                                                 08026000
CVTRV316 EQU   CVTSTATE                                                 08027000
CVTRV315 EQU   CVTGTFS                                                  08028000
CVTGTFAV EQU   CVTGTFS                                                  08029000
CVT0SCR1 EQU   CVTMAP+232                                               08030000
CVTRV515 EQU   CVTMAP+228                                               08031000
CVTRMS   EQU   CVTMAP+224                                               08032000
CVTPATCH EQU   CVTMAP+220                                               08033000
CVTTSCE  EQU   CVTMAP+216                                               08034000
CVTLNKSC EQU   CVTMAP+214                                               08035000
CVTQABST EQU   CVTMAP+212                                               08036000
CVTMDLDS EQU   CVTMAP+208                                               08037000
CVTUSER  EQU   CVTMAP+204                                               08038000
CVTABEND EQU   CVTMAP+200                                               08039000
CVTSMCA  EQU   CVTMAP+196                                               08040000
CVTRSV18 EQU   CVTMAP+192                                               08041000
CVTQLPAQ EQU   CVTMAP+188                                               08042000
CVTQCDSR EQU   CVTMAP+184                                               08043000
CVTRSV17 EQU   CVTOPTB                                                  08044000
CVTRSV16 EQU   CVTOPTB                                                  08045000
CVTFP    EQU   CVTOPTB                                                  08046000
CVTAPTHR EQU   CVTOPTB                                                  08047000
CVTNLOG  EQU   CVTOPTB                                                  08048000
CVTTOD   EQU   CVTOPTB                                                  08049000
CVTCTIMS EQU   CVTOPTB                                                  08050000
CVTPROT  EQU   CVTOPTB                                                  08051000
CVTXPFP  EQU   CVTOPTA                                                  08052000
CVTASCII EQU   CVTOPTA                                                  08053000
CVTRSV13 EQU   CVTOPTA                                                  08054000
CVTRSV12 EQU   CVTOPTA                                                  08055000
CVTNIP   EQU   CVTOPTA                                                  08056000
CVTDDR   EQU   CVTOPTA                                                  08057000
CVTAPR   EQU   CVTOPTA                                                  08058000
CVTCCH   EQU   CVTOPTA                                                  08059000
CVTSNCTR EQU   CVTMAP+180                                               08060000
CVTQMWR  EQU   CVTMAP+176                                               08061000
CVTQOCR  EQU   CVTMAP+172                                               08062000
CVT1EF00 EQU   CVTMAP+168                                               08063000
CVTMZ00  EQU   CVTMAP+164                                               08064000
CVTSV76Q EQU   CVTSV76C                                                 08065000
CVTRSV11 EQU   CVTMAP+156                                               08066000
CVT0PT01 EQU   CVTMAP+152                                               08067000
CVTMSER  EQU   CVTMAP+148                                               08068000
CVTRV516 EQU   CVTIERLC                                                 08069000
CVTILCH  EQU   CVTMAP+140                                               08070000
CVT0DS   EQU   CVTMAP+136                                               08071000
CVTFBOSV EQU   CVTMAP+132                                               08072000
CVTNUCB  EQU   CVTMAP+128                                               08073000
CVTIXAVL EQU   CVTMAP+124                                               08074000
CVTSV76M EQU   CVTIOQET                                                 08075000
CVTDCBA  EQU   CVTMAP+117                                               08076000
CVTMVS2  EQU   CVTDCB                                                   08077000
CVT6DAT  EQU   CVTDCB                                                   08078000
CVT4MPS  EQU   CVTDCB                                                   08079000
CVTRSV09 EQU   CVTDCB                                                   08080000
CVT4MS1  EQU   CVTDCB                                                   08081000
CVT2SPS  EQU   CVTDCB                                                   08082000
CVT1SSS  EQU   CVTDCB                                                   08083000
CVTRSV08 EQU   CVTDCB                                                   08084000
CVTSTB   EQU   CVTMAP+112                                               08085000
CVTQTD00 EQU   CVTMAP+108                                               08086000
CVTQTE00 EQU   CVTMAP+104                                               08087000
CVTCUCB  EQU   CVTMAP+100                                               08088000
CVTSJQ   EQU   CVTMAP+96                                                08089000
CVTPBLDL EQU   CVTMAP+92                                                08090000
CVTTPC   EQU   CVTMAP+88                                                08091000
CVTSVDCB EQU   CVTMAP+84                                                08092000
CVTBRET  EQU   CVTMAP+82                                                08093000
CVTEXIT  EQU   CVTMAP+80                                                08094000
CVT0FN00 EQU   CVTMAP+76                                                08095000
CVTDARA  EQU   CVTDAR+1                                                 08096000
CVTRSV07 EQU   CVTFLGS1                                                 08097000
CVTRSV06 EQU   CVTFLGS1                                                 08098000
CVTRSV05 EQU   CVTFLGS1                                                 08099000
CVTRSV04 EQU   CVTFLGS1                                                 08100000
CVTRSV03 EQU   CVTFLGS1                                                 08101000
CVTRSV02 EQU   CVTFLGS1                                                 08102000
CVTRSV01 EQU   CVTFLGS1                                                 08103000
CVTDMPLK EQU   CVTFLGS1                                                 08104000
CVTXITP  EQU   CVTMAP+68                                                08105000
CVTZDTAB EQU   CVTMAP+64                                                08106000
CVTMSLT  EQU   CVTMAP+60                                                08107000
CVTDATE  EQU   CVTMAP+56                                                08108000
CVTBTERM EQU   CVTMAP+52                                                08109000
CVTSYSAD EQU   CVTMAP+48                                                08110000
CVTXTLER EQU   CVTMAP+44                                                08111000
CVTILK2  EQU   CVTMAP+40                                                08112000
CVTILK1  EQU   CVTMAP+36                                                08113000
CVTPRLTV EQU   CVTMAP+32                                                08114000
CVTPCNVT EQU   CVTMAP+28                                                08115000
CVT0VL00 EQU   CVTMAP+24                                                08116000
CVTXAPG  EQU   CVTMAP+20                                                08117000
CVTBUF   EQU   CVTMAP+16                                                08118000
CVTJOB   EQU   CVTMAP+12                                                08119000
CVTLINK  EQU   CVTMAP+8                                                 08120000
CVT0EF00 EQU   CVTMAP+4                                                 08121000
CVTTCBP  EQU   CVTMAP                                                   08122000
ASXBEND  EQU   ASXB+232                                                 08123000
ASXBRV25 EQU   ASXB+228                                                 08124000
ASXBRV24 EQU   ASXB+224                                                 08125000
ASXBPT0E EQU   ASXB+220                                                 08126000
ASXBCRB4 EQU   ASXBCASW+3                                               08127000
ASXBCRB3 EQU   ASXBCASW+2                                               08128000
ASXBCRB2 EQU   ASXBCASW+1                                               08129000
ASXBCR06 EQU   ASXBCRB1                                                 08130000
ASXBCR05 EQU   ASXBCRB1                                                 08131000
ASXBCR04 EQU   ASXBCRB1                                                 08132000
ASXBCR03 EQU   ASXBCRB1                                                 08133000
ASXBCR02 EQU   ASXBCRB1                                                 08134000
ASXBCR01 EQU   ASXBCRB1                                                 08135000
ASXBTFD  EQU   ASXBCRB1                                                 08136000
ASXBPIP  EQU   ASXBCRB1                                                 08137000
ASXBCTDC EQU   ASXB+212                                                 08138000
ASXBTDCB EQU   ASXB+208                                                 08139000
ASXBRV19 EQU   ASXB+204                                                 08140000
ASXBSENV EQU   ASXBSECR+1                                               08141000
ASXBRV34 EQU   ASCBSFLG                                                 08142000
ASXBRV33 EQU   ASCBSFLG                                                 08143000
ASXBRV32 EQU   ASCBSFLG                                                 08144000
ASXBRV31 EQU   ASCBSFLG                                                 08145000
ASXBRV30 EQU   ASCBSFLG                                                 08146000
ASXBRV29 EQU   ASCBSFLG                                                 08147000
ASXBRV28 EQU   ASCBSFLG                                                 08148000
ASXBRV27 EQU   ASCBSFLG                                                 08149000
ASXBUSER EQU   ASXB+192                                                 08150000
ASXBLSRB EQU   ASXBAEQ+20                                               08151000
ASXBFSRB EQU   ASXBAEQ+16                                               08152000
ASXBLRQE EQU   ASXBAEQ+12                                               08153000
ASXBFRQE EQU   ASXBAEQ+8                                                08154000
ASXBLIQE EQU   ASXBAEQ+4                                                08155000
ASXBFIQE EQU   ASXBAEQ                                                  08156000
ASXBETSK EQU   ASXB+164                                                 08157000
ASXBSIRB EQU   ASXB+160                                                 08158000
ASXBPSWD EQU   ASXB+152                                                 08159000
ASXBPRG  EQU   ASXB+136                                                 08160000
ASXBRV26 EQU   ASXB+132                                                 08161000
ASXBOUSB EQU   ASXB+128                                                 08162000
ASXBDDR  EQU   ASXB+124                                                 08163000
ASXBRCTD EQU   ASXB+120                                                 08164000
ASXBRSMD EQU   ASXB+116                                                 08165000
ASXBSPSA EQU   ASXB+112                                                 08166000
ASXBFRWA EQU   ASXB+108                                                 08167000
ASXBFLSA EQU   ASXB+36                                                  08168000
ASXBIHSA EQU   ASXB+32                                                  08169000
ASXBRV15 EQU   ASXB+28                                                  08170000
ASXBRV14 EQU   ASXB+24                                                  08171000
ASXBLWA  EQU   ASXB+20                                                  08172000
ASXBMPST EQU   ASXB+16                                                  08173000
ASXBRS00 EQU   ASXB+14                                                  08174000
ASXBASXB EQU   ASXB                                                     08175000
ASXBEGIN EQU   ASXB                                                     08176000
ASCBEND  EQU   ASCB+208                                                 08177000
ASCBSRBT EQU   ASCB+200                                                 08178000
ASCBSWTL EQU   ASCB+196                                                 08179000
ASCBRS14 EQU   ASCB+195                                                 08180000
ASCBSMCT EQU   ASCB+194                                                 08181000
ASCBRS12 EQU   ASCB+192                                                 08182000
ASCBPCTT EQU   ASCB+188                                                 08183000
ASCBVGTT EQU   ASCB+184                                                 08184000
ASCBRV43 EQU   ASCBSRQ4                                                 08185000
ASCBRV42 EQU   ASCBSRQ4                                                 08186000
ASCBRV41 EQU   ASCBSRQ4                                                 08187000
ASCBRV40 EQU   ASCBSRQ4                                                 08188000
ASCBRV39 EQU   ASCBSRQ4                                                 08189000
ASCBRV38 EQU   ASCBSRQ4                                                 08190000
ASCBRV37 EQU   ASCBSRQ4                                                 08191000
ASCBRV36 EQU   ASCBSRQ4                                                 08192000
ASCBRV35 EQU   ASCBSRQ3                                                 08193000
ASCBRV34 EQU   ASCBSRQ3                                                 08194000
ASCBRV33 EQU   ASCBSRQ3                                                 08195000
ASCBRV32 EQU   ASCBSRQ3                                                 08196000
ASCBRV31 EQU   ASCBSRQ3                                                 08197000
ASCBRV30 EQU   ASCBSRQ3                                                 08198000
ASCBRV29 EQU   ASCBSRQ3                                                 08199000
ASCBRV28 EQU   ASCBSRQ3                                                 08200000
ASCBRV27 EQU   ASCBSRQ2                                                 08201000
ASCBRV26 EQU   ASCBSRQ2                                                 08202000
ASCBRV25 EQU   ASCBSRQ2                                                 08203000
ASCBRV24 EQU   ASCBSRQ2                                                 08204000
ASCBRV23 EQU   ASCBSRQ2                                                 08205000
ASCBRV22 EQU   ASCBSRQ2                                                 08206000
ASCBRV21 EQU   ASCBSRQ2                                                 08207000
ASCBRV20 EQU   ASCBSRQ2                                                 08208000
ASCBRV19 EQU   ASCBSRQ1                                                 08209000
ASCBRV18 EQU   ASCBSRQ1                                                 08210000
ASCBRV17 EQU   ASCBSRQ1                                                 08211000
ASCBRV16 EQU   ASCBSRQ1                                                 08212000
ASCBRV15 EQU   ASCBSRQ1                                                 08213000
ASCBRV14 EQU   ASCBSRQ1                                                 08214000
ASCBRV13 EQU   ASCBSRQ1                                                 08215000
ASCBSTA  EQU   ASCBSRQ1                                                 08216000
ASCBJBNS EQU   ASCB+176                                                 08217000
ASCBJBNI EQU   ASCB+172                                                 08218000
ASCBMCC  EQU   ASCB+168                                                 08219000
ASCBRTWA EQU   ASCB+164                                                 08220000
ASCBIQEA EQU   ASCB+160                                                 08221000
ASCBXMPQ EQU   ASCB+156                                                 08222000
ASCBRS01 EQU   ASCB+154                                                 08223000
ASCBFMCT EQU   ASCB+152                                                 08224000
ASCBOUXB EQU   ASCB+148                                                 08225000
ASCBOUCB EQU   ASCB+144                                                 08226000
ASCBMECB EQU   ASCB+140                                                 08227000
ASCBQECB EQU   ASCB+136                                                 08228000
ASCBLSQH EQU   ASCBLKGP+4                                               08229000
ASCBLOCK EQU   ASCBLKGP                                                 08230000
ASCBNVSC EQU   ASCB+122                                                 08231000
ASCBVSC  EQU   ASCB+120                                                 08232000
ASCBSRBS EQU   ASCB+118                                                 08233000
ASCBSSRB EQU   ASCB+116                                                 08234000
ASCBRV06 EQU   ASCBFLG2                                                 08235000
ASCBRV05 EQU   ASCBFLG2                                                 08236000
ASCBRV04 EQU   ASCBFLG2                                                 08237000
ASCBSNQS EQU   ASCBFLG2                                                 08238000
ASCBS2S  EQU   ASCBFLG2                                                 08239000
ASCBCEXT EQU   ASCBFLG2                                                 08240000
ASCBPXMT EQU   ASCBFLG2                                                 08241000
ASCBXMPT EQU   ASCBFLG2                                                 08242000
ASCBRF07 EQU   ASCBDSP1                                                 08243000
ASCBRF06 EQU   ASCBDSP1                                                 08244000
ASCBRF05 EQU   ASCBDSP1                                                 08245000
ASCBRF04 EQU   ASCBDSP1                                                 08246000
ASCBRF03 EQU   ASCBDSP1                                                 08247000
ASCBRF02 EQU   ASCBDSP1                                                 08248000
ASCBFAIL EQU   ASCBDSP1                                                 08249000
ASCBNOQ  EQU   ASCBDSP1                                                 08250000
ASCBSWCT EQU   ASCB+112                                                 08251000
ASCBTMCH EQU   ASCB+104                                                 08252000
ASCBNSWP EQU   ASCBFLG1                                                 08253000
ASCBTYP1 EQU   ASCBFLG1                                                 08254000
ASCBSTND EQU   ASCBFLG1                                                 08255000
ASCBABNT EQU   ASCBFLG1                                                 08256000
ASCBTERM EQU   ASCBFLG1                                                 08257000
ASCBS3S  EQU   ASCBFLG1                                                 08258000
ASCBCMSH EQU   ASCBFLG1                                                 08259000
ASCBTOFF EQU   ASCBFLG1                                                 08260000
ASCBRF01 EQU   ASCBRCTF                                                 08261000
ASCBTMLW EQU   ASCBRCTF                                                 08262000
ASCBOUT  EQU   ASCBRCTF                                                 08263000
ASCBWAIT EQU   ASCBRCTF                                                 08264000
ASCBRV08 EQU   ASCBRCTF                                                 08265000
ASCBFQU  EQU   ASCBRCTF                                                 08266000
ASCBFRS  EQU   ASCBRCTF                                                 08267000
ASCBTMNO EQU   ASCBRCTF                                                 08268000
ASCBDUMP EQU   ASCB+96                                                  08269000
ASCBRV44 EQU   ASCB+92                                                  08270000
ASCBUBET EQU   ASCB+88                                                  08271000
ASCBECB  EQU   ASCB+84                                                  08272000
ASCBJSTL EQU   ASCB+80                                                  08273000
ASCBEWST EQU   ASCB+72                                                  08274000
ASCBEJST EQU   ASCB+64                                                  08275000
ASCBTSB  EQU   ASCB+60                                                  08276000
ASCBCSCB EQU   ASCB+56                                                  08277000
ASCBRSMA EQU   ASCBRSM+1                                                08278000
ASCBRV54 EQU   ASCBRSMF                                                 08279000
ASCBRV53 EQU   ASCBRSMF                                                 08280000
ASCBRV52 EQU   ASCBRSMF                                                 08281000
ASCBRV51 EQU   ASCBRSMF                                                 08282000
ASCBVEQR EQU   ASCBRSMF                                                 08283000
ASCBN2LP EQU   ASCBRSMF                                                 08284000
ASCB1LPU EQU   ASCBRSMF                                                 08285000
ASCB2LPU EQU   ASCBRSMF                                                 08286000
ASCBLDA  EQU   ASCB+48                                                  08287000
ASCBSTOR EQU   ASCB+44                                                  08288000
ASCBDP   EQU   ASCB+43                                                  08289000
ASCBRV07 EQU   ASCB+42                                                  08290000
ASCBIOSM EQU   ASCB+40                                                  08291000
ASCBSEQN EQU   ASCB+38                                                  08292000
ASCBASID EQU   ASCB+36                                                  08293000
ASCBCPUS EQU   ASCB+32                                                  08294000
ASCBSPL  EQU   ASCB+28                                                  08295000
ASCBIOSP EQU   ASCB+24                                                  08296000
ASCBSYNC EQU   ASCBSUPC+4                                               08297000
ASCBSVRB EQU   ASCBSUPC                                                 08298000
ASCBCMSF EQU   ASCB+12                                                  08299000
ASCBBWDP EQU   ASCB+8                                                   08300000
ASCBFWDP EQU   ASCB+4                                                   08301000
ASCBASCB EQU   ASCB                                                     08302000
ASCBEGIN EQU   ASCB                                                     08303000
SPQERES2 EQU   SPQESECT+12                                              08304000
SPQERES1 EQU   SPQESECT+9                                               08305000
IQEOUTLM EQU   IQESECT+20                                               08306000
IQEDCB   EQU   IQESECT+16                                               08307000
IQETCBA  EQU   IQETCB+1                                                 08308000
IQESTAT2 EQU   IQETCB                                                   08309000
IQEIRBA  EQU   IQEIRB+1                                                 08310000
@NM00011 EQU   IQEFLAGS                                                 08311000
@NM00010 EQU   IQEFLAGS                                                 08312000
@NM00009 EQU   IQEFLAGS                                                 08313000
@NM00008 EQU   IQEFLAGS                                                 08314000
@NM00007 EQU   IQEFLAGS                                                 08315000
@NM00006 EQU   IQEFLAGS                                                 08316000
@NM00005 EQU   IQEFLAGS                                                 08317000
IQEPURGE EQU   IQEFLAGS                                                 08318000
IQELNKA  EQU   IQELNK+1                                                 08319000
IQESTAT1 EQU   IQELNK                                                   08320000
@NM00004 EQU   TCBXTNT2+32                                              08321000
TCBRV181 EQU   TCBRV173                                                 08322000
TCBRV180 EQU   TCBRV173                                                 08323000
TCBRV179 EQU   TCBRV173                                                 08324000
TCBRV178 EQU   TCBRV173                                                 08325000
TCBRV177 EQU   TCBRV173                                                 08326000
TCBRV176 EQU   TCBRV173                                                 08327000
TCBRV175 EQU   TCBRV173                                                 08328000
TCBRV174 EQU   TCBRV173                                                 08329000
TCBRV172 EQU   TCBRV164                                                 08330000
TCBRV171 EQU   TCBRV164                                                 08331000
TCBRV170 EQU   TCBRV164                                                 08332000
TCBRV169 EQU   TCBRV164                                                 08333000
TCBRV168 EQU   TCBRV164                                                 08334000
TCBRV167 EQU   TCBRV164                                                 08335000
TCBRV166 EQU   TCBRV164                                                 08336000
TCBRV165 EQU   TCBRV164                                                 08337000
TCBRV163 EQU   TCBRV155                                                 08338000
TCBRV162 EQU   TCBRV155                                                 08339000
TCBRV161 EQU   TCBRV155                                                 08340000
TCBRV160 EQU   TCBRV155                                                 08341000
TCBRV159 EQU   TCBRV155                                                 08342000
TCBRV158 EQU   TCBRV155                                                 08343000
TCBRV157 EQU   TCBRV155                                                 08344000
TCBRV156 EQU   TCBRV155                                                 08345000
TCBRV154 EQU   TCBRV146                                                 08346000
TCBRV153 EQU   TCBRV146                                                 08347000
TCBRV152 EQU   TCBRV146                                                 08348000
TCBRV151 EQU   TCBRV146                                                 08349000
TCBRV150 EQU   TCBRV146                                                 08350000
TCBRV149 EQU   TCBRV146                                                 08351000
TCBRV148 EQU   TCBRV146                                                 08352000
TCBRV147 EQU   TCBRV146                                                 08353000
TCBRV145 EQU   TCBXTNT2+26                                              08354000
TCBRV144 EQU   TCBXTNT2+24                                              08355000
TCBCAUF  EQU   TCBXTNT2+20                                              08356000
TCBRV142 EQU   TCBXTNT2+16                                              08357000
TCBRSV49 EQU   TCBXTNT2+12                                              08358000
TCBEVENT EQU   TCBXTNT2+8                                               08359000
TCBRCMP  EQU   TCBXTNT2+5                                               08360000
TCBRSVAB EQU   TCBXTNT2+4                                               08361000
TCBGTFA  EQU   TCBGTF+1                                                 08362000
TCBRSV47 EQU   TCBTFLG                                                  08363000
TCBRSV46 EQU   TCBTFLG                                                  08364000
TCBRSV45 EQU   TCBTFLG                                                  08365000
TCBRSV44 EQU   TCBTFLG                                                  08366000
TCBRSV43 EQU   TCBTFLG                                                  08367000
TCBDSPIT EQU   TCBTFLG                                                  08368000
TCBERRTN EQU   TCBTFLG                                                  08369000
TCBASYNC EQU   TCBTFLG                                                  08370000
@NM00003 EQU   TCB+296                                                  08371000
TCBSVCA2 EQU   TCB+292                                                  08372000
TCBSWASA EQU   TCB+288                                                  08373000
TCBDBTB  EQU   TCB+284                                                  08374000
TCBRPT   EQU   TCB+280                                                  08375000
TCBRV141 EQU   TCBRV133                                                 08376000
TCBRV140 EQU   TCBRV133                                                 08377000
TCBRV139 EQU   TCBRV133                                                 08378000
TCBRV138 EQU   TCBRV133                                                 08379000
TCBRV137 EQU   TCBRV133                                                 08380000
TCBRV136 EQU   TCBRV133                                                 08381000
TCBRV135 EQU   TCBRV133                                                 08382000
TCBRV134 EQU   TCBRV133                                                 08383000
TCBRV132 EQU   TCBRV124                                                 08384000
TCBRV131 EQU   TCBRV124                                                 08385000
TCBRV130 EQU   TCBRV124                                                 08386000
TCBRV129 EQU   TCBRV124                                                 08387000
TCBRV128 EQU   TCBRV124                                                 08388000
TCBRV127 EQU   TCBRV124                                                 08389000
TCBRV126 EQU   TCBRV124                                                 08390000
TCBRV125 EQU   TCBRV124                                                 08391000
TCBRV123 EQU   TCBFBYT2                                                 08392000
TCBRV122 EQU   TCBFBYT2                                                 08393000
TCBSSSYN EQU   TCBFBYT2                                                 08394000
TCBFPRAP EQU   TCBFBYT2                                                 08395000
TCBFDW   EQU   TCBFBYT2                                                 08396000
TCBFMW   EQU   TCBFBYT2                                                 08397000
TCBCNCB  EQU   TCBFBYT2                                                 08398000
TCBLLH   EQU   TCBFBYT1                                                 08399000
TCBRV113 EQU   TCBFBYT1                                                 08400000
TCBEOT   EQU   TCBFBYT1                                                 08401000
TCBRTM2  EQU   TCBFBYT1                                                 08402000
TCBPGNLY EQU   TCBFBYT1                                                 08403000
TCBNDIOS EQU   TCBFBYT1                                                 08404000
TCBRV327 EQU   TCBFBYT1                                                 08405000
TCBEOTFM EQU   TCBFBYT1                                                 08406000
TCBRV326 EQU   TCB+272                                                  08407000
TCBUKYSP EQU   TCB+268                                                  08408000
TCBMODE  EQU   TCBESTAE+3                                               08409000
TCBERTYP EQU   TCBESTAE+2                                               08410000
TCBRV314 EQU   TCBESTRM                                                 08411000
TCBRV313 EQU   TCBESTRM                                                 08412000
TCBRV312 EQU   TCBESTRM                                                 08413000
TCBRV311 EQU   TCBESTRM                                                 08414000
TCBRV310 EQU   TCBESTRM                                                 08415000
TCBRV309 EQU   TCBESTRM                                                 08416000
TCBSTAFX EQU   TCBESTRM                                                 08417000
TCBETERM EQU   TCBESTRM                                                 08418000
TCBSCBKY EQU   TCBESTAE                                                 08419000
TCBRTM12 EQU   TCB+260                                                  08420000
TCBSTAWA EQU   TCB+252                                                  08421000
TCBFOEA  EQU   TCBFOE+1                                                 08422000
TCBRSV42 EQU   TCBFOE                                                   08423000
TCBCCPVI EQU   TCBXSCT+2                                                08424000
TCBRV325 EQU   TCBXSCT+1                                                08425000
TCBRV324 EQU   TCBXSCT1                                                 08426000
TCBRV323 EQU   TCBXSCT1                                                 08427000
TCBRV322 EQU   TCBXSCT1                                                 08428000
TCBRV321 EQU   TCBXSCT1                                                 08429000
TCBRV320 EQU   TCBXSCT1                                                 08430000
TCBRV319 EQU   TCBXSCT1                                                 08431000
TCBS3A   EQU   TCBXSCT1                                                 08432000
TCBACTIV EQU   TCBXSCT1                                                 08433000
TCBRSV41 EQU   TCB+239                                                  08434000
TCBRSVAA EQU   TCB+237                                                  08435000
TCBABCUR EQU   TCB+236                                                  08436000
TCBTMSAV EQU   TCB+232                                                  08437000
TCBIOTIM EQU   TCB+228                                                  08438000
TCBRTWA  EQU   TCB+224                                                  08439000
TCBTIRB  EQU   TCB+216                                                  08440000
TCBAECB  EQU   TCB+212                                                  08441000
TCBEXT2A EQU   TCBEXT2+1                                                08442000
TCBRSV39 EQU   TCBEXT2                                                  08443000
TCBSTMCT EQU   TCB+207                                                  08444000
TCBSYSCT EQU   TCB+206                                                  08445000
TCBRSV37 EQU   TCB+205                                                  08446000
TCBEXSVC EQU   TCBDAR                                                   08447000
TCBDARMS EQU   TCBDAR                                                   08448000
TCBDARWT EQU   TCBDAR                                                   08449000
TCBDARO  EQU   TCBDAR                                                   08450000
TCBDARMC EQU   TCBDARC                                                  08451000
TCBDARD  EQU   TCBDAR                                                   08452000
TCBDARS  EQU   TCBDAR                                                   08453000
TCBDARP  EQU   TCBDAR                                                   08454000
TCBGTOFM EQU   TCBFLGS7                                                 08455000
TCBADMP  EQU   TCBFLGS7                                                 08456000
TCBRSTSK EQU   TCBFLGS7                                                 08457000
TCBSVCS  EQU   TCBFLGS7                                                 08458000
TCBSTACK EQU   TCBFLGS7                                                 08459000
TCBRSV34 EQU   TCBFLGS7                                                 08460000
TCBRSV33 EQU   TCBFLGS7                                                 08461000
TCBGPECB EQU   TCBFLGS7                                                 08462000
TCBNTJS  EQU   TCBFLGS6                                                 08463000
TCBAPG   EQU   TCBFLGS6                                                 08464000
TCBMIGR  EQU   TCBFLGS6                                                 08465000
TCBRV303 EQU   TCBFLGS6                                                 08466000
TCBSPVLK EQU   TCBFLGS6                                                 08467000
TCBCPU   EQU   TCBFLGS6                                                 08468000
TCBPIE17 EQU   TCBFLGS6                                                 08469000
TCBRSV79 EQU   TCBNDSP5                                                 08470000
TCBRSV78 EQU   TCBNDSP5                                                 08471000
TCBRSV77 EQU   TCBNDSP5                                                 08472000
TCBRSV76 EQU   TCBNDSP5                                                 08473000
TCBRSV75 EQU   TCBNDSP5                                                 08474000
TCBRSV74 EQU   TCBNDSP5                                                 08475000
TCBRSV95 EQU   TCBNDSP5                                                 08476000
TCBRSV94 EQU   TCBNDSP5                                                 08477000
TCBRSV93 EQU   TCBNDSP4                                                 08478000
TCBRSV92 EQU   TCBNDSP4                                                 08479000
TCBRSV91 EQU   TCBNDSP4                                                 08480000
TCBRSV90 EQU   TCBNDSP4                                                 08481000
TCBRSV89 EQU   TCBNDSP4                                                 08482000
TCBRSV88 EQU   TCBNDSP4                                                 08483000
TCBRSV87 EQU   TCBNDSP4                                                 08484000
TCBRSV86 EQU   TCBNDSP4                                                 08485000
TCBEXT1A EQU   TCBEXT1+1                                                08486000
TCBRSV32 EQU   TCBEXT1                                                  08487000
TCBEXCPD EQU   TCB+192                                                  08488000
TCBIOBRC EQU   TCB+188                                                  08489000
TCBDDWTC EQU   TCB+186                                                  08490000
TCBDDEXC EQU   TCB+184                                                  08491000
@NM00002 EQU   TCBRECDE                                                 08492000
TCBREC   EQU   TCBRECDE                                                 08493000
TCBMDIDS EQU   TCB+176                                                  08494000
TCBNDINT EQU   TCBNDSP3                                                 08495000
TCBRSV27 EQU   TCBNDSP3                                                 08496000
TCBRSV26 EQU   TCBNDSP3                                                 08497000
TCBRSV25 EQU   TCBNDSP3                                                 08498000
TCBRSV24 EQU   TCBNDSP3                                                 08499000
TCBSRBND EQU   TCBNDSP3                                                 08500000
TCBRV302 EQU   TCBNDSP3                                                 08501000
TCBLJSND EQU   TCBNDSP3                                                 08502000
TCBABE   EQU   TCBNDSP2                                                 08503000
TCBDSS   EQU   TCBNDSP2                                                 08504000
TCBOWAIT EQU   TCBNDSP2                                                 08505000
TCBIWAIT EQU   TCBNDSP2                                                 08506000
TCBNDTS  EQU   TCBNDSP2                                                 08507000
TCBNDSVC EQU   TCBNDSP2                                                 08508000
TCBSTPP  EQU   TCBNDSP2                                                 08509000
TCBABD   EQU   TCBNDSP2                                                 08510000
TCBRSV22 EQU   TCBNDSP1                                                 08511000
TCBPIEND EQU   TCBNDSP1                                                 08512000
TCBTPSP  EQU   TCBNDSP1                                                 08513000
TCBDDRND EQU   TCBNDSP1                                                 08514000
TCBRSPND EQU   TCBNDSP1                                                 08515000
TCBRSTND EQU   TCBNDSP1                                                 08516000
TCBDARPN EQU   TCBNDSP1                                                 08517000
TCBDARTN EQU   TCBNDSP1                                                 08518000
TCBNDSP0 EQU   TCBNDSP                                                  08519000
TCBUSER  EQU   TCB+168                                                  08520000
TCBTCTB  EQU   TCBTCT+1                                                 08521000
TCBRSV9C EQU   TCBTCTGF                                                 08522000
TCBRSV9B EQU   TCBTCTGF                                                 08523000
TCBRSV9A EQU   TCBTCTGF                                                 08524000
TCBRSV99 EQU   TCBTCTGF                                                 08525000
TCBRSV98 EQU   TCBTCTGF                                                 08526000
TCBRSV97 EQU   TCBTCTGF                                                 08527000
TCBRSV20 EQU   TCBTCTGF                                                 08528000
TCBSMFGF EQU   TCBTCTGF                                                 08529000
TCBSTCUR EQU   TCBNSTAE                                                 08530000
TCBRV301 EQU   TCBNSTAE                                                 08531000
TCBSYNCH EQU   TCBNSTAE                                                 08532000
TCBHALT  EQU   TCBNSTAE                                                 08533000
TCBPPSUP EQU   TCBNSTAE                                                 08534000
TCB33E   EQU   TCBNSTAE                                                 08535000
TCBQUIES EQU   TCBNSTAE                                                 08536000
TCBAQE   EQU   TCB+156                                                  08537000
TCBTSDP  EQU   TCB+151                                                  08538000
TCBTSLP  EQU   TCB+150                                                  08539000
TCBCPUBN EQU   TCBTSFLG                                                 08540000
TCBDYDSP EQU   TCBTSFLG                                                 08541000
TCBRSV18 EQU   TCBTSFLG                                                 08542000
TCBRSV17 EQU   TCBTSFLG                                                 08543000
TCBTIOTG EQU   TCBTSFLG                                                 08544000
TCBRV300 EQU   TCBTSTSK                                                 08545000
TCBRSV16 EQU   TCBJSTCB                                                 08546000
TCBTQET  EQU   TCBTME                                                   08547000
TCBQEL   EQU   TCBFSA                                                   08548000
TCBGRS15 EQU   TCBGRS+60                                                08549000
TCBGRS14 EQU   TCBGRS+56                                                08550000
TCBGRS13 EQU   TCBGRS+52                                                08551000
TCBGRS8  EQU   TCBGRS+32                                                08552000
TCBGRS7  EQU   TCBGRS+28                                                08553000
TCBGRS2  EQU   TCBGRS+8                                                 08554000
TCBGRS1  EQU   TCBGRS+4                                                 08555000
TCBGRS0  EQU   TCBGRS                                                   08556000
TCBJPQB  EQU   TCBJPQ+1                                                 08557000
TCBRSV15 EQU   TCBPURGE                                                 08558000
TCBRSV14 EQU   TCBPURGE                                                 08559000
TCBRSV13 EQU   TCBPURGE                                                 08560000
TCBRSV12 EQU   TCBPURGE                                                 08561000
TCBRSV11 EQU   TCBPURGE                                                 08562000
TCBRSV10 EQU   TCBPURGE                                                 08563000
TCBRSV09 EQU   TCBPURGE                                                 08564000
TCBJPQF  EQU   TCBPURGE                                                 08565000
TCBLLS   EQU   TCB+36                                                   08566000
TCBPNDSP EQU   TCBFLGS5                                                 08567000
TCBFCD1  EQU   TCBFLGS5                                                 08568000
TCBSTP   EQU   TCBFLGS5                                                 08569000
TCBSYS   EQU   TCBFLGS5                                                 08570000
TCBPAGE  EQU   TCBFLGS5                                                 08571000
TCBUXNDF EQU   TCBABWF                                                  08572000
TCBFC    EQU   TCBFLGS5                                                 08573000
TCBONDSP EQU   TCBFLGS4                                                 08574000
TCBMPCND EQU   TCBFLGS4                                                 08575000
TCBMPCVQ EQU   TCBFLGS4                                                 08576000
TCBUXNDV EQU   TCBFLGS4                                                 08577000
TCBHNDSP EQU   TCBFLGS4                                                 08578000
TCBRQENA EQU   TCBFLGS4                                                 08579000
TCBSER   EQU   TCBFLGS4                                                 08580000
TCBNDUMP EQU   TCBFLGS4                                                 08581000
TCBDWSTA EQU   TCBFLGS3                                                 08582000
TCBRSV08 EQU   TCBFLGS3                                                 08583000
TCBRSV07 EQU   TCBFLGS3                                                 08584000
TCBRSV06 EQU   TCBFLGS3                                                 08585000
TCBABGM  EQU   TCBFLGS3                                                 08586000
TCBABTRM EQU   TCBFLGS3                                                 08587000
TCBADINP EQU   TCBFLGS3                                                 08588000
TCBFTS   EQU   TCBFLGS2                                                 08589000
TCBFDSOP EQU   TCBFLGS2                                                 08590000
TCBFJMC  EQU   TCBFLGS2                                                 08591000
TCBFSMC  EQU   TCBFLGS2                                                 08592000
TCBFABOP EQU   TCBFLGS2                                                 08593000
TCBFSTI  EQU   TCBFLGS2                                                 08594000
TCBFOINP EQU   TCBFLGS2                                                 08595000
TCBFX    EQU   TCBFLGS1                                                 08596000
TCBFS    EQU   TCBFLGS1                                                 08597000
TCBFT    EQU   TCBFLGS1                                                 08598000
TCBPDUMP EQU   TCBFLGS1                                                 08599000
TCBNONPR EQU   TCBFLGS1                                                 08600000
TCBFERA  EQU   TCBFLGS1                                                 08601000
TCBFE    EQU   TCBFLGS1                                                 08602000
TCBFA    EQU   TCBFLGS1                                                 08603000
TCBZERO  EQU   TCBPKF                                                   08604000
TCBFLAG  EQU   TCBPKF                                                   08605000
TCBRSV03 EQU   TCBMSS                                                   08606000
TCBTRNB  EQU   TCBTRN+1                                                 08607000
TCBRSV02 EQU   TCBABF                                                   08608000
TCBOLTEP EQU   TCBABF                                                   08609000
TCBTCPP  EQU   TCBABF                                                   08610000
TCBRSV01 EQU   TCBABF                                                   08611000
TCBGRPH  EQU   TCBABF                                                   08612000
TCBNOCHK EQU   TCBABF                                                   08613000
TCBMOD91 EQU   TCBABF                                                   08614000
TCBCMPC  EQU   TCBCMP+1                                                 08615000
TCBRV318 EQU   TCBCMSG                                                  08616000
TCBRV317 EQU   TCBCIND                                                  08617000
TCBRV316 EQU   TCBCWTO                                                  08618000
TCBCASID EQU   TCBCDBL                                                  08619000
TCBNOCC  EQU   TCBSTCC                                                  08620000
TCBDMPO  EQU   TCBCPP                                                   08621000
TCBCSTEP EQU   TCBCMPF                                                  08622000
TCBCREQ  EQU   TCBCMPF                                                  08623000
TCBDEB   EQU   TCB+8                                                    08624000
TCBPIEA  EQU   TCBPIE+1                                                 08625000
TCBPM    EQU   TCBPMASK                                                 08626000
@NM00001 EQU   TCBPMASK                                                 08627000
TCBFRS6  EQU   TCBFRS+24                                                08628000
TCBFRS4  EQU   TCBFRS+16                                                08629000
TCBFRS2  EQU   TCBFRS+8                                                 08630000
TCBFRS0  EQU   TCBFRS                                                   08631000
@NM00116 EQU   PSA+3668                                                 08632000
PSASTAK  EQU   PSA+3072                                                 08633000
@NM00115 EQU   PSA+1048                                                 08634000
PSAUSEND EQU   PSA+1048                                                 08635000
PSARV062 EQU   PSA+1044                                                 08636000
PSACDAL  EQU   PSA+1040                                                 08637000
PSAWTCOD EQU   PSA+1036                                                 08638000
PSAATCVT EQU   PSA+1032                                                 08639000
PSAPCPSW EQU   PSA+1024                                                 08640000
PSAPIR2  EQU   PSA+1020                                                 08641000
PSARV059 EQU   PSA+1018                                                 08642000
PSASVC13 EQU   PSA+1016                                                 08643000
PSASFACC EQU   PSA+1008                                                 08644000
PSASTOP  EQU   PSA+992                                                  08645000
PSASTART EQU   PSA+976                                                  08646000
PSARSPSW EQU   PSA+968                                                  08647000
PSASRPSW EQU   PSA+960                                                  08648000
PSARV045 EQU   PSA+892                                                  08649000
PSARV044 EQU   PSA+888                                                  08650000
PSARV043 EQU   PSA+884                                                  08651000
PSARV042 EQU   PSA+880                                                  08652000
PSARV041 EQU   PSA+876                                                  08653000
PSARV040 EQU   PSA+872                                                  08654000
PSARV025 EQU   PSA+868                                                  08655000
PSADSSED EQU   PSA+868                                                  08656000
PSADSSPR EQU   PSA+864                                                  08657000
PSADSSFW EQU   PSA+860                                                  08658000
PSADSS14 EQU   PSA+856                                                  08659000
PSADSSPP EQU   PSA+848                                                  08660000
PSADSSRP EQU   PSA+840                                                  08661000
PSADSS05 EQU   PSADSSF4                                                 08662000
PSADSS10 EQU   PSADSSF4                                                 08663000
PSADSSVE EQU   PSADSSF4                                                 08664000
PSADSSDE EQU   PSADSSF4                                                 08665000
PSADSSC0 EQU   PSADSSF4                                                 08666000
PSADSSIE EQU   PSADSSF4                                                 08667000
PSADSS12 EQU   PSADSSF4                                                 08668000
PSADSSRC EQU   PSADSSF4                                                 08669000
PSARV057 EQU   PSADSSF3                                                 08670000
PSARV056 EQU   PSADSSF3                                                 08671000
PSARV055 EQU   PSADSSF3                                                 08672000
PSADSSMC EQU   PSADSSF3                                                 08673000
PSADSSRW EQU   PSADSSF3                                                 08674000
PSADSSNM EQU   PSADSSF3                                                 08675000
PSADSSES EQU   PSADSSF3                                                 08676000
PSADSSGP EQU   PSADSSF3                                                 08677000
PSADSSF2 EQU   PSADSSFL+1                                               08678000
PSADSSPI EQU   PSADSSF1                                                 08679000
PSADSSOI EQU   PSADSSF1                                                 08680000
PSADSSSP EQU   PSADSSF1                                                 08681000
PSADSSTP EQU   PSADSSF1                                                 08682000
PSADSSDW EQU   PSADSSF1                                                 08683000
PSADSSDD EQU   PSADSSF1                                                 08684000
PSADSSDM EQU   PSADSSF1                                                 08685000
PSADSSMV EQU   PSADSSF1                                                 08686000
PSADSSTS EQU   PSA+816                                                  08687000
PSADSSWK EQU   PSA+812                                                  08688000
PSADSSR3 EQU   PSA+808                                                  08689000
PSADSSR2 EQU   PSA+804                                                  08690000
PSADSSRS EQU   PSA+800                                                  08691000
PSASTOR  EQU   PSA+796                                                  08692000
PSACPUSA EQU   PSA+794                                                  08693000
PSAVSTAP EQU   PSA+792                                                  08694000
PSAWKVAP EQU   PSA+788                                                  08695000
PSAWKRAP EQU   PSA+784                                                  08696000
PSAMCHIC EQU   PSA+783                                                  08697000
PSARV061 EQU   PSA+782                                                  08698000
PSASYMSK EQU   PSA+781                                                  08699000
PSAMCHFL EQU   PSA+780                                                  08700000
PSACR0   EQU   PSA+776                                                  08701000
PSAPSWSV EQU   PSA+768                                                  08702000
PSACLHS  EQU   PSAHLHI                                                  08703000
PSALKR15 EQU   PSALKSA+60                                               08704000
PSALKR14 EQU   PSALKSA+56                                               08705000
PSALKR13 EQU   PSALKSA+52                                               08706000
PSALKR12 EQU   PSALKSA+48                                               08707000
PSALKR11 EQU   PSALKSA+44                                               08708000
PSALKR10 EQU   PSALKSA+40                                               08709000
PSALKR9  EQU   PSALKSA+36                                               08710000
PSALKR8  EQU   PSALKSA+32                                               08711000
PSALKR7  EQU   PSALKSA+28                                               08712000
PSALKR6  EQU   PSALKSA+24                                               08713000
PSALKR5  EQU   PSALKSA+20                                               08714000
PSALKR4  EQU   PSALKSA+16                                               08715000
PSALKR3  EQU   PSALKSA+12                                               08716000
PSALKR2  EQU   PSALKSA+8                                                08717000
PSALKR1  EQU   PSALKSA+4                                                08718000
PSALKR0  EQU   PSALKSA                                                  08719000
PSARV023 EQU   PSACLHT+52                                               08720000
PSALOCAL EQU   PSACLHT+48                                               08721000
PSACMSL  EQU   PSACLHT+44                                               08722000
PSAOPTL  EQU   PSACLHT+40                                               08723000
PSATPACL EQU   PSACLHT+36                                               08724000
PSATPDNL EQU   PSACLHT+32                                               08725000
PSATPNCL EQU   PSACLHT+28                                               08726000
PSAIOSLL EQU   PSACLHT+24                                               08727000
PSAIOSUL EQU   PSACLHT+20                                               08728000
PSAIOSCL EQU   PSACLHT+16                                               08729000
PSAIOSSL EQU   PSACLHT+12                                               08730000
PSASALCL EQU   PSACLHT+8                                                08731000
PSAASML  EQU   PSACLHT+4                                                08732000
PSADISPL EQU   PSACLHT                                                  08733000
PSASRSA  EQU   PSA+636                                                  08734000
PSARV050 EQU   PSA+634                                                  08735000
PSADSSGO EQU   PSA+633                                                  08736000
PSARECUR EQU   PSA+632                                                  08737000
PSAHLHIS EQU   PSA+628                                                  08738000
PSAIPCSA EQU   PSA+624                                                  08739000
@NM00114 EQU   PSA+621                                                  08740000
PSAIPCDM EQU   PSA+620                                                  08741000
PSAIPCD  EQU   PSA+616                                                  08742000
@NM00113 EQU   PSA+613                                                  08743000
PSAIPCRM EQU   PSA+612                                                  08744000
PSAIPCR  EQU   PSA+608                                                  08745000
PSAMCHEX EQU   PSA+600                                                  08746000
PSAMPSW  EQU   PSA+592                                                  08747000
PSAEXPS2 EQU   PSA+584                                                  08748000
PSAEXPS1 EQU   PSA+576                                                  08749000
PSAPIREG EQU   PSA+572                                                  08750000
PSARSREG EQU   PSA+568                                                  08751000
PSAGPREG EQU   PSA+556                                                  08752000
PSARV022 EQU   PSASUP4                                                  08753000
PSARV021 EQU   PSASUP4                                                  08754000
PSARV020 EQU   PSASUP4                                                  08755000
PSARV019 EQU   PSASUP4                                                  08756000
PSARV018 EQU   PSASUP4                                                  08757000
PSARV017 EQU   PSASUP4                                                  08758000
PSARV016 EQU   PSASUP4                                                  08759000
PSARV015 EQU   PSASUP4                                                  08760000
PSARV014 EQU   PSASUP3                                                  08761000
PSAULCMS EQU   PSASUP3                                                  08762000
PSARV012 EQU   PSASUP3                                                  08763000
PSAESTA  EQU   PSASUP3                                                  08764000
PSASPR   EQU   PSASUP3                                                  08765000
PSAPSREG EQU   PSASUP3                                                  08766000
PSAPI2   EQU   PSASUP3                                                  08767000
PSAIOSUP EQU   PSASUP3                                                  08768000
PSALCR   EQU   PSASUP2                                                  08769000
PSARTM   EQU   PSASUP2                                                  08770000
PSAACR   EQU   PSASUP2                                                  08771000
PSAIPCE2 EQU   PSASUP2                                                  08772000
PSAIPCES EQU   PSASUP2                                                  08773000
PSAIPCEC EQU   PSASUP2                                                  08774000
PSAGTF   EQU   PSASUP2                                                  08775000
PSAIPCRI EQU   PSASUP2                                                  08776000
PSATYPE6 EQU   PSASUP1                                                  08777000
PSATCTL  EQU   PSASUP1                                                  08778000
PSADISP  EQU   PSASUP1                                                  08779000
PSALOCK  EQU   PSASUP1                                                  08780000
PSAPI    EQU   PSASUP1                                                  08781000
PSAEXT   EQU   PSASUP1                                                  08782000
PSASVC   EQU   PSASUP1                                                  08783000
PSAIO    EQU   PSASUP1                                                  08784000
PSAANEW  EQU   PSA+544                                                  08785000
PSATOLD  EQU   PSA+540                                                  08786000
PSATNEW  EQU   PSA+536                                                  08787000
PSALCCAR EQU   PSA+532                                                  08788000
PSALCCAV EQU   PSA+528                                                  08789000
PSAPCCAR EQU   PSA+524                                                  08790000
PSAPCCAV EQU   PSA+520                                                  08791000
PSACPULA EQU   PSA+518                                                  08792000
PSACPUPA EQU   PSA+516                                                  08793000
PSAPSA   EQU   PSA+512                                                  08794000
FLCHDEND EQU   PSA+512                                                  08795000
FLCCRSAV EQU   FLCMCLA+280                                              08796000
FLCGRSAV EQU   FLCMCLA+216                                              08797000
FLCFPSAV EQU   FLCMCLA+184                                              08798000
FLCFLA   EQU   FLCMCLA+88                                               08799000
FLCRGNCD EQU   FLCMCLA+84                                               08800000
FLCFSAA  EQU   FLCFSA+1                                                 08801000
@NM00112 EQU   FLCFSA                                                   08802000
@NM00111 EQU   FLCMCLA+72                                               08803000
FLCMCIC  EQU   FLCMCLA+64                                               08804000
@NM00110 EQU   FLCMCLA+20                                               08805000
FLCIOAA  EQU   FLCIOA+1                                                 08806000
@NM00109 EQU   FLCIOA                                                   08807000
@NM00108 EQU   FLCMCLA+15                                               08808000
@NM00107 EQU   FLCMCLA+14                                               08809000
@NM00106 EQU   FLCMCLA+12                                               08810000
FLCLCL   EQU   FLCMCLA+8                                                08811000
FLCIOELA EQU   FLCIOEL+1                                                08812000
@NM00105 EQU   FLCIOEL                                                  08813000
FLCCHNID EQU   FLCMCLA                                                  08814000
@NM00104 EQU   PSA+160                                                  08815000
FLCMTRCD EQU   PSA+157                                                  08816000
@NM00103 EQU   PSA+156                                                  08817000
FLCPERA  EQU   FLCPER+1                                                 08818000
@NM00102 EQU   FLCPER                                                   08819000
@NM00101 EQU   PSA+151                                                  08820000
FLCPERCD EQU   PSA+150                                                  08821000
FLCMCNUM EQU   PSA+149                                                  08822000
@NM00100 EQU   PSA+148                                                  08823000
FLCTEAA  EQU   FLCTEA+1                                                 08824000
@NM00099 EQU   FLCTEA                                                   08825000
PSAPIPC  EQU   PSAPICOD                                                 08826000
PSAPIMC  EQU   PSAPICOD                                                 08827000
PSAPIPER EQU   PSAPICOD                                                 08828000
PSARV049 EQU   FLCPICOD                                                 08829000
FLCPILCB EQU   FLCPIILC                                                 08830000
@NM00098 EQU   FLCPIILC                                                 08831000
@NM00097 EQU   PSAEPPSW                                                 08832000
FLCSVCN  EQU   PSAESPSW+2                                               08833000
FLCSILCB EQU   FLCSVILC                                                 08834000
@NM00096 EQU   FLCSVILC                                                 08835000
@NM00095 EQU   PSAESPSW                                                 08836000
FLCEICOD EQU   PSAEEPSW+2                                               08837000
PSASPAD  EQU   PSAEEPSW                                                 08838000
@NM00094 EQU   PSA+128                                                  08839000
FLCINPSW EQU   PSA+120                                                  08840000
FLCMNPSW EQU   PSA+112                                                  08841000
FLCPNPSW EQU   PSA+104                                                  08842000
FLCSNPSW EQU   PSA+96                                                   08843000
FLCENPSW EQU   PSA+88                                                   08844000
FLCTRACE EQU   PSA+84                                                   08845000
FLCTIMER EQU   PSA+80                                                   08846000
FLCCVT2  EQU   PSA+76                                                   08847000
FLCCAW   EQU   PSA+72                                                   08848000
FLCCSW   EQU   PSA+64                                                   08849000
FLCIOPSW EQU   PSA+56                                                   08850000
FLCMOPSW EQU   PSA+48                                                   08851000
FLCPOPSW EQU   PSA+40                                                   08852000
FLCSOPSW EQU   PSA+32                                                   08853000
FLCEOPSW EQU   PSA+24                                                   08854000
@NM00093 EQU   FLCICCW2+4                                               08855000
FLCCVT   EQU   FLCICCW2                                                 08856000
FLCICCW1 EQU   FLCROPSW                                                 08857000
FLCIPPSW EQU   FLCRNPSW                                                 08858000
*                                      END UNREFERENCED COMPONENTS      08859000
@RT00180 EQU   AT001000                                                 08860000
@RT00186 EQU   AT001000                                                 08861000
@RF00199 EQU   @RC00195                                                 08862000
@RF00212 EQU   @RC00195                                                 08863000
@RC00202 EQU   @RC00195                                                 08864000
@RT00232 EQU   AT001000                                                 08865000
@RT00238 EQU   AT001000                                                 08866000
@RT00283 EQU   AT001000                                                 08867000
@RT00295 EQU   AT001000                                                 08868000
@RT00303 EQU   AT001000                                                 08869000
@RT00311 EQU   AT001000                                                 08870000
@RT00318 EQU   AT001000                                                 08871000
@RT00442 EQU   AT001090                                                 08872000
@RT00450 EQU   AT001390                                                 08873000
@RT00470 EQU   AT001390                                                 08874000
@RT00508 EQU   AT001390                                                 08875000
@RC00582 EQU   @RC00581                                                 08876000
@RT00760 EQU   AT001410                                                 08877000
@RT00769 EQU   AT001400                                                 08878000
@RF00790 EQU   @EL00006                                                 08879000
@RC00792 EQU   @EL00006                                                 08880000
@RF00808 EQU   AT001350                                                 08881000
@RT00854 EQU   AT001150                                                 08882000
@RT00905 EQU   AT001610                                                 08883000
@RT00911 EQU   AT001600                                                 08884000
@RT00932 EQU   AT001600                                                 08885000
AT001620 EQU   @EL00011                                                 08886000
@RT01118 EQU   AT001460                                                 08887000
@RT01122 EQU   AT001480                                                 08888000
@RT01134 EQU   AT001490                                                 08889000
@RF01144 EQU   AT001460                                                 08890000
@RT01153 EQU   AT001480                                                 08891000
@RT01161 EQU   AT001480                                                 08892000
@RC01111 EQU   @RC01109                                                 08893000
@RT01171 EQU   AT001480                                                 08894000
@RT01175 EQU   AT001480                                                 08895000
@RT01211 EQU   AT001510                                                 08896000
@RT01232 EQU   AT001500                                                 08897000
@RT01271 EQU   AT001430                                                 08898000
@RT01436 EQU   AT001650                                                 08899000
@RT01503 EQU   AT001660                                                 08900000
@RT01509 EQU   AT001660                                                 08901000
@RT01629 EQU   AT001740                                                 08902000
@RT01632 EQU   AT001740                                                 08903000
@RC01644 EQU   @RC01635                                                 08904000
@RC01700 EQU   @RC01691                                                 08905000
@RF00204 EQU   @RC00202                                                 08906000
@RT01094 EQU   AT001620                                                 08907000
@ENDDATA EQU   *                                                        08908000
         END   IGC0004B,(C'PLS2130',0701,78095)                         08909000
./  ADD  SSI=60840695,NAME=IEAVECH0
         TITLE 'IEAVECH0 - CHAP SVC - ENTRY POINT IGC044'               00060002
* /* START OF SPECIFICATIONS ****                                       00120002
*                                                                       00180002
*01*  MODULE-NAME = IEAVECH0                                            00240002
*                                                                       00300002
*02*     CSECT-NAME = IGC044                                            00310002
*                                                                       00378602
*01*  DESCRIPTIVE-NAME = CHAP                                           00427502
*                                                                       00484302
*01*  COPYRIGHT = NONE                                                  00563902
*                                                                       00639502
*01*  STATUS = OSVS2 RELEASE 2 VERSION 1                                00660402
*                                                                       00720302
*01*  FUNCTION = THIS ROUTINE ALTERS THE DISPATCHING PRIORITY OF A      00780702
*        TASK                                                           00900002
*                                                                       00910002
*02*     OPERATION = CHAP SVC: THIS ROUTINE ALTERS THE DISPATCHING      01020002
*        PRIORITY OF A TASK AND REPOSITIONS THE TCB, ACCORDING TO THE   01080002
*        NEW PRIORITY, ON THE TCB DISPATCHING QUEUE. FOR OTHER THAN     01090002
*        SYSTEM TASK CALLERS, THE SUBJECT TASK MUST BE EITHER THE       01200002
*        CURRENT TASK OR ONE OF ITS SUBTASKS.                           01260002
*                                                                       01320002
*        IGC044R1: THIS ROUTINE IS AN FRR FOR CHAP. IT CALLS ROUTINE    01380002
*        IGC044R2 TO VERIFY TCB QUEUES, AND PERCOLATES.                 01440002
*                                                                       01500002
*        IGC044R2: THIS ROUTINE VALIDATES THE TCB FAMILY AND            01560002
*        DISPATCHING QUEUES FOR RECOVERY. THE CURRENT ASCB AND ASXB ARE 01620002
*        VEFIFIED BY CONTROL BLOCK VERIFIER, THE DISPATCHING QUEUE IS   01680002
*        VERIFIED BY QUEUE VERIFIER, AND THE FAMILY QUEUE  IS VERIFIED  01740002
*        BY PERFORMING A TREE SCAN, VERIFYING THE REQUIRED POINTERS BY  01800002
*        CALLING CONTROL BLOCK VERIFIER.                                01860002
*                                                                       01920002
*01*   NOTES =                                                          01980002
*                                                                       02040002
*02*     DEPENDENCIES = THE LOCAL LOCK IS REQUIRED THROUGH OUT THIS     02100002
*        MODULE.                                                        02160002
*                                                                       02220002
*03*        CHARACTER-CODE-DEPENDENCIES = NONE                          02280002
*                                                                       02340002
*02*     RESTRICTIONS = NONE                                            02400002
*                                                                       02450002
*02*     REGISTER-CONVENTIONS = REGISTER DEFINITIONS FOLLOW THE CSECT   02500002
*        STATEMENT. FURTHER DESCRIPTIONS IN INTRODUCTORY COMMENTS FOR   02550002
*        EACH SUBROUTINE AND EACH RECOVERY ROUTINE.                     02600002
*                                                                       02700002
*02*     PATCH-LABEL = IEAPATCH                                         02750002
*                                                                       02800002
*01*  MODULE-TYPE = SVC ROUTINE, WITH RECOVERY                          02850002
*                                                                       02900002
*02*     PROCESSOR = ASSEMBLER                                          02950002
*                                                                       03050002
*02*     MODULE-SIZE = SEE SYMBOL IGC044 IN THE EXTERNAL SYMBOL         03100002
*        DICTIONARY.                                                    03150002
*                                                                       03220002
*02*     ATTRIBUTES = NUCLEUS,ZERO PROTECT KEY, REFRESHABLE, SUPERVISOR 03300002
*        MODE                                                           03360002
*                                                                       03420002
*01*  ENTRY-POINT = IGC044                                              03480002
*                                                                       03540002
*02*     PURPOSE = SVC CHAP                                             03600002
*                                                                       03660002
*02*     LINKAGE = SVC 44 ONLY (CHAP MACRO)                             03720002
*                                                                       03780002
*02*     INPUT = REGISTER 0 CONTAINS THE ALGEBRAIC VALUE BY WHICH THE   03840002
*        DISPATCHING PRIORITY IS TO BE CHANGED. REGISTER 1 CONTAINS     03900002
*        ZERO OR THE ADDRESS OF A FULLWORD ON A FULLWORD BOUNDARY,      03960002
*        WHICH IN TURN CONTAINS THE ADDRESS OF THE TCB TO BE CHAPPED.   04020002
*        REGISTER 1 EQUAL TO ZERO INDICATES THAT THE CURRENT TASK IS TO 04080002
*        BE CHAPPED. FOR OTHER THAN SYSTEM TASKS, IF A TCB ADDRESS IS   04140002
*        SPECIFIED, IT MUST BE THE ADDRESS OF THE TCB OF A SUBTASK OF   04200002
*        THE CURRENT TASK.                                              04260002
*                                                                       04320002
*02*     OUTPUT = NONE                                                  04380002
*                                                                       04440002
*01*  EXIT-NORMAL =                                                     04500002
*                                                                       04550002
*02*     CONDITIONS = SVC CHAP EXITS TO IEAVEXP1, THE FORCE DISPATCHER  04610002
*        ENTRY TO EXIT PROLOGUE (OBTAINED FROM CVTEXP1).                04670002
*                                                                       04730002
*02*     OUTPUT = NONE                                                  04800002
*                                                                       04860002
*02*     RETURN-CODES = NONE                                            04920002
*                                                                       04980002
*01*  EXIT-ERROR = CHAP9030                                             05040002
*                                                                       05100002
*02*     CONDITIONS = FOR A DETECTED ERROR DURING SVC PROCESSING, ABEND 05150002
*        IS ISSUED. AN INVALID PARAMETER ADDRESS CAN ALSO CAUSE THE FRR 05210002
*        TO BE ENTERED TO PROCESS THE ERROR (SEE INTRODUCTORY COMMENTS  05270002
*        FOR IGC044R1).                                                 05330002
*                                                                       05400002
*02*     OUTPUT = ABEND CODE, 12C OR 22C                                05450002
*                                                                       05510002
*02*     RETURN-CODES = NONE                                            05570002
*                                                                       05630002
*01*  ENTRY-POINT = IGC044R1                                            05700002
*                                                                       05760002
*02*     PURPOSE = A FUNCTIONAL RECOVERY ROUTINE (FRR) TO PROVIDE       05820002
*        RECOVERY FOR TCB QUEUE ERRORS.                                 05880002
*                                                                       05940002
*02*     LINKAGE = ENTRY FROM RECOVERY TERMINATION MANAGER (RTM)        06000002
*        FROM A STACK ELEMENT CREATED BY SETFRR MACRO CODE IN IGC044    06050002
*        ENTRY PROCESSING.                                              06110002
*                                                                       06170002
*02*     INPUT = REGISTER 1 CONTAINS THE ADDRESS OF AN SDWA. REGISTER   06230002
*        14 CONTAINS THE RETURN ADDRESS. REGISTER 15 CONTAINS THE ENTRY 06290002
*        POINT ADDRESS. REGISTER 0 CONTAINS THE ADDRESS OF A 200 BYTE   06350002
*        WORKAREA.                                                      06410002
*                                                                       06470002
*02*     OUTPUT = RETURN CODE. NEW SYSTEM COMPLETION CODE IN CASE OF    06530002
*        ENTRY CAUSED BY INVALID PARAMETER.                             06600002
*                                                                       06650002
*01*  EXIT-NORMAL = CHAP7000                                            06710002
*                                                                       06770002
*02*     CONDITIONS = RETURN TO RTM VIA BR 14.                          06830002
*                                                                       06900002
*02*     OUTPUT = RETURN CODE. TCB QUEUES AS MODIFIED BY IGC044R2.      06950002
*                                                                       07010002
*02*     RETURN-CODES = 0, NO RETRY.                                    07070002
*                                                                       07130002
*01*  EXIT-ERROR = NONE                                                 07200002
*                                                                       07260002
*01*  ENTRY-POINT = IGC044R2                                            07320002
*                                                                       07380002
*02*     PURPOSE = RECOVERY ROUTINE WHICH VALIDATES THE TCB FAMILY AND  07440002
*        DISPATCHING QUEUES.                                            07500002
*                                                                       07560002
*02*     LINKAGE = BRANCH ENTRY ONLY, ADDRESS OBTAINED FROM V-TYPE      07620002
*        ADDRESS CONSTANT. CALLED BY CHAP SVC, STATUS, ATTACH SVC       07680002
*        MODULE IEAVEAT0, DETACH SVC MODULE IEAVEED0.                   07740002
*                                                                       07800002
*02*     INPUT = REGISTER 1 CONTAINS THE ADDRESS OF AN SDWA. REGISTER   07850002
*        14 CONTAINS THE RETURN ADDRESS. REGISTER 15 CONTAINS THE ENTRY 07900002
*        POINT ADDRESS. REGISTER 0 CONTAINS THE ADDRESS OF A 200 BYTE   07950002
*        WORKAREA. REGISTER 2 CONTAINS 0 FOR NO DUMP, OR THE ADDRESS OF 08000002
*        THE TITLE FOR AN SVC DUMP.                                     08050002
*                                                                       08100002
*02*     OUTPUT = RETURN CODE.                                          08170002
*                                                                       08240002
*02*     REGISTERS-SAVED = 0, 1, 9, 14                                  08310002
*                                                                       08400002
*01*  EXIT-NORMAL = CHAP8000                                            08450002
*                                                                       08510002
*02*     CONDITIONS = RETURN TO CALLER VIA BR 14.                       08570002
*                                                                       08630002
*02*     OUTPUT = RETURN CODE. TCB DISPATCHING AND FAMILY QUEUE MAY BE  08700002
*        RESTRUCTURED TO CORRECT ERRORS (SEE INTRODUCTORY COMMENTS FOR  08760002
*        IGC044R2).                                                     08820002
*                                                                       08880002
*02*     RETURN-CODES = SEE INTRODUCTORY COMMENTS FOR IGC044R2.         08940002
*                                                                       09000002
*01*  EXIT-ERROR = NONE                                                 09060002
*                                                                       09120002
*01*  EXTERNAL-REFERENCES =                                             09180002
*                                                                       09240002
*02*     ROUTINES = TESTAUTH TO CHECK CALLER FOR SYSTEM OR APF          09300002
*        AUTHORIZATION, BRANCH LINKAGE GENERATED BY TESTAUTH MACRO.     09350002
*        STATUS TO STOP THE TCB TO BE CHAPPED, BRANCH ADDRESS OBTAINED  09410002
*        FROM SCVTSTAT. QUEUE VERIFIER, IEAVEQV1 AT ENTRY POINT         09470002
*        IEAVEQV3, TO VERIFY TCB DISPATCHING QUEUE, BRANCH ADDRESS      09530002
*        FROM V-TYPE ADDRESS CONSTANT. TCB CONTROL BLOCK VERIFIER       09600002
*        IEAVETCB, TO VERIFY TCB'S ON THE FAMILY QUEUE, BRANCH          09650002
*        ADDRESS FROM V-TYPE ADDRESS CONSTANT. ASCB CONTROL BLOCK       09700002
*        VERIFIER IEAVECAS, TO VERIFY THE CURRENT ASXB BEFORE USING     09750002
*        THE TCB DISPATCHING QUEUE POINTERS, BRANCH ADDRESS FROM        09800002
*        V-TYPE ADDRESS CONSTANT. SVC DUMP TO DUMP THE SQA, LSQA, AND   09850002
*        TRACE TABLE ON SYSTEM ERROR, BRANCH LINKAGE GENERATED BY SDUMP 09900002
*        MACRO.                                                         10000002
*                                                                       10050002
*02*     DATA-AREAS = SDWA                                              10100002
*                                                                       10200002
*02*     CONTROL-BLOCKS = ASCB(W), ASXB(W), TCB(W), RB(R), CVT(R),      10250002
*        SCVT(R), PSA(R)                                                10300002
*                                                                       10360002
*01*  TABLES = 200 BYTE WORKAREA PROVIDED TO FRR BY RTM                 10420002
*                                                                       10500002
*01*  MACROS = SETFRR, TESTAUTH, SETRP, ABEND, MODESET, SDUMP           10560002
*                                                                       10620002
*02*    SERIALIZATION = LOCAL LOCK, HELD ON ENTRY, NEITHER OBTAINED NOR 10680002
*       RELEASED IN THIS MODULE.                                        10740002
*                                                                       10800002
*01*  CHANGE-ACTIVITY = Y02752, Y02753, VS02632, VS04242                10860002
*                                                                       10920002
*01*  MESSAGES = NONE                                                   10980002
*                                                                       11040002
*01*  ABEND-CODES = 12C, INVALID PARAMETER. 22C, INVALID PARAMETER WORD 11100002
*     ADDRESS.                                                          11160002
*                                                                       11220002
**** END OF SPECIFICATIONS ***/                                         11280002
         EJECT                                                          11340002
IGC044   CSECT                                                          11400002
         ENTRY IGC044R2                                                 11450002
*A-000000-999999                                                @Y02752 11500002
         SPACE 3                                                        11560002
*        EQUATES                                                        11620002
KEYMASK  EQU   X'F0'                   MASK FOR CLEARING PSW CMWP BITS  11700002
STATMASK EQU   X'0B'                   MASK FOR STATUS STOP TCB         11760002
WORDMASK EQU   B'00000011'             MASK FOR CHECKING FULLWORD       11820002
ABEND12C EQU   X'12C'                  ABEND CODE, PARM INVALID         11880002
ABEND22C EQU   X'22C'                  ABEND CODE, PARM ADDR INVALID    11940002
SAVELNG  EQU   72                      STANDARD SAVE AREA LENGTH        12000002
SPID245  EQU   245                     SUBPOOL ID, SQA                  12060002
C0       EQU   0                       CONSTANT 0                       12120002
C1       EQU   1                       CONSTANT 1                       12180002
C2       EQU   2                       CONSTANT 2                       12240002
C3       EQU   3                       CONSTANT 3                       12300002
C8       EQU   8                       CONSTANT 8                       12360002
C12      EQU   12                      CONSTANT 12                      12420002
C16      EQU   16                      CONSTANT 16                      12480002
RCODE4   EQU   4                       RETURN CODE, RECOVERY RTN        12540002
RCODE8   EQU   8                       RETURN CODE, RECOVERY RTN        12600002
RCODE12  EQU   12                      RETURN CODE, RECOVERY RTN        12660002
         SPACE 3                                                        12720002
*        REGISTERS                                                      12780002
R0       EQU   0                       REGISTER 0                       12840002
R1       EQU   1                       REGISTER 1                       12900002
R2       EQU   2                       REGISTER 2                       12960002
R2ASXB   EQU   2                       ADDRESS OF ASXB                  13020002
R3       EQU   3                       REGISTER 3                       13080002
R4CURTCB EQU   4                       ADDRESS OF CURRENT TCB           13140002
R4       EQU   4                       REGISTER 4                       13200002
R5CURRB  EQU   5                       ADDRESS OF CURRENT SVRB          13260002
R5       EQU   5                       REGISTER 5                       13320002
R6BASE   EQU   6                       ADDRESS OF ENTRY POINT           13380002
R7ASCB   EQU   7                       ADDRESS OF ASCB                  13440002
R7       EQU   7                       REGISTER 7                       13500002
R8CHAP   EQU   8                       ADDRESS OF TCB TO BE CHAPPED     13560002
R8       EQU   8                       REGISTER 8                       13620002
R9FRRWA  EQU   9                       ADDRESS OF FRR WORKAREA          13680002
R9       EQU   9                       REGISTER 9                       13740002
R10      EQU   10                      REGISTER 10                      13800002
R10VALUE EQU   10                      NUMERICAL VALUE FOR CHAPPING     13860002
R11      EQU   11                      REGISTER 11                      13920002
R12      EQU   12                      REGISTER 12                      13980002
R13      EQU   13                      REGISTER 13                      14040002
R13FORWD EQU   13                      CHAP TCB FORWARD PTR             14100002
R14      EQU   14                      REGISTER 14                      14160002
R14RET   EQU   14                      RETURN ADDRESS                   14220002
R15      EQU   15                      REGISTER 15                      14280002
R15BACK  EQU   15                      CHAP TCB BACK PTR                14340002
R15RETCD EQU   15                      RETURN CODE                      14400002
         EJECT                                                          14460002
*********************************************************************** 14520002
*                                                                     * 14580002
*                              CHAP SVC                               * 14640002
*                                                                     * 14700002
*********************************************************************** 14750002
         SPACE 4                                                        14800002
*/* IGC044: CHART  BEGIN FLOWCHART                                   */ 14850002
*/* FOOTING                                                             14900002
*/* SVC CHAP MAINLINE                                                */ 15000002
         SPACE                                                          15060002
*/* IGC044: E ENTER CHAP SVC                                         */ 15120002
         SPACE                                                          15180002
         USING IGC044,R6BASE           ESTABLISH ADDRESSABILITY         15240002
         USING RBSECT,R5CURRB                                           15300002
         SPACE                                                          15350002
         MODID BR=YES                  IDENTIFIER                       15410002
         SPACE                                                          15470002
         LR    R10VALUE,R0             SAVE CHANGE VALUE                15530002
         LR    R11,R1                  SAVE PARM ADDRESS                15600002
         SPACE                                                          15660002
*/* L SETFRR: ESTABLISH FRR                                          */ 15720002
         SPACE                                                          15780002
         LA    R14,IGC044R1            ADDRESS OF FRR           @Y02753 15840002
         SETFRR A,FRRAD=(R14),PARMAD=(R9FRRWA),WRKREGS=(R15,R1) @Y02753 15900002
         SPACE                                                          15960002
*/* D (YES,CHAP0010,NO,) IS THERE A PARM WORD                        */ 16020002
         SPACE                                                          16080002
         LTR   R11,R11                 WAS INPUT REG 1 NONZERO          16140002
         BNZ   CHAP0010                YES, MAY HAVE TO VALIDITY CHK    16200002
         SPACE                                                          16260002
*/* P (,CHAP0070) SET CHAP TCB ADDR TO CURRENT TCB                   */ 16320002
         SPACE                                                          16380002
         LA    R8CHAP,0(,R4CURTCB)     SET ADDR, CLEAR HIGH ORDER BYTE  16440002
         B     CHAP0070                BYPASS VALIDITY CHECKING         16500002
         SPACE                                                          16560002
*/* CHAP0010: L TESTAUTH: CHECK CALLER FOR KEY, STATE, APF AUTH      */ 16620002
         SPACE                                                          16680002
CHAP0010 EQU   *                       *                                16740002
         TESTAUTH FCTN=1,STATE=YES,KEY=YES,RBLEVEL=2,BRANCH=YES         16800002
         SPACE                                                          16860002
*/* D (NO,CHAP0030,YES,) IS CALLER AUTHORIZED                        */ 16920002
         SPACE                                                          16980002
         LTR   R15RETCD,R15RETCD       TESTAUTH RETURN CODE             17040002
         BNZ   CHAP0030                NONZERO, VALIDITY CHECK          17100002
         SPACE                                                          17160002
*/* P (,CHAP0020) SET CHAP ADDR TO PARM VALUE                        */ 17220002
         SPACE                                                          17280002
         L     R8CHAP,0(,R11)          INPUT TCB ADDRESS                17340002
         LA    R8CHAP,0(,R8CHAP)       INSURE HIGH ORDER BYTE ZERO      17400002
         B     CHAP0020                BYPASS VALIDITY CHECK            17460002
         SPACE                                                          17520002
*/* CHAP0030: D (NO,CHAP9000,YES,) IS INPUT PARM A FULLWORD          */ 17580002
         SPACE                                                          17640002
CHAP0030 EQU   *                       *                                17700002
         LA    R3,WORDMASK             ALIGNMENT MASK                   17760002
         NR    R3,R11                  IS ADDR ON WORD BOUNDARY         17820002
         BNZ   CHAP9000                NO, GO ABEND 22C                 17880002
         SPACE                                                          17940002
*/* P VALIDITY CHECK PARM WORD, SETTING CHAP ADDR TO PARM VALUE      */ 18000002
         SPACE                                                          18060002
         SR    R2,R2                   CLEAR                            18120002
         L     R1,RBLINK               ADDRESS OF CALLERS RB            18180002
         LA    R3,KEYMASK              MASK TO CLEAR KEY                18240002
         IC    R2,RBOPSW+C1-RBSECT(,R1) PSW KEY-CMWP BITS               18300002
         NR    R2,R3                   CALLERS PROTECT KEY              18360002
         MODESET KEYADDR=(2)           SET CALLERS KEY                  18420002
         L     R8CHAP,0(,R11)          PARM                             18480002
         ST    R8CHAP,0(,R11)          CHECK PROTECT KEY                18540002
         MODESET EXTKEY=SUPR           RESET KEY ZERO                   18600002
         LA    R8CHAP,0(,R8CHAP)       CLEAR HIGH ORDER BYTE            18660002
         SPACE                                                          18720002
*/* D (NO,CHAP9010,YES,) IS CHAP TCB A SUBTASK OF CURRENT TASK       */ 18780002
         SPACE                                                          18840002
         ICM   R11,B'1111',TCBLTC-TCB(R4CURTCB) ADDR OF FIRST SUBTASK   18900002
         B     CHAP0050                ENTER CHECKING LOOP              18960002
         SPACE                                                          19020002
CHAP0060 EQU   *                       TOP OF CHECKING LOOP             19080002
         ICM   R11,B'1111',TCBNTC-TCB(R11) ADDR OF NEXT SUBTASK         19140002
CHAP0050 EQU   *                       LOOP ENTRY POINT                 19200002
         BZ    CHAP9010                ALL SUBTASKS CHECKED WITH NO     19260002
*                                        MATCH, GO ABEND 12C            19320002
         CR    R8CHAP,R11              IS THIS THE CHAP TCB             19380002
         BNE   CHAP0060                NO, CHECK NEXT SUBTASK           19440002
*                                      YES, CONTINUE                    19500002
         EJECT                                                          19560002
*********************************************************************** 19620002
*                                                                     * 19680002
*                PARAMETER VALIDITY CHECKING COMPLETE                 * 19740002
*                                                                     * 19800002
*********************************************************************** 19860002
         SPACE 4                                                        19920002
*/* CHAP0020: D (YES,CHAP9010,NO,) HAS THE CHAP TCB TERMINATED       */ 19980002
         SPACE                                                          20040002
CHAP0020 EQU   *                       *                                20100002
         TM    TCBFLGS5-TCB(R8CHAP),TCBFC IS THE TASK COMPLETE FLAG ON  20160002
         BO    CHAP9010                YES, GO ABEND 12C                20220002
         SPACE                                                          20280002
*/* D (NO,CHAP0070,YES,) IS THE CHAP TCB ACTIVE                      */ 20340002
         SPACE                                                          20400002
         TM    TCBFBYT1-TCB(R8CHAP),TCBACTIV IS THE CHAP TASK ACTIVE    20460002
*                                              ON ANOTHER CPU           20520002
         BZ    CHAP0070                NO, BYPASS STATUS STOP           20580002
         SPACE                                                          20640002
*/* L STATUS: STOP THE CHAP TASK                                     */ 20700002
         SPACE                                                          20750002
         LA    R0,STATMASK             INDICATE RESET TCB NON DISP      20800002
         LR    R1,R8CHAP               CHAP TCB TO BE RESET             20850002
         SR    R13,R13                 NO NODISP BITS TO BE SET         20900002
         L     R15,CVTPTR              CVT ADDRESS                      20950002
         L     R15,CVTABEND-CVT(,R15)  SCVT ADDRESS                     21000002
         L     R15,SCVTSTAT-SCVTSECT(,R15) STATUS BRANCH ENTRY ADDR     21070002
         BALR  R14RET,R15              INVOKE STATUS                    21140002
         EJECT                                                          21210002
*********************************************************************** 21300002
*                                                                     * 21360002
*               UNCHAIN CHAP TCB FROM DISPATCHING QUEUE               * 21420002
*                                                                     * 21480002
*********************************************************************** 21540002
         SPACE 4                                                        21600002
*/* CHAP0070: S UNCHAIN: REMOVE CHAP TCB FROM DISPATCH QUEUE         */ 21650002
         SPACE                                                          21710002
CHAP0070 EQU   *                       *                                21770002
         L     R2ASXB,ASCBASXB-ASCB(,R7ASCB) CURRENT ASXB ADDR          21830002
         BAL   R14,UNCHAIN             REMOVE CHAP TCB FROM QUEUE       21900002
         SPACE 4                                                        21960002
*********************************************************************** 22020002
*                                                                     * 22080002
*                      ALTER CHAP TASK PRIORITIES                     * 22140002
*                                                                     * 22200002
*********************************************************************** 22260002
         SPACE 4                                                        22320002
*/* P CALCULATE NEW DISPATCHING PRIORITY                             */ 22380002
         SPACE                                                          22440002
         SR    R13,R13                 CLEAR                            22500002
         IC    R13,TCBDSP-TCB(,R8CHAP) GET PRESENT DISPATCH PRIORITY    22560002
         AR    R13,R10VALUE            CALCULATE NEW DISP PRIORITY      22620002
         SPACE                                                          22680002
*/* D (YES,CHAP0080,NO,) IS NEW DISP GT ZERO                         */ 22740002
         SPACE                                                          22800002
         LTR   R13,R13                 IS DISP POSITIVE                 22860002
         BP    CHAP0080                YES, CONTINUE CHECK              22920002
         SPACE                                                          22980002
*/* P (,CHAP0090) RESET NEW DISP TO ZERO                             */ 23040002
         SPACE                                                          23100002
         SR    R13,R13                 ZERO                             23160002
         B     CHAP0090                GO SET TCB DISP                  23220002
         SPACE                                                          23280002
*/* CHAP0080: D (NO,CHAP0100,YES,) IS NEW DISP GE CURRENT TCB LIMIT  */ 23340002
         SPACE                                                          23400002
CHAP0080 EQU   *                       *                                23460002
         SR    R10,R10                 CLEAR                            23520002
         IC    R10,TCBLMP-TCB(,R4CURTCB) CURRENT TCB LIMIT PRIORITY     23580002
         CR    R13,R10                 DOES NEW DISP EXCEED THIS LIMIT  23640002
         BL    CHAP0100                NO, CONTINUE CHECK               23700002
         SPACE                                                          23760002
*/* P (,CHAP0110) SET NEW DISP AND NEW LIMIT TO CURRENT LIMIT        */ 23820002
         SPACE                                                          23880002
         LR    R13,R10                 RESET CALCULATED DISP            23940002
*                                      NEW LIMIT VALUE=CURRENT LIMIT    24000002
         B     CHAP0110                GO STORE VALUES INTO CHAP TCB    24050002
         SPACE                                                          24100002
*/* CHAP0100: D (NO,CHAP0090,YES,) IS NEW DISP GT CHAP TCB LIMIT     */ 24150002
         SPACE                                                          24200002
CHAP0100 EQU   *                       *                                24250002
         IC    R10,TCBLMP-TCB(,R8CHAP) CHAP TCB LIMIT PRIORITY          24300002
         CR    R13,R10                 DOES NEW DISP EXCEED LIMIT       24370002
         BNH   CHAP0090                NO, GO STORE NEW DISP            24440002
         SPACE                                                          24510002
*/* P SET NEW LIMIT TO NEW DISP                                      */ 24600002
         SPACE                                                          24660002
         LR    R10,R13                 CHAP TCB LIMIT WILL INCREASE     24720002
         SPACE                                                          24780002
*/* CHAP0110: P STORE NEW LIMIT INTO CHAP TCB                        */ 24840002
         SPACE                                                          24900002
CHAP0110 EQU   *                       *                                24960002
         STC   R10,TCBLMP-TCB(,R8CHAP) SAVE                             25020002
         SPACE                                                          25080002
*/* CHAP0090: P STORE NEW DISP INTO CHAP TCB                         */ 25140002
         SPACE                                                          25200002
CHAP0090 EQU   *                       *                                25260002
         STC   R13,TCBDSP-TCB(,R8CHAP) SAVE                             25320002
         EJECT                                                          25380002
*********************************************************************** 25440002
*                                                                     * 25500002
*       RECHAIN CHAP TCB AT PROPER POSITION ON DISPATCHING QUEUE      * 25560002
*                                                                     * 25620002
*********************************************************************** 25680002
         SPACE 4                                                        25740002
*/* S CHAIN: ADD CHAP TCB TO DISPATCHING QUEUE                       */ 25800002
         SPACE                                                          25860002
         BAL   R14RET,CHAIN            INVOKE QUEUING SUBROUTINE        25920002
         SPACE 3                                                        25980002
*********************************************************************** 26040002
*                                                                     * 26100002
*    CHAP PROCESSING COMPLETE OR ERROR DETECTED, EXIT FROM CHAP SVC   * 26160002
*                                                                     * 26220002
*********************************************************************** 26280002
         SPACE 4                                                        26340002
*/* P (,CHAP0180) RESTORE REGS 0, 1, 14, 15                          */ 26400002
         SPACE                                                          26460002
         L     R15,CVTPTR              ADDRESS OF THE CVT               26520002
         L     R14RET,CVTEXP1-CVT(,R15) RETURN ADDRESS IN EXIT PROLOGUE 26580002
*                                      TO FORCE DISPATCHER ENTRY        26640002
         L     R15,RBGRS15             RESTORE 15                       26700002
         LM    R0,R1,RBGRS0            RESTORE 0, 1                     26760002
         B     CHAP0180                GO CANCEL FRR                    26820002
         SPACE                                                          26880002
*/* CHAP9000: P (,CHAP9020) SET ABEND CODE 22C                       */ 26940002
         SPACE                                                          27000002
CHAP9000 EQU   *                       *                                27060002
         LA    R1,ABEND22C             INVALID PARM WORD ADDR           27120002
         B     CHAP9020                GO CLEAR RETURN ADDRESS          27180002
         SPACE                                                          27240002
*/* CHAP9010: P SET ABEND CODE 12C                                   */ 27300002
         SPACE                                                          27360002
CHAP9010 EQU   *                       *                                27420002
         LA    R1,ABEND12C             INVALID PARM                     27480002
         SPACE                                                          27540002
*/* CHAP9020: P INDICATE ABEND                                       */ 27600002
         SPACE                                                          27660002
CHAP9020 EQU   *                       *                                27720002
         SR    R14RET,R14RET           NO RETURN ADDR - ABEND           27780002
         SPACE                                                          27840002
*/* CHAP0180: L SETFRR: CANCEL FRR                                   */ 27900002
         SPACE                                                          27960002
CHAP0180 EQU   *                       *                                28020002
         SETFRR D,WRKREGS=(R10,R11)    CANCEL FRR               @Y02753 28080002
         SPACE                                                          28140002
*/* D (YES,CHAP9030,NO,) IS ABEND INDICATED                          */ 28200002
         SPACE                                                          28260002
         LTR   R14RET,R14RET           IS RETURN ADDRESS ZERO           28320002
         SPACE                                                          28380002
*/* R () RETURN VIA EXIT PROLOGUE (IEAVEXP1)                         */ 28440002
         SPACE                                                          28500002
         BNZR  R14RET                  RETURN ADDRESS NONZERO, RETURN   28550002
         SPACE                                                          28600002
*/* CHAP9030: L () ABEND: TERMINATE CURRENT TASK                     */ 28650002
         SPACE                                                          28700002
CHAP9030 EQU   *                       *                                28750002
         ABEND (1),DUMP,,SYSTEM        INVOKE ABEND                     28800002
         SPACE                                                          28870002
*/* IGC044: END FLOWCHART                                            */ 28940002
         SPACE 2                                                        29010002
         DROP  R5CURRB                                                  29100002
         EJECT                                                          29160002
*/* CHAIN: CHART                                                     */ 29220002
*/* FOOTING                                                             29280002
*/* SUBROUTINE QUEUES A TCB ONTO TCB DISPATCHING QUEUE               */ 29340002
         SPACE 2                                                        29400002
*********************************************************************** 29460002
*                                                                     * 29520002
* SUBROUTINE CHAIN ADDS A TCB TO THE DISPATCHING QUEUE.               * 29580002
*                                                                     * 29640002
* REGISTER USAGE : R2ASXB - ADDRESS OF THE CURRENT ASXB               * 29700002
*                  R8CHAP - ADDRESS OF TCB TO BE CHAINED              * 29760002
*                  R10    - DESTROYED                                 * 29820002
*                  R11    - DESTROYED                                 * 29880002
*                  R14RET - RETURN ADDRESS                            * 29940002
*                                                                     * 30000002
*********************************************************************** 30060002
         SPACE 4                                                        30120002
*/* E ENTER CHAIN                                                    */ 30180002
         SPACE                                                          30240002
*/* P SET 'PRESENT' (ASXBFTCB) AND 'PREVIOUS' (0) TCB PTRS           */ 30300002
         SPACE                                                          30360002
CHAIN    EQU   *                       *                                30420002
         L     R10,ASXBFTCB-ASXB(,R2ASXB) ADDR OF TOP TCB ON QUEUE      30480002
         SR    R11,R11                 NO PREVIOUS TCB                  30540002
         SPACE                                                          30600002
*/* CHAP0130: D (YES,CHAP0230,NO,) IS 'PRESENT' PTR 0                */ 30660002
         SPACE                                                          30720002
CHAP0130 EQU   *                       TOP OF POSITION SEARCH LOOP      30780002
         LTR   R10,R10                 IS THIS THE END OF THE QUEUE     30840002
         BZ    CHAP0230                YES, PROCESS AS SUCH             30900002
         SPACE                                                          30960002
*/* D (YES,CHAP0160,NO,) IS CHAP TCB DISP GT 'PRESENT' TCB DISP      */ 31020002
         SPACE                                                          31080002
         CLC   TCBDSP-TCB(C1,R8CHAP),TCBDSP-TCB(R10)                    31140002
         BH    CHAP0160                CORRECT POSITION, GO CHAIN       31200002
         SPACE                                                          31260002
*/* P (,CHAP0130) SET PREVIOUS TO PRESENT, PRESENT TO NEXT ON QUEUE  */ 31320002
         SPACE                                                          31380002
         LR    R11,R10                 CHECKED TCB BECOMES PREVIOUS     31440002
         L     R10,TCBTCB-TCB(R10)     GET NEXT ON QUEUE                31500002
         B     CHAP0130                REPEAT SEARCH LOOP               31560002
         SPACE                                                          31620002
* END OF POSITION SEARCH LOOP                                           31680002
         SPACE                                                          31740002
*/* CHAP0230: P (,CHAP0120) CHAIN CHAP TCB AT END OF DISPATCH QUEUE  */ 31800002
         SPACE                                                          31860002
CHAP0230 EQU   *                       *                                31920002
         ST    R8CHAP,ASXBLTCB-ASXB(,R2ASXB) RESET END OF QUEUE PTR     31980002
         B     CHAP0120                GO SET REMAINING CHAIN PTRS      32040002
         SPACE                                                          32100002
*/* CHAP0160: P SET 'PRESENT' TCB'S BACK PTR TO CHAP TCB             */ 32160002
         SPACE                                                          32220002
CHAP0160 EQU   *                       *                                32280002
         ST    R8CHAP,TCBBACK-TCB(,R10) CHAIN PRESENT BACK TO CHAP      32340002
         SPACE                                                          32400002
*/* CHAP0120: D (NO,CHAP0150,YES,) IS PRESENT PTR THE TOP OF QUEUE   */ 32450002
         SPACE                                                          32500002
CHAP0120 EQU   *                       *                                32550002
         LTR   R11,R11                 ANY PREVIOUS TCB                 32600002
         BNZ   CHAP0150                YES, BYPASS TOP OF QUEUE RESET   32700002
         SPACE                                                          32760002
*/* P (,CHAP0140) CHAIN CHAP TCB AT TOP OF DISPATCHING QUEUE         */ 32820002
         SPACE                                                          32880002
         ST    R8CHAP,ASXBFTCB-ASXB(,R2ASXB) RESET TOP OF QUEUE PTR     32940002
         B     CHAP0140                GO SET CHAP TCB CHAIN PTRS       33000002
         SPACE                                                          33060002
*/* CHAP0150: P CHAIN CHAP TCB AFTER 'PREVIOUS' TCB                  */ 33120002
         SPACE                                                          33180002
CHAP0150 EQU   *                       *                                33240002
         ST    R8CHAP,TCBTCB-TCB(,R11) CHAP TCB FOLLOWS PREVIOUS TCB    33300002
         SPACE                                                          33360002
*/* CHAP0140: P SET CHAIN FIELDS IN CHAP TCB                         */ 33420002
         SPACE                                                          33480002
CHAP0140 EQU   *                       *                                33540002
         ST    R11,TCBBACK-TCB(,R8CHAP) CHAIN CHAP TCB TO PREVIOUS      33600002
         ST    R10,TCBTCB-TCB(,R8CHAP) CHAIN CHAP TCB TO PRESENT        33660002
         SPACE                                                          33720002
*/* R () RETURN                                                      */ 33780002
         SPACE                                                          33840002
         BR    R14RET                  RETURN                           33900002
         SPACE                                                          33960002
*/* CHAIN: END FLOWCHART                                             */ 34020002
         EJECT                                                          34080002
*/* UNCHAIN: CHART                                                   */ 34140002
*/* FOOTING                                                             34200002
*/* SUBROUTINE REMOVES A TCB FROM THE DISPATCHING QUEUE              */ 34260002
         SPACE 2                                                        34320002
*********************************************************************** 34380002
*                                                                     * 34440002
* SUBROUTINE UNCHAIN REMOVES A TCB FROM THE TCB DISPATCHING QUEUE     * 34500002
*                                                                     * 34560002
* REGISTER USAGE:                                                     * 34620002
*              R2ASXB - ADDRESS OF THE CURRENT ASXB                   * 34680002
*              R8CHAP - ADDRESS OF THE TCB TO BE UNCHAINED            * 34740002
*              R13    - DESTROYED                                     * 34800002
*              R14    - RETURN ADDRESS                                * 34860002
*              R15    - DESTROYED                                     * 34920002
*                                                                     * 34980002
*********************************************************************** 35040002
         SPACE 4                                                        35100002
*/* E ENTER UNCHAIN                                                  */ 35160002
         SPACE                                                          35220002
*/* P SET FORWARD PTR TO CHAP TCBTCB, BACK PTR TO CHAP TCBBACK       */ 35280002
         SPACE                                                          35340002
UNCHAIN  EQU   *                       ENTRY POINT                      35400002
         L     R13FORWD,TCBTCB-TCB(,R8CHAP) TCB FOLLOWING CHAP TCB      35460002
         L     R15BACK,TCBBACK-TCB(,R8CHAP) TCB PRECEEDING CHAP TCB     35520002
         SPACE                                                          35580002
*/* D (NO,CHAP0290,YES,) IS CHAP TCB AT TOP OF DISPATCHING QUEUE     */ 35640002
         SPACE                                                          35700002
         CL    R8CHAP,ASXBFTCB-ASXB(,R2ASXB) IS CHAP FIRST ON QUEUE     35760002
         BNE   CHAP0290                NO, UNCHAIN FROM PRECEEDING TCB  35820002
         SPACE                                                          35880002
*/* P (,CHAP0190) RESET TOP OF QUEUE PTR (ASXBFTCB) TO FORWARD PTR   */ 35940002
         SPACE                                                          36000002
         ST    R13FORWD,ASXBFTCB-ASXB(,R2ASXB) RESET PTR TO FIRST TCB   36060002
         B     CHAP0190                GO CHECK BOTTOM PTR              36120002
         SPACE                                                          36180002
*/* CHAP0290: P SET PRECEEDING TCB'S TCBTCB TO FORWARD PTR           */ 36240002
         SPACE                                                          36300002
CHAP0290 EQU   *                       *                                36360002
         ST    R13FORWD,TCBTCB-TCB(,R15BACK) BREAK FORWARD CHAIN        36420002
         SPACE                                                          36480002
*/* CHAP0190: D (NO,CHAP0200,YES,) IS CHAP TCB AT BOTTOM OF QUEUE    */ 36540002
         SPACE                                                          36600002
CHAP0190 EQU   *                       *                                36660002
         CL    R8CHAP,ASXBLTCB-ASXB(,R2ASXB) IS CHAP LAST ON QUEUE      36720002
         BNE   CHAP0200                NO, UNCHAIN FROM FOLLOWING TCB   36780002
         SPACE                                                          36840002
*/* P (,CHAP0240) RESET END OF QUEUE PTR (ASXBLTCB) TO BACK PTR      */ 36900002
         SPACE                                                          36960002
         ST    R15BACK,ASXBLTCB-ASXB(,R2ASXB) RESET PTR TO END TCB      37020002
         B     CHAP0240                GO TO EXIT SUBROUTINE            37080002
         SPACE                                                          37140002
*/* CHAP0200: P SET FOLLOWING TCB'S TCBBACK TO BACK PTR              */ 37200002
         SPACE                                                          37260002
CHAP0200 EQU   *                       *                                37320002
         ST    R15BACK,TCBBACK-TCB(,R13FORWD) BREAK BACK CHAIN          37380002
         SPACE                                                          37440002
*/* CHAP0240: R () RETURN TO CALLER                                  */ 37500002
         SPACE                                                          37560002
CHAP0240 EQU   *                       *                                37620002
         BR    R14                     RETURN                           37680002
         SPACE 3                                                        37740002
*/* UNCHAIN: END FLOWCHART                                           */ 37800002
         TITLE 'IEAVECH0 - FRR FOR CHAP SVC - ENTRY POINT IGC044R1'     37860002
*/* IGC044R1: CHART                                                  */ 37920002
*/* FOOTING                                                             37980002
*/* FRR FOR SVC CHAP                                                 */ 38040002
         SPACE 2                                                        38100002
*********************************************************************** 38160002
*                                                                     * 38220002
* IGC044R1 IS THE ENTRY POINT OF CHAP'S FUNCTIONAL RECOVERY ROUTINE   * 38280002
* (FRR). IT MAY BE ENTERED IN NORMAL PROCESSING BY MEANS OF A         * 38340002
* PARAMETER VALIDITY CHECK IN THE CALLER'S KEY, IN WHICH CASE THE FRR * 38400002
* SETS COMPLETION CODE 22C AND PERCOLATES, OR THROUGH AN UNEXPECTED   * 38460002
* ERROR. IN THE LATTER CASE, ROUTINE IGC044R2 IS INVOKED TO VALIDATE  * 38520002
* THE TCB QUEUES, AND THE ERROR IS PERCOLATED (I.E., THE FRR RETURNS  * 38580002
* CONTROL TO RTM SPECIFYING NO RETRY). IF ENTERED VIA PERCOLATION,    * 38640002
* STATUS HAS ALREADY CALLED IGC044R2 AND RECORDED, HENCE THIS FRR     * 38650002
* ONLY PERCOLATES. (STATUS IS THE ONLY ROUTINE CALLED BY CHAP HAVING  * 38660002
* ITS OWN FRR.)                                                       * 38670002
*                                                                     * 38700002
* SYSTEM ROUTINES CALLED / MACROS ISSUED: SETRP                       * 38760002
*                                                                     * 38820002
* SUBROUTINES CALLED: IGC044R2                                        * 38880002
*                                                                     * 38940002
* RETURN CODES SET: 0 (VIA SETRP)                                     * 39000002
*                                                                     * 39060002
* REGISTER USAGE:                                                     * 39120002
*        R0  - INPUT, ADDRESS OF 200 BYTE WORKAREA                    * 39180002
*        R1  - INPUT, ADDRESS OF SDWA                                 * 39240002
*        R9  - RETURN ADDRESS SAVE REGISTER                           * 39300002
*        R14 - RETURN ADDRESS                                         * 39302002
*        R15 - ENTRY POINT ADDRESS                                    * 39408802
*                                                                     * 39426402
*********************************************************************** 39500002
         SPACE 3                                                        39600002
*/* E ENTER IGC044R1                                                 */ 39650002
         SPACE                                                          39700002
IGC044R1 EQU   *                       ENTRY POINT                      39750002
         USING IGC044R1,R15                                     @Y02753 39800002
         L     R6BASE,CHAP044E         SVC ENTRY POINT ADDRESS  @Y02753 39850002
         DROP  R15                                              @Y02753 39900002
         SPACE                                                          39970002
*/* D (NO,CHAP7000,YES,) DID ERROR OCCUR IN CURRENT ADDRESS SPACE    */ 40040002
         SPACE                                                          40110002
         OC    SDWAFMID-SDWA(C2,R1),SDWAFMID-SDWA(R1) ASID 0    @Y02753 40180002
         BNZ   CHAP7000                NO, EXIT FRR             @Y02753 40250002
         SPACE                                                          40300002
*/* D (YES,CHAP7010,NO,) ENTRY DUE TO VALIDITY CHECK                 */ 40350002
         SPACE                                                          40400002
         LR    R9,R14                  SAVE RETURN ADDRESS      @Y02753 40450002
         IC    R7,SDWAMWP1-SDWA(,R1)   ERROR-TIME PSW KEY-CMWP  @Y02753 40500002
         LA    R8,KEYMASK              MASK CLEARS CMWP BITS    @Y02753 40560002
         NR    R7,R8                   WAS ERROR TIME KEY ZERO  @Y02753 40620002
         BZ    CHAP7020                YES, CONTINUE RECOVERY   @Y02753 40680002
*                                      NO, CHECK INVALID PARM   @Y02753 40740002
         TM    SDWAERRA-SDWA(R1),SDWAPCHK DID A PGM CHECK OCCUR @Y02753 40800002
         BO    CHAP7010                YES, ASSUME INVALID PARM @Y02753 40870002
*                                      NO, CONTINUE RECOVERY            40940002
         SPACE                                                          40948002
*/* CHAP7020: D (YES,CHAP7030,NO,) DID STATUS PERCOLATE THIS ERROR   */ 40956002
         SPACE                                                          40964002
CHAP7020 EQU   *                       *                                40972002
         TM    SDWAERRC-SDWA(R1),SDWAPERC HAS PERCOLATION      @YM04242 40980002
*                                      OCCURRED                         40988002
         BO    CHAP7030                YES, TURN OFF RECORDING @YM04242 40996002
         SPACE                                                          41010002
*/* S (,CHAP7000) IGC044R2: VALIDATE TCB QUEUES                      */ 41100002
         SPACE                                                          41150002
         SETRP RECORD=YES,RECPARM=CHAPFRR  ERROR RECORDING      @Y02753 41250002
         LA    R15,IGC044R2            ENTRY POINT ADDRESS      @Y02753 41300002
         LA    R2,CHAPSLNG             TITLE FOR SVC DUMP       @Y02753 41350002
         BALR  R14,R15                 QUEUE VALIDATION RTN     @Y02753 41400002
* NOTE: REGISTER 6 (BASE) IS RESET TO SAME VALUE IN IGC044R2.           41470002
* REGISTERS 0, 1, 9, 14 RETURNED UNCHANGED.                             41540002
         B     CHAP7000                GO EXIT FRR              @Y02753 41610002
         SPACE                                                          41700002
*/* CHAP7030: P (,CHAP7000) REQUEST NO RECORDING                     */ 41708002
         SPACE                                                          41716002
CHAP7030 EQU   *                       *                       @YM04242 41720002
         SETRP RECORD=NO               NO RECORDING            @YM04242 41724002
         B     CHAP7000                GO EXIT                 @YM04242 41732002
         SPACE                                                          41740002
*/* CHAP7010: P RESET COMPLETION CODE TO 22C                         */ 41750002
         SPACE                                                          41800002
CHAP7010 EQU   *                       *                                41850002
         SETRP RECORD=NO,DUMP=YES      USER ERROR, NO RECORDING @Y02753 41900002
         MVC   SDWACMPC-SDWA(C3,R1),CHAP22C INVALID PARMS       @Y02753 41950002
         SPACE                                                          42000002
*/* CHAP7000: R () RETURN TO RTM, NO RETRY (RC=0)                    */ 42060002
         SPACE                                                          42120002
CHAP7000 EQU   *                       *                                42180002
         SETRP FRELOCK=(LOCAL),RC=0    NO RETRY                 @Y02753 42240002
         LR    R14,R9                  RESTORE                  @Y02753 42300002
         BR    R14                     RETURN                   @Y02753 42370002
         SPACE                                                          42440002
*/* IGC044R1: END FLOWCHART                                          */ 42510002
         TITLE 'IEAVECH0 - TCB QUEUE VALIDATION ROUTINE - IGC044R2'     42600002
*/* IGC044R2: CHART                                                  */ 42660002
*/* FOOTING                                                             42720002
*/* TCB QUEUE VERIFICATION ROUTINE                                   */ 42780002
         SPACE 2                                                        42840002
*********************************************************************** 42900002
*                                                                     * 42960002
* THIS ROUTINE VERIFIES THE TCB DISPATCHING QUEUE AND THE TCB FAMILY  * 43020002
* QUEUE FOR THE CURRENT ADDRESS SPACE. IT IS AN EXTERNAL ENTRY TO     * 43080002
* CHAP, AND IS INVOKED BY OTHER MODULES FOR RECOVERY, SPECIFICALLY    * 43140002
* ATTACH, DETACH, AND STATUS.                                         * 43200002
*                                                                     * 43260002
* THE ERROR RECORDING OUTPUT DATA AREA IS SDWA FIELD SDWAVRA.         * 43320002
* ERROR RECORDING IS DONE IN THE FOLLOWING FORMAT:                    * 43380002
*                                                                     * 43440002
*        (1) IF QUEUE VERIFIER IS CALLED, THE RECORD BEGINS WITH AN 8 * 43500002
*            BYTE ID ENTRY, FOLLOWED BY ERROR RECORDING PERFORMED BY  * 43560002
*            QUEUE VERIFIER.                                          * 43620002
*        (2) FOLLOWING RECORDING BY QUEUE VERIFIER, AN 8 BYTE ID      * 43680002
*            ENTRY FOR IGC044R2, IF THAT ID WILL FIT INTO SPACE LEFT. * 43740002
*        (3) FOLLOWING THE ID, A 4 BYTE DESCRIPTOR:                   * 43800002
*              BYTE1 - FLAGS:                                         * 43860002
*                      BIT0 - 1, ERRORS WERE DETECTED BUT NOT RECORDED* 43920002
*                             0, ANY ERRORS DETECTED WERE RECORDED    * 43980002
*                      BITS1-7 - RESERVED                             * 44040002
*              BYTE2 - A COUNT OF THE NUMBER OF ERRORS RECORDED       * 44100002
*              BYTE3 - A COUNT OF THE NUMBER OF ERRORS DETECTED       * 44160002
*              BYTE4 - THE RETURN CODE FROM IGC044R2                  * 44220002
*        (4) FOLLOWING THE DESCRIPTOR, A 16 BYTE ENTRY FOR EACH ERROR * 44280002
*            DETECTED (AND CORRECTED), PROVIDED THERE WAS SPACE FOR   * 44340002
*            THE ENTRY. THE FORMAT OF THE 16 BYTE ENTRIES IS DESCRIBED* 44400002
*            IN THE GENERAL COMMENTS FOR SUBROUTINE RECERROR.         * 44460002
*                                                                     * 44520002
* SUBROUTINES CALLED: TCBCHECK                                        * 44580002
*                                                                     * 44640002
* SYSTEM ROUTINES CALLED / MACROS ISSUED:                             * 44700002
*                                                                     * 44760002
*        IEAVEQV0 (QUEUE VERIFIER) AT ENTRY POINT IEAVEQV3            * 44820002
*        ASCB/ASXB CONTROL BLOCK VERIFIER - IEAVECAS                  * 44880002
*        SDUMP                                                        * 44940002
*                                                                     * 45000002
* RETURN CODES SET:                                                   * 45060002
*                                                                     * 45120002
*        0 - THE TCB QUEUES OF THE CURRENT ADDRESS SPACE ARE USABLE   * 45180002
*        4 - THE TCB QUEUES OF THE CURRENT ADDRESS SPACE ARE UNUSABLE * 45240002
*            BECAUSE THE ASCB OR ASXB IS INVALID.                     * 45300002
*        8 - THE TCB DISPATCHING QUEUE WAS EMPTY AFTER PROCESSING BY  * 45360002
*            QUEUE VERIFIER.                                          * 45420002
*                                                                     * 45480002
* REGISTER USAGE:                                                     * 45540002
*                                                                     * 45600002
*        0 - ADDRESS OF 200 BYTE WORKAREA (UNCHANGED)                 * 45650002
*        1 - ADDRESS OF THE SDWA (UNCHANGED)                          * 45700002
*        2 - INPUT, 0 FOR NO SVC DUMP; ADDRESS OF DUMP TITLE FOR SVC  * 45750002
*            DUMP. CONTAINS ADDRESS OF CURRENT ASXB DURING PROCESSING.* 45800002
*        3 - WORKAREA ADDRESS DURING PROCESSING.                      * 45850002
*        6 - BASE REGISTER                                            * 45900002
*        9 - UNCHANGED                                                * 45970002
*        14 - RETURN ADDRESS (UNCHANGED)                              * 46040002
*        15 - INPUT, ENTRY POINT ADDRESS                              * 46110002
*             OUTPUT, RETURN CODE                                     * 46200002
*        ALL OTHER REGISTERS VOLATILE                                 * 46250002
*                                                                     * 46300002
* WORKAREA:                                                           * 46350002
*        THE 200 BYTE WORKAREA ADDRESSED BY REGISTER 0 ON ENTRY IS    * 46400002
*        MAPPED AS FOLLOWS: FIRST PORTION MAPPED BY DSECT WKAREA,     * 46450002
*        ADDRESSED BY REG 3, THEN THE PARM LIST AREA, MAPPED BY       * 46500002
*        DSECT QVPL (AREA ALSO USED FOR SDUMP LIST FORM), ADDRESSED   * 46560002
*        BY REG 1, THEN A 72 BYTE REGISTER SAVE AREA ADDRESSED BY     * 46620002
*        REG 13, THEN A WORKAREA FOR IEAVEQV3 (LENGTH DEFINED BY      * 46680002
*        QVPLWASZ).                                                   * 46740002
*                                                                     * 46800002
*********************************************************************** 46860002
         SPACE 3                                                        46920002
*/* E ENTER IGC044R2                                                 */ 46980002
         SPACE                                                          47040002
IGC044R2 EQU   *                       ENTRY POINT                      47100002
         USING IGC044R2,R15                                     @Y02753 47160002
         L     R6BASE,CHAP044E         SVC ENTRY POINT ADDRESS  @Y02753 47220002
         DROP  R15                                              @Y02753 47280002
         LR    R3,R0                   200 BYTE WORKAREA ADDR   @Y02753 47340002
         USING WKAREA,R3                                        @Y02753 47400002
         ST    R14,WKRETAD             SAVE RETURN ADDRESS      @Y02753 47470002
         LA    R13,WKLENGTH+QVPLSIZE(,R3) SAVE AREA ADDRESS     @Y02753 47540002
         SPACE                                                          47610002
*/* L IEAVECAS: VERIFY CURRENT ASCB/ASXB                             */ 47700002
         SPACE                                                          47750002
         STM   R2,R7,0(R13)            SAVE REGISTERS          @YM02632 47800002
         L     R0,PSAAOLD-PSA(,R0)     ADDRESS OF CURRENT ASCB  @Y02753 47850002
         L     R15,CHAPAVER            ENTRY POINT ADDRESS      @Y02753 47900002
         BALR  R14,R15                 CONTROL BLOCK VERIFIER   @Y02753 47950002
* NOTE: REGISTERS 2-7, 15 MAY BE CHANGED                                48000002
         LM    R2,R7,0(R13)            RESTORE REGISTERS       @YM02632 48070002
         SPACE                                                          48140002
*/* D (YES,CHAP8090,NO,) VALID                                       */ 48210002
         SPACE                                                          48300002
         LTR   R15,R15                 CAN ASXB BE REFERENCED   @Y02753 48360002
         BZ    CHAP8090                YES, CONTINUE            @Y02753 48420002
         SPACE                                                          48480002
*/* P (,CHAP8010) SET RETURN CODE 4                                  */ 48540002
         SPACE                                                          48600002
         BAL   R14,HDSETUP             MOVE HEADER, DESCRIPTOR  @Y02753 48650002
         LA    R15,RCODE4              QUEUES ARE UNUSABLE      @Y02753 48700002
         B     CHAP8010                GO SET RETURN CODE       @Y02753 48750002
         SPACE                                                          48800002
*/* CHAP8090: D (NO,CHAP8080,YES,) WAS SVC DUMP REQUESTED            */ 48850002
         SPACE                                                          48900002
CHAP8090 EQU   *                       *                                48970002
         LTR   R2,R2                   WAS DUMP TITLE PROVIDED  @Y02753 49040002
         BZ    CHAP8080                NO, BYPASS SVC DUMP      @Y02753 49110002
         SPACE                                                          49200002
*/* L SVC DUMP: REQUEST DUMP OF SQA, LSQA, TRACE                     */ 49250002
         SPACE                                                          49300002
         LR    R7,R1                   SAVE ADDRESS OF SDWA     @Y02753 49350002
         LA    R1,WKLENGTH(,R3)        ADDRESS OF LIST AREA     @Y02753 49400002
         MVC   0(SDUMPLNG,R1),CHAPSDMP MOVE LIST FORM           @Y02753 49450002
* NOTE: REGISTER 15 CONTAINS ZERO, INDICATING CURRENT ADDRESS SPACE     49500002
         SDUMP HDRAD=(R2),ASID=(R15),BRANCH=YES,MF=(E,(1))      @Y02753 49550002
         LR    R1,R7                   ADDRESS OF SDWA          @Y02753 49600002
         SPACE                                                          49650002
*/* CHAP8080: L IEAVEQV3: VERIFY AND CORRECT TCB DISPATCHING QUEUE   */ 49700002
         SPACE                                                          49800002
CHAP8080 EQU   *                       *                                49860002
         LA    R4,CHAPQVID             RECORDING HEADER FOR QV3 @Y02753 49920002
         LA    R5,L'CHAPQVID           LENGTH OF HEADER         @Y02753 49980002
         BAL   R14,RECMOVE             HEADER INTO OUTPUT AREA  @Y02753 50040002
         SPACE                                                          50100002
* BUILD PARAMETER LIST FOR IEAVEQV3                                     50160002
         SPACE                                                          50220002
         L     R2,PSAAOLD-PSA(,R0)     ADDRESS OF CURRENT ASCB  @Y02753 50280002
         LR    R0,R1                   ADDRESS OF SDWA          @Y02753 50340002
         LA    R10,SDWARA-SDWA(,R1)    ADDR OF RECORDING AREA  @YM02632 50400002
         LA    R1,WKLENGTH(,R3)        ADDRESS OF QVPL          @Y02753 50460002
         XC    0(QVPLSIZE,R1),0(R1)    CLEAR LIST AREA          @Y02753 50520002
         L     R2ASXB,ASCBASXB-ASCB(,R2)  ADDR OF CURRENT ASXB  @Y02753 50580002
         LA    R8,QVPLSIZE+SAVELNG(,R1) WORKAREA ADDRESS        @Y02753 50640002
         L     R15,CHAPTVER            ADDR OF TCB VERIFIER RTN @Y02753 50700002
         ST    R15,QVPLEVR-QVPL(,R1)   INTO PARM LIST           @Y02753 50760002
         ST    R10,QVPLODA-QVPL(,R1)   ADDR OF OUTPUT DATA AREA @Y02753 50820002
         ST    R8,QVPLWKA-QVPL(,R1)    ADDR IEAVEQV3 WORKAREA   @Y02753 50880002
         LA    R10,ASXBFTCB-ASXB(,R2ASXB) ADDR TCB QUEUE HEADER @Y02753 50940002
         ST    R10,QVPLHDR-QVPL(,R1)   INTO PARM LIST           @Y02753 51000002
         LA    R10,ASXBLTCB-ASXB(,R2ASXB) ADDR QUEUE TRAILER    @Y02753 51060002
         ST    R10,QVPLTRLR-QVPL(,R1)  INTO PARM LIST           @Y02753 51120002
         LA    R10,TCBTCB-TCB(,R0)     FORWARD PTR OFFSET       @Y02753 51180002
         STH   R10,QVPLFPTR-QVPL(,R1)  INTO PARM LIST           @Y02753 51240002
         LA    R10,TCBBACK-TCB(,R0)    BACK CHAIN PTR OFFSET    @Y02753 51300002
         STH   R10,QVPLBPTR-QVPL(,R1)  INTO PARM LIST           @Y02753 51370002
* FIELDS QVPLLELM, QVPLNOEL, QVPLFELM ARE INPUT, CONTAIN 0              51440002
* BECAUSE LIST AREA WAS CLEARED.                                        51510002
         SPACE                                                          51600002
* INVOKE IEAVEQV3                                                       51650002
         SPACE                                                          51700002
* REGISTER 13 CONTAINS ADDRESS OF A 72 BYTE SAVE AREA                   51750002
         L     R15,CHAPQV3             ADDRESS OF IEAVEQV3      @Y02753 51800002
         BALR  R14,R15                 INVOKE QUEUE VERIFIER    @Y02753 51850002
         SPACE                                                          51900002
*/* S HDSETUP: SET UP OUTPUT RECORDING AREA FOR IGC044R2             */ 51960002
         SPACE                                                          52020002
         LR    R1,R0                   RESTORE SDWA ADDRESS     @Y02753 52080002
         BAL   R14,HDSETUP             MOVE HEADER, DESCRIPTOR  @Y02753 52140002
         SPACE                                                          52200002
*/* CHAP8130: D (NO,CHAP8020,YES,) IS TCB DISPATCHING QUEUE EMPTY    */ 52260002
         SPACE                                                          52320002
CHAP8130 EQU   *                       *                                52380002
         ICM   R10,B'1111',ASXBFTCB-ASXB(R2ASXB) ADDR FIRST TCB @Y02753 52440002
         BNZ   CHAP8020                NONZERO, CONTINUE        @Y02753 52500002
         SPACE                                                          52570002
*/* P SET RETURN CODE 8, ASCBFAIL=1                                  */ 52640002
         SPACE                                                          52710002
         L     R7,PSAAOLD-PSA(,R0)     ADDRESS OF CURRENT ASCB  @Y02753 52800002
         OI    ASCBDSP1-ASCB(R7),ASCBFAIL ADDRESS SPACE FAILURE @Y02753 52850002
         LA    R15,RCODE8              QUEUES ARE UNUSABLE      @Y02753 52900002
         SPACE                                                          52950002
*/* CHAP8010: D (NO,CHAP8000,YES,) IS THERE A DESCRIPTOR WORD        */ 53000002
         SPACE                                                          53050002
CHAP8010 EQU   *                       *                                53100002
         ICM   R10,B'1111',WKOUTDP     ADDRESS OF DESCRIPTOR    @Y02753 53160002
         BZ    CHAP8000                NO DESCRIPTOR, GO EXIT   @Y02753 53220002
         SPACE                                                          53280002
*/* P (,CHAP8000) SAVE RETURN CODE IN DESCRIPTOR                     */ 53340002
         SPACE                                                          53400002
         ST    R15,0(,R10)             RETURN CODE              @Y02753 53460002
         B     CHAP8000                GO EXIT THIS ROUTINE     @Y02753 53520002
         SPACE                                                          53580002
*/* CHAP8020: P SET SEARCH TCB = TOP OF QUEUE, ITS TCBNTC=0, OTC=0   */ 53640002
         SPACE                                                          53700002
CHAP8020 EQU   *                       *                                53760002
         L     R10,ASXBETSK-ASXB(,R2ASXB) ADDRESS OF OLDEST TCB @Y02753 53820002
         SR    R11,R11                 CLEAR OTC                @Y02753 53880002
         ST    R11,TCBNTC-TCB(,R10)    OLDEST TCB HAS NO SISTER @Y02753 53940002
         EJECT                                                          54000002
*********************************************************************** 54070002
*                                                                     * 54140002
*                       INNER LOOP, ON TCBLTC                         * 54210002
*                                                                     * 54300002
*********************************************************************** 54350002
         SPACE                                                          54400002
*/* CHAP8030: P SET SEARCH TCB'S TCBOTC=OTC                          */ 54450002
         SPACE                                                          54500002
CHAP8030 EQU   *                       *                                54550002
         ST    R11,TCBOTC-TCB(,R10)    UNCOND UPDATE TCBOTC     @Y02753 54600002
         SPACE                                                          54660002
*/* CHAP8140: D (YES,CHAP8040,NO,) IS TCBLTC OF SEARCH TCB = 0       */ 54720002
         SPACE                                                          54780002
CHAP8140 EQU   *                       *                                54840002
         ICM   R7,B'1111',TCBLTC-TCB(R10) PTR MOST RECENT SUB   @Y02753 54900002
         BZ    CHAP8040                NO SUBTASK-CHECK SISTERS @Y02753 54977202
         SPACE                                                          55050002
*/* P SET OTC = SEARCH TCB                                           */ 55100002
         SPACE                                                          55150002
         LR    R11,R10                 UPDATE OTC FOR TCBCHECK  @Y02753 55240002
         SPACE                                                          55300002
*/* S TCBCHECK: VERIFY SEARCH TCB'S TCBLTC                           */ 55360002
         SPACE                                                          55420002
         BAL   R14,TCBCHECK            INVOKE CHECK OUT ROUTINE @Y02753 55480002
         SPACE                                                          55540002
*/* D (NO,CHAP8060,YES,) ANY REPLACEMENT                             */ 55600002
         SPACE                                                          55660002
         LTR   R15,R15                 UPDATE SEARCH TCBLTC     @Y02753 55720002
         BZ    CHAP8060                NO, CONTINUE             @Y02753 55780002
         SPACE                                                          55840002
*/* S RECERROR: SET ERROR ENTRY INTO OUTPUT AREA                     */ 55900002
         SPACE                                                          55960002
         L     R4,CHAPNTC              ERROR IDENTIFIER         @Y02753 56020002
         CLI   WKCHKRCD+C1,RCODE8      WAS A TCBNTC UPDATED     @Y02753 56080002
         BE    CHAP8150                YES, LEAVE IDENT AS IS   @Y02753 56140002
         L     R4,CHAPLTC              ERROR IDENTIFIER         @Y02753 56200002
CHAP8150 EQU   *                       *                                56260002
         BAL   R14,RECERROR            GO SET UP AND MOVE ENTRY @Y02753 56320002
         SPACE                                                          56380002
*/* D (NO,CHAP8140,YES,) WAS TCBCHECK RETURN CODE = 4                */ 56440002
         SPACE                                                          56500002
         CLI   WKCHKRCD+C1,RCODE4      WAS A TCBNTC UPDATED     @Y02753 56560002
         BNE   CHAP8140                GO RECHECK SEARCH TCBLTC @Y02753 56620002
         SPACE                                                          56680002
*/* P UPDATE SEARCH TCB'S TCBLTC WITH REPLACEMENT                    */ 56740002
         SPACE                                                          56800002
         ST    R8,TCBLTC-TCB(,R10)     FIX INVALID POINTER      @Y02753 56860002
         SPACE                                                          56920002
*/* D (YES,CHAP8040,NO,) IS NEW TCBLTC ZERO                          */ 56980002
         SPACE                                                          57040002
         LTR   R7,R8                   RESET SUBTASK PTR        @Y02753 57100002
         BZ    CHAP8040                NO SUBTASK-CHECK SISTERS @Y02753 57160002
         SPACE                                                          57220002
*/* CHAP8060: P (,CHAP8030) SET SEARCH TCB=TCBLTC                    */ 57280002
         SPACE                                                          57340002
CHAP8060 EQU   *                       *                                57400002
         LR    R10,R7                  NEW SEARCH TCB           @Y02753 57460002
         B     CHAP8030                CHECK SEARCH TCB SUBTSKS @Y02753 57520002
         EJECT                                                          57580002
*********************************************************************** 57640002
*                                                                     * 57700002
*             OUTER LOOP 1, ON TCBNTC OF LAST CHECKED TCB             * 57760002
*                                                                     * 57820002
*********************************************************************** 57880002
         SPACE 2                                                        57940002
*/* CHAP8040: D (YES,CHAP8050,NO,) IS SEARCH TCBNTC ZERO             */ 58000002
         SPACE                                                          58060002
CHAP8040 EQU   *                       *                                58120002
         ICM   R7,B'1111',TCBNTC-TCB(R10) NEXT SISTER PTR ZERO  @Y02753 58180002
         BZ    CHAP8050                NO NEXT SISTER, CHECK    @Y02753 58240002
*                                      SEARCH TCB'S MOTHER'S SISTER     58300002
         SPACE                                                          58360002
*/* S TCBCHECK: VERIFY SISTER TCB                                    */ 58420002
         SPACE                                                          58480002
         BAL   R14,TCBCHECK            INVOKE CHECKOUT ROUTINE  @Y02753 58540002
         SPACE                                                          58600002
*/* D (NO,CHAP8070,YES,) ANY REPLACEMENT                             */ 58660002
         SPACE                                                          58720002
         LTR   R15,R15                 UPDATE SEARCH TCBNTC     @Y02753 58780002
         BZ    CHAP8070                NO, CONTINUE             @Y02753 58840002
         SPACE                                                          58900002
*/* S RECERROR: INDICATE ERROR IN OUTPUT DATA AREA                   */ 58960002
         SPACE                                                          59020002
         L     R4,CHAPNTC              ERROR IDENTIFIER         @Y02753 59080002
         BAL   R14,RECERROR            GO SET UP AND MOVE ENTRY @Y02753 59140002
         SPACE                                                          59200002
*/* D (NO,CHAP8040,YES,) WAS TCBCHECK RETURN CODE = 4                */ 59260002
         SPACE                                                          59320002
         CLI   WKCHKRCD+C1,RCODE4      WAS SOME TCBNTC UPDATED  @Y02753 59380002
         BNE   CHAP8040                GO RECHECK SEARCH TCBNTC @Y02753 59440002
         SPACE                                                          59500002
*/* P UPDATE SEARCH TCB'S TCBNTC WITH REPLACEMENT                    */ 59560002
         SPACE                                                          59620002
         ST    R8,TCBNTC-TCB(,R10)     FIX INVALID POINTER      @Y02753 59680002
         SPACE                                                          59740002
*/* D (YES,CHAP8050,NO,) IS NEW TCBNTC ZERO                          */ 59800002
         SPACE                                                          59860002
         LTR   R7,R8                   RESET SISTER PTR         @Y02753 59920002
         BZ    CHAP8050                NO SISTER, CHECK LAST    @Y02753 59980002
*                                      CHECKED TCB'S MOTHER'S SISTERS   60040002
         SPACE                                                          60100002
*/* CHAP8070: P (,CHAP8030) SET SEARCH TCB = TCBNTC OF SEARCH TCB    */ 60160002
         SPACE                                                          60220002
CHAP8070 EQU   *                       *                                60280002
         LR    R10,R7                  NEW SEARCH TCB           @Y02753 60340002
         B     CHAP8030                CONTINUE SCAN            @Y02753 60400002
         EJECT                                                          60460002
*********************************************************************** 60520002
*                                                                     * 60580002
*        OUTER LOOP 2, ON TCBNTC OF MOTHER OF LAST CHECKED TCB        * 60640002
*                                                                     * 60700002
*********************************************************************** 60760002
         SPACE 2                                                        60820002
*/* CHAP8050: D (YES,CHAP8110,NO,) IS OTC=ASXBETSK                   */ 60880002
         SPACE                                                          60940002
CHAP8050 EQU   *                       *                                61000002
         C     R11,ASXBETSK-ASXB(,R2ASXB) ARE THERE ANY TCBS   @YM02632 61060002
*                                      ON FAMILY QUEUE NOT YET CHECKED  61120002
         BE    CHAP8110                NO, SCAN COMPLETE        @Y02753 61180002
         SPACE                                                          61240002
*/* P SET SEARCH TCB = TCBOTC OF SEARCH TCB                          */ 61300002
         SPACE                                                          61360002
         LR    R10,R11                 TO CONTINUE SCAN FROM    @Y02753 61420002
*                                      PREVIOUSLY CHECKED TCB           61480002
         SPACE                                                          61540002
*/* P (,CHAP8040) SET OTC = TCBOTC OF OTC TCB                        */ 61600002
         SPACE                                                          61660002
         L     R11,TCBOTC-TCB(,R11)    SET TO PREV UPDATED PTR  @Y02753 61720002
         B     CHAP8040                CONTINUE SCAN WITH PREV  @Y02753 61780002
*                                      CHECKED TCB'S SISTER PTR         61840002
         EJECT                                                          61900002
*********************************************************************** 61960002
*                                                                     * 62020002
*                        TREE SCAN COMPLETE                           * 62080002
*                                                                     * 62140002
*********************************************************************** 62200002
         SPACE 2                                                        62260002
*/* CHAP8110: P UPDATE ASXBTCBS, ASCBTCBS                            */ 62320002
         SPACE                                                          62380002
CHAP8110 EQU   *                       *                                62390002
         L     R12,PSAAOLD-PSA(,R0)    ADDRESS OF CURRENT ASCB  @Y02753 62400002
         SR    R4,R4                   CLEAR FOR COMPARE        @Y02753 62410002
         L     R13,ASCBTCBS-ASCB(,R12) PRESENT READY COUNT      @Y02753 62420002
CHAP8190 EQU   *                       TOP OF COMPARE-AND-SWAP LOOP     62440002
         L     R11,ASXBFTCB-ASXB(,R2ASXB) TOP OF DISPATCH QUEUE @Y02753 62500002
         SR    R10,R10                 INITIALIZE TOTAL COUNT   @Y02753 62560002
         SR    R7,R7                   INITIAL READY TCB COUNT  @Y02753 62590002
CHAP8160 EQU   *                       TOP OF COUNTING LOOP             62620002
         LA    R10,C1(,R10)            INCREMENT TOTAL COUNT    @Y02753 62680002
         CH    R4,TCBFLGS4-TCB(,R11)   IS THE TASK DISPATCHABLE @Y02753 62687002
         BNZ   CHAP8180                NO, DON'T UP READY COUNT @Y02753 62694002
         L     R8,TCBRBP-TCB(,R11)     ADDRESS OF TOP RB        @Y02753 62701002
         CLI   RBWCF-RBSECT(R8),C0     IS WAIT COUNT ZERO       @Y02753 62708002
         BNZ   CHAP8180                NO, DON'T UP READY COUNT @Y02753 62715002
         LA    R7,C1(,R7)              INCREMENT READY COUNT    @Y02753 62722002
CHAP8180 EQU   *                       *                                62729002
         ICM   R11,B'1111',TCBTCB-TCB(R11) ADDRESS OF NEXT TCB  @Y02753 62740002
         BNZ   CHAP8160                IF IT EXISTS, COUNT IT   @Y02753 62800002
         CS    R13,R7,ASCBTCBS-ASCB(R12) UPDATE READY COUNT IF  @Y02753 62810002
*                                      UNCHANGED                        62820002
         BNE   CHAP8190                OR RECOMPUTE COUNT       @Y02753 62830002
         STH   R10,ASXBTCBS-ASXB(,R2ASXB) SAVE TOTAL COUNT      @Y02753 62860002
         SPACE                                                          62920002
*/* P SET RETURN CODE = 0                                            */ 62980002
         SPACE                                                          63040002
         SR    R15,R15                 NO PERMANENT ERRORS      @Y02753 63100002
         SPACE                                                          63160002
*/* CHAP8000: R () RETURN TO CALLER                                  */ 63220002
         SPACE                                                          63280002
CHAP8000 EQU   *                       *                                63340002
         L     R14,WKRETAD             RETURN ADDRESS           @Y02753 63400002
         LR    R0,R3                   RESTORE                  @Y02753 63460002
         BR    R14                     RETURN                   @Y02753 63520002
         SPACE 2                                                        63580002
*/* IGC044R2: END FLOWCHART                                          */ 63640002
         EJECT                                                          63700002
*/* TCBCHECK: CHART                                                  */ 63760002
*/* FOOTING                                                             63820002
*/* SUBROUTINE VALIDITY CHECKS INPUT TCB, FINDS ALTERNATE            */ 63880002
         SPACE 2                                                        63940002
*********************************************************************** 64000002
*                                                                     * 64060002
* SUBROUTINE TCBCHECK IS CALLED BY ROUTINE IGC044R2 TO VALIDITY CHECK * 64120002
* A TCB. IN CASE IT IS NOT VALID, A SEARCH IS MADE TO FIND THE MOST   * 64180002
* RECENT SUBTASK OF THE TCB ADDRESSED BY REGISTER 11, BEGINNING WITH  * 64240002
* A TCB HAVING TCBNTC=0. IF THERE IS NO SUBTASK WITH TCBNTC=0, A      * 64300002
* SEARCH IS MADE FOR THE END OF THE SUBTASK QUEUE, AND THEN THE       * 64360002
* SEARCH FOR THE MOST RECENT SUBTASK IS MADE. THE ADDRESS OF THE TCB  * 64420002
* FOUND IS RETURNED TO IGC044R2 FOR USE IN CORRECTING THE INVALID     * 64480002
* POINTER.                                                            * 64540002
*                                                                     * 64600002
* SYSTEM ROUTINES CALLED / MACROS ISSUED: TCB CONTROL BLOCK VERIFIER  * 64660002
*                                            - IEAVETCB               * 64720002
*                                                                     * 64780002
* SUBROUTINES CALLED: CHAIN, UNCHAIN                                  * 64840002
*                                                                     * 64900002
* RETURN CODES SET: 0, 4                                              * 64960002
*                                                                     * 65020002
* REGISTER USAGE:                                                     * 65080002
*        R1    - ADDRESS OF THE SDWA                                  * 65140002
*        R2ASXB - ADDRESS OF THE CURRENT ASXB                         * 65200002
*        R3    - WORKAREA ADDRESS                                     * 65260002
*        R7    - INPUT TCB ADDRESS                                    * 65320002
*        R8    - OUTPUT TCB ADDRESS                                   * 65380002
*        R11   - MOTHER TCB ADDRESS FOR SEARCHING FAMILY QUEUE        * 65440002
*        R13   - SAVE AREA ADDRESS                                    * 65500002
*        R14   - RETURN ADDRESS                                       * 65560002
*        R15   - OUTPUT, RETURN CODE                                  * 65620002
*                                                                     * 65680002
*********************************************************************** 65740002
         SPACE 3                                                        65800002
*/* E ENTER TCBCHECK                                                 */ 65860002
         SPACE                                                          65920002
TCBCHECK EQU   *                       ENTRY POINT                      65980002
         STM   R14,R12,SVREG14-SAVEAREA(R13) SAVE REGISTERS     @Y02753 66040002
         SPACE                                                          66100002
*/* P INITIALIZE OUTPUT TCB ADDR TO 0, CLEAR FAMILY PTR, RETURN CODE */ 66160002
         SPACE                                                          66220002
         SR    R8,R8                   CLEAR                    @Y02753 66280002
         STH   R8,WKCHKRCD             CLEAR RETURN CODE        @Y02753 66340002
         ST    R8,WKFAMPTR             CLEAR FAMILY POINTER     @Y02753 66400002
         EJECT                                                          66460002
*/* L IEAVETCB: VALIDITY CHECK INPUT TCB ADDRESS                     */ 66520002
         SPACE                                                          66580002
         LR    R0,R7                   ADDR OF TCB TO CHECKED   @Y02753 66640002
         L     R15,CHAPTVER            ENTRY POINT ADDRESS      @Y02753 66700002
         BALR  R14,R15                 TCB CONTROL BLK CHECKER  @Y02753 66760002
* NOTE: REGISTERS 2-7,15 MAY BE CHANGED                                 66820002
         SPACE                                                          66880002
*/* D (YES,CHAP8500,NO,) IS INPUT TCB VALID                          */ 66940002
         SPACE                                                          67000002
         LR    R7,R0                   RESTORE                  @Y02753 67060002
         LM    R2,R3,SVREG2-SAVEAREA(R13) RESTORE               @Y02753 67120002
         L     R6BASE,SVREG6-SAVEAREA(,R13) RESTORE             @Y02753 67180002
         LTR   R15,R15                 VALID                    @Y02753 67240002
         BZ    CHAP8500                YES, CONTINUE            @Y02753 67300002
         SPACE                                                          67360002
*/* P SET RETURN CODE 4                                              */ 67420002
         SPACE                                                          67480002
         MVI   WKCHKRCD+C1,RCODE4      RET CODE, TCB NOT VALID  @Y02753 67540002
         EJECT                                                          67600002
*********************************************************************** 67660002
*                                                                     * 67720002
* LOOP RUNS THE DISPATCHING QUEUE SEARCHING FOR TCBS WITH TCBOTC      * 67780002
* MATCHING THE INPUT MOTHER TCB ADDRESS (REGISTER 11), IN ORDER TO    * 67840002
* BACK UP THE FAMILY QUEUE (TCBNTC POINTERS), AND THUS LOCATE THE     * 67900002
* BEST REPLACEMENT FOR THE INVALID TCB ADDRESS.                       * 67960002
*                                                                     * 68020002
*********************************************************************** 68080002
         SPACE 2                                                        68140002
*/* CHAP8510: P SET SEARCH TCB TO TOP OF DISPATCHING QUEUE           */ 68200002
         SPACE                                                          68260002
CHAP8510 EQU   *                       TOP OF FAMILY SEARCH LOOP        68320002
         L     R7,ASXBFTCB-ASXB(,R2ASXB) ADDRESS OF RCT TCB     @Y02753 68380002
         SPACE                                                          68440002
*/* CHAP8520: D (NO,CHAP8530,YES,) IS TCBOTC = INPUT OTC             */ 68500002
         SPACE                                                          68560002
CHAP8520 EQU   *                       *                                68620002
         C     R11,TCBOTC-TCB(,R7)     SEARCH TCB IN THE FAMILY @Y02753 68680002
         BNE   CHAP8530                NO, CONTINUE SCAN        @Y02753 68740002
         SPACE                                                          68800002
*/* P SET FAMILY TCB POINTER TO ADDR OF SEARCH TCB                   */ 68860002
         SPACE                                                          68920002
         ST    R7,WKFAMPTR             SAVE ADDRESS             @Y02753 68980002
         SPACE                                                          69040002
*/* D (NO,CHAP8530,YES,) IS TCBNTC OF SEARCH TCB = OUTPUT TCB        */ 69100002
         SPACE                                                          69160002
         C     R8,TCBNTC-TCB(,R7)      IS SEARCH TCB NEXT       @Y02753 69220002
         BNE   CHAP8530                NO, CONTINUE SEARCH      @Y02753 69280002
         SPACE                                                          69340002
*/* P (,CHAP8510) SET OUTPUT TCB = SEARCH TCB ADDR                   */ 69400002
         SPACE                                                          69460002
         LR    R8,R7                   SAVE MOST RECENT SUBTASK @Y02753 69520002
         B     CHAP8510                SEARCH FOR ANOTHER       @Y02753 69580002
         SPACE                                                          69640002
*/* CHAP8530: P SET SEARCH TCB TO NEXT ON THE DISPATCHING QUEUE      */ 69700002
         SPACE                                                          69760002
CHAP8530 EQU   *                       *                                69820002
         ICM   R7,B'1111',TCBTCB-TCB(R7) NEXT TCB               @Y02753 69880002
         SPACE                                                          69940002
*/* D (NO,CHAP8520,YES,) IS SEARCH TCB PTR 0                         */ 70000002
         SPACE                                                          70060002
         BNZ   CHAP8520                NOT ZERO, CHECK THIS TCB @Y02753 70120002
         SPACE                                                          70180002
*/* D (NO,CHAP8540,YES,) IS OUTPUT TCB ADDRESS = 0                   */ 70240002
         SPACE                                                          70300002
         LTR   R8,R8                   SEARCH SUCCESSFUL        @Y02753 70360002
         BNZ   CHAP8540                YES, PREPARE TO RETURN   @Y02753 70420002
         SPACE                                                          70480002
*/* D (YES,CHAP8590,NO,) IS FAMILY POINTER = 0                       */ 70540002
         SPACE                                                          70600002
         ICM   R7,B'1111',WKFAMPTR     WERE THERE NO SUBTASKS   @Y02753 70660002
         BZ    CHAP8590                YES, RETURN              @Y02753 70720002
         SPACE                                                          70780002
*/* N SEARCH TCB IS NOW INITIALIZED TO FAMILY POINTER                */ 70840002
         EJECT                                                          70900002
*********************************************************************** 70960002
*                                                                     * 71020002
* END OF FAMILY QUEUE POINTER LOST. RUN FAMILY QUEUE TO LOCATE END.   * 71080002
*                                                                     * 71140002
*********************************************************************** 71200002
         SPACE                                                          71260002
*/* CHAP8550: P OUTPUT = SEARCH, SEARCH = TCBNTC OF SEARCH TCB       */ 71320002
         SPACE                                                          71380002
CHAP8550 EQU   *                       *                                71440002
         LR    R4,R7                   SAVE                     @Y02753 71500002
         L     R7,TCBNTC-TCB(,R7)      NEXT OLDER SUBTASK       @Y02753 71560002
         SPACE                                                          71620002
*/* D (YES,CHAP8560,NO,) IS SEARCH TCB ADDR = FAMILY PTR             */ 71680002
         SPACE                                                          71740002
         C     R7,WKFAMPTR             IS FAMILY QUEUE CIRCULAR @Y02753 71800002
         BE    CHAP8560                YES, CLEAR CIRCULAR PTR  @Y02753 71860002
         SPACE                                                          71920002
*/* L IEAVETCB: VALIDITY CHECK SEARCH TCB ADDR                       */ 71980002
         SPACE                                                          72040002
         LR    R0,R7                   ADDR TCB TO BE CHECKED   @Y02753 72100002
         L     R15,CHAPTVER            ENTRY POINT ADDRESS      @Y02753 72160002
         BALR  R14,R15                 TCB CONTROL BLOCK VERIFR @Y02753 72220002
         SPACE                                                          72280002
*/* D (YES,CHAP8550,NO,) IS SEARCH TCB ADDR VALID                    */ 72340002
         SPACE                                                          72400002
         LR    R7,R0                   RESTORE                  @Y02753 72460002
         LM    R2,R3,SVREG2-SAVEAREA(R13) RESTORE               @Y02753 72520002
         L     R6BASE,SVREG6-SAVEAREA(,R13) RESTORE             @Y02753 72580002
         LTR   R15,R15                 VALIDITY CHECK RET CODE  @Y02753 72640002
         BZ    CHAP8550                CHECK NEXT OLDER SISTER  @Y02753 72700002
         SPACE                                                          72760002
*/* CHAP8560: P OUTPUT = LAST VALID SISTER, CLEAR TCBNTC             */ 72820002
         SPACE                                                          72880002
CHAP8560 EQU   *                       *                                72940002
         SR    R8,R8                   CLEAR                    @Y02753 73000002
         ST    R8,TCBNTC-TCB(,R4)      SEARCH TCB NOW CHAIN END @Y02753 73060002
         SPACE                                                          73120002
*/* P (,CHAP8590) SET RETURN CODE 8                                  */ 73180002
         SPACE                                                          73240002
         MVI   WKCHKRCD+C1,RCODE8      INDICATE A TCBNTC FIELD  @Y02753 73300002
*                                      HAS BEEN UPDATED         @Y02753 73360002
         B     CHAP8590                GO EXIT THIS ROUTINE     @Y02753 73420002
         EJECT                                                          73480002
*********************************************************************** 73540002
*                                                                     * 73600002
* INPUT TCB IS VALID. INSURE THAT IT IS ON THE DISPATCHING QUEUE IF   * 73660002
* TCBFC=1, AND NOT ON THE QUEUE IF TCBFC=0.                           * 73720002
*                                                                     * 73780002
*********************************************************************** 73850002
         SPACE 3                                                        73900002
*/* CHAP8500: P START SEARCH AT TOP OF DISPATCHING QUEUE             */ 73950002
         SPACE                                                          74000002
CHAP8500 EQU   *                       *                                74050002
         L     R8,ASXBFTCB-ASXB(,R2ASXB) ADDR TOP TCB ON QUEUE  @Y02753 74100002
         SPACE                                                          74170002
*/* CHAP8570: D (YES,CHAP8540,NO,) IS SEARCH TCB = INPUT TCB         */ 74240002
         SPACE                                                          74310002
CHAP8570 EQU   *                       TOP OF DISP QUEUE SEARCH LOOP    74400002
         C     R8,SVREG7-SAVEAREA(,R13) IS THIS THE INPUT TCB   @Y02753 74450002
         BE    CHAP8540                ON QUEUE, GO CHECK TCBFC @Y02753 74500002
         SPACE                                                          74550002
*/* P SET SEARCH TCB = NEXT TCB ON DISPATCHING QUEUE                 */ 74600002
         SPACE                                                          74650002
         ICM   R8,B'1111',TCBTCB-TCB(R8) NEXT TCB               @Y02753 74700002
         SPACE                                                          74750002
*/* D (NO,CHAP8570,YES,) IS SEARCH TCB PTR = 0                       */ 74800002
         SPACE                                                          74850002
         BNZ   CHAP8570                GO CHECK THIS TCB        @Y02753 74900002
         SPACE 2                                                        75000002
* FALL THROUGH LOOP MEANS INPUT TCB NOT ON DISPATCHING QUEUE            75070002
         SPACE 2                                                        75150002
*/* D (YES,CHAP8590,NO,) IS INPUT TCB'S TCBFC =1                     */ 75220002
         SPACE                                                          75300002
         L     R8,SVREG7-SAVEAREA(,R13) RESTORE INPUT           @Y02753 75360002
         TM    TCBFLGS5-TCB(R8),TCBFC  HAS END OF TASK OCCURRED @Y02753 75420002
         BO    CHAP8590                YES, RETURN TO CALLER    @Y02753 75480002
         SPACE                                                          75540002
*/* S (,CHAP8590) CHAIN: PUT INPUT TCB ON DISPATCHING QUEUE          */ 75600002
         SPACE                                                          75660002
         BAL   R14,CHAIN               PUT INPUT TCB ON QUEUE   @Y02753 75720002
         B     CHAP8590                GO EXIT THIS ROUTINE     @Y02753 75780002
         EJECT                                                          75840002
*/* CHAP8540: D (NO,CHAP8590,YES,) IS TCBFC=1                        */ 75900002
         SPACE                                                          75960002
CHAP8540 EQU   *                       *                                76020002
         TM    TCBFLGS5-TCB(R8),TCBFC  HAS END OF TASK OCCURRED @Y02753 76080002
         BZ    CHAP8590                LEAVE TCB ON DISP QUEUE  @Y02753 76140002
         SPACE                                                          76200002
*/* S UNCHAIN: REMOVE COMPLETE TCB FROM DISPATCH QUEUE               */ 76250002
         SPACE                                                          76300002
         LR    R7,R13                  SAVE                     @Y02753 76350002
         BAL   R14,UNCHAIN             TAKE TCB OFF QUEUE       @Y02753 76400002
         LR    R13,R7                  RESTORE                  @Y02753 76450002
         SPACE                                                          76500002
*/* CHAP8590: R RETURN TO CALLER                                     */ 76560002
         SPACE                                                          76620002
CHAP8590 EQU   *                       *                                76680002
         LM    R14,R7,SVREG14-SAVEAREA(R13) RESTORE REGS        @Y02753 76740002
         LM    R9,R12,SVREG9-SAVEAREA(R13) RESTORE REGS         @Y02753 76800002
         LH    R15,WKCHKRCD            RETURN CODE              @Y02753 76870002
         BR    R14                     RETURN                   @Y02753 76940002
         SPACE 2                                                        77010002
*/* TCBCHECK: END FLOWCHART                                          */ 77100002
         EJECT                                                          77160002
*/* RECERROR: CHART                                                  */ 77220002
*/* FOOTING                                                             77280002
*/* ERROR RECORDING SUBROUTINE                                       */ 77340002
         SPACE 2                                                        77400002
*********************************************************************** 77460002
*                                                                     * 77520002
* SUBROUTINE RECERROR SETS UP AN ENTRY FOR RECORDING EITHER AN        * 77580002
* INVALID TCBLTC FIELD OR INVALID TCBNTC FIELD. EACH ENTRY CONSISTS   * 77640002
* OF AN IDENTIFIER WORD CONTAINING C'NTC ' OR C'LTC ', THE ADDRESS    * 77700002
* OF THE TCB CONTAINING THE INVALID FIELD, THE INVALID FIELD CONTENTS * 77760002
* AND THE REPLACEMENT ADDRESS. EACH OF THESE ADDRESSES IS A FULLWORD, * 77820002
* SO THAT EACH ENTRY IS 4 WORDS.                                      * 77880002
*                                                                     * 77940002
* SUBROUTINES CALLED: RECMOVE                                         * 78000002
*                                                                     * 78060002
* SYSTEM ROUTINES CALLED / MACROS ISSUED: NONE                        * 78120002
*                                                                     * 78180002
* RETURN CODES SET: NONE                                              * 78240002
*                                                                     * 78300002
* REGISTER USAGE:                                                     * 78360002
*        4 - INPUT, ADDRESS OF IDENTIFIER WORD, DESTROYED             * 78420002
*        5 - DESTROYED                                                * 78480002
*        7 - INVALID FIELD CONTENTS                                   * 78540002
*        8 - REPLACEMENT FIELD CONTENTS                               * 78600002
*        10 - ADDRESS OF TCB HAVING INVALID FIELD                     * 78660002
*        14 - RETURN ADDRESS                                          * 78720002
*        15 - DESTROYED                                               * 78780002
*                                                                     * 78840002
*********************************************************************** 78900002
         SPACE 2                                                        78950002
*/* E ENTER RECERROR                                                 */ 79000002
         SPACE                                                          79050002
RECERROR EQU   *                       *                                79100002
         ST    R4,WKWORD1              SET IDENTIFIER IN ENTRY  @Y02753 79150002
         SPACE                                                          79200002
*/* D (NO,CHAP8700,YES,) IS THERE A DESCRIPTOR WORD                  */ 79260002
         SPACE                                                          79320002
         ICM   R4,B'1111',WKOUTDP      PTR TO DESCRIPTOR WORD   @Y02753 79380002
         BZ    CHAP8700                NO DESCRIPTOR, EXIT      @Y02753 79440002
         SPACE                                                          79500002
*/* P INCREMENT COUNT OF ERRORS DETECTED                             */ 79560002
         SPACE                                                          79620002
         SR    R5,R5                   CLEAR                    @Y02753 79680002
         IC    R5,C2(,R4)              COUNT OF ERRORS DETECTED @Y02753 79740002
         LA    R5,C1(,R5)              INCREMENT BY ONE         @Y02753 79800002
         STC   R5,C2(,R4)              INTO DESCRIPTOR          @Y02753 79870002
         STM   R4,R5,WKTEMP1           SAVE COUNT AND ADDRESS   @Y02753 79940002
         SPACE                                                          80010002
*/* D (YES,CHAP8700,NO,) HAS OVERFLOW OCCURRED                       */ 80100002
         SPACE                                                          80160002
         TM    WKFLAGS,WKOVERF         IS OUTPUT AREA FULL      @Y02753 80220002
         BO    CHAP8700                YES, GO EXIT SUBROUTINE  @Y02753 80280002
         SPACE                                                          80340002
*/* S RECMOVE: MOVE ENTRY TO OUTPUT DATA AREA                        */ 80400002
         SPACE                                                          80450002
         LR    R15,R14                 SAVE RETURN ADDRESS      @Y02753 80500002
         ST    R10,WKWORD2             ADDRESS OF ERROR TCB     @Y02753 80550002
         STM   R7,R8,WKWORD3           OLD, NEW FIELD CONTENTS  @Y02753 80600002
         LA    R4,WKWORD1              ADDRESS OF ENTRY         @Y02753 80650002
         LA    R5,C16                  LENGTH OF ENTRY          @Y02753 80700002
         BAL   R14,RECMOVE             MOVE ENTRY TO DATA AREA  @Y02753 80770002
         LR    R14,R15                 RESTORE                  @Y02753 80840002
         LM    R4,R5,WKTEMP1           RESTORE                  @Y02753 80910002
         SPACE                                                          81000002
*/* D (NO,CHAP8720,YES,) WAS MOVE SUCCESSFUL                         */ 81060002
         SPACE                                                          81120002
         TM    WKFLAGS,WKOVERF         DID OVERFLOW OCCUR       @Y02753 81180002
         BO    CHAP8720                SET INDICATOR IN OUTPUT  @Y02753 81240002
         SPACE                                                          81300002
*/* P (,CHAP8700) INCREMENT COUNT OF ERRORS RECORDED                 */ 81360002
         SPACE                                                          81420002
         STC   R5,C1(,R4)              UPDATE COUNT             @Y02753 81480002
         B     CHAP8700                GO EXIT SUBROUTINE       @Y02753 81540002
         SPACE                                                          81600002
*/* CHAP8720: P SET OVERFLOW INDICATOR IN OUTPUT DATA AREA           */ 81660002
         SPACE                                                          81720002
CHAP8720 EQU   *                       *                                81780002
         OI    0(R4),WKOVERF           BIT0=1 FOR OVERFLOW      @Y02753 81840002
         SPACE                                                          81900002
*/* CHAP8700: R () RETURN                                            */ 81960002
         SPACE                                                          82020002
CHAP8700 EQU   *                       *                                82080002
         BR    R14                     RETURN                   @Y02753 82140002
         SPACE 2                                                        82200002
*/* RECERROR: END FLOWCHART                                          */ 82260002
         EJECT                                                          82320002
*/* HDSETUP: CHART                                                   */ 82380002
*/* FOOTING                                                             82440002
*/* SUBROUTINE MOVES HEADER AND DESCRIPTOR WORD INTO OUTPUT AREA     */ 82500002
         SPACE 2                                                        82560002
*********************************************************************** 82620002
*                                                                     * 82680002
* SUBROUTINE HDSETUP MOVES THE OUTPUT HEADER AND DESCRIPTOR WORD      * 82740002
* INTO THE OUTPUT DATA AREA FOR RECORDING, PROVIDED THERE IS ROOM.    * 82800002
* IF THE MOVE IS MADE, WORKAREA FIELD WKOUTDP IS SET TO THE ADDRESS   * 82860002
* OF THE DESCRIPTOR WORD; OTHERWISE, WKOUTDP IS LEFT ZERO.            * 82920002
*                                                                     * 82980002
* SUBROUTINES CALLED: RECMOVE                                         * 83040002
*                                                                     * 83100002
* RETURN CODES SET: NONE                                              * 83160002
*                                                                     * 83220002
* REGISTER USAGE:                                                     * 83280002
*              R4, R5, R7, R10 - DESTROYED                            * 83340002
*                                                                     * 83400002
*********************************************************************** 83450002
         SPACE 2                                                        83500002
*/* E ENTER HDSETUP                                                  */ 83550002
         SPACE                                                          83600002
HDSETUP  EQU   *                       *                                83650002
         LR    R10,R14                 SAVE RETURN ADDRESS      @Y02753 83700002
         LA    R4,CHAPR2ID             ADDRESS OF HEADER        @Y02753 83750002
         LA    R5,C12                  LNG OF HEADER+DESCRIPTOR @Y02753 83800002
         SR    R7,R7                   CLEAR                    @Y02753 83850002
         IC    R7,SDWAURAL-SDWA(,R1)   SAVE OFFSET              @Y02753 83900002
         SPACE                                                          84000002
*/* S RECMOVE: MOVE HEADER DESCRIPTOR                                */ 84070002
         SPACE                                                          84140002
         BAL   R14,RECMOVE             MOVE HEADER, DESCRIPTOR  @Y02753 84210002
         SPACE                                                          84300002
*/* D (NO,CHAP8170,YES,) WAS DESCRIPTOR MOVED                        */ 84360002
         SPACE                                                          84420002
         TM    WKFLAGS,WKOVERF         DID OVERFLOW OCCUR       @Y02753 84480002
         BO    CHAP8170                LEAVE DESCRIPTOR PTR 0   @Y02753 84540002
         SPACE                                                          84600002
*/* P SAVE ADDRESS OF DESCRIPTOR WORD                                */ 84660002
         SPACE                                                          84720002
         LA    R5,SDWAVRA-SDWA+C8(R7,R1) ADDR DESCRIPTOR WORD   @Y02753 84780002
         ST    R5,WKOUTDP              INTO WORKAREA            @Y02753 84840002
         SPACE                                                          84900002
*/* CHAP8170: R () RETURN                                            */ 84950002
         SPACE                                                          85000002
CHAP8170 EQU   *                       *                                85050002
         LR    R14,R10                 RESTORE RETURN ADDRESS   @Y02753 85100002
         BR    R14                     RETURN                   @Y02753 85150002
         SPACE                                                          85200002
*/* HDSETUP: END FLOWCHART                                           */ 85270002
         EJECT                                                          85340002
*/* RECMOVE: CHART                                                   */ 85410002
*/* FOOTING                                                             85500002
*/* SUBROUTINE MOVES ERROR INFORMATION INTO OUTPUT DATA AREA         */ 85560002
         SPACE 2                                                        85620002
*********************************************************************** 85680002
*                                                                     * 85740002
* SUBROUTINE RECMOVE MOVES AN ERROR ENTRY INTO THE ERROR RECORDING    * 85800002
* OUTPUT DATA AREA, UPDATING THE OFFSET IN THE DATA AREA HEADER. AN   * 85860002
* INDICATOR, WKOVERF IN WKFLAGS, IS SET IF THE ENTRY WILL NOT FIT.    * 85920002
*                                                                     * 85980002
* SUBROUTINES CALLED: NONE                                            * 86040002
*                                                                     * 86100002
* RETURN CODES SET: NONE                                              * 86160002
*                                                                     * 86220002
* REGISTER USAGE:                                                     * 86280002
*                                                                     * 86340002
*        4 - ADDRESS OF THE ERROR ENTRY                               * 86400002
*        5 - LENGTH OF THE ERROR ENTRY                                * 86410002
*        13 - SAVE AREA ADDRESS                                       * 86500002
*        14 - RETURN ADDRESS                                          * 86550002
*        ALL REGISTERS RESTORED ON RETURN                             * 86620002
*                                                                     * 86700002
*********************************************************************** 86702002
         SPACE 2                                                        86800002
*/* E ENTER RECMOVE                                                  */ 86850002
         SPACE                                                          86900002
RECMOVE  EQU   *                       *                                86950002
         STM   R14,R12,SVREG14-SAVEAREA(R13) SAVE REGISTERS     @Y02753 87049902
         SPACE                                                          87069902
*/* D (YES,CHAP8810,NO,) WILL DATA FIT INTO RECORDING AREA           */ 87149802
         SPACE                                                          87189802
         SR    R7,R7                   CLEAR                            87243102
         IC    R7,SDWAURAL-SDWA(,R1)   OFFSET TO AVAILABLE AREA @Y02753 87302002
         LA    R8,0(R5,R7)             NEW OFFSET               @Y02753 87367002
         CH    R8,SDWAVRAL-SDWA(,R1)   NEW OFFSET WITHIN AREA   @Y02753 87450002
         BNH   CHAP8810                YES, CONTINUE            @Y02753 87480002
         SPACE                                                          87543202
*/* P (,CHAP8800) SET RECORDING OVERFLOW INDICATOR                   */ 87605802
         SPACE                                                          87665802
         OI    WKFLAGS,WKOVERF         FLAG NO MORE RECORDING   @Y02753 87721802
         B     CHAP8800                GO EXIT SUBROUTINE       @Y02753 87780302
         SPACE                                                          87840002
*/* CHAP8810: P MOVE ERROR INFORMATION INTO RECORDING AREA           */ 87901402
         SPACE                                                          87960502
CHAP8810 EQU   *                       *                                88021402
         STC   R8,SDWAURAL-SDWA(,R1)   SAVE NEW OFFSET          @Y02753 88080102
         LA    R8,SDWAVRA-SDWA(R7,R1)  ADDR OF AVAILABLE SPACE  @Y02753 88140602
         BCTR  R5,R0                   ENTRY LENGTH LESS ONE    @Y02753 88200102
         EX    R5,CHAPMVC              MOVE ENTRY               @Y02753 88266602
         SPACE                                                          88320202
*/* CHAP8800: R () RETURN                                            */ 88406902
         SPACE                                                          88441002
CHAP8800 EQU   *                       *                                88520002
         LM    R14,R12,SVREG14-SAVEAREA(R13) RESTORE REGISTERS  @Y02753 88574602
         BR    R14                     RETURN                   @Y02753 88627802
         DROP  R3                      WORKAREA NO LONGER USED  @Y02753 88681802
         SPACE 2                                                        88741802
*/* RECMOVE: END FLOWCHART                                           */ 88809002
         TITLE 'IEAVECH0 - CHAP SVC - ENTRY POINT IGC044'               88860402
*********************************************************************** 88921702
*                                                                     * 88980602
*                         CONSTANTS                                   * 89100002
*                                                                     * 89160002
*********************************************************************** 89220002
         SPACE 3                                                        89280002
CHAP044E DC    A(IGC044)               SVC ENTRY POINT ADDRESS          89340002
CHAPQV3  DC    V(IEAVEQV3)             QUEUE VERIFIER ENTRY POINT ADDR  89400002
CHAPTVER DC    V(IEAVETCB)             TCB CONTROL BLOCK VERIFIER       89460002
CHAPAVER DC    V(IEAVECAS)             CURRENT ASCB VERIFIER            89520002
CHAPLTC  DS    0F                      FULLWORD ALIGNMENT               89580002
         DC    CL4'LTC'                IDENTIFIER FOR TCBLTC FIELD      89640002
CHAPNTC  DS    0F                      FULLWORD ALIGNMENT               89700002
         DC    CL4'NTC'                IDENTIFIER FOR TCBNTC FIELD      89760002
CHAPR2ID DS    0F                      12 BYTE ENTRY                    89820002
         DC    CL8'IGC044R2'           TCB QUEUE VALIDATION RTN ID      89880002
         DC    F'0'                    DESCRIPTOR WORD                  89940002
CHAPQVID DC    CL8'IEAVEQV3'           QUEUE VERIFIER ID                90000002
CHAPMVC  MVC   0(0,R8),0(R4)           EXECUTE TARGET, MOVES ENTRY      90060002
CHAP22C  DC    X'22C000'               COMPLETION CODE, INVALID PARM    90120002
CHAPSLNG DC    FL1'24'                 LENGTH OF TITLE FOR SVC DUMP     90180002
CHAPFRR  DS    0CL24                   RECORD PARAMETER LIST            90240002
         DC    CL8'IEAVECH0'           MODULE NAME                      90300002
         DC    CL8'IGC044'             CSECT NAME                       90360002
         DC    CL8'IGC044R1'           FRR ID                           90420002
CHAPSDMP SDUMP SDATA=(SQA,LSQA,TRT),MF=L SVC DUMP FOR RECOVERY          90480002
SDUMPLNG EQU   *-CHAPSDMP              LENGTH OF MACRO LIST FORM        90540002
         EJECT                                                          90600002
*********************************************************************** 90660002
*                                                                     * 90720002
*                            MAPPING MACROS                           * 90780002
*                                                                     * 90840002
*********************************************************************** 90900002
         SPACE 4                                                        90960002
         CVT   DSECT=YES                                                91020002
         EJECT                                                          91080002
         IHASCVT DSECT=YES,LIST=YES                                     91140002
         EJECT                                                          91200002
         IHAASCB                                                        91260002
         EJECT                                                          91320002
         IHAASXB                                                        91380002
         EJECT                                                          91440002
         IHAPSA                                                         91500002
         EJECT                                                          91560002
         IHAFRRS                                                        91620002
         EJECT                                                          91680002
         IKJTCB LIST=YES                                                91740002
         EJECT                                                          91800002
         IHARB                                                          91850002
         EJECT                                                          91900002
         IHASDWA                                                        91950002
         EJECT                                                          92000002
         IHAQVPL                                                        92100002
         EJECT                                                          92160002
*********************************************************************** 92220002
*                                                                     * 92280002
*                   FRR TCB QUEUE ROUTINE WORKAREA                    * 92340002
*                                                                     * 92400002
*********************************************************************** 92460002
         SPACE 3                                                        92520002
WKAREA   DSECT                         WORKAREA FOR IGC044R2            92580002
WKRETAD  DS    A                       RETURN ADDRESS FROM IGC044R2     92640002
WKFAMPTR DS    A                       FAMILY PTR USED IN TCBCHECK      92700002
WKOUTDP  DS    A                       ADDRESS OF OUTPUT DESCRIPTOR     92750002
WKWORD1  DS    F                       ERROR ENTRY WORD                 92800002
WKWORD2  DS    F                       ERROR ENTRY WORD                 92850002
WKWORD3  DS    F                       ERROR ENTRY WORD                 92900002
WKWORD4  DS    F                       ERROR ENTRY WORD                 92950002
WKTEMP1  DS    F                       TEMPORARY SAVE WORD              93005102
WKTEMP2  DS    F                       TEMPORARY SAVE WORD              93069902
WKCHKRCD DS    H                       RETURN CODE FROM TCBCHECK        93149802
WKFLAGS  DS    C                       FLAGS                            93189802
WKOVERF  EQU   X'80'                   1 - OVERFLOW HAS OCCURRED        93300002
*                                      0 - NO OVERFLOW YET              93400002
*                                      BITS 1-7 RESERVED                93500002
WKLENGTH EQU   ((*-WKAREA+3)/4)*4      LENGTH OF WORKAREA               93600002
         SPACE 4                                                        93700002
*********************************************************************** 93800002
*                                                                     * 93900002
*                              SAVE AREA                              * 94000002
*                                                                     * 94100002
*********************************************************************** 94200002
 SPACE 3                                                                94300002
SAVEAREA DSECT                         MAPPING OF STANDARD SAVE AREA    94400002
SVWORD1  DS    A                       NOT USED                         94500002
SVPREVA  DS    A                       ADDRESS OF PREVIOUS SAVE AREA    94600002
SVNEXTA  DS    A                       ADDRESS OF NEXT SAVE AREA        94700002
SVREG14  DS    A                       REGISTER 14                      94800002
SVREG15  DS    A                       REGISTER 15                      94900002
SVREG0   DS    A                       REGISTER 0                       95000002
SVREG1   DS    A                       REGISTER 1                       95100002
SVREG2   DS    A                       REGISTER 2                       95200002
SVREG3   DS    A                       REGISTER 3                       95300002
SVREG4   DS    A                       REGISTER 4                       95400002
SVREG5   DS    A                       REGISTER 5                       95500002
SVREG6   DS    A                       REGISTER 6                       95600002
SVREG7   DS    A                       REGISTER 7                       95700002
SVREG8   DS    A                       REGISTER 8                       95800002
SVREG9   DS    A                       REGISTER 9                       95900002
SVREG10  DS    A                       REGISTER 10                      96000002
SVREG11  DS    A                       REGISTER 11                      96100002
SVREG12  DS    A                       REGISTER 12                      96200002
         EJECT                                                          96300002
*********************************************************************** 96400002
*                                                                     * 96500002
*                       FRR SIX-WORD WORKAREA                         * 96600002
*                                                                     * 96700002
*********************************************************************** 96800002
         SPACE 3                                                        96900002
CHAPXA   DSECT                         WORKAREA OBTAINED BY SETFRR      97000002
CHAPX1   DS    A                       WORD 1                           97100002
CHAPX2   DS    F                       WORD 2                           97200002
CHAPX3   DS    F                       WORD 3                           97300002
CHAPX4   DS    F                       WORD 4                           97400002
CHAPX5   DS    F                       WORD 5                           97500002
CHAPX6   DS    F                       WORD 6                           97600002
         SPACE 4                                                        97700002
         END                                                            97800002
./  ADD  SSI=32820431,NAME=IEAVEED0
         TITLE 'IEAVEED0 - DETACH SVC - ENTRY POINT IGC062'             00050002
IGC062   CSECT                                                          00100002
*A-000000-999999                                                @Y02752 00150002
         SPACE 2                                                        00200002
* /* START OF SPECIFICATIONS ****                                       00300002
*                                                                       00350002
*01*  MODULE-NAME = IEAVEED0                                            00400002
*                                                                       00450002
*02*     CSECT-NAME = IGC062                                            00500002
*                                                                       00600002
*01*  DESCRIPTIVE-NAME = DETACH                                         00650002
*                                                                       00700002
*01*  COPYRIGHT = NONE                                                  00750002
*                                                                       00800002
*01*  STATUS = OS/VS2 RELEASE 2 VERSION 1                               00900002
*                                                                       00960002
*01*  FUNCTION = THIS MODULE PROVIDES AN SVC TO FREE TCB RESOURCES OF A 01020002
*     COMPLETED SUBTASK, AND TO FORCE COMPLETION OF AN INCOMPLETE       01080002
*     SUBTASK. A BRANCH ENTRY IS USED FOR THE LATTER PURPOSE BY ABEND,  01140002
*     AND IS CALLED BY END OF TASK PROCESSING AS A TASK TERMINATION     01200002
*     RESOURCE MANAGER (TRRM).                                          01250002
*                                                                       01300002
*02*     OPERATION = SVC ENTRY PERFORMS VALIDITY CHECKING AND           01380002
*        INITIALIZATION FUNCTIONS AND CALLS SUBROUTINE SUBRTN (SEE      01410002
*        INTRODUCTORY COMMENTS FOR SUBRTN).  ABEND BRANCH ENTRY SAVES   01500002
*        REGISTERS AND CALLS SUBROUTINE SUBRTN.  END OF TASK BRANCH     01560002
*        ENTRY (TTRM) POSTS THE END OF TASK ECB, IF THERE IS ONE, AND   01620002
*        SCHEDULES THE END OF TASK EXIT  ROUTINE (ETXR) IF THERE IS     01640002
*        ONE. THE TCB IS DEQUEUED FROM THE TCB DISPATCHING QUEUE. IF    01700002
*        THERE WAS NEITHER AN ECB NOR ETXR, THE TCB RESOURCES ARE       01800002
*        FREED, OTHERWISE NOT.                                          01850002
*                                                                       01900002
*01*   NOTES =                                                          01950002
*                                                                       02000002
*02*     DEPENDENCIES = THE LOCAL LOCK IS HELD UPON ENTRY, AND MAY BE   02050002
*        RELEASED AND REOBTAINED BY SUBROUTINE  SUBRTN. OTHERWISE, IT   02150002
*        IS HELD THROUGHOUT THIS MODULE.                                02200002
*                                                                       02250002
*03*           CHARACTER-CODE-DEPENDENCIES = NONE                       02300002
*                                                                       02350002
*02*     RESTRICTIONS = THE BRANCH ENTRY POINT IS LIMITED IN USE TO     02450002
*        ABEND AND END OF TASK.                                         02500002
*                                                                       02550002
*02*     REGISTER-CONVENTIONS = REGISTER DEFINITIONS FOLLOW THESE       02590002
*        SPECIFICATIONS. FURTHER INFORMATION ON THE USAGE OF REGISTERS  02670002
*        IS CONTAINED IN THE INTRODUCTORY COMMENTS PRECEEDING           02710002
*        EACH SUBROUTINE, RECOVERY ROUTINE, AND THE BRANCH              02790002
*        ENTRY ROUTINE.                                                 02830002
*                                                                       02910002
*02*     PATCH-LABEL = NONE                                             02950002
*                                                                       03050002
*01*  MODULE-TYPE = SVC ROUTINE                                         03100002
*                                                                       03150002
*02*     PROCESSOR = ASSEMBLER                                          03200002
*                                                                       03250002
*02*     MODULE-SIZE = SEE SYMBOL IGC062 IN THE EXTERNAL SYMBOL         03350002
*        DICTIONARY.                                                    03400002
*                                                                       03450002
*02*     ATTRIBUTES = PAGED-LPA, ZERO PROTECT KEY, REFRESHABLE,         03510002
*        SUPERVISOR MODE.                                               03570002
*                                                                       03650002
*01*  ENTRY-POINT = IGC062                                              03700002
*                                                                       03760002
*02*     PURPOSE = SVC DETACH                                           03820002
*                                                                       03880002
*02*     LINKAGE = SVC 62 (DETACH MACRO)                                03950002
*                                                                       04000002
*02*     INPUT = REGISTER 1 CONTAINS THE ADDRESS OF A FULLWORD, WHICH   04050002
*        IN TURN CONTAINS THE ADDRESS OF THE SUBTASK TCB TO BE          04100002
*        DETACHED. BIT 0 OF REGISTER 1 = 0 INDICATES STAE=NO, BIT 0 OF  04150002
*        REGISTER 1 = 1 INDICATES STAE=YES.                             04210002
*                                                                       04270002
*02*     OUTPUT = SEE BELOW.                                            04350002
*                                                                       04400002
*01*  EXIT-NORMAL =                                                     04500002
*                                                                       04550002
*02*     CONDITIONS = RETURN VIA EXIT PROLOGUE, IEAVEXPR.               04600002
*                                                                       04650002
*02*     OUTPUT = RETURN CODE. IF THE SUBTASK IS INCOMPLETE, IT IS      04700002
*        ABTERMED, USING CODE 13E FOR STAE=NO, 33E FOR STAE=YES. THIS   04800002
*        IS OUTPUT TO RTM (RECOVERY TERMINATION MANAGER), USED TO       04850002
*        DETERMINE WHETHER OR NOT A STAE EXIT IS TO BE SCHEDULED.       04900002
*                                                                       04950002
*02*     RETURN-CODES = 4 - AN INCOMPLETE SUBTASK WAS ABTERMED WITH     05000002
*        CODE 33E. 0 - ALL OTHER CONDITIONS.                            05050002
*                                                                       05100002
*01*  EXIT-ERROR = DET00100                                             05150002
*                                                                       05200002
*02*     CONDITIONS = AN INVALID PARAMETER OR INVALID PARAMETER WORD    05300002
*        ADDRESS WAS PASSED TO DETACH.                                  05360002
*                                                                       05420002
*02*     OUTPUT = ABEND CODE 23E.                                       05500002
*                                                                       05550002
*02*     RETURN-CODES = NONE                                            05600002
*                                                                       05700002
*01*  ENTRY-POINT = IGC062R1                                            05750002
*                                                                       05800002
*02*     PURPOSE = CALLED AS A DETACH BRANCH ENTRY BY ABEND, AND AS A   05850002
*        TTRM BY END OF TASK.                                           05900002
*                                                                       06000002
*02*     LINKAGE = BRANCH ENTERED, ADDRESS OBTAINED FROM CVT062R1.      06050002
*                                                                       06100002
*02*     INPUT = SEE INTRODUCTORY COMMENTS PRECEEDING IGC062R1.         06150002
*                                                                       06200002
*02*     OUTPUT = NONE                                                  06250002
*                                                                       06310002
*01*  EXIT-NORMAL = DET04010                                            06370002
*                                                                       06450002
*02*     CONDITIONS = RETURN VIA BR 14.                                 06500002
*                                                                       06600002
*02*     OUTPUT = NONE                                                  06650002
*                                                                       06710002
*02*     RETURN-CODES = NONE                                            06770002
*                                                                       06830002
*01*  EXIT-ERROR = NONE                                                 06900002
*                                                                       06950002
*01*  ENTRY-POINT = IGC062R2                                            07000002
*                                                                       07050002
*02*     PURPOSE = FUNCTIONAL RECOVERY ROUTINE (FRR) IN EFFECT WHILE    07100002
*        LOCAL LOCK IS HELD.                                            07200002
*                                                                       07260002
*02*     LINKAGE = FROM RTM, ADDRESS FROM STACK ELEMENT CREATED BY      07262002
*        SETFRR (SEE SUBROUTINE FRRON).                                 07357002
*                                                                       07403602
*02*     INPUT = REGISTER 0 - ADDRESS OF A 200 BYTE WORKAREA.           07457002
*        REGISTER 1 - ADDRESS OF AN SDWA. REGISTER 14 -                 07560002
*        RETURN ADDRESS.                                                07563002
*                                                                       07633002
*02*     OUTPUT = SEE BELOW.                                            07703002
*                                                                       07773002
*01*  EXIT-NORMAL = DET80000                                            07850002
*                                                                       07900002
*02*     CONDITIONS = FRR WAS ENTERED FROM SVC DETACH, AS A RESULT OF A 07950002
*        FAILURE, OR AS A RESULT OF VALIDITY CHECKING.                  08010002
*                                                                       08070002
*02*     OUTPUT = RETURN CODE. SDWACMPC MAY BE MODIFIED TO 23E (INVALID 08150002
*        INPUT PARAMETER) OR 43E (INVALID END OF TASK ECB ADDRESS).     08200002
*        SDWASRSV IS UPDATED. SDWARCDE, SDWARCRD, SDWAUPRG, SDWARTYA,   08250002
*        AND SDWARECP ARE SET BY SETRP MACRO.                           08300002
*                                                                       08400002
*02*     RETURN-CODES = 0, NO RETRY.                                    08450002
*                                                                       08500002
*01*  EXIT-NORMAL = DET80030                                            08550002
*                                                                       08600002
*02*     CONDITIONS = FRR WAS ENTERED FROM IGC062R1 (BRANCH ENTRY)      08670002
*        PROCESSING.                                                    08750002
*                                                                       08800002
*02*     OUTPUT = RETURN CODE. SDWARCDE, SDWARCRD, AND SDWARECP ARE SET 08850002
*        BY SETRP MACRO. THE DETACH TCB IS DEQUEUED FROM THE            08900002
*        DISPATCHING AND FAMILY QUEUES.                                 09000002
*                                                                       09050002
*02*     RETURN-CODES = 4, RETRY.                                       09100002
*                                                                       09150002
*01*  EXIT-ERROR = NONE                                                 09200002
*                                                                       09300002
*01*  ENTRY-POINT = IGC062R3                                            09360002
*                                                                       09420002
*02*     PURPOSE = RECOVERY RETRY ROUTINE (SEE INTRODUCTORY COMMENTS    09450002
*        PRECEEDING IGC062R3).                                          09500002
*                                                                       09600002
*02*     LINKAGE = FROM RTM, USING ADDRESS IN SDWARTYA.                 09650002
*                                                                       09700002
*02*     INPUT = SEE INTRODUCTORY COMMENTS PRECEEDING IGC062R3.         09750002
*                                                                       09800002
*02*     OUTPUT = SEE INTRODUCTORY COMMENTS PRECEEDING IGC062R3.        09900002
*                                                                       09950002
*01*  EXIT-NORMAL = DET70010                                            10000002
*                                                                       10050002
*02*     CONDITIONS = RETURN TO BRANCH CALLER OF DETACH.                10100002
*                                                                       10200002
*02*     OUTPUT = SEE INTRODUCTORY COMMENTS PRECEEDING IGC062R3.        10250002
*                                                                       10300002
*02*     RETURN-CODES = NONE.                                           10350002
*                                                                       10400002
*01*  EXIT-ERROR = NONE                                                 10500002
*                                                                       10550002
*01*  EXTERNAL-REFERENCES =                                             10600002
*                                                                       10650002
*02*     ROUTINES = STATUS, TO STOP THE SUBTASK TO BE DETACHED, BRANCH  10700002
*        ADDRESS OBTAINED FROM SCVTSTAT. WAIT SVC, TO WAIT FOR          10800002
*        COMPLETION OF ABTERMED SUBTASK. POST TO POST END OF TASK ECB,  10850002
*        BRANCH ADDRESS FROM CVT0PT02. ABTERM TO ABTERM AN INCOMPLETE   10900002
*        SUBTASK, OR TO ABTERM MOTHER TASK IN CASE OF ERROR IN END OF   10950002
*        TASK PROCESSING, BRANCH LINKAGE GENERATED BY CALLRTM MACRO.    11000002
*        FREEMAIN TO FREE TCB, TCB PROBLEM PROGRAM SAVE AREA, IRB, IRB  11100002
*        PROBLEM PROGRAM SAVE AREA, IQE, BRANCH LINKAGE GENERATED BY    11150002
*        FREEMAIN MACRO. IGC044R2 TO VALIDATE THE TCB QUEUES IN ERROR   11200002
*        PROCESSING, BRANCH ADDRESS FROM V-TYPE ADDRESS CONSTANT. STAGE 11250002
*        II EXIT EFFECTOR TO SCHEDULE END OF TASK EXIT ROUTINE (ETXR),  11300002
*        BRANCH ADDRESS FROM CVT0EF00.                                  11400002
*                                                                       11450002
*02*     DATA-AREAS = SDWA                                              11500002
*                                                                       11550002
*02*     CONTROL-BLOCKS = TCB(D), RB(R), CVT(R), SCVT(R), PSA(R),       11600002
*        IQE(D), IRB(D)                                                 11700002
*                                                                       11750002
*01*  TABLES = NONE.                                                    11800002
*                                                                       11850002
*01*  MACROS = WAIT, ABEND, CALLRTM, FREEMAIN, SETFRR, SETRP, MODESET.  11900002
*                                                                       12000002
*02*    SERIALIZATION = LOCAL LOCK.                                     12050002
*                                                                       12100002
*01*  CHANGE-ACTIVITY = Y02752, Y02753                                  12150002
*                                                                       12200002
*01*  MESSAGES = NONE.                                                  12300002
*                                                                       12350002
*01*  ABEND-CODES = 13E, 23E, 33E, 43E, 53E. 13E - CODE FOR ABTERMING   12400002
*     INCOMPLETE SUBTASK, STAE=NO. 23E - INVALID PARAMETER OR PARAMETER 12450002
*     WORD ADDRESS. 33E - CODE FOR ABTERMING INCOMPLETE SUBTASK,        12500002
*     STAE=YES. 43E - INVALID IND OF TASK ECB ADDRESS (CONTENTS OF      12600002
*     FIELD TCBECB IN COMPLETING TCB). 53E - ERROR OCCURRED IN TASK     12650002
*     TERMINATION PROCESSING OF A SUBTASK BEFORE ECB AND ETXR COULD BE  12700002
*     PROCESSED.                                                        12750002
*                                                                       12800002
**** END OF SPECIFICATIONS ***/                                         12900002
         EJECT                                                          12950002
* DETACH REGISTERS                                                      13000002
         SPACE                                                          13050002
R0       EQU   0                       WORK REGISTER                    13100002
R1INPARM EQU   1                       INPUT ADDRESS                    13200002
R1       EQU   1                       WORK REGISTER                    13250002
R2       EQU   2                       WORK REGISTER                    13300002
R2DETTCB EQU   2                       ADDRESS OF THE DETACH TCB        13350002
R3       EQU   3                       WORK REGISTER                    13400002
R4OTCB   EQU   4                       ADDRESS OF MOTHER TCB            13500002
R4       EQU   4                       WORK REGISTER                    13550002
R5RB     EQU   5                       ADDRESS OF CURRENT RB, SVC ENTRY 13600002
R5FRR    EQU   5                       ADDRESS OF FRR WORKAREA          13650002
R6BASE   EQU   6                       BASE REGISTER                    13700002
R7       EQU   7                       WORK REGISTER                    13800002
R8       EQU   8                       WORK REGISTER                    13850002
R9       EQU   9                       MAINTENANCE REGISTER             13900002
R10      EQU   10                      WORK REGISTER                    13950002
R11      EQU   11                      WORK REGISTER                    14000002
R12      EQU   12                      WORK REGISTER                    14100002
R13WKPTR EQU   13                      ADDRESS OF WORKAREA              14150002
R13      EQU   13                      WORK REGISTER                    14200002
R14      EQU   14                      BRANCH REGISTER                  14250002
R15      EQU   15                      WORK REGISTER                    14300002
         SPACE 2                                                        14400002
* MODULE EQUATES                                                        14450002
         SPACE                                                          14500002
USECNT1  EQU   1                       IRB USE COUNT 1                  14550002
C0       EQU   0                       CONSTANT 0                       14600002
C1       EQU   1                       CONSTANT 1                       14700002
C2       EQU   2                       CONSTANT 2                       14750002
C3       EQU   3                       CONSTANT 3                       14800002
C4       EQU   4                       CONSTANT 4                       14850002
C7       EQU   7                       CONSTANT 7                       14900002
C8       EQU   8                       CONSTANT 8                       15000002
C255     EQU   255                     CONSTANT 255                     15050002
CXF0     EQU   X'F0'                   CONSTANT X'F0'                   15100002
KEYMASK  EQU   B'11110000'             MASK TO CLEAR PROTECT KEY        15150002
WORDMASK EQU   B'00000011'             MASK TO CHECK FULLWORD ALIGNMENT 15200002
FF       EQU   X'FF'                   BYTE OF ONES                     15300002
SVAREAL  EQU   72                      LENGTH OF PROBLEM PGM SAVE AREA  15350002
SP250    EQU   250                     SUBPOOL ID                       15400002
SP253    EQU   253                     SUBPOOL ID                       15450002
ABEND13E EQU   X'13E'                  ABEND CODE FOR SUBTASK ABTERM,   15500002
*                                        WITH STAE=NO                   15600002
ABEND23E EQU   X'23E'                  ABEND CODE FOR MOTHER, INVALID   15650002
*                                        PARAMETER                      15700002
ABEND33E EQU   X'33E'                  ABEND CODE FOR SUBTASK ABTERM,   15750002
*                                        WITH STAE=YES                  15800002
ABEND43E EQU   X'43E'                  ABEND CODE FOR MOTHER, INVALID   15900002
*                                        ATTACH ECB                     15950002
ABEND53E EQU   X'53E'                  CODE FOR MOTHER, SUBTASK         16000002
*                                      ENCOUNTERED ERROR IN END OF      16050002
*                                      TASK BEFORE ECB/ETXR PROCESSING  16100002
PTCBCODE EQU   X'0B'                   STATUS STOP TCB ENTRY CODE       16200002
               SPACE 3                                                  16250002
* MODULE USING STATEMENTS                                               16300002
         SPACE 2                                                        16350002
         USING WKAREA,R13WKPTR         PRIVATE WORK/SAVE AREA           16400002
         USING DETFRRWA,R5FRR          FRR SIX WORD WORKAREA            16500002
         USING PSA,R0                  ADDRESSABILITY FOR PREFIX SAVE   16550002
*                                        AREA                           16600002
         SPACE 3                                                        16650002
         ENTRY IGC062R1                                                 16700002
         SPACE 3                                                        16800002
*/* IGC062: CHART                                                    */ 16850002
*/* FOOTING                                                             16870002
*/* DETACH MAINLINE - SVC ENTRY                                      */ 16950002
         EJECT                                                          17000002
*/* IGC062: E ENTER SVC DETACH                                       */ 17100002
         SPACE 2                                                        17150002
         USING IGC062,R6BASE                                            17200002
         MODID BR=YES                  IDENTIFIER                       17250002
         SPACE                                                          17300002
*/* P SET UP WORKAREA IN RBEXSAVE                                    */ 17400002
         SPACE                                                          17450002
         LA    R13WKPTR,RBEXSAVE-RBBASIC(,R5RB)  ADDRESS WORKAREA       17500002
         XC    0(WKLENTH,R13WKPTR),0(R13WKPTR) CLEAR WORKAREA           17550002
         ST    R14,WKR14RET            SAVE RETURN ADDRESS              17600002
         SPACE                                                          17700002
*/* S FRRON: ESTABLISH FRR                                           */ 17750002
         SPACE                                                          17800002
         LR    R8,R5RB                 SAVE CURRENT RB ADDRESS          17850002
         BAL   R14,FRRON               ESTABLISH FRR                    17900002
         SPACE                                                          18000002
*/* D (NO,DET00100,YES,) INPUT PARAMETER FULLWORD                    */ 18050002
         SPACE                                                          18100002
         LA    R7,WORDMASK             CHECK ALIGNMENT                  18150002
         NR    R7,R1                   IS PARM ADDR ON FULLWORD BDY     18200002
         BNZ   DET00100                NO, GO ABEND CURRENT TASK, 23E   18300002
*                                      YES, CHECK STORAGE KEY           18350002
         SPACE                                                          18400002
*/* P VALIDITY CHECK INPUT PARM STORAGE ADDRESS                      */ 18450002
         SPACE                                                          18500002
         L     R7,RBLINK-RBBASIC(,R8)  ADDRESS OF CALLER'S RB           18600002
         IC    R2,RBOPSW+C1-RBBASIC(,R7) PSW KEY-CMWP FIELDS            18650002
         LA    R7,KEYMASK              TO CLEAR CMWP BITS, HIGH BYTES   18700002
         NR    R2,R7                   CALLER'S PROTECT KEY             18750002
         MODESET KEYADDR=(2)           SET CALLER'S PROTECT KEY         18800002
         L     R7,0(,R1)               INPUT PARM FETCH CHECK           18900002
         ST    R7,0(,R1)               INPUT PARM STORE CHECK           18950002
         MODESET EXTKEY=SUPR           RESET KEY 0                      19000002
         SPACE                                                          19050002
*/* D (NO,DET00100,YES,) IS INPUT ADDRESS OF A SUBTASK               */ 19100002
         SPACE                                                          19200002
         LA    R7,0(,R7)               INSURE BYTE0 = 0                 19250002
         ICM   R8,B'1111',TCBLTC-TCB(R4OTCB)  ADDR OF NEWEST SUBTASK    19300002
         B     DET00210                ENTER LOOP                       19350002
         SPACE                                                          19400002
DET00200 EQU   *                       TOP OF LOOP                      19500002
         ICM   R8,B'1111',TCBNTC-TCB(R8) ADDR OF NEXT SUBTASK           19550002
DET00210 EQU   *                       LOOP ENTRY POINT                 19600002
         BZ    DET00100                SUBTASK PTR 0, GO ABEND          19650002
*                                        CURRENT TASK, 23E              19700002
         CR    R7,R8                   IS THIS THE INPUT SUBTASK        19800002
         BNE   DET00200                NO, CONTINUE LOOP                19850002
*                                      YES, CONTINUE DETACH             19900002
         SPACE                                                          19950002
*/* D (NO,DET00220,YES,) WAS STAE=YES SPECIFIED                      */ 20000002
         SPACE                                                          20100002
         LTR   R1,R1                   BIT0=1 FOR STAE=YES              20150002
         BNM   DET00220                BYPASS FLAG SETTING, BIT0 IS OFF 20200002
         SPACE                                                          20250002
*/* P SET INDICATOR FOR STAE=YES                                     */ 20300002
         SPACE                                                          20400002
         OI    WKFLAGS,WKSTAE          SET STAE INDICATOR               20450002
         SPACE                                                          20500002
*/* DET00220: D (NO,DET00240,YES,) IS DETACH TCB IN ABEND            */ 20550002
         SPACE                                                          20600002
DET00220 EQU   *                       *                                20650002
         TM    TCBFLGS1-TCB(R7),TCBFA  IS ABEND IN PROCESS              20700002
         BNO   DET00240                NO, BYPASS SETTING OF FLAG       20800002
         SPACE                                                          20850002
*/* P SET INDICATOR FOR NO ABTERM                                    */ 20900002
         SPACE                                                          21000002
         OI    WKFLAGS,WKTCBFA         SUBTASK NOT TO BE ABTERMED       21050002
         SPACE                                                          21100002
*/* DET00240: D (NO,DET00230,YES,) WOULD AN ABEND CAUSE RECURSION    */ 21150002
         SPACE                                                          21200002
DET00240 EQU   *                       *                                21250002
         TM    TCBFBYT1-TCB(R7),TCBRTM2 HAS RTM2 ALREADY BEEN ENTERED   21300002
         BNO   DET00230                NO, BYPASS SETTING OF FLAG       21400002
         SPACE                                                          21450002
*/* P SET INDICATOR FOR CONDITIONAL FREEMAINS                        */ 21500002
         SPACE                                                          21600002
         OI    WKFLAGS,WKCONDL         PERFORM CONDITIONAL FREEMAINS    21650002
         SPACE                                                          21700002
*/* DET00230: S SUBRTN: PERFORM DETACH, WITH ABTERM IF REQUIRED      */ 21750002
         SPACE                                                          21800002
DET00230 EQU   *                       *                                21900002
         LR    R2DETTCB,R7             ADDRESS OF TCB TO BE DETACHED    21950002
         ST    R2DETTCB,WKR1TCB        JOURNAL DETACH TCB ADDRESS       22000002
         BAL   R14,SUBRTN              PERFORM DETACH                   22050002
         SPACE                                                          22100002
*/* S FRROFF: CANCEL FRR                                             */ 22200002
         SPACE                                                          22250002
         BAL   R14,FRROFF              CANCEL FRR                       22300002
         SPACE                                                          22350002
*/* R RETURN TO SVC CALLER                                           */ 22400002
         SPACE                                                          22500002
         L     R14,WKR14RET            RESTORE RETURN ADDRESS           22550002
         BR    R14                     RETURN, VIA EXIT PROLOG          22600002
         SPACE 3                                                        22650002
*/* DET00100: S FRROFF: CANCEL FRR                                   */ 22700002
         SPACE                                                          22800002
DET00100 EQU   *                       *                                22850002
         BAL   R14,FRROFF              CANCEL FRR                       22900002
         SPACE                                                          22950002
*/* L () ABEND: TERMINATE CURRENT TASK, 23E                          */ 23000002
         SPACE                                                          23100002
         LA    R1,ABEND23E             ERROR CODE FOR CURRENT TASK      23150002
         SPACE                                                          23200002
         ABEND (1),DUMP,,SYSTEM                                         23250002
         SPACE 2                                                        23300002
*/* IGC062: END FLOWCHART                                            */ 23400002
         EJECT                                                          23450002
*/* SUBRTN: CHART BEGIN FLOWCHART                                    */ 23500002
*/* FOOTING                                                             23550002
*/* SUBROUTINE WHICH PERFORMS NORMAL DETACH FUNCTIONS                */ 23600002
         SPACE 2                                                        23650002
*********************************************************************** 23750002
*                                                                     * 23800002
* SUBROUTINE SUBRTN PERFORMS NORMAL DETACH PROCESSING: UNCHAINING OF  * 23850002
* THE TCB FROM ITS FAMILY QUEUE, AND FREEING THE TCB STORAGE AND THE  * 23900002
* STORAGE OCCUPIED BY THE ASSOCIATED PROBLEM PROGRAM SAVE AREA, IF    * 24000002
* THERE IS ONE. THE DETACH TASK IS FIRST ABTERMED, IF IT HAS NOT COM- * 24050002
* PLETED, AND IF IT IS NOT ALREADY ABENDING. THIS ROUTINE IS CALLED   * 24100002
* BY THE SVC ENTRY, AND BY THE BRANCH ENTRY FROM ABEND.               * 24150002
*                                                                     * 24200002
* SUBROUTINES CALLED: FRRON, FRROFF, FREE, FREETCB, POSTRTN, ABTERMR  * 24300002
*                                                                     * 24350002
* SYSTEM ROUTINES CALLED / MACROS ISSUED: STATUS, WAIT, SETLOCK       * 24400002
*                                                                     * 24450002
* REGISTER USAGE: R2DETTCB - ADDRESS OF TCB TO BE DETACHED            * 24500002
*                 R13WKPTR - ADDRESS OF WORKAREA                      * 24600002
*                 R14      - RETURN ADDRESS                           * 24650002
*                 R5FRR    - FRR WORKAREA ADDRESS SAVE REGISTER       * 24700002
*                                                                     * 24750002
* RETURN CODES SET: 0, 4                                              * 24800002
*                                                                     * 24900002
*********************************************************************** 24950002
         SPACE 2                                                        25000002
*/* E ENTER SUBRTN                                                   */ 25050002
         SPACE                                                          25100002
SUBRTN   DS    0H                      ENTRY POINT                      25200002
         ST    R14,WKSUBRET            SAVE RETURN ADDRESS              25250002
         SPACE                                                          25300002
*/* D (NO,DET01100,YES,) IS DETACH TCBFC = 1                         */ 25350002
         SPACE                                                          25400002
         TM    TCBFLGS5-TCB(R2DETTCB),TCBFC  HAS SUBTASK BEEN THROUGH   25500002
*                                             EXIT                      25550002
         BZ    DET01100                      NO, FORCE COMPLETION IF    25600002
*                                             NECESSARY                 25650002
         SPACE                                                          25700002
*                                            YES - UNCHAIN TCB AND FREE 25800002
         SPACE                                                          25850002
*/* S (,DET01110) FREETCB: FREE TCB RESOURCES                        */ 25900002
         SPACE                                                          25924002
         BAL   R14,FREETCB             FREE TCB RESOURCES               26000002
         B     DET01110                GO TO EXIT SUBROUTINE            26100002
         EJECT                                                          26150002
*********************************************************************** 26200002
*                                                                     * 26250002
*           PROCESS SUBTASK WHICH HAS NOT YET COMPLETED               * 26300002
*                                                                     * 26400002
*********************************************************************** 26450002
         SPACE 2                                                        26500002
*/* DET01100: D (NO,DET01120,YES,) IS DETACH TCBACTIV = 1            */ 26550002
         SPACE                                                          26600002
DET01100 EQU   *                       *                                26650002
         TM    TCBFBYT1-TCB(R2DETTCB),TCBACTIV  IS SUBTASK ACTIVE       26700002
         BZ    DET01120                NO, BYPASS STATUS STOP           26800002
         SPACE                                                          26850002
*/* L STATUS: STOP DETACH TCB                                        */ 26900002
         SPACE                                                          27000002
         LR    R1,R2DETTCB             ADDR OF TCB TO STOP     @YM02796 27050002
         LR    R7,R13WKPTR             SAVE                             27100002
         L     R15,CVTPTR              ADDRESS OF CVT                   27150002
         L     R15,CVTABEND-CVTMAP(,R15)  ADDR OF SECONDARY CVT         27200002
         L     R15,SCVTSTAT-SCVTSECT(,R15) ADDR OF STATUS BRANCH ENTRY  27300002
         LA    R0,PTCBCODE             STATUS ENTRY CODE, STOP TCB      27350002
         SR    R13,R13                 MASK, NO NONDISP BITS TO BE SET  27400002
         BALR  R14,R15                 INVOKE STATUS (STOPS TASK VIA    27450002
*                                        SIGP, STAYS STOPPED WHILE      27500002
*                                        DETACH HOLDS LOCAL LOCK)       27600002
         LR    R13WKPTR,R7             RESTORE                          27650002
         SPACE                                                          27700002
*/* DET01120: D (NO,DET01130,YES,) IS THERE AN ETXR                  */ 27750002
         SPACE                                                          27800002
DET01120 EQU   *                       *                                27850002
         ICM   R8,B'1111',TCBIQE-TCB(R2DETTCB)  ADDRESS OF IQE          27900002
         BZ    DET01130                IF ADDRESS 0, BYPASS PROCESSING  28000002
         SPACE                                                          28050002
*/* D (NO,DET01140,YES,) IS IRB USE COUNT = 1                        */ 28100002
         SPACE                                                          28200002
         L     R11,IQEIRB-IQESECT(,R8) ADDRESS OF IRB                   28250002
         CLI   RBUSE-RBSECT(R11),USECNT1  IS USE COUNT 1                28300002
         BNE   DET01140                NO, GO DECREMENT USE COUNT       28350002
         SPACE                                                          28400002
*/* S FREE: FREE IRB PROB PGM SAVE AREA, SUBPOOL 250                 */ 28450002
         SPACE                                                          28550002
         L     R1,RBPPSAV-RBSECT(,R11) ADDRESS OF IRB USER SAVE AREA    28600002
         LA    R0,SVAREAL              LENGTH OF SAVE AREA              28650002
         LA    R3,SP250                SUBPOOL NUMBER                   28700002
         BAL   R14,FREE                FREE SAVE AREA                   28800002
         SPACE                                                          28850002
*/* S (,DET01150) FREE: FREE IRB,SUBPOOL 253                         */ 28900002
         SPACE                                                          28950002
         LA    R0,RBSECT-RBPRFXST(R0)  OFFSET FROM IRB ADDR TO PREFIX   29000002
         LR    R1,R11                  ADDRESS OF IRB                   29100002
         SR    R1,R0                   ADDRESS OF IRB PREFIX            29150002
         LA    R0,IRBLEN               LENGTH OF IRB                    29200002
         LA    R3,SP253                SUBPOOL NUMBER                   29250002
         BAL   R14,FREE                FREE IRB                         29300002
         B     DET01150                CONTINUE ETXR PROCESSING         29400002
         SPACE                                                          29450002
*/* DET01140: P DECREMENT IRB USE COUNT BY 1                         */ 29500002
         SPACE                                                          29550002
DET01140 EQU   *                       *                                29600002
         IC    R0,RBUSE-RBSECT(,R11)   IRB USE COUNT IN LOW ORDER BYTE  29700002
         BCTR  R0,R0                     LESS 1                         29750002
         STC   R0,RBUSE-RBSECT(,R11)   SAVE USE COUNT                   29800002
         SPACE                                                          29850002
*/* DET01150: S FREE: FREE IQE, SUBPOOL 253                          */ 29900002
         SPACE                                                          30000002
DET01150 EQU   *                       *                                30050002
         LR    R1,R8                   ADDRESS OF IQE                   30100002
         LA    R0,IQELEN               LENGTH OF IQE                    30150002
         LA    R3,SP253                SUBPOOL NUMBER                   30200002
         BAL   R14,FREE                FREE IQE                         30300002
         SPACE                                                          30350002
*/* P SET DETACH TCBIQE = 0, TCBFETXR = 0                            */ 30420002
         SPACE                                                          30425002
         XC    TCBIQE-TCB(C4,R2DETTCB),TCBIQE-TCB(R2DETTCB)  ZERO       30485002
         NI    TCBFLGS2-TCB(R2DETTCB),FF-TCBFETXR  ETXR FLAG OFF        30600002
         SPACE                                                          30650002
*/* DET01130: D (NO,DET01160,YES,) SHOULD SUBTASK BE ABTERMED        */ 30700002
         SPACE                                                          30750002
DET01130 EQU   *                       *                                30800002
         TM    WKFLAGS,WKTCBFA         WAS SUBTASK IN ABEND WHEN SVC    30900002
*                                        WAS ISSUED                     30950002
         BO    DET01160                YES, BYPASS ABTERM               31000002
         SPACE                                                          31050002
*/* P INDICATE ABEND CODE 13E FOR SUBTASK                            */ 31100002
         SPACE                                                          31200002
         LA    R1,ABEND13E             CODE FOR SUBTASK, STAE=NO        31250002
         SPACE                                                          31270002
*/* D (NO,DET01170,YES,) WAS STAE=YES SPECIFIED                      */ 31350002
         SPACE                                                          31400002
         TM    WKFLAGS,WKSTAE          IS COMP CODE 13E CORRECT         31500002
         BZ    DET01170                YES, STAE=NO                     31550002
*                                      NO, STAE=YES                     31600002
         SPACE                                                          31650002
*/* P INDICATE ABEND CODE 33E FOR SUBTASK                            */ 31700002
         SPACE                                                          31800002
         LA    R1,ABEND33E             CODE FOR SUBTASK, STAE=YES       31850002
         SPACE                                                          31900002
*/* DET01170: L RTM: ABTERM SUBTASK                                  */ 31950002
         SPACE                                                          32000002
DET01170 EQU   *                       *                                32050002
         LR    R12,R2DETTCB            SAVE                             32100002
         BAL   R14,ABTERMR             CALL ABTERMING SUBROUTINE        32170002
         LR    R2DETTCB,R12            RESTORE                          32250002
         SPACE                                                          32300002
*/* DET01160: P SAVE DETACH TCBECB, RESET TO WORKAREA ECB ADDRESS    */ 32400002
         SPACE                                                          32450002
DET01160 EQU   *                       *                                32500002
         L     R10,TCBECB-TCB(,R2DETTCB) GET ECB ADDRESS                32550002
         LA    R8,WKECB                ADDRESS OF WORKAREA ECB          32600002
         ST    R8,TCBECB-TCB(,R2DETTCB)  INTO DETACH TCB                32700002
         TM    TCBFBYT2-TCB(R2DETTCB),TCBECBNV IS NO CHECK FLAG NOW SET 32750002
         BZ    DET02030                NO, SAVE THIS STATUS             32800002
         OI    WKFLAGS,WKECBNV         YES, SAVE THIS STATUS            32850002
DET02030 EQU   *                       *                                32900002
         OI    TCBFBYT2-TCB(R2DETTCB),TCBECBNV WORKAREA ECB NOT CHECKED 33000002
         SPACE                                                          33050002
*/* S FRROFF: CANCEL FRR                                             */ 33100002
         SPACE                                                          33150002
         BAL   R14,FRROFF              CANCEL FRR                       33200002
         SPACE                                                          33250002
*/* L SETLOCK: RELEASE LOCAL LOCK                                    */ 33350002
         SPACE                                                          33400002
         LR    R7,R13WKPTR             SAVE                             33450002
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=('ENTERED WITH LOCK HELD')  33500002
         SPACE                                                          33600002
*/* L WAIT SVC: ALLOW SUBTASK TO COMPLETE                            */ 33650002
         SPACE                                                          33700002
         LR    R1,R8                   ECB ADDRESS                      33750002
         WAIT  ECB=(1)                 ISSUE SVC                        33800002
         SPACE                                                          33900002
*/* L SETLOCK: GET LOCAL LOCK                                        */ 33950002
         SPACE                                                          34000002
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        *34050002
               RELATED=('RELEASED BY EXIT')                             34100002
         LR    R13WKPTR,R7             RESTORE                          34200002
         SPACE                                                          34250002
*/* S FRRON: ESTABLISH FRR                                           */ 34300002
         SPACE                                                          34350002
         BAL   R14,FRRON               ADD DETACH FRR TO STACK          34400002
         SPACE                                                          34500002
*/* D (NO,DET01180,YES,) WAS THERE AN ATTACH ECB                     */ 34550002
         SPACE                                                          34600002
         LTR   R11,R10                 IS SAVED ECB PTR = 0             34650002
         BZ    DET01180                YES, BYPASS POST                 34700002
         SPACE                                                          34800002
*/* S POSTRTN: POST ATTACH ECB WITH TCB COMPLETION CODE              */ 34850002
         SPACE                                                          34900002
         TM    WKFLAGS,WKECBNV         WAS NO CHECK FLAG ON PREVIOUSLY  34950002
         BO    DET02040                YES, LEAVE ON                    35000002
         NI    TCBFBYT2-TCB(R2DETTCB),FF-TCBECBNV NO, RESET TO CHECK    35100002
DET02040 EQU   *                       *                                35150002
         BAL   R14,POSTRTN             INVOKE POST                      35200002
         SPACE                                                          35250002
*/* DET01180: S FREETCB: FREE TCB RESOURCES                          */ 35300002
         SPACE                                                          35400002
DET01180 EQU   *                       *                                35450002
         BAL   R14,FREETCB             UNCHAIN AND FREE TCB, SAVEAREA   35500002
         SPACE                                                          35550002
*/* P SET RETURN CODE TO 4                                           */ 35600002
         SPACE                                                          35700002
         LA    R15,C4                  RETURN CODE USED WHEN SUBTASK    35750002
*                                        ABTERMED WITH 33E              35800002
         SPACE                                                          35850002
*/* D (YES,DET01190,NO,) WAS STAE=YES SPECIFIED                      */ 35900002
         SPACE                                                          36000002
         TM    WKFLAGS,WKSTAE          WAS STAE=YES SPECIFIED           36050002
         BO    DET01190                YES, LEAVE RETURN CODE AS IS     36100002
         SPACE                                                          36150002
*/* DET01110: P SET RETURN CODE 0                                    */ 36200002
         SPACE                                                          36250002
DET01110 EQU   *                       *                                36350002
         SR    R15,R15                 RETURN CODE 0                    36400002
         SPACE                                                          36450002
*/* DET01190: R RETURN TO CALLING POINT                              */ 36500002
         SPACE                                                          36550002
DET01190 EQU   *                       *                                36600002
         L     R14,WKSUBRET            RESTORE RETURN ADDRESS           36650002
         BR    R14                     RETURN                           36700002
         SPACE 2                                                        36750002
*/* SUBRTN: END FLOWCHART                                            */ 36800002
         EJECT                                                          36850002
*/* POSTRTN: CHART                                                   */ 37000002
*/* FOOTING                                                             37050002
*/* POSTS ATTACH ECB                                                 */ 37100002
         SPACE 2                                                        37200002
*********************************************************************** 37250002
*                                                                     * 37300002
* SUBROUTINE POSTRTN VALIDITY CHECKS AND POSTS THE ATTACH ECB,        * 37350002
* ADDRESSED BY TCBECB OF THE DETACH TCB. IF VALIDITY CHECK FAILS, THE * 37400002
* FRR IS ENTERED TO SET CODE 43E. THIS SUBROUTINE IS CALLED BY SUBROU-* 37500002
* TINE SUBRTN AND BY THE END OF TASK BRANCH ENTRY.                    * 37550002
*                                                                     * 37600002
* SUBROUTINES CALLED: NONE                                            * 37650002
*                                                                     * 37700002
* SYSTEM ROUTINES CALLED / MACROS ISSUED: POST IS INVOKED AT BRANCH   * 37800002
*                                         ENTRY IEA0PT02              * 37850002
*                                                                     * 37900002
* RETURN CODES SET: NONE                                              * 37950002
*                                                                     * 38000002
* REGISTER USAGE: R0       - DESTROYED                                * 38100002
*                 R2DETTCB - DETACH TCB ADDRESS                       * 38150002
*                 R4OTCB   - ADDRESS OF MOTHER TCB OF DETACH TCB      * 38200002
*                 R10      - DESTROYED                                * 38250002
*                 R11      - INPUT, ECB ADDRESS                       * 38300002
*                 R12      - DESTROYED                                * 38400002
*                 R14      - RETURN ADDRESS                           * 38450002
*                                                                     * 38500002
*********************************************************************** 38550002
         SPACE 3                                                        38600002
*/* E ENTER POSTRTN                                                  */ 38700002
         SPACE                                                          38750002
*/* D (NO,DET04110,YES,) IS ECB TO BE VALIDITY CHECKED               */ 38800002
         SPACE                                                          38850002
POSTRTN  EQU   *                       ENTRY POINT                      38900002
         TM    TCBFBYT2-TCB(R2DETTCB),TCBECBNV IS SYSTEM ECB INDICATED  39000002
         BO    DET04110                YES, BYPASS VALIDITY CHECK       39050002
         SPACE                                                          39100002
*/* P VALIDITY CHECK ECB BEFORE POSTING                              */ 39150002
         SPACE                                                          39200002
         LR    R0,R2DETTCB             SAVE DETACH TCB ADDRESS          39300002
         SR    R2,R2                   CLEAR                            39350002
         IC    R2,TCBPKF-TCB(R4OTCB)   CORRECT ECB PROTECT KEY          39400002
         OI    DETFRRF1,DETECB         INDICATE CHECKING ECB            39450002
         MODESET KEYADDR=(2)           SET CALLER'S PROTECT KEY         39500002
         OC    0(C4,R11),0(R11)        REFERENCE ECB IN CALLER'S KEY    39600002
         MODESET EXTKEY=SUPR           RESET KEY 0                      39650002
         NI    DETFRRF1,FF-DETECB      RESET CHECK FLAG                 39700002
         LR    R2DETTCB,R0             RESTORE                          39750002
         SPACE                                                          39800002
*/* DET04110: L IEAV0PT02: POST ATTACH ECB                           */ 39900002
         SPACE                                                          39950002
DET04110 EQU   *                       *                                40000002
         SR    R10,R10                 CLEAR                            40050002
         L     R15,CVTPTR              ADDRESS OF CVT                   40100002
         LR    R0,R14                  SAVE RETURN ADDRESS              40200002
         ICM   R10,B'0111',TCBCMPC-TCB(R2DETTCB)  GET COMPLETION CODE   40250002
         LR    R12,R4OTCB              ADDRESS OF MOTHER TCB            40300002
         L     R15,CVT0PT02-CVT(,R15)  BRANCH ENTRY ADDRESS             40350002
         BALR  R14,R15                 INVOKE POST                      40400002
* NOTE - - REGISTERS 10 - 15 DESTROYED                                  40450002
         SPACE                                                          40500002
*/* R RETURN                                                         */ 40550002
         SPACE                                                          40600002
         LR    R14,R0                  RESTORE RETURN ADDRESS           40650002
         BR    R14                     RETURN                           40700002
         SPACE                                                          40800002
*/* POSTRTN: END FLOWCHART                                           */ 40860002
         EJECT                                                          40862002
*/* ABTERMR: CHART                                                   */ 40924002
*/* FOOTING                                                             41000002
*/* ABTERM SUBROUTINE                                                */ 41050002
*********************************************************************** 41150002
*                                                                     * 41200002
* SUBROUTINE ABTERMR ABTERMS A TCB. IT IS CALLED BY SUBROUTINE SUBRTN * 41250002
* AND RECOVERY RETRY ROUTINE IGC062R3.                                * 41300002
*                                                                     * 41400002
* SUBROUTINES CALLED: NONE                                            * 41450002
*                                                                     * 41500002
* SYSTEM ROUTINES CALLED / MACROS ISSUED: CALLRTM                     * 41550002
*                                                                     * 41600002
* RETURN CODES SET: NONE                                              * 41700002
*                                                                     * 41750002
* REGISTER USAGE:                                                     * 41800002
*        R0    - DESTROYED                                            * 41850002
*        R1    - INPUT, COMPLETION CODE                               * 41900002
*        R2    - DESTROYED                                            * 42000002
*        R7    - DESTROYED                                            * 42050002
*        R12   - ADDRESS OF TCB TO BE ABTERMED                        * 42100002
*        R14   - RETURN ADDRESS                                       * 42150002
*        R15   - DESTROYED                                            * 42200002
*                                                                     * 42300002
*********************************************************************** 42350002
*/* E ENTER ABTERMR                                                  */ 42400002
         SPACE                                                          42450002
ABTERMR  EQU   *                       ENTRY POINT                      42500002
         LR    R7,R14                  SAVE RETURN ADDRESS              42600002
         SPACE                                                          42650002
*/* L CALLRTM: ABTERM TASK                                           */ 42700002
         SPACE                                                          42750002
         CALLRTM TYPE=ABTERM,DUMP=NO,COMPCOD=(1),TCB=(12)      @YM03636 42800002
         SPACE                                                          42900002
*/* R () RETURN                                                      */ 42950002
         SPACE                                                          43000002
         LR    R14,R7                  RESTORE RETURN ADDRESS           43050002
         BR    R14                     RETURN                           43100002
*/* ABTERMR: END FLOWCHART                                           */ 43200002
         EJECT                                                          43250002
*/* FREETCB: CHART                                                   */ 43300002
*/* FOOTING                                                             43350002
*/* SUBROUTINE WHICH FREES TCB RESOURCES                             */ 43400002
         SPACE 2                                                        43500002
*********************************************************************** 43550002
*                                                                     * 43600002
* SUBROUTINE FREETCB DEQUEUES THE DETACH TCB FROM ITS FAMILY QUEUE,   * 43650002
* FREES THE TCB'S PROBLEM PROGRAM SAVE AREA, IF ONE EXISTS, AND FREES * 43700002
* THE TCB STORAGE. IT IS CALLED BY SUBROUTINE SUBRTN AND BY THE       * 43800002
* BRANCH ENTRY FROM END-OF-TASK.                                      * 43850002
*                                                                     * 43900002
* SUBROUTINES CALLED: FREE, DEQUEUE                                   * 43950002
*                                                                     * 44000002
* SYSTEM ROUTINES CALLED / MACROS ISSUED: NONE                        * 44100002
*                                                                     * 44150002
* RETURN CODES SET: NONE                                              * 44200002
*                                                                     * 44250002
* REGISTER USAGE: R5       - RESTRICTED                               * 44300002
*                 R8       - RETURN ADDRESS SAVE REGISTER             * 44400002
*                 R2DETTCB - ADDRESS OF THE DETACH TCB                * 44450002
*                 R14      - RETURN ADDRESS                           * 44500002
*                                                                     * 44550002
*********************************************************************** 44600002
         SPACE 2                                                        44700002
*/* E ENTER FREETCB                                                  */ 44750002
         SPACE                                                          44800002
FREETCB  DS    0H                      ENTRY POINT                      44850002
         LR    R8,R14                  SAVE RETURN ADDRESS              44900002
         SPACE                                                          44950002
*/* D (NO,DET02000,YES,) IS THERE A PROB PGM SAVE AREA               */ 45020002
         SPACE                                                          45100002
         SR    R1,R1                   CLEAR                            45150002
         ICM   R1,B'0111',TCBFSAB-TCB(R2DETTCB) SAVE AREA ADDRESS       45200002
         BZ    DET02000                BYPASS FREEING IF ADDRESS 0      45300002
         SPACE                                                          45350002
*/* S FREE: FREE PROBLEM PROGRAM SAVE AREA, SP 250                   */ 45400002
         SPACE                                                          45450002
         LA    R0,SVAREAL              LENGTH OF SAVE AREA              45500002
         LA    R3,SP250                SUBPOOL NUMBER                   45570002
         BAL   R14,FREE                FREEMAIN SAVE AREA               45650002
         SPACE                                                          45700002
*/* DET02000: S DEQUEUE: UNCHAIN TCB FROM FAMILY QUEUE               */ 45750002
         SPACE                                                          45800002
DET02000 EQU   *                       *                                45900002
         BAL   R14,DEQUEUE             UNCHAIN FROM FAMILY QUEUE        45950002
         SPACE                                                          46000002
*/* S FREE: FREE DETACH TCB                                          */ 46050002
         SPACE                                                          46100002
         LR    R1,R2DETTCB             ADDRESS OF TCB                   46200002
         LA    R7,TCBPXLEN             LENGTH OF TCB PREFIX             46250002
         SR    R1,R7                   ADDRESS OF TCB PREFIX            46300002
         LA    R0,TCBLEN               LENGTH OF TCB                    46350002
         LA    R3,SP253                SUBPOOL NUMBER                   46400002
         BAL   R14,FREE                FREE TCB                         46500002
         SPACE                                                          46550002
*/* R RETURN TO CALLING POINT                                        */ 46600002
         SPACE                                                          46650002
         LR    R14,R8                  RESTORE                          46700002
         BR    R14                     RETURN                           46750002
         SPACE 2                                                        46850002
*/* FREETCB: END FLOWCHART                                           */ 46900002
         EJECT                                                          46950002
*/* FREE: CHART                                                      */ 47000002
*/* FOOTING                                                             47100002
*/* SUBROUTINE WHICH PERFORMS FREEMAINS                              */ 47150002
         SPACE 2                                                        47200002
*********************************************************************** 47250002
*                                                                     * 47300002
* SUBROUTINE FREE INVOKES A BRANCH ENTRY FREEMAIN. IF THE DETACH TASK * 47400002
* IS IN ABEND, THE FREEMAIN IS CONDITIONAL. OTHERWISE, THE FREEMAIN   * 47450002
* IS UNCONDITIONAL. IT IS CALLED BY SUBROUTINES FREETCB AND SUBRTN.   * 47500002
*                                                                     * 47550002
* SYSTEM ROUTINES CALLED / MACROS ISSUED: FREEMAIN BRANCH ENTRY       * 47600002
*                                                                     * 47700002
* RETURN CODES SET: NONE                                              * 47750002
*                                                                     * 47800002
* REGISTER USAGE: R0       - LENGTH OF AREA TO BE FREED               * 47850002
*                 R1       - ADDRESS OF AREA TO BE FREED              * 47900002
*                 R2DETTCB - ADDRESS OF THE DETACH TCB                * 48000002
*                 R3       - SUBPOOL ID OF AREA TO BE FREED           * 48050002
*                 R4OTCB   - ADDRESS OF THE MOTHER TCB                * 48100002
*                 R5       - RESTRICTED                               * 48150002
*                 R8       - RESTRICTED                               * 48200002
*                 R12      - RETURN ADDRESS SAVE REGISTER             * 48300002
*                 R13WKPTR - ADDRESS OF WORKAREA                      * 48350002
*                                                                     * 48400002
*********************************************************************** 48450002
         SPACE 2                                                        48540002
*/* E ENTER FREE                                                     */ 48600002
         SPACE                                                          48650002
FREE     DS    0H                      ENTRY POINT                      48700002
         LR    R12,R14                 SAVE RETURN ADDRESS              48750002
         SPACE                                                          48800002
*/* D (YES,DET03010,NO,) IS THIS A PERMANENTLY RESIDENT TASK         */ 48900002
         SPACE                                                          48950002
         TM    TCBFLGS7-TCB(R2DETTCB),TCBRSTSK IS TASK PERM RESIDENT    49000002
         BO    DET03010                YES, PERFORM NO FREEMAINS        49050002
         SPACE                                                          49100002
         L     R7,PSAAOLD-PSA(R0)      ADDRESS OF CURRENT ASCB          49150002
         SPACE                                                          49200002
*/* D (NO,DET03000,YES,) WAS CONDITIONAL FREEMAIN REQUESTED          */ 49300002
         SPACE                                                          49350002
         TM    WKFLAGS,WKCONDL         CONDITIONAL FREEMAIN REQUESTED   49400002
         BZ    DET03000                NO, ISSUE UNCONDITIONAL REQUEST  49500002
         SPACE                                                          49550002
*/* L (,DET03010) FREEMAIN: CONDITIONALLY FREE INPUT AREA            */ 49600002
         SPACE                                                          49650002
         FREEMAIN RC,LV=(0),A=(1),SP=(3),BRANCH=YES                     49700002
         B     DET03010                GO EXIT SUBROUTINE               49800002
         SPACE                                                          49850002
*/* DET03000: L FREEMAIN: UNCOND FREE INPUT AREA                     */ 49900002
         SPACE                                                          49950002
DET03000 EQU   *                       *                                50000002
         FREEMAIN RU,LV=(0),A=(1),SP=(3),BRANCH=YES                     50100002
         SPACE                                                          50150002
*/* DET03010: R RETURN TO CALLING POINT                              */ 50200002
         SPACE                                                          50250002
DET03010 EQU   *                       *                                50300002
         LR    R14,R12                 RESTORE                          50400002
         BR    R14                     RETURN                           50450002
         SPACE 2                                                        50500002
*/* FREE: END FLOWCHART                                              */ 50550002
         EJECT                                                          50600002
*/* DEQUEUE: CHART                                                   */ 50700002
*/* FOOTING                                                             50750002
*/* SUBROUTINE REMOVES DETACH TCB FROM THE FAMILY QUEUE              */ 50800002
*********************************************************************** 50850002
*                                                                     * 50900002
* SUBROUTINE DEQUEUE REMOVES THE DETACH TCB FROM THE FAMILY QUEUE,    * 51000002
* IF IT IS STILL ON THAT QUEUE.                                       * 51050002
*                                                                     * 51100002
* SUBROUTINES CALLED: NONE                                            * 51150002
*                                                                     * 51200002
* SYSTEM ROUTINES CALLED / MACROS ISSUED: NONE                        * 51250002
*                                                                     * 51350002
* RETURN CODES SET: NONE                                              * 51400002
*                                                                     * 51450002
* REGISTER USAGE:                                                     * 51500002
*        R2DETTCB - ADDRESS OF THE DETACH TCB                         * 51600002
*        R4OTCB - ADDRESS OF THE MOTHER TCB                           * 51650002
*        R7    - DESTROYED                                            * 51700002
*        R11   - DESTROYED                                            * 51750002
*        R14   - RETURN ADDRESS                                       * 51800002
*                                                                     * 51900002
* LEVEL - 2 (CALLED BY SUBROUTINE FREETCB AND THE FRR)                * 51950002
*                                                                     * 52000002
*********************************************************************** 52050002
         SPACE                                                          52100002
*/* E ENTER DEQUEUE                                                  */ 52150002
*/* P REMOVE DETACH TCB FROM THE FAMILY QUEUE                        */ 52250002
         SPACE                                                          52300002
DEQUEUE  EQU   *                       *                                52350002
         LA    R11,TCBLTC-TCB(,R4OTCB) INITIAL CHAIN FIELD ADDRESS      52400002
         B     DET02010                ENTER LOOP                       52450002
         SPACE                                                          52550002
DET02020 EQU   *                       TOP OF LOOP                      52620002
         LA    R11,TCBNTC-TCB(,R7)     UPDATE CHAIN FIELD ADDRESS       52624002
DET02010 EQU   *                       *                                52700002
         ICM   R7,B'1111',0(R11)       CHAIN FIELD CONTENTS (ADDRESS    52750002
*                                        OF NEXT SUBTASK)               52850002
         BZ    DET02050                NO MORE SUBTASKS, RETURN         52900002
         CR    R7,R2DETTCB             IS THIS THE DETACH TCB           52950002
         BNE   DET02020                NO, CONTINUE                     53000002
*                                      YES, UNCHAIN IT                  53055002
         L     R7,TCBNTC-TCB(,R2DETTCB)  ADDRESS OF NEXT SUBTASK, OR 0  53108002
         ST    R7,0(,R11)                  INTO PREVIOUS CHAIN FIELD    53200002
         SPACE                                                          53250002
*/* DET02050: R () RETURN                                            */ 53300002
         SPACE                                                          53400002
DET02050 EQU   *                       *                                53450002
         BR    R14                     RETURN                           53500002
         SPACE                                                          53550002
*/* DEQUEUE: END FLOWCHART                                           */ 53600002
         TITLE 'IEAVEED0 - DETACH BRANCH ENTRY - IGC062R1'              53700002
*/* IGC062R1: CHART                                                  */ 53750002
*/* FOOTING                                                             53800002
*/* BRANCH ENTRY FOR ABEND AND EOT                                   */ 53850002
*********************************************************************** 53900002
*                                                                     * 53950002
* IGC062R1 IS A BRANCH ENTRY POINT FOR USE BY ABEND AND END-OF-TASK.  * 54010002
* IT PROVIDES ABEND WITH A DIRECTED DETACH FUNCTION, FOR WHICH THE    * 54070002
* DETACH TCB NEED NOT BE A SUBTASK OF THE CURRENT TCB. FOR END-OF-    * 54150002
* TASK IT IS A RESOURCE MANAGER, AND HANDLES SCHEDULING OF ETXR,      * 54240002
* POSTING ATTACH ECB, AND FREEING TCB RELATED RESOURCES.              * 54300002
*                                                                     * 54350002
* SUBROUTINES CALLED: FRRON, FRROFF, SUBRTN, FREETCB, POSTRTN         * 54400002
*                                                                     * 54450002
* SYSTEM ROUTINES CALLED / MACROS ISSUED: STAGE II EXIT EFFECTOR      * 54500002
*                                                                     * 54550002
* RETURN CODES SET: NONE                                              * 54620002
*                                                                     * 54680002
* REGISTER USAGE: R0       - AN ENTRY CODE:                           * 54750002
*                                      0 - EOT PROCESSING             * 54800002
*                                      1 - ABEND PROCESSING           * 54850002
*                 R1       - ADDRESS OF TCB TO BE DETACHED            * 54920002
*                 R13      - ADDRESS OF A 72 BYTE REGISTER SAVE AREA  * 54990002
*                 R14      - RETURN ADDRESS                           * 55060002
*                 R15      - ENTRY POINT ADDRESS                      * 55130002
*                                                                     * 55200002
* NOTE: LOCAL LOCK IS HELD UPON ENTRY                                 * 55260002
*                                                                     * 55320002
*********************************************************************** 55380002
         SPACE                                                          55440002
*/* E ENTER IGC062R1                                                 */ 55500002
         SPACE                                                          55550002
IGC062R1 DS    0H                      ENTRY POINT                      55600002
         STM   R14,R12,WKR14RET        SAVE REGISTERS                   55650002
         SR    R2,R2                   CLEAR                            55700002
         STC   R2,WKFLAGS              CLEAR FLAGS                      55800002
         ST    R2,WKECB                CLEAR ECB                        55850002
         LR    R2DETTCB,R1             DETACH TCB ADDRESS               55900002
         USING IGC062R1,R15                                             55950002
         L     R6BASE,DET062EP         ESTABLISH ADDRESSABILITY         56000002
         DROP  R15                                                      56100002
         SPACE                                                          56150002
*/* P GET MOTHER TCB ADDRESS                                         */ 56200002
         SPACE                                                          56250002
         L     R4OTCB,TCBOTC-TCB(,R2DETTCB) SET MOTHER TCB ADDRESS      56300002
         SPACE                                                          56400002
*/* S FRRON: ESTABLISH FRR                                           */ 56450002
         SPACE                                                          56500002
         BAL   R14,FRRON               ADD ELEMENT TO STACK             56550002
         SPACE                                                          56600002
*/* P INDICATE CONDITIONAL FREEMAINS TO BE PERFORMED, BRANCH ENTRY   */ 56700002
         SPACE                                                          56750002
         OI    WKFLAGS,WKCONDL+WKBRNTY ABEND NOT PERMISSIBLE THIS ENTRY 56800002
*                                      DETACH WAS BRANCH ENTERED        56850002
         SPACE                                                          56900002
*/* D (0,DET04000,1,) CHECK ENTRY CODE                               */ 56950002
         SPACE                                                          57050002
         CLI   WKR0+C3,C0              IS ENTRY CODE 0                  57100002
         BE    DET04000                YES, GO PERFORM EOT PROCESSING   57150002
         SPACE                                                          57200002
*/* P CLEAR TCBECB IN DETACH TCB                                     */ 57250002
         SPACE                                                          57350002
         SR    R15,R15                 ZERO                             57400002
         ST    R15,TCBECB-TCB(,R2DETTCB)  NO POST FOR THIS ENTRY        57450002
         SPACE                                                          57500002
*/* S (,DET04010) SUBRTN: PERFORM DETACH                             */ 57600002
         SPACE                                                          57650002
         BAL   R14,SUBRTN              DETACH INPUT TCB, WITH STAI=NO,  57700002
*                                        AND WITH ABTERM ALLOWED        57750002
         B     DET04010                GO TO EXIT                       57800002
         SPACE 2                                                        57850002
*********************************************************************** 57900002
*                                                                     * 58000002
*                       PERFORM EOT PROCESSING                        * 58050002
*                                                                     * 58100002
*********************************************************************** 58200002
         SPACE                                                          58250002
*/* DET04000: P SET END OF TASK INDICATOR FOR FRR                    */ 58300002
         SPACE                                                          58350002
DET04000 EQU   *                       *                                58400002
         OI    DETFRRF1,DETEOT         INDICATE EOT ENTRY       @Y02753 58450002
         SPACE                                                          58500002
*/* D (NO,DET04020,YES,) IS THERE AN ATTACH ECB                      */ 58600002
         SPACE                                                          58650002
         ICM   R11,B'1111',TCBECB-TCB(R2DETTCB)  ECB ADDRESS            58700002
         BZ    DET04020                IF ADDRESS 0, BYPASS POST        58800002
         SPACE                                                          58850002
*/* S POSTRTN: VALIDITY CHECK AND POST ATTACH ECB                    */ 58900002
         SPACE                                                          58950002
         BAL   R14,POSTRTN             INVOKE POST SUBROUTINE           59000002
         OI    WKFLAGS,WKHOLD          TCB NOT TO BE FREED              59100002
         SPACE                                                          59150002
*/* DET04020: D (NO,DET04030,YES,) IS THERE AN ETXR                  */ 59200002
         SPACE                                                          59250002
DET04020 EQU   *                       *                                59300002
         TM    TCBFLGS2-TCB(R2DETTCB),TCBFETXR  DOES ATTACH ETXR EXIST  59400002
         BZ    DET04030                NO, BYPASS SCHEDULING            59450002
         SPACE                                                          59500002
*/* L STAGE II EXIT EFFECTOR: SCHEDULE ETXR                          */ 59550002
         SPACE                                                          59600002
         L     R1,TCBIQE-TCB(,R2DETTCB)  IQE ADDRESS                    59700002
         LCR   R1,R1                   COMPLEMENT OF IQE ADDR IS INPUT  59750002
         L     R15,CVTPTR              ADDRESS OF CVT                   59800002
         L     R15,CVT0EF00-CVTMAP(,R15)  ADDR OF STAGE II EXIT EFFECT  59850002
         BALR  R14,R15                 SCHEDULE ETXR                    59900002
         OI    WKFLAGS,WKHOLD          TCB NOT TO BE FREED              59950002
         SPACE                                                          60050002
*/* DET04030: P SET TCBACTIV = 0                                     */ 60100002
         SPACE                                                          60150002
DET04030 EQU   *                       *                                60200002
         NI    TCBFBYT1-TCB(R2DETTCB),FF-TCBACTIV  ACTIVE SWITCH OFF    60300002
         OI    DETFRRF1,DETCOMPL       INDICATE ECB,ETXR PROCESSING     60350002
*                                      COMPLETED                @Y02753 60400002
         SPACE                                                          60450002
*/* P UNCHAIN TCB FROM DISPATCHING QUEUE                             */ 60500002
         SPACE                                                          60600002
         L     R14,PSAAOLD-PSA(R0)     ADDRESS OF CURRENT ASCB          60650002
         L     R14,ASCBASXB-ASCB(,R14) ADDRESS OF CURRENT ASXB          60700002
         SR    R10,R10                 INITIAL PREVIOUS TCB PTR         60750002
         L     R11,ASXBFTCB-ASXB(,R14) INITIAL COMPARE TCB PTR, ADDR    60800002
*                                        OF FIRST TCB ON READY QUEUE    60900002
         L     R12,TCBTCB-TCB(,R11)    INITIAL NEXT TCB PTR             60950002
         B     DET04050                GO CHECK COMPARE TCB             61000002
         SPACE                                                          61050002
DET04040 EQU   *                       SEARCH LOOP                      61100002
         LR    R10,R11                 COMPARE TCB BECOMES PREVIOUS     61200002
         LR    R11,R12                 NEXT BECOMES COMPARE             61210002
         L     R12,TCBTCB-TCB(,R12)    UPDATE PTR TO NEXT TCB           61300002
DET04050 EQU   *                       SEARCH LOOP ENTRY POINT          61350002
         CR    R11,R2DETTCB            IS COMPARE TCB THE DETACH TCB    61400002
         BNE   DET04040                NO, TRY NEXT                     61500002
*                                      YES, UNCHAIN IT                  61550002
         LTR   R10,R10                 IS FIRST ELEMENT BEING UNCHAINED 61600002
         BZ    DET04060                YES, GO UPDATE TOP OF QUEUE PTR  61650002
         ST    R12,TCBTCB-TCB(,R10)    NO, CHAIN NEXT TO PREVIOUS BY    61700002
*                                        FORWARD PTR                    61750002
         B     DET04070                GO PROCESS BACK CHAIN            61808002
DET04060 EQU   *                       *                                61900002
         ST    R12,ASXBFTCB-ASXB(,R14) NEXT BECOMES FIRST ON QUEUE      61950002
DET04070 EQU   *                       *                                62000002
         LTR   R12,R12                 IS LAST ELEMENT BEING UNCHAINED  62100002
         BZ    DET04080                YES, GO UPDATE END OF QUEUE PTR  62150002
         ST    R10,TCBBACK-TCB(,R12)   NO, CHAIN PREVIOUS TO NEXT BY    62200002
*                                        BACKWARD PTR                   62250002
         B     DET04090                UNCHAINING IS COMPLETE           62300002
DET04080 EQU   *                       *                                62350002
         ST    R10,ASXBLTCB-ASXB(,R14) PREVIOUS BECOMES LAST ON QUEUE   62400002
         SPACE                                                          62500002
*/* DET04090: P CLEAR PSATOLD, INDICATE TASK HAS COMPLETED           */ 62550002
         SPACE                                                          62600002
DET04090 EQU   *                       *                                62650002
         SR    R10,R10                 CLEAR                            62700002
         ST    R10,PSATOLD-PSA(R0)     ZERO CURRENT TCB POINTER         62800002
         OI    TCBFLGS5-TCB(R2DETTCB),TCBFC  TASK IS COMPLETE           62850002
         SPACE                                                          62900002
*/* P DECREMENT COUNT OF TCB'S ON DISPATCH QUEUE                     */ 63000002
         SPACE                                                          63050002
         LH    R10,ASXBTCBS-ASXB(,R14) NUMBER OF TCB'S ON DISPATCHING   63100002
         BCTR  R10,R0                  QUEUE LESS ONE                   63150002
         STH   R10,ASXBTCBS-ASXB(,R14) SAVE NEW COUNT (FIELD IS         63200002
*                                        SERIALIZED BY LOCAL LOCK)      63300002
         SPACE                                                          63350002
*/* D (YES,DET04100,NO,) WAS THERE AN ECB OR ETXR                    */ 63400002
         SPACE                                                          63450002
         TM    WKFLAGS,WKHOLD          SHOULD TCB BE FREED              63500002
         BO    DET04100                NO, BYPASS FREEMAIN              63550002
         SPACE                                                          63650002
*/* S (,DET04010) FREETCB: FREE TCB RESOURCES                        */ 63700002
         SPACE                                                          63750002
         BAL   R14,FREETCB             CLEAN UP TCB                     63800002
         B     DET04010                GO EXIT                          63900002
         SPACE                                                          63950002
*/* DET04100: P SET TCBIQE = 0, TCBECB = 0, TCBFETXR = 0             */ 64000002
         SPACE                                                          64050002
DET04100 EQU   *                       *                                64100002
         NI    TCBFLGS2-TCB(R2DETTCB),FF-TCBFETXR  ETXR OFF             64200002
         SR    R0,R0                   CLEAR                            64250002
         ST    R0,TCBIQE-TCB(,R2DETTCB)  NO IQE PTR                     64300002
         ST    R0,TCBECB-TCB(,R2DETTCB)  NO ECB PTR                     64350002
         SPACE                                                          64400002
*/* DET04010: S FRROFF: CANCEL FRR                                   */ 64500002
         SPACE                                                          64550002
DET04010 EQU   *                       *                                64600002
         BAL   R14,FRROFF              REMOVE STACK ELEMENT             64650002
         SPACE                                                          64700002
*/* R RETURN TO CALLER                                               */ 64800002
         SPACE                                                          64850002
         LM    R14,R12,WKR14RET        RESTORE REGISTERS                64900002
         BR    R14                     RETURN                           64950002
         SPACE                                                          65000002
*/* IGC062R1: END FLOWCHART                                          */ 65100002
         TITLE 'IEAVEED0 - DETACH FRR - IGC062R2'                       65200002
*/* IGC062R2: CHART                                                  */ 65250002
*/* FOOTING                                                             65300002
*/* FRR                                                              */ 65400002
         SPACE                                                          65450002
*********************************************************************** 65500002
*                                                                     * 65550002
* IGC062R2 IS THE FUNCTIONAL RECOVERY ROUTINE (FRR) FOR DETACH. IT    * 65600002
* PROVIDES FOR PARAMETER VALIDITY CHECKING, VALIDATION OF THE TCB     * 65700002
* DISPATCHING AND FAMILY QUEUES, AND FOR BRANCH ENTRY, RETRY TO       * 65750002
* RETURN TO THE CALLER.                                               * 65800002
*                                                                     * 65850002
* SUBROUTINES CALLED: DEQUEUE                                         * 65900002
*                                                                     * 66000002
* SYSTEM ROUTINES CALLED/MACROS ISSUED:                               * 66050002
* IGC044R2 - TCB QUEUE VALIDATION ROUTINE, IN CHAP MODULE IEAVECH0    * 66100002
*                                                                     * 66150002
* RETURN CODES SET: 0, 4                                              * 66200002
*                                                                     * 66300002
* REGISTER USAGE:                                                     * 66350002
*        R0    - ADDRESS OF 200 BYTE WORKAREA                         * 66420002
*        R1    - ADDRESS OF THE SDWA                                  * 66430002
*        R9    - RETURN ADDRESS SAVE REGISTER                         * 66500002
*        R14   - RETURN ADDRESS                                       * 66600002
*        R15   - ENTRY POINT ADDRESS                                  * 66650002
*                                                                     * 66700002
*********************************************************************** 66750002
         SPACE 2                                                        66800002
*/* E ENTER IGC062R2                                                 */ 66900002
         SPACE                                                          66950002
IGC062R2 EQU   *                       ENTRY POINT              @Y02753 67000002
         USING IGC062R2,R15                                     @Y02753 67050002
         L     R6BASE,DET062EP         SVC ENTRY POINT ADDRESS  @Y02753 67100002
         DROP  R15                                              @Y02753 67150002
         L     R5FRR,SDWAPARM-SDWA(,R1) ADDRESS OF FRR WORKAREA @Y02753 67200002
         LR    R9,R14                  SAVE RETURN ADDRESS      @Y02753 67300002
         SPACE                                                          67350002
*/* D (NO,DET80000,YES,) DID ERROR OCCUR IN CURRENT ADDRESS SPACE    */ 67400002
         SPACE                                                          67500002
         OC    SDWAFMID-SDWA(C2,R1),SDWAFMID-SDWA(R1) ANY ASID  @Y02753 67550002
         BNZ   DET80000                YES, GO PERCOLATE ERROR  @Y02753 67600002
         SPACE                                                          67630002
*/* D (NO,DET80060,YES,) WAS DETACH BRANCH ENTERED                   */ 67700002
         SPACE                                                          67800002
         L     R13WKPTR,DETWKPTR       ADDRESS OF WORKAREA      @Y02753 67850002
         TM    WKFLAGS,WKBRNTY         WAS ENTRY AT IGC062R1    @Y02753 67900002
         BZ    DET80060                NO, CHECK ENTRY TYPE     @Y02753 67950002
         SPACE                                                          68000002
*/* P INDICATE TASK HAS COMPLETED                                    */ 68100002
         SPACE                                                          68150002
         L     R2DETTCB,WKR1TCB        ADDRESS OF DETACH TCB    @Y02753 68230002
         OI    TCBFLGS5-TCB(R2DETTCB),TCBFC SET COMPLETE FLAG SO THAT   68310002
* IGC044R2 WILL DEQUEUE TCB FROM THE DISPATCHING QUEUE          @Y02753 68390002
         SPACE                                                          68470002
*/* DET80060: D (NO,DET80020,YES,) ENTRY DUE TO VALIDITY CHECK       */ 68550002
         SPACE                                                          68630002
DET80060 EQU   *                       *                                68710002
         IC    R10,SDWAMWP1-SDWA(,R1)  ERROR-TIME PSW KEY-CMWP  @Y02753 68790002
         LA    R11,KEYMASK             MASK OUT ALL BUT KEY     @Y02753 68870002
         NR    R10,R11                 CLEAR ALL BUT KEY        @Y02753 68950002
         BZ    DET80020                KEY ZERO, ERROR ENTRY    @Y02753 69030002
         SPACE                                                          69110002
         TM    SDWAERRA-SDWA(R1),SDWAPCHK DID A PGM CHECK OCCUR @Y02753 69190002
         BZ    DET80020                NO, VALIDATE QUEUES      @Y02753 69270002
         SPACE                                                          69350002
*/* P REQUEST DUMP, NO RECORDING                                     */ 69430002
         SPACE                                                          69510002
         SETRP RECORD=NO,DUMP=YES      NO RECORDING, USER ERROR @Y02753 69590002
         SPACE                                                          69670002
*/* D (NO,DET80010,YES,) WAS DETACH ENTERED BY END OF TASK           */ 69750002
         SPACE                                                          69830002
         TM    DETFRRF1,DETEOT         CHECK FOR END OF TASK    @Y02753 69910002
         BZ    DET80010                NO, SET COMPLETION CODE  @Y02753 69990002
         SPACE                                                          70070002
*/* P INDICATE INVALID ECB AT END OF TASK                            */ 70150002
         SPACE                                                          70230002
         OI    DETFRRF1,DETEOT2        SET INDICATOR            @Y02753 70310002
         SR    R2,R2                   INDICATE NO SVC DUMP     @Y02753 70390002
*                                      TO IGC044R2                      70470002
         B     DET80070                GO VALIDATE QUEUES       @Y02753 70550002
         SPACE                                                          70630002
*/* DET80020: L IGC044R2: VALIDATE TCB QUEUES                        */ 70710002
         SPACE                                                          70790002
DET80020 EQU   *                       *                                70870002
         SETRP RECORD=YES,RECPARM=DETFRRID INITIALIZE RECORDING @Y02753 70950002
         LA    R2,DETIDLNG             ADDR OF SVC DUMP HEADER  @Y02753 71030002
DET80070 EQU   *                       *                                71110002
         L     R15,DET044R2            QUEUE VALIDATION RTN     @Y02753 71190002
         BALR  R14,R15                 INVOKE IGC044R2          @Y02753 71270002
* ALL REGISTERS, EXCEPT 0, 1, 9, 14, MAY BE CHANGED.                    71350002
         SPACE                                                          71430002
         USING DET80080,R14            ADDRESSABILITY           @Y02753 71510002
DET80080 EQU   *                       RETURN POINT             @Y02753 71590002
         L     R6BASE,DET062EP         SVC ENTRY POINT ADDRESS  @Y02753 71670002
         DROP  R14                                              @Y02753 71750002
         L     R5FRR,SDWAPARM-SDWA(,R1) FRR WORKAREA ADDRESS    @Y02753 71830002
         L     R13WKPTR,DETWKPTR       ADDRESS OF WORKAREA      @Y02753 71910002
         L     R2DETTCB,WKR1TCB        ADDRESS OF DETACH TCB    @Y02753 71990002
         L     R4OTCB,DETOTC           ADDRESS OF MOTHER TCB    @Y02753 72070002
         SPACE                                                          72150002
*/* D (NO,DET80000,YES,) ARE QUEUES USABLE                           */ 72230002
         SPACE                                                          72310002
         LTR   R15,R15                 VALIDATION SUCCESSFUL    @Y02753 72390002
         BNZ   DET80000                NO, GO EXIT NO RETRY     @Y02753 72470002
         SPACE                                                          72550002
*/* D (NO,DET80000,YES,) WAS DETACH BRANCH ENTERED                   */ 72630002
         SPACE                                                          72710002
         TM    WKFLAGS,WKBRNTY         ENTERED AT IGC062R1      @Y02753 72790002
         BZ    DET80000                NO, GO EXIT NO RETRY     @Y02753 72870002
         SPACE                                                          72950002
*/* S DEQUEUE: REMOVE TCB FROM FAMILY QUEUE                          */ 73030002
         SPACE                                                          73110002
         BAL   R14,DEQUEUE             UNCHAIN OFF FAMILY QUEUE @Y02753 73190002
         SPACE                                                          73270002
*/* D (NO,DET80030,YES,) WAS ENTRY FROM END OF TASK                  */ 73350002
         SPACE                                                          73430002
         TM    DETFRRF1,DETEOT         EOT RESOURCE MGR         @Y02753 73510002
         BZ    DET80030                NO, RETRY NO ABTERM      @Y02753 73590002
         SPACE                                                          73670002
*/* D (NO,DET80090,YES,) WAS ENTRY CAUSED BY ECB CHECK               */ 73750002
         SPACE                                                          73830002
         TM    DETFRRF1,DETEOT2        VAL CHK AT EOT IS ECB    @Y02753 73910002
         BZ    DET80090                NO, CHECK FOR 53E ABEND  @Y02753 73990002
         SPACE                                                          74070002
*/* P (,DET80040) INDICATE ABTERM CODE 43E                           */ 74150002
         SPACE                                                          74230002
         LA    R0,ABEND43E             YES, ABTERM CODE 43E     @Y02753 74310002
         B     DET80040                GO EXIT, RETRY           @Y02753 74390002
         SPACE                                                          74470002
*/* DET80090: D (YES,DET80030,NO,) WAS ECB AND ETXR PROCESSING DONE  */ 74550002
         SPACE                                                          74630002
DET80090 EQU   *                       *                        @Y02753 74710002
         TM    DETFRRF1,DETCOMPL       WAS ECB/ETXR CHECKING/PROCESSING 74790002
*                                      PERFORMED                @Y02753 74870002
         BO    DET80030                YES, RETRY, NO ABTERM    @Y02753 74950002
         SPACE                                                          75030002
*/* P (,DET80040) INDICATE ABTERM, CODE 53E                          */ 75110002
         SPACE                                                          75190002
         LA    R0,ABEND53E             CODE, MOTHER TASK ABTERM @Y02753 75270002
         B     DET80040                GO EXIT, RETRY           @Y02753 75350002
         SPACE                                                          75430002
*/* DET80010: D (YES,DET80100,NO,) INVALID ECB                       */ 75510002
         SPACE                                                          75590002
DET80010 EQU   *                       *                                75670002
         TM    DETFRRF1,DETECB         ATTACH ECB BEING CHECKED @Y02753 75750002
         BO    DET80100                YES, SET COMP CODE = 43E @Y02753 75830002
         SPACE                                                          75910002
*/* P (,DET80000) RESET COMPLETION CODE TO 23E                       */ 75990002
         SPACE                                                          76070002
         MVC   SDWACMPC-SDWA(C3,R1),DETSY23E INVALID PARM WORD  @Y02753 76150002
         B     DET80000                GO EXIT, NO RETRY        @Y02753 76230002
         SPACE                                                          76310002
*/* DET80100: P RESET COMPLETION CODE TO 43E                         */ 76390002
         SPACE                                                          76470002
DET80100 EQU   *                       *                        @Y02753 76550002
         MVC   SDWACMPC-SDWA(C3,R1),DETSY43E CODE, INVALID ECB  @Y02753 76630002
         SPACE                                                          76710002
*/* DET80000: R () PERCOLATE ERROR (RC=0)                            */ 76790002
         SPACE                                                          76870002
DET80000 EQU   *                       *                        @Y02753 76950002
         SETRP FRELOCK=(LOCAL),RC=0    NO RETRY                 @Y02753 77030002
         LR    R14,R9                  RESTORE                  @Y02753 77110002
         BR    R14                     RETURN TO RTM            @Y02753 77190002
         SPACE 2                                                        77270002
*/* DET80030: P INDICATE NO ABTERM TO RETRY ROUTINE                  */ 77350002
         SPACE                                                          77430002
DET80030 EQU   *                       *                        @Y02753 77510002
         SR    R0,R0                   NO ABTERM COMP CODE      @Y02753 77590002
         SPACE                                                          77670002
*/* DET80040: R () RETRY (RC = 4)                                    */ 77750002
         SPACE                                                          77830002
DET80040 EQU   *                       *                                77910002
         LA    R15,IGC062R3            ADDRESS OF RETRY ROUTINE @Y02753 77990002
         STM   R0,R15,SDWASR00-SDWA(R1) REGISTERS FOR RETRY RTN @Y02753 78070002
         SETRP RETADDR=(15),RETREGS=YES,RC=4 EXIT CODE, RETRY   @Y02753 78150002
         LR    R14,R9                  RESTORE                  @Y02753 78230002
         BR    R14                     RETURN TO RTM            @Y02753 78310002
         SPACE                                                          78390002
*/* IGC062R2: END FLOWCHART                                          */ 78470002
         TITLE 'IEAVEED0 - DETACH RECOVERY RETRY - IGC062R3'            78550002
*/* IGC062R3: CHART                                                  */ 78630002
*/* FOOTING                                                             78710002
*/* RECOVERY RETRY ROUTINE                                           */ 78790002
         SPACE 2                                                        78870002
*********************************************************************** 78950002
*                                                                     * 79030002
* IGC062R3 IS A RETRY ROUTINE SCHEDULED (VIA SETRP) IN THE DETACH FRR * 79110002
* WHENEVER RECOVERY IS BEING PERFORMED FOR BRANCH ENTRY TO DETACH.    * 79190002
* THIS ROUTINE ABTERMS THE MOTHER TASK OF THE CURRENT TASK UPON       * 79270002
* REQUEST. IN THIS CASE, THE MOTHER TCB ADDRESS AND THE COMPLETION    * 79350002
* CODE TO BE USED ARE PASSED BY THE FRR. HOWEVER, THE PRIMARY PURPOSE * 79430002
* OF THIS ROUTINE IS TO RETURN CONTROL TO THE CALLER, SINCE FAILURE   * 79510002
* TO COMPLETE PROCESSING IS A MUCH LESS DRASTIC ERROR THAN PERCOLA-   * 79590002
* TION, FOR THE CIRCUMSTANCES UNDER WHICH IGC062R1 IS CALLED.         * 79670002
*                                                                     * 79750002
* SUBROUTINES CALLED: FRROFF,ABTERMR                                  * 79830002
*                                                                     * 79910002
* SYSTEM ROUTINES CALLED / MACROS ISSUED: NONE                        * 79990002
*                                                                     * 80070002
* RETURN CODES SET: NONE                                              * 80150002
*                                                                     * 80230002
* REGISTER USAGE:                                                     * 80310002
*        R0    - INPUT, ABTERM COMPLETION CODE, OR 0                  * 80390002
*        R4    - ADDRESS OF MOTHER TCB OF CURRENT TASK                * 80470002
*        R5FRR - ADDRESS OF SIX-WORD WORKAREA FROM SETFRR             * 80550002
*        R6BASE - BASE REGISTER                                       * 80630002
*        R13WKPTR - ADDRESS OF DETACH WORKAREA                        * 80710002
*        R15   - ENTRY POINT ADDRESS                                  * 80790002
*                                                                     * 80870002
*********************************************************************** 80950002
         SPACE 3                                                        81030002
*/* E ENTER IGC062R3                                                 */ 81110002
         SPACE                                                          81190002
*/* D (NO,DET70010,YES,) IS ABTERM REQUESTED                         */ 81270002
         SPACE                                                          81350002
IGC062R3 EQU   *                       *                        @Y02753 81430002
         LTR   R0,R0                   ANY COMPLETION CODE      @Y02753 81510002
         BZ    DET70010                NO, BYPASS ABTERM        @Y02753 81590002
         SPACE                                                          81670002
*/* S ABTERMR: ABTERM THE MOTHER TASK                                */ 81750002
         SPACE                                                          81830002
         LR    R12,R4                  ADDRESS OF MOTHER TCB    @Y02753 81910002
         LR    R1,R0                   COMPLETION CODE          @Y02753 81990002
         BAL   R14,ABTERMR             INVOKE ABTERM SUBROUTINE @Y02753 82070002
         SPACE                                                          82150002
*/* DET70010: S FRROFF: CANCEL FRR STACK ELEMENT                     */ 82230002
         SPACE                                                          82310002
DET70010 EQU   *                       *                        @Y02753 82390002
         BAL   R14,FRROFF              REMOVE FRR STACK ELEMENT @Y02753 82470002
         SPACE                                                          82550002
*/* P RESTORE REGISTERS                                              */ 82630002
         SPACE                                                          82710002
         LM    R14,R12,WKR14RET        RESTORE                  @Y02753 82790002
         SPACE                                                          82870002
*/* R () RETURN TO CALLER OF IGC062R1                                */ 82950002
         SPACE                                                          83030002
         BR    R14                     RETURN TO EOT OR ABEND   @Y02753 83110002
         SPACE 2                                                        83190002
*/* IGC062R3: END FLOWCHART                                          */ 83270002
         TITLE 'IEAVEED0 - DETACH SVC - ENTRY POINT IGC062'             83350002
*/* FRRON: CHART                                                     */ 83430002
*/* FOOTING                                                             83510002
*/* SUBROUTINE ESTABLISHES FRR                                       */ 83590002
         SPACE 2                                                        83670002
*********************************************************************** 83750002
*                                                                     * 83830002
* SUBROUTINE FRRON ESTABLISHES DETACH'S FRR VIA SETFRR                * 83910002
*                                                                     * 83990002
* SYSTEM ROUTINES CALLED / MACROS ISSUED: SETFRR                      * 84070002
*                                                                     * 84150002
* RETURN CODES SET: NONE                                              * 84230002
*                                                                     * 84310002
* REGISTER USAGE:                                                     * 84390002
*        R11 - DESTROYED                                              * 84470002
*        R12 - DESTROYED                                              * 84550002
*        R7  - DESTROYED                                              * 84630002
*        R4OTC - ADDRESS OF MOTHER TCB                                * 84710002
*        R13WKPTR - ADDRESS OF WKAREA                                 * 84790002
*        R14 - RETURN ADDRESS                                         * 84870002
*        R5FRR - OUTPUT, ADDRESS OF FRR WORKAREA                      * 84950002
*                                                                     * 85030002
*********************************************************************** 85110002
         SPACE 2                                                        85190002
*/* E ENTER FRRON                                                    */ 85270002
         SPACE                                                          85350002
*/* L SETFRR: ESTABLISH FRR                                          */ 85430002
         SPACE                                                          85510002
FRRON    EQU   *                       ENTRY POINT                      85590002
         LA    R11,IGC062R2            ADDRESS OF FRR           @Y02753 85670002
         SETFRR A,FRRAD=(R11),PARMAD=(R5FRR),WRKREGS=(R12,R7)   @Y02753 85750002
         SPACE                                                          85830002
*/* P JOURMAL MOTHER TCB ADDRESS, WORKAREA ADDRESS                   */ 85910002
         SPACE                                                          85990002
         ST    R4OTCB,DETOTC           ADDRESS OF MOTHER TCB    @Y02753 86070002
         ST    R13WKPTR,DETWKPTR       ADDRESS OF WKAREA        @Y02753 86150002
         SPACE                                                          86230002
*/* R RETURN TO CALLING POINT                                        */ 86310002
         SPACE                                                          86390002
         BR    R14                     RETURN                   @Y02753 86470002
         SPACE 2                                                        86550002
*/* FRRON: END FLOWCHART                                             */ 86630002
         EJECT                                                          86710002
*/* FRROFF: CHART                                                    */ 86790002
*/* FOOTING                                                             86870002
*/* SUBROUTINE CANCELS FRR                                           */ 86950002
         SPACE 2                                                        87030002
*********************************************************************** 87110002
*                                                                     * 87190002
* SUBROUTINE FRROFF CANCELS DETACH'S FRR VIA SETFRR.                  * 87270002
*                                                                     * 87350002
* SYSTEM ROUTINES CALLED / MACROS ISSUED: SETFRR                      * 87430002
*                                                                     * 87510002
* RETURN CODES SET: NONE                                              * 87590002
*                                                                     * 87670002
* REGISTER USAGE:                                                     * 87750002
*        R11 - DESTROYED                                              * 87830002
*        R12 - DESTROYED                                              * 87910002
*        R14 - RETURN ADDRESS                                         * 87990002
*                                                                     * 88070002
*********************************************************************** 88150002
         SPACE 2                                                        88230002
*/* E ENTER FRROFF                                                   */ 88310002
         SPACE                                                          88390002
*/* L SETFRR: CANCEL FRR                                             */ 88470002
         SPACE                                                          88550002
FRROFF   EQU   *                       ENTRY POINT                      88630002
         SETFRR D,WRKREGS=(R11,R12)                             @Y02753 88710002
         SPACE                                                          88790002
*/* R RETURN TO CALLING POINT                                        */ 88870002
         SPACE                                                          88950002
         BR    R14                     RETURN                   @Y02753 89030002
         SPACE 2                                                        89110002
*/* FRROFF: END FLOWCHART                                            */ 89190002
         EJECT                                                          89270002
*********************************************************************** 89350002
*                                                                     * 89430002
*                              CONSTANTS                              * 89510002
*                                                                     * 89590002
*********************************************************************** 89670002
         SPACE 2                                                        89750002
DET062EP DC    A(IGC062)               SVC ENTRY ADDRESS                89830002
DET044R2 DC    V(IGC044R2)             ADDRESS OF QUEUE VERIFYING      *89910002
                                       ROUTINE IN MODULE IEAVECH0       89990002
DETSY23E DC    X'23E000'               SYSTEM COMPLETION CODE           90070002
DETSY43E DC    X'43E000'               SYSTEM COMPLETION CODE           90150002
DETIDLNG DC    FL1'24'                 LENGTH SVC DUMP HEADER           90230002
DETFRRID DS    0CL24                   RECORD PARAMETER LIST            90310002
         DC    CL8'IEAVEEDO'           MODULE NAME                      90390002
         DC    CL8'IGC062'             CSECT NAME                       90470002
         DC    CL8'IGC062R2'           FRR ID                           90550002
         EJECT                                                          90630002
         CVT   DSECT=YES                                                90710002
         EJECT                                                          90790002
         IHASCVT                                                        90870002
         EJECT                                                          90950002
         IHAIQE                                                         91030002
         EJECT                                                          91110002
         IHAPSA                                                         91190002
         EJECT                                                          91270002
         IHAFRRS                                                        91350002
         EJECT                                                          91430002
         IHASDWA                                                        91510002
         EJECT                                                          91590002
         IHAASCB                                                        91670002
         EJECT                                                          91750002
         IHAASXB                                                        91830002
         EJECT                                                          91910002
         IKJTCB LIST=YES                                                91990002
         EJECT                                                          92070002
         IKJRB                                                          92150002
         EJECT                                                          92230002
*********************************************************************** 92310002
*                                                                     * 92390002
*                          DETACH WORKAREA                            * 92470002
*                                                                     * 92550002
*********************************************************************** 92630002
         SPACE                                                          92710002
WKAREA   DSECT                         DETACH WORKAREA                  92790002
WKFLAGS  DS    C                       SWITCHES                         92870002
WKSTAE   EQU   X'80'                   1 - STAE=YES SPECIFIED, 0 - NO   92950002
WKTCBFA  EQU   X'40'                   1 - DETACH TCBFA=1, NO ABTERM    93030002
*                                      0 - DETACH TCBFA=0, ABTERM TASK  93110002
WKHOLD   EQU   X'20'                   1 - ECB OR ETXR, DO NOT FREE     93190002
*                                          TCB IN EOT PROCESSING        93270002
*                                      0 - FREE TCB IN EOT PROCESSING   93350002
WKCONDL  EQU   X'10'                   1 - CONDITIONAL FREEMAINS        93430002
*                                      0 - UNCONDITIONAL FREEMAINS      93510002
WKECBNV  EQU   X'08'                   1 - TCBECBNV=1 BEFORE RESET      93590002
*                                      0 - TCBECBNV=0 BEFORE RESET      93670002
WKBRNTY  EQU   X'04'                   1 - DETACH WAS BRANCH ENTERED    93750002
*                                      0 - DETACH ENTERED VIA SVC       93830002
WKRESRV  DS    CL3                     RESERVED                         93910002
WKPREVSA DS    A                       PREVIOUS SAVE AREA PTR           93990002
WKSUBRET EQU   WKPREVSA                RETURN ADDRESS SAVE WORD         94070002
WKNEXTSA DS    A                       NEXT SAVE AREA PTR               94150002
WKECB    EQU   WKNEXTSA                ECB FOR ABTERM OF INCOMPLETE TCB 94230002
WKR14RET DS    A                       REGISTER 14 SAVE WORD            94310002
WKR15EP  DS    A                       REGISTER 15                      94390002
WKR0     DS    A                       REGISTER 0                       94470002
WKR1TCB  DS    A                       REGISTER 1, DETACH TCB ADDRESS   94550002
WKLENTH  EQU   *-WKAREA                LENGTH OF WORKAREA               94630002
         SPACE 3                                                        94710002
*********************************************************************** 94790002
*                                                                     * 94870002
* MAPPING OF SIX WORD WORKAREA PROVIDED BY SETFRR, USED TO COMMUNI-   * 94950002
* CATE WITH FRR (ENTRY POINT IGC062R2)                                * 95030002
*                                                                     * 95110002
*********************************************************************** 95190002
         SPACE                                                          95270002
DETFRRWA DSECT                                                          95350002
DETFRRW1 DS    0F                      WORD 1                           95430002
DETFRRF1 DS    C                       FLAGS                            95510002
DETECB   EQU   X'80'                   1 - ECB VALIDITY CHECK ATTEMPT   95590002
DETEOT   EQU   X'40'                   1 - END OF TASK BRANCH ENTRY     95670002
DETCOMPL EQU   X'20'                   1 - ECB, ETXR PROCESS COMPLETED  95750002
DETEOT2  EQU   X'10'                   1 - INVALID ECB AT EOT TIME      95830002
*                                      BITS 4-7 RESERVED                95910002
         DS    AL3                     RESERVED                         95990002
DETFRRW2 DS    0F                      WORD 2                           96070002
DETOTC   DS    A                       ADDRESS OF MOTHER TCB, EOT ENTRY 96150002
DETFRRW3 DS    0F                      WORD 3                           96230002
DETWKPTR DS    A                       DETACH WORKAREA ADDRESS          96310002
DETFRRW4 DS    F                       WORD 4                           96390002
DETFRRW5 DS    F                       WORD 5                           96470002
DETFRRW6 DS    F                       WORD 6                           96550002
         SPACE 2                                                        96630002
         END                                                            96710002
./  ADD  SSI=81920353,NAME=IEAVENQ1
         TITLE 'IEAVENQ1 - ENQ/DEQ/RESERVE'                             00030502
IGC048   CSECT                                                          00030702
* /* START OF SPECIFICATIONS ****                                       00031003
*                                                                       00033502
*01*  MODULE-NAME = IEAVENQ1                                            00034002
*                                                                       00034502
*02*     CSECT-NAME = IGC048                                            00035002
*                                                                       00035502
*01*  DESCRIPTIVE-NAME = ENQ/DEQ/RESERVE                                00036002
*                                                                       00036502
*01*  COPYRIGHT = NONE                                                  00037002
*                                                                       00037502
*01*  STATUS = 0                                                        00038002
*                                                                       00038502
*01*  FUNCTION                                                          00039002
*                                                                       00039502
*             THE ENQ/DEQ ROUTINE PERMITS THE SERIALIZATION OF ONE      00040002
*             OR MORE NAMED RESOURCES. AS A MINOR FUNCTION, THIS        00040402
*             ROUTINE MAY ALSO ESTABLISH A 'MUST COMPLETE' STATUS       00040802
*             AFFECTING THE DISPATCHABILITY OF VARIOUS TASKS IN         00041202
*             THE SYSTEM. THIS LATTER SERVICE IS AVAILABLE ONLY         00041602
*             TO PROGRAMS WHICH RUN WITH A CONTROL PROGRAM KEY          00042002
*             (I.E. KEY 0-7), SUPERVISOR STATE, OR AUTHORIZED           00042402
*             (VIA APF).                                                00042802
*                                                                       00043502
*             THE SHARED DASD FUNCTION IS SUPPORTED THROUGH THE         00043602
*             USE OF RESERVE/DEQ.                                       00043702
*                                                                       00043802
*             THE ENQ RESOURCE MANAGER (MANUAL PURGE) PERFORMS          00043902
*             CLEAN-UP FUNCTION FOR END OF TASK, ADDRESS SPACE          00044102
*             ABEND, AND OUT OF CORE ABEND.                             00044302
*                                                                       00044502
*02*     OPERATION = SEE METHOD OF OPERATION DIAGRAMS OR                00045002
*                    FLOWCHARTS                                         00045102
*                                                                       00045202
*01*   NOTES = THE HEAD OF THE ENQ/DEQ RESOURCE QUEUE IS POINTED        00045502
*              BY CVTFQCB AND ALL MAJOR QCBS, MINOR QCBS, AND QELS      00045702
*              ARE FORWARD AND BACKWARD CHAINED.                        00045902
*                                                                       00046102
*02*     DEPENDENCIES = THIS MODULE DOES NOT CONTAIN ANY                00046502
*                       HARDWARE DEPENDENCIES.                          00047002
*                                                                       00048002
*                       IN ORDER TO REDUCE SQA (SUBPOOL 245)   @Z30BNVD 00048203
*                       FRAGMENTATION, NIP OBTAINS AND         @Z30BNVD 00048503
*                       INITIALIZES A BLOCK OF STORAGE FOR     @Z30BNVD 00048603
*                       ENQ/DEQ/RESERVE RESOURCE CONTROL       @Z30BNVD 00048703
*                       BLOCKS. ADDITIONALLY, NIP WILL         @Z30BNVD 00049003
*                       UPDATE THE RESPECTIVE QUEUE LIMIT      @Z30BNVD 00049103
*                       COUNTS WITHIN THIS MODULE TO REFLECT   @Z30BNVD 00049203
*                       THE NUMBER OF ELEMENTS IT HAS PLACED   @Z30BNVD 00049303
*                       ON THESE QUEUES. THE LIMIT COUNTS      @Z30BNVD 00049503
*                       ARE LOCATED AT ENTRY LABEL IEAVENQQ    @Z30BNVD 00049703
*                       AND ARE A TOTAL OF 6 WORDS. NIP WILL   @Z30BNVD 00050003
*                       ALSO INITIALIZE THE FOLLOWING DATA     @Z30BNVD 00050103
*                       WITHIN THE ENQ/DEQ/RESERVE GLOBAL      @Z30BNVD 00050203
*                       SAVE AREA (GS):                        @Z30BNVD 00050303
*                          - AT X'80', 6 WORDS DEFINING THE    @Z30BNVD 00050403
*                            RESPECTIVE QUEUE ELEMENT          @Z30BNVD 00050503
*                            COUNTS.                           @Z30BNVD 00050603
*                          - AT X'98', 6 WORDS DEFINING THE    @Z30BNVD 00050703
*                            POINTERS TO THE RESPECTIVE        @Z30BNVD 00050803
*                            QUEUE HEADS                       @Z30BNVD 00050903
*                          - AT X'B0', 1 WORD CONTAINING       @Z30BNVD 00051003
*                            THE BEGINNING ADDRESS OF THE      @Z30BNVD 00051103
*                            BLOCK                             @Z30BNVD 00051203
*                          - AT X'B4', 1 WORD CONTAINING       @Z30BNVD 00051303
*                            THE ENDING ADDRESS OF THE         @Z30BNVD 00051403
*                            BLOCK                             @Z30BNVD 00051503
*03*        CHARACTER-CODE-DEPENDENCIES = THIS MODULE IS NOT            00051603
*                                         CHARACTER CODE                00051703
*                                                                       00051803
*02*     RESTRICTIONS = NONE                                            00052003
*                                                                       00052103
*02*     REGISTER-CONVENTIONS = REFER TO 'REGISTER EQUATES'             00052203
*                               PORTION OF THIS MODULE.                 00052303
*                                                                       00052403
*02*     PATCH-LABEL = NONE WITHIN THIS MODULE. THE COMMON              00052502
*                      NUCLEUS MAINTENANCE AREA SHOULD BE               00052702
*                      USED (IEAPATCH).                                 00052902
*                                                                       00053102
*01*  MODULE-TYPE = MODULE                                              00053502
*                                                                       00054002
*02*     PROCESSOR = ASSEMBLER                                          00054502
*                                                                       00055002
*02*     MODULE-SIZE = APPROXIMATELY 7500 BYTES                         00055502
*                                                                       00056002
*02*     ATTRIBUTES = TYPE 2 SVC, KEY 0,                                00056502
*                     SUPERVISOR STATE, ENABLED                         00057002
*                                                                       00057502
*01*  ENTRY-POINT = IGC048 (DEQ)                                        00058002
*                                                                       00058502
*02*     PURPOSE = THIS IS THE OTHER HALF OF THE ENQ/RESERVE            00059002
*                  FUNCTION. IT RELINQUISHES THE SERIALIZATION          00059502
*                  OBTAINED VIA ENQ/RESERVE.                            00060002
*                                                                       00060502
*02*     LINKAGE = VIA SVC INTERRUPT HANDLER (TYPE 2 SVC)               00061002
*                                                                       00061502
*02*     INPUT = REGISTERS                                              00062002
*                  0    - IRRELEVANT                                    00062502
*                  1    - ADDRESS OF VARIABLE LENGTH                    00063002
*                         PARAMETER ELEMENT LIST                        00063502
*                  2    - IRRELEVANT                                    00064002
*                  3    - ADDRESS OF CVT                                00064502
*                  4    - ADDRESS OF CURRENT TCB                        00065002
*                  5    - ADDRESS OF CURRENT RB                         00065502
*                  6    - ENTRY POINT ADDRESS                           00066002
*                  7    - ADDRESS OF CURRENT ASCB                       00066502
*                  8-13 - IRRELEVANT                                    00067002
*                  14   - EXIT ADDRESS                                  00067502
*                  15   - IRRELEVANT                                    00068002
*                                                                       00068502
*                PARAMETER ELEMENT LIST                                 00069002
*                                                                       00069502
*                **********************************************         00070002
*             -4 * TCB POINTER OR DOES NOT EXIST              *         00070502
*                **********************************************         00071002
*             +0 * FLAGS1 * MINOR LENGTH * FLAGS2 * RET. CODE *         00071502
*                **********************************************         00072002
*             +4 * ADDRESS OF MAJOR NAME                      *         00072502
*                **********************************************         00073002
*             +8 * ADDRESS OF MINOR NAME                      *         00073502
*                **********************************************         00074002
*            +12 * ADDRESS OF UCB ADDRESS OR DOES NOT EXIST   *         00074502
*                **********************************************         00075002
*                                                                       00075502
*                NOTE: NON-RESERVE ELEMENTS ARE 3 WORDS IN              00076002
*                      LENGTH, WHILE RESERVE ELEMENTS ARE               00076502
*                      4 WORDS IN LENGTH. IN A MULTIPLE                 00077002
*                      ELEMENT PARAMETER LIST, ELEMENTS ARE             00077502
*                      CONTIGUOUS STARTING AT OFFSET +0                 00078002
*                                                                       00078502
*                      FLAGS1   BIT 0 - END OF LIST                     00079002
*                               BIT 1 - IGNORE FOLLOWING BITS           00079502
*                               BIT 2 - RESERVED                        00080002
*                               BIT 3 - IRRELEVANT (OUTPUT FROM ENQ)    00080502
*                               BIT 4 - RESERVED                        00081002
*                               BIT 5 - RESERVED                        00081502
*                               BIT 6 - GENERIC=YES SPECIFIED           00082002
*                               BIT 7 - TCB= SPECIFIED                  00082502
*                                                                       00083002
*                      FLAGS2   BIT 0 - USED BY ENQ/RESERVE ONLY        00083502
*                               BIT 1 - SEE NOTE A                      00084002
*                               BIT 2 - OBSOLETE PARAMETER              00084502
*                                       (RMC=SYSTEM)                    00085002
*                               BIT 3 - RMC=STEP SPECIFIED              00085502
*                               BIT 4 - SEE NOTE A                      00086002
*                               BIT 5 - SEE NOTE B                      00086502
*                               BIT 6 - SEE NOTE B                      00087002
*                               BIT 7 - SEE NOTE B                      00087502
*                                                                       00088002
*                      NOTE A   00 - SCOPE OF STEP                      00088502
*                               01 - UCB= SPECIFIED                     00089002
*                                    (SYSTEMS REQUIRED)                 00089502
*                               10 - SCOPE OF SYSTEM                    00090002
*                               11 - SCOPE OF SYSTEMS                   00090502
*                                                                       00091002
*                      NOTE B   000 - RET=NONE SPECIFIED                00091502
*                               001 - RET=HAVE SPECIFIED                00092002
*                               010 - USED BY ENQ/RESERVED ONLY         00092502
*                               011 - USED BY ENQ/RESERVED ONLY         00093002
*                               100 - USED BY ENQ/RESERVED ONLY         00093502
*                               101 - RESERVED                          00094002
*                               110 - RESERVED                          00094502
*                               111 - USED BY ENQ/RESERVE ONLY          00100002
*                                                                       00100502
*02*     OUTPUT = ELEMENT(S) REMOVED FROM RESOURCE QUEUE AND            00101002
*                 MUST COMPLETE STATE REMOVED WHEN REQUESTED.           00101502
*                                                                       00102002
*                 REGISTER 0-1  - UNPREDICTABLE                         00102502
*                          2-13 - SAME AS AT ENTRY                      00103002
*                                 (RESTORED WHEN REDISPATCHED)          00103502
*                          14   - UNPREDICTABLE                         00104002
*                          15   - ZERO (ALL RETURN CODES ZERO)          00104502
*                                 OR                                    00105002
*                                 PARAMETER LIST POINTER (AT            00105502
*                                 LEAST ONE NON-ZERO RETURN CODE)       00106002
*                                                                       00106502
*                          EACH RETURN CODE IS PLACED IN                00107002
*                          THE RETURN CODE FIELD OF EACH                00107502
*                          PARAMETER LIST ELEMENT, OFFSET +3            00108002
*                          INTO EACH ELEMENT (SEE DIAGRAM)              00108502
*                                                                       00109002
*                          RETURN CODES POSSIBLE FOR                    00109502
*                                                                       00110002
*                             RET=NONE   N/A                            00110502
*                             RET=HAVE   0 - SUCCESSFUL RELEASE         00112002
*                                        4 - NOT RELEASED,              00112502
*                                            RESOURCE IS                00113002
*                                            BEING WAITED FOR           00113502
*                                        8 - NOT FOUND                  00114002
*                             GENERIC &                                 00114502
*                             RET=HAVE   0 - RELEASED ALL               00115002
*                                        4 - N/A                        00115202
*                                        8 - NONE FOUND                 00115502
*                                                                       00116002
*02*     REGISTERS-SAVED = NONE (SAVED BY SVC INTERRUPT HANDLER)        00116502
*                                                                       00117002
*02*     REGISTER-USAGE = REFER TO 'REGISTER EQUATES' PORTION           00117502
*                         OF THIS MODULE                                00118002
*                                                                       00118502
*02*     REGISTERS-RESTORED = NONE (RESTORED AT EXIT TIME)              00119002
*                                                                       00119502
*01*  ENTRY-POINT = IGC056 (ENQ)                                        00120002
*                                                                       00120502
*02*     PURPOSE = PROVIDE SERIALIZATION OF A RESOURCE THROUGH          00121002
*                  THE PROPER USE OF PRE-SELECTED NAMES. BASICAL-       00121502
*                  LY THE CALLER, AFTER ISSUING THE ENQ/RESERVE         00122002
*                  SVC, WILL EITHER RECEIVE CONTROL BACK                00122502
*                  IMMEDIATELY OR WILL WAIT UNTIL ANOTHER               00123002
*                  REQUESTOR RELINQUISHES CONTROL OF THE                00123502
*                  RESOURCE VIA THE DEQ SERVICE ROUTINE.                00124002
*                                                                       00124502
*02*     LINKAGE = VIA SVC INTERRUPT HANDLER (TYPE 2 SVC)               00125002
*                                                                       00125502
*02*     INPUT = REGISTERS - SAME AS AT ENTRY POINT IGC048              00126002
*                                                                       00126502
*                PARAMETER ELEMENT LIST                                 00127002
*                                                                       00127502
*                **********************************************         00127640
*             -8 * TCB PTR IF ECB ALSO CODED OR DOESN'T EXIST  @ZA14267 00127740
*                **********************************************         00128002
*             -4 * ECB POINTER OR TCB PTR. OR DOES NOT EXIST  *         00128502
*                **********************************************         00129002
*             +0 * FLAGS1 * MINOR LENGTH * FLAGS2 * RET. CODE *         00129502
*                **********************************************         00130002
*             +4 * ADDRESS OF MAJOR NAME                      *         00130502
*                **********************************************         00131002
*             +8 * ADDRESS OF MINOR NAME                      *         00131502
*                **********************************************         00132002
*            +12 * ADDR. OF UCB ADDR.(RESERVE ONLY) OR ABSENT *         00132502
*                **********************************************         00133002
*                                                                       00133502
*                NOTE: NON-RESERVE ELEMENTS ARE 3 WORDS IN              00134002
*                LENGTH, WHILE RESERVE ELEMENTS ARE 4 WORDS             00134502
*                IN LENGTH. IN A MULTIPLE ELEMENT PARAMETER             00135002
*                LIST, ELEMENTS ARE CONTIGUOUS STARTING AT              00135502
*                OFFSET +0                                              00136002
*                                                                       00136502
*                FLAGS1   BIT 0 - END OF LIST INDICATOR                 00137002
*                         BIT 1 - IGNORE FOLLOWING BITS                 00137502
*                         BIT 2 - RESERVED                              00138002
*                         BIT 3 - IRRELEVANT (POTENTIAL OUTPUT)         00138502
*                         BIT 4 - RESERVED                              00139002
*                         BIT 5 - RESERVED                              00139502
*                         BIT 6 - RESERVED (USED BY DEQ ONLY)           00140002
*                         BIT 7 - TCB= SPECIFIED                        00140502
*                                                                       00141002
*                FLAGS2   BIT 0 - 0=EXCLUSIVE,1=SHARE                   00141502
*                         BIT 1 - SEE NOTE A                            00142002
*                         BIT 2 - OBSOLETE (SMC=SYSTEM SPECIFIED)       00142502
*                         BIT 3 - SMC=STEP SPECIFIED                    00143002
*                         BIT 4 - SEE NOTE A                            00143502
*                         BIT 5 - SEE NOTE B                            00144002
*                         BIT 6 - SEE NOTE B                            00144502
*                         BIT 7 - SEE NOTE B                            00145002
*                                                                       00145502
*                NOTE A   00 - SCOPE OF STEP                            00146002
*                         01 - UCB= SPECIFIED                           00146502
*                              (SYSTEMS REQUIRED)                       00147002
*                         10 - SCOPE OF SYSTEM                          00147502
*                         11 - SCOPE OF SYSTEMS                         00148002
*                                                                       00148502
*                NOTE B   000 - RET=NONE SPECIFIED                      00149002
*                         001 - RET=HAVE SPECIFIED                      00149502
*                         010 - RET=CHNG SPECIFIED                      00150002
*                         011 - RET=USE SPECIFIED                       00150502
*                         100 - ECB= SPECIFIED                          00151002
*                         101 - RESERVED                                00151502
*                         110 - RESERVED                                00152002
*                         111 - RET=TEST SPECIFIED                      00152202
*                                                                       00152502
*02*     OUTPUT = NORMALLY, ELEMENT OBTAINED, INITIALIZED,              00153002
*                 AND PLACED IN RESOURCE QUEUE                          00153502
*                                                                       00154002
*                 REGISTERS 0-1  - UNPREDICTABLE                        00154502
*                           2-13 - SAME AS AT ENTRY                     00155002
*                                  (RESTORED WHEN REDISPATCHED)         00155502
*                           14   - UNPREDICTABLE                        00156002
*                           15   - ZERO (ALL RETURN CODES ZERO)         00156502
*                                  OR                                   00157002
*                                  PARAMETER LIST POINTER (AT           00157502
*                                  LEAST ONE NON-ZERO RETURN CODE)      00158002
*                                                                       00158502
*                        EACH RETURN CODE IS PLACED                     00159002
*                        IN THE RETURN CODE FIELD                       00159502
*                        OF EACH PARAMETER LIST                         00160002
*                        ELEMENT, OFFSET +3 INTO                        00160502
*                        EACH ELEMENT (SEE DIAGRAM)                     00161002
*                                                                       00161502
*                        POSSIBLE RETURN CODES FOR                      00162002
*                                                                       00162202
*                           RET=NONE   0 - RESOURCE OBTAINED            00162502
*                                      4 - N/A                          00163002
*                                      8 - N/A                          00163502
*                                     20 - N/A                          00164002
*                           RET=TEST   0 - RESOURCE IS AVAILABLE        00165502
*                                      4 - RESOURCE NOT AVAILABLE       00165602
*                                      8 - TASK ALREADY OWNS            00165702
*                                          RESOURCE                     00165802
*                                     20 - TASK IS WAITING              00165902
*                                          FOR RESOURCE                 00166002
*                           RET=USE    0 - RESOURCE OBTAINED            00166102
*                                      4 - RESOURCE NOT AVAILABLE       00166202
*                                      8 - TASK ALREADY OWNS            00166302
*                                          RESOURCE                     00166502
*                                     20 - TASK IS WAITING              00166602
*                                          FOR RESOURCE                 00166702
*                           RET=HAVE   0 - RESOURCE OBTAINED            00166802
*                                      4 - N/A                          00167002
*                                      8 - TASK ALREADY OWNS            00167102
*                                          RESOURCE                     00167202
*                                     20 - TASK IS WAITING              00167502
*                                          FOR RESOURCE                 00168002
*                           RET=CHNG   0 - EXCLUSIVE CONTROL            00168502
*                                      4 - CURRENTLY SHARING            00169002
*                                      8 - NOT IN QUEUE                 00169502
*                                     20 - TASK IS WAITING              00170002
*                                          FOR RESOURCE                 00170502
*                           ECB=       0 - RESOURCE OBTAINED,           00171002
*                                          DO NOT WAIT, ECB             00171502
*                                          WILL NOT BE POSTED           00172002
*                                      4 - WAIT FOR POST                00172502
*                                      8 - TASK ALREADY OWNS            00173002
*                                          RESOURCE                     00173502
*                                     20 - TASK IS WAITING              00174002
*                                          FOR RESOURCE                 00174502
*                                                                       00175002
*                           NOTE: RETURN CODES 12 AND 16 HAVE           00175502
*                                 BECOME OBSOLETE                       00176002
*                                                                       00176502
*                 DATA - WHEN A RETURN CODE 8 (MEANING TASK             00176602
*                        ALREADY OWNS RESOURCE) IS PASSED BACK,         00176702
*                        THE FORTH BIT (X'10') OF THE PARAMETER         00176802
*                        LIST IDENTIFYING THE OWNED RESOURCE REFLECTS   00176902
*                        WHETHER THE TASK HAS EXCLUSIVE CONTROL         00177002
*                        (BIT OFF) OR SHARED CONTROL (BIT ON).          00177102
*                                                                       00177202
*02*     REGISTERS-SAVED = NONE (SAVED BY SVC INTERRUPT HANDLER)        00177302
*                                                                       00177502
*02*     REGISTER-USAGE = REFER TO 'REGISTER EQUATES' PORTION           00178002
*                         OF THIS MODULE                                00178502
*                                                                       00179002
*02*     REGISTERS-RESTORED = NONE (RESTORED AT EXIT TIME)              00179502
*                                                                       00180002
*01*  ENTRY-POINT = IEAVENQ2 (RESOURCE MANAGER)                         00180502
*                                                                       00181002
*02*     PURPOSE = CLEAN UP AFTER AN ABEND OR AT END OF TASK            00181502
*                  TIME. AT EITHER NORMAL OR ABNORMAL TASK              00182002
*                  TERMINATION, ALL REQUESTS MADE BY THIS               00182502
*                  TASK WILL BE DEQUEUED. FOR MEMORY                    00183002
*                  TERMINATION, ALL REQUESTS MADE BY THIS               00183502
*                  ADDRESS SPACE WILL BE DEQUEUED. A MUST               00184002
*                  COMPLETE TERMINATION WILL BE DONE THE                00184502
*                  SAME WAY, EXCEPT THAT THE OPERATOR WILL              00185002
*                  BE NOTIFIED OF THE EXCLUSIVE-SYSTEM(S)               00185502
*                  WIDE RESOURCES DEQUEUED.                             00186002
*                                                                       00186502
*02*     LINKAGE = BRANCH ENTERED (CVTRENQ)                             00187002
*                                                                       00187502
*02*     INPUT = REGISTERS                                              00188002
*                  0 - IRRELEVANT                                       00188502
*                  1 - INDIRECT POINTER TO RESOURCE MANAGER             00189002
*                      LIST (IHARMPL)                                   00189502
*                  2-12 - IRRELEVANT                                    00190002
*                  13 - ADDRESS OF 72 BYTE SAVE AREA                    00190502
*                  14 - IRRELEVANT                                      00191002
*                  15 - IRRELEVANT                                      00191502
*                                                                       00192002
*                DATA                                                   00192502
*                  IHARMPL  +0 FLAGS AND ASID                           00193002
*                           +4 ASCB ADDRESS                             00193502
*                           +8 TCB ADDRESS OR ZERO                      00194002
*                          +12 BEGINNING OF WORK AREA                   00194502
*                              (12 WORDS) FOR RESOURCE                  00195002
*                              MANAGER USE                              00195502
*                                                                       00196002
*02*     OUTPUT = POSSIBLE RELEASE OF ENQUEUED RESOURCES                00196502
*                                                                       00197002
*                 REGISTERS 0-14 - SAME AS AT ENTRY                     00197502
*                           15   - RETURN CODE (0-SUCCESSFUL,           00198002
*                                  4-UNSUCCESSFUL)                      00198502
*                                                                       00199002
*                 DATA - NONE                                           00199502
*                                                                       00200002
*02*     REGISTERS-SAVED = ALL REGISTERS SAVED IN SUPPLIED              00200502
*                          SAVE AREA (INPUT REGISTER 13)                00201002
*                                                                       00201502
*02*     REGISTER-USAGE = REFER TO 'REGISTER EQUATES' PORTION           00202002
*                         OF THIS MODULE                                00202502
*                                                                       00203002
*02*     REGISTERS-RESTORED = ALL REGISTERS RESTORED FROM               00203502
*                             SUPPLIED SAVE AREA                        00204002
*                                                                       00204502
*01*  ENTRY-POINT = IEAVSRR1 (ERROR RECOVERY)                           00205002
*                                                                       00205502
*02*     PURPOSE = INSURE ENQ/DEQ/RESERVE IS STILL FUNCTIONAL           00206002
*                  BY VERIFYING/FIXING RESOURCE QUEUES. PLUS,           00206502
*                  SUPPLY ADDITIONAL ERROR DIAGNOSTIC                   00207002
*                  INFORMATION                                          00207502
*                                                                       00208002
*02*     LINKAGE = RTM DOES A LPSW OF THIS ENTRY POINT                  00208502
*                  ADDRESS                                              00209002
*                                                                       00209502
*02*     INPUT = REGISTERS                                              00210002
*                  0 - IRRELEVANT                                       00210502
*                  1 - ADDRESS OF SDWA                                  00211002
*                  2-13 - IRRELEVANT                                    00211502
*                  14 - RETURN ADDRESS                                  00212002
*                  15 - ENTRY POINT ADDRESS                             00212502
*                                                                       00213002
*02*     OUTPUT = GOOD RESOURCE QUEUES AND SDWA MODIFIED                00213502
*                 TO REFLECT ADDITIONAL DIAGNOSTIC/RETRY                00214002
*                 INFORMATION                                           00214502
*                                                                       00215002
*                 REGISTERS 0 - IRRELEVANT                              00215502
*                           1 - ADDRESS OF SDWA                         00216002
*                           2-13 - IRRELEVANT                           00216502
*                           14 - RETURN ADDRESS                         00217002
*                           15 - RETURN CODE (0-CONTINUE                00217502
*                                WITH TERMINATION, 4-RETRY)             00218002
*                                                                       00218502
*02*     REGISTERS-SAVED = SDWA ADDRESS(REG 1) AND RETURN               00219002
*                          ADDRESS(REG 14) ARE SAVED IN                 00219502
*                          ENQ/DEQ GLOBAL SAVE AREA                     00220002
*                                                                       00220502
*02*     REGISTER-USAGE = REFER TO 'REGISTER EQUATES'                   00221002
*                         PORTION OF THIS MODULE                        00221502
*                                                                       00222002
*02*     REGISTERS-RESTORED = SDWA ADDRESS(REG 1) AND                   00222502
*                             RETURN ADDRESS(REG 14) ARE                00223002
*                             RESTORED FROM ENQ/DEQ                     00223502
*                             GLOBAL SAVE AREA                          00224002
*                                                                       00224502
*01*  ENTRY-POINT = ENQXRTRY (ENQ RETRY)                                00225002
*                                                                       00225502
*02*     PURPOSE = PERFORM NORMAL ENQ END PROCESSING,                   00226002
*                  DETERMINE ABEND CODE, AND INVOKE ABEND               00226502
*                                                                       00227002
*02*     LINKAGE = VIA RTM WHEN AN ERROR HAS OCCURRED AND               00227502
*                  RETRY HAS BEEN REQUESTED                             00228002
*                                                                       00228502
*02*     INPUT = REGISTERS                                              00229002
*                  0-4 - IRRELEVANT                                     00229502
*                  5 - ADDRESS OF CURRENT RB                            00230002
*                  6 - FIRST BASE REGISTER                              00230502
*                  7 - SECOND BASE REGISTER                             00231002
*                  8-15 - IRRELEVANT                                    00231502
*                                                                       00232002
*02*     OUTPUT = AN ABEND                                              00232502
*                                                                       00233002
*                  REGISTERS 0 - ABEND FLAGS                            00233502
*                            1 - ABEND CODE                             00234002
*                            2-15 - IRRELEVANT                          00234502
*                                                                       00235002
*02*     REGISTERS-SAVED = NONE                                         00235502
*                                                                       00236002
*        REGISTER-USAGE = REFER TO 'REGISTER EQUATES'                   00236502
*                         PORTION OF THIS MODULE                        00237002
*                                                                       00237502
*02*     REGISTERS-RESTORED = NONE                                      00238002
*                                                                       00238502
*01*  ENTRY-POINT = DEQXRTRY (DEQ RETRY)                                00239002
*                                                                       00239502
*02*     PURPOSE = PERFORM NORMAL DEQ END PROCESSING,                   00240002
*                  DETERMINE, ABEND CODE, AND INVOKE ABEND              00240502
*                                                                       00241002
*02*     LINKAGE = VIA RTM WHEN AN ERROR HAS OCCURRED AND               00241502
*                  RETRY HAS BEEN REQUESTED                             00242002
*                                                                       00242502
*02*     INPUT = REGISTERS                                              00243002
*                  0-4 - IRRELEVANT                                     00243502
*                  5 - ADDRESS OF CURRENT RB                            00244002
*                  6 - FIRST BASE REGISTER                              00244502
*                  7 - SECOND BASE REGISTER                             00245002
*                  8-15 - IRRELEVANT                                    00245502
*                                                                       00246002
*02*     OUTPUT = AN ABEND                                              00246502
*                                                                       00247002
*                 REGISTERS 0 - ABEND FLAGS                             00247502
*                           1 - ABEND CODE                              00248002
*                           2-15 IRRELEVANT                             00248502
*                                                                       00249002
*02*     REGISTERS-SAVED = NONE                                         00249502
*                                                                       00250002
*02*     REGISTER-USAGE = REFER TO 'REGISTER EQUATES'                   00250502
*                         PORTION OF THIS MODULE                        00251002
*                                                                       00251502
*02*     REGISTERS-RESTORED = NONE                                      00252002
*                                                                       00252502
*01*  ENTRY-POINT = XSTARTIO (CODE EXECUTED UNDER SRB)                  00253002
*                                                                       00253502
*02*     PURPOSE = RELEASE SRB/IOSB STORAGE WHEN I/O COMPLETE.          00254002
*                  THIS I/O HAS RELEASED A RESERVED DEVICE.             00254502
*                                                                       00255002
*02*     LINKAGE = VIA SRB DISPATCHER                                   00255502
*                                                                       00256002
*02*     INPUT = REGISTERS                                              00256502
*                  0 - IRRELEVANT                                       00257002
*                  1 - ADDRESS OF STORAGE TO BE FREED                   00257502
*                  2-13 - IRRELEVANT                                    00258002
*                  14 - EXIT ADDRESS                                    00258502
*                  15 - ENTRY POINT ADDRESS                             00259002
*                                                                       00259502
*02*     OUTPUT = REGISTERS - IRRELEVANT                                00260002
*                                                                       00260502
*02*     REGISTERS-SAVED = NONE                                         00261002
*                                                                       00261502
*02*     REGISTER-USAGE = REFER TO 'REGISTER EQUATES'                   00262002
*                         PORTION OF THIS MODULE                        00262502
*                                                                       00263002
*02*     REGISTERS-RESTORED = NONE                                      00263502
*                                                                       00264002
*01*  EXIT-NORMAL = TEST4 (MAINLINE DEQ EXIT)                           00264502
*                                                                       00265002
*02*     CONDITIONS = FUNCTION COMPLETED, RETURN TO                     00265502
*                     CALLER VIA BRANCHING TO ADDRESS                   00266002
*                     IN REGISTER 14 AT ENTRY                           00266502
*                                                                       00267002
*02*     OUTPUT = SEE OUTPUT FOR ENTRY POINT - IGC048                   00267502
*                                                                       00268002
*02*     RETURN-CODES = SEE OUTPUT FOR ENTRY POINT - IGC048             00268102
*                                                                       00268202
*01*  EXIT-NORMAL = TEST11 (MAINLINE ENQ EXIT)                          00268502
*                                                                       00269002
*02*     CONDITIONS = FUNCTION COMPLETED, RETURN TO                     00269502
*                     CALLER VIA BRANCHING TO ADDRESS                   00270002
*                     IN REGISTER 14 AT ENTRY                           00270502
*                                                                       00271002
*02*     OUTPUT = SEE OUTPUT FOR ENTRY POINT - IGC056                   00271502
*                                                                       00272002
*02*     RETURN-CODES = SEE OUTPUT FOR ENTRY POINT - IGC056             00272502
*                                                                       00273002
*01*  EXIT-NORMAL = ERMNWTO1 (MAINLINE RESOURCE MANAGER EXIT)           00273502
*                                                                       00274002
*02*     CONDITIONS = FUNCTION COMPLETED, RETURN TO                     00274502
*                     CALLER VIA BRANCHING TO ADDRESS                   00275002
*                     IN REGISTER 14 AT ENTRY                           00275502
*                                                                       00276002
*02*     OUTPUT = POSSIBLE RELEASE OF ENQUEUED RESOURCES                00276502
*                FOR TASK TERMINATING                                   00277002
*                                                                       00277502
*                 REGISTERS 0-14 - SAME AS AT ENTRY                     00278002
*                           15   - RETURN CODE                          00278502
*                                                                       00279002
*                DATA - NONE                                            00279502
*                                                                       00280002
*02*     RETURN-CODES = 0 - SUCCESSFUL                                  00280502
*                       4 - UNSUCCESSFUL                                00281002
*                                                                       00281502
*01*  EXIT-NORMAL = TEST62C (MAINLINE EXIT FOR CODE EXECUTING           00282002
*                            UNDER SRB DURING RELEASE OF A              00282502
*                            DEVICE)                                    00283002
*                                                                       00283502
*02*     CONDITIONS = FUNCTION COMPLETED, EXIT VIA                      00284002
*                     BRANCHING TO THE ADDRESS CONTAINED                00284502
*                     IN REGISTER 14 AT ENTRY                           00285002
*                                                                       00285502
*02*     OUTPUT = REGISTERS - IRRELEVANT                                00286002
*                                                                       00286502
*02*     RETURN-CODES = NONE                                            00287002
*                                                                       00287502
*01*  EXIT-NORMAL = TEST20  (ERROR RECOVERY EXIT FOR                    00288002
*                           CONTINUING WITH TERMINATION)                00288502
*                                                                       00289002
*02*     CONDITIONS = FUNCTION COMPLETED, RETURN TO                     00289502
*                     CALLER VIA BRANCHING TO ADDRESS                   00290002
*                     CONTAINED IN REGISTER 14 AT ENTRY                 00290502
*                                                                       00291002
*02*     OUTPUT = NORMALLY - SDWA MODIFIED TO REFLECT                   00291502
*                                 FREE SDWA, RECORD,                    00292002
*                                 FREE LOCKS, AND                       00292502
*                                 ADDITIONAL DIAGNOSTIC INFO            00293002
*                                                                       00293502
*                 REGISTERS - 0    - IRRELEVANT                         00294002
*                             1    - ADDRESS OF SDWA                    00294502
*                             2-13 - IRRELEVANT                         00295002
*                             14   - RETURN ADDRESS                     00295502
*                             15   - ZERO (CONTINUE WITH                00296002
*                                    TERMINATION                        00296502
*                                                                       00297002
*02*     RETURN-CODES = 0 - CONTINUE WITH TERMINATION                   00297502
*                                                                       00298002
*01*  EXIT-NORMAL = TEST19M (ERROR RECOVERY EXIT FOR RETRY)             00298502
*                                                                       00299002
*02*     CONDITIONS = FUNCTION COMPLETED, RETURN TO                     00299502
*                     CALLER VIA BRANCHING TO ADDRESS                   00300002
*                     CONTAINED IN REGISTER 14 AT ENTRY                 00300502
*                                                                       00301002
*02*     OUTPUT = NORMALLY - SDWA MODIFIED TO REFLECT                   00301502
*                                 FREE SDWA, RECORD, RETRY,             00302002
*                                 RETRY REGISTERS, AND                  00302502
*                                 ADDITIONAL DIAGNOSTIC INFO            00303002
*                                                                       00303502
*                REGISTERS 0    - IRRELEVANT                            00304002
*                          1    - ADDRESS OF SDWA                       00304502
*                          2-13 - IRRELEVANT                            00305002
*                          14   - RETURN ADDRESS                        00305502
*                          15   - FOUR (RETRY)                          00306002
*                                                                       00306502
*02*     RETURN-CODES = 4 - RETRY                                       00307002
*                                                                       00307202
*01*  EXIT-ERROR = DEQYABND (ERROR EXIT FOR DEQ MAINLINE)               00307502
*                                                                       00308002
*02*     CONDITIONS = FUNCTION COMPLETE, ABEND CALLER VIA               00308502
*                     ABEND (SVC 13)                                    00309002
*                                                                       00309502
*02*     OUTPUT = REGISTERS 0    - ABEND FLAGS                          00310002
*                           1    - ABEND CODE                           00310502
*                           2-15 - IRRELEVANT                           00311002
*                                                                       00311502
*02*     RETURN-CODES = NONE                                            00312002
*                                                                       00312502
*01*  EXIT-ERROR = ENQYABND (ERROR EXIT FOR ENQ MAINLINE)               00313002
*                                                                       00313502
*02*     CONDITIONS = FUNCTION COMPLETE, ABEND CALLER                   00314002
*                     VIA ABEND (SVC 13)                                00314502
*                                                                       00315002
*02*     OUTPUT = REGISTERS 0    - ABEND FLAGS                          00315502
*                           1    - ABEND CODE                           00316002
*                           2-15 - IRRELEVANT                           00316502
*                                                                       00317002
*02*     RETURN-CODES = NONE                                            00317502
*                                                                       00318002
*01*  EXTERNAL-REFERENCES                                               00318502
*                                                                       00319002
*02*     ROUTINES       PURPOSE                  LINKAGE                00319502
*          ABEND          TERMINATE TASK           SVC                  00320002
*          FREEMAIN       FREE STORAGE             BRANCH               00320502
*          FREEMAIN       FREE STORAGE             SVC                  00321002
*          GETMAIN        OBTAIN STORAGE           BRANCH               00321502
*          POST           POST AN ECB              BRANCH               00322002
*          SETLOCK        OBTAIN LOCK              BRANCH               00322502
*          SPOST          PURGE SRBS               SVC                  00323002
*          STATUS         SET/RESET STEP MC        BRANCH               00323502
*          STARTIO        RELEASE DEVICE           BRANCH               00324002
*          SYSEVENT       RELEASE/HOLD RESOURCE    BRANCH               00324502
*          TESTAUTH       DETERMINE AUTHORIZATION  BRANCH               00325002
*          WAIT           WAIT FOR A POST          BRANCH               00325502
*          WTO            SEND OPERATOR MESSAGE    SVC                  00326002
*                                                                       00326502
*02*     DATA-AREAS = ENQ/DEQ GLOBAL SAVE AREA(GS) - WORK AREA          00327002
*                                                    SERIALIZED VIA     00327202
*                                                    CMS LOCK           00327502
*                     PARAMETER ELEMENT LIST(PEL) - REFLECT             00328002
*                                                   INPUT               00328502
*                                                   PARMS.              00329002
*                     RB EXTENDED SAVE AREA(WA) - WORK AREA             00329502
*                                                                       00330002
*02*     CONTROL-BLOCKS = ASCB      R,W                                 00330502
*                         ASVT      R                                   00331002
*                         ASXB      R                                   00331502
*                         CVT       R                                   00332002
*                         DQE       R                                   00332502
*                         FRRS      R                                   00333002
*                         FQE       R                                   00333502
*                         GDA       R                                   00334002
*                         IOCM      R                                   00334502
*                         IOSB  C,D,  W                                 00335002
*                         QCB   C,D,R,W                                 00335502
*                         PSA       R                                   00336002
*                         QEL   C,D,R,W                                 00336502
*                         RB        R,W                                 00337002
*                         RMPL      R                                   00337502
*                         SRB   C,D,  W                                 00338002
*                         SCVT      R                                   00338502
*                         SDWA      R,W                                 00339002
*                         SPQE      R                                   00339502
*                         TCB       R                                   00340002
*                         UCB       R,W                                 00340502
*                         WSAVT     R                                   00341002
*                                                                       00341502
*01*  TABLES = ENQ/DEQ GLOBAL SAVE AREA(GS) - SEE DSECT                 00342002
*              COMMENTARY FOR DESCRIPTION                               00342502
*                                                                       00343002
*01*  MACROS = ABEND                                                    00343502
*              FREEMAIN                                                 00344002
*              GETMAIN                                                  00344502
*              MODESET                                                  00345002
*              MODID                                                    00345502
*              SETFRR                                                   00346002
*              SETLOCK                                                  00346502
*              SPOST                                                    00347002
*              STARTIO                                                  00347502
*              SYSEVENT                                                 00348002
*              TESTAUTH                                                 00348502
*              WTO                                                      00349002
*                                                                       00349502
*02*     SERIALIZATION = RESOURCES ENQUEUED - NONE                      00350002
*                                                                       00350502
*                        LOCKS - LOCAL, CMS, AND SALLOC                 00351002
*                                                                       00351502
*01*  CHANGE-ACTIVITY = THIS MODULE HAS BEEN COMPLETELY                 00352002
*                       RE-WRITTEN. THE S/D CODE IS Y02752.             00352502
*                       THE FOLLOWING ADDITIONAL CHANGES HAVE           00352702
*                       BEEN MADE :                                     00354502
*                         Y02113 - N/A       - DCRR                     00354602
*                         Y02752 - N/A       - DCRR                     00354702
*                         YM01596 - 4/26/73 - CROSS ADDRESS SPACE       00354802
*                                             POST INTERFACE ERROR      00354902
*                         YM01991 - 6/27/73 - WRONG REGISTER FOR        00355002
*                                             SUB-QEL CHECK             00355202
*                         YM03340 - 10/9/73 - INTEGRITY ADDITIONAL      00356502
*                                             INFORMATION               00356602
*                         YM03564 - 10/9/73 - PERFORMANCE IMPROVEMENTS  00356702
*                         YM04188 - 11/2/73 - STARTIO MACRO ERROR       00356802
*                         YM04705 - 11/1/73 - ZERO RETURN CODE ERROR    00356902
*                                             FOR A LIST REQUEST AND    00357002
*                                             CLEAR HIGH BYTE OF UCB    00358002
*                                             ADDRESS PRIOR TO SAVING   00359002
*                         YM05430 - 11/6/73 - INCORRECT DATA BEING      00361002
*                                             RECORDED IN SDWA          00362002
*                         YA00805 - 07/1/74 - SHARED DASD               00362303
*                                             RESERVE/RELEASE SUPPORT   00362703
*                         Z30BNVD - 10/9/74 - SQA FRAGMENTATION         00363203
*                                             REDUCTION AND             00363803
*                                             INTELLIGENT WAIT          00364403
*                         ZA07146 - 10/2/75 - RTM SUPPORT TO FIX        00364540
*                                             INTRA ADDRESS SPACE       00364640
*                                             INTERLOCK PROBLEM         00364740
*                         ZA03873 - 12/2/75 - ESTAE COVERING WAIT       00364840
*                         Z40FPVD - 12/15/75 - ESTAE TO FAST ESTAE      00364940
*       ZA10756-CHANGE TO PERFORM RECORDING ONLY FOR AN        @ZA32935 00365040
*               UNEXPECTED ERROR.                              @ZA32935 00365140
*       ZA14267-ENHANCEMENT TO PERMIT ENQ WITH BOTH ECB AND    @ZA32935 00365240
*               TCB.                                           @ZA32935 00365340
*       ZA17306-CHANGE TO ISSUE ENQHOLD AND ENQRELSE SYSEVENTS @ZA32935 00365440
*               SO SRM WILL MAKE IT LESS LIKELY FOR ADDRESS    @ZA32935 00365540
*               SPACES TO BE SWAPPED OUT WHEN RESERVES ARE IN  @ZA32935 00365640
*               EFFECT.                                        @ZA32935 00365740
*       ZA20351-CHANGE TO PREVENT TCBQEL COUNTER FROM WRAPPING @ZA32935 00365840
*               AROUND.                                        @ZA32935 00365940
*       ZA32935-IEAVENQ1 WILL STEAL RESOURCES TO PREVENT       @ZA32935 00366040
*               INTERLOCKS IF TCBFA IS ON AND OTHER CONDITIONS @ZA32935 00366140
*               ARE MET. HOWEVER, IF AN ESTAE TERM EXIT OR     @ZA32935 00366240
*               TASK RESOURCE MANAGER OBTAINS A RESOURCE VIA   @ZA32935 00366340
*               ENQ AND LATER ISSUES ENQ RET=HAVE,SMC=STEP FOR @ZA32935 00366440
*               THE SAME RESOURCE, THE CURRENT STEALING LOGIC  @ZA32935 00366540
*               WILL CAUSE CONTROL OF THE RESOURCE TO BE LOST  @ZA32935 00366640
*               IF OTHER ENQ REQUESTS HAD BEEN QUEUED. THE FIX @ZA32935 00366740
*               IS TO SET A FLAG IN ANY QEL OBTAINED WHEN      @ZA32935 00366840
*               TCBFA IS ON. (TCBFA MEANS ABNORMAL TERMINATION @ZA32935 00366940
*               IS IN PROGRESS AND RETRY IS NOT POSSIBLE.)     @ZA32935 00367040
*               THEN, IEAVENQ1 WILL NOT STEAL                  @ZA32935 00368140
*               A RESOURCE WHICH WAS OBTAINED WHEN TCBFA WAS   @ZA32935 00368640
*               ON AND IS NOT OWNED BY THE REQUESTING TASK.    @ZA32935 00369140
*                                                                       00369640
*01*  MESSAGES = THE FOLLOWING MESSAGES ARE REQUESTED BY                00371503
*                ENQ/DEQ/RESERVE:                                       00373003
*                  IEA801I AAAAAAAAAAAAAAAA BB FAILED                   00374003
*                          WHILE IN STEP MUST COMPLETE                  00376503
*                          STATUS                                       00377503
*                                                                       00379502
*                          AAA... - JOBNAME STEPNAME                    00380503
*                                  OR UNIDENTIFIED TASK                 00382403
*                          BB - ST OR JS INDICATING                     00384003
*                               STEP OR JOBSTEP                         00384503
*                                                                       00386003
*                 IEA803I CC FAILED WHILE IN 'STEP MUST                 00388003
*                          COMPLETE' STATUS DUE TO DDDD                 00389003
*                                                                       00391003
*                          CC - ST OR JS INDICATING                     00393003
*                               STEP OR JOBSTEP                         00394003
*                          DDDD - S(SYSTEM)CODE OR                      00396003
*                                 U(USER)CODE                           00397003
*                                                                       00398003
*                  IEA960I ENQ/DEQ CONTROL QUEUES WERE                  00400003
*                          DAMAGED. RESTORATION ATTEMPTED               00402003
*                                                                       00403003
*                          THIS MESSAGE IS PRINTED WHEN                 00405003
*                          ENQ/DEQ/RESERVE CONTROL BLOCKS               00406003
*                          HAVE BEEN DAMAGED                            00408003
*                          (E.G. WILD STORE)                            00409003
*                                                                       00410003
*                  IEA961I RESOURCE NAMED QNAME,RNAME MAY               00412003
*                          BE DAMAGED                                   00413003
*                                                                       00415003
*                          THIS MESSAGE IS PRINTED WHEN                 00417003
*                          A TASK IS IN THE MUST COMPLETE               00418003
*                          STATE AND ABNORMALLY TERMINATES.             00420003
*                                                                       00421003
*01*  ABEND-CODES = ISSUED BY ENQ/RESERVE:                              00422003
*                     138 - TASK ALREADY HAD OR WAS WAITING             00424003
*                           FOR RESOURCE                                00426003
*                     238 - INVALID MINOR NAME LENGTH                   00427003
*                     338 - CALLER NOT AUTHORIZED FOR                   00429003
*                           FUNCTION                                    00430003
*                     438 - INVALID PARAMETER LIST                      00432003
*                     638 - OUT OF STORAGE                              00433003
*                     738 - UNEXPECTED ERROR                            00434003
*                     838 - ENQ DENIED DUE TO ENQ/DEQ/RESERVE           00436003
*                           RESOURCE CONTROL BLOCK DAMAGE               00437003
*                                                                       00439003
*                   ISSUED BY DEQ:                                      00441003
*                     130 - RESOURCE NOT FOUND                          00442003
*                     230 - INVALID MINOR NAME LENGTH                   00444003
*                     330 - CALLER NOT AUTHORIZED FOR                   00445003
*                           FUNCTION                                    00447003
*                     430 - INVALID PARAMETER LIST                      00448003
*                     530 - RESOURCE IS BEING WAITED UPON               00450003
*                     630 - OUT OF STORAGE                              00451003
*                     730 - UNEXPECTED ERROR                            00453003
*                                                                       00454003
**** END OF SPECIFICATIONS ***/                                         00456003
         SPACE                                                          00456203
* A-000000-999999                                               @Y02752 00457003
         ENTRY IEAVENQ1                                                 00459003
IEAVENQ1 EQU   IGC048         MODULE NAME                               00460003
         ENTRY IGC056                                                   00462003
         ENTRY IEAVENQ2                                                 00463003
         ENTRY IEAVENQQ                                        @Z30BNVD 00463503
         USING PSA,0          ADDRESSABILITY TO LOW CORE                00464003
         USING TCB,R4         TCB ADDRESSABILITY                        00466003
         USING RBSECT,R5      WORK AREA ADDRESSABILITY                  00467003
         USING IGC048,R6,R7                                             00469003
         USING PEL,R8                                                   00470003
         USING MAJ,R9                                                   00472003
         USING MIN,R10                                                  00473003
         USING QEL,R11                                                  00475003
         USING GS,R13         GLOBAL SAVE ADDRESSABILITY                00476003
         USING *,R6                                                     00478003
         LM    R6,R7,BASE     ESTABLISH BASE REGISTERS                  00480002
         USING IGC048,R6,R7                                             00510002
         MODID  BR=YES        IDENTIFY MODULE                           00570002
DEQID    EQU   *              *                                         00600002
         LA    R0,RETRYDEQ    INDEX OF RETRY ADDRESS                    00630002
         LA    R2,DEQFRR      GET ADDRESS OF RECOVERY ROUTINE           00660002
         BAL   R3,XSETUP      INITIALIZE ENVIRONMENT                    00690002
         CLI   WAERR,ZERO     Q. ABEND                                  00720002
         BNE   DEQYABN        A. YES.                                   00750002
* CHECK RESERVED BITS                                                   00780002
         TM    WAPLAST,PELRES1+PELSAVE+PELGEN1 Q. RESERVED     @YM03340 00810002
         BNZ   DEQYRESB       A. YES, RESERVED USED. ERROR              00840002
         TM    WAPFLAG,PELRET1+PELRET2+PELSYSMC Q. RESERVED             00870002
         BNZ   DEQYRESB       A. YES, RESERVED USED. ERROR              00900002
* CHECK FOR MILEN OF 0 (EXCLUDE GENERIC)                                00930002
         TM    WAPLAST,PELGEN2  Q. GENERIC                              00960002
         BO    DEQYGEN        A. YES, SKIP CHECK                        00990002
         TM    WAFLAG2,WABADMIL  Q. BAD MINOR LENGTH                    01020002
         BO    DEQYMIL0       A. YES, ERROR                             01050002
DEQYGEN  EQU   *              *                                         01080002
* CHECK TCB CONFLICTS                                                   01110002
         TM    WAPLAST,PELTCBF  Q. TCB SPECIFIED                        01140002
         BZ    DEQNDIR        A. NO, SKIP NEXT CHECK                    01170002
         TM    WAPFLAG,PELSTPMC  Q. SET MUST COMPLETE                   01200002
         BO    DEQYCONF       A. YES, CONFLICTING PARAMETERS            01230002
DEQNDIR  EQU   *              *                                         01260002
* CHECK GENERIC CONFLICTS                                               01290002
         TM    WAPLAST,PELGEN2  Q. GENERIC                              01320002
         BZ    DEQNGEN        A. NO, SKIP ADDITIONAL CHECKS             01350002
         TM    WAPFLAG,PELRET1+PELRET2+PELRET3  Q. RET=NONE(DEFAULT)    01380002
         BZ    DEQYCONF       A. YES, CONFLICTING PARAMETERS            01410002
         TM    WAPFLAG,PELSTPMC  Q. SET MUST COMPLETE                   01440002
         BO    DEQYCONF       A. YES CONFLICTING PARAMETERS             01470002
DEQNGEN  EQU   *              *                                         01500002
* CHECK IF AUTHORIZED                                                   01530002
         TM    WAFLAG2,WANOAUTH  Q. AUTHORIZED VIA TESTAUTH.            01560002
         BZ    DEQYAUTO       A. YES. SKIP AUTHORIZATION CHECKS.        01590002
* CHECK AUTHORIZATION FOR TCB,RMC,GENERIC                               01620002
         TM    WAPLAST,PELGEN2+PELTCBF  Q.TCB OR GENERIC SPECIFIED.     01650002
         BNZ   DEQNAUTH       A. YES. ABEND.                            01680002
         TM    WAPFLAG,PELSTPMC  Q. RMC KEYWORD SPECIFIED.              01710002
         BO    DEQNAUTH       A. YES . ABEND.                           01740002
DEQYAUTO EQU   *              *                                         01770002
         TM    WAPFLAG,PELSTPMC  Q. RMC SPECIFIED.                      01800002
         BZ    DEQNRMC        A. NO.                                    01830002
         OI    WAFLAG2,WARMC  INDICATE NEED FOR RESET MUST COMPLETE     01860002
DEQNRMC  EQU   *              *                                         01890002
DEQQPEL  EQU   *              *                                         01920002
         BAL   R3,XFINDMAJ    FIND A MATCHING MAJOR.                    01950002
         LTR   R9,R9          Q. FIND A MAJOR                           01980002
         BNP   DEQNMAJ        A. NO  'RETURN CODE 8'                    02010002
         TM    WAPLAST,PELGEN2  Q. GENERIC=YES                          02040002
         BZ    DEQNGENR       A. NO. CONTINUE PROCESSING.               02070002
* GENERIC DEQUEUE                                                       02100002
         L     R10,MAJFMIN    GET THE FIRST MINOR                       02130002
DEQQMIN  EQU   *              MINOR QCB LOOP                            02160002
         LPR   R10,R10        Q. IS THERE A MINOR.                      02190002
         BZ    DEQNMIN        A. NO SEE WHAT HAPPENED.                  02220002
* SCOPE MUST MATCH FOR GENERIC DEQUEUE.                                 02250002
         TM    PELFLAG,PELSCPE1+PELSCPE2 Q. REQUESTING STEP.            02280002
         BNZ   DEQNSTEP       A. NO.                                    02310002
         TM    MINFLGS,MINSTEP  Q. REQUEST FOR THIS MINOR.              02340002
         BZ    DEQNTHIS       A. NO.                                    02370002
         CLC   GSASID(TWO),MINASID Q. REQUEST FOR THIS MINOR.           02400002
         BNE   DEQNTHIS       A. NO. GET NEXT MINOR.                    02430002
         B     DEQYTHIS       A. YES. SCOPE MATCH.                      02460002
DEQNSTEP EQU   *              *                                         02490002
         TM    PELFLAG,PELSCPE2  Q. REQUESTING SYSTEMS.                 02520002
         BZ    DEQNSYSS       A. NO. REQUEST IS FOR SYSTEM              02550002
         TM    MINFLGS,MINSYSS  Q. REQUEST FOR THIS MINOR.              02580002
         BZ    DEQNTHIS       A. NO. NOT THIS ONE.                      02610002
         B     DEQYTHIS       A. YES. THIS ONE.                         02640002
DEQNSYSS EQU   *              *                                         02670002
         TM    MINFLGS,MINSYS Q. REQUEST FOR THIS MINOR.                02700002
         BZ    DEQNTHIS       A. NO. NOT THIS ONE.                      02730002
DEQYTHIS EQU   *              *                                         02760002
         BAL   R3,XQELSCAN    SCAN THE QELS                             02790002
         LTR   R11,R11        Q. FIND A MATCH                           02820002
         BNP   DEQNDEQ        A. NO. GET NEXT MINOR.                    02850002
         LA    R0,TWO         INIT REG FOR COMPARE                      02880002
         C     R0,GSGRPNUM    MATCH QEL IN GROUP 1                      02910002
         BH    DEQYDEQ        A. YES. DEQUEUE IT.                       02940002
         TM    QELLFLGS,QELECBF   Q. ECB DEQUEUE                        02970002
         BO    DEQYDEQ        A. YES. CAN DEQUEUE                       03000002
         OI    WAFLAG1,WAWAITN  INDICATE FOUND A WAITING QEL(NOT ECB)   03030002
         B     DEQNDEQ        GET THE NEXT MINOR.                       03060002
DEQYDEQ  EQU   *              *                                         03090002
* GROUP 1 OR ECB(ANY GROUP)                                             03120002
         BAL   R2,XDEQQEL     DEQUEUE THE CURRENT QEL                   03150002
         OI    WAFLAG1,WA1DEQ  INDICATE AT LEAST ONE QEL DEQUEUED       03180002
         LTR   R10,R10        Q. CHANGE IN MINOR                        03210002
         BNP   DEQQMIN        A. YES. HAVE NEXT ALREADY.                03240002
DEQNDEQ  EQU   *              GET NEXT MINOR.                           03270002
DEQNTHIS EQU   *              *                                         03300002
         L     R10,MINNMIN    GET NEXT MINOR.                           03330002
         B     DEQQMIN        LOOP                                      03360002
DEQNMIN  EQU   *              CHECK WHAT HAPPENED.                      03390002
         TM    WAFLAG1,WAWAITN+WA1DEQ   Q. FIND ANY.                    03420002
         BZ    DEQNFIND       A. NO. 'RETURN CODE 8'                    03450002
         TM    WAFLAG1,WAWAITN   Q. ANY FOUND WAITING                   03480002
         BZ    DEQYFIND       A. NO. 'RETURN CODE 0'                    03510002
         B     DEQYWTNG       A. YES. 'RETURN CODE 4'                   03540002
         EJECT                                                          03570002
DEQNGENR EQU   *              *                                         03600002
         BAL   R3,XFINDMIN    FIND A MATCHING MINOR                     03630002
         LTR   R10,R10        Q. FIND ONE.                              03660002
         BNP   DEQNMIN1       A. NO. 'RETURN CODE 8'                    03690002
         BAL   R3,XQELSCAN    SCAN THE QELS                             03720002
         LTR   R11,R11        Q. FIND A MATCH QEL                       03750002
         BZ    DEQNQEL        A. NO. 'RETURN CODE 8'                    03780002
         LA    R0,TWO         USE FOR THE FOLLOWING COMPARE             03810002
         C     R0,GSGRPNUM    Q. GROUP NUMBER ONE                       03840002
         BH    DEQYDEQ1       A. YES.CAN DEQUEUE.                       03870002
         TM    QELLFLGS,QELECBF  Q. DEQUEUE ALLOWED.                    03900002
         BZ    DEQNDEQ1       A. NO 'RETURN CODE 4'                     03930002
DEQYDEQ1 EQU   *              QEL IS DEQ-ABLE                           03960002
* QEL IS DEQ-ABLE                                                       03990002
         BAL   R2,XDEQQEL     DEQUEUE THE CURRENT QEL                   04020002
         B     DEQYRC0        'RETURN CODE 0'                           04050002
         EJECT                                                          04080002
DEQYA430 EQU   *              INVALID PARM LIST                         04110002
DEQYRESB EQU   *              *                                         04140002
DEQYCONF EQU   *              CONFLICTING PARMS                         04170002
         MVI   WAERR,AB430    'ABEND CODE 430'                          04200002
         B     DEQPART2       PROCEED TO PART 2                         04230002
DEQYA330 EQU   *              NOT AUTHORIZED                            04260002
DEQNAUTH EQU   *              *                                         04290002
         MVI   WAERR,AB330    'ABEND CODE OF 330'                       04320002
         B     DEQPART2       PROCEED TO PART 2                         04350002
DEQYA230 EQU   *              MINOR NAME LENGTH OF ZERO                 04380002
DEQYMIL0 EQU   *              *                                         04410002
         MVI   WAERR,AB230    'ABEND CODE 230'                          04440002
         B     DEQPART2       PROCEED TO PART 2                         04470002
DEQYRC8  EQU   *              NO QEL(S) FOUND                           04500002
DEQNFIND EQU   *              *                                         04530002
DEQNMAJ  EQU   *              *                                         04560002
DEQNMIN1 EQU   *              *                                         04590002
DEQNQEL  EQU   *              *                                         04620002
         MVI   WARET,EIGHT    'RETURN CODE 8'                           04650002
         B     DEQPART2       PROCEED TO PART 2                         04680002
DEQYRC4  EQU   *              RESOURCE BEING WAITED UPON                04710002
DEQYWTNG EQU   *              *                                         04740002
DEQNDEQ1 EQU   *              *                                         04770002
         MVI   WARET,FOUR     'RETURN CODE 4'                           04800002
         B     DEQPART2       PROCEED TO PART 2                         04830002
DEQYRC0  EQU   *              AOK                                       04860002
DEQYFIND EQU   *              *                                         04890002
         MVI   WARET,ZERO     SET ZERO RETURN CODE             @YM04705 04900002
DEQYABN  EQU   *              *                                         04920002
         EJECT                                                          04950002
DEQPART2 EQU   *              PART 2 OF DEQ                             04980002
         CLI   WARET,ZERO     Q. IS THIS RETURN CODE ZERO               05010002
         BZ    DEQYZERO       A. YES.                                   05040002
         OI    WAFLAG2,WAR15SW   INDICATE HAVE A NON ZERO RET CODE.     05070002
DEQYZERO EQU   *              *                                         05100002
         CLI   WAERR,ZERO     Q. ABEND REQ'D                            05130002
         BNE   DEQYABND       A.YES                                     05160002
         TM    WAPFLAG,PELRET1+PELRET2+PELRET3  Q. RET=NONE             05190002
         BNZ   DEQYSTOR       A. NO. STORE THE RET. CODE.               05220002
* RET=NONE                                                              05250002
         CLI   WARET,ZERO     Q. R.C. OF 0                              05280002
         BE    DEQNSTOR       A. YES. DONT STORE                        05310002
         CLI   WARET,FOUR     Q. R.C. OF FOUR                           05340002
         MVI   WAERR,AB530    CHANGE TO 530 ABEND                       05370002
         BE    DEQYABND       A. YES. ABEND 530                         05400002
         MVI   WAERR,AB130    CHANGE TO ABEND 130                       05430002
         B     DEQYABND       ABEND 130                                 05460002
DEQYSTOR EQU   *              *                                         05490002
* NOT RET=NONE                                                          05520002
         LR    R14,R8         CURRENT PEL                               05550002
         S     R14,WANEWPEL   PEL DISPLACEMENT                          05580002
         AL    R14,WAOLDPEL   CORRESPONDING PEL                         05610002
         LH    R2,WAKEY       GET THE USERS KEY                         05640002
TEST1    EQU   *              *                                         05670002
         MODESET  KEYADDR=(2)  CHANGE TO USER KEY.                      05700002
         IC    R15,WARET      GET RETURN CODE.                          05730002
         STC   R15,PELRET-PEL(R14)  STORE THE RET CODE.                 05760002
TEST2    EQU   *              *                                         05790002
         MODESET  EXTKEY=SUPR  SET KEY BACK TO ZERO                     05820002
DEQNSTOR EQU   *              *                                         05850002
         TM    PELLAST,PELEOL   Q. END OF LIST                          05880002
         BO    DEQYEOL        A. YES.                                   05910002
         TM    PELFLAG,PELSCPE2  Q. UCB PARM ELEM                       05940002
         BZ    DEQNUCB        A. NO.                                    05970002
         TM    PELFLAG,PELSCPE1  Q. UCB PARM ELEM                       06000002
         BO    DEQNUCB        A. NO                                     06030002
         LA    R8,FOUR(R8)    COMPENSATE FOR UCB WORD                   06060002
DEQNUCB  EQU   *              *                                         06090002
         LA    R8,PELELEM(R8) BUMP TO THE NEXT ELEM                     06120002
         B     DEQQPEL        PROCESS THE NEXT ELEMENT.                 06150002
DEQYEOL  EQU   *              *                                         06180002
         BAL   R3,XENDUP      DO END PROCESSING                         06210002
         SR    R15,R15        ASSUME RET CODE OF ZERO.                  06240002
         TM    WAFLAG2,WAR15SW   Q. SET R15 TO ZERO.                    06270002
         BZ    DEQYZ15        A. YES                                    06300002
* AT LEAST ONE NON ZERO RET CODE WAS GOTTEN.                            06330002
         L     R15,WAOLDPEL   SET R15 TO POINT TO PARM LIST             06360002
DEQYZ15  EQU   *              *                                         06390002
         L     R14,CVTPTR     GET CVT                                   06420002
TEST4    EQU   *              *                                         06450002
         L     R14,CVTEXPRO-CVT(R14)  GET EXIT ADDRESS.                 06480002
         BR    R14            RETURN                                    06510002
DEQYABND EQU   *              *                                         06540002
DEQXRTRY EQU   *              RETRY FROM HERE AFTER ERROR               06570002
* R5,R6,R7 AND R13 ARE SET CORRECTLY                                    06600002
         BAL   R3,XENDUP      DO END PROCESSING                         06630002
         LA    R1,DEQCODE     GET BACK END OF ABEND CODE.               06660002
         ICM   R1,M0010,WAERR  GET THE FRONT END OF ABEND CODE.         06690002
         ABEND  (1),DUMP,,SYSTEM   ABEND.                               06720002
TEST5    EQU   *              *                                         06750002
         EJECT                                                          06780002
IGC056   DS    0D             ENTRY POINT FOR ENQ/RESERVE               06810002
         USING *,R6                                                     06840002
         DROP  R7                                                       06870002
         LM    R6,R7,BASE     ESTABLISH BASE REGISTERS                  06900002
         USING IGC048,R6,R7                                             06930002
         B     ENQID          SKIP ENQ IDENTIFIER                       06960002
         DC    CL8'IGC056'    ENQ IDENTIFIER                            06990002
ENQID    EQU   *              USED ONLY TO BYPASS ENQ IDENTIFIER        07020002
         LA    R0,RETRYENQ    INDEX OF RETRY ADDRESS                    07050002
         LA    R2,ENQFRR      OBTAIN FRR E.P. ADDRESS                   07080002
         BAL   R3,XSETUP      PERFORM COMMON INITIALIZATION             07110002
         TM    GSFLAG1,GSNOENQ   Q. STOP ENQ                            07140002
         BO    ENQYA838       A. YES. 'ABEND CODE 838'                  07170002
         CLI   WAERR,ZERO     Q. ABEND                                  07200002
         BNE   ENQYABN        A. YES.                                   07230002
* CHECK RESERVED BITS                                                   07260002
         TM    WAPLAST,PELRES1+PELSAVE+PELGEN1+PELGEN2         @YM03340 07290002
         BNZ   ENQYRESB       ERROR WHEN BITS USED                      07320002
         TM    WAPFLAG,PELSYSMC   Q. SET MUST COMPLETE                  07350002
         BO    ENQYRESB           A. YES, CONFLICTING PARAMETERS        07380002
         TM    WAPFLAG,PELRET1    Q. FURTHER CHECKING NECESSARY         07410002
         BZ    ENQNRESB           A. NO, THEN SKIP                      07440002
         TM    WAPFLAG,PELRET2+PELRET3  Q. RESERVED BITS USED           07470002
         BM    ENQYRESB                 A. YES, ERROR                   07500002
ENQNRESB EQU   *              *                                         07530002
* CHECK FOR MINOR NAME LENGTH OF 0                                      07560002
         TM    WAFLAG2,WABADMIL                                         07590002
         BO    ENQYMIL0         ERROR WHEN LENGTH ZERO REQUESTED        07620002
         TM    WAPLAST,PELTCBF  Q. DIRECTED ENQ                         07650002
         BZ    ENQNDIR          A. NO, THEN SKIP                        07680002
* TCB REQUEST                                                           07710002
         L     R10,PSAAOLD    GET FIRST TCB IN THIS ADDR SPACE          07740002
         L     R10,ASCBASXB-ASCB(R10)  DITTO                            07770002
         L     R10,ASXBFTCB-ASXB(R10)  DITTO                            07800002
ENQQTCB1 EQU   *              CHECK EACH ACTIVE TCB IN THIS ADDR SPACE  07830002
         CR    R10,R4         Q. VALID TCB                              07860002
         BE    ENQYTCB1       A. YES.                                   07890002
         ICM   R10,M1111,TCBTCB-TCB(R10) Q. ANY MORE TCBS               07920002
         BNZ   ENQQTCB1       A. YES. LOOP.                             07950002
* IF HERE, HAVE INVALID TCB                                             07980002
         B     ENQNTCB1       'ABEND 438'                               08010002
ENQYTCB1 EQU   *              *                                         08040002
* CHECK TCB CONFLICTS                                                   08070002
         TM    PELFLAG,PELSCPE2   Q. UCB SPECIFIED.                     08100002
         BZ    NRESV4         A. NO.                                    08130002
         TM    PELFLAG,PELSCPE1   Q. UCB SPECIFIED.                     08160002
         BZ    ENQYCONF       A. YES. CONFLICTING PARMS                 08190002
NRESV4   EQU   *              *                                         08220002
         TM    WAPFLAG,PELSTPMC  Q. SET STEP MUST COMPLETE              08250002
         BO    ENQYCONF          A. YES, CONFLICTING PARAMETERS         08280002
         TM    WAECBA,WAECBF     Q. ECB SPECIFIED              @ZA14267 08287040
         BO    ENQNDIR           A. YES, DO NOT CHECK FOR      @ZA14267 08292040
*                                CHNG, USE, OR TEST            @ZA14267 08297040
         TM    WAPFLAG,PELRET2   Q. CHNG, USE, OR TEST REQUESTED        08310002
         BZ    ENQYCONF          A. NO, ERROR (IF NOT ECB)     @ZA14267 08320040
ENQNDIR  EQU   *              *                                         08370002
* CHECK FOR ECB AND SMC=STEP CONFLICT                                   08400002
         TM    WAPFLAG,PELSTPMC  Q. SMC=STEP SPECIFIED.                 08430002
         BZ    ENQNSMC3       A. NO.                                    08460002
         TM    WAECBA,WAECBF  Q. ECB= SPECIFIED.                        08490002
         BO    ENQYCONF       A. YES. SMC + ECB CONFLICT. ABEND.        08520002
ENQNSMC3 EQU   *              *                                         08550002
* CHECK IF AUTHORIZED                                                   08580002
         TM    WAFLAG2,WANOAUTH    Q. CALLER AUTHORIZED VIA TESTAUTH.   08610002
         BZ    ENQYAUTO       A. YES. SKIP AUTHORIZATION CHECKS.        08640002
* CHECK AUTHORIZATION FOR TCB,ECB,SMC                                   08670002
         TM    WAPLAST,PELTCBF  Q. TCB KEYWORD SPECIFIED                08700002
         BO    ENQNAUTH       A. YES. ABEND CALLER.                     08730002
         TM    WAPFLAG,PELSTPMC Q. SMC KEYWORD SPECIFIED                08760002
         BO    ENQNAUTH       A. YES. ABEND CALLER                      08790002
         TM    WAECBA,WAECBF   Q. ECB KEYWORD SPECIFIED.                08820002
         BO    ENQNAUTH       A. YES. ABEND CALLER.                     08850002
         SPACE 3                                                        08880002
ENQYAUTO EQU   *              *                                         08910002
ENQQPEL  EQU   *              *                                         08940002
         TM    PELFLAG,PELSCPE2   Q. UCB SPECIFIED.                     08970002
         BZ    ENQNUCB        A. NO.                                    09000002
         TM    PELFLAG,PELSCPE1   Q. UCB SPECIFIED.                     09030002
         BO    ENQNUCB        A. NO.                                    09060002
* CHECK FOR VALID UCB                                                   09090002
         L     R1,PELUCBAA    GET THE UCB ADDR ADDR                     09120002
         L     R1,ZERO(R1)    GET THE UCB ADDR                          09150002
         CLI   UCBID-UCBOB(R1),XFF   Q. ABEND DUE TO BAD UCB AD.        09180002
         BNE   ENQYA438       A. YES. ABEND WITH 438 CODE.              09210002
         TM    WAFLAG2,WANOAUTH    Q. CHECK UCB ADDRESS FURTHER.        09240002
         BZ    ENQNCHK        A. NO.                                    09270002
         L     R14,TCBJSTCB-TCB(R4)  GET POINTER TO JOB STEP TCB        09300002
         ICM   R14,M1111,TCBTIO-TCB(R14)  Q. IS THERE A TIOT            09330002
         BZ    ENQNTIOT       A. NO. INVALID UCB. ABEND 438.            09360002
         LA    R14,TIOELNGH-TIOT1(R14)  SKIP TO DD ENTRIES              09390002
ENQQENTY EQU   *              *                                         09420002
         SR    R15,R15        ZERO FOR INSERT                           09450002
         ICM   R15,M0001,TIOELNGH-TIOENTRY(R14) Q. ANY MORE DD-S        09480002
         BZ    ENQNENTY       A. NO 'ABEND 438'  INVALID UCB ADDRESS    09510002
         LA    R15,ZERO(R15,R14)                                        09540002
         LA    R14,TIOEFSRT-ONE-TIOENTRY(R14)  GET ADDR. OF UCB ADDR    09570002
ENQQDEV  EQU   *              *                                         09600002
         CR    R14,R15        Q. END OF DEVICES                         09630002
         BE    ENQYNEXT       A. YES, CHECK NEXT DD ENTRY               09660002
         BH    ENQNDEV        A. YES, ERROR ABEND                       09690002
         CLM   R1,M0111,ONE(R14)  A. NO. Q. MATCH ON UCB                09720002
         BE    ENQYDEV        A. YES, FOUND                             09750002
         LA    R14,FOUR(R14)  A. NO, GET NEXT DEVICE ENTRY ADDR.        09780002
         B     ENQQDEV        LOOP                                      09810002
ENQYNEXT EQU   *              *                                         09840002
         LR    R14,R15        GET NEXT DD ENTRY                         09870002
         B     ENQQENTY       LOOP                                      09900002
         EJECT                                                          09930002
* FIND A MAJOR                                                          09960002
ENQYDEV  EQU   *              *                                         09990002
ENQNUCB  EQU   *              *                                         10020002
ENQNCHK  EQU   *              *                                         10050002
ENQQMAJ  EQU   *              *                                         10080002
         BAL   R3,XFINDMAJ    FIND MATCHING MAJOR                       10110002
* INSERT AT THE TOP                                                     10140002
         LTR   R9,R9          Q. FOUND ONE                              10170002
         BP    ENQYMAJ        A. YES, SKIP CREATING ONE                 10200002
         TM    WAPFLAG,PELRET2  Q. RET=TEST/CHNG/USE                    10230002
         BZ    ENQNTCU        A. NO. WAS RET=NONE/HAVE/ECB              10260002
         TM    WAPFLAG,PELRET1+PELRET3  Q. TEST  Q. CHNG                10290002
         BO    ENQYTEST       A. TEST  'RETURN CODE 0'                  10320002
         BZ    ENQYCNG2       A. CHNG. 'RETURN CODE 8'                  10350002
ENQNTCU  EQU   *              *                                         10380002
         BAL   R3,XGETMAJ     OBTAIN STORAGE FOR MAJOR QCB              10410002
         TM    WAFLAG2,WANOCORE    Q. STORAGE AVAILABLE                 10440002
         BO    ENQNCORE       A. NO, ERROR                              10470002
         EJECT                                                          10500002
* INITIALIZE THE MAJOR                                                  10530002
         L     R12,GSMJWORD   GET ADDRESS OF MAJOR QCB                  10560002
         XC    ZERO(MAJLEN,R12),ZERO(R12)  ZERO MAJOR QCB STORAGE       10590002
         L     R15,PELMAJA    GET ADDRESS OF QNAME                      10620002
         MVC   MAJNAME-MAJ(EIGHT,R12),ZERO(R15)  MOVE QNAME INTO MAJOR  10650002
         EJECT                                                          10680002
* CHAIN THE MAJOR                                                       10710002
         L     R14,CVTPTR     GET ADDRESS OF CVT                        10740002
TEST6    EQU   *              *                                         10770002
         L     R9,CVTFQCB-CVT(R14)  GET ADDRESS OF FIRST MAJOR QCB      10800002
         LTR   R9,R9          Q. ANY EXIST                              10830002
         BNZ   ENQNFST        A. YES, SKIP PROCESS FOR FIRST            10860002
* NO MAJORS EXIST                                                       10890002
         ST    R12,CVTLQCB-CVT(R14)  INIT. POINTER TO LAST MAJOR QCB    10920002
         B     ENQOUT         SKIP INIT. BACKWARD POINTER               10950002
ENQNFST  EQU   *              *                                         10980002
* NOT THE FIRST MAJOR      (CHAIN ON TOP)                               11010002
         ST    R9,MAJNMAJ-MAJ(R12)  INITIALIZE NEXT POINTER             11040002
         ST    R12,MAJPMAJ-MAJ(R9)   SET PREVIOUS  POINTER              11070002
ENQOUT   EQU   *                                                        11100002
         ST    R12,CVTFQCB-CVT(R14)  NEW FIRST MAJOR QCB POINTER        11130002
         LR    R9,R12         TWO POINTERS TO NEW MAJOR QCB             11160002
* CHAIN OF MAJOR COMPLETE                                               11190002
         B     ENQNMAJ        GO CREATE MINOR QCB                       11220002
         EJECT                                                          11250002
* FIND A MINOR                                                          11280002
ENQYMAJ  EQU   *              *                                         11310002
         BAL   R3,XFINDMIN    FIND MATCHING MINOR                       11340002
         LTR   R10,R10        Q. FIND A MATCHING MINOR.                 11370002
         BP    ENQYMIN        A. YES.                                   11400002
         TM    WAPFLAG,PELRET2  Q. RET=TEST/CHNG/USE                    11430002
         BZ    ENQNTCU1       A. NO. WAS RET=NONE/HAVE/ECB              11460002
         TM    WAPFLAG,PELRET1+PELRET3  Q. TEST  Q. CHNG                11490002
         BO    ENQYTST1       A. TEST  'RETURN CODE 0'                  11520002
         BZ    ENQYCNG3       A. CHNG. 'RETURN CODE 8'                  11550002
ENQNTCU1 EQU   *              *                                         11580002
         BAL   R3,XGETMIN     GET CORE FOR A MINOR QCB                  11610002
         TM    WAFLAG2,WANOCORE   Q. CORE OBTAINED                      11640002
         BO    ENQYA638           A. NO, ERROR                          11670002
         EJECT                                                          11700002
* INITIALIZE THE MINOR                                                  11730002
ENQNMAJ  EQU   *              *                                         11760002
* INITIALIZE AND CHAIN MINOR                                            11790002
         L     R12,GSMNWORD   GET ADDRESS OF MINOR QCB                  11820002
         XC    ZERO(MINLEN,R12),ZERO(R12)  ZERO MINOR QCB STORAGE       11850002
* SET THE SCOPE                                                         11880002
         TM    PELFLAG,PELSCPE1+PELSCPE2   Q. STEP SPECIFIED            11910002
         BNZ   ENQNSTEP       A. NO, TRY SYSTEMS                        11940002
* SET STEP                                                              11970002
         OI    MINFLGS-MIN(R12),MINSTEP   INDICATE STEP                 12000002
         MVC   MINASID-MIN(TWO,R12),GSASID  INIT ASID.                  12030002
         B     ENQYSTEP       SKIP REMAINING SCOPE PROCESSING           12060002
ENQNSTEP EQU   *              *                                         12090002
         TM    PELFLAG,PELSCPE2  Q. SYSTEMS SPECIFIED                   12120002
         BZ    ENQNSYSS       A. NO, MUST BE SYSTEM                     12150002
* SET SYSTEMS                                                           12180002
         OI    MINFLGS-MIN(R12),MINSYSS   INDICATE SYSTEMS              12210002
         B     ENQYSYSS       SKIP REMAINING SCOPE PROCESSING           12240002
ENQNSYSS EQU   *              *                                         12270002
         OI    MINFLGS-MIN(R12),MINSYS   INDICATE SYSTEM                12300002
ENQYSTEP EQU   *              USED TO SKIP REMAINING SCOPE PROCESSING   12330002
ENQYSYSS EQU   *              USED TO SKIP REMAINING SCOPE PROCESSING   12360002
* MOVE MINOR NAME                                                       12390002
         L     R14,PELMINA    GET ADDRESS OF RNAME                      12420002
         ICM   R15,M0001,PELMILEN   Q. LENGTH OF RNAME ZERO             12450002
         BNZ   ENQYMIL        A. NO, BYPASS ZERO PROCESSING             12480002
         IC    R15,ZERO(R14)  GET LENGTH FROM BEGINNING OF RNAME        12510002
         LA    R14,ONE(R14)   BUMP RNAME POINTER PAST LENGTH            12540002
ENQYMIL  EQU   *              USED TO BYPASS PROCESSING FOR ZERO LENGTH 12570002
         STC   R15,MINNAMEL-MIN(R12)  SAVE LENGTH                       12600002
         BCTR  R15,ZERO       DECREMENT LENGTH FOR EXECUTE              12630002
         EX    R15,MOVEMIN1   MOVE RNAME INTO MINOR                     12660002
         EJECT                                                          12690002
* CHAIN THE MINOR                                                       12720002
*  INSERT AT THE TOP OF MINOR Q                                         12750002
         L     R10,MAJFMIN    GET ADDRESS OF FIRST MINOR                12780002
         LTR   R10,R10        Q. ANY MINORS                             12810002
         BZ    ENQY1ST        A. NO, SKIP TO PROCESSING FOR FIRST MINOR 12840002
* NOT THE FIRST MINOR                                                   12870002
         ST    R10,MINNMIN-MIN(R12)  SET NEXT POINTER IN NEW MINOR      12900002
         ST    R12,MINPMIN-MIN(R10)  SET PREVIOUS POINTER IN OLD MINOR  12930002
         B     ENQN1ST        SKIP PROCESSING OF FIRST MINOR            12960002
ENQY1ST  EQU   *              BRANCH TO ONLY WHEN FIRST MINOR           12990002
* FIRST MINOR                                                           13020002
         ST    R12,MAJLMIN    INITIALIZE LAST MINOR POINTER             13050002
ENQN1ST  EQU   *              BRANCHED TO ONLY WHEN NOT FIRST MINOR     13080002
         ST    R12,MAJFMIN    RESET POINTER TO FIRST MINOR              13110002
         LR    R10,R12        TWO POINTERS TO MINOR QCB                 13140002
* CHAIN OF MINOR COMPLETE                                               13170002
* SET GROUP NUMBER TO 1                                                 13200002
* SET NUMBER OF QELS IN GROUP 1 TO 1                                    13230002
* SET GROUPS 2,3 AND 4 TO ZERO                                          13260002
         XC    GSGPAREA(GSGPLEN),GSGPAREA  ZERO GROUP COUNT AREA        13290002
         MVI   GSGROUP1+ONE,ONE    SET GROUP NUMBER TO ONE              13320002
         MVI   GSGRPNUM+THREE,ONE    NEW QEL IS IN GROUP 1              13350002
         SR    R11,R11        INDICATE NO MATCH QEL                     13380002
         B     ENQNMIN        GO CREATE QEL                             13410002
         EJECT                                                          13440002
ENQYMIN  EQU   *              *                                         13470002
         TM    MINFLGS,MINNOENQ  Q. STOP ENQ FOR THIS MINOR             13500002
         BO    ENQYA838       A. YES. ABEND CODE '838'                  13530002
         TM    TCBFLGS1,TCBFA Q. MY TCB ABENDING                        13560002
         BZ    ENQNABND       A. NO.                                    13590002
         SPACE 2                                                        13594040
*                                                              @ZA07146 13598040
* AVOID STEALING LOGIC FOR ENQ RET=TEST REQUEST                @ZA07146 13602040
*                                                              @ZA07146 13606040
         TM    WAPFLAG,PELRET1+PELRET2+PELRET3 Q. RET=TEST     @ZA07146 13610040
         BO    ENQYTST        A. YES, PROCESS NORMALLY         @ZA07146 13614040
         EJECT                                                          13620002
* ENQ'S STEAL QEL ROUTINE                                               13650002
*                                                                       13680002
* REQUIREMENTS FOR STEALING                                             13710002
* ENQ'S CALLER MUST BE ABEND                                            13740002
* THE PRESENT OWNER MUST NOT BE ABEND.                                  13770002
* THE ENQUEUEING PROGRAM MUST HAVE HAD PERMANENTLY LOST CONTROL         13800002
* ENQUEUED TCB MUST BE IN SAME ABEND TCB TREE.                          13830002
*                                                                       13860002
* R11 IS THE QEL SEARCH REG                                             13890002
* R12 CONTAINS THE ABENDED QELTCB IN THIS ADDRESS SPACE                 13920002
* R14 IS USED AS A QUICKY REG                                           13950002
* R15 IS USED TO SEARCH TO THE TOP OF BOTH TREES                        13980002
* R0 IS USED AS A BCT REG                                               14010002
* R1 IS USED TO SAVE THE TOP OF THE FIRST TCB TREE                      14040002
ENQQQEL1 EQU   *              *                                         14070002
         L     R11,MINLQEL    GET BOTTOM QEL                            14100002
ENQQQEL  EQU   *              *                                         14130002
         LTR   R11,R11        Q. ANY QEL LEFT                           14160002
         BNP   ENQNQEL        A. NO. LOOP COMPLETE.                     14190002
* CHECK IF THIS QEL BELONGS TO THIS ADDRESS SPACE                       14220002
         CLC   QELASID(TWO),GSASID   Q. QEL IN THIS ADDRESS SPACE       14250002
         BNE   ENQNASID       A. NO. DONT STEAL.                        14280002
         L     R12,QELTCB     GET THE QEL'S TCB                         14310002
         LTR   R12,R12        DITTO                                     14340002
         BP    ENQYTCB        DITTO                                     14370002
         L     R12,QELTCB-QEL(R12)  DITTO                               14400002
ENQYTCB  EQU   *              *                                         14430002
* CHECK IF QEL TCB IS ABENDING                                          14460002
         CR    R4,R12         Q. THIS TCB SAME AS QEL TCB               14490002
         BE    ENQYABNG       A. YES. CAN STEAL.                        14520002
         TM    TCBFLGS5-TCB(R12),TCBABWF  Q. QEL-TCB ABENDING           14550002
         BZ    ENQNABNG       A. NO. CANT STEAL.                        14580002
ENQYABNG EQU   *              *                                         14610002
         SPACE 3                                                        14640002
* ARE THE TOPS OF BOTH TREES THE SAME                                   14670002
* INPUT R4 MYTCB R12 QELTCB                                             14700002
* OUTPUT R1 MYTOPTCB R15 QELTOPTCB                                      14730002
         LR    R1,R4          USE MY TCB TO FIND TOP                    14760002
ENQQTOP1 EQU   *              *                                         14790002
         TM    TCBFLGS1-TCB(R1),TCBFT  Q. IS IT TOP OF ABEND TREE       14820002
         BO    ENQYTOP1       A. YES.                                   14850002
         ICM   R1,M1111,TCBOTC-TCB(R1)  A. NO. GET MOTHER               14880002
         BNZ   ENQQTOP1       LOOP.                                     14910002
ENQYTOP1 EQU   *              *                                         14940002
         LR    R15,R12        USE QEL TCB TO FIND TOP                   14970002
ENQQTOP2 EQU   *              *                                         15000002
         TM    TCBFLGS1-TCB(R15),TCBFT Q. IS IT TOP OF ABEND TREE       15030002
         BO    ENQYTOP2       A. YES.                                   15060002
         ICM   R15,M1111,TCBOTC-TCB(R15)  A. NO. GET MOTHER.            15090002
         BNZ   ENQQTOP2       LOOP.                                     15120002
ENQYTOP2 EQU   *              *                                         15150002
         SPACE 3                                                        15180002
         CR    R1,R15         Q. DOES MY TOP MATCH QEL TCB'S TOP        15210002
         BNE   ENQNMTCB       A. NO, BYPASS STEALING           @ZA32935 15240040
*                                                              @ZA32935 15391040
*        SEE CHANGE ACTIVITY IN THE PROLOGUE FOR A GENERAL     @ZA32935 15392040
*        DESCRIPTION OF THIS FIX. HERE ARE A COUPLE OTHER      @ZA32935 15393040
*        COMMENTS:                                             @ZA32935 15394040
*       -STEALING IN GENERAL IS PERFORMED BECAUSE RTM WILL SET @ZA32935 15395040
*        NONDISPATCHABLE ALL DAUGHTER TASKS OF A TASK WHICH IS @ZA32935 15396040
*        ABNORMALLY TERMINATING. THE STEALING IS DONE BECAUSE  @ZA32935 15397040
*        ENQ RESOURCES MAY BE OWNED BY THESE TASKS. THERE IS   @ZA32935 15398040
*        VERY LIKELY CODE IN THE SYSTEM WHICH DEPENDS ON       @ZA32935 15399040
*        STEALING TO HAPPEN IN OTHER SITUATIONS IN ABNORMAL    @ZA32935 15400040
*        TERMINATION. THEREFORE, IT IS NECESSARY TO BE         @ZA32935 15401040
*        CAUTIOUS IN CHANGING CODE HERE. ONE KIND OF PROBLEM   @ZA32935 15402040
*        WHICH CAN OCCUR INVOLVES INTERLOCKS WHICH CAN ARISE   @ZA32935 15403040
*        BECAUSE OF ENQ'S ON MULTIPLE RESOURCES.               @ZA32935 15404040
*       -IF A TERM EXIT OR TASK RESOURCE MANAGER HOLDS AN ENQ  @ZA32935 15405040
*        RESOURCE AND IS THEN SET NON-DISPATCHABLE BY A HIGHER @ZA32935 15406040
*        LEVEL TASK FOR ABNORMAL TERMINATION (PERHAPS FOR      @ZA32935 15407040
*        CANCEL), A DEADLOCK COULD BE CREATED. THEREFORE, IT   @ZA32935 15408040
*        IS NECESSARY FOR THIS FIX TO BYPASS STEALING ONLY IF  @ZA32935 15408740
*        THE CURRENT TASK OWNS THE RESOURCE.                   @ZA32935 15409440
*                                                              @ZA32935 15411040
         TM    QELQFLGS,QELTCBFA  WAS TCBFA ON WHEN QEL BUILT? @ZA32935 15412040
         BZ    ENQYSTL        NO, CONTINUE STEAL PROCESSING    @ZA32935 15413040
         CR    R4,R12         IS RESOURCE OWNED BY CURRENT TCB @ZA32935 15414040
         BE    ENQNSTL        YES, BYPASS STEALING             @ZA32935 15415040
ENQYSTL  EQU   *                                               @ZA32935 15416040
* DEQUEUE TO AVOID INTERLOCK IN ABEND PROCESSING                        15420002
         ST    R4,GSR14SAV    SAVE REG ACROSS DEQUEUE                   15450002
         LR    R4,R12         INSERT QELTCB FOR DEQ(DIRECTED DEQ)       15480002
         BAL   R3,XQELSCAN    TAKE SNAPSHOT OF QUEUES                   15510002
         LTR   R11,R11        Q. FIND IT                                15540002
         BZ    ENQNFIND       A. NO.                                    15570002
         BAL   R2,XDEQQEL     DEQUEUE THE QEL                           15600002
ENQNFIND EQU   *              *                                         15630002
         L     R4,GSR14SAV    SAVE REG ACROSS DEQUEUE                   15660002
         LTR   R10,R10        Q. MINOR CHANGE                           15690002
         BP    ENQQQEL1       A. NO.                                    15720002
         B     ENQQMAJ        A. YES. BEGIN AGAIN.                      15750002
         SPACE                                                          15753040
ENQNMTCB EQU   *              *                                @ZA32935 15756040
ENQNSTL  EQU   *              *                                @ZA32935 15759040
ENQNABNG EQU   *              *                                         15762040
ENQNASID EQU   *              *                                         15765040
         L     R11,QELPQEL    GET PREVIOUS QEL.                         15768040
         B     ENQQQEL        LOOP.                                     15771040
         EJECT                                                          15780002
ENQNQEL  EQU   *              *                                         15810002
ENQYTST  EQU   *              BYPASSES ENQ RESOURCE STEALING            15820040
ENQNABND EQU   *              *                                         15840002
         BAL   R3,XQELSCAN    SEARCH FOR MATCHING QEL                   15870002
         LA    R12,ONE        SET TO ONE FOR COMPARE                    15900002
         LTR   R11,R11        Q. SECOND REQUEST FOR THIS TASK           15930002
         BZ    ENQYNEW        A. NO. THIS IS A NEW REQUEST.             15960002
         C     R12,GSGRPNUM   Q. IS GROUP NUMBER ONE.                   15990002
         BNE   ENQYWTNG       A. OWNER WAITING 'RETUN CODE 20'          16020002
         TM    WAPFLAG,PELSTPMC  Q. SMC=STEP AND RET=HAVE               16050002
         BZ    ENQNSMC        A. NO.                                    16080002
         TM    WAPFLAG,PELRET1+PELRET2  Q. SMC=STEP AND RET=HAVE        16110002
         BNZ   ENQNHAVE       A. NO.                                    16140002
         TM    WAPFLAG,PELRET3   Q. SMC=STEP AND RET=HAVE               16170002
         BZ    ENQNHAVE       A. NO                                     16200002
* SMC=STEP AND RET=HAVE                                                 16230002
* THE QELMC BIT IS SET , NO QEL IS BUILT                                16260002
* THE QEL IS CHANGED FROM THE PREVIOUS REQUEST ONLY IN                  16290002
*        THAT THE QEL MC FLAG IS SET                                    16320002
*        A STATUS WILL BE ISSUED EVEN THOUGH NO QEL WAS BUILT.          16350002
*        THE SAME ACTION CAN BE ACCOMPLISHED BY THE CALLER              16380002
*        IF HE ISSUES STATUS DIRECTLY                                   16410002
         TM    QELQFLGS,QELMC   Q. IN MUST COMPLETE ALREADY             16440002
         BO    ENQYMC         A. YES. DON'T ISSUE STATUS AGAIN          16470002
         OI    WAFLAG1,WASTATUS  TELL MYSELF TO ISSUE STATUS            16500002
         OI    QELQFLGS,QELMC    INDICATE USER IN MUST COMPLETE STATE   16530002
         B     ENQYHAVE       GO BACK TO CALLER WITH 'RETURN CODE 8'    16560002
ENQYMC   EQU   *              *                                         16590002
ENQNHAVE EQU   *              *                                         16620002
ENQNSMC  EQU   *              *                                         16650002
         TM    WAPFLAG,PELRET2   Q. RET=CHNG                            16680002
         BZ    ENQNCHNG       A. NO 'RETURN CODE 8'                     16710002
         TM    WAPFLAG,PELRET1+PELRET3   Q. RET=CHNG                    16740002
         BNZ   ENQNCHNG       A. NO. 'RETURN CODE 8'                    16770002
* RET=CHNG                                                              16800002
         CH    R12,GSGROUP1   Q. ONLY QEL IN GROUP 1                    16830002
         BNE   ENQYSHRN       A. NO. CURRENTLY SHARING.                 16860002
* CAN CHANGE BECAUSE IT'S THE ONLY QEL IN GROUP 1                       16890002
         TM    WAPFLAG,PELSTPMC   Q.  SMC=STEP                          16920002
         BZ    ENQNSMC2       A. NO.                                    16950002
         TM    QELQFLGS,QELMC Q. IN MUST COMPLETE ALREADY               16980002
         BO    ENQYMC1        A. YES. DONT REISSUE STATUS               17010002
         OI    QELQFLGS,QELMC INDICATE USER IN MUST COMPLETE STATE      17040002
         OI    WAFLAG1,WASTATUS   TELL MYSELF TO ISSUE STATUS           17070002
ENQYMC1  EQU   *              *                                         17100002
ENQNSMC2 EQU   *              *                                         17130002
         NI    QELQFLGS,XFF-QELSHARE MAKE EXCLUSIVE                     17160002
         B     ENQYCHNG       'RETURN CODE 0' AOK                       17190002
         EJECT                                                          17220002
ENQYNEW  EQU   *              *                                         17250002
         TM    WAPFLAG,PELRET2  Q. RET=CHNG                             17280002
         BZ    ENQNCNG1       A. NO.                                    17310002
         TM    WAPFLAG,PELRET1+PELRET3  Q. RET=CHNG                     17340002
         BZ    ENQYCNG1       A. YES. 'RETURN CODE 8'                   17370002
ENQNCNG1 EQU   *              NOT RET=CHNG                              17400002
         TM    WAPFLAG,PELRET2+PELRET3  Q. RET=TEST OR RET=USE          17430002
         BNO   ENQNTU         A. NO. BUILD QEL                          17460002
         C     R12,GSGRPNUM   Q. WOULD THE NEW QEL BE IN GROUP 1        17490002
         BNE   ENQNGP1        A. NO. 'RETURN CODE 4'                    17520002
         TM    WAPFLAG,PELRET1+PELRET2+PELRET3  Q. RET=TEST             17550002
         BO    ENQYTST2       A. YES. 'RETURN CODE 0'                   17580002
ENQNTU   EQU   *              *                                         17610002
* BUILD A QEL                                                           17640002
         BAL   R3,XGETQEL     GET QEL CORE.                             17670002
         TM    WAFLAG2,WANOCORE  Q. OUT OF CORE                         17700002
         BO    ENQNCORE       A. YES 'ABEND 638'                        17730002
         EJECT                                                          17760002
* INITIALIZE THE QEL                                                    17790002
ENQNMIN  EQU   *              *                                         17820002
* INITIALIZE AND CHAIN THE QEL                                          17850002
         L     R12,GSQLWORD   GET THE QEL ADDRESS.                      17880002
* R11 IS THE CURRENT QEL                                                17910002
* R12 IS THE NEW QEL TO BE CHAINED                                      17940002
* R15 IS THE LIST QEL FOR THIS REQUEST.                                 17970002
* R14 IS USED AS A QUICKY WORK REG                                      18000002
* R0 IS USED TO CONTAIN A ZERO                                          18030002
         XC    ZERO(QELSIZE1,R12),ZERO(R12)   ZERO FIRST 4 WORDS        18060002
         TM    PELFLAG,PELSHARE  Q. IS IT A SHARED REQUEST              18090002
         BZ    ENQNSHR        A. NO.                                    18120002
         OI    QELQFLGS-QEL(R12),QELSHARE  A. YES. INDICATE SHARED.     18150002
ENQNSHR  EQU   *              *                                         18180002
         TM    WAPFLAG,PELSTPMC   Q. SMC=STEP                           18210002
         BZ    ENQNSMC1       A. NO.                                    18240002
         OI    QELQFLGS-QEL(R12),QELMC  INDICATE MUST COMPLETE          18270002
         OI    WAFLAG1,WASTATUS  TELL MYSELF TO ISSUE STATUS            18300002
ENQNSMC1 EQU   *              *                                         18330002
         ICM   R15,M1111,GSLSTQEL  Q. WILL THE NEW QEL BE THE LIST QEL  18360002
         BZ    ENQYLQEL       A. YES.                                   18390002
* BUILD A SUB QEL                                                       18420002
         O     R15,HIGHBIT    POINT THIS AT THE LIST QEL                18450002
         ST    R15,QELLQEL-QEL(R12)   DITTO                             18480002
         ICM   R14,M0111,QELLFLGS-QEL(R15)  GET FLAGS AND ASID.         18510002
         STCM  R14,M0111,QELLFLGS-QEL(R12) PROPAGATE THEM               18540002
         LA    R1,QELSIZE1    ADDRESS OF UCB STORE                      18570002
         B     ENQNLQEL       CONTINUE.                                 18600002
ENQYLQEL EQU   *              LIST QEL INITIALIZATION.                  18630002
         SR    R0,R0          ZERO FOR STORE                            18660002
         ST    R0,QELLCNT-QEL(R12)  ZERO LIST AND WAIT COUNTS.          18690002
*        DO NOT UPDATE THE COUNT OF THIS TASKS LIST QEL'S,     @ZA20351 18693040
*        IF THE COUNT IS ABOUT TO WRAP AROUND. TCBQEL IS USED  @ZA20351 18696040
*        ONLY BY ENQ AND ITS RESOURCE MANAGER. IF TCBQEL WERE  @ZA20351 18699040
*        PERMITTED TO GO TO 0 WHEN IT IS REALLY A MULTIPLE OF  @ZA20351 18702040
*        256, THE ENQ/DEQ RESOURCE MANAGER WOULD NOT ATTEMPT   @ZA20351 18705040
*        TO DEQ ANY RESOURCES.                                 @ZA20351 18708040
         CLI   TCBQEL,XFF                                      @ZA20351 18711040
         BE    NOUPDATE       DO NOT UPDATE QEL COUNT          @ZA20351 18714040
         IC    R0,TCBQEL      BUMP TCB QEL(LIST QEL) COUNT              18720002
         A     R0,FONE        DITTO                                     18750002
         STC   R0,TCBQEL                                                18780040
NOUPDATE EQU   *                                               @ZA20351 18790040
         ICM   R14,M1111,WAECBA   Q. ECB REQUEST.                       18810002
         ST    R5,QELSVRB-QEL(R12)  BEST GUESS ,NOT ECB                 18840002
         BNM   ENQNECB1       A. NO                                     18870002
         ST    R14,QELECB-QEL(R12)    SAVE ECB ADDRESS                  18900002
         OI    QELLFLGS-QEL(R12),QELECBF  INDICATE ECB                  18930002
ENQNECB1 EQU   *              *                                         18960002
         ST    R4,QELTCB-QEL(R12)   SAVE THE TCB ADDRESS.               18990002
         OI    QELQFLGS-QEL(R12),QELLIST  INDICATE LIST QEL             19020002
         LH    R14,GSASID     GET THE ASID                              19050002
         STH   R14,QELASID-QEL(R12)  SAVE THE ASID.                     19080002
         LR    R15,R12        SET THE LIST QEL REG TO THIS QEL          19110002
         LA    R1,QELSIZE2    ADDRESS OF UCB STORE                      19140002
         ST    R12,GSLSTQEL   SAVE THE LIST QEL ADDRESS.                19170002
ENQNLQEL EQU   *              *                                         19200002
* STORE UCB IF RESERVE REQUEST                                          19230002
         TM    PELFLAG,PELSCPE2   Q. UCB SPECIFIED.                     19260002
         BZ    ENQNUCB1       A. NO.                                    19290002
         TM    PELFLAG,PELSCPE1   Q. UCB SPECIFIED.                     19320002
         BO    ENQNUCB1       A. NO.                                    19350002
         L     R14,PELUCBAA   GET THE UCB ADDR ADDR                     19380002
         L     R14,ZERO(R14)  GET THE UCB ADDR                          19410002
         TM    UCBTBYT3-UCBOB(R14),UCB3DACC  Q. DASD           @YA00805 19440003
         BZ    ENQNUCB1       A. NO.                           @YA00805 19470003
         TM    UCBTBYT2-UCBOB(R14),UCB2OPT2  Q. SHARED         @YA00805 19500003
         BO    ENQYUCB1       A. YES.                          @YA00805 19530003
         LR    R0,R14         SAVE UCB ADDR                    @YA00805 19532003
         ICM   R14,M0111,UCBEXTP-UCBOB(R14)  GET UCB EXT. ADDR @YA00805 19533003
         TM    UCBFLP1-UCBETI(R14),UCBSHRUP Q. SHR CAPABILITY  @YA00805 19536003
         LR    R14,R0         RESTORE UCB ADDR                 @YA00805 19538003
         BZ    ENQNUCB1       A. NO. PROCESS AS NORMAL ENQ     @YA00805 19538303
ENQYUCB1 EQU   *              PROCESS AS RESERVE               @YA00805 19538603
         LA    R14,ZERO(R14)  CLEAR HIGH BYTE OF UCB ADDRESS   @YM04705 19540002
         ST    R14,ZERO(R1,R12)   STORE UCB ADDRESS                     19560002
         OI    QELQFLGS-QEL(R12),QELRESV   SET THE RESERVE INDICATOR    19590002
ENQNUCB1 EQU   *              *                                         19620002
         TM    WAFLAG2,WANOAUTH  CHECK FOR NOT AUTH.           @ZA17306 19626040
         BO    ENQNAUT2       NOT AUTH., DO NOT SET FLAG       @ZA17306 19632040
         OI    QELQFLGS-QEL(R12),QELAUTH  SET AUTH. FLAG       @ZA17306 19638040
ENQNAUT2 EQU   *                                               @ZA17306 19644040
         TM    TCBFLGS1,TCBFA IS TASK TERMINATING ABNORMALLY?  @ZA32935 19645040
         BZ    ENQNFA         NO, DO NOT SET FLAG              @ZA32935 19646040
         OI    QELQFLGS-QEL(R12),QELTCBFA  YES, SET FLAG       @ZA32935 19647040
ENQNFA   EQU   *                                               @ZA32935 19648040
* BUMP THE LIST QEL COUNT (NUMBER OF ACTIVE QELS)                       19650002
         LH    R14,QELLCNT-QEL(R15)   BUMP COUNT                        19680002
         LA    R14,ONE(R14)   DITTO                                     19710002
         STH   R14,QELLCNT-QEL(R15)   DITTO                             19740002
         EJECT                                                          19770002
* CHAIN THE QEL                                                         19800002
         ICM   R11,M1111,MINLQEL   GET THE LAST QEL OFF MINOR           19830002
         BZ    ENQYFIRS       THERE IS NONE                             19860002
* ADD TO BOTTOM                                                         19890002
         ST    R11,QELPQEL-QEL(R12)  SET PREVIOUS                       19920002
         ST    R12,QELNQEL-QEL(R11)  SET NEXT                           19950002
         B     ENQNFIRS       CONTINUE                                  19980002
ENQYFIRS EQU   *              ADD TO THE MINOR                          20010002
* ONLY QEL                                                              20040002
         ST    R12,MINFQEL-MIN(R10)   SET FIRST                         20070002
ENQNFIRS EQU   *              *                                         20100002
         ST    R12,MINLQEL-MIN(R10)  SET LAST                           20130002
         LR    R11,R12        MAKE NEW THE CURRENT                      20160002
         EJECT                                                          20190002
         LA    R0,TWO         USE TWO FOR COMPARE(S)                    20220002
         C     R0,GSGRPNUM    Q. GROUP 1                                20250002
         BNH   ENQNGRP1       A. NO.                                    20280002
* GROUP 1                                                               20310002
         TM    QELQFLGS,QELRESV   Q. RESERVE                            20340002
         BZ    ENQNRESV       A. NO 'RETURN CODE 0'                     20370002
* RESERVE AND GROUP 1                                                   20400002
         L     R15,PELUCBAA   GET THE UCB ADDR ADDR                     20430002
         L     R15,ZERO(R15)  GET THE UCB ADDR                          20460002
         SR    R14,R14        BUMP UCB RESERVE COUNT                    20490002
         IC    R14,UCBSQC-UCBOB(R15)  DITTO                             20520002
         LA    R14,ONE(R14)   DITTO                                     20550002
         STC   R14,UCBSQC-UCBOB(R15)  DITTO                             20580002
         TM    QELQFLGS,QELAUTH  CHECK FOR AUTH. INVOKER       @ZA17306 20584040
         BNO   ENQNAUT3       SKIP SYSEVENT                    @ZA17306 20588040
         LR    R1,R10         PASS MINOR QCB TO SRM            @ZA17306 20592040
         LH    R0,QELASID     PASS ASID TO SRM                 @ZA17306 20596040
         SYSEVENT ENQHOLD,ASID=(0),ENTRY=BRANCH                @ZA17306 20600040
ENQNAUT3 EQU   *                                               @ZA17306 20604040
         B     ENQYRESV       'RETURN CODE 0'                           20610002
ENQNGRP1 EQU   *              NOT GROUP 1                               20640002
* NOT GROUP 1                                                           20670002
         LH    R14,QELWCNT-QEL(R15)  BUMP THE WAIT COUNT                20700002
         LA    R14,ONE(R14)   DITTO                                     20730002
         STH   R14,QELWCNT-QEL(R15)  DITTO                              20760002
         C     R0,GSGRPNUM    Q. GROUP 2                                20790002
         BNE   ENQNGRP2       A. NO                                     20820002
* GROUP 2                                                               20850002
         LH    R14,GSGROUP2       Q. 1 QEL IN GROUP 2                   20880002
         CR    R0,R14         DITTO                                     20910002
         BNH   ENQNONE            A. NO.                                20940002
         LH    R1,GSGROUP1        GET NUMBER OF QELS IN GROUP 1         20970002
         L     R12,MINFQEL    GET FIRST QEL IN GROUP 1                  21000002
         BAL   R3,XHOLD       ISSUE THE HOLD EVENT FOR GROUP 1          21030002
ENQNONE  EQU   *              *                                         21060002
ENQNGRP2 EQU   *              *                                         21090002
* GROUP 2 OR MORE                                                       21120002
         TM    WAECBA,WAECBF  Q. ECB REQUEST                            21150002
         BO    ENQYECB        A. YES. 'RETURN CODE 4'                   21180002
         OI    WAFLAG2,WAWAIT SET WILL WAIT WITHIN ENQ.                 21210002
         L     R12,CVTPTR            GET CVT ADDRESS           @Z30BNVD 21212003
         L     R12,CVTASVT-CVT(R12)  GET ASVT ADDRESS          @Z30BNVD 21214003
         LA    R1,MINFQEL            PREPARE QEL PTR FOR LOOP  @Z30BNVD 21216003
NEXTQEL  EQU   *                     LOOP LABEL                @Z30BNVD 21218003
         L     R1,ZERO(R1)           GET FIRST/NEXT QEL ADDR   @Z30BNVD 21220003
         LTR   R1,R1                 Q. ANY MORE QELS          @Z30BNVD 21222003
         BZ    ENQNECB               A. NO. DONE               @Z30BNVD 21224003
         LH    R3,QELASID-QEL(R1)    GET ASID FROM QEL         @Z30BNVD 21226003
         BCTR  R3,ZERO               ASVT INDEX = ASID-1       @Z30BNVD 21228003
         SLL   R3,TWO                MULTIPLY INDEX BY 4       @Z30BNVD 21230003
         L     R3,ASVTENTY-ASVT(R3,R12)  GET ASCB ADDR         @Z30BNVD 21232003
         TM    ASCBDSP1-ASCB(R3),ASCBNOQ Q. ASCB REMOVED FROM          X21234003
                                            DISPATCHING QUEUE  @Z30BNVD 21236003
         BZ    NEXTQEL               A. NO. GO GET ANOTHER     @Z30BNVD 21237003
         OI    WAFLAG3,WALONGWT      LONG WAIT TO BE ISSUED    @Z30BNVD 21238003
         B     ENQNECB        'RETURN CODE 0'                           21240002
         EJECT                                                          21270002
ENQYA838 EQU   *              *                                         21300002
* REQUEST DENIED                                                        21330002
         MVI   WAERR,AB838    'ABEND CODE 838'                          21360002
         B     ENQPART2       PROCEED TO PART 2                         21390002
ENQYA638 EQU   *              'ABEND CODE 638'                          21420002
* OUT OF CORE                                                           21450002
ENQNCORE EQU   *              OUT OF CORE                               21480002
         MVI   WAERR,AB638    'ABEND CODE 638'                          21510002
         B     ENQPART2       PROCEED TO PART 2                         21540002
* ABEND CODE 538 IS OBSOLETE                                            21570002
ENQYA438 EQU   *              'ABEND CODE 438'                          21600002
* INVALID PARAMETER LIST                                                21630002
ENQYRESB EQU   *              'RESERVED BITS SPECIFIED'                 21660002
ENQNENTY EQU   *              *                                         21690002
ENQNDEV  EQU   *              *                                         21720002
ENQNTIOT EQU   *              *                                         21750002
ENQYCONF EQU   *              CONFLICTING PARAMETERS                    21780002
ENQNTCB1 EQU   *              *                                         21810002
         MVI   WAERR,AB438    'ABEND CODE 438'                          21840002
         B     ENQPART2       PROCEED TO PART 2                         21870002
ENQYA338 EQU   *              ' ABEND CODE 338 '                        21900002
* NOT AUTHORIZED FOR REQUESTED FUNCTION                                 21930002
ENQNAUTH EQU   *              CALLER NO AUTHORIZED                      21960002
         MVI   WAERR,AB338    ' ABEND CODE 338 '                        21990002
         B     ENQPART2       PROCEED TO PART 2                         22020002
ENQYA238 EQU   *              'ABEND CODE 238'                          22050002
ENQYMIL0 EQU   *              MINOR NAME LENGTH OF 0                    22080002
* MINOR NAME LENGTH 0                                                   22110002
         MVI   WAERR,AB238    'ABEND CODE 238'                          22140002
         B     ENQPART2       PROCEED TO PART 2                         22170002
ENQYRC20 EQU   *              'RETURN CODE 20'                          22200002
ENQYWTNG EQU   *              *                                         22230002
* TASK IS WAITING FOR RESOURCE                                          22260002
* RET=NONE (SEE ABEND 138)                                              22290002
         MVI   WARET,TWENTY   'RETURN CODE 20'                          22320002
         B     ENQPART2       PROCEED TO PART 2                         22350002
* RETURN CODE 12 AND 16 HAVE BECOME OBSOLETE                            22356002
ENQYRC8  EQU   *              *                                @YM03340 22359002
ENQNCHNG EQU   *              *                                @YM03340 22362002
ENQYHAVE EQU   *              *                                @YM03340 22368002
* TASK ALREADY OWNS RESOURCE                                            22374002
         NI    WAPLAST,XFF-PELSHR INDICATE EXCLUSIVE           @YM03340 22380002
*                                 RESOURCE CONTROL                      22383002
         TM    QELQFLGS-QEL(R11),QELSHARE  Q. SHARED RESOURCE  @YM03340 22386002
         BZ    ENQYXCLU       A. NO - EXCLUSIVE CONTROL        @YM03340 22392002
         OI    WAPLAST,PELSHR INDICATE SHARED RESOURCE         @YM03340 22398002
ENQYXCLU EQU   *              BYPASS SETTING OF SHR FLAG       @YM03340 22404002
ENQYCNG2 EQU   *              *                                         22440002
ENQYCNG1 EQU   *              *                                         22530002
ENQYCNG3 EQU   *              *                                         22560002
* RET=CHNG  NOTHING FOUND                                               22620002
* RET=NONE  NEVER (SEE ABEND CODE 138)                                  22650002
         MVI   WARET,EIGHT    'RETURN CODE 8'                           22680002
         B     ENQPART2       PROCEED TO PART 2                         22710002
ENQYRC4  EQU   *              *                                         22740002
ENQYSHRN EQU   *              *                                         22770002
ENQNGP1  EQU   *              *                                         22800002
ENQYECB  EQU   *              *                                         22830002
* RET=NONE  NEVER                                                       22860002
* RET=TEST  NOT AVAILABLE                                               22890002
* RET=USE   NOT AVAILABLE                                               22920002
* RET=HAVE  NEVER                                                       22950002
* RET=CHNG  CURRENTLY SHARING                                           22980002
* ECB=      NOTAVAILABLE, WAIT FOR POST                                 23010002
         MVI   WARET,FOUR     'RETURN CODE 4'                           23040002
         B     ENQPART2       PROCEED TO PART 2                         23070002
ENQYRC0  EQU   *              *                                         23100002
ENQYTEST EQU   *              *                                         23130002
ENQYCHNG EQU   *              *                                         23160002
ENQNRESV EQU   *              *                                         23190002
ENQNECB  EQU   *              *                                         23220002
ENQYRESV EQU   *              *                                         23250002
ENQYTST1 EQU   *              *                                         23280002
ENQYTST2 EQU   *              *                                         23310002
* RET=NONE  ASSIGNED                                                    23340002
* RET=TEST  IS AVAILABLE                                                23370002
* RET=USE   ASSIGNED                                                    23400002
* RET=HAVE  ASSIGNED                                                    23430002
* RET=CHNG  RESOURCE NOW EXCLUSIVE                                      23460002
* ECB=      ASSIGNED, DO NOT WAIT ON ECB                                23490002
         MVI   WARET,ZERO     ZERO RETURN CODE                 @YM04705 23500002
ENQYABN  EQU   *              *                                         23520002
         EJECT                                                          23550002
ENQPART2 EQU   *              ENQ PART TWO                              23580002
         CLI   WARET,ZERO     Q. IS THIS RETURN CODE ZERO               23610002
         BE    ENQYZERO       A. YES.                                   23640002
         OI    WAFLAG2,WAR15SW   INDICATE HAVE A NON ZERO RET CODE.     23670002
ENQYZERO EQU   *              *                                         23700002
         CLI   WAERR,ZERO     Q. ABEND REQUIRED.                        23730002
         BNE   ENQYABND       A. YES                                    23760002
         TM    WAPFLAG,PELRET1+PELRET2+PELRET3  Q. RET=NONE (DEFAULT)   23790002
         BNZ   ENQYSTOR       A. NO.STORE RET CODE.                     23820002
* RET=NONE                                                              23850002
         CLI   WARET,ZERO     Q. RETURN CODE OF ZERO                    23880002
         BE    ENQNSTOR       A. YES NOT A 138 AND DON'T STORE R.C.     23910002
         MVI   WAERR,AB138    CHANGE TO 138 ABEND.                      23940002
         B     ENQY138        'ABEND WITH CODE 138'                     23970002
ENQYSTOR EQU   *              *                                         24000002
         LR    R14,R8         CURRENT PEL                               24030002
         S     R14,WANEWPEL   PEL DISPLACEMENT                          24060002
         AL    R14,WAOLDPEL   CORRESPONDING OLD PEL                     24090002
         LH    R2,WAKEY       GET THE USERS KEY                         24120002
TEST6A   EQU   *              *                                         24150002
         MODESET  KEYADDR=(2)  SET PSW TO CALLERS KEY                   24180002
         SR    R15,R15        ZERO WORK REG                    @YM03340 24190002
         IC    R15,WARET      GET RETURN CODE                           24210002
         STC   R15,PELRET-PEL(R14)  STORE RETURN CODE.                  24240002
         C     R15,FEIGHT     Q. RETURN CODE 8                 @YM03340 24243002
         BNE   ENQNNO8        A. NO, SKIP ADDITIONAL SUPPORT   @YM03340 24246002
         NI    PELLAST-PEL(R14),XFF-PELSHR  INDICATE EXCLUSIVE @YM03340 24249002
         TM    WAPLAST,PELSHR Q. SHARED RESOURCE               @YM03340 24252002
         BZ    ENQYXCL        A. NO SKIP SETTING SHARE FLAG    @YM03340 24255002
         OI    PELLAST-PEL(R14),PELSHR  INDICATE SHARED        @YM03340 24258002
ENQYXCL  EQU   *              BYPASS SETTING OF SHR FLAG       @YM03340 24261002
ENQNNO8  EQU   *              BYPASS EXCLUSIVE/SHARE SUPPORT   @YM03340 24265002
TEST6B   EQU   *              *                                         24270002
         MODESET  EXTKEY=SUPR   SET KEY BACK TO ZERO                    24300002
ENQNSTOR EQU   *              *                                         24330002
         TM    PELLAST,PELEOL  Q. END OF LIST                           24360002
         BO    ENQYEOL        A. YES END OF LIST                        24390002
         TM    PELFLAG,PELSCPE2  Q. UCB PARM ELEM                       24420002
         BZ    ENQNUCB2       A. NO.                                    24450002
         TM    PELFLAG,PELSCPE1  Q. UCB PARM ELEM                       24480002
         BO    ENQNUCB2       A. NO.                                    24510002
         LA    R8,FOUR(R8)    COMPENSATE FOR UCB WORD                   24540002
ENQNUCB2 EQU   *              *                                         24570002
         LA    R8,PELELEM(R8)  BUMP TO NEXT ELEMENT                     24600002
         B     ENQQPEL        PROCESS THE NEXT ELEMENT                  24630002
ENQYEOL  EQU   *              YES END OF LIST                           24660002
         NI    WAFLAG1,XFF-WACMS  INDICATE FREED CMS                    24780002
X9       SETLOCK  RELEASE,TYPE=CMS,RELATED=((X4))  RELEASE CMS          24810002
TEST7    EQU   *              *                                         24840002
         NI    WAFLAG1,XFF-WAFRR  INDICATE DELETED FRR                  24870002
         SETFRR D,WRKREGS=(R14,R15) DELETE FRR.                         24900002
TEST8    EQU   *              *                                         24930002
         TM    WAFLAG2,WAWAIT   Q. MUST WAIT.                  @YM03564 24937002
         BZ    ENQNWAIT       A. NO. SKIP WAIT.                @YM03564 24944002
* WAIT                                                                  24951002
*                                                                       24951940
* NEED ESTAE EXIT TO COVER WAIT - CLEAN-UP RELATED CNTL BLKS   @ZA03873 24952840
* REGS 1, 13 AND 15 ARE USED DURING INTERFACE TO ESTAE         @Z40FPVD 24953540
         LR    R1,R5           DUPLICATE RB ADDR               @Z40FPVD 24954540
         LA    R13,ENQESTAE    ESTAE EXIT ROUTINE ADDR         @ZA03873 24957040
         S     R1,ERBPREL      RB PERFIX ADDR                  @Z40FPVD 24957540
         FESTAE EXITADR=(R13),RBADDR=(R1),TCBADDR=(R4),                X24958040
               PARAM=(R5),TERM=YES,RECORD=YES                  @Z40FPVD 24959040
         LA    R0,ONE         WAIT COUNT                                24960002
         TM    WAFLAG3,WALONGWT  Q. ISSUE LONG WAIT            @Z30BNVD 24970003
         BZ    NORMWAIT       A. NO. SKIP IT                   @Z30BNVD 24980003
         O     R0,HIGHBIT     LONG WAIT INDICATOR                       24990002
NORMWAIT EQU   *              ECB PREPARATION                  @Z30BNVD 25000003
         SR    R1,R1          ZERO ECB MEANS RB WAIT                    25020002
         L     R15,WAITADDR   GET BRANCH ENTRY TO WAIT                  25050002
         STM   R0,R15,TCBGRS-TCB(R4)  SAVE ENQ REGS                     25080002
         LA    R14,ENQXADDR   GET RESUME ADDRESS                        25110002
         ST    R14,RBOPSW+FOUR   SET RESUME ADDRESS.                    25140002
         NI    WAFLAG1,XFF-WALOCAL  WAIT FREES LOCK, FLAG OFF  @YM03564 25150002
TEST9    EQU   *              *                                         25170002
         BALR  R14,R15        WAIT WITH NO ECB.                         25200002
* THE ABOVE BALR IS ONLY AN ILLUSION                                    25230002
ENQXADDR EQU   *              GET RESUME ADDRESS                        25235002
         FESTAE 0,WRKREG=(R13)                                 @Z40FPVD 25239040
ENQNWAIT EQU   *              *                                         25290002
         TM    WAFLAG1,WASTATUS  Q. ISSUE STATUS                        25350002
         BZ    ENQNSTAT       A. NO                                     25380002
         TM    WAFLAG1,WALOCAL  Q. HOLD LOCAL LOCK             @YM03564 25381002
         BO    YLOCKED3       A. YES NO NEED TO OBTAIN         @YM03564 25382002
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=((X7))  @YM03564 25383002
         OI    WAFLAG1,WALOCAL  INDICATE LOCAL LOCK HELD       @YM03564 25384002
YLOCKED3 EQU   *              USED TO BYPASS OBTAIN OF LOCK    @YM03564 25385002
*        INITIALIZE PARAMETERS FOR BRANCH ENTRY TO STATUS      @YM03564 25390002
         L     R0,FONE        STEP MUST COMPLETE               @YM03564 25410002
         SR    R1,R1          SET AND CURRENT TCB              @YM03564 25415002
         L     R15,CVTPTR     LOCATE STATUS BRANCH ENTRY ADDR. @YM03564 25420002
         L     R14,CVTABEND-CVT(R15)  DITTO                    @YM03564 25425002
         L     R15,SCVTSTAT-SCVTSECT(R14)  DITTO               @YM03564 25430002
         BALR  R14,R15        SET MUST COMPLETE                @YM03564 25435002
TEST10   EQU   *              *                                         25440002
ENQNSTAT EQU   *              *                                         25470002
         BAL   R3,XENDUP      PERFORM END PROCESSING           @YM03564 25480002
         SR    R15,R15        ASSUME R15 ZERO.                          25500002
         TM    WAFLAG2,WAR15SW   Q. SET R15 TO ZERO                     25530002
         BZ    ENQYZ15        A. YES                                    25560002
         L     R15,WAOLDPEL   SET R15 TO PARM LIST ADDR.                25590002
ENQYZ15  EQU   *              *                                         25620002
         L     R14,CVTPTR     GET CVT ADDRESS                           25650002
TEST11   EQU   *              *                                         25680002
         L     R14,CVTEXPRO-CVT(R14)  GET EXIT ADDRESS.                 25710002
         BR    R14            RETURN                                    25740002
ENQY138  EQU   *              *                                         25770002
ENQYABND EQU   *              *                                         25800002
ENQXRTRY EQU   *              RETRY FROM HERE AFTER ERROR               25830002
* R5,R6,R7 AND R13 ARE SET CORRECTLY                                    25860002
         BAL   R3,XENDUP      PERFORM END PROCESSING                    25890002
         LA    R1,ENQCODE     GET BACK END OF ENQ CODE                  25920002
         ICM   R1,M0010,WAERR   GET FRONT OF ABEND CODE                 25950002
         ABEND (1),DUMP,,SYSTEM  ABEND MY CALLER                        25980002
         EJECT                                                          26010002
ENQESTAE EQU   *                  SOFTWARE RECOVERY ROUTINE    @ZA03873 26017040
         BALR  R15,ZERO           TEMP ADDRESSABILITY          @ZA03873 26017140
         USING *,R15              DITTO                        @ZA03873 26017240
         LM    R6,R7,BASE         PERMANENT ADDRESSABILITY     @ZA03873 26017340
         DROP  R15                                             @ZA03873 26017440
         USING IGC048,R6,R7       DITTO                        @ZA03873 26017540
         USING SDWA,R1                                         @ZA03873 26017640
         LA    R12,TWELVE         Q, SDWA AVAILABLE            @ZA03873 26017740
         CR    R0,R12             DITTO                        @ZA03873 26017840
         BE    ENQESKIP           A. NO, BYPASS CLEANUP, NO SA @ZA03873 26017940
         STM   R14,R12,TWELVE(R13) SAVE REGS IN SA             @ZA03873 26018040
         L     R5,SDWAPARM        PARM IS RB PTR               @ZA03873 26018840
         LR    R8,R13             SAVE SAVE AREA ADDR          @ZA03873 26018940
ENQEGLL  SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                @ZA03873X26019040
               RELATED=(ENQERLL)                               @ZA03873 26019240
         OI    WAFLAG1,WALOCAL     INDICATE LOCAL LOCK HELD    @ZA03873 26019340
         SETFRR A,PARMAD=(R12),FRRAD=ENQFRR,WRKREGS=(R10,R11)  @ZA03873 26020940
         ST    R5,ZERO(R12)       FRR INPUT - WA @ABILITY      @ZA03873 26021640
ENQEGCMS SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,RELATED=(ENQECMS) @ZA03873 26021840
         OI    WAFLAG1,WACMS      INDICATE CMS LOCK HELD       @ZA03873 26022040
         L     R13,CVTPTR         GET GLOBAL SAVE AREA ADDR    @ZA03873 26022240
         L     R13,CVTSPSA-CVT(R13) DITTO                      @ZA03873 26022440
         L     R13,WSAGNQDQ-WSAG(R13) DITTO                    @ZA03873 26022640
         XC    GSCLEAR(GSCLEARL),GSCLEAR ZERO COMMON GS        @ZA03873 26022840
         L     R14,PSAAOLD         SAVE THE ASID               @ZA03873 26023040
         MVC   GSASID(TWO),ASCBASID-ASCB(R14) DITTO            @ZA03873 26023240
         ST    R8,GSPSAVE          SAVE CALLERS SA ADDR        @ZA03873 26023440
         L     R8,WANEWPEL         GET CORRECT PLIST ADDR      @ZA03873 26023640
         L     R4,PSATOLD          SUBROUTINES NEED TCB ADDR   @ZA03873 26023740
ENQELOOP EQU   *                   RESTART RESOURCE SEARCH     @ZA03873 26023840
         BAL   R3,XFINDMAJ         FIND MATCHING MAJOR         @ZA03873 26024040
         LTR   R9,R9               Q. FOUND A MAJOR            @ZA03873 26024240
         BNP   ENQENELM            A. NO, SKIP ELEMENT         @ZA03873 26024440
         BAL   R3,XFINDMIN         FIND MATCHING MINOR         @ZA03873 26024640
         LTR   R10,R10             Q. FOUND A MINOR            @ZA03873 26024840
         BNP   ENQENELM            A. NO, SKIP ELEMENT         @ZA03873 26025040
         BAL   R3,XQELSCAN         SCAN THE  QELS              @ZA03873 26025240
         LTR   R11,R11             Q. FOUND MATCH QEL          @ZA03873 26025440
         BZ    ENQENELM            A. SKIP ELEMENT             @ZA03873 26025640
         BAL   R2,XDEQQEL          DEQUE CURRENT QEL           @ZA03873 26025840
ENQENELM EQU   *                   SKIPS PROCESSING OF ELEMENT @ZA03873 26026040
         TM    PELLAST,PELEOL      Q. END OF LIST              @ZA03873 26026240
         BO    ENQEDONE            A. YES, GET OUT             @ZA03873 26026440
         TM    PELFLAG,PELSCPE2    Q. UCB ADDR PRESENT         @ZA03873 26026640
         BZ    ENQENUCB            A. NO, GET NEXT ELEMENT     @ZA03873 26026840
         TM    PELFLAG,PELSCPE1    Q. UCB ADDR PRESENT         @ZA03873 26027040
         BZ    ENQENUCB            A. NO, GET NEXT ELEMENT     @ZA03873 26027240
         LA    R8,FOUR(R8)         COMPENSATE  FOR UCB WORD    @ZA03873 26027440
ENQENUCB EQU   *                   SKIPS UCB COMPENSATION      @ZA03873 26027640
         LA    R8,PELELEM(R8)      BUMP TO NEXT ELEMENT        @ZA03873 26027840
         B     ENQELOOP            PROCESS NEXT ELEMENT        @ZA03873 26028040
ENQEDONE EQU   *                   PLIST PROCESSING COMPLETE   @ZA03873 26028240
         L     R8,GSPSAVE          CALLERS SA ADDR             @ZA03873 26028440
         NI    WAFLAG1,XFF-WACMS   FREED CMS LOCK              @ZA03873 26028640
ENQECMS  SETLOCK RELEASE,TYPE=CMS,RELATED=(ENQEGCMS)           @ZA03873 26028840
         SETFRR D,WRKREGS=(R14,R15) DELETE FRR                 @ZA03873 26029040
ENQERLL  SETLOCK RELEASE,TYPE=LOCAL,RELATED=(ENQEGLL)          @ZA03873 26029240
         LR    R13,R8              RESTORE CALLERS REG 13      @ZA03873 26029440
         LM    R14,R12,TWELVE(R13) RESTORE REGS                @ZA03873 26029640
         LR    R8,R14              SAVE RETURN ADDR            @ZA03873 26029840
         SETRP DUMP=IGNORE,RC=0,RECORD=NO                      @ZA10756 26029940
         LR    R14,R8              RESET RETURN ADDR           @ZA03873 26030240
ENQESKIP EQU   *                   BYPASSES PLIST PROCESSING   @ZA03873 26030440
         SR    R15,R15             NO SDWA - CONT WITH TERM    @ZA03873 26030640
         BR    R14                 RETURN TO RTM               @ZA03873 26030840
         EJECT                                                          26031040
IEAVENQ2 EQU   *              RESOURCE MANAGER                          26040002
         STM   R14,R12,TWELVE(R13)  SAVE REGS                           26070002
         LR    R9,R13         SAVE CALLER'S REG 13                      26100002
         BALR  R6,ZERO        TEMP ADDRESSABILITY                       26130002
         USING *,R6                                                     26160002
         DROP  R7                                                       26190002
         LM    R6,R7,BASE     GET MODULE ADDRESSABILITY                 26220002
         USING IGC048,R6,R7   MODULE ADDRESSABILITY                     26250002
         USING RMPL,R8        RES. MGR. PARM LIST ADDRESSABILITY        26280002
         L     R8,ZERO(R1)    SAVE RMPL ADDRESS.                        26310002
         L     R5,RMPLRMWA    OBTAIN R.M. WORK AREA                     26340002
         LA    R14,RBEXSAVE-RBSECT   GET DISPLACEMENT TO XSAVE          26370002
         SLR   R5,R14         MAKE WORK AREA LOOK LIKE XSAVE            26400002
* REFERENCES ARE ONLY ALLOWED TO THE WORK AREA (NONE ALLOWED TO THE RB) 26430002
         XC    WA(WARMLEN),WA    ZERO R.M. SECTION                      26460002
         ICM   R4,M1111,RMPLTCBA  Q. MEMORY TERMINATION                 26490002
         BZ    ERMYMEM        A. YES. MUST CHECK ALL QELS.              26520002
* TASK TERMINATION                                                      26550002
         TM    TCBFLGS2,TCBFJMC   Q. THIS TASK IN STEP MUST COMPLETE    26580002
         BZ    ERMNSTAT       A. NO DONT ISSUE STATUS.                  26610002
         OI    WAFLAG2,WARMC   REMINDER TO ISSUE STATUS                 26640002
         TM    RMPLFLG1,RMPLTYPE  Q. ABNORMAL TERMINATION               26670002
         BZ    ERMNAB         A. NO.                                    26700002
         OI    WAFLAG1,WAABNDMC   INDICATE ABENDED IN MUST COMPLETE     26730002
ERMNAB   EQU   *              *                                         26760002
ERMNSTAT EQU   *              *                                         26790002
         CLI   TCBQEL,ZERO    Q. ANY QELS FOR THIS TASK                 26820002
         BE    ERMNQELS       A. NO. NOTHING TO DO.                     26850002
         B     ERMNMEM        CONTINUE                                  26880002
ERMYMEM  EQU   *              *                                         26910002
* MEMORY TERMINATION                                                    26940002
         L     R14,RMPLASCB   GET THE TERMINATED ASCB                   26970002
         CLI   ASCBSMCT-ASCB(R14),ZERO  Q. DID MEM FAIL IN M.C.         27000002
         BE    ERMNSMC        A. NO                                     27030002
         OI    WAFLAG1,WAABNDMC    A. YES. REMEMBER THIS.               27060002
ERMNSMC  EQU   *              *                                         27090002
ERMNMEM  EQU   *              *                                         27120002
* NEED TO SCAN QUEUES                                                   27150002
* INITIALIZE FOR MAIN LINE CODE                                         27180002
X5       SETLOCK  OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=((X7)) LOCK     27210002
TEST12   EQU   *              *                                         27240002
         OI    WAFLAG1,WALOCAL  INDICATE LOCAL LOCK SET                 27270002
         LA    R2,ERMFRR      SETUP RM RECOVERY                         27300002
         SETFRR  A,PARMAD=(R13),FRRAD=(R2),WRKREGS=(R14,R15)  COVER     27330002
TEST13   EQU   *              *                                         27360002
         OI    WAFLAG1,WAFRR  INDICATE A NEED TO RESET FRR.             27390002
         ST    R5,ZERO(R13)   FRR INPUT IS W.A. ADDRESSABILITY          27420002
X6       SETLOCK  OBTAIN,TYPE=CMS,MODE=UNCOND,RELATED=((X8)) LOCK       27450002
TEST14   EQU   *              *                                         27480002
         OI    WAFLAG1,WACMS  INDICATE CMS SET                          27510002
         L     R13,CVTPTR     GET CVT ADDRESS.                          27540002
TEST15   EQU   *              *                                         27570002
         L     R13,CVTSPSA-CVT(R13)   GET THE GLOBAL SAVE AREA TABLE    27600002
         L     R13,WSAGNQDQ-WSAG(R13)  GET ENQ GLOBAL SAVE AREA         27630002
         XC    GSCLEAR(GSCLEARL),GSCLEAR    RESET TO ZERO.              27660002
         ST    R9,GSPSAVE     SAVE CALLER'S REG 13                      27690002
         LH    R15,RMPLASID   SAVE THE ASID                             27720002
         STH   R15,GSASID     DITTO                                     27750002
         EJECT                                                          27780002
* MAIN PROCESSING                                                       27810002
         MVI   WARETRY,RETRYERM    PASS INDEX TO RETRY                  27840002
         USING PEL,R8         ADDRESSABILITY TO PEL.                    27870002
         LA    R8,DUMMYPEL    SETUP DUMMY PEL FOR QELSCAN RTN           27900002
         L     R9,CVTPTR      GET THE CVT ADDRESS                       27930002
TEST16   EQU   *              *                                         27960002
         L     R9,CVTFQCB-CVT(R9)  GET THE FIRST MAJOR QCB              27990002
ERMQMAJ  EQU   *              *                                         28020002
         LPR   R9,R9          Q. ANY MAJORS                             28050002
         BZ    ERMNMAJ        A. NO.  NONE LEFT.                        28080002
         L     R10,MAJFMIN    GET FIRST MINOR.                          28110002
ERMQMIN  EQU   *              *                                         28140002
         LPR   R10,R10        Q. ANY MOINORS                            28170002
         BZ    ERMNMIN        A. NO. NONE LEFT                          28200002
ERMQQEL  EQU   *              *                                         28230002
         L     R11,MINLQEL    DEQUEUE FROM BOTTOM.                      28260002
* DEQ FROM BOTTOM AVOIDS SOME OVERHEAD (POSTS,SYSEVENTS,ETC.)           28290002
ERMQQEL1 EQU   *              *                                         28320002
         LPR   R11,R11        Q. ANY QELS LEFT.                         28350002
         BZ    ERMNQEL        A.  NO.  TRY NEXT MINOR.                  28380002
         LH    R15,QELASID    Q. SAME MEMORY                            28410002
         CH    R15,GSASID     DITTO                                     28440002
         BE    ERMYQEL        A. YES. POSSIBLE DEQUEUE.                 28470002
         L     R11,QELPQEL    GET THE PREVIOUS QEL.                     28500002
         B     ERMQQEL1       LOOP                                      28530002
ERMYQEL  EQU   *              *                                         28560002
         BAL   R3,XQELSCAN    Q. MATCH FOR THIS ASID.TCB                28590002
         LTR   R11,R11        DITTO                                     28620002
         BZ    ERMNMTCH       A. NO.                                    28650002
* HAVE A MATCH QEL                                                      28680002
         TM    WAFLAG1,WAABNDMC  Q. NEED A WARNING MESSAGE.             28710002
         BZ    ERMNWTO        A. NO.                                    28740002
         TM    QELQFLGS,QELSHARE   Q. NEED FOR WARNING MESSAGE          28770002
         BO    ERMNWTO        A. NO                                     28800002
         TM    MINFLGS,MINSTEP   Q. NEED FOR WTO WARNING MSG            28830002
         BO    ERMNWTO        A. NO                                     28860002
         ICM   R12,M1111,QELLQEL  Q. HAVE THE LIST QEL ADDRESS.         28890002
         BM    ERMYHAVE       A. YES                                    28920002
         LR    R12,R11        A. NO. HAVE NOW.                          28950002
ERMYHAVE EQU   *              *                                         28980002
         ICM   R15,M0011,QELWCNT-QEL(R12)  Q. HAVE RESOURCE             29010002
         BNZ   ERMNWTO        A. NO. NEVER HAD THIS ONE.                29040002
         LA    R0,WTOLEN      GET MESSAGE LENGTH                        29070002
         L     R14,SP253      GET SUBPOOL                               29100002
         BAL   R12,XGET       GET STORAGE                               29130002
         LTR   R15,R15        Q. CAN WTO BE WRITTEN                     29160002
         BNZ   ERMNWTO        A. NO                                     29190002
* CONSTRUCT WTO MESSAGE                                                 29220002
         MVC   FOUR(WTOLEN-FOUR,R1),ERMWTO2  'RESOURCE MAY BE DAMAGED'  29250002
         MVC   INSERT6+FOUR(INSERT6L,R1),MAJNAME  MOVE IN MAJOR NAME    29280002
         SR    R15,R15        CLEAR FOR INSERT                          29310002
         IC    R15,MINNAMEL   GET LENGTH                                29340002
         CH    R15,HMAXLEN    Q. LENGTH LT MAXIMUM LENGTH               29370002
         BL    ERMYLESS       A. YES.                                   29400002
         LA    R15,INSERT7L   NO. SET TO MAXIMUM LENGTH.                29430002
ERMYLESS EQU   *              *                                         29460002
         BCTR  R15,ZERO       MOVE MINOR NAME TO GOTTEN STORAGE.        29490002
         EX    R15,MOVEMIN2   DITTO                                     29520002
         LA    R15,INSERT7+TWO(R1,R15) FORMULATE ADDRESS                29550002
         MVC   FOUR(MAYLEN,R15),MAYBEDAM  MOVE REST OF MESSAGE          29580002
         L     R15,WAWTOQ     GET TOP OF QUEUE                          29610002
         ST    R15,ZERO(R1)   SAVE TOP                                  29640002
         ST    R1,WAWTOQ      CHAIN THIS ONE.                           29670002
ERMNWTO  EQU   *              *                                         29700002
         BAL   R2,XDEQQEL     DEQ THE MATCH QEL                         29730002
         LTR   R9,R9          Q. DID MAJOR CHANGE                       29760002
         BNP   ERMQMAJ        A. YES. PROCESS MAJOR.                    29790002
         LTR   R10,R10        Q. MINOR CHANGE                           29820002
         BNP   ERMQMIN        A. YES. PROCESS MINOR.                    29850002
         B     ERMQQEL        PROCESS QEL                               29880002
ERMNQEL  EQU   *              *                                         29910002
ERMNMTCH EQU   *              *                                         29940002
         L     R10,MINNMIN    GET NEXT MINOR                            29970002
         B     ERMQMIN        LOOP ON MINOR QUEUE                       30000002
ERMNMIN  EQU   *              *                                         30030002
         L     R9,MAJNMAJ     GET NEXT MAJOR                            30060002
         B     ERMQMAJ        LOOP ON MAJOR QUEUE.                      30090002
ERMNMAJ  EQU   *              *                                         30120002
* PROCESSED ALL QELS.                                                   30150002
         ICM   R15,M1111,WAWTOQ  Q. ANY WTO'S                           30180002
         BZ    ERMNWTOS       A. NO.                                    30210002
         LA    R0,WTOLEN      GET CORE FOR WTO.                         30240002
         L     R14,SP253      GET SUBPOOL NUMBER                        30270002
         BAL   R12,XGET       GET STORAGE                               30300002
         LTR   R15,R15        Q. CAN WTO BE WRITTEN                     30330002
         BNZ   ERMNWTOS       A. NO.                                    30360002
         MVC   FOUR(WTOLEN-FOUR,R1),ERMWTO1 'JOB FAILED IN STEP M.C.'   30390002
         LTR   R4,R4          Q. TCB                                    30420002
         BZ    ERMNTCB        A. NO.                                    30450002
         ICM   R15,M1111,TCBTIO  Q. TIOT.                               30480002
         BZ    ERMNTIOT       A. NO.                                    30510002
         MVC   INSERT3+FOUR(INSERT3L,R1),TIOCNJOB-TIOT1(R15) JOB NAME   30540002
         MVI   INSERT4+FOUR(R1),C','   COMMA                            30570002
         MVC   INSERT5+FOUR(INSERT5L,R1),TIOCSTEP-TIOT1(R15) STEP NAME  30600002
ERMNTIOT EQU   *              *                                         30630002
         C     R4,TCBJSTCB    Q. JOB STEP TCB.                          30660002
         BE    ERMYJBST       A. YES                                    30690002
         MVC   INSERT5A+FOUR(TWO,R1),ST  MOVE IN STEP                   30720002
ERMYJBST EQU   *              *                                         30750002
         L     R15,WAWTOQ     GET TOP OF QUEUE                          30780002
         ST    R15,ZERO(R1)   SAVE TOP                                  30810002
         ST    R1,WAWTOQ      CHAIN THIS ONE.                           30840002
         LA    R0,WTOLEN      GET CORE FOR WTO.                         30870002
         L     R14,SP253      GET SUBPOOL NUMBER                        30900002
         BAL   R12,XGET       GET STORAGE                               30930002
         LTR   R15,R15        Q. CAN WTO BE WRITTEN                     30960002
         BNZ   ERMNWTOS       A. NO.                                    30990002
         MVC   FOUR(WTOLEN-FOUR,R1),ERMWTP 'JOB FAILED IN M.C. (CODE)'  31020002
         C     R4,TCBJSTCB    Q. JOB STEP TCB                           31050002
         BE    ERMYJS         A. YES.                                   31080002
         MVC   INSERT1+FOUR(INSERT1L,R1),ST  MOVE IN STEP ABREV.        31110002
ERMYJS   EQU   *              *                                         31140002
         MVO   ZERO(THREE,R1),TCBCMPC(TWO) MOVE ABC TO 0ABC             31170002
         ICM   R15,M1100,ZERO(R1)    Q. SYSTEM CODE                     31200002
         BNZ   ERMYSYST       A. YES.                                   31230002
         MVI   INSERT2+FOUR(R1),C'U'  A.NO. USER CODE.                  31260002
         MVC   ZERO(TWO,R1),TCBCMPC+ONE  MOVE XABC TO XABC              31290002
ERMYSYST EQU   *              *                                         31320002
         UNPK  ZERO(FOUR,R1),ZERO(THREE,R1)  UNPACK XABC TO FAFBFC      31350002
         TR    ZERO(THREE,R1),TABLE-C'0'   TRANSLATE FAFBFC TO C'ABC'   31380002
         MVC   INSERT2+FOUR+ONE(THREE,R1),ZERO(R1)  MOVE RESULT.        31410002
ERMNTCB  EQU   *              *                                         31440002
         L     R15,WAWTOQ     GET TOP OF QUEUE                          31470002
         ST    R15,ZERO(R1)   SAVE TOP                                  31500002
         ST    R1,WAWTOQ      CHAIN THIS ONE.                           31530002
ERMNWTOS EQU   *              *                                         31560002
ERMXRTRY EQU   *              *                                         31590002
         L     R9,GSPSAVE     GET CALLER'S REG 13                       31620002
ERMNQELS EQU   *              *                                         31650002
         BAL   R3,XENDUP      CLEAN UP WHERE NECESSARY                  31680002
ERMQWTO1 EQU   *              *                                         31710002
         ICM   R12,M1111,WAWTOQ  Q. ANY WTO MESSAGES.                   31740002
         BZ    ERMNWTO1       A. NO.                                    31770002
         L     R15,NEXT(R12)  UNCHAIN                                   31800002
         ST    R15,WAWTOQ     DITTO                                     31830002
* WRITE MESSAGE                                                         31860002
         LA    R1,FOUR(R12)   GET MESSAGE ADDRESS                       31890002
         LH    R0,ZERO(R1)    GET LENGTH                                31920002
         WTO   MF=(E,(1))     WRITE TO OPERATOR OR PROGRAMER            31950002
TEST18   EQU   *              *                                         31980002
         LA    R0,WTOLEN      GET LENGTH TO FREE                        32010002
         LR    R1,R12         PASS ADDRESS TO FREE                      32040002
         L     R14,SP253      GET SUBPOOL                               32070002
         BAL   R12,XSVCFREE   FREE THE STORAGE                          32100002
         B     ERMQWTO1       LOOP.                                     32130002
ERMNWTO1 EQU   *              *                                         32160002
         LR    R13,R9         RESTORE CALLER'S REG13                    32190002
         LM    R14,R12,TWELVE(R13)  RESTORE REGS.                       32220002
TEST19   EQU   *              *                                         32250002
         BR    R14            RETURN                                    32280002
BASE     DC    A(IGC048)      FIRST BASE REGISTER VALUE                 32300040
BASE1    DC    A(IGC048+4096) SECOND BASE REGISTER VALUE                32320040
         EJECT                                                          36120002
XDEQQEL  EQU   *              DEQUEUE THE INPUT QEL                     36150002
* INPUT--                                                               36180002
* R11 IS THE QEL TO BE DEQUEUED                                         36210002
         ICM   R12,M1111,QELLQEL  Q. IS CURRENT QEL A SUB QEL           36240002
         BM    YSUBQEL        A. YES                                    36270002
* MAY HAVE TO DECREMENT THE TCBQEL COUNT (NUMBER OF LIST QELS)          36300002
         LR    R12,R11        A. NO. CURRENT IS A LIST QEL              36330002
YSUBQEL  EQU   *              *                                         36360002
         LH    R1,QELLCNT-QEL(R12)  GET THE NUMBER OF ACTIVE QELS.      36390002
         BCTR  R1,ZERO        DITTO                                     36420002
         STH   R1,QELLCNT-QEL(R12)  DITTO                               36450002
         LA    R0,ONE         USED FOR COMPARE                          36480002
         C     R0,GSGRPNUM    Q. MATCH IN GROUT 1                       36510002
         BNE   NGROUP1        A. NO                                     36540002
* THE MATCH QEL IS IN GROUP 1                                           36570002
         TM    QELLFLGS-QEL(R12),QELPOST+QELECBF Q. SPOST NECESSARY     36600002
         BNO   NSPOST         A. NO.                                    36630002
         OI    WAFLAG1,WASPOST  INDICATE SPOST MUST BE ISSUED.          36660002
NSPOST   EQU   *              *                                         36690002
         LH    R1,GSGROUP2    GET NUMBER OF QELS IN GRP 2               36720002
         LTR   R1,R1          Q. GROUP 2 EXIST                          36750002
         BZ    NGROUP2        A. NO                                     36780002
* MATCH IN GRP 1 AND GRP 2 EXISTS                                       36810002
         CH    R0,GSGROUP1    Q. LAST QEL IN GROUP 1                    36840002
         BNE   NALONE         A. NO.                                    36870002
* LAST QEL IN GROUP 1 AND A GROUP 2 EXISTS.                             36900002
         L     R12,QELNQEL    GET THE 1ST QEL IN GROUP 2                36930002
         BAL   R3,XPOST       POST GROUP 2                              36960002
         LH    R1,GSGROUP3    GET QEL COUNT FOR GRP 3                   36990002
         LTR   R1,R1          Q. GROUP 3 EXIST                          37020002
         BZ    NGROUP3        A. NO.                                    37050002
         L     R12,QELNQEL    GET 1ST QEL IN GROUP 2                    37080002
         LH    R1,GSGROUP2    GET GROUP 2 QEL COUNT.                    37110002
         BAL   R3,XHOLD       ISSUE SYSEVENT FOR GROUP 2                37140002
NGROUP3  EQU   *              *                                         37170002
NALONE   EQU   *              *                                         37200002
         LA    R1,ONE         NUMBER OF QELS TO BE RLSE'D               37230002
         LR    R12,R11        RLSE CURRENT QEL                          37260002
         BAL   R3,XRLSE       ISSUE SYSEVENT FOR THIS QEL               37290002
NGROUP2  EQU   *              *                                         37320002
         TM    QELQFLGS,QELRESV   Q. IS CURRENT QEL RESERVE QEL         37350002
         BZ    NRESERVE       A. NO.                                    37380002
* MATCH QEL IS IN GROUP 1 AND IS RESERVE                                37410002
         TM    QELQFLGS,QELLIST  Q. LIST QEL                            37440002
         L     R12,QELSIZE1(R11)   GET THE UCB ADDRESS                  37470002
         BZ    NLSTQEL        A. NO.                                    37500002
         L     R12,QELSIZE2(R11)   GET THE UCB ADDRESS                  37530002
NLSTQEL  EQU   *              *                                         37560002
* GROUP 1 AND RESERVE AND DASD DEVICE IS SHARABLE                       37590002
         SR    R0,R0          ZERO FOR INSERT                           37620002
         IC    R0,UCBSQC-UCBOB(R12)  DECREMENT THE RESERVE COUNT        37650002
         S     R0,FONE        DITTO                                     37680002
         STC   R0,UCBSQC-UCBOB(R12)  DITTO                              37710002
         TM    QELQFLGS,QELAUTH  CHECK FOR AUTH. INVOKER       @ZA17306 37713040
         BNO   ENQNAUT4       SKIP SYSEVENT                    @ZA17306 37716040
         LR    R1,R10         PASS MINOR QCB TO SRM            @ZA17306 37719040
         LH    R0,QELASID     PASS ASID TO SRM                 @ZA17306 37722040
         SYSEVENT ENQRLSE,ASID=(0),ENTRY=BRANCH                @ZA17306 37725040
ENQNAUT4 EQU   *                                               @ZA17306 37728040
         CLI   UCBSQC-UCBOB(R12),ZERO  CHECK RESERVE COUNT     @ZA17306 37731040
         BNZ   NRELEASE       COUNT DID NOT GO TO ZERO                  37740002
         TM    UCBFLB-UCBOB(R12),UCBRESVH Q. RESV. OUTSTANDING @YA00805 37741003
         BZ    NRELEASE       A. NO. SKIP RELEASE              @YA00805 37743003
* GRP 1 AND RESERVE AND SHRD DASD AND RESV COUNT HIT ZERO               37770002
* RELEASE THE RESERVED DEVICE (IF NOT ALREADY RELEASED)                 37800002
         STM   R0,R15,GSSAVE1  SAVE REGS ACROSS 'STARTIO'               37830002
         LR    R2,R12         SAVE UCB ADDRESS.                         37860002
         L     R14,SP245      GET SUBPOOL NUMBER                        37890002
         LA    R0,ZLEN        GET LENGTH FOR IOSB AND SRB               37920002
         BAL   R12,XGET       GET CORE FOR IOSB AND SRB                 37950002
         LTR   R15,R15        Q. CORE GOTTEN                            37980002
         BNZ   NSIOCORE       A. NO. IGNORE 'STARTIO'                   38010002
         LA    R3,ZSRB-Z(R1)  GET SRB ADDRESS.                          38040002
         LA    R4,ZIOSB-Z(R1) GET IOSB ADDRESS.                         38070002
         XC    Z-Z(ZLEN,R1),Z-Z(R1)   INITIALIZE IOSB AND SRB TO ZERO.  38100002
         ST    R4,SRBPARM-SRB(R3)   PASS IOSB ADDRESS AS PARAMETER      38130002
         OI    IOSOPT-IOSB(R4),IOSBYP+IOSRELSE  BYPASS CK.ADD RLSE CCW  38160002
         OI    IOSDVRID-IOSB(R4),IOSMISID  SET MISCELLANEOUS I.D.       38190002
         MVI   IOSASID+ONE-IOSB(R4),ONE    I/O RELATED TO MASTER A.S.   38220002
         LA    R1,XSTARTIO    ADDRESS OF SCHEDULED ROUTINE.             38250002
         ST    R1,IOSPGAD-IOSB(R4)  SAVE IT.                            38280002
         ST    R2,IOSUCB-IOSB(R4)  PASS UCB ADDRESS.                    38310002
         LA    R14,BR14       ADDRESS OF NOP EXIT ROUTINE.              38340002
         ST    R14,IOSNRM-IOSB(R4)  NOP NORMAL EXIT ROUTINE             38370002
         ST    R14,IOSABN-IOSB(R4)  NOP ABNORMAL EXIT ROUTINE           38400002
         STARTIO  SRB=(3)     RELEASE DEVICE, IF NEED BE.      @YM04188 38430002
NSIOCORE EQU   *              *                                         38460002
         LM    R0,R15,GSSAVE1  RESTORE REGS                             38490002
NRELEASE EQU   *              *                                         38520002
NRESERVE EQU   *              *                                         38550002
         B     YGROUP1        CONTINUE.                                 38580002
NGROUP1  EQU   *              *                                         38610002
* MATCH NOT IN GROUP 1                                                  38640002
         LH    R1,QELWCNT-QEL(R12)  LOWER THE WAIT COUNT.               38670002
         BCTR  R1,ZERO        DITTO                                     38700002
         STH   R1,QELWCNT-QEL(R12)  DITTO                               38730002
         LA    R0,TWO         USE FOR COMPARE                           38760002
         C     R0,GSGRPNUM    Q. MATCH IN GROUP 2                       38790002
         BNE   NGRP2          A. NO.                                    38820002
* MATCH QEL IS IN GROUP 2                                               38850002
         LA    R0,ONE         USE FOR COMPARE                           38880002
         CH    R0,GSGROUP2    Q. LAST QEL IN GROUP 2                    38910002
         BNE   NALONE1        A. NO.                                    38940002
* MATCH IN GRP 2 AND LAST QEL IN GROUP 2                                38970002
         L     R12,MINFQEL    GET 1ST QEL IN GROUP 1                    39000002
         CH    R0,GSGROUP3    Q. GRP 3 EXIST                            39030002
         BNH   YGRP3              A. YES.                               39060002
* MATCH IN GRP 2 AND LAST QEL IN GRP 2 AND THERE IS NO GROUP 3          39090002
         LH    R1,GSGROUP1    GET THE NUMBER OF QELS IN GROUP 1         39120002
         BAL   R3,XRLSE       ISSUE SYSEVENT FOR GROUP 1                39150002
         B     NGRP3          CONTINUE.                                 39180002
YGRP3    EQU   *              *                                         39210002
* MATCH IN GRP 2 AND LAST QEL IN GROUP 2 AND A GRP 3 EXISTS             39240002
         TM    QELQFLGS-QEL(R12),QELSHARE  Q. GRP 1 SHARE               39270002
         BZ    NSHARE         A. NO.                                    39300002
         L     R12,QELNQEL    GET 1ST QEL IN GROUP 3                    39330002
         TM    QELQFLGS-QEL(R12),QELSHARE  Q. GRP 3 SHARE               39360002
         BZ    NSHARE         A. NO.                                    39390002
*  MATCH QEL IS ONLY QEL IN GRP 2 AND GRPS 1 & 3 ARE SHARE              39420002
         LH    R1,GSGROUP3    GET QEL COUNT FOR GROUP 3                 39450002
         BAL   R3,XPOST       POST GROUP 3                              39480002
         SR    R0,R0          USE FOR COMPARE                           39510002
         CH    R0,GSGROUP4    Q. GRP 4 EXIST                            39540002
         BNE   YGRP4          A. YES.                                   39570002
* MATCH QEL IS LONE QEL IN GRP 2 AND GRPS 1&3 ARE SHARE AND NO GRP 4    39600002
         LH    R1,GSGROUP1    GET NUMBER OF QELS IN GROUP 1             39630002
         L     R12,MINFQEL    GET 1ST QEL IN GROUP 1                    39660002
         BAL   R3,XRLSE       ISSUE SYSEVENT FOR GROUP 1                39690002
         B     NGRP4          CONTINUE.                                 39720002
YGRP4    EQU   *              *                                         39750002
* MATCH QEL IS LONE QEL IN GRP 2 AND GRPS 1&3 ARE SHARE AND A GRP 4     39780002
         LH    R1,GSGROUP3    GET NUMBER OF QELS IN GROUP 3             39810002
         L     R12,QELNQEL    GET 1ST QEL IN GROUP 3                    39840002
         BAL   R3,XHOLD       ISSUE SYSEVENT FOR GROUP 3                39870002
NGRP4    EQU   *              *                                         39900002
NSHARE   EQU   *              *                                         39930002
NGRP3    EQU   *              *                                         39960002
NALONE1  EQU   *              *                                         39990002
NGRP2    EQU   *              *                                         40020002
YGROUP1  EQU   *              *                                         40050002
* MOST OF DEQUEUE COMPLETE                                              40080002
* FREE THE QEL (POSSIBLY THE MINOR AND THEN POSSIBLY THE MAJOR)         40110002
* FREEQMM                                                               40140002
         LR    R12,R11        SAVE QEL TO BE FREED.                     40170002
         L     R11,QELNQEL    SET CURRENT QEL TO NEXT QEL               40200002
         LCR   R11,R11        INDICATE A QEL CHANGE                     40230002
* UNCHAIN THE INPUT QEL                                                 40260002
         LA    R1,MINFQEL     PASS FIRST/LAST TO UNCHAIN RTN            40290002
         BAL   R3,XUNCHAIN    UNCHAIN                                   40320002
         TM    QELQFLGS-QEL(R12),QELLIST  Q. IS THIS A LIST QEL         40350002
         BO    YLISTQEL       A. YES.                                   40380002
         LR    R1,R12         PASS QEL TO BE FREED.                     40410002
         L     R12,QELLQEL-QEL(R12)  GET THE LIST QEL ADDRESS.          40440002
         ST    R12,GSR2SAVE   SAVE THE LIST QEL ADDRESS                 40470002
         BAL   R3,XFREEQEL    FREE THE SUB QEL                          40500002
         L     R12,GSR2SAVE   RESTORE THE LIST QEL ADDRESS              40530002
YLISTQEL EQU   *              *                                         40560002
         ICM   R0,M0011,QELLCNT-QEL(R12)  Q. CAN LIST QEL BE FREED.     40590002
         BNZ   NFREE          A. NO.                                    40620002
         LTR   R4,R4          Q. POSSIBLE TO DECREMENT                  40650002
         BZ    NDECR          A. NO. TCB NOT THERE                      40680002
* DECREMENT                                                             40732040
         L     R14,QELTCB-QEL(R12)   GET THE QEL TCB                    40740002
*        DO NOT DECREMENT THE TCB LIST QEL COUNT IF IT IS 255. @ZA20351 40742040
*        TO PREVENT WRAPPING, WHEN TCBQEL IS INCREMENTED, IT   @ZA20351 40744040
*        IS NOT INCREMENTED BEYOND 255. THAT MAKES IT          @ZA20351 40746040
*        NECESSARY TO NOT DECREMENT TCBQEL ONCE IT REACHES 255.@ZA20351 40748040
*        (IF IT WERE DECREMENTED FROM 255, IT MIGHT REACH 0    @ZA20351 40750040
*        PREMATURELY.) THE ONLY EFFECT OF LEAVING THE COUNT AT @ZA20351 40752040
*        255 IS THAT THE RESOURCE MANAGER WILL SCAN            @ZA20351 40754040
*        FOR UN-DEQED RESOURCES EVEN WHEN THE TASK DOES        @ZA20351 40756040
*        NOT HAVE ANY ENQED RESOURCES.                         @ZA20351 40758040
         CLI   TCBQEL-TCB(R14),XFF                             @ZA20351 40760040
         BE    NDECR          DO NOT DECREMENT                 @ZA20351 40762040
         IC    R1,TCBQEL-TCB(R14)  DECREMENT THE TCB QEL COUNT          40770002
         BCTR  R1,ZERO        DITTO                                     40796040
         STC   R1,TCBQEL-TCB(R14)   DITTO                               40830002
NDECR    EQU   *              *                                         40860002
         LA    R1,ZERO(R12)   PASS THE LIST QEL ADDRESS                 40890002
         BAL   R3,XFREEQEL    FREE THE LIST QEL                         40920002
NFREE    EQU   *              *                                         40950002
         ICM   R15,M1111,MINFQEL  Q. MINOR EMPTY                        40980002
         BNZ   YQEL           A. NO.                                    41010002
* UNCHAIN THE MINOR.                                                    41040002
         LR    R12,R10        GET MINOR TO BE FREED.                    41070002
         L     R10,MINNMIN    MAKE NEXT THE CURRENT                     41100002
         LCR   R10,R10        INDICATE A MINOR CHANGE                   41130002
         LA    R1,MAJFMIN     PASS ADDR OF FIRST/LAST                   41160002
         BAL   R3,XUNCHAIN    UNCHAIN THE MINOR.                        41190002
         LR    R1,R12         PASS ADDRESS TO BE FREED                  41220002
         BAL   R3,XFREEMIN    FREE THE MINOR.                           41250002
         ICM   R15,M1111,MAJFMIN   Q. MAJOR EMPTY                       41280002
         BNZ   YMIN               A. NO.                                41310002
* UNCHAIN THE MAJOR                                                     41340002
         LR    R12,R9         MAJOR TO BE FREED.                        41370002
         L     R9,MAJNMAJ     MAKE NEXT MAJOR CURRENT                   41400002
         LCR   R9,R9          INDICATE A MAJOR CHANGE                   41430002
         L     R1,CVTPTR      GET CVT ADDRESS.                          41460002
TEST21   EQU   *              *                                         41490002
         LA    R1,CVTFQCB-CVT(R1)  GET FIRST/LAST ADDRESS.              41520002
         BAL   R3,XUNCHAIN    UNCHAIN THE MAJOR.                        41550002
         LR    R1,R12         PASS ADDRESS TO FREE                      41580002
         BAL   R3,XFREEMAJ    FREE THE MAJOR.                           41610002
YMIN     EQU   *              *                                         41640002
YQEL     EQU   *              *                                         41670002
* COMPLEMENTED REGISTER INDICATES A CHANGE TO THAT QUEUE.               41700002
* THE COMPLEMENTED ADDRESS IS THE NEW CURRENT ADDRESS.                  41730002
         BR    R2             RETURN                                    41760002
         EJECT                                                          41790002
XENDUP   EQU   *              *                                         41820002
         TM    WAFLAG1,WACMS  Q. HAVE CMS.                              41850002
         BZ    NCMS           A. NO.                                    41880002
         NI    WAFLAG1,XFF-WACMS  INDICATE FREED CMS                    41910002
X8       SETLOCK  RELEASE,TYPE=CMS,RELATED=((X4),(X6)) UNLOCK           41940002
TEST22   EQU   *              *                                         41970002
NCMS     EQU   *              *                                         42000002
         TM    WAFLAG1,WAFRR   Q. HAVE AN FRR                           42030002
         BZ    NFRR1          A. NO                                     42060002
         SETFRR D,WRKREGS=(R14,R15) DELETE FRR.                         42090002
TEST23   EQU   *              *                                         42120002
NFRR1    EQU   *              *                                         42150002
         TM    WAFLAG2,WANWPEL   Q. WAS PARM LIST CORE GOTTEN           42540002
         BZ    NMOVE          A. NO                                     42570002
         TM    WAFLAG1,WALOCAL  Q. HOLD LOCAL LOCK             @YM03564 42575002
         BO    YLOCKED1       A. YES, NO NEED TO OBTAIN        @YM03564 42580002
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=((X7))  @YM03564 42585002
         OI    WAFLAG1,WALOCAL  INDICATE LOCAL LOCK HELD       @YM03564 42590002
YLOCKED1 EQU   *              USED TO BYPASS OBTAIN OF LOCK    @YM03564 42595002
         L     R1,WANEWPEL    GET ADDRESS OF CORE TO FREE               42600002
         L     R0,WAPARMSZ    GET THE STORAGE LENGTH                    42630002
         A     R0,WANAMESZ    DITTO                                     42660002
         L     R14,SP253      GET SUBPOOL                               42690002
         BAL   R12,XFREE      FREE THE STORAGE                 @YM03564 42720002
NMOVE    EQU   *              *                                         42750002
         TM    WAFLAG2,WARMC  Q. ISSUE RESET M.C.                       42780002
         BZ    NRMC           A. NO.                                    42810002
         TM    WAFLAG1,WALOCAL  Q. HOLD LOCAL LOCK             @YM03564 42815002
         BO    YLOCKED2       A. YES, NO NEED TO OBTAIN        @YM03564 42819002
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=((X7))  @YM03564 42823002
         OI    WAFLAG1,WALOCAL  INDICATE LOCAL LOCK HELD       @YM03564 42827002
YLOCKED2 EQU   *              USED TO BYPASS OBTAIN OF LOCK    @YM03564 42831002
* INITIALIZE PARAMETERS FOR BRANCH ENTRY TO STATUS             @YM03564 42835002
         L     R0,FONE        STEP MUST COMPLETE               @YM03564 42840002
         L     R1,HIGHBIT     RESET AND CURRENT TCB            @YM03564 42845002
         L     R15,CVTPTR     LOCATE STATUS BRANCH ENTRY ADDR. @YM03564 42850002
         L     R14,CVTABEND-CVT(R15)  DITTO                    @YM03564 42855002
         L     R15,SCVTSTAT-SCVTSECT(R14)  DITTO               @YM03564 42860002
         BALR  R14,R15        RESET MUST COMPLETE STATUS       @YM03564 42865002
TEST26   EQU   *              *                                         42870002
NRMC     EQU   *              *                                         42900002
         TM    WAFLAG1,WALOCAL      Q. HAVE LOCAL LOCK         @YM03564 42902002
         BZ    NLOCAL         A. NO.                           @YM03564 42904002
X7       SETLOCK  RELEASE,TYPE=LOCAL,RELATED=((X3),(X5))       @YM03564 42906002
TEST24   EQU   *              *                                @YM03564 42908002
NLOCAL   EQU   *              *                                @YM03564 42910002
         TM    WAFLAG2,WADAMAGE  Q. QUEUES BEEN DAMAGED.       @YM03564 42912002
         BZ    NDAMAGE        A. NO.                           @YM03564 42914002
         LA    R1,FRRWTO      GET Q-DAMAGE MESSAGE             @YM03564 42916002
         LH    R0,ZERO(R1)    GET LENGTH                       @YM03564 42918002
         WTO   MF=(E,(1))     WRITE IT.                        @YM03564 42920002
TEST25   EQU   *              *                                @YM03564 42922002
NDAMAGE  EQU   *              *                                @YM03564 42924002
         TM    WAFLAG1,WASPOST  Q. ISSUE SPOST                          42930002
         BZ    NSPOST1        A. NO.                                    42960002
         SPOST                                                          42990002
TEST29   EQU   *              *                                         43020002
NSPOST1  EQU   *              *                                         43050002
         BR    R3             RETURN.                                   43080002
         EJECT                                                          43110002
XFINDMAJ EQU   *              *                                         43140002
         L     R9,CVTPTR      GET ADDRESS OF CVT                        43170002
TEST30   EQU   *              *                                         43200002
         ICM   R9,M1111,CVTFQCB-CVT(R9)  Q. ANY MAJOR                   43230002
         L     R12,PELMAJA    GET ADDRESS OF QNAME                      43260002
QMAJOR   EQU   *              *                                         43290002
         BZR   R3             A. NO.                                    43320002
         CLC   ZERO(EIGHT,R12),MAJNAME    Q. MAJOR NAMES MATCH          43350002
         BER   R3             A. YES, STOP SEARCH                       43380002
         ICM   R9,M1111,MAJNMAJ   Q. ANY MORE MAJORS                    43410002
         B     QMAJOR         GO CHECK RESULTS                          43440002
         EJECT                                                          43470002
XFINDMIN EQU   *              *                                         43500002
* INPUT--                                                               43530002
* R3 IS THE RETURN REGISTER.                                            43560002
* R8 HAS POINTER TO INPUT PARM ELEM.                                    43590002
* PELSCPE1,PELSCPE2,PELMINA,PELMILEN                                    43620002
* INPUT MINOR NAME (POINTED TO BY PELMINA)                              43650002
* R9 CONTAINS POINTER TO CURRENT MAJOR                                  43680002
* MAJFMIN                                                               43710002
* MINNMIN,MINSTEP,MINSYS,MINSYSS,MINASID,MINNAMEL,MINNAME               43740002
* R13 HAS POINTER TO GS (GLOBAL SAVE)                                   43770002
* GSASID                                                                43800002
* PROCESS--                                                             43830002
* R10 IS USED FOR CURRENT MINOR IN MINOR SEARCH.                        43860002
* R12 IS USED TO POINT TO THE INPUT MINOR NAME.                         43890002
* R14 IS USED AS A QUICKY REGISTER                                      43920002
* R15(LOW ORDER BYTE) CONTAINS THE INPUT PARM ELEM'S MINOR LENGTH.      43950002
* OUTPUT--                                                              43980002
* R10 CONTAINS THE MATCHING MINOR (FIND) OR ZERO (NO FIND)              44010002
* R12,R14,R15 ARE DESTROYED.                                            44040002
         L     R10,MAJFMIN    GET THE FIRST MINOR.                      44070002
         L     R12,PELMINA    GET ADDRESS OF MINOR NAME(OR MIN LEN)     44100002
         ICM   R15,M0001,PELMILEN   Q. IS MINOR LENGTH ZERO(DYNAMIC)    44130002
         BNZ   NDYNAM         A. NO. HAVE THE MINOR LENGTH.             44160002
         IC    R15,ZERO(R12)  GET THE DYNAMIC LENGTH.                   44190002
         LA    R12,ONE(R12)   ADJUST ADDR TO POINT TO NAME              44220002
         B     QMINOR         MINOR LOOP.                      @YM03564 44225002
NEQSCOPE EQU   *              *                                @YM03564 44230002
NEQNAME  EQU   *              *                                @YM03564 44235002
NEQLEN   EQU   *              *                                @YM03564 44240002
         L     R10,MINNMIN    GET NEXT MINOR                   @YM03564 44245002
NDYNAM   EQU   *              *                                         44250002
* HAVE THE MINOR NAME LENGTH                                            44280002
QMINOR   EQU   *              *                                         44310002
         LTR   R10,R10        Q. ANY MORE MINORS.                       44340002
         BZR   R3             A. NO. RETURN (NO FIND)                   44370002
         LR    R14,R15        DUPLICATE MINOR NAME LENGTH      @YM03564 44400002
         IC    R14,MINNAMEL   GET LENGTH FROM MINOR QCB        @YM03564 44410002
         CR    R14,R15        Q. MINOR NAME LENGTHS EQUAL      @YM03564 44420002
         BNE   NEQLEN         A. NO. LENGTH NOT EQUAL.                  44430002
* LENGTHS ARE EQUAL                                                     44460002
* NOW CHECK FOR NAME MATCH.                                             44490002
         BCTR  R14,ZERO       Q. REQUEST FOR THIS MINOR        @YM03564 44550002
         EX    R14,COMPMIN    DITTO                                     44580002
         BNE   NEQNAME        A. NO. GET NEXT MINOR.                    44610002
* NAMES ARE THE SAME                                                    44640002
* NOW CHECK FOR SCOPE MATCH.                                            44670002
         TM    PELFLAG,PELSCPE1+PELSCPE2  Q. REQUESTING STEP            44700002
         BNZ   NSTEP          A. NO. REQUEST FOR SYSTEM OR SYSTEMS      44730002
         TM    MINFLGS,MINSTEP  Q. REQUEST FOR THIS MINOR               44760002
         BZ    NEQSCOPE       A. NO. SCOPE NOT EQUAL.                   44790002
         LH    R14,GSASID     GET THE INPUT ASID.                       44820002
         CH    R14,MINASID    Q. REQUEST FOR THIS MINOR                 44850002
         BER   R3             A. YES. FOUND A MATCH. RETURN.            44880002
         B     NEQSCOPE       A. NO. SCOPE NOT EQUAL.                   44910002
NSTEP    EQU   *              *                                         44940002
         TM    PELFLAG,PELSCPE2  Q. REQUESTING SYSTEMS                  44970002
         BZ    NSYSTEMS       A. NO. REQUEST IS FOR SYSTEM              45000002
         TM    MINFLGS,MINSYSS   Q. REQUEST FOR THIS MINOR              45030002
         BOR   R3             A. YES. FOUND A MATCH. RETURN.            45060002
         B     NEQSCOPE       A. NO. SCOPE NOT EQUAL.                   45090002
NSYSTEMS EQU   *              *                                         45120002
         TM    MINFLGS,MINSYS   Q. REQUEST FOR THIS MINOR               45150002
         BOR   R3             A. YES. FOUND A MATCH. RETURN.            45180002
         B     NEQSCOPE       A. NO. SCOPE NOT EQUAL           @YM03564 45270002
         EJECT                                                          45360002
XFREE    EQU   *              *                                         45390002
         STM   R3,R4,WADWORD  SAVE REGS ACROSS FREEMAIN                 45420002
TEST31   EQU   *              *                                         45450002
         LR    R3,R14         KEY AND SUBPOOL                           45480002
         L     R4,PSATOLD     SETUP CURRENT TCB                         45510002
         L     R7,PSAAOLD     GET CURRENT ASCB                          45540002
         BALR  R15,ZERO       GET TEMP ADDRESSABILITY                   45570002
         USING *,R15          GET TEMP ADDRESSABILITY                   45600002
         FREEMAIN RC,LV=(0),A=(1),KEY=(3),SP=(3),BRANCH=YES FREE CORE   45630002
TEST32   EQU   *              *                                         45660002
         DROP  R15            RELEASE TEMP ADDRESSABILITY               45690002
         L     R7,BASE1       RESTORE CLOBBERED BASE                    45720002
         LM    R3,R4,WADWORD  RESTORE REGS                              45750002
         BR    R12            EXIT                                      45780002
         EJECT                                                          45810002
XFREEMAJ EQU   *              *                                         45840002
         LA    R0,MAJLEN      GET MAJOR LENGTH                          45870002
         B     XFREEE         FREE IT.                                  45900002
         SPACE 2                                                        45930002
XFREEMIN EQU   *              *                                         45960002
         LA    R0,MINLEN      GET MINOR LENGTH                          45990002
         SR    R14,R14        DITTO                                     46020002
         IC    R14,MINNAMEL-MIN(R1)  DITTO                              46050002
         ALR   R0,R14         DITTO                                     46080002
         B     XFREEE         FREE IT.                                  46110002
         SPACE 2                                                        46140002
XFREEQEL EQU   *              *                                         46170002
         LA    R0,QELSIZE1    GET FIRST SIZE(SUB QEL SIZE)              46200002
         TM    QELQFLGS-QEL(R1),QELLIST  Q. LIST QEL                    46230002
         BZ    YSIZE1         A. NO. SUB QEL.                           46260002
         LA    R0,QELSIZE2    GET SECOND SIZE (LIST QEL N/RESV)         46290002
YSIZE1   EQU   *              *                                         46320002
         TM    QELQFLGS-QEL(R1),QELRESV   Q. RESERVE                    46350002
         BZ    NRESV2         A. NO.                                    46380002
* UCB WORD                                                              46410002
         A     R0,FFOUR       ADD WORD FOR UCB.                         46440002
NRESV2   EQU   *              *                                         46470002
YFREMAIN EQU   *              *                                         46500002
XFREEE   EQU   *              *                                         46530002
* CORE WILL BE RECYCLED IF IT FALLS WITHIN THE RANGE OF GSQUEUE AND     46560002
*  THE MAXIMUM COUNT FOR GSQUEUE HAS NOT BEEN REACHED.                  46590002
*  OTHERWISE, THE CORE WILL BE FREED                                    46620002
         LR    R12,R0         SAVE THE LENGTH                           46650002
* INPUT LENGTH IN R12 AND ADDRESS IN R1                                 46680002
         LA    R12,SEVEN(R12) OBTAIN INDEX WHILE ROUNDING               46710002
         SRL   R12,THREE      DITTO                                     46740002
         SLL   R12,TWO        DITTO                                     46770002
         C     R12,QRANGE     Q. FALL WITHIN QUEUES                     46800002
         BH    YFREEIT        A. NO.  DO FREEMAIN.                      46830002
         L     R14,GSCOUNT(R12)  Q. LIMITS REACHED             @Z30BNVD 46860003
         C     R14,QTAB(R12)  DITTO                                     46890002
         BNL   FREECHK        A. YES. CHECK WHICH TO FREE      @Z30BNVD 46920003
         LA    R14,ONE(R14)   BUMP THE QUEUE COUNT.                     46950002
         L     R15,GSQUEUE(R12)  INSERT AT TOP OF QUEUE.                46980002
         ST    R15,NEXT(R1)   DITTO                                     47010002
         ST    R1,GSQUEUE(R12)  DITTO                                   47040002
         ST    R14,GSCOUNT(R12)   STORE THE COUNT                       47070002
         BR    R3             EXIT                                      47100002
FREECHK  EQU   *              ONLY INVOKED FROM XFREEE         @Z30BNVD 47102003
         L     R14,GSBLOCKB   BEGINNING ADDR OF BLK            @Z30BNVD 47104003
         CR    R14,R1         Q. FALLS WITHIN RANGE            @Z30BNVD 47110003
         BH    YFREEIT        A. NO. DO NOT SAVE               @Z30BNVD 47112003
         L     R15,GSBLOCKE   ENDING ADDR OF BLOCK             @Z30BNVD 47113003
         CR    R1,R15         Q. FALLS WITHIN RANGE            @Z30BNVD 47114003
         BNL   YFREEIT        A. NO. DO NOT SAVE               @Z30BNVD 47116003
         STM   R9,R10,GSGBSV  NEED WORK REGS                   @Z30BNVD 47118003
         LA    R9,GSQUEUE(R12) TREAT Q HEAD LIKE FIRST ELEMENT @Z30BNVD 47120003
         L     R10,GSQUEUE(R12) GET QUEUE HEAD                 @Z30BNVD 47121003
CHECKEM  EQU   *              USED TO LOOP THRU FREE QUEUE     @Z30BNVD 47122603
         CR    R14,R10        Q. FALLS WITHIN RANGE            @Z30BNVD 47124203
         BH    GOTONE         A. NO. FOUND ONE TO FREE         @Z30BNVD 47126603
         CR    R10,R15        Q. FALLS WITHIN RANGE            @Z30BNVD 47128203
         BNL   GOTONE         A. NO. FOUND ONE TO FREE         @Z30BNVD 47128603
         LR    R9,R10         SAVE PREVIOUS ELEMENT ADDR       @Z30BNVD 47129203
         L     R10,NEXT(R10)  GET NEXT ELEMENT                 @Z30BNVD 47129603
         LTR   R10,R10        Q. IS THERE ANOTHER ELEMENT      @Z30BNVD 47129703
         BNZ   CHECKEM        A. YES. KEEP LOOKING             @Z30BNVD 47129803
         LM    R9,R10,GSGBSV  RESET WORK REGS                  @Z30BNVD 47129903
         B     YFREEIT        NO ELEMENT TO REPLACE            @Z30BNVDX47130003
                              - FREE CURRENT                   @Z30BNVD 47132003
GOTONE   EQU   *              GOUND FREEABLE ELEMENT           @Z30BNVD 47132503
         L     R15,NEXT(R10)  GET FORWARD PTR                  @Z30BNVD 47133003
         ST    R15,NEXT(R1)   PUT FORWARD PTR IN NEW BLOCK     @Z30BNVD 47133503
         ST    R1,NEXT(R9)    PREVIOUS POINTS TO NEW           @Z30BNVD 47133603
         LR    R1,R10         BLOCK TO BE FREED                @Z30BNVD 47133703
         LM    R9,R10,GSGBSV  RESET WORK REGS                  @Z30BNVD 47133803
         B     YFREEIT        FREE ELEMENT FOUND               @Z30BNVD 47134003
YFREEIT  EQU   *              *                                         47136003
         L     R14,SP245      GET SUBPOOL                               47160002
         BAL   R12,XFREE      FREE STORAGE                              47190002
         BR    R3             RETURN.                                   47220002
         EJECT                                                          57840002
XGET     EQU   *              *                                         57870002
         STM   R3,R4,WADWORD  SAVE REGS ACROSS GETMAIN                  57900002
TEST33   EQU   *              *                                         57930002
         LR    R3,R14         KEY AND SUBPOOL                           57960002
         L     R4,PSATOLD     SETUP CURRENT TCB                         57990002
         L     R7,PSAAOLD     GET CURRENT ASCB                          58020002
         BALR  R15,ZERO       GET TEMP ADDRESSABILITY                   58050002
         USING *,R15          GET TEMP ADDRESSABILITY                   58080002
         GETMAIN  RC,LV=(0),KEY=(3),SP=(3),BRANCH=YES  GET CORE         58110002
TEST34   EQU   *              *                                         58140002
         DROP  R15            RELEASE TEMP ADDRESSABILITY               58170002
         L     R7,BASE1       RESTORE CLOBBERED BASE                    58200002
         LM    R3,R4,WADWORD  RESTORE REGS                              58230002
         BR    R12            EXIT                                      58260002
         EJECT                                                          58290002
XGETQEL  EQU   *              *                                         58320002
         SR    R14,R14        SET REGISTER TO ZERO                      58350002
         ST    R14,GSMJWORD   SET MAJOR LENGTH TO ZERO                  58380002
         ST    R14,GSMNWORD   SET MINOR LENGTH TO ZERO                  58410002
         B     XGETQEL1       GET QEL SIZE                              58440002
         SPACE 2                                                        58470002
XGETMIN  EQU   *              *                                         58500002
         SR    R14,R14        SET REGISTER TO ZERO                      58530002
         ST    R14,GSMJWORD   SET MAJOR LENGTH TO ZERO                  58560002
         B     XGETMIN1       GET MINOR AND QEL                         58590002
         SPACE 2                                                        58620002
XGETMAJ  EQU   *              *                                         58650002
* COMPUTE MAJOR                                                         58680002
         LA    R14,MAJLEN     GET LENGTH OF MAJOR                       58710002
         ST    R14,GSMJWORD   SAVE MAJOR LENGTH                         58740002
XGETMIN1 EQU   *              *                                         58770002
* COMPUTE MINOR                                                         58800002
         SR    R15,R15        ZERO WORK REGISTER                        58830002
         ICM   R15,M0001,PELMILEN  Q. DYNAMIC MINOR NAME LENGTH         58860002
         BNZ   NDYNAMIC       A. NO.  MILEN NOT ZERO                    58890002
         L     R14,PELMINA    GET THE DYNAMIC LENGTH                    58920002
         IC    R15,ZERO(R14)  DITTO                                     58950002
NDYNAMIC EQU   *              *                                         58980002
         LA    R14,MINLEN(R15)   GET THE MINOR LENGTH(WITHOUT NAME)     59010002
         ST    R14,GSMNWORD   SAVE MINOR LENGTH                         59040002
XGETQEL1 EQU   *              *                                         59070002
* COMPUTE QEL SIZE                                                      59100002
         LA    R14,QELSIZE2   SET SIZE 2                                59130002
         ICM   R15,M1111,GSLSTQEL    Q. LIST QEL EXIST                  59160002
         BZ    NSUBQEL        A. YES. BUILD LIST QEL                    59190002
         LA    R14,QELSIZE1   SET SIZE 1                                59220002
NSUBQEL  EQU   *              *                                         59250002
         TM    PELFLAG,PELSCPE2   Q. UCB SPECIFIED.                     59280002
         BZ    NRESV3         A. NO.                                    59310002
         TM    PELFLAG,PELSCPE1   Q. UCB SPECIFIED.                     59340002
         BO    NRESV3         A. NO.                                    59370002
         L     R12,PELUCBAA   GET THE UCB ADDR ADDR                     59400002
         L     R12,ZERO(R12)  GET THE UCB ADDR                          59430002
         TM    UCBTBYT3-UCBOB(R12),UCB3DACC  Q. DASD           @YA00805 59460003
         BZ    NRESV3         A. NO.                           @YA00805 59490003
         TM    UCBTBYT2-UCBOB(R12),UCB2OPT2  Q. SHARED         @YA00805 59520003
         BO    YRESV3         A. YES.                          @YA00805 59550003
         LR    R0,R12         SAVE UCB ADDR                    @YA00805 59552003
         ICM   R12,M0111,UCBEXTP-UCBOB(R12)  EXTENSION ADDR    @YA00805 59554003
         TM    UCBFLP1-UCBETI(R12),UCBSHRUP Q. SHR POTENTIAL   @YA00805 59556003
         LR    R12,R0         RESTORE UCB ADDR                 @YA00805 59558003
         BZ    NRESV3         A. NO. PROCESS AS NORMAL ENQ     @YA00805 59560003
YRESV3   EQU   *              PROCESS AS RESERVE               @YA00805 59562003
         LA    R14,FOUR(R14)   ADD UCB WORD.                            59580002
NRESV3   EQU   *              *                                         59610002
         ST    R14,GSQLWORD   SAVE THE COMPUTED SIZE.                   59640002
* CORE WILL EITHER BE 'GETMAINED' OR GOTTEN FROM GSQUEUE                59670002
* GSQUEUE IS A RECYCLING STORAGE QUEUE                                  59700002
* GSQUEUE IS INDEXABLE BY LENGTH/2                                      59730002
* GSCOUNT IS THE NUMBER OF FREE ELEMENTS HUNG FROM GSQUEUE              59760002
* EACH LENGTH IS CHECKED FOR A FREE ELEMENT. IF ONE EXISTS,             59790002
*  IT IS TAKEN FROM GSQUEUE. IF NONE EXISTS, THE SIZE                   59820002
*  IS ADDED TO THAT OF OTHERS NOT FOUND.                                59850002
*  SIZES NOT FOUND ARE SUMED AND 1 GETMAIN IS DONE.                     59880002
         SR    R0,R0          GETMAIN LENGTH ACCUMULATOR                59910002
         LA    R12,EIGHT      LOOP CONTROL                              59940002
Q3       EQU   *              *                                         59970002
         L     R14,GS3WORDS(R12)  GET LENGTH OR 0                       60000002
         LA    R14,SEVEN(R14)  OBTAIN INDEX WHILE ROUNDING              60030002
         SRA   R14,THREE      Q. IS IT ZERO.                            60060002
         BZ    YZERO          A. YES. IGNORE                            60090002
         SLL   R14,TWO        LENGTH ROUNDED TO DBL WD DIVIDED BY 2     60120002
         C     R14,QRANGE     Q. LENGTH WITHIN RANGE                    60150002
         BH    NELEM1         A. NO. ACCUMULATE LENGTH FOR GET          60180002
         L     R1,GSQUEUE(R14)  GET QUEUED ELEMENT OR 0                 60210002
         LTR   R1,R1          Q. DOES ELEMENT EXIST                     60240002
         BNZ   YELEM2         A. YES                                    60270002
NELEM1   EQU   *              *                                         60300002
         SLL   R14,ONE        GET ROUNDED LENGTH                        60330002
         AR    R0,R14         ACCUMULATE LENGTH                         60360002
         O     R14,HIGHBIT    INDICATE LENGTH NOT PROCESSED             60390002
         ST    R14,GS3WORDS(R12)  SAVE THE LENGTH                       60420002
         B     NELEM2         CONTINUE                                  60450002
YELEM2   EQU   *              *                                         60480002
         L     R15,NEXT(R1)   UNCHAIN                          @Z30BNVD 60484003
         ST    R15,GSQUEUE(R14)   DITTO                        @Z30BNVD 60485003
         ST    R1,GS3WORDS(R12)  SAVE THE ELEMENT'S ADDRESS    @Z30BNVD 60487003
         L     R15,GSCOUNT(R14)  DECREMENT THE Q COUNT                  60510002
         BCT   R15,YNOTZERO   SKIP WHEN Q NOT EMPTY            @Z30BNVD 60540003
         STM   R10,R12,GSGBSV NEED WORK REGS                   @Z30BNVD 60544003
         LR    R10,R0         SAVE CONTENTS OF REG             @Z30BNVD 60546003
         L     R0,BLKSIZE(R14) GET SIZE OF BLOCK               @Z30BNVD 60548003
         LR    R11,R14         SAVE CONTENTS OF REG            @Z30BNVD 60550003
         L     R14,SP245      INDICATE SUBPOOL                 @Z30BNVD 60552003
         BAL   R12,XGET       GET A BLOCK                      @Z30BNVD 60554003
         LR    R14,R11        RESTORE INDEX                    @Z30BNVD 60556003
         LTR   R15,R15        Q. GOT SOME                      @Z30BNVD 60558003
         BZ    YGOTSOME       A. YES. GO PROCESS               @Z30BNVD 60560003
         SR    R15,R15        ZERO COUNT REG                   @Z30BNVD 60560503
         B     NGOT           SKIP CHAINING PROCESS            @Z30BNVD 60561003
YGOTSOME EQU   *              BRANCHED TO WHEN STORAGE GOTTEN  @Z30BNVD 60561503
         ST    R1,GSQUEUE(R14)  INITIALIZE QUEUE HEAD          @Z30BNVD 60562003
         AR    R0,R1          DETERMINE END OF BLOCK           @Z30BNVD 60564003
         SLL   R11,ONE        INDEX TO ELEMENT SIZE            @Z30BNVD 60566003
BLDLOOP  EQU   *              LOOP TO BUILD FREE QUEUE         @Z30BNVD 60568003
         LR    R12,R1         SAVE CURRENT                     @Z30BNVD 60570003
         LA    R15,ONE(R15)   COUNT ELEMENT                    @Z30BNVD 60572003
         AR    R1,R11         GET NEXT                         @Z30BNVD 60574003
         ST    R1,NEXT(R12)   CHAIN CURRENT TO NEXT            @Z30BNVD 60576003
         CR    R0,R1          Q. PROCESSING LAST ONE           @Z30BNVD 60577003
         BH    BLDLOOP        A. NO. GO PROCESS ANOTHER        @Z30BNVD 60579003
         SR    R0,R0          RESET ENTRY VALUE                @Z30BNVD 60581003
         ST    R0,NEXT(R12)   ZERO PTR IN LAST ONE             @Z30BNVD 60583003
NGOT     EQU   *              LABEL USED WHEN GET FAILS        @Z30BNVD 60585003
         LR    R0,R10         RESET ENTRY VALUE                @Z30BNVD 60588003
         LM    R10,R12,GSGBSV RESET WORK REGS                  @Z30BNVD 60590003
YNOTZERO EQU   *              USED WHEN BLOCK NOT NEEDED       @Z30BNVD 60592003
         ST    R15,GSCOUNT(R14) SAVE NEW COUNT                 @Z30BNVD 60594003
NELEM2   EQU   *              *                                         60690002
YZERO    EQU   *              *                                         60720002
         SL    R12,FFOUR      Q. IS THIS THE LAST                       60750002
         BNM   Q3             A. NO. LOOP.                              60780002
         LTR   R0,R0          Q. ACCUMULATED LENGTH 0                   60810002
         BZR   R3             YES. EXIT                                 60840002
* GETMAIN                                                               60870002
         L     R14,SP245      GET SUBPOOL                               60900002
         BAL   R12,XGET       GET STORAGE                               60930002
         LTR   R15,R15        Q. GO O.K.                                60960002
         BZ    YGOTIT         A. YES.                                   60990002
         OI    WAFLAG2,WANOCORE   SET NO CORE SWITCH                    61020002
         BR    R3             EXIT                                      61050002
YGOTIT   EQU   *              *                                         61080002
         LA    R12,EIGHT      LOOP CONTROL. ALSO USED AS INDEX          61110002
QBREAKIT EQU   *              *                                         61140002
         L     R14,GS3WORDS(R12)   Q. IGNORE THIS WORD                  61170002
         LTR   R14,R14        DITTO                                     61200002
         BNM   YIGNORIT       A. YES                                    61230002
         LA    R14,ZERO(R14)   CLEAR HIGH BIT                           61260002
         ST    R1,GS3WORDS(R12)   SAVE THE ADDRESS                      61290002
         LA    R1,ZERO(R1,R14) ADDRESS PLUS LENGTH (CLEAR HIGH BIT)     61320002
YIGNORIT EQU   *              *                                         61350002
         SL    R12,FFOUR      Q. IS THIS THE END.                       61380002
         BNM   QBREAKIT       A. NO. LOOP.                              61410002
         BR    R3             EXIT                                      61440002
         EJECT                                                          61470002
XHOLD    EQU   *              *                                         61500002
         OI    GSFLAG1,GSHOLD   WANT ENQHOLD                            61530002
         B     YSYSEVNT       CONTINUE.                                 61560002
         SPACE 2                                                        61590002
XRLSE    EQU   *              *                                         61620002
         NI    GSFLAG1,XFF-GSHOLD  WANT ENQRLSE                         61650002
YSYSEVNT EQU   *              *                                         61680002
         TM    MINFLGS,MINSTEP   Q. STEP WIDE MINOR                     61710002
         BOR   R3             A. YES. DONT ISSUE SYSEVENT.              61740002
         STM   R14,R4,GSR3SAVE   SAVE REGS                              61770002
         LR    R3,R1          SAVE COUNT                                61800002
         LR    R1,R10         MINOR ADDRESS TO OPTIMIZER                61920002
QHOLDQEL EQU   *              *                                         61950002
         LH    R2,QELASID-QEL(R12)  GET ASID FOR OPT.                   61980002
         TM    GSFLAG1,GSHOLD   Q. HOLD.                                62040002
         BO    YHOLD          A. YES.                                   62070002
* ENQRLSE                                                               62100002
         SYSEVENT  ENQRLSE,ASID=(2),ENTRY=BRANCH CALL OPT.              62130002
TEST38   EQU   *              *                                         62160002
         B     NHOLD          CONTINUE.                                 62190002
YHOLD    EQU   *              *                                         62220002
* ENQHOLD                                                               62250002
         SYSEVENT  ENQHOLD,ASID=(2),ENTRY=BRANCH  CALL OPT.             62280002
TEST39   EQU   *              *                                         62310002
NHOLD    EQU   *              *                                         62340002
         L     R12,QELNQEL-QEL(R12)  GET NEXT QEL FOR LOOP              62370002
         BCT   R3,QHOLDQEL    LOOP ON COUNT                             62400002
         LM    R14,R4,GSR3SAVE   RESTORE REGS.                          62430002
         BR    R3             RETURN                                    62460002
         EJECT                                                          62490002
XPOST    EQU   *              POST A GROUP OF QELS                      62520002
QPOSTQEL EQU   *              *                                         62550002
         ICM   R15,M1111,QELLQEL-QEL(R12) Q. LIST QEL ADDRESS           62610002
         LA    R14,QELSIZE1   GET SUB-QEL SIZE                          62640002
         BM    NLQEL          A. NO.                                    62670002
         LA    R14,QELSIZE2   GET LIST-QEL SIZE                         62700002
         LR    R15,R12        GET THE LIST-QEL ADDRESS                  62730002
NLQEL    EQU   *              *                                         62760002
         TM    QELQFLGS-QEL(R12),QELRESV   Q. RESERVE                   62790002
         BZ    NRESERV1       A. NO.                                    62820002
* SHARED DASD                                                           62850002
         L     R14,ZERO(R14,R12)  GET UCB ADDRESS                       62880002
         SR    R0,R0          BUMP RESERVE COUNT                        62910002
         IC    R0,UCBSQC-UCBOB(R14)  DITTO                              62940002
         AL    R0,FONE        DITTO                                     62970002
         STC   R0,UCBSQC-UCBOB(R14)  DITTO                              63000002
         TM    QELQFLGS-QEL(R12),QELAUTH  CHECK FOR AUTH.      @ZA17306 63005040
         BNO   NRESERV1       SKIP SYSEVENT                    @ZA17306 63010040
         STM   R14,R1,GSR3SAVE                                 @ZA17306 63012040
         LR    R1,R10         PASS MINOR QCB TO SRM            @ZA17306 63015040
         LH    R0,QELASID-QEL(R12)  PASS ASID TO SRM           @ZA17306 63020040
         SYSEVENT ENQHOLD,ASID=(0),ENTRY=BRANCH                @ZA17306 63025040
         LM    R14,R1,GSR3SAVE                                 @ZA17306 63027040
NRESERV1 EQU   *              *                                         63030002
         STM   R0,R15,GSSAVE1                                  @ZA17306 63050040
         LR    R9,R13         SAVE GLOBAL SAVE AREA ADDRESS             63060002
         LH    R11,QELWCNT-QEL(R15)  DECREMENT WAIT COUNT.              63090002
         S     R11,FONE       DITTO                                     63120002
         STH   R11,QELWCNT-QEL(R15)  DITTO                              63150002
         BNZ   NPOST          DONT POST TILL COUNT GOES TO 0            63180002
         OI    QELLFLGS-QEL(R15),QELPOST   INDICATE POST OCCURED.       63210002
         SR    R11,R11        NO ECB,SVRB ADDR ALREADY IN R10           63240002
         ICM   R10,M1111,QELECB-QEL(R15)  Q. ECB POST                   63270002
         BNM   NECB           A. NO. SVRB POST.                         63300002
* ECB POST                                                              63330002
         LA    R11,ZERO(R10)  INDICATE NO SHEDULE                       63360002
         SR    R10,R10        NO COMPLETION CODE                        63390002
NECB     EQU   *              *                                         63420002
         LH    R13,QELASID-QEL(R12)  Q. CROSS MEMORY POST               63450002
         CH    R13,GSASID-GS(R9)     DITTO                              63480002
         BE    NSCHED         A. NO.                                    63510002
* CROSS MEMORY POST                                                     63540002
         O     R11,HIGHBIT    INDICATE SCHEDULE IS NECESSARY            63570002
         L     R1,CVTPTR      GET CVT ADDRESS                           63600002
TEST41   EQU   *              *                                         63630002
         L     R1,CVTASVT-CVT(R1)  GET THE ASVT                         63660002
         BCTR  R13,ZERO       ASID-1                                    63710002
         SLL   R13,TWO        (ASID-1) X 4                              63730002
         L     R13,ASVTENTY-ASVT(R13,R1)  GET ASCB ADDRESS     @YM01596 63750002
         LA    R12,BR14       ADDRESS OF BR14 INSTUCTION                63780002
NSCHED   EQU   *              *                                         63810002
         L     R15,POSTADDR    GET POST'S ADDRESS                       63840002
TEST42   EQU   *              *                                         63870002
         BALR  R14,R15        POST                                      63900002
* NO ADDRESSABILITY HERE OTHER THAN R9                                  63930002
NPOST    EQU   *              *                                         63960002
         LM    R0,R15,GSSAVE1-GS(R9)   GET ALL REGS BACK                63990002
         BCTR  R1,ZERO        DECREMENT POST COUNT                      64020002
         LTR   R1,R1          Q. DONE WITH POSTS                        64050002
         BZR   R3             A. YES. RETURN                            64080002
         L     R12,QELNQEL-QEL(R12)  GET THE NEXT QEL                   64110002
         B     QPOSTQEL       LOOP                                      64140002
         EJECT                                                          64170002
XQELSCAN EQU   *              *                                         64200002
* INPUT--                                                               64230002
* GSASID CONTINS THE CURRENT ASID                                       64260002
* R3 IS THE RETURN ADDRESS                                              64290002
* R4 CONTAINS A TCB ADDRESS OR 0                                        64320002
* R8 CONTAINS THE CURRENT PEL                                           64350002
* R10 CONTAINS THE MINOR TO BE SEARCHED                                 64380002
* R13 CONTAINS THE ADDRESS OF THE GS(GLOBAL SAVE)                       64410002
* PROCESS--                                                             64440002
* R11 IS USED TO CONTAIN THE MATCH QEL OR 0                             64470002
* R12 CONTAINS THE CURRENT QEL                                          64500002
* R14 CONTAINS EITHER THE PREVIOUS TYPE OR THE CURRENT TYPE (E/S)       64530002
* R15 IS USED AS A MULTI USE WORK REG                                   64560002
* R0 CONTAINS THE CURRENT QEL COUNT FOR THE CURRENT GROUP               64590002
* R1 IS USED TO CONTAIN THE CURRENT GROUP NUMBER TIMES TWO              64620002
* WORK REGISTERS  R11,R12,R14,R15,R0,R1                                 64650002
* NOT TO BE USED ARE R2,R3,R4,R5,R6,R7,R8,R9,R10,R13                    64680002
* R2 MAY AT A LATER TIME BECOME THE LINK REGISTER                       64710002
* OUTPUT--                                                              64740002
* R11 WILL CONTAIN THE MATCH QEL OR 0                                   64770002
* GSGRPNUM CONTAINS THE MATCH GROUP NUMBER OR THE GROUP NUMBER OF THE   64800002
*        TO BE BUILT QEL (FUTURE OR POTENTIAL QEL),MULTIPLIED BY TWO    64830002
* GSGROUPS 1 THRU 4 WILL CONTAIN THEIR RESPECTIVE QEL COUNTS            64860002
* THE LAST COUNT MAY REFLECT AN MATCH COUNT OR THE POTENTIAL COUNT      64890002
         SPACE 3                                                        64920002
* INITIALIZE                                                            64950002
         SR    R11,R11        SET THE MATCH QEL TO ZERO                 64980002
         SR    R1,R1          SET CURRENT GROUP TO ZERO                 65010002
         XC    GSGPAREA(GSGPLEN),GSGPAREA  ZERO GROUP RELATED INFO      65040002
         SR    R14,R14        SET PREVIOUS TYPE TO EXCLUSIVE            65070002
         ICM   R12,M1111,MINFQEL  Q. FIRST QEL ZERO                     65100002
         BZ    YEND1          A. YES. CANNOT HAVE A MATCH.              65130002
QQEL1    EQU   *              SCAN THE QEL(S)                           65160002
         LTR   R14,R14        Q. PREV=EXCL                              65190002
         L     R14,QELQFLGS-QEL(R12)   MAKE CURR THE PREV               65220002
         BNM   YCHANGE0       A. YES. HAS TO BE GROUP CHANGE            65250002
         LTR   R14,R14        Q. CURR=EXCL                              65280002
         BNM   YCHANGE0       A. YES HAS TO BE GROUP CHANGE             65310002
         A     R0,FONE        ADD ONE TO CURRENT QEL COUNT              65340002
         B     NCHANGE0       BYPASS THE CHANGE OF GROUP                65370002
YCHANGE0 EQU   *              CHANGE GROUP COUNT                        65400002
         LA    R1,TWO(R1)     BUMP GROUP OFFSET                         65430002
         LA    R0,ONE         SET CURRENT QEL COUNT TO ONE              65460002
NCHANGE0 EQU   *              *                                         65490002
         CLC   GSASID(TWO),QELASID-QEL(R12) Q.BELONG TO THE TARGET A.S. 65520002
         BNE   NMATCH         MISSED THE TARGET                         65550002
         L     R15,QELTCB-QEL(R12)  GET TCB OR LIST QEL ADDRESS         65580002
         LTR   R15,R15        Q. TCB                                    65610002
         BP    YTCB           A. YES                                    65640002
         L     R15,QELTCB-QEL(R15)  OBTAIN THE TCB                      65670002
YTCB     EQU   *              HAVE THE TCB                              65700002
         CR    R4,R15         TCB'S MATCH                               65730002
         BE    YMATCH         YES. ASID.TCB = ASID.TCB                  65760002
         LTR   R4,R4          CHECK FOR A TCB OF 0                      65790002
         BNZ   NMATCH         NOT 0 (NO MATCH) ZERO TCB = ALL TCB'S     65820002
YMATCH   EQU   *              FOUND A MATCH QEL                         65850002
         LR    R11,R12        SAVE IT.                                  65880002
         SRL   R1,ONE         SAVE THE MATCH GROUP NUMBER               65910002
         ST    R1,GSGRPNUM    DITTO                                     65940002
         SLL   R1,ONE         DITTO                                     65970002
NMATCH   EQU   *              *                                         66000002
         C     R1,FEIGHT                                                66030002
         BH    YIGNORE3       A. YES                                    66060002
         STH   R0,GSGROUP(R1)  SAVE THE CURRENT QEL COUNT               66090002
YIGNORE3 EQU   *              *                                         66120002
         ICM   R12,M1111,QELNQEL-QEL(R12)  Q. NEXT QEL ZERO.            66150002
         BNZ   QQEL1          A. NO. LOOP ON QELS                       66180002
YEND     EQU   *              FINISH UP                                 66210002
         LTR   R11,R11        Q. HAVE A MATCH QEL                       66240002
         BNZR  R3             YES. EXIT                                 66270002
         LTR   R14,R14        Q. GROUP CHANGE                           66300002
         BNM   YCHANGE1       A. YES                                    66330002
         TM    PELFLAG,PELSHARE   Q. GROUP CHANGE                       66360002
         BZ    YCHANGE1       A. YES                                    66390002
         A     R0,FONE        BUMP THE CURRENT QEL COUNT.               66420002
         B     NCHANGE1       CONTINUE PROCESSING                       66450002
YCHANGE1 EQU   *              *                                         66480002
YEND1    EQU   *              *                                         66510002
         LA    R1,TWO(R1)     BUMP GROUP OFFSET                         66540002
         LA    R0,ONE         RESET THE QEL COUNT TO ONE.               66570002
NCHANGE1 EQU   *              *                                         66600002
         C     R1,FEIGHT      Q. OVER FOUR GROUPS.                      66630002
         SRL   R1,ONE         SAVE THE POTENTIAL GROUP NUMBER.          66660002
         ST    R1,GSGRPNUM    DITTO                                     66690002
         BHR   R3             A. YES. QUIT.                             66720002
         SLL   R1,ONE         RESTORE INDEX                             66750002
         STH   R0,GSGROUP(R1) BUMP THIS GROUPS QEL COUNT.               66780002
         BR    R3             BYE                                       66810002
         EJECT                                                          66840002
XSETUP   EQU   *              *                                         66870002
* INPUT--                                                               66900002
* R1 IS THE INPUT PARM LIST                                             66930002
* R2 IS FRR E.P.                                                        66960002
* R3 IS THE LINK REGISTER                                               66990002
* ADDRESSABILITY TO WA (USING R5)                                       67020002
* WORK--                                                                67050002
* R8 THRU R2                                                            67080002
* OUTPUT--                                                              67110002
* WA ALL ZEROS PLUS--                                                   67140002
*   WAOLDPEL,WANEWPEL,WAKEY,WAPLAST,WAPFLAG,WAPARMSZ,WANAMESZ           67170002
*   WALOCAL,WAFRR,WABADMIL,WAERR,WANOAUTH,WANOCORE                      67200002
* PORTION OF GLOBAL SAVE CLEARED                                        67230002
* A MOVED LIST,IF CALLER NOT AN AUTHORIZED CALLER.                      67260002
* FRR ENVIRONMENT                                                       67290002
* POSSIBLY A MOVED LIST                                                 67320002
* LOCAL AND CMS LOCK                                                    67350002
* R4 CONTAINS THE CURRENT OR PARM LIST TCB ADDR                         67380002
* R8 IS ADDRESS OF TOP PARM OF WACURPEL                                 67410002
* R13 IS ADDRESS OF GS                                                  67440002
         LA    R8,ZERO(R1)    SAVE THE PARM LIST                        67470002
         XC    WA(WALEN),WA   ZERO THE WORK AREA                        67500002
         STC   R0,WARETRY     SET RETRY ADDRESS                         67530002
         ST    R8,WAOLDPEL    INIT OLD LIST AS INPUT LIST               67560002
         ST    R8,WANEWPEL    SET NEW=OLD                               67590002
X3       SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=((X7),IEAVWAIT)  67620002
TEST43   EQU   *              *                                         67650002
* SETLOCK DESTROYS R11 THRU R14                                         67680002
         OI    WAFLAG1,WALOCAL  INDICATE LOCAL LOCK OBTAINED.           67710002
         SETFRR A,PARMAD=(R13),FRRAD=(R2),WRKREGS=(R14,R15)   COVER     67740002
TEST44   EQU   *              *                                         67770002
         ST    R5,ZERO(R13)   FRR INPUT IS W.A. ADDRESSABILITY          67800002
* SETFRR DESTROYS R14 AND R15                                           67830002
         OI    WAFLAG1,WAFRR   INDICATE FRR OUTSTANDING                 67860002
         L     R2,RBLINK-RBSECT(R5)  GET MY CALLER'S KEY                67890002
         IC    R2,RBOPSWKY-RBSECT(R2)  DITTO                            67920002
         N     R2,KEYMASK     DITTO                                     67950002
         STH   R2,WAKEY       SAVE MY CALLER'S KEY                      67980002
* SCAN THE INPUT PARM LIST                                              68010002
* FOR THIS ENTIRE ROUTINE R2 CONTAINS MY CALLER'S KEY                   68040002
* COMPUTE THE PARM LIST SIZE AND NAME LENGTH SIZE                       68070002
         LR    R12,R8         SET CURRENT ELEMENT TO TOP ELEMENT        68100002
         SR    R14,R14        SET CURRENT PARM SIZE TO 0                68130002
         SR    R15,R15        SET CURRENT NAME SIZE TO 0                68160002
         SR    R0,R0          ZERO FOR INSERT OF MINOR NAME LENGTH      68190002
         SR    R9,R9          USE FOR MINOR LENGTH 0, NON 0 SWITCH      68220002
TEST45   EQU   *              *                                         68250002
         MODESET  KEYADDR=(2)  GO INTO CALLER'S KEY                     68280002
QLAST    EQU   *              LOOP TILL END OF LIST                     68310002
         LA    R14,PELELEM(R14)  ACCUMULATE PARM LIST SIZE              68340002
         TM    PELFLAG-PEL(R12),PELSCPE2  Q. HAVE UCB                   68370002
         BZ    NRESV          A. NO.                                    68400002
         TM    PELFLAG-PEL(R12),PELSCPE1  Q. HAVE UCB                   68430002
         BO    NRESV          A. NO.                                    68460002
         L     R1,PELUCBAA-PEL(R12)  REFERENCE UCB ADDR ADDR            68490002
         L     R11,ZERO(R1)   REFERENCE UCB ADDRESS                     68520002
         L     R11,ZERO(R11)  REFERENCE UCB                             68550002
         LA    R14,FOUR(R14)  BUMP PARM SIZE BY UCB ADDR SIZE           68580002
         LA    R15,FOUR(R15)  BUMP NAME SIZE BY UCB WORD SIZE           68610002
NRESV    EQU   *              *                                         68640002
         L     R1,PELMAJA-PEL(R12)  REFERENCE MAJOR ADDRESS             68670002
         IC    R11,ZERO(R1)   REFERENCE MAJOR NAME                      68700002
         IC    R11,PELMAJSZ-ONE(R1)  DITTO                              68730002
         LA    R15,PELMAJSZ(R15)  ACCUMULATE NAME LENGTH SIZE           68760002
         ICM   R1,M1111,PELMINA-PEL(R12)  Q. MINOR NAME                 68790002
         BNZ   YMINAME        A. YES. CHECK LENGTH                      68820002
         BALR  R9,ZERO        A. NO. ABEND ALL BUT GENERIC DEQ.         68850002
         B     NMINAME        CONTINUE PROCESSING                       68880002
YMINAME  EQU   *              *                                         68910002
         ICM   R0,M0001,PELMILEN-PEL(R12)  Q. DYNAMIC LENGTH            68940002
         BNZ   NDYN           A. NO. REFERENCE MINOR NAME               68970002
         ICM   R0,M0001,ZERO(R1)   Q. LENGTH ZERO                       69000002
         LA    R1,ONE(R1)     PREPARE FOR NON-ZERO LENGTH               69030002
         BNZ   YMILEN         A. NO. REFERENCE MINOR NAME               69060002
         BALR  R9,ZERO        A. NO. ABEND ALL BUT GENERIC DEQ.         69090002
         B     NMILEN         CONTINUE                                  69120002
YMILEN   EQU   *              *                                         69150002
NDYN     EQU   *              *                                         69180002
         IC    R11,ZERO(R1)   REFERENCE MINOR NAME                      69210002
         BCTR  R1,ZERO        DITTO                                     69240002
         ALR   R1,R0          DITTO                                     69270002
         IC    R11,ZERO(R1)   DITTO                                     69300002
NMINAME  EQU   *              *                                         69330002
NMILEN   EQU   *              *                                         69360002
         ALR   R15,R0         BUMP NAME SIZE BY MINOR LENGTH SIZE       69390002
         TM    PELLAST-PEL(R12),PELEOL  Q. END OF LIST                  69420002
         BO    YLAST          A. YES                                    69450002
         LA    R12,ZERO(R8,R14)  GET ADDRESS OF NEXT ELEM               69480002
         B     QLAST          LOOP ON ELEMENTS                          69510002
YLAST    EQU   *              FINISHED WITH LIST                        69540002
         ICM   R1,M0010,PELLAST-PEL(R12) GET PROPER(LAST ELEM)FLAG BYTE 69570002
         IC    R1,PELFLAG-PEL(R8)  GET PROPER(TOP ELEM) FLAG BYTE       69600002
TEST46   EQU   *              *                                         69630002
         MODESET  EXTKEY=SUPR   SET KEY BACK TO 0                       69660002
         LTR   R9,R9          Q. MINOR LEN OF ZERO FOUND                69690002
         BZ    NLEN0          A. NO.                                    69720002
         OI    WAFLAG2,WABADMIL    A. YES. ABEND ALL BUT GENERIC DEQ.   69750002
NLEN0    EQU   *              *                                         69780002
         STH   R1,WAPFLGS     SAVE PROPER(GLOBAL TO THE REQUEST) FLAGS  69810002
         TM    WAPLAST,PELIGNOR    Q. OLD OPTIONS                       69840002
         BZ    NOLDOPTN       A. NO. HAVE NEW OPTIONS.                  69870002
         NI    WAPLAST,PELEOL  A. YES. CONVERT TO NEW OPTIONS           69900002
NOLDOPTN EQU   *              WAPLAST IS NOW ALWAYS NEW OPTIONS         69930002
         ST    R14,WAPARMSZ   SAVE THE TOTAL PARM SIZE                  69960002
         ST    R15,WANAMESZ   SAVE THE TOTAL NAME SIZE                  69990002
         TM    WAPFLAG,PELRET1   Q. ECB REQUESTED                       70020002
         BZ    NECB1          A. NO.                                    70050002
         TM    WAPFLAG,PELRET2+PELRET3  Q. ECB REQUESTED                70080002
         BNZ   NECB1          A. NO. CHECK FOR ONLY TCB        @ZA14267 70090040
         TM    WAPLAST,PELTCBF Q. BOTH ECB AND TCB             @ZA14267 70130040
         BNO   YECB1          A. NO. ONLY ECB                  @ZA14267 70170040
*                                                                       70260040
* BOTH TCB AND ECB WERE SPECIFIED                              @ZA14267 70262040
*                                                                       70264040
         SH    R8,HPREFIX     GET PREFIX ADDRESS OF PEL        @ZA14267 70266040
         MODESET KEYADDR=(2)   SWITCH TO CALLERS KEY           @ZA14267 70267040
         L     R4,PELTCB-PELPREFX(0,R8) SET TCB ADDRESS        @ZA14267 70268040
         L     R9,PELDUAL-PELPREFX(0,R8) GET ECB ADDRESS       @ZA14267 70269040
         MODESET EXTKEY=SUPR  GO BACK TO KEY 0                 @ZA14267 70270040
         O     R9,HIGHBIT     INDICATE ECB                     @ZA14267 70271040
         B     NTCB1          COMMON TCB/ECB PROCESSING        @ZA14267 70272040
NECB1    EQU   *              *                                         70278240
         TM    WAPLAST,PELTCBF   Q. TCB REQUEST                @ZA14267 70278440
         BZ    NTCBECB        A. NO.                                    70278640
YECB1    EQU   *              *                                         70278840
*                                                                       70279040
* ONLY TCB SPECIFIED OR ONLY ECB SPECIFIED                     @ZA14267 70279240
*                                                                       70279440
         SH    R8,HPREFIX     GET PREFIX ADDRESS OF PEL        @ZA14267 70280040
TEST47   EQU   *              *                                         70320002
         MODESET  KEYADDR=(2)   SWITCH TO CALLER'S KEY                  70350002
         L     R9,PELDUAL-PELPREFX(R8)   GET TCB OR ECB ADDRESS         70380002
TEST48   EQU   *              *                                         70410002
         MODESET  EXTKEY=SUPR     GO BACK TO KEY 0                      70440002
         O     R9,HIGHBIT     INDICATE ECB (GUESS)             @ZA14267 70470040
         TM    WAPLAST,PELTCBF   Q. TCB REQUEST                         70530002
         BZ    NTCB1          A. NO.                                    70560002
         LA    R9,ZERO(R9)    CLEAR HIGH BIT                            70590002
         LR    R4,R9          SET TCB ADDRESS                           70620002
NTCB1    EQU   *              *                                         70650002
         ST    R9,WAECBA      SAVE THE TCB OR ECB ADDRESS      @ZA14267 70660040
*                                                                       70685040
* WATCBA WILL BE USED ONLY IF ECB WAS SPECIFIED (INDICATED BY HIGH      70690040
* ORDER BIT).                                                  @ZA14267 70693040
*                                                                       70700040
         AH    R8,HPREFIX     RESET TO TOP ELEM                @ZA14267 70705040
NTCBECB  EQU   *              *                                         70710002
         TM    WAKEY+ONE,NOSUPKEY Q. SUPR KEY                  @YM03564 70720002
         BZ    YAUTH          A. YES - BYPASS TESTAUTH         @YM03564 70730002
         LR    R11,R3         SAVE THE LINK REGISTER                    70750002
         TESTAUTH  FCTN=1,STATE=YES,KEY=YES,BRANCH=YES CHECK AUTH       70770002
TEST49   EQU   *              *                                         70800002
* R14 THRU R3 CLOBBERED.                                                70830002
         LR    R3,R11         RESTORE THE LINK REGISTER                 70860002
         LTR   R15,R15        Q. AUTHORIZED CALLER                      70890002
         BZ    YAUTH          A. YES. DONT MOVE PARM LIST               70920002
* MOVE PARM LIST IF COMING THRU HERE                                    70950002
         LH    R2,WAKEY       RESTORE CALLER'S KEY                      70980002
         OI    WAFLAG2,WANOAUTH  INDICATE NOT AUTHORIZED CALL           71010002
* MOVE LIST NOW.                                                        71040002
* R8 USED FOR OLD PEL                                                   71070002
* R9  USED FOR NEW PEL PARMS                                            71100002
* R10 USED FOR NEW PEL NAMES                                            71130002
* R12 USED FOR PARM SIZE                                                71160002
* R14 USED FOR NAME SIZE                                                71190002
* R15, R0, R1 USED FOR QUICK WORK                                       71220002
* R2 USED FOR KEY REG                                                   71250002
         L     R0,WAPARMSZ    GET PARM SIZE                             71280002
         A     R0,WANAMESZ    GET TOTAL SIZE (PARM SIZE+NAME SIZE)      71310002
         L     R14,SP253      GET SUBPOOL                               71340002
         BAL   R12,XGET       GET STORAGE                               71370002
         LTR   R15,R15        Q. GET THE CORE                           71400002
         BZ    YGOT2          A. YES CONTINUE.                          71430002
         MVI   WAERR,AB6XX    A. NO. INDICATE 638 OR 630 ABEND.         71460002
         B     NGOT2          RETURN.                                   71490002
YGOT2    EQU   *              PROCEED WITH MOVE.                        71520002
         L     R12,WAPARMSZ   GET PARM SIZE                             71550002
         LA    R9,ZERO(R1)    SAVE NEW PARM LIST ADDRESS.               71580002
         ST    R9,WANEWPEL    SAVE NEW PARM LIST FOR FREEMAIN           71610002
         OI    WAFLAG2,WANWPEL   INDICATE NEW PEL GOTTEN                71640002
* R8 CONTAINS ADDRESS OF OLD PEL.                                       71670002
         L     R14,WANAMESZ   GET THE NAME SIZE                         71700002
         LA    R10,ZERO(R9,R12)  GET THE ADDRESS TO NAME START          71730002
QMOVLIST EQU   *              *                                         71760002
         SH    R12,HPELSZ     Q. MOVE COMPLETE.                         71790002
         BM    YMOVLIST       A. YES EXIT.                              71820002
TEST50   EQU   *              *                                         71850002
         MODESET  KEYADDR=(2)    SET CALLER'S KEY.                      71880002
         LM    R15,R1,ZERO(R8)   GET ONE ELEMENT(LESS UCB)              71910002
TEST51   EQU   *              *                                         71940002
         MODESET  EXTKEY=SUPR   GO BACK TO KEY 0                        71970002
         STM   R15,R1,ZERO(R9)   SAVE ONE ELEMENT(LESS UCB)             72000002
         SH    R14,HMAJSZ     Q. MOVE COMPLETE                          72030002
         BM    YERRLIST       A. YES. VOLATILE INPUT LIST               72060002
         L     R15,PELMAJA-PEL(R9)  GET ADDRESS OF MAJOR NAME           72090002
TEST52   EQU   *              *                                         72120002
         MODESET  KEYADDR=(2)   SWITCH TO CALLER'S KEY                  72150002
         TM    ZERO(R15),ZERO    REFERENCE MAJOR NAME                   72180002
         TM    EIGHT-ONE(R15),ZERO    DITTO                             72210002
TEST53   EQU   *              *                                         72240002
         MODESET  EXTKEY=SUPR   SWITCH BACK TO KEY 0                    72270002
         MVC   ZERO(EIGHT,R10),ZERO(R15)  MOVE MAJOR NAME               72300002
         ST    R10,PELMAJA-PEL(R9)  RELOCATE MAJOR NAME POINTER         72330002
         CLC   ZERO(FOUR,R10),SYSZ   Q. AUTHORIZED NAME                 72360002
         BH    NAUTHNAM       A. NO.                                    72390002
         BE    YAUTHNAM       A. YES. RESTRICTED NAME                   72420002
         LA    R1,SYSTABLE-EIGHT   SEARCH THRU AUTH NAME TABLE          72450002
QAUTHNAM EQU   *              *                                         72480002
         LA    R1,EIGHT(R1)   GET ADDRESS CURRENT AUTH NAME             72510002
         CLC   ZERO(EIGHT,R10),ZERO(R1)    Q. AUTHORIZED NAME           72540002
         BH    QAUTHNAM       A. NO. LOOP.                              72570002
         BL    NAUTHNAM       A. NO. NAME NOT IN TABLE                  72600002
YAUTHNAM EQU   *              *                                         72630002
         MVI   WAERR,AB3XX    INDICATE NOT AUTHORIZED FOR FUNCTION      72660002
NAUTHNAM EQU   *              *                                         72690002
         LA    R10,PELMAJSZ(R10)   UPDATE NAMES ADDRESS                 72720002
         ICM   R15,M1111,PELMINA-PEL(R9)  Q. MINOR NAME                 72750002
         BZ    NMINMOVE       A. NO. NO MOVE                            72780002
         SR    R1,R1          ZERO FOR INSERT                           72810002
         ICM   R1,M0001,PELMILEN-PEL(R9)  Q. DYNAMIC MI LENGTH          72840002
         BNZ   YMINMOVE       A. NO. HAVE LENGTH                        72870002
TEST54   EQU   *              *                                         72900002
         MODESET  KEYADDR=(2)   SWITCH TO CALLER'S KEY                  72930002
         ICM   R1,M0001,ZERO(R15)  Q. MINOR                             72960002
TEST55   EQU   *              *                                         72990002
         MODESET  EXTKEY=SUPR   SWITCH BACK TO KEY 0                    73020002
         LA    R15,ONE(R15)   ADJUST MINOR NAME ADDRESS                 73050002
         BNZ   YMINMOVE       A. YES.                                   73080002
* THIS PATH IS LEGAL IF GENERIC DEQ WAS SPECIFIED.                      73110002
         SR    R15,R15        ZERO MINOR NAME                           73140002
         ST    R15,PELMINA-PEL(R9)    DITTO                             73170002
         B     NMINMOVE       CONTINUE.                                 73200002
YMINMOVE EQU   *              *                                         73230002
         SR    R14,R1         Q. MOVE COMPLETE                          73260002
         BM    YERRLIST       A. YES. VOLATILE LIST                     73290002
         STC   R1,PELMILEN-PEL(R9)  SAVE MINOR NAME LENGTH              73320002
         BCTR  R1,ZERO        DECREMENT FOR EXECUTE                     73350002
TEST56   EQU   *              *                                         73380002
         MODESET  KEYADDR=(2)   SWITCH TO CALLER'S KEY                  73410002
         IC    R0,ZERO(R15)      REFERENCE MINOR NAME                   73440002
         IC    R0,ZERO(R15,R1)    DITTO                                 73470002
TEST57   EQU   *              *                                         73500002
         MODESET  EXTKEY=SUPR   SWITCH BACK TO KEY 0                    73530002
         EX    R1,MOVEMIN     MOVE MINOR NAME                           73560002
         ST    R10,PELMINA-PEL(R9)    RELOCATE MINOR ADDRESS            73590002
         LA    R10,ONE(R10,R1)   UPDATE NAMES ADDRESS                   73620002
NMINMOVE EQU   *              *                                         73650002
         TM    PELFLAG-PEL(R9),PELSCPE2  Q. UCB SPECIFIED               73680002
         BZ    NRESV1         A. NO.                                    73710002
         TM    PELFLAG-PEL(R9),PELSCPE1  Q. UCB SPECIFIED.              73740002
         BO    NRESV1         A. NO.                                    73770002
         SH    R12,HFOUR      Q. END OF MOVE                            73800002
         BM    YERRLIST       A. YES. INPUT LIST VOLATILE.              73830002
         SH    R14,HFOUR      Q. END OF MOVE                            73860002
         BM    YERRLIST       A. YES. INPUT LIST VOLATILE.              73890002
TEST58   EQU   *              *                                         73920002
         MODESET  KEYADDR=(2)    SWITCH TO CALLER'S KEY                 73950002
         L     R15,PELUCBAA-PEL(R8)  GET THE UCB ADDR ADDR              73980002
         L     R15,ZERO(R15)  GET THE UCB ADDR                          74010002
TEST59   EQU   *              *                                         74040002
         MODESET  EXTKEY=SUPR  SWITCH BACK TO KEY 0                     74070002
         ST    R15,ZERO(R10)     SAVE THE UCB ADDRESS                   74100002
         ST    R10,PELUCBAA-PEL(R9)   SAVE UCB ADDR ADDR                74130002
         LA    R8,FOUR(R8)    UPDATE OLD PEL ADDRESS                    74160002
         LA    R9,FOUR(R9)    UPDATE NEW PEL ADDRESS                    74190002
         LA    R10,FOUR(R10)  UPDATE NAMES ADDR                         74220002
NRESV1   EQU   *              *                                         74250002
         LA    R8,PELELEM(R8)    UPDATE OLD PEL ADDRESS                 74280002
         LA    R9,PELELEM(R9)  UPDATE NEW PEL ADDRESS                   74310002
         B     QMOVLIST       LOOP.                                     74340002
YERRLIST EQU   *              INPUT LIST VOLATILE                       74370002
         MVI   WAERR,AB4XX    INDICATE INVALID PARM LIST                74400002
YMOVLIST EQU   *              *                                         74430002
NGOT2    EQU   *              *                                         74460002
YAUTH    EQU   *              *                                         74490002
* OBTAIN CMS LOCK                                                       74520002
X4       SETLOCK  OBTAIN,TYPE=CMS,MODE=UNCOND,RELATED=((X8),(X9)) LOCK  74550002
TEST60   EQU   *              *                                         74580002
         OI    WAFLAG1,WACMS  INDICATE CMS OBTAINED                     74610002
         L     R13,CVTPTR     GET GLOBAL SAVE ADDRESS                   74640002
TEST61   EQU   *              *                                         74670002
         L     R13,CVTSPSA-CVT(R13)  DITTO                              74700002
         L     R13,WSAGNQDQ-WSAG(R13)  DITTO                            74730002
         XC    GSCLEAR(GSCLEARL),GSCLEAR  ZERO PORTION OF GLOBAL STORE  74760002
TEST62   EQU   *              *                                         74790002
         L     R14,PSAAOLD    SAVE THE ASID                             74820002
         MVC   GSASID(TWO),ASCBASID-ASCB(R14)  DITTO                    74850002
         L     R8,WANEWPEL    SETUP CORRECT PARM LIST ADDRESS           74880002
* WANEWPEL CONTAINS EITHER THE NEWLY GOTTEN LIST OR THE INPUT LIST      74910002
         BR    R3             RETURN                                    74940002
         EJECT                                                          74970002
XSTARTIO EQU   *              *                                         75000002
* ROUTINE TO BE SCHEDULED BY IOS AT THE COMPLETION OF                   75030002
*  THE I/O DONE TO RELEASE A RESERVED DEVICE.                           75060002
         LR    R8,R14         SAVE RETURN REG.                          75090002
         BALR  R15,ZERO       OBTAIN ADDRESSABILITY                     75120002
         USING *,R15          DITTO                                     75150002
         LM    R6,R7,BASES    OBTAIN ADDRESSABILITY TO ENTIRE MODULE    75180002
         DROP  R15            *                                         75210002
X1       SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=((X2)) LOCK      75240002
TEST62A  EQU   *              *                                         75270002
         LA    R0,ZLEN        LENGTH OF IOSB-SRB CORE                   75300002
         L     R3,SP245       SUBPOOL 245                               75330002
         SR    R4,R4          PASS NO TCB ADDRESS                       75360002
         L     R7,PSAAOLD     GET CURRENT ASCB                          75390002
         BALR  R15,ZERO       TEMP ADDRESSABILITY                       75420002
         USING *,R15          DITTO                                     75450002
         FREEMAIN RC,LV=(0),A=(1),KEY=(3),SP=(3),BRANCH=YES FREE CORE   75480002
TEST62B  EQU   *              *                                         75510002
         DROP  R15            RELEASE TEMP ADDRESSABILITY               75540002
         L     R7,BASES+FOUR  RESTORE 2ND BASE REG.                     75570002
X2       SETLOCK RELEASE,TYPE=LOCAL,RELATED=((X1)) UNLOCK               75600002
TEST62C  EQU   *              *                                         75630002
         LR    R14,R8         RESTORE RETURN REGISTER                   75660002
         BR    R14            BRANCH TO DISPATCHER.                     75690002
         EJECT                                                          75720002
XSVCFREE EQU   *              *                                         75750002
         FREEMAIN RC,LV=(0),A=(1),SP=(14)  FREE STORAGE                 75780002
TEST63   EQU   *              *                                         75810002
         BR    R12            EXIT                                      75840002
         EJECT                                                          75870002
XUNCHAIN EQU   *              *                                         75900002
         ICM   R14,M1111,PREV(R12)  GET PREVIOUS                        75930002
         L     R15,NEXT(R12)  GET THE NEXT                              75960002
         BZ    NPREV          THERE IS NO PREVIOUS                      75990002
* YES PREVIOUS                                                          76020002
         LTR   R15,R15        Q. IS THERE A NEXT.                       76050002
         BZ    NNEXT          A. NO.                                    76080002
* NEXT AND PREVIOUS (UNCHAIN FROM MIDDLE)                               76110002
         ST    R15,NEXT(R14)  NEXT=NEXT                                 76140002
         ST    R14,PREV(R15)  PREV=PREV                                 76170002
         BR    R3             RETURN                                    76200002
NNEXT    EQU   *              *                                         76230002
* NO NEXT AND PREVIOUS  (UNCHAIN FROM BOTTOM)                           76260002
         ST    R15,NEXT(R14)  NEXT=0                                    76290002
         ST    R14,LAST(R1)   LAST=PREV                                 76320002
         BR    R3             RETURN                                    76350002
NPREV    EQU   *              *                                         76380002
         LTR   R15,R15        Q. IS THERE A NEXT                        76410002
         BZ    NNEXT1         A. NO.                                    76440002
* NO PREVIOUS AND A NEXT  (UNCHAIN FROM TOP)                            76470002
         ST    R15,FIRST(R1)   FIRST=NEXT                               76500002
         ST    R14,PREV(R15)  PREV=0                                    76530002
         BR    R3             RETURN                                    76560002
NNEXT1   EQU   *              *                                         76590002
* NO PREVIOUS AND NO NEXT (UNCHAIN  ONLY)                               76620002
         ST    R15,FIRST(R1)  FIRST=0                                   76650002
         ST    R14,LAST(R1)   LAST=0                                    76680002
         BR    R3             RETURN                                    76710002
         DROP  R6,R7                                                    76720040
         EJECT                                                          76740002
         IHAASCB                                                        76777703
         EJECT                                                          76780002
         IHAASVT                                               @YM01596 76790002
         EJECT                                                          76800002
         IHAASXB                                                        76830002
         EJECT                                                          76860002
         CVT   DSECT=YES,LIST=YES                                       76890002
         EJECT                                                          76920002
         IHADQE                                                         76950002
         EJECT                                                          76980002
         IHAFRRS                                                        77010002
         EJECT                                                          77040002
         IHAFQE                                                         77070002
         EJECT                                                          77100002
         IHAGDA                                                         77130002
         EJECT                                                          77160002
**********************************************************************  77162003
*                                                                    *  77164003
*        ENQ/DEQ/RESERVE GLOBAL SAVE AREA                            *  77166003
*                                                                    *  77168003
*                                                                    *  77170003
*        A NIP DEPENDENCY REQUIRES THAT THE FOLLOWING          @Z30BNVD 77172003
*        DATA FIELDS BEGIN AT DISPLACEMENT X'80' AND ARE       @Z30BNVD 77174003
*        CONTIGUOUS. NIP INITIALIZES THESE FIELDS.             @Z30BNVD 77176003
*                       GSCOUNT  - 6 WORDS                     @Z30BNVD 77178003
*                       GSQUEUE  - 6 WORDS                     @Z30BNVD 77180003
*                       GSBLOCKB - 1 WORD                      @Z30BNVD 77182003
*                       GSBLOCKE - 1 WORD                      @Z30BNVD 77184003
*                                                                    *  77186003
**********************************************************************  77188003
GS       DSECT                                                          77190002
GSSAVE   DS    0F             18 WORD SAVE AREA                         77220002
         DS    F              1ST WORD                                  77250002
GSPSAVE  DS    F              PREVIOUS SAVE                             77280002
GSNSAVE  DS    F              NEXT SAVE                                 77310002
GSSAVE1  DS    16F            REGISTER SAVE AREA (MUST BE 16 WORDS)     77340002
GSR14SAV DS    1F             LINK R14 SAVE AREA                        77370002
GSR2SAVE DS    1F             LINK R2 SAVE AREA                         77400002
GSGBSV   DS    0F             GET/FREE BLOCK RTN SAVE AREA     @Z30BNVD 77402003
GSR3SAVE DS    11F            LINK R3 SAVE AREA                         77430002
GSCOUNT  DS    6F             CONTAINS COUNT OF FREE CELLS IN QUEUE     77460002
GSQUEUE  DS    6F             POINTERS TO HEADS OF FREE CELL QUEUES     77490002
GSBLOCKB DS    F              BEGINNING ADDR OF BLOCK          @Z30BNVD 77492003
GSBLOCKE DS    F              ENDING ADDR OF BLOCK             @Z30BNVD 77502003
GSCLEAR  EQU   *              HERE TO GSCLEARL IS CLEARED ON EACH ENTRY 77520002
GSLSTQEL DS    F              LIST QEL SAVE FOR DEQ                     77550002
GS3WORDS DS    0F             BLOCK LENGTH SAVE LOCATIONS               77580002
GSMNWORD DS    F              LENGTH OF MINOR BEING OBTAINED            77610002
GSMJWORD DS    F              LENGTH OF MAJOR BEING OBTAINED            77640002
GSQLWORD DS    F              LENGTH OF QEL BEING OBTAINED              77670002
GSGPAREA EQU   *              BEGINNING OF GROUP INDICATORS             77700002
GSGRPNUM DS    F              ACTUAL OR POTENTIAL GROUP NUMBER          77730002
GSGROUP  DS    0H             BEGINNING OF GROUP COUNTERS               77760002
GSGROUP0 DS    H              DUMMY GROUP.                              77790002
GSGROUP1 DS    H              NUMBER OF QELS IN GROUP 1                 77820002
GSGROUP2 DS    H              NUMBER OF QELS IN GROUP 2                 77850002
GSGROUP3 DS    H              NUMBER OF QELS IN GROUP 3                 77880002
GSGROUP4 DS    H              NUMBER OF QELS IN GROUP 4                 77910002
GSGPLEN  EQU   *-GSGPAREA     LENGTH OF GROUP INDICATOR AREA            77940002
GSASID   DS    H              ASID SAVE LOCATION                        77970002
GSCLEARL EQU   *-GSCLEAR      LENGTH OF AREA REINIT. ON EACH ENTRY      78000002
GSFLAG1  DS    B              GENERAL ENQ/DEQ STATUS FLAGS              78030002
GSHOLD   EQU   X'80'          USED ONLY BY THE XHOLD/XRLSE ROUTINE      78060002
GSNOENQ  EQU   X'40'          ENQ ON-OFF SWITCH                         78090002
GSFRRSER EQU   X'20'          SERIOUS ERROR (SET BY FRR)                78120002
* FROM HERE ON IS FRR WORK AREA                                         78150002
GSFRRSAV DS    4F             GENERAL SAVE AREA                         78180002
GSFRRSDW EQU   GSFRRSAV+12    SDWA AD (REG 1)                           78210002
GSFRR2SV DS    4F             LINK REG2 SAVE AREA                       78240002
GSFRR3SV DS    4F             LINK REG3 SAVE AREA                       78270002
GSFRR4SV DS    4F             LINK REG4 SAVE AREA                       78300002
         EJECT                                                          78330002
         IECDIOCM                                                       78360002
         EJECT                                                          78390002
         IECDIOSB                                                       78420002
IOSBLEN  EQU   IOSEND-IOSB    LENGTH OF IOSB                            78450002
         EJECT                                                          78480002
         IHAQCB                                                         78510002
MAJBASIC EQU   24             LENGTH OF ALL MAJORS                      78540002
MAJLEN   EQU   MAJNAME-MAJ+8  BASIC SIZE OF A MAJOR QCB                 78570002
MINLEN   EQU   MINNAME-MIN    NON-VARIABLE SIZE OF MINOR QCB            78600002
MINBASIC EQU   20             MINIMUM LENGTH OF ALL MINORS              78630002
         EJECT                                                          78660002
PELPREFX DSECT                                                          78690002
PELTCB   DS    A              IF BOTH TCB AND ECB ARE CODED, TCB        78700040
*                             ADDRESS                          @ZA14267 78706040
PELDUAL  DS    A              PEL PREFIX WORD (TCB ADDR. OR ECB ADDR.)  78720002
PEL      EQU   *              BEGINNING OF PEL                          78750002
PELLAST  DS    X              FLAG 1 BYTE                               78780002
PELEOL   EQU   X'80'          LAST ELEMENT OF LIST                      78810002
PELIGNOR EQU   X'40'          IGNORE REMAINING BITS OF THIS BYTE        78840002
PELRES1  EQU   X'20'          RESERVED                                  78870002
PELSHR   EQU   X'10'          SHARED RESOURCE                  @YM03340 78900002
PELSAVE  EQU   X'08'          RESERVED                                  78930002
PELGEN1  EQU   X'04'          SEE COMMENTS BELOW                        78960002
PELGEN2  EQU   X'02'          SEE COMMENTS BELOW                        78990002
PELTCBF  EQU   X'01'          TCB= WAS SPECIFIED                        79020002
* PELGEN1 AND PELGEN2                                                   79050002
*   00- NO GENERIC                                                      79080002
*   01- GENERIC=YES                                                     79110002
*   10- GENERIC=COND (VS1 ONLY)                                         79140002
*   11- GENERIC=ALL (VS1 ONLY)                                          79170002
PELMILEN DS    X              RNAME LENGTH                              79200002
PELFLAG  DS    X              FLAG 2 BYTE                               79230002
PELSHARE EQU   X'80'          0 = EXCLUSIVE, 1 = SHARE                  79260002
PELSCPE1 EQU   X'40'          SEE COMMENTS BELOW                        79290002
PELSYSMC EQU   X'20'          OBSOLETE (SET/RESET SYSTEM MUST COMPLETE) 79320002
PELSTPMC EQU   X'10'          SET/RESET STEP MUST COMPLETE SPECIFIED    79350002
PELSCPE2 EQU   X'08'          SEE COMMENTS BELOW                        79380002
PELRET1  EQU   X'04'          SEE COMMENTS BELOW                        79410002
PELRET2  EQU   X'02'          SEE COMMENTS BELOW                        79440002
PELRET3  EQU   X'01'          SEE COMMENTS BELOW                        79470002
* PELRET1 AND PELRET2 AND PELRET3                                       79500002
*   000- RET=NONE (NO RET)                                              79530002
*   001- RET=HAVE                                                       79560002
*   010- RET=CHNG                                                       79590002
*   011- RET=USE                                                        79620002
*   100- ECB=                                                           79650002
*   101- RESERVED                                                       79680002
*   110- RESERVED                                                       79710002
*   111- RET=TEST                                                       79740002
* PELSCPE1 AND PELSCPE2                                                 79770002
*   00- STEP                                                            79800002
*   01- SYSTEMS AND UCB                                                 79830002
*   10- SYSTEM                                                          79860002
*   11- SYSTEMS                                                         79890002
PELRET   DS    X              RETURN CODE AREA                          79920002
PELMAJA  DS    A              ADDRESS OF QNAME                          79950002
PELMAJSZ EQU   8              LENGTH OF QNAME                           79980002
PELMINA  DS    A              ADDRESS OF RNAME                          80010002
PELELEM  EQU   *-PEL          LENGTH OF ONE PARAMETER ELEMENT           80040002
PELUCBAA DS    A              ADDRESS OF POINTER TO UCB                 80070002
         EJECT                                                          80100002
         IHAPSA                                                         80130002
         EJECT                                                          80160002
         IHAQEL                                                         80190002
QELSIZE1 EQU   16             SUBORDINATE QEL (NOT LIST QEL)            80220002
QELSIZE2 EQU   24             LISTQEL WITHOUT UCB                       80250002
QELSIZE3 EQU   28             LIST QEL WITH UCB                         80280002
QELBASIC EQU   16             MINIMUM LENGTH OF ALL QELS                80310002
         EJECT                                                          80340002
         IHARB                                                          80370040
RBOPSWKY EQU   RBOPSW+1       PSW KEY IN RB                             80400002
         EJECT                                                          80430002
         ORG   RBEXSAVE                                                 80460002
WA       EQU   *                   ENQ WORK AREA                        80490002
* WARNING----WARNING----WARNING----WARNING----WARNING----WARNING *      80520002
* ENQ/DEQ MAY USE 12 WORDS                                              80550002
* THE RESOURCE MANAGER AND SUBROUTINES MAY ONLY USE THE 1ST 7 WORDS     80580002
* COMMON TO ENQ/DEQ/RESOURCE MANAGER                                    80610002
WADWORD  DS    D              QUICK SAVE AREA (NOT USED ACROSS BAL)     80640002
WAWTOQ   DS    F              PTR. TO FIRST MSG. IN MSG. QUEUE          80670002
WARETRY  DS    X              INDEX TO RETRY ADDRESS                    80700002
WAERR    DS    X              FIRST DIGIT OF ABEND CODE                 80730002
WARESV1  DS    H              RESERVED                                  80760002
WAFLAG1  DS    B              CURRENT PROCESSING FLAGS                  80790002
WACMS    EQU   X'80'          ON - CMS LOCK HELD                        80820002
WAFRR    EQU   X'40'          ON - FRR ESTABLISHED                      80850002
WALOCAL  EQU   X'20'          ON - LOCAL LOCK HELD                      80880002
WASPOST  EQU   X'10'          ON - ISSUE SPOST                          80910002
WASTATUS EQU   X'08'          ON - ISSUE STATUS                         80940002
WAABNDMC EQU   X'04'          THIS TASK/ADDRSPACE ABEND IN M.C.         80970002
WAWAITN  EQU   X'02'          ON - WAITING QEL FOUND (NOT ECB)          81000002
WA1DEQ   EQU   X'01'          ON - INDICATES AT LEAST ONE QEL DEQUEUED  81030002
WAFLAG2  DS    B              USER/INPUT SUMMARY FLAGS                  81060002
WABADMIL EQU   X'80'          ON - BAD MINOR LENGTH SPECIFIED           81090002
WARMC    EQU   X'40'          ISSUE STATUS RESET,MC,STEP                81120002
WADAMAGE EQU   X'20'          TRIGGERS Q-DAMAGE MESSAGE                 81150002
WANOCORE EQU   X'10'          ON - NO STORAGE AVAILABLE                 81180002
WAR15SW  EQU   X'08'          ON - INDICATES NON-ZERO RETURN CODE       81210002
WAWAIT   EQU   X'04'          ON - WAIT WITHIN ENQ                      81240002
WANOAUTH EQU   X'02'          ON - FAILED AUTHORIZATION CHECK           81270002
WANWPEL  EQU   X'01'          INDICATES GOT NEW PARM LIST CORE          81300002
WAPFLGS  DS    H              SAVED PARM FLAGS                          81330002
WAPLAST  EQU   WAPFLGS+0      SAVED PELLAST FLAG BYTE                   81360002
WAPFLAG  EQU   WAPFLGS+1      SAVED PELFLAG FLAG BYTE                   81390002
WARMLEN  EQU   *-WA           RES. MGR. WA LENGTH                       81420002
* COMMON TO JUST ENQ/DEQ                                                81450002
WANEWPEL DS    F              NEW PARAMETER LIST ADDR (UNAUTH. CALLER)  81480002
WAOLDPEL DS    F              INPUT PARAMETER LIST ADDRESS              81510002
WAPARMSZ DS    F              SIZE OF NEW PARAM. LIST OBTAINED          81540002
WANAMESZ DS    F              TOTAL SIZE OF MINOR NAME                  81570002
WAFLAG3  DS    B              ADDITIONAL PROCESSING FLAGS      @Z30BNVD 81600003
WALONGWT EQU   X'80'          ON - ISSUE LONG WAIT             @Z30BNVD 81610003
WARET    DS    B              RETURN CODE SAVE LOCATION                 81630002
WAKEY    DS    H              CALLER'S KEY                              81660002
WAECBA   DS    F              ECB SAVE FOR ENQ  (HIGH BIT 1)            81690002
WATCBA   EQU   WAECBA         TCB SAVE FOR ENQ/DEQ (HIGH BIT 0)         81720002
WAECBF   EQU   X'80'          HIGH BIT 1 MEANS ECB SPECIFIED.           81750002
WALEN    EQU   *-WA           LENGTH OF WORK AREA                       81780002
         EJECT                                                          81810002
         IHARMPL                                                        81840002
         EJECT                                                          81845040
         IHASCB                                                         81850040
         EJECT                                                          81860040
         EJECT                                                          81870002
         IHASRB                                                         81900002
SRBLEN   EQU   *-SRB          LENGTH OF SRB                             81930002
         EJECT                                                          81960002
         IHASCVT LIST=YES                                      @YM03564 81970002
         EJECT                                                          81980002
         IHASDWA                                                        81990002
         ORG   SDWAVRA        VARIABLE RECORDING AREA                   82020002
VRA      EQU   *              *                                         82050002
VRACOUNT DS    XL4            ERROR COUNT                               82080002
* FROM HERE DOWN IS INFO PERTAINING TO FIRST ERROR ENCOUNTERED          82110002
VRACSECT DS    XL4            ADDRESS OF IEAVENQ1                       82140002
VRALINKA DS    XL4            LAST 'BAL' PRIOR TO RECORDING             82170002
VRACODE  DS    XL4            CODE X'10' QEL, X'14' MINOR, X'18' MAJOR  82200002
VRAADDR1 DS    XL4            FIRST ADDRESS OF INVALID RANGE            82230002
VRAADDR2 DS    XL4            LAST ADDRESS OF INVALID RANGE             82260002
VRALEN1  EQU   *-VRA          MINIMUM RECORD LENGTH                     82290002
VRAIMAGE DS    XL64           INVALID RANGE IMAGE                       82320002
VRALEN2  EQU   *-VRAIMAGE     MAXIMUM IMAGE LENGTH                      82350002
         EJECT                                                          82380002
         IHASPQE                                                        82410002
         EJECT                                                          82440002
         IKJTCB                                                         82470002
         EJECT                                                          82500002
TIOT     DSECT                                                          82530002
         IEFTIOT1                                                       82560002
         EJECT                                                          82590002
IEFUCBOB DSECT                                                          82620002
         IEFUCBOB  LIST=YES                                             82650002
UCBSKA   EQU   UCBOB+X'30'    SEEK ADDRESS                              82680002
         EJECT                                                          82710002
         IHAWSAVT  CLASS=GLOBAL                                         82740002
         EJECT                                                          82750040
         IHAWSAVT                                                       82760040
         EJECT                                                          82770002
Z        DSECT                                                          82800002
* COMBINES THE IOSB AND SRB FOR 'STARTIO' LOGIC.                        82830002
ZIOSB    DS    0D             IOSB                                      82860002
         ORG   *+IOSBLEN      IOSB END                                  82890002
ZSRB     DS    0D             SRB                                       82920002
         ORG   *+SRBLEN       SRB END                                   82950002
ZLEN     EQU   *-Z            Z END                                     82980002
         EJECT                                                          83010002
IGC048   CSECT                                                          83040002
*        THESE CONSTANTS MUST BE ADDRESSABLE BY THE FRR,                83042040
*        THE ESTAE, AND NORMAL ENQ/DEQ PROCESSING. THE                  83044040
*        TECHNIQUE USED IS THAT THE FRR USES THE START OF               83046040
*        THE CONSTANTS AS THE BEGINNING OF ITS ADDRESSABILITY.          83048040
*        ALL OTHER PROCESSING USES THE BEGINNING OF THE                 83050040
*        MODULE AS THE START OF ADDRESSABILITY; THUS, THE               83052040
*        CONSTANT AREA IS AT THE END OF THAT ADDRESSABILITY.            83054040
*                                                                       83056040
FRRBASE  DS    0D                DUMMY FOR FRR ADDRESSABILITY           83058040
*        THE FOLLOWING CONSTANTS ARE NEEDED FOR INTRA MODULE            83060040
*        ADDRESSABILITY.                                                83062040
*                                                                       83064040
BASES    DC    A(IGC048),A(IGC048+4096) BASE ADDRESS'S FOR THIS MODULE  83070002
ERBPREL  DC    AL4(RBPRFXND-RBPREFIX)   LENGTH OF RB PREFIX    @ZA03873 83080040
POSTADDR DC    V(IEA0PT01)    POST E.P.                                 83100002
WAITADDR DC    V(IEAVWAIT)    BRANCH E.P. TO WAIT                       83130002
SP245    DC    0F'0',AL3(245),AL1(0)    SUBPOOL 245                     83160002
SP253    DC    0F'0',AL3(253),AL1(0)    SUBPOOL 253                     83190002
FONE     DC    F'1'           FULL WORD ONE                             83220002
HONE     EQU   FONE+2         HALF WORD ONE                             83250002
FFOUR    DC    F'4'           FULL WORD FOUR                            83280002
HFOUR    EQU   FFOUR+2        HALF WORD FOUR                            83310002
FEIGHT   DC    F'8'           FULL WORD EIGHT                           83340002
HEIGHT   EQU   FEIGHT+2       HALF WORD EIGHT                           83370002
HIGHBIT  DC    X'80000000'    MASK TO TURN ON HIGH ORDER BIT            83400002
KEYMASK  DC    X'000000F0'    MASK TO TURN OFF ALL BUT KEY BITS         83430002
HMAJSZ   EQU   FEIGHT+2       MAJOR NAME LENGTH                         83460002
HPELSZ   DC    H'12'          ELEMENT SIZE IN INPUT PARM LIST           83490002
HMAXLEN  DC    AL2(INSERT7L)  MAXIMUM MINOR LENGTH FOR MSG              83520002
ST       DC    CL2'ST'        ST MEANS STEP.                            83550002
HPREFIX  DC    AL2(PEL-PELPREFX) LENGTH OF PEL PREFIX          @ZA14267 83560040
TABLE    DC    CL16'0123456789ABCDEF'  TRANSLATE TABLE                  83580002
SYSTABLE DS    0D             AUTHORIZED NAME TABLE                     83610002
* THIS TABLE MUST BE IN ALPHABETICAL ORDER                              83640002
         DC    CL8'SYSCTLG'   SYSCTLG                           @Y02113 83690002
         DC    CL8'SYSDSN'    SYSDSN                                    83700002
         DC    CL8'SYSIEA01'  SYSIEA01                                  83730002
         DC    CL8'SYSIEECT'  SYSIEECT                                  83760002
         DC    CL8'SYSIEFSD'  SYSIEFSD                                  83790002
         DC    CL8'SYSIGGV1'  SYSIGGV1                          @Y02113 83800002
         DC    CL8'SYSIGGV2'  SYSIGGV2                          @Y02113 83810002
         DC    CL8'SYSPSWRD'  SYSPSWRD                                  83820002
         DC    CL8'SYSVSAM'   SYSVSAM                           @Y02113 83830002
         DC    CL8'SYSVTOC'   SYSVTOC                                   83850002
SYSZ     DC    CL4'SYSZ',XL4'FFFFFFFF'   THIS IS  A STOPPER             83880002
LIST     DC    CL8'IEAVENQ1'  LOAD MUDULE NAME                          83910002
         DC    CL8'IGC048'    CSECT NAME                                83940002
         DC    CL8'IEAVSRR1'  FRR NAME                                  83970002
LISTLEN  EQU   *-LIST         *                                         84000002
RETRY    DS    0F             RETRY ADDRESSES                           84030002
RETRYDEQ EQU   *-RETRY        INDEX TO RETRY ADDRESS                    84060002
         DC    A(DEQXRTRY)    DEQ RETRY ADDRESS                         84090002
RETRYENQ EQU   *-RETRY        INDEX TO RETRY ADDRESS                    84120002
         DC    A(ENQXRTRY)    ENQ RETRY ADDRESS                         84150002
RETRYERM EQU   *-RETRY        INDEX TO RETRY ADDRESS                    84180002
         DC    A(ERMXRTRY)    RES. MGR. RETRY ADDRESS                   84210002
DUMMYPEL DS    0F             DUMMY PEL FOR QEL SCAN ROUTINE            84240002
DUMMYWD1 DC    X'80010000'    END OF LIST AND MINOR LENGTH OF ONE       84270002
DUMMYWD2 DC    X'00000000'    DUMMY QNAME ADDRESS                       84300002
DUMMYWD3 DC    X'00000000'    DUMMY RNAME ADDRESS                       84330002
FZERO    EQU   DUMMYWD3       FULLWORD OF ZERO                          84360002
HZERO    EQU   FZERO          HALFWORD OF ZERO                          84390002
* NOTE: BY CHANGING QTAB,GSCOUNT AND GSQUEUE THE NUMBER OF              84420002
*       QUEUES CAN BE CHANGED.                                          84450002
IEAVENQQ DS    0F             USED BY NIP TO INIT LIMITS       @Z30BNVD 84460003
QTAB     DC    F'0',F'0',F'48',F'98',F'18',F'10' Q LIMITS=4K   @Z30BNVD 84480003
QLENGTH  EQU   *-QTAB-4       TABLE LENGTH                              84510002
QRANGE   DC    A(QLENGTH)     ALL INSIDE OF RANGE CAN BE QUEUED         84540002
BLKSIZE  DC    F'0',F'0',F'384',F'1152',F'256',F'160' SECONDARY        X84544003
               BLOCK SIZES 24,48,8,4 ELEMENTS RESPECTIVELY     @Z30BNVD 84554003
BR14     BR    R14            ERROR ROUTINE FOR BAD CROSS MEM POSTS     84570002
MOVEMIN  MVC   ZERO(ZERO,R10),ZERO(R15)  MOVE RNAME                     84600002
MOVEMIN1 MVC   MINNAME-MIN(ZERO,R12),ZERO(R14)  MOVE RNAME              84630002
MOVEMIN2 MVC   INSERT7+FOUR(ZERO,R1),MINNAME  MOVE MINOR TO WTO STORAGE 84660002
COMPMIN  CLC   MINNAME(ZERO),ZERO(R12)   COMPARE MINOR NAMES            84690002
         EJECT                                                          84720002
ERMWTP   WTO   'IEA803I JS FAILED WHILE IN ''STEP MUST COMPLETE'' STATU-84750002
               S DUE TO S   ',MF=L,ROUTCDE=(1)  WTP MSG                 84780002
INSERT1  EQU   12             JS OR ST INSERT                           84810002
INSERT2  EQU   66             COMP CODE INSERT                          84840002
ERMWTO1  WTO   'IEA801I UNIDENTIFIED TASK JS FAILED WHILE IN ''STEP MUS-84870002
               T COMPLETE STATUS''',ROUTCDE=(1),DESC=3,MF=L  WTO MSG    84900002
INSERT5A EQU   30             ST OR JS INSERT                           84930002
INSERT3  EQU   12             JOB NAME INSERT                           84960002
INSERT4  EQU   20             COMMA INSERT                              84990002
INSERT5  EQU   21             STEP NAME INSERT                          85020002
ERMWTO2  WTO   'IEA961I RESOURCE NAMED         ,                       -85050002
                               ',ROUTCDE=(1),DESC=3,MF=L  WTO MSG       85080002
INSERT6  EQU   27             MAJOR NAME INSERT                         85110002
INSERT7  EQU   36             MINOR NAME INSERT                         85140002
FRRWTO   WTO   'IEA960I ENQ/DEQ CONTROL QUEUES WERE DAMAGED. RESTORATIO-85170002
               N ATTEMPTED',ROUTCDE=(1),DESC=3,MF=L  WTO MSG            85200002
INSERT1L EQU   2              JS OR ST LENGTH                           85230002
INSERT3L EQU   8              JOB NAME LENGTH                           85260002
INSERT5L EQU   8              STEP NAME LENGTH                          85290002
INSERT6L EQU   8              MAJOR NAME LENGTH                         85320002
INSERT7L EQU   24             MAX MINOR NAME LENGTH                     85350002
MAYBEDAM DC    CL14'MAY BE DAMAGED'  INSERT FOR ERMWTO2                 85380002
MAYLEN   EQU   *-MAYBEDAM     MSG LENGTH                                85410002
         EJECT                                                          85440002
* BIT MASKS                                                             85450002
M0001    EQU   B'0001'        MASK USED IN ICM INSTR.                   85470002
M0010    EQU   B'0010'        MASK USED IN ICM INSTR.                   85490002
M0011    EQU   B'0011'        MASK USED IN ICM INSTR.                   85510002
M0111    EQU   B'0111'        MASK USED IN ICM INSTR.                   85530002
M1000    EQU   B'1000'        MASK USED IN ICM INSTR.                   85550002
M1100    EQU   B'1100'        MASK USED IN ICM INSTR.                   85570002
M1111    EQU   B'1111'        MASK USED IN ICM INSTR.                   85590002
* REGISTER EQUATES - INDICATE GENERAL USAGE                             85610002
R0       EQU   0              WORK                                      85680002
R1       EQU   1              ADDRESS OF SDWA OR WORK                   85700002
R2       EQU   2              RETURN ADDR. - FIRST LEVEL SUBROUTINES    85720002
R3       EQU   3              RETURN ADDR. - SECOND LEVEL SUBROUTINES   85740002
R4       EQU   4              ADDRESS OF CURRENT TCB                    85760002
R5       EQU   5              ADDRESS OF CURRENT RB                     85780002
R6       EQU   6              FIRST BASE                                85800002
R7       EQU   7              SECOND BASE                               85820002
R8       EQU   8              ADDR. OF PEL OR ADDR. OF RMPL             85840002
R9       EQU   9              ADDRESS OF MAJOR                          85860002
R10      EQU   10             ADDRESS OF MINOR                          85880002
R11      EQU   11             ADDRESS OF QEL                            85900002
R12      EQU   12             RETURN ADDR. - THIRD LEVEL SUBROUTINES    85920002
R13      EQU   13             ADDR. OF ENQ/DEQ GLOBAL SAVE AREA         85940002
R14      EQU   14             WORK                                      85960002
R15      EQU   15             WORK AND RETURN CODE                      85980002
         EJECT                                                          86140002
* CONSTANTS                                                             86150002
ZERO     EQU   0              ZERO                                      86160002
ONE      EQU   1              ONE                                       86190002
TWO      EQU   2              TWO                                       86220002
THREE    EQU   3              THREE                                     86250002
FOUR     EQU   4              FOUR                                      86280002
FIVE     EQU   5              FIVE                                      86310002
SEVEN    EQU   7              SEVEN                                     86340002
EIGHT    EQU   8              EIGHT                                     86370002
NINE     EQU   9              NINE                                      86400002
TWELVE   EQU   12             TWELVE                                    86430002
TWENTY   EQU   20             TWENTY                                    86460002
BLKRANGE EQU   20             INDEX TO LAST AVAILABLE                  X86461003
                               COUNT/QUEUE IN THE GS           @Z30BNVD 86463003
AB138    EQU   1              PREFIX FOR ABEND CODE                     86490002
AB238    EQU   2              PREFIX FOR ABEND CODE                     86520002
AB338    EQU   3              PREFIX FOR ABEND CODE                     86550002
AB438    EQU   4              PREFIX FOR ABEND CODE                     86580002
AB638    EQU   6              PREFIX FOR ABEND CODE                     86610002
AB838    EQU   8              PREFIX FOR ABEND CODE                     86640002
AB130    EQU   1              PREFIX FOR ABEND CODE                     86670002
AB230    EQU   2              PREFIX FOR ABEND CODE                     86700002
AB330    EQU   3              PREFIX FOR ABEND CODE                     86730002
AB430    EQU   4              PREFIX FOR ABEND CODE                     86760002
AB530    EQU   5              PREFIX FOR ABEND CODE                     86790002
AB630    EQU   6              PREFIX FOR ABEND CODE                     86820002
AB3XX    EQU   3              PREFIX FOR ABEND CODE                     86850002
AB4XX    EQU   4              PREFIX FOR ABEND CODE                     86880002
AB6XX    EQU   6              PREFIX FOR ABEND CODE                     86910002
AB7XX    EQU   7              PREFIX FOR ABEND CODE                     86940002
NEXT     EQU   0              NEXT MAJ,MIN,QEL                          86970002
PREV     EQU   4              PREVIOUS MAJ,MIN,QEL                      87000002
FIRST    EQU   0              FIRST MAJ,MIN,QEL                         87030002
LAST     EQU   4              LAST MAJ,MIN,QEL                          87060002
FWORD    EQU   3              FULLWORD BOUNDRY CHECK                    87090002
DWORD    EQU   7              DOUBLEWORD BOUNDRY CHECK                  87120002
XFF      EQU   X'FF'          ALL ONES                                  87150002
DEQCODE  EQU   X'30'          BACK END OF DEQ ABEND CODE.               87180002
ENQCODE  EQU   X'38'          BACK END OF ENQ CODE.                     87210002
NOSUPKEY EQU   X'80'          WHEN ON - NOT SUPR KEY           @YM03564 87220002
WTOLEN   EQU   88             LENGTH OF WTO GOTTEN STORAGE              87270002
         EJECT                                                          87290040
IEAVSRR1 EQU   *              SOFTWARE RECOVERY ROUTINE                 87310040
DEQFRR   EQU   *              *                                         87330040
ENQFRR   EQU   *              *                                         87350040
ERMFRR   EQU   *              *                                         87370040
XFRR     EQU   *              *                                         87390040
         BALR  R15,ZERO       TEMPORARY ADDRESSABILITY                  87410040
         USING *,R15          TEMPORARY ADDRESSABILITY                  87430040
         L     R6,XFRRBASE           GET PERMANENT ADDRESSABILITY       87440040
         DROP  R15                                                      87470040
         USING FRRBASE,R6           PERMANENT ADDRESSABILITY            87480040
         USING SDWA,R1        SDWA ADDRESSABILITY                       87510040
         MVC   SDWAMODN(LISTLEN),LIST  MOVE 3 NAMES                     87530040
         OI    SDWAACF2,SDWAFREE+SDWARCRD  FREE SDWA, ALSO RECORD.      87550040
         ICM   R0,M0011,SDWAFMID   Q. LSQA ADDRESSABLE                  87570040
         BNZ   NREF           A. NO.                                    87590040
         L     R5,SDWAPARM    GET W.A. ADDRESSABILITY                   87610040
         L     R5,ZERO(R5)    DITTO                                     87630040
         MVI   WAERR,AB7XX    INDICATE UNEXPECTED ABEND                 87650040
         L     R9,CVTPTR      GET ENQ/DEQ GLOBAL S.A.                   87670040
TEST19A  EQU   *              *                                         87690040
         L     R13,CVTSPSA-CVT(R9)   DITTO.                             87710040
         L     R13,WSAGNQDQ-WSAG(R13)   DITTO                           87730040
*                                                                       87750040
* PARM LIST IS INVALID, IF---                                           87770040
* PROGRAM CHECK OCCURRED                                                87790040
* PROGRAM CHECK PSW KEY IS NOT ZERO                                     87810040
* FRR WAS NOT PERCOLATED TO.                                            87830040
* NOTE-THE RESOURCE MANAGER RUNS ONLY IN KEY 0.                         87850040
*                                                                       87870040
         TM    SDWAERRA,SDWAPCHK Q. INVALID PARM LIST                   87890040
         BZ    NINVALID       A. NO.                                    87910040
         TM    SDWAMWP1,SDWAKEY1    Q. INVALID PARM LIST                87930040
         BZ    NINVALID       A. NO.                                    87950040
         TM    SDWAERRC,SDWAPERC  Q. INVALID PARM LIST.                 87970040
         BO    NINVALID       A. NO.                                    87990040
         MVI   WAERR,AB4XX    INDICATE INVALID LIST ABEND               88010040
         NI    SDWAACF2,XFF-SDWARCRD  DON'T RECORD                      88030040
         B     YINVALID       A. YES. INVALID PARM LIST                 88050040
NINVALID EQU   *              *                                         88070040
         STM   R14,R1,GSFRRSAV   SAVE RETURN AD,SDWA AD                 88090040
         TM    WAFLAG1,WACMS  Q. HAVE CMS.                              88110040
         BZ    NSEARCH        A. NO.                                    88130040
         LR    R0,R13         SAVE REG                                  88150040
XX       SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=((XY))          88170040
TEST19B  EQU   *              *                                         88190040
         LR    R13,R0         RESTORE REG                               88210040
* SCAN,VERIFY AND FIX QUEUES.                                           88230040
         LA    R12,CVTFQCB-CVT(R9) ADDRESS OF FIRST/LAST (MAJOR)        88250040
         LA    R8,MAJBASIC    PASS COMMON LENGTH OF MAJOR               88270040
         BAL   R2,XFRRFIX     VERIFY AND MAYBE FIX, Q. SERIOUS ERROR    88290040
         BZ    NSERIOUS       A. NO.                                    88310040
         OI    GSFLAG1,GSNOENQ  A. YES, TURN OFF ENQ.                   88330040
NSERIOUS EQU   *              *                                         88350040
         ICM   R9,M1111,CVTFQCB-CVT(R9)  Q. ANY MAJORS                  88370040
QMAJOR1  EQU   *              *                                         88390040
         BZ    NMAJOR1        A. NO.                                    88410040
         LA    R12,MAJFMIN    ADDRESS OF FIRST/LAST (MINOR)             88430040
         LA    R8,MINBASIC    PASS COMMON LENGTH OF MINOR               88450040
         BAL   R2,XFRRFIX     VERIFY AND MAYBE FIX. Q. SERIOUS ERROR    88470040
         BZ    NSER           A. NO.                                    88490040
         OI    GSFLAG1,GSNOENQ   A. YES. TURN OFF ENQ.                  88510040
NSER     EQU   *              *                                         88530040
         ICM   R10,M1111,MAJFMIN Q. ANY MINORS.                         88550040
QMINOR1  EQU   *              *                                         88570040
         BZ    NMINOR1        A. NO.                                    88590040
         LA    R12,MINFQEL    ADDRESS OF FIRST/LAST (QEL)               88610040
         LA    R8,QELBASIC    PASS COMMON LENGTH OF QEL                 88630040
         BAL   R2,XFRRFIX     VERIFY AND MAYBE FIX, Q. SERIOUS ERROR    88650040
         BZ    NSERI          A. NO.                                    88670040
         OI    MINFLGS,MINNOENQ  A. YES. NO ENQS FOR THIS MINOR         88690040
NSERI    EQU   *              *                                         88710040
         ICM   R10,M1111,MINNMIN  Q. ANY MORE MINORS.                   88730040
         BNZ   QMINOR1        A. YES.                                   88750040
NMINOR1  EQU   *              *                                         88770040
         ICM   R9,M1111,MAJNMAJ  Q. ANY MAJORS LEFT.                    88790040
         BNZ   QMAJOR1        A. YES.                                   88810040
NMAJOR1  EQU   *              *                                         88830040
         L     R1,QRANGE      GET THE HIGHEST VALID INDEX               88850040
QGOODQS  EQU   *              *                                         88870040
         L     R14,GSQUEUE(R1)   GET TOP OF QUEUE.                      88890040
QGOODQ   EQU   *              *                                         88910040
         LTR   R14,R14        Q. THIS QUEUE O.K.                        88930040
         BZ    YGOODQ         A. YES.                                   88950040
         LR    R15,R14        GET END OF STORAGE PLUS ONE               88970040
         AR    R15,R1         DITTO                                     88990040
         AR    R15,R1         DITTO                                     89010040
         BAL   R4,XFRRQGOT    Q. GOOD QUEUE                             89030040
         BNZ   NGOODQ         A. NO.                                    89050040
         L     R14,NEXT(R14)  GET NEXT FREE ELEMENT ADDRESS             89070040
         B     QGOODQ         LOOP.                                     89090040
NGOODQ   EQU   *              *                                         89110040
         SR    R4,R4          RESTORE QUEUE                             89130040
         ST    R4,GSQUEUE(R1) DITTO                                     89150040
YGOODQ   EQU   *              *                                         89170040
         S     R1,FFOUR       Q. LAST INDEX                             89190040
         BNZ   QGOODQS        A. NO. LOOP.                              89210040
* GSQUEUE IS STILL GOOD OR HAS BEEN MADE GOOD.                          89230040
         LR    R0,R13         SAVE REG                                  89250040
XY       SETLOCK  RELEASE,TYPE=SALLOC,RELATED=((XX))  FREE LOCK         89270040
TEST19D  EQU   *              *                                         89290040
         LR    R13,R0         RESTORE REG                               89310040
NSEARCH  EQU   *              *                                         89330040
         LM    R14,R1,GSFRRSAV   RESTORE REGS                           89350040
YINVALID EQU   *              *                                         89370040
         SR    R15,R15        CLEAR FOR INSERT                          89390040
         ICM   R15,M0001,WARETRY  Q. RETRY                              89410040
         BZ    NRETRY         A. NO.                                    89430040
         L     R15,RETRY(R15) GET RETRY ADDRESS                         89450040
         MVI   WARETRY,ZERO   ZERO FOR RECURSION                        89470040
* SETUP INPUT REGS FOR RETRY                                            89490040
         LM    R6,R7,BASES  SET MAINLINE BASE REGS             @ZA03873 89500040
         STM   R5,R13,SDWASR05   PASS R5,R6,R7,R13                      89510040
* RETRY                                                                 89530040
         ST    R15,SDWARTYA   SET RETRY ADDRESS                         89550040
         MVI   SDWARCDE,FOUR  INDICATE RETRY                            89570040
         SR    R15,R15        RETURN                                    89590040
TEST19M  EQU   *              *                                         89610040
         BR    R14            DITTO                                     89630040
NRETRY   EQU   *              *                                         89650040
NREF     EQU   *              *                                         89670040
         OI    SDWAACF4,SDWACMS+SDWAFLLK   FREE LOCKS                   89690040
         MVI   SDWARCDE,ZERO  CONTINUE W/TERMINATION                    89710040
         SR    R15,R15        A.O.K.                                    89730040
TEST20   EQU   *              *                                         89750040
         BR    R14            EXIT                                      89770040
         EJECT                                                          89830040
XFRRFIX  EQU   *              *                                         89850040
* VERIFY AND MAYBE FIX THE QUEUES                                       89870040
         STM   R1,R4,GSFRR2SV SAVE REGS.                                89890040
         SR    R1,R1          PREVIOUS ELEMENT =0                       89910040
         SR    R2,R2          PREVIOUS ELEMENT =0                       89930040
         NI    GSFLAG1,XFF-GSFRRSER   RESET ANSWER FLAGS                89950040
         L     R14,FIRST(R12) GET FIRST                                 89970040
QBADFOW  EQU   *              *                                         89990040
         LR    R15,R14        GET END OF BASIC SECTION PLUS 1           90010040
         AR    R15,R8         DITTO                                     90030040
         LTR   R14,R14        Q. ANY MORE                               90050040
         BZ    NBADFOW        A. NO MORE FOWARD POINTERS                90070040
         BAL   R3,XFRRQADR    Q. BAD ADDRESS.                           90090040
         BNZ   YBADFOW        A. YES.                                   90110040
         CLR   R14,R12        Q. CIRCULAR QUEUE                         90130040
         BE    YCIRCLE        A. YES. BAD FOWARD POINTER                90150040
         LTR   R1,R1          Q. TOP ELEMENT.                           90170040
         BZ    NCIRCLE        A. YES. NOT CIRCULAR YET.                 90190040
         L     R4,FIRST(R12)  A. NO. CHECK FOR CIRCLE.                  90210040
QCIRCLE  EQU   *              *                                         90230040
         CLR   R14,R4         Q. CIRCULAR QUEUE                         90250040
         BE    YCIRCLE        A. YES.                                   90270040
         CLR   R4,R1          Q. END OF SEARCH                          90290040
         BE    NCIRCLE        A. YES.                                   90310040
         L     R4,NEXT(R4)    CONTINUE SEARCH.                          90330040
         B     QCIRCLE        DITTO.                                    90350040
NCIRCLE  EQU   *              *                                         90370040
         CL    R1,PREV(R14)   Q. HAS BACKWARD QUEUE BEEN HIT.           90390040
         BE    NHITBACK       A. NO.                                    90410040
         BAL   R4,XFRRSM      INDICATE SMALL ERROR                      90430040
         ST    R1,PREV(R14)   FIX PREVIOUS.                             90450040
NHITBACK EQU   *              *                                         90470040
         CL    R1,LAST(R12)   Q. DOES LAST POINT WITHIN Q.              90490040
         BNE   NWITHIN        A. NO.                                    90510040
         BAL   R4,XFRRSM      INDICATE SMALL ERROR.                     90530040
         XC    LAST(FOUR,R12),LAST(R12)  FIX IT.                        90550040
NWITHIN  EQU   *              *                                         90570040
         LR    R1,R14         PREVIOUS=CURRENT                          90590040
         ICM   R14,M1111,NEXT(R14)  CONTINUE DOWN QUEUE                 90610040
         B     QBADFOW        DITTO                                     90630040
YCIRCLE  EQU   *              *                                         90650040
YBADFOW  EQU   *              *                                         90670040
         LTR   R1,R1          Q. BAD ADDRESS IN HEADER                  90690040
         BZ    YBADFIRS       A. YES.                                   90710040
         BAL   R4,XFRRSM      INDICATE SMALL ERROR                      90730040
         XC    NEXT(FOUR,R1),NEXT(R1)  FIX CHAIN POINTER                90750040
         B     NBADFIRS       CONTINUE                                  90770040
YBADFIRS EQU   *              *                                         90790040
         BAL   R4,XFRRSER     INDICATE LARGE ERROR.                     90810040
         XC    FIRST(FOUR,R12),FIRST(R12)  FIX HEADER                   90830040
NBADFIRS EQU   *              *                                         90850040
NBADFOW  EQU   *              *                                         90870040
         L     R14,LAST(R12)  GET LAST                                  90890040
QBADBACK EQU   *              *                                         90910040
         LR    R15,R14        GET END OF BASIC BLOCK PLUS 1             90930040
         AR    R15,R8         DITTO                                     90950040
         LTR   R14,R14        Q. ANY MORE                               90970040
         BZ    NBADBACK       A. NO MORE BACKWARD POINTERS              90990040
         BAL   R3,XFRRQADR    Q. BAD ADDRESS                            91010040
         BNZ   YBADBACK       A. YES.                                   91030040
         CLR   R14,R12        Q. CIRCULAR QUEUE                         91050040
         BE    YCIRCL         A. YES.                                   91070040
         LTR   R2,R2          Q. CIRCULAR QUEUE                         91090040
         BZ    NCIRCL         A. NO. FIRST TIME CANNOT BE CIRCULAR      91110040
         L     R4,LAST(R12)   A. MAYBE                                  91130040
QCIRCL   EQU   *              *                                         91150040
         CLR   R14,R4         Q. CIRCULAR QUEUE                         91170040
         BE    YCIRCL         A. YES.                                   91190040
         CLR   R4,R2          Q. CIRCULAR QUEUE                         91210040
         BE    NCIRCL         A. NO. THIS IS END OF SEARCH.             91230040
         L     R4,PREV(R4)    A. MAYBE. CONTINUE SEARCH.                91250040
         B     QCIRCL         DITTO.                                    91270040
NCIRCL   EQU   *              *                                         91290040
         CL    R2,NEXT(R14)   Q. HAS FOWARD Q BEEN HIT                  91310040
         BE    NHITFOW        A. NO.                                    91330040
         BAL   R4,XFRRSM      INDICATE SMALL ERROR                      91350040
         ST    R2,NEXT(R14)   FIX IT.                                   91370040
NHITFOW  EQU   *              *                                         91390040
         LR    R2,R14         PREVIOUS=CURRENT                          91410040
         ICM   R14,M1111,PREV(R14)  CONTINUE UP QUEUE.                  91430040
         B     QBADBACK       Q. END OF QUEUE.                          91450040
YCIRCL   EQU   *              *                                         91470040
YBADBACK EQU   *              *                                         91490040
         LTR   R2,R2          Q. BAD 'LAST' ADDRESS.                    91510040
         BZ    YBADLAST       A. YES.                                   91530040
         BAL   R4,XFRRSM      INDICATE SMALL ERROR.                     91550040
         XC    PREV(FOUR,R2),PREV(R2)  FIX IT.                          91570040
         B     NBADBACK       CONTINUE                                  91590040
YBADLAST EQU   *              *                                         91610040
         BAL   R4,XFRRSER     INDICATE SERIOUS ERROR                    91630040
         XC    LAST(FOUR,R12),LAST(R12)  FIX IT.                        91650040
NBADBACK EQU   *              *                                         91670040
         SR    R1,R1          PREVIOUS=0                                91690040
         ICM   R14,M1111,FIRST(R12)  Q. EMPTY Q.                        91710040
QLASTFOW EQU   *              *                                         91730040
         BZ    YLASTFOW       A. YES.                                   91750040
         LR    R1,R14         PREVIOUS=CURRENT                          91770040
         ICM   R14,M1111,NEXT(R14)  CONTINUE DOWN QUEUE.                91790040
         B     QLASTFOW       Q. IS IT THE END.                         91810040
YLASTFOW EQU   *              *                                         91830040
         CL    R1,LAST(R12)   Q. IS FOWARD QUEUE GOOD                   91850040
         BE    YFOW           A. YES.                                   91870040
         CL    R2,FIRST(R12)  Q. IS BACKWARD QUEUE GOOD                 91890040
         BE    NFOWYBCK       A. YES.                                   91910040
         LTR   R1,R1          Q. IS BACKWARD QUEUE GOOD.                91930040
         BZ    NFOWYBCK       A. YES.                                   91950040
         LTR   R2,R2          Q. IS FOWARD QUEUE GOOD                   91970040
         BZ    YFOWNBCK       A. YES.                                   91990040
NFOWNBCK EQU   *              *                                         92010040
* BAD FOWARD, BAD BACKWARD.                                             92030040
         BAL   R4,XFRRSER     INDICATE SERIOUS ERROR.                   92050040
         ST    R1,PREV(R2)    CHAIN THE LOOSE ENDS.                     92070040
         ST    R2,NEXT(R1)    DITTO.                                    92090040
         B     YFOWYBCK       CONTINUE.                                 92110040
NFOWYBCK EQU   *              *                                         92130040
* BAD FOWARD, GOOD BACKWARD.                                            92150040
         BAL   R4,XFRRSER     INDICATE SERIOUS ERROR.                   92170040
         ST    R2,FIRST(R12)  FIX IT.                                   92190040
         B     YFOWYBCK       CONTINUE.                                 92210040
YFOW     EQU   *              *                                         92230040
* GOOD FOWARD.                                                          92250040
         CL    R2,FIRST(R12)   Q. IS BACKWARD QUEUE GOOD.               92270040
         BE    YFOWYBCK       A. YES.                                   92290040
YFOWNBCK EQU   *              *                                         92310040
* GOOD FOWARD, BAD BACKWARD.                                            92330040
         BAL   R4,XFRRSER     INDICATE SERIOUS ERROR.                   92350040
         ST    R1,LAST(R12)   FIX IT.                                   92370040
YFOWYBCK EQU   *              *                                         92390040
         TM    GSFLAG1,GSFRRSER  CC=0 OK, CC NE 0 SERIOUS ERROR         92410040
         LM    R1,R4,GSFRR2SV RESTORE REGS                              92430040
         BR    R2             RETURN.                                   92450040
         EJECT                                                          92470040
XFRRQADR EQU   *              *                                         92490040
*  VERIFY THAT ADDRESS PASSED IN R14 IS A GOOD ADDRESS                  92510040
*  R15 CONTAINS THE LAST BYTE +1 TO BE VERIFIED                         92530040
         STM   R1,R4,GSFRR3SV SAVE REGS.                                92550040
         BAL   R4,XFRRQGOT    Q. BAD ADDRESS.                           92570040
* OUTPUT IS COND. CODE 0=GOOD ADDRESS, NZ=BAD ADDRESS                   92590040
         BNZ   YBADADR        A. YES.                                   92610040
         LA    R1,MINBASIC    GET MIDDLE BASIC LENGTH                   92630040
         CLR   R8,R1          DETERMINE EXIT ROUTINE                    92650040
         BE    XMINCK         MINOR EXIT.                               92670040
         BL    XQELCK         QEL EXIT.                                 92690040
XMAJCK   EQU   *              MAJOR EXIT.                               92710040
         B     NBADADR        NOT A BAD ADDRESS.                        92730040
XMINCK   EQU   *              *                                         92750040
         SR    R1,R1          CLEAR                                     92770040
         IC    R1,MINNAMEL-MIN(R14)  GET MINOR NAME LENGTH              92790040
         AR    R15,R1         CALCULATE MINOR QCB END ADDR. +1          92810040
         BAL   R4,XFRRQGOT    Q. BAD ADDRESS.                           92830040
* AN OUTPUT CC OR NZ MEANS BAD ADDRESS                                  92850040
         BNZ   YBADADR        A. YES.                                   92870040
* CHECK MINOR SCOPE                                                     92890040
         TM    MINFLGS-MIN(R14),MINSYSS+MINSYS  Q. BAD SCOPE            92910040
         BO    YBADADR        A. YES                                    92930040
         TM    MINFLGS-MIN(R14),MINSYSS+MINSTEP  Q. BAD SCOPE.          92950040
         BO    YBADADR        A. YES.                                   92970040
         TM    MINFLGS-MIN(R14),MINSYS+MINSTEP  Q. BAD SCOPE            92990040
         BO    YBADADR        A. YES.                                   93010040
         B     NBADADR        A. NO. GOOD CONTROL BLOCK.                93030040
XQELCK   EQU   *              *                                         93050040
         LR    R1,R14         SAVE REG 14                               93070040
         LR    R2,R15         SAVE REG                                  93090040
         TM    QELTCB-QEL(R14),FWORD  Q. FULL WORD BNDY.                93110040
         BNZ   YBADQEL        A. NO. BAD QEL ADDRESS.                   93130040
         TM    QELQFLGS-QEL(R14),QELLIST  Q. LIST QEL                   93150040
         BO    YLSTQEL        A. YES.                                   93170040
*  SUBQEL THRU HERE.                                                    93190040
         TM    QELQFLGS-QEL(R14),QELRESV   Q. RESERVE                   93210040
         BZ    NRESERV2       A. NO.                                    93230040
         A     R15,FFOUR      ADD UCB ADDRESS LENGTH                    93250040
         BAL   R4,XFRRQGOT    Q. BAD QEL                                93270040
         BNZ   YBADQEL        A. YES.                                   93290040
         L     R3,QELSIZE1(R14)  GET UCB ADDRESS                        93310040
         BAL   R4,XFRRQUCB    Q. GOOD UCB ADDRESS                       93330040
         BZ    YGOODUCB       A. YES.                                   93350040
         BAL   R4,XFRRSM      RECORED SMALL ERROR                       93370040
         NI    QELQFLGS-QEL(R14),XFF-QELRESV   RESET RESERVE BIT.       93390040
YGOODUCB EQU   *              *                                         93410040
NRESERV2 EQU   *              *                                         93430040
         ICM   R14,M1111,QELLQEL-QEL(R1)  GET LIST QEL ADDRESS          93450040
         BNM   YBADQEL        Q. HIGH BIT ON. A. NO. BAD ADDRESS        93470040
         X     R14,HIGHBIT    ZERO HIGH BIT                    @YM01991 93490040
YLSTQEL  EQU   *              *                                         93510040
* R14 CONTAINS LISTQEL ADDRESS TO BE CHECKED.                           93530040
* R1 CONTAINS A SUBQEL OR SAME AS R14                                   93550040
         LA    R15,QELSIZE2   GET END ADDRESS PLUS 1                    93570040
         AR    R15,R14        DITTO                                     93590040
         BAL   R4,XFRRQGOT    Q. GOTTEN IN SP245                        93610040
         BNZ   YBADQEL        A. NO.                                    93630040
         TM    QELTCB-QEL(R14),QELXLIST  Q. CORRECT BIT SETTING         93650040
         BO    YBADQEL        A. NO. BAD ADDRESS.                       93670040
         TM    QELQFLGS-QEL(R14),QELRESV  Q. RESERVE                    93690040
         BZ    NRESERV        A. NO.                                    93710040
         A     R15,FFOUR      ADD UCB ADDRESS LENGTH                    93730040
         BAL   R4,XFRRQGOT    Q. BAD QEL                                93750040
         BNZ   YBADQEL        A. YES.                                   93770040
         L     R3,QELSIZE2(R14)  GET UCB ADDRESS.                       93790040
         BAL   R4,XFRRQUCB    Q. GOOD UCB ADDR.                         93810040
         BZ    YUCBOK         A. YES.                                   93830040
         BAL   R4,XFRRSM      RECORD SMALL ERROR                        93850040
         NI    QELQFLGS-QEL(R14),XFF-QELRESV   RESET RESERVE BIT.       93870040
YUCBOK   EQU   *              *                                         93890040
NRESERV  EQU   *              *                                         93910040
         TM    QELECB-QEL(R14),QELXECB  Q. ECB                          93930040
         BO    YECB           A. YES.                                   93950040
* SVRB THRU HERE                                                        93970040
         TM    QELLFLGS-QEL(R14),QELECBF  Q. BITS CONFLICT              93990040
         BO    YBADQEL        A. YES. BAD QEL ADDRESS.                  94010040
         B     NECB2          CONTINUE                                  94030040
YECB     EQU   *              *                                         94050040
         TM    QELLFLGS-QEL(R14),QELECBF  Q. BITS CONFLICT              94070040
         BZ    YBADQEL        A. YES.                                   94090040
NECB2    EQU   *              *                                         94110040
         CLC   QELLCNT-QEL(TWO,R14),HZERO  Q. LIST COUNT INACCURATE     94130040
         BE    YBADQEL        A. YES.                                   94150040
* GOOD QEL, SO FAR.                                                     94170040
         CLC   QELLFLGS-QEL(THREE,R14),QELLFLGS-QEL(R1) Q. COMMON MATCH 94190040
         BNE   YBADQEL        A. NO. BAD QEL.                           94210040
         LR    R14,R1         RESTORE REG 14                            94230040
         LR    R15,R2         RESTORE REG                               94250040
         B     NBADADR        GOOD ADDRESS RETURN.                      94270040
YBADQEL  EQU   *              *                                         94290040
* BAD QEL                                                               94310040
         LR    R14,R1         RESTORE REG 14                            94330040
         LR    R15,R2         RESTORE REG                               94350040
YBADADR  EQU   *              *                                         94370040
* BAD ADDRESS, CC NE 0                                                  94390040
         LM    R1,R4,GSFRR3SV RESTORE REGS.                             94410040
         LTR   R3,R3          CC NE 0                                   94430040
         BR    R3             RETURN                                    94450040
NBADADR  EQU   *              *                                         94470040
* GOOD ADDRESS, CC EQ 0                                                 94490040
         LM    R1,R4,GSFRR3SV RESTORE REGS.                             94510040
         CLR   R3,R3          CC EQ 0.                                  94530040
         BR    R3             RETURN.                                   94550040
         EJECT                                                          94570040
XFRRQGOT EQU   *              *                                         94590040
         STM   R1,R3,GSFRR4SV SAVE REGS.                                94610040
         L     R1,CVTPTR      GET SPQE FOR SUBPOOL 245                  94630040
         L     R1,CVTGDA-CVT(R1)  DITTO.                                94650040
         L     R1,SQASPQEP-GDA(R1)  DITTO.                              94670040
TEST32E  EQU   *              *                                         94690040
         ICM   R1,M1111,SPDQEPTR-SPQESECT(R1)  Q. ANY DQE-S LEFT.       94710040
QDQE     EQU   *              *                                         94730040
TEST32F  EQU   *              *                                         94750040
         BZ    NDQE           A. NO.                                    94770040
* HAVE DQE IN R1                                                        94790040
         L     R2,DQEBLKAD-DQESECT(R1)  GET LOW ADDRESS OF BLOCK        94810040
         LR    R3,R2          GET END OF BLOCK AD PLUS 1                94830040
         A     R3,DQELNTH-DQESECT(R1)   DITTO.                          94850040
* CHECK IF ADDRESS RANGE LIES WITHIN ALLOCATED STORAGE.                 94870040
         CLR   R14,R2         Q. LOW ADDRESS IN THIS BLOCK.             94890040
         BL    NINDQE         A. NO. H=MAYBE,L=NO,E=YES.                94910040
         CLR   R15,R3         Q. HIGH ADDRESS IN THIS BLOCK             94930040
         BNH   YDQE           A. YES.                                   94950040
NINDQE   EQU   *              *                                         94970040
TEST32G  EQU   *              *                                         94990040
         ICM   R1,M1111,DQEPTR-DQESECT(R1) Q. ANY MORE DQE-S            95010040
         B     QDQE           LOOP                                      95030040
YDQE     EQU   *              *                                         95050040
         ICM   R1,M1111,DQFQEPTR-DQESECT(R1)  A. ANY FQE-S.             95070040
QFQE     EQU   *              *                                         95090040
         BZ    NFQE           A. NO.                                    95110040
* HAVE FQE IN REG 1                                                     95130040
         LA    R3,FQESLNTH    GET END OF FREE AREA PLUS 1               95150040
         AR    R3,R1          DITTO                                     95170040
         LR    R2,R3          GET BEGINING OF FREE AREA.                95190040
         S     R2,FQELNTH-FQESECT(R1)   DITTO.                          95210040
* CHECK FOR OVERLAP OF ADDRESS RANGE VS. FREE AREA.                     95230040
         CLR   R15,R2         Q. HIGH ADDRESS LE FREE AREA.             95250040
         BNH   NINFQE         A. YES. NOT IN THIS FREE AREA.            95270040
         CLR   R14,R3         Q. LOW ADDRESS HE FREE AREA.              95290040
         BL    YFQE           A. NO. RANGE AND FREE AREA OVERLAP.       95310040
NINFQE   EQU   *              *                                         95330040
         ICM   R1,M1111,FQEPTR-FQESECT(R1)  Q. ANY MORE FQE-S           95350040
         B     QFQE           LOOP                                      95370040
NFQE     EQU   *              *                                         95390040
* CHECK FOR OVERLAP OF ADDRESS RANGE AND STORAGE CHECKS                 95410040
         L     R1,GSFRRSDW    GET SDWA ADDRESS                          95430040
         USING SDWA,R1        ADDRESSABILITY                            95450040
         CL    R15,SDWASCKB   Q. LE BEGIN                               95470040
         BNH   NSTORCK        A. YES. NOT A STORAGE CK.                 95490040
         CL    R14,SDWASCKE   Q. HIGHER THAN END                        95510040
         BH    NSTORCK        A. YES. NOT A STORAGE CK.                 95530040
         TM    SDWAMCHD,SDWASCK  Q. STORAGE CHECK.                      95550040
         BO    YSTORCK        A. YES. BAD ADDRESS.                      95570040
NSTORCK  EQU   *              *                                         95590040
         LM    R1,R3,GSFRR4SV RESTORE REGS.                             95610040
         CLR   R4,R4          SET CC=0                                  95630040
         BR    R4             RETURN                                    95650040
YSTORCK  EQU   *              *                                         95670040
YFQE     EQU   *              *                                         95690040
NDQE     EQU   *              *                                         95710040
         LM    R1,R3,GSFRR4SV RESTORE REGS.                             95730040
         LTR   R4,R4          SET CC NE 0                               95750040
         BR    R4             RETURN.                                   95770040
         EJECT                                                          95790040
XFRRSER  EQU   *               *                                        95810040
         OI    GSFLAG1,GSFRRSER   INDICATE SERIOUS ERROR.               95830040
XFRRSM   EQU   *              *                                         95850040
         STM   R1,R4,GSFRR4SV SAVE REGS.                                95870040
         OI    WAFLAG2,WADAMAGE  INDICATE QUEUE DAMAGE                  95890040
         L     R1,GSFRRSDW    GET SDWA ADDRESS                          95910040
         USING SDWA,R1        ADDRESSABILITY                            95930040
         L     R2,VRACOUNT    ADD 1 TO ERROR COUNT                      95950040
         A     R2,FONE        DITTO                                     95970040
         ST    R2,VRACOUNT    DITTO                                     95990040
         ST    R6,VRACSECT    SAVE ADDRESS OF THIS MODULE               96010040
         CLI   SDWAURAL,ZERO  Q. FIRST TIME THRU                        96030040
         BNE   NSAVE          A. NO. DON'T SAVE                         96050040
         MVC   VRACOUNT(FOUR),FONE  START COUNTING                      96070040
         OI    SDWADPVA,SDWAHEX  INDICATE HEX DATA.                     96090040
         ST    R4,VRALINKA    SAVE THE LAST LINK(BAL) ADDRESS           96110040
         LR    R2,R8          CONTROL BLOCK CODE                        96130040
         LR    R3,R14         START ADDRESS                             96150040
         LR    R4,R15         END ADDRESS                               96170040
         BCTR  R4,ZERO        DITTO                                     96190040
         STM   R2,R4,VRACODE  SAVE IT                                   96210040
         MVI   SDWAURAL,VRALEN1   INDICATE LENGTH                       96230040
TEST32J  EQU   *              *                                         96250040
         LRA   R2,ZERO(R3)    Q. CAN SAVE                               96270040
         BNZ   NSAVE          A. NO.                                    96290040
         LA    R2,VRALEN2-ONE  GET MAXIMUM LENGTH TO MOVE               96310040
         SR    R4,R3          GET CORRECT LENGTH                        96330040
         CLR   R2,R4          Q. MOVE MAXIMUM                           96350040
         BNH   YMAX           A. YES.                                   96370040
         LR    R2,R4          A. NO. SAVE LENGTH MINUS 1                96390040
YMAX     EQU   *              *                                         96410040
         LR    R4,R3          OBTAIN END ADDRESS                        96430040
         AR    R4,R2          DITTO.                           @YM05430 96450040
TEST32K  EQU   *              *                                         96470040
         LRA   R4,ZERO(R4)    Q. CAN SAVE                               96490040
         BNZ   NSAVE          A. NO.                                    96510040
         EX    R2,BADMOVE     MOVE IT.                                  96530040
BADMOVE  MVC   VRAIMAGE(ZERO),ZERO(R3)  DITTO                           96550040
         LA    R2,VRALEN1+ONE(R2) ACQUIRE TOTAL LENGTH                  96570040
         STC   R2,SDWAURAL    SAVE TOTAL                                96590040
NSAVE    EQU   *              *                                         96610040
         LM    R1,R4,GSFRR4SV RESTORE REGS.                             96630040
         BR    R4             RETURN.                                   96650040
         EJECT                                                          96670040
XFRRQUCB EQU   *              *                                         96690040
         STM   R1,R3,GSFRR4SV SAVE REGS.                                96710040
TEST32L  EQU   *              *                                         96730040
         LRA   R1,UCBID-UCBOB(R3)  Q. VALID UCB.                        96750040
         BNZ   NREALAD        A. NO.                                    96770040
         CLI   UCBID-UCBOB(R3),XFF  Q. VALID UCB.                       96790040
NREALAD  EQU   *              *                                         96810040
         LM    R1,R3,GSFRR4SV RESTORE REGS.                             96830040
         BR    R4             RETURN (CC OF 0 IS O.K.)                  96850040
*        THE FOLLOWING CONSTANT MUST STAY AT FRR END TO BE              96900040
*        ABLE TO ADDRESS THE COMMON CONSTANTS.                          96950040
XFRRBASE DC    A(FRRBASE)     ADDR OF CONSTANTS FOR BASE                97000040
         END   IGC048                                                   97050040
./  ADD  SSI=80930133,NAME=IEAVEOR
         TITLE 'IEAVEOR - VS2 ETM EXIT/EOT - SVC 3                     *00001000
                        '                                               00002000
IGC003   CSECT ,                                                01S0001 00003000
@PROLOG  DS    0H                                               01S0002 00004000
CVTPTR   EQU 16                                                         00005000
RBPRFXLN EQU 64                                                         00006000
RBPRFLNA EQU 32                                                         00007000
PRBLEN   EQU 136                                                        00008000
SIRBLEN  EQU 200                                                        00009000
TIRBLEN  EQU 136                                                        00010000
IRBLEN   EQU 128                                                        00011000
SVRBLEN  EQU 224                                                        00012000
         USING IGC003,R6CSECT                                           00013000
         MODID BR=YES                                                   00014000
*/* P  SAVE R15-R1 FROM ENTRY IN TCB RSA AND DO INITIALIZATION       */ 00015000
*                                                               01S0069 00016000
*   TCBGRS15=R15;                   /* SAVE R15                      */ 00017000
         ST    R15,TCBGRS15(,R4TCB)                             01S0069 00018000
*   TCBGRS0=R0;                     /* SAVE R0                       */ 00019000
         ST    R0,TCBGRS0(,R4TCB)                               01S0070 00020000
*   TCBGRS1=R1;                     /* SAVE R1                       */ 00021000
         ST    R1,TCBGRS1(,R4TCB)                               01S0071 00022000
*   TCBNONPR='0'B;                  /* SET TASK IN A PREEMPTIVE STATE   00023000
*                                      AGAIN                 @Z40FPYK*/ 00024000
         NI    TCBNONPR(R4TCB),B'11101111'                      01S0072 00025000
*   R8DSECT=WSALEXIT;               /* ADDRESS EXIT WORK/SAVE AREA   */ 00026000
         L     @12,ASCBASXB(,R7ASCB)                            01S0073 00027000
         L     @12,ASXBSPSA(,@12)                               01S0073 00028000
         L     R8DSECT,WSALEXIT(,@12)                           01S0073 00029000
*   GEN(USING @DATD,R8DSECT)                                    01S0074 00030000
*   REFS(R8DSECT);                  /* DATAREG(8)                    */ 00031000
         USING @DATD,R8DSECT                                            00032000
*   R14SAVE=CVTEXP1;                /* SAVE RETURN ADDRESS           */ 00033000
         L     @12,CVTEXP1(,R3CVT)                              01S0075 00034000
         ST    @12,R14SAVE                                      01S0075 00035000
*   R13AREA=ADDR(REGSAVE);          /* ADDRESS SUBROUTINE SAVEAREA   */ 00036000
         LA    R13AREA,REGSAVE                                  01S0076 00037000
*   RFY                                                         01S0077 00038000
*    (R14,                                                      01S0077 00039000
*     R15) UNRSTD;                  /* RELEASE ENTRY REGISTERS FOR      00040000
*                                      SUBROUTINE CALLS              */ 00041000
*   FLAGS=0;                        /* INITIALIZE WSA BITS           */ 00042000
         SLR   @12,@12                                          01S0078 00043000
         ST    @12,FLAGS                                        01S0078 00044000
*TESTREGS:                          /* TESTING LABEL                 */ 00045000
*                                                               01S0079 00046000
*   /*****************************************************************/ 00047000
*   /*                                                               */ 00048000
*   /* EXIT TERMINATES NOT ONLY RB'S BUT SPIE EXITS RUNNING UNDER    */ 00049000
*   /* RB'S AND MUST DISTINGUISH THE TWO CASES WITHOUT RECEIVING ANY */ 00050000
*   /* DATA FROM THE EXITING PROGRAM. TOWARD THIS END PFLIH INVOKES  */ 00051000
*   /* SPIE EXITS WITH R14 ADDRESSING AN SVC3 INSTRUCTION RESERVED   */ 00052000
*   /* FOR SPIE EXIT TERMINATION. IF A TASK WHICH HAS NOT ISSUED SPIE*/ 00053000
*   /* EXECUTES THAT SVC3 THEN EXIT TERMINATES THE CURRENT RB        */ 00054000
*   /* NORMALLY.                                                     */ 00055000
*   /*                                                               */ 00056000
*   /*****************************************************************/ 00057000
*                                                               01S0079 00058000
*/* D (YES,DOSPIE,NO,)  SVC3 FROM PCIH AND SPIE ISSUED               */ 00059000
*                                                               01S0079 00060000
*   IF PSWECIA                      /* IF INSTRUCTION ADDRESS FROM      00061000
*                                      SVC 3                         */ 00062000
*       =ADDR(IEAPSVC3)             /* EQUALS ADDRESS OF BYTE   01S0079 00063000
*                                      FOLLOWING PCIH SVC 3          */ 00064000
*       &TCBPIEAÂ¬=0                 /* AND TASK HAS ISSUED SPIE      */ 00065000
*       &SCAPIEÂ¬=0                  /* AND SPIE VALIDITY CHECK HAS      00066000
*                                      NOT FAILED                    */ 00067000
*       &PIEPICAAÂ¬=0 THEN           /* AND TASK HAS NOT CANCELLED       00068000
*                                      SPIE THEN                     */ 00069000
TESTREGS L     @12,@CA02028                                     01S0079 00070000
         C     @12,PSWECIA(,R5RB)                               01S0079 00071000
         BNE   @RF00079                                         01S0079 00072000
         L     @12,TCBPIEA-1(,R4TCB)                            01S0079 00073000
         LA    @12,0(,@12)                                      01S0079 00074000
         LTR   @12,@12                                          01S0079 00075000
         BZ    @RF00079                                         01S0079 00076000
         L     @12,TCBPIE(,R4TCB)                               01S0079 00077000
         L     @12,SCAPIE(,@12)                                 01S0079 00078000
         LTR   @12,@12                                          01S0079 00079000
         BZ    @RF00079                                         01S0079 00080000
         L     @12,PIEPICAA-1(,@12)                             01S0079 00081000
         LA    @12,0(,@12)                                      01S0079 00082000
         LTR   @12,@12                                          01S0079 00083000
         BNZ   @RT00079                                         01S0079 00084000
*     GO TO DOSPIE;                 /* GO TERMINATE SPIE EXIT        */ 00085000
*                                                               01S0081 00086000
*   /*****************************************************************/ 00087000
*   /*                                                               */ 00088000
*   /* AN RB MAY REQUEST BARRING FROM ITS TASK OF STATUS STOPS AND   */ 00089000
*   /* ATTENTION EXITS FOR THE DURATION OF THE EXISTENCE OF THAT RB. */ 00090000
*   /* EXIT UNBARS THE TASK UPON TERMINATION OF SUCH AN RB IF THE    */ 00091000
*   /* TASK HAS NO OTHER SUCH RB.                                    */ 00092000
*   /*                                                               */ 00093000
*   /*****************************************************************/ 00094000
*                                                               01S0081 00095000
*/* P  PERMIT STOP'S AND ATTN'S IF NO RB EXCEPT EXITOR BARS THEM     */ 00096000
*                                                               01S0081 00097000
*   IF RBATTN='1'B                  /* IF EXITING RB REQUESTS   01S0081 00098000
*                                      ATTN/STOP BARRING             */ 00099000
*       &RBTCBNXT='0'B THEN         /* AND HAS MOTHER RB THEN        */ 00100000
@RF00079 TM    RBATTN(R5RB),B'00100000'                         01S0081 00101000
         BNO   @RF00081                                         01S0081 00102000
         TM    RBTCBNXT(R5RB),B'10000000'                       01S0081 00103000
         BNZ   @RF00081                                         01S0081 00104000
*     DO;                           /* TRY TO UNBAR STOP'S AND ATTN'S   00105000
*                                      FROM TASK                     */ 00106000
*       R10WORK=RBLINKB;            /* ADDRESS RB FOR LOOP ON RB        00107000
*                                      CHAIN                         */ 00108000
         L     R10WORK,RBLINKB-1(,R5RB)                         01S0083 00109000
         LA    R10WORK,0(,R10WORK)                              01S0083 00110000
*       DO WHILE                    /* SCAN RB QUEUE FOR ANOTHER RB     00111000
*                                      REQUESTING BARRING WHILE      */ 00112000
*             (R10WORK->RBTCBNXT='0'B/* END OF RB QUEUE NOT REACHED  */ 00113000
*             &R10WORK->RBATTN='0'B);/* AND ANOTHER BARRING ANCESTOR    00114000
*                                      NOT FOUND                     */ 00115000
         B     @DE00084                                         01S0084 00116000
@DL00084 DS    0H                                               01S0085 00117000
*         R10WORK=R10WORK->RBLINKB; /* ADDRESS NEXT MOTHER RB        */ 00118000
         L     @12,RBLINKB-1(,R10WORK)                          01S0085 00119000
         LA    @12,0(,@12)                                      01S0085 00120000
         LR    R10WORK,@12                                      01S0085 00121000
*       END;                        /* LOOP TO TEST EXIT CONDITIONS  */ 00122000
@DE00084 TM    RBTCBNXT(R10WORK),B'10000000'                    01S0086 00123000
         BNZ   @DC00084                                         01S0086 00124000
         TM    RBATTN(R10WORK),B'00100000'                      01S0086 00125000
         BZ    @DL00084                                         01S0086 00126000
@DC00084 DS    0H                                               01S0087 00127000
*       IF R10WORK->RBATTN='0'B THEN/* IF NO BARRING RB FOUND THEN   */ 00128000
         TM    RBATTN(R10WORK),B'00100000'                      01S0087 00129000
         BNZ   @RF00087                                         01S0087 00130000
*         TCBATT='0'B;              /* UNBAR STOP/ATTN'S FROM TASK   */ 00131000
         NI    TCBATT(R4TCB),B'11011111'                        01S0088 00132000
*TESTBAR:                                                       01S0089 00133000
*       GEN(DS 0H);                 /* TESTING LABEL                 */ 00134000
@RF00087 DS    0H                                               01S0089 00135000
TESTBAR  DS 0H                                                          00136000
*     END;                          /* UNBARRING ATTEMPT COMPLETED   */ 00137000
*                                                               01S0091 00138000
*   /*****************************************************************/ 00139000
*   /*                                                               */ 00140000
*   /* MAKING STOP'S PERMISSABLE MAKES ANY DEFERRED STOP COMPLETABLE.*/ 00141000
*   /* EXIT NOTIFIES STATUS STOP SYNCH OF DEFERRED STOP COMPLETION.  */ 00142000
*   /*                                                               */ 00143000
*   /*****************************************************************/ 00144000
*                                                               01S0091 00145000
*/* P  COMPLETE STOP IF TASK HAS STOP PENDING AND DOESN'T BAR STOP'S */ 00146000
*                                                               01S0091 00147000
*   IF TCBSTPPR='1'B THEN                                       01S0091 00148000
@RF00081 TM    TCBSTPPR(R4TCB),B'01000000'                      01S0091 00149000
         BNO   @RF00091                                         01S0091 00150000
*     DO;                           /* IF TASK HAS STOP PENDING      */ 00151000
*       IF TCBATT='0'B THEN         /* AND TASK DOESN'T BAR STOPS       00152000
*                                      THEN                          */ 00153000
         TM    TCBATT(R4TCB),B'00100000'                        01S0093 00154000
         BNZ   @RF00093                                         01S0093 00155000
*         DO;                       /* COMPLETE STOP                 */ 00156000
*           TCBPNDSP='1'B;          /* SET TASK NONDISPATCHABLE      */ 00157000
         OI    TCBPNDSP(R4TCB),B'00000001'                      01S0095 00158000
*           TCBSTPP='1'B;           /* INDICATE NONDISPATCHABILITY      00159000
*                                      DUE TO STOP                   */ 00160000
         OI    TCBSTPP(R4TCB),B'01000000'                       01S0096 00161000
*           TCBSTPPR='0'B;          /* INDICATE TASK HAS NO STOP        00162000
*                                      PENDING                       */ 00163000
         NI    TCBSTPPR(R4TCB),B'10111111'                      01S0097 00164000
*STATUS1:                           /* TESTING LABEL                 */ 00165000
*           CALL IEAVESSS;          /* DECREMENT STATUS STOP    01S0098 00166000
*                                      SYNCH'ER'S WAIT COUNT         */ 00167000
STATUS1  L     @15,@CV02049                                     01S0098 00168000
         BALR  @14,@15                                          01S0098 00169000
*         END;                      /* STOP COMPLETED                */ 00170000
*       ELSE                                                    01S0100 00171000
*         DO;                       /* CHECK END OF TASK             */ 00172000
         B     @RC00093                                         01S0100 00173000
@RF00093 DS    0H                                               01S0101 00174000
*           IF TCBEOT='1'B          /* IF END OF TASK                */ 00175000
*               &RBTCBNXT='1'B THEN                             01S0101 00176000
         TM    TCBEOT(R4TCB),B'00000100'                        01S0101 00177000
         BNO   @RF00101                                         01S0101 00178000
         TM    RBTCBNXT(R5RB),B'10000000'                       01S0101 00179000
         BNO   @RF00101                                         01S0101 00180000
*             DO;                   /* AND LAST RB ON CHAIN          */ 00181000
*               CALL IEAVESSS;      /* GO TO STATUS FOR CLEAN UP     */ 00182000
         L     @15,@CV02049                                     01S0103 00183000
         BALR  @14,@15                                          01S0103 00184000
*             END;                  /* CLEAN UP COMPLETE             */ 00185000
*         END;                      /* END END OF TASK CHECK         */ 00186000
@RF00101 DS    0H                                               01S0106 00187000
*     END;                          /* STOP PENDING COMPLETE         */ 00188000
*                                                               01S0106 00189000
@RC00093 DS    0H                                               01S0107 00190000
*   /*****************************************************************/ 00191000
*   /*                                                               */ 00192000
*   /* A TASK BECOMES NONDISPATCHABLE WHEN THE MOTHER RB HAS         */ 00193000
*   /* OUTSTANDING WAIT'S OR EXIT HAS COMPLETED A STATUS STOP.       */ 00194000
*   /*                                                               */ 00195000
*   /*****************************************************************/ 00196000
*                                                               01S0107 00197000
*/* S CSPROC:  DECREMENT READY TCB COUNT ON WAIT OR STOP             */ 00198000
*                                                               01S0107 00199000
*   IF RBTCBNXT='0'B&               /* IF TASK NOT ENDED BUT         */ 00200000
*       (RBLINKB->RBWCF>0           /* EITHER MOTHER RB WAITING      */ 00201000
*       |TCBSTPP='1'B) THEN         /* OR TASK STOPPED BY EXIT THEN  */ 00202000
@RF00091 TM    RBTCBNXT(R5RB),B'10000000'                       01S0107 00203000
         BNZ   @RF00107                                         01S0107 00204000
         L     @12,RBLINKB-1(,R5RB)                             01S0107 00205000
         CLI   RBWCF(@12),0                                     01S0107 00206000
         BH    @RT00107                                         01S0107 00207000
         TM    TCBSTPP(R4TCB),B'01000000'                       01S0107 00208000
         BNO   @RF00107                                         01S0107 00209000
@RT00107 DS    0H                                               01S0108 00210000
*     CALL CSPROC;                  /* DECREMENT READY TASK COUNT    */ 00211000
         BAL   @14,CSPROC                                       01S0108 00212000
*                                                               01S0109 00213000
*   /*****************************************************************/ 00214000
*   /*                                                               */ 00215000
*   /* SVC 13 PERFORMS NORMAL TASK TERMINATION WHEN EXIT RECOGNIZES  */ 00216000
*   /* THE LAST RB AS EXITING FOR THE FIRST TIME. SVC 13 RUNS UNDER  */ 00217000
*   /* THE LAST RB AND SETS IT UP FOR SVC 3 WHICH TERMINATES IT AFTER*/ 00218000
*   /* SVC 13 HAS EXITED.                                            */ 00219000
*   /*                                                               */ 00220000
*   /*****************************************************************/ 00221000
*                                                               01S0109 00222000
*/* D (YES,DOSVC13,NO,)  LAST RB EXITING AND SVC 13 NOT EXECUTED     */ 00223000
*                                                               01S0109 00224000
*   IF RBTCBNXT='1'B                /* IF TCB HAS ONLY TERMINATING RB*/ 00225000
*       &TCBEOT='0'B THEN           /* AND TASK TERMINATION HAS NOT     00226000
*                                      EXECUTED THEN                 */ 00227000
@RF00107 TM    RBTCBNXT(R5RB),B'10000000'                       01S0109 00228000
         BNO   @RF00109                                         01S0109 00229000
         TM    TCBEOT(R4TCB),B'00000100'                        01S0109 00230000
         BZ    @RT00109                                         01S0109 00231000
*     GO TO DOSVC13;                /* BRANCH TO EXECUTE IT          */ 00232000
*                                                               01S0110 00233000
*   /*****************************************************************/ 00234000
*   /*                                                               */ 00235000
*   /* OTHERWISE EXIT TERMINATES THE EXITING RB.                     */ 00236000
*   /*                                                               */ 00237000
*   /*****************************************************************/ 00238000
*                                                               01S0111 00239000
*/* SVC3RB: L  TERMINATE RB -- CHART SVC3RB                          */ 00240000
*                                                               01S0111 00241000
*                                                               02S0111 00242000
*/* SVC3RB: CHART (AREF)                                             */ 00243000
*/* HEADER                                                      02S0111 00244000
*/* 3.1.7.9.17 - EXIT/EOT - SVC 3 - IEAVEOR                     02S0111 00245000
*/* SECOND OF TWO CHARTS - TERMINATION OF CONTROL LEVEL              */ 00246000
*/* E  RB TERMINATION -- FROM CHART SVC3                             */ 00247000
*                                                               02S0111 00248000
*   ;                                                           02S0111 00249000
*                                                               02S0111 00250000
@RF00109 DS    0H                                               02S0112 00251000
*   /*****************************************************************/ 00252000
*   /*                                                               */ 00253000
*   /* THE INNER HALF OF EXIT PERFORMS SIMPLE RB TERMINATION         */ 00254000
*   /* DEPENDING ON SUPERVISOR/PROGRAM/INTERRUPT/SYSTEM-INTERRUPT    */ 00255000
*   /* REQUEST BLOCK TYPE.                                           */ 00256000
*   /*                                                               */ 00257000
*   /*****************************************************************/ 00258000
*                                                               02S0112 00259000
*                                                               02S0112 00260000
*   /*****************************************************************/ 00261000
*   /*                                                               */ 00262000
*   /* EXIT DEQUEUES THE TERMINATING RB (UNLESS THIS WOULD LEAVE THE */ 00263000
*   /* TCB QUEUED BUT WITHOUT AN RB) MARKS THE RB INACTIVE AND THEN  */ 00264000
*   /* CALLS STAE CONTROL BLOCK PURGE IF THE RB HAS ISSUED STAE OR ON*/ 00265000
*   /* END OF TASK (IN WHICH CASE THE MOTHER TASK MAY HAVE ISSUED    */ 00266000
*   /* STAI).                                                        */ 00267000
*   /*                                                               */ 00268000
*   /*****************************************************************/ 00269000
*                                                               02S0112 00270000
*/* P  DEQUEUE RB UNLESS LAST RB UNDER TCB                           */ 00271000
*                                                               02S0112 00272000
*   IF RBTCBNXT='0'B THEN           /* IF RB HAS MOTHER RB THEN      */ 00273000
         TM    RBTCBNXT(R5RB),B'10000000'                       02S0112 00274000
         BNZ   @RF00112                                         02S0112 00275000
*     TCBRBP=RBLINKB;               /* POINT TCB AT MOTHER RB        */ 00276000
         L     @12,RBLINKB-1(,R5RB)                             02S0113 00277000
         LA    @12,0(,@12)                                      02S0113 00278000
         ST    @12,TCBRBP(,R4TCB)                               02S0113 00279000
*   ELSE                            /* IF RB IS LAST RB THEN @ZA09499*/ 00280000
*     NEXT='1'B;                    /* SET SWITCH TO INDICATE SO        00281000
*                                                            @ZA09499*/ 00282000
         B     @RC00112                                         02S0114 00283000
@RF00112 OI    NEXT,B'10000000'                                 02S0114 00284000
*TESTRB:                            /* TESTING LABEL                 */ 00285000
*/* S SCBPURGE:  CALL SCB PURGE IF STAE ISSUED OR END OF TASK        */ 00286000
*                                                               02S0115 00287000
*   IF RBSCB='1'B                   /* IF RB HAS ISSUED STAE         */ 00288000
*       |RBTCBNXT='1'B THEN         /* OR HAS NO MOTHER THEN         */ 00289000
@RC00112 DS    0H                                               02S0115 00290000
TESTRB   LR    @12,R5RB                                         02S0115 00291000
         AL    @12,@CF02210                                     02S0115 00292000
         TM    RBSCB-56(@12),B'00000010'                        02S0115 00293000
         BO    @RT00115                                         02S0115 00294000
         TM    RBTCBNXT(R5RB),B'10000000'                       02S0115 00295000
         BNO   @RF00115                                         02S0115 00296000
@RT00115 DS    0H                                               02S0116 00297000
*     DO;                           /* CALL SCB PURGE                */ 00298000
*       R0=ADDR(RBSECT);            /* PASS RB ADDRESS               */ 00299000
         LR    R0,R5RB                                          02S0117 00300000
*       R1=0;                       /* INDICATE EXIT NOT XCTL        */ 00301000
         SLR   R1,R1                                            02S0118 00302000
*SCB1:                              /* TESTING LABEL                 */ 00303000
*       CALL SCBPURGE;              /* INVOKE STAE RTRM              */ 00304000
SCB1     L     @15,CVTSCBP(,R3CVT)                              02S0119 00305000
         BALR  @14,@15                                          02S0119 00306000
*SCB2:                              /* TESTING LABEL                 */ 00307000
*     END;                          /* SCB'S PURGED                  */ 00308000
SCB2     DS    0H                                               02S0121 00309000
*                                                               02S0121 00310000
*   /*****************************************************************/ 00311000
*   /*                                                               */ 00312000
*   /* THE SVRB CONTAINS REGISTERS 2-14 FROM TIME OF SVC INSTRUCTION */ 00313000
*   /* EXECUTION AND REGISTERS 15-1 FROM TIME OF SVC ROUTINE RETURN. */ 00314000
*   /*                                                               */ 00315000
*   /*****************************************************************/ 00316000
*                                                               02S0121 00317000
*/* D (YES,,NO,%DOSVRB)  SVRB EXITING                                */ 00318000
*                                                               02S0121 00319000
*   IF RBFTP='110'B THEN            /* IF SVRB EXITING THEN          */ 00320000
@RF00115 TM    RBFTP(R5RB),B'11000000'                          02S0121 00321000
         BNO   @RF00121                                         02S0121 00322000
         TM    RBFTP(R5RB),B'00100000'                          02S0121 00323000
         BNZ   @RF00121                                         02S0121 00324000
*DOSVRB:                                                        02S0122 00325000
*     DO;                           /* TERMINATE SVRB                */ 00326000
DOSVRB   DS    0H                                               02S0123 00327000
*       R14SAVE=CVTEXPRO;           /* SET NORMAL EXIT PROLOGUE ENTRY*/ 00328000
         L     @12,CVTEXPRO(,R3CVT)                             02S0123 00329000
         ST    @12,R14SAVE                                      02S0123 00330000
*/* N  USUAL PATH -- SVRB TERMINATION                                */ 00331000
*/* P  MOVE R2-R14 FROM SVRB TO TCB (R15-R1 DONE AT EXIT ENTRY)      */ 00332000
*                                                               02S0124 00333000
*       ADDR(TCBGRS2)->WORDS13=ADDR(RBGRS2)->WORDS13;/* MOVE 13 02S0124 00334000
*                                      REGISTERS                     */ 00335000
         MVC   WORDS13+56(52,R4TCB),WORDS13+40(R5RB)            02S0124 00336000
*TESTREG1:                          /* TESTING LABEL                 */ 00337000
*                                                               02S0125 00338000
*       /*************************************************************/ 00339000
*       /*                                                           */ 00340000
*       /* THE SVRB STORAGE SHOULD HAVE BEEN ALLOCATED       @Z40FPYK*/ 00341000
*       /* BY THE SVC FIRST LEVEL INTERRUPT HANDLER.         @Z40FPYK*/ 00342000
*       /*                                                           */ 00343000
*       /*************************************************************/ 00344000
*                                                               02S0125 00345000
*/* S MSS:  FREE SP255 OR CELL SVRB IF DYNAMIC                       */ 00346000
*/* D (YES,,NO,DOPRB) CAN SVRB BE FREED ?                            */ 00347000
*                                                               02S0125 00348000
*       IF RBFDYN='1'B              /* IF SVRB FREEABLE              */ 00349000
*           &RBTCBNXT='0'B THEN     /* AND SVRB HAS MOTHER RB THEN   */ 00350000
TESTREG1 TM    RBFDYN(R5RB),B'00000010'                         02S0125 00351000
         BNO   @RF00125                                         02S0125 00352000
         TM    RBTCBNXT(R5RB),B'10000000'                       02S0125 00353000
         BNZ   @RF00125                                         02S0125 00354000
*         DO;                       /* RETURN SVRB TO THE COMMON        00355000
*                                      MEMORY SVRB POOL      @Z40FPYK*/ 00356000
*/* D (YES,,NO,PGMGR) VALID SVRB ?                                   */ 00357000
*                                                               02S0127 00358000
*           RFY                                                 02S0127 00359000
*             MBCB BASED(MBCBPTR);                              02S0127 00360000
*           MBCBPTR=R5RB-LENGTH(MBCBMAIN)-ADDR(RBPRFLNA);/* START OF    00361000
*                                      THE SVRB BUFFER POOL  @Z40FPYK*/ 00362000
         LR    @12,R5RB                                         02S0128 00363000
         SL    @12,@CF00061                                     02S0128 00364000
         LA    @11,RBPRFLNA                                     02S0128 00365000
         SLR   @12,@11                                          02S0128 00366000
         ST    @12,MBCBPTR                                      02S0128 00367000
*/* P SET UP TO RETURN SVRB TO POOL                                  */ 00368000
*                                                               02S0129 00369000
*           IF RBNOCELL='1'B THEN                               02S0129 00370000
         TM    RBNOCELL(R5RB),B'10000000'                       02S0129 00371000
         BO    @RT00129                                         02S0129 00372000
*             GO TO PGMGR;          /*                        @M41810*/ 00373000
*           IF MBCBID=CHARSVRB THEN                             02S0131 00374000
         CLC   MBCBID(4,@12),CHARSVRB                           02S0131 00375000
         BNE   @RF00131                                         02S0131 00376000
*             DO;                   /* DETERMINE IF THIS IS A VALID     00377000
*                                      SVRB THAT IS BEING RETURNED TO   00378000
*                                      THE SVRB POOL. THIS IS   02S0132 00379000
*                                      DETERMINED BY A VERIFICATION     00380000
*                                      OF WHETHER THE MBCB IDENTIFIER   00381000
*                                      IS 'SVRB'. IF YES THEN THIS IS   00382000
*                                      INDEED AN SVRB WHICH BELONGS     00383000
*                                      TO THE COMMON SVRB MEMORY        00384000
*                                      POOL.                 @Z40FPYK*/ 00385000
*               R0=ASCBSVRB;        /* SET UP TO RETURN THE SVRB TO     00386000
*                                      THE COMMON MEMORY POOL   02S0133 00387000
*                                                            @Z40FPYK*/ 00388000
         L     R0,ASCBSVRB(,R7ASCB)                             02S0133 00389000
*               R1=ASCBSYNC;        /* SYNCHRONIZATION COUNTER TO       00390000
*                                      CONTROL MULTIPLE ACCESSES TO     00391000
*                                      THE ASCB SVRB POOL    @Z40FPYK*/ 00392000
         L     R1,ASCBSYNC(,R7ASCB)                             02S0134 00393000
*/*FREESVRB: P SET UP SVRB LINK FIELD FOR POOL                       */ 00394000
*                                                               02S0135 00395000
*FREESVRB:                                                      02S0135 00396000
*               MBCBLINK=ASCBSVRB;  /* UPDATE CURRENT LINK FIELD IN     00397000
*                                      THE SVRB BEING FREED. @Z40FPYK*/ 00398000
FREESVRB L     @12,ASCBSVRB(,R7ASCB)                            02S0135 00399000
         L     @11,MBCBPTR                                      02S0135 00400000
         ST    @12,MBCBLINK(,@11)                               02S0135 00401000
*/* P INCREMENT SYNCHRONOUS COUNTER                                  */ 00402000
*                                                               02S0136 00403000
*               RFY                                             02S0136 00404000
*                (R14,                                          02S0136 00405000
*                 R15) RSTD;        /* RESTRICT REGISTERS 14 AND 15     00406000
*                                                            @Z40FPYK*/ 00407000
*               R15=R1+1;           /* INCREMENT SYNCHRONOUS COUNT IN   00408000
*                                      ASCB                  @Z40FPYK*/ 00409000
         LA    R15,1                                            02S0137 00410000
         ALR   R15,R1                                           02S0137 00411000
*/* P SVRB BEING RETURNED TO POOL                                    */ 00412000
*                                                               02S0138 00413000
*               R14=MBCBPTR;        /* SVRB WHICH IS BEING RETURNED     00414000
*                                      TO POOL               @Z40FPYK*/ 00415000
         L     R14,MBCBPTR                                      02S0138 00416000
*/* P RETURN SVRB TO POOL                                            */ 00417000
*                                                               02S0139 00418000
*               CDS(R0,R14,ASCBSUPC);/* RETURN SVRB TO COMMON MEMORY    00419000
*                                      POOL                  @Z40FPYK*/ 00420000
         CDS   R0,R14,ASCBSUPC(R7ASCB)                          02S0139 00421000
*/* D (YES,FREESVRB,NO,) SVRB RETURNED ?                             */ 00422000
*                                                               02S0140 00423000
*               BC(7,FREESVRB);     /* WAS SVRB RETURNED TO POOL ?      00424000
*                                      NO--                  @Z40FPYK*/ 00425000
         BC    7,FREESVRB                                       02S0140 00426000
*/* P (,DOSVRB) SVRB RETURNED SUCCESSFULLY                           */ 00427000
*                                                               02S0141 00428000
*             END;                  /* YES, WE HAVE FINISHED @Z40FPYK*/ 00429000
*           ELSE                                                02S0142 00430000
*             DO;                   /* DETERMINE IF INVALID SVRB OR     00431000
*                                      PROGRAM MGR SVRB      @Z40FPYK*/ 00432000
         B     @RC00131                                         02S0142 00433000
@RF00131 DS    0H                                               02S0143 00434000
*/*PGMGR: D (YES,,NO,%ABEND) PROGRAM MGR SVRB ?                      */ 00435000
*                                                               02S0143 00436000
*PGMGR:                                                         02S0143 00437000
*               IF RBNOCELL='1'B THEN                           02S0143 00438000
PGMGR    TM    RBNOCELL(R5RB),B'10000000'                       02S0143 00439000
         BNO   @RF00143                                         02S0143 00440000
*                 DO;               /* PROGRAM MANAGER SVRB OR  02S0144 00441000
*                                      REQUEST TO FREE SVRB  @ZM41810*/ 00442000
*/* P SET UP TO FREEMAIN RB                                          */ 00443000
*                                                               02S0145 00444000
*                   R1=ADDR(RBPRFXST);/* POINT TO PREFIX WHICH MUST     00445000
*                                      BE FREED              @Z40FPYK*/ 00446000
         LR    R1,R5RB                                          02S0145 00447000
         AL    R1,@CF02211                                      02S0145 00448000
*                   R0=RBSIZE*8;    /* SIZE OF RB TO BE FREED   02S0146 00449000
*                                                            @Z40FPYK*/ 00450000
         LH    R0,RBSIZE(,R5RB)                                 02S0146 00451000
         SLA   R0,3                                             02S0146 00452000
*                   R10WORK=R3CVT;  /* SAVE REGISTER CLOBBERED BY       00453000
*                                      FREEMAIN              @Z40FPYK*/ 00454000
         LR    R10WORK,R3CVT                                    02S0147 00455000
*/* S (,DOPRB) FREEMAIN:GO FREE THE SVRB                             */ 00456000
*                                                               02S0148 00457000
*                   GEN(FREEMAIN RC,LV=(0),A=(1),SP=255,BRANCH=YES)     00458000
*                   REFS(R13AREA,R0,R1) SETS(R14,R15,R3CVT);/*  02S0148 00459000
*                                      FREEMAIN SVRB FROM SUBPOOL 255   00460000
*                                                            @Z40FPYK*/ 00461000
         FREEMAIN RC,LV=(0),A=(1),SP=255,BRANCH=YES                     00462000
*                   R3CVT=R10WORK;  /* RESTORE REGISTER CLOBBERED BY    00463000
*                                      FREEMAIN              @Z40FPYK*/ 00464000
         LR    R3CVT,R10WORK                                    02S0149 00465000
*                 END;                                          02S0150 00466000
*               ELSE                                            02S0151 00467000
*                 DO;                                           02S0151 00468000
*                                                               02S0151 00469000
         B     @RC00143                                         02S0151 00470000
@RF00143 DS    0H                                               02S0152 00471000
*/*%ABEND: P SET UP ABEND CONDITION = 4                              */ 00472000
*                                                               02S0152 00473000
*                   R15=ABENDCND;   /* ABEND CONDITION CODE = 4 02S0152 00474000
*                                                            @Z40FPYK*/ 00475000
         LA    R15,4                                            02S0152 00476000
*/* R X'0F9' ABEND                                                   */ 00477000
*                                                               02S0153 00478000
*                   GEN SETS(R0,R1) EXIT(ABEND X'0F9',DUMP,,SYSTEM);    00479000
         ABEND X'0F9',DUMP,,SYSTEM                                      00480000
*                                   /* ABEND CALLER WITH A X'0F9' R15   00481000
*                                      = 4 ABEND CODE        @Z40FPYK*/ 00482000
*                   RFY                                         02S0154 00483000
*                    (R14,                                      02S0154 00484000
*                     R15) UNRSTD;  /* UNRESTRICT REGS 14 AND 15        00485000
*                                                            @Z40FPYK*/ 00486000
*                 END;              /* END OF ABEND INVALID SVRB        00487000
*                                      FUNCTION              @Z40FPYK*/ 00488000
*             END;                  /* END OF FREE VALID SVRB   02S0156 00489000
*                                      FUNCTION              @Z40FPYK*/ 00490000
*         END;                      /* END OF ALL SVRB FUNCTIONS        00491000
*                                                            @Z40FPYK*/ 00492000
*/* P MARK SVRB INACTIVE IF NOT DYNAMIC                              */ 00493000
*                                                               02S0158 00494000
*       ELSE                        /* IF SVRB NOT FREEABLE  @ZA09499*/ 00495000
*         RBFACTV='0'B;             /* INDICATE SVRB COMPLETE   02S0158 00496000
*                                                            @ZA09499*/ 00497000
         B     @RC00125                                         02S0158 00498000
@RF00125 NI    RBFACTV(R5RB),B'10111111'                        02S0158 00499000
*     END;                          /* END OF TERMINATE SVRB    02S0159 00500000
*                                      FUNCTIONS             @Z40FPYK*/ 00501000
*                                                               02S0160 00502000
*   /*****************************************************************/ 00503000
*   /*                                                               */ 00504000
*   /* EXIT TERMINATES A PROGRAM REQUEST BY FREEING PROGRAM AND      */ 00505000
*   /* REQUEST BLOCKS.                                               */ 00506000
*   /*                                                               */ 00507000
*   /*****************************************************************/ 00508000
*                                                               02S0160 00509000
*/*DOPRB:    D (YES,,NO,%DOPRB)  PRB EXITING ?                       */ 00510000
*                                                               02S0160 00511000
*   ELSE                                                        02S0160 00512000
*     IF RBFTP='000'B THEN          /* OTHERWISE IF PRB EXITING THEN */ 00513000
         B     @RC00121                                         02S0160 00514000
@RF00121 TM    RBFTP(R5RB),B'11100000'                          02S0160 00515000
         BNZ   @RF00160                                         02S0160 00516000
*DOPRB:                                                         02S0161 00517000
*       DO;                         /* TERMINATE PRB                 */ 00518000
DOPRB    DS    0H                                               02S0162 00519000
*/* P RESTORE REGS 2-14 OF SYNCH PRB                                 */ 00520000
*                                                               02S0162 00521000
*         IF RBCDSYNC='1'B&         /* RESTORE REGS 2-14 OF SYNCH    */ 00522000
*             RBCDSAVE='1'B THEN    /* USER IF REQUIRED              */ 00523000
         TM    RBCDSYNC(R5RB),B'00010100'                       02S0162 00524000
         BNO   @RF00162                                         02S0162 00525000
*           DO;                                                 02S0163 00526000
*             ADDR(TCBGRS2)->WORDS13=ADDR(RBGRS2)->WORDS13;     02S0164 00527000
         MVC   WORDS13+56(52,R4TCB),WORDS13+40(R5RB)            02S0164 00528000
*           END;                                                02S0165 00529000
*                                                               02S0165 00530000
*/* S CDEXIT:  FREE PROGRAMS                                         */ 00531000
*                                                               02S0166 00532000
*CDEXIT1:                           /* TESTING LABEL                 */ 00533000
*         CALL IEAPPGMX;            /* CALL PROGRAM MANAGEMENT RTRM  */ 00534000
@RF00162 DS    0H                                               02S0166 00535000
CDEXIT1  L     @15,@CV02075                                     02S0166 00536000
         BALR  @14,@15                                          02S0166 00537000
*CDEXIT2:                           /* TESTING LABEL                 */ 00538000
*/* S MSS:  FREE SP255 PRB IF DYNAMIC                                */ 00539000
*                                                               02S0167 00540000
*         IF RBFDYN='1'B            /* IF PRB DYNAMIC                */ 00541000
*             &RBTCBNXT='0'B THEN   /* AND PRB HAS MOTHER RB THEN       00542000
*                                                            @YM01975*/ 00543000
CDEXIT2  TM    RBFDYN(R5RB),B'00000010'                         02S0167 00544000
         BNO   @RF00167                                         02S0167 00545000
         TM    RBTCBNXT(R5RB),B'10000000'                       02S0167 00546000
         BNZ   @RF00167                                         02S0167 00547000
*           DO;                     /* FREEMAIN RB                   */ 00548000
*             R0=RBSIZE*8;          /* PASS RB BYTE SIZE INCLUDING      00549000
*                                      THAT OF PARTIAL PREFIX        */ 00550000
         LH    R0,RBSIZE(,R5RB)                                 02S0169 00551000
         SLA   R0,3                                             02S0169 00552000
*             R1=ADDR(RBPRFXST);    /* PASS ADDRESS OF GOTTEN PARTIAL   00553000
*                                      PREFIX                        */ 00554000
         LR    R1,R5RB                                          02S0170 00555000
         AL    R1,@CF02211                                      02S0170 00556000
*             R10WORK=R3CVT;        /* SAVE REGISTER CLOBBERED BY       00557000
*                                      FREEMAIN                      */ 00558000
         LR    R10WORK,R3CVT                                    02S0171 00559000
*MAINP1:                            /* TESTING LABEL                 */ 00560000
*             GEN(FREEMAIN RC,LV=(0),A=(1),SP=255,BRANCH=YES)   02S0172 00561000
*             REFS(R13AREA,R0,R1) SETS(R14,R15,R3CVT);/* FREEMAIN RB    00562000
*                                      FROM SUBPOOL 255              */ 00563000
MAINP1   FREEMAIN RC,LV=(0),A=(1),SP=255,BRANCH=YES                     00564000
*MAINP2:                            /* TESTING LABEL                 */ 00565000
*             R3CVT=R10WORK;        /* RESTORE REGISTER CLOBBERED BY    00566000
*                                      FREEMAIN                      */ 00567000
MAINP2   LR    R3CVT,R10WORK                                    02S0173 00568000
*           END;                    /* RB STORAGE FREED IF DYNAMIC   */ 00569000
*/* P MARK PRB INACTIVE IF NOT DYNAMIC                               */ 00570000
*                                                               02S0175 00571000
*         ELSE                      /* IF PRB WAS NOT FREED  @ZA09499*/ 00572000
*           RBFACTV='0'B;           /* INDICATE PRB COMPLETE @ZA09499*/ 00573000
         B     @RC00167                                         02S0175 00574000
@RF00167 NI    RBFACTV(R5RB),B'10111111'                        02S0175 00575000
*/* N (,%DORB)  PRB TERMINATED                                       */ 00576000
*                                                               02S0176 00577000
*TESTPRB:                                                       02S0176 00578000
*         GEN(DS 0H);               /* TESTING LABEL                 */ 00579000
@RC00167 DS    0H                                               02S0176 00580000
TESTPRB  DS 0H                                                          00581000
*       END DOPRB;                  /* PRB TERMINATED                */ 00582000
*                                                               02S0178 00583000
*   /*****************************************************************/ 00584000
*   /*                                                               */ 00585000
*   /* ATTENTION EXIT EPILOG PERFORMS SPECIAL PROCESSING FOR         */ 00586000
*   /* ATTENTION IRB TERMINATION. IRB CONTAINS REGISTERS FROM TASK   */ 00587000
*   /* INTERRUPTED AT TIME OF IRB SCHEDULING BY STAGE 3 EXIT         */ 00588000
*   /* EFFECTOR.                                                     */ 00589000
*   /*                                                               */ 00590000
*   /*****************************************************************/ 00591000
*                                                               02S0178 00592000
*/* %DOPRB: D (YES,,NO,%DOIRB)  IRB EXITING                          */ 00593000
*                                                               02S0178 00594000
*     ELSE                                                      02S0178 00595000
*       IF RBFTP='010'B THEN        /* OTHERWISE IF IRB EXITING THEN */ 00596000
         B     @RC00160                                         02S0178 00597000
@RF00160 TM    RBFTP(R5RB),B'01000000'                          02S0178 00598000
         BNO   @RF00178                                         02S0178 00599000
         TM    RBFTP(R5RB),B'10100000'                          02S0178 00600000
         BNZ   @RF00178                                         02S0178 00601000
*DOIRB:                                                         02S0179 00602000
*         DO;                       /* TERMINATE IRB                 */ 00603000
DOIRB    DS    0H                                               02S0180 00604000
*/* S ATTNEPLG:  CALL ATTENTION EXIT EPILOG IF ATTN IRB              */ 00605000
*                                                               02S0180 00606000
*           IF RBATNXIT='1'B THEN   /* IF ATTN EXIT IRB THEN         */ 00607000
         TM    RBATNXIT(R5RB),B'00000010'                       02S0180 00608000
         BNO   @RF00180                                         02S0180 00609000
*ATTN1:                             /* TESTING LABEL                 */ 00610000
*             CALL ATTNEPLG;        /* CALL ATTN EXIT RTRM           */ 00611000
ATTN1    L     @15,CVTSTXU(,R3CVT)                              02S0181 00612000
         BALR  @14,@15                                          02S0181 00613000
*ATTN2:                             /* TESTING LABEL                 */ 00614000
*/* P  MOVE R0-R15 FROM IRB TO TCB                                   */ 00615000
*                                                               02S0182 00616000
*           TCBGRS=RBGRSAVE;        /* MOVE 16 REGISTERS             */ 00617000
@RF00180 DS    0H                                               02S0182 00618000
ATTN2    MVC   TCBGRS(64,R4TCB),RBGRSAVE(R5RB)                  02S0182 00619000
*TESTREG2:                          /* TESTING LABEL                 */ 00620000
*                                                               02S0183 00621000
*           /*********************************************************/ 00622000
*           /*                                                       */ 00623000
*           /* EITHER AN IQE OR AN RQE MAY HAVE SCHEDULED AN IRB.    */ 00624000
*           /*                                                       */ 00625000
*           /*********************************************************/ 00626000
*                                                               02S0183 00627000
*                                                               02S0183 00628000
*           /*********************************************************/ 00629000
*           /*                                                       */ 00630000
*           /* TO TERMINATE AN RQE EXIT RETURNS IT TO IOS.           */ 00631000
*           /*                                                       */ 00632000
*           /*********************************************************/ 00633000
*                                                               02S0183 00634000
*/* D (YES,,NO,%DORQE)  QUEUE ELEMENT RQE                            */ 00635000
*/* S (,%DOQE) IOS:  RETURN RQE IF NOT NULL BUT RETURNABLE           */ 00636000
*                                                               02S0183 00637000
*           IF RBIQE1Â¬=0            /* IF QE NOT NULL                */ 00638000
*               &RBIQETP='01'B THEN /* AND QE RETURNABLE RQE THEN    */ 00639000
TESTREG2 L     @12,RBIQE1-1(,R5RB)                              02S0183 00640000
         LA    @12,0(,@12)                                      02S0183 00641000
         LTR   @12,@12                                          02S0183 00642000
         BZ    @RF00183                                         02S0183 00643000
         TM    RBIQETP(R5RB),B'00000100'                        02S0183 00644000
         BNO   @RF00183                                         02S0183 00645000
         TM    RBIQETP(R5RB),B'00001000'                        02S0183 00646000
         BNZ   @RF00183                                         02S0183 00647000
*DORQE:                                                         02S0184 00648000
*             DO;                   /* RETURN RQE TO IOS             */ 00649000
DORQE    DS    0H                                               02S0185 00650000
*               R1=ADDR(IQESECT);   /* PASS RQE ADDRESS              */ 00651000
         L     R1,RBIQE1-1(,R5RB)                               02S0185 00652000
         LA    R1,0(,R1)                                        02S0185 00653000
*IOS1:                              /* TESTING LABEL                 */ 00654000
*               CALL IECVX025;      /* CALL IOS                      */ 00655000
IOS1     L     @15,@CV02098                                     02S0186 00656000
         BALR  @14,@15                                          02S0186 00657000
*IOS2:                              /* TESTING LABEL                 */ 00658000
*               RBIQE1=0;           /* INDICATE RQE TERMINATED       */ 00659000
IOS2     SLR   @12,@12                                          02S0187 00660000
         STCM  @12,7,RBIQE1(R5RB)                               02S0187 00661000
*TESTRQE:                                                       02S0188 00662000
*               GEN(DS 0H);         /* TESTING LABEL                 */ 00663000
TESTRQE  DS 0H                                                          00664000
*             END DORQE;            /* RQE TERMINATED                */ 00665000
*                                                               02S0190 00666000
*           /*********************************************************/ 00667000
*           /*                                                       */ 00668000
*           /* EXIT TERMINATES RETURNABLE AND ETXR IQE'S.            */ 00669000
*           /*                                                       */ 00670000
*           /*********************************************************/ 00671000
*                                                               02S0190 00672000
*/* %DORQE: D (YES,,NO,%DOQE)  IQE RETURNABLE OR ETXR                */ 00673000
*                                                               02S0190 00674000
*           ELSE                                                02S0190 00675000
*             IF RBIQETP='11'B      /* IF QE RETURNABLE IQE          */ 00676000
*                 |RBETXR='1'B THEN /* OR IRB ETXR THEN              */ 00677000
         B     @RC00183                                         02S0190 00678000
@RF00183 TM    RBIQETP(R5RB),B'00001100'                        02S0190 00679000
         BO    @RT00190                                         02S0190 00680000
         TM    RBETXR(R5RB),B'00010000'                         02S0190 00681000
         BNO   @RF00190                                         02S0190 00682000
@RT00190 DS    0H                                               02S0191 00683000
*DOIQE:                                                         02S0191 00684000
*               DO;                 /* TERMINATE IQE                 */ 00685000
*                                                               02S0191 00686000
DOIQE    DS    0H                                               02S0192 00687000
*                 /***************************************************/ 00688000
*                 /*                                                 */ 00689000
*                 /* AN ETXR IRB CONTAINS A COUNT OF THE NUMBER OF   */ 00690000
*                 /* DAUGHTER TASKS ON BEHALF OF WHICH IT WILL RUN. A*/ 00691000
*                 /* NON-ETXR IRB SHOULD CONTAIN A ZERO COUNT. EXIT  */ 00692000
*                 /* PERFORMS FINAL TERMINATION OF AN IRB WHEN IT    */ 00693000
*                 /* CONTAINS A ZERO COUNT.                          */ 00694000
*                 /*                                                 */ 00695000
*                 /***************************************************/ 00696000
*                                                               02S0192 00697000
*/* P  DECREMENT RB USE COUNT IF NONZERO                             */ 00698000
*                                                               02S0192 00699000
*                 IF RBUSE>0 THEN   /* IF ETXR IRB THEN              */ 00700000
         CLI   RBUSE(R5RB),0                                    02S0192 00701000
         BNH   @RF00192                                         02S0192 00702000
*TESTUSE:                           /* TESTING LABEL                 */ 00703000
*                   RBUSE=RBUSE-1;  /* DECREMENT NUMBER OF      02S0193 00704000
*                                      UNTERMINATED ETXR EXECUTIONS  */ 00705000
TESTUSE  SLR   @12,@12                                          02S0193 00706000
         IC    @12,RBUSE(,R5RB)                                 02S0193 00707000
         BCTR  @12,0                                            02S0193 00708000
         STC   @12,RBUSE(,R5RB)                                 02S0193 00709000
*                                                               02S0194 00710000
*                 /***************************************************/ 00711000
*                 /*                                                 */ 00712000
*                 /* EXIT TERMINATES AN IQE IF IT CONTAINS A WORK    */ 00713000
*                 /* AREA XOR SCHEDULES AN END-OF-TASK EXIT ROUTINE. */ 00714000
*                 /*                                                 */ 00715000
*                 /***************************************************/ 00716000
*                                                               02S0194 00717000
*/* D (YES,,NO,%DOWA)  IRB HAS WORK AREA                             */ 00718000
*                                                               02S0194 00719000
*                 IF RBSIZE*8>ADDR(RBIQEWRK)-ADDR(RBPRFXST) THEN/* IF   00720000
*                                      IRB CONTAINS WORKAREA THEN    */ 00721000
@RF00192 LH    @12,RBSIZE(,R5RB)                                02S0194 00722000
         SLA   @12,3                                            02S0194 00723000
         LA    @11,RBIQEWRK(,R5RB)                              02S0194 00724000
         LR    @02,R5RB                                         02S0194 00725000
         AL    @02,@CF02211                                     02S0194 00726000
         SLR   @11,@02                                          02S0194 00727000
         CR    @12,@11                                          02S0194 00728000
         BNH   @RF00194                                         02S0194 00729000
*DOWA:                                                          02S0195 00730000
*                   DO;             /* RETURN IQE TO NEXT-AVAILABLE     00731000
*                                      QUEUE                         */ 00732000
DOWA     DS    0H                                               02S0196 00733000
*                     IQELNKA=RBNEXAV;/* PLACE OLD NEXT-AVAILABLE       00734000
*                                      QUEUE ON IQE                  */ 00735000
         L     @12,RBIQE1-1(,R5RB)                              02S0196 00736000
         LA    @12,0(,@12)                                      02S0196 00737000
         MVC   IQELNKA(3,@12),RBNEXAV+1(R5RB)                   02S0196 00738000
*                     RBNEXAV=RBIQE1;/* PLACE NEW NEXT-AVAILABLE        00739000
*                                      QUEUE ON IRB                  */ 00740000
         ST    @12,RBNEXAV(,R5RB)                               02S0197 00741000
*                     RBIQE1=0;     /* INDICATE IQE TERMINATED       */ 00742000
         SLR   @12,@12                                          02S0198 00743000
         STCM  @12,7,RBIQE1(R5RB)                               02S0198 00744000
*TESTNAQ:                                                       02S0199 00745000
*                     GEN(DS 0H);   /* TESTING LABEL                 */ 00746000
TESTNAQ  DS 0H                                                          00747000
*/* P (,%DOQE)  RETURN IQE TO NEXT-AVAILABLE QUEUE                   */ 00748000
*                                                               02S0200 00749000
*                   END DOWA;       /* IQE RETURNED TO NAQ           */ 00750000
*/* %DOWA: D (YES,,NO,%DOQE)  IRB FOR EOT EXIT ROUTINE               */ 00751000
*                                                               02S0201 00752000
*                 ELSE              /* OTHERWISE NO WA SO            */ 00753000
*                   IF RBETXR='1'B THEN/* IF ETXR IRB THEN           */ 00754000
         B     @RC00194                                         02S0201 00755000
@RF00194 TM    RBETXR(R5RB),B'00010000'                         02S0201 00756000
         BNO   @RF00201                                         02S0201 00757000
*DOETXR:                                                        02S0202 00758000
*                     DO;           /* FREEMAIN IQE                  */ 00759000
DOETXR   DS    0H                                               02S0203 00760000
*                       R0=LENGTH(IQESECT);/* PASS LENGTH OF IQE     */ 00761000
         LA    R0,24                                            02S0203 00762000
*                       R1=ADDR(IQESECT);/* PASS IQE ADDRESS         */ 00763000
         L     R1,RBIQE1-1(,R5RB)                               02S0204 00764000
         LA    R1,0(,R1)                                        02S0204 00765000
*MAINIQE1:                          /* TESTING LABEL                 */ 00766000
*                       GEN(FREEMAIN RC,LV=(0),A=(1),SP=253,BRANCH=YES) 00767000
*                       REFS(CVTCRMN);/* FREEMAIN IQE                */ 00768000
MAINIQE1 FREEMAIN RC,LV=(0),A=(1),SP=253,BRANCH=YES                     00769000
*MAINIQE2:                          /* TESTING LABEL                 */ 00770000
*                       RBIQE1=0;   /* INDICATE IQE TERMINATED       */ 00771000
MAINIQE2 SLR   @12,@12                                          02S0206 00772000
         STCM  @12,7,RBIQE1(R5RB)                               02S0206 00773000
*TESTETXR:                                                      02S0207 00774000
*                       GEN(DS 0H); /* TESTING LABEL                 */ 00775000
TESTETXR DS 0H                                                          00776000
*/* S (,%DOQE) MSS:  FREE SP253 IQE                                  */ 00777000
*                                                               02S0208 00778000
*                     END DOETXR;   /* IQE FREEMAINED                */ 00779000
*TESTIQE:                           /* TESTING LABEL                 */ 00780000
*               END DOIQE;          /* IQE TERMINATED                */ 00781000
@RF00201 DS    0H                                               02S0209 00782000
@RC00194 DS    0H                                               02S0209 00783000
TESTIQE  DS    0H                                               02S0210 00784000
*                                                               02S0210 00785000
*           /*********************************************************/ 00786000
*           /*                                                       */ 00787000
*           /* AN IRB MAY ADDRESS A PROBLEM-PROGRAM SAVE-AREA        */ 00788000
*           /* RESIDING IN SUBPOOL 250 (0).                          */ 00789000
*           /*                                                       */ 00790000
*           /*********************************************************/ 00791000
*                                                               02S0210 00792000
*/* %DOQE: S MSS:  FREE SP250 PPSA IF PRESENT AND IRB ENDING         */ 00793000
*                                                               02S0210 00794000
*           IF RBPPSAV1>0           /* IF IRB HAS PROBLEM PROGRAM       00795000
*                                      SAVEAREA                      */ 00796000
*               &RBFDYN='1'B        /* AND IRB/PPSA STORAGE FREEABLE */ 00797000
*               &RBUSE=0 THEN       /* AND RB USE COUNT ZERO THEN    */ 00798000
@RF00190 DS    0H                                               02S0210 00799000
@RC00183 L     @12,RBPPSAV1-1(,R5RB)                            02S0210 00800000
         LA    @12,0(,@12)                                      02S0210 00801000
         LTR   @12,@12                                          02S0210 00802000
         BNP   @RF00210                                         02S0210 00803000
         TM    RBFDYN(R5RB),B'00000010'                         02S0210 00804000
         BNO   @RF00210                                         02S0210 00805000
         CLI   RBUSE(R5RB),0                                    02S0210 00806000
         BNE   @RF00210                                         02S0210 00807000
*             DO;                   /* FREEMAIN PPSA                 */ 00808000
*               R1=RBPPSAV1;        /* PASS ADDRESS OF PPSA          */ 00809000
         LR    R1,@12                                           02S0212 00810000
*               R0=72;              /* PASS LENGTH OF PPSA           */ 00811000
         LA    R0,72                                            02S0213 00812000
*               R10WORK=R3CVT;      /* SAVE REGISTER CLOBBERED BY       00813000
*                                      FREEMAIN                      */ 00814000
         LR    R10WORK,R3CVT                                    02S0214 00815000
*MAINSA1:                           /* TESTING LABEL                 */ 00816000
*               GEN(FREEMAIN RC,LV=(0),A=(1),SP=250,BRANCH=YES) 02S0215 00817000
*               REFS(CVTCRMN,R13AREA,R0,R1) SETS(R14,R15,R3CVT);/*      00818000
*                                      FREEMAIN PPSA FROM SUBPOOL 250*/ 00819000
MAINSA1  FREEMAIN RC,LV=(0),A=(1),SP=250,BRANCH=YES                     00820000
*MAINSA2:                           /* TESTING LABEL                 */ 00821000
*               R3CVT=R10WORK;      /* RESTORE REGISTER CLOBBERED BY    00822000
*                                      FREEMAIN                      */ 00823000
MAINSA2  LR    R3CVT,R10WORK                                    02S0216 00824000
*             END;                  /* PPSA STORAGE FREED IF PRESENT */ 00825000
*                                                               02S0218 00826000
*           /*********************************************************/ 00827000
*           /*                                                       */ 00828000
*           /* AN IRB RESIDES IN SUBPOOL 253.                        */ 00829000
*           /*                                                       */ 00830000
*           /*********************************************************/ 00831000
*                                                               02S0218 00832000
*/* S MSS:  FREE SP253 IRB IF DYNAMIC AND USE COUNT ZERO             */ 00833000
*                                                               02S0218 00834000
*           IF RBFDYN='1'B          /* IF RB STORAGE FREEABLE        */ 00835000
*               &RBUSE=0 THEN       /* AND RB USE COUNT ZERO THEN    */ 00836000
@RF00210 TM    RBFDYN(R5RB),B'00000010'                         02S0218 00837000
         BNO   @RF00218                                         02S0218 00838000
         CLI   RBUSE(R5RB),0                                    02S0218 00839000
         BNE   @RF00218                                         02S0218 00840000
*             DO;                   /* FREEMAIN RB                   */ 00841000
*               R0=RBSIZE*8;        /* PASS RB BYTE SIZE INCLUDING      00842000
*                                      THAT OF PARTIAL PREFIX AND       00843000
*                                      POSSIBLE WORKAREA             */ 00844000
         LH    R0,RBSIZE(,R5RB)                                 02S0220 00845000
         SLA   R0,3                                             02S0220 00846000
*               R1=ADDR(RBPRFXST);  /* PASS ADDRESS OF RB PARTIAL       00847000
*                                      PREFIX                        */ 00848000
         LR    R1,R5RB                                          02S0221 00849000
         AL    R1,@CF02211                                      02S0221 00850000
*               R10WORK=R3CVT;      /* SAVE REGISTER CLOBBERED BY       00851000
*                                      FREEMAIN                      */ 00852000
         LR    R10WORK,R3CVT                                    02S0222 00853000
*MAINI1:                            /* TESTING LABEL                 */ 00854000
*               GEN(FREEMAIN RC,LV=(0),A=(1),SP=253,BRANCH=YES) 02S0223 00855000
*               REFS(CVTCRMN,R13AREA,R14,R15,R0,R1) SETS(R14,R15,R3CVT) 00856000
*                   ;               /* FREEMAIN IRB FROM SUBPOOL 253 */ 00857000
MAINI1   FREEMAIN RC,LV=(0),A=(1),SP=253,BRANCH=YES                     00858000
*MAINI2:                            /* TESTING LABEL                 */ 00859000
*               R3CVT=R10WORK;      /* RESTORE REGISTER CLOBBERED BY    00860000
*                                      FREEMAIN                      */ 00861000
MAINI2   LR    R3CVT,R10WORK                                    02S0224 00862000
*             END;                  /* IRB STORAGE FREED IF DYNAMIC  */ 00863000
*/* P MARK IRB INACTIVE IF NOT DYNAMIC OR USE COUNT NOT ZERO         */ 00864000
*                                                               02S0226 00865000
*           ELSE                    /* IF IRB NOT FREED      @ZA09499*/ 00866000
*             RBFACTV='0'B;         /* INDICATE IRB COMPLETE @ZA09499*/ 00867000
         B     @RC00218                                         02S0226 00868000
@RF00218 NI    RBFACTV(R5RB),B'10111111'                        02S0226 00869000
*/* N (,%DORB)  IRB TERMINATED                                       */ 00870000
*                                                               02S0227 00871000
*         END DOIRB;                /* IRB TERMINATED                */ 00872000
*                                                               02S0228 00873000
*   /*****************************************************************/ 00874000
*   /*                                                               */ 00875000
*   /* AN SIRB CONTAINS THE TASK REGISTERS FROM TIME OF SIRB         */ 00876000
*   /* SCHEDULING BY STAGE 3 EXIT EFFECTOR.                          */ 00877000
*   /*                                                               */ 00878000
*   /*****************************************************************/ 00879000
*                                                               02S0228 00880000
*/* %DOIRB: N  OTHERWISE SIRB EXITING                                */ 00881000
*                                                               02S0228 00882000
*       ELSE                        /* OTHERWISE SIRB EXITING SO     */ 00883000
*DOSIRB:                                                        02S0228 00884000
*         DO;                       /* TERMINATE SIRB                */ 00885000
         B     @RC00178                                         02S0228 00886000
@RF00178 DS    0H                                               02S0228 00887000
DOSIRB   DS    0H                                               02S0229 00888000
*/* P  MOVE R0-R15 FROM SIRB TO TCB                                  */ 00889000
*                                                               02S0229 00890000
*           TCBGRS=RBGRSAVE;        /* MOVE 16 REGISTERS             */ 00891000
         MVC   TCBGRS(64,R4TCB),RBGRSAVE(R5RB)                  02S0229 00892000
*TESTSIRB:                          /* TESTING LABEL                 */ 00893000
*/* P MARK SIRB INACTIVE                                             */ 00894000
*                                                               02S0230 00895000
*           RBFACTV='0'B;           /* INDICATE SIRB COMPLETE   02S0230 00896000
*                                                            @ZA09499*/ 00897000
TESTSIRB NI    RBFACTV(R5RB),B'10111111'                        02S0230 00898000
*/* N  SIRB TERMINATED                                               */ 00899000
*                                                               02S0231 00900000
*         END DOSIRB;               /* SIRB TERMINATED               */ 00901000
*/* %DORB: R  RB TERMINATED                                          */ 00902000
*/* SVC3RB: END                                                      */ 00903000
*                                                               02S0232 00904000
*   ;                                                           01S0232 00905000
*                                                               01S0232 00906000
@RC00178 DS    0H                                               01S0232 00907000
@RC00160 DS    0H                                               01S0232 00908000
@RC00121 DS    0H                                               01S0233 00909000
*   /*****************************************************************/ 00910000
*   /*                                                               */ 00911000
*   /* AFTER TERMINATING THE LAST RB UNDER A TCB EXIT PERFORMS THAT  */ 00912000
*   /* FINAL EOT CLEANUP WHICH SVC 13 COULD NOT PERFORM.             */ 00913000
*   /*                                                               */ 00914000
*   /*****************************************************************/ 00915000
*                                                               01S0233 00916000
*/* D (YES,DODETACH,NO,)  LAST RB EXITING AND SVC 13 EXECUTED        */ 00917000
*                                                               01S0233 00918000
*   IF NEXT='1'B                    /* IF TCB HAS ONLY TERMINAITNG RB*/ 00919000
*       &TCBEOT='1'B THEN           /* AND TASK TERMINATION HAS 01S0233 00920000
*                                      EXECUTED THEN                 */ 00921000
         TM    NEXT,B'10000000'                                 01S0233 00922000
         BNO   @RF00233                                         01S0233 00923000
         TM    TCBEOT(R4TCB),B'00000100'                        01S0233 00924000
         BO    @RT00233                                         01S0233 00925000
*     GO TO DODETACH;               /* BRANCH TO EOT CLEANUP         */ 00926000
*                                                               01S0234 00927000
*   /*****************************************************************/ 00928000
*   /*                                                               */ 00929000
*   /* EXIT RETURNS NORMALLY AFTER TERMINATING AN RB.                */ 00930000
*   /*                                                               */ 00931000
*   /*****************************************************************/ 00932000
*                                                               01S0235 00933000
*/* N  USUAL PATH -- RB TERMINATION WITHOUT TASK TERMINATION         */ 00934000
*/* R  RETURN TO EXIT PROLOGUE WITH TCB R15-R1                       */ 00935000
*                                                               01S0235 00936000
*   RFY                                                         01S0235 00937000
*     R15 RSTD;                     /* PASS R15 TO EXIT PROLOG       */ 00938000
@RF00233 DS    0H                                               01S0236 00939000
*   R15=TCBGRS15;                   /* PRESERVE TCB R15 OVER PROLOG  */ 00940000
         L     R15,TCBGRS15(,R4TCB)                             01S0236 00941000
*   R0=TCBGRS0;                     /* PRESERVE TCB R0 OVER PROLOG   */ 00942000
         L     R0,TCBGRS0(,R4TCB)                               01S0237 00943000
*   R1=TCBGRS1;                     /* PRESERVE TCB R1 OVER PROLOG   */ 00944000
         L     R1,TCBGRS1(,R4TCB)                               01S0238 00945000
*PROLOG1:                           /* TESTING LABEL                 */ 00946000
*   GO TO PROLOGUE;                 /* CLEAN UP AND EXIT TO     01S0239 00947000
*                                      DISPATCHER                    */ 00948000
PROLOG1  L     @14,R14SAVE                                      01S0239 00949000
         BR    @14                                              01S0239 00950000
*   RFY                                                         01S0240 00951000
*     R15 UNRSTD;                   /* RELEASE R15 PASSED TO EXIT       00952000
*                                      PROLOGUE FOR CALLS            */ 00953000
*                                                               01S0241 00954000
*   /*****************************************************************/ 00955000
*   /*                                                               */ 00956000
*   /* TO TERMINATE A SPIE EXIT EXIT MAKES THE EXIT REUSABLE AND SETS*/ 00957000
*   /* UP A RETRY WITH PARAMETER REGISTERS. FOR INTEGRITY EXIT       */ 00958000
*   /* ACCESSES SP0 PIE UNDER USER KEY.                              */ 00959000
*   /*                                                               */ 00960000
*   /*****************************************************************/ 00961000
*                                                               01S0241 00962000
*/* DOSPIE: N  SPIE EXIT TERMINATION                                 */ 00963000
*                                                               01S0241 00964000
*DOSPIE:                            /* TERMINATE SPIE EXIT RATHER       00965000
*                                      THAN RB                       */ 00966000
*/* S MODESET:  SET PSW KEY TO THAT OF PIE                           */ 00967000
*                                                               01S0241 00968000
*   RFY                                                         01S0241 00969000
*     R2 RSTD;                      /* PRESERVE EXIT KEY ACROSS 01S0241 00970000
*                                      MODESET                       */ 00971000
DOSPIE   DS    0H                                               01S0242 00972000
*   R2=TCBPKF;                      /* OBTAIN TASK PROTECTION KEY    */ 00973000
         SLR   R2,R2                                            01S0242 00974000
         IC    R2,TCBPKF(,R4TCB)                                01S0242 00975000
*MODESET1:                          /* TESTING LABEL                 */ 00976000
*   GEN(MODESET KEYADDR=(2))                                    01S0243 00977000
*   REFS(R2);                       /* OBTAIN TASK KEY TO PRESERVE      00978000
*                                      INTEGRITY                     */ 00979000
MODESET1 MODESET KEYADDR=(2)                                            00980000
*MODESET2:                          /* TESTING LABEL                 */ 00981000
*/* P  INDICATE SPIE EXIT REINVOCABLE                                */ 00982000
*                                                               01S0244 00983000
*   PIENOPI='0'B;                   /* MARK SPIE EXIT NONBUSY        */ 00984000
MODESET2 L     @12,TCBPIE(,R4TCB)                               01S0244 00985000
         L     @12,SCAPIE(,@12)                                 01S0244 00986000
         NI    PIENOPI(@12),B'01111111'                         01S0244 00987000
*/* S MODESET:  SET PSW KEY TO THAT OF SUPERVISOR                    */ 00988000
*                                                               01S0245 00989000
*MODESET3:                          /* TESTING LABEL                 */ 00990000
*   GEN(MODESET EXTKEY=SUPR);       /* OBTAIN EXIT KEY TO CONTINUE      00991000
*                                      SUPERVISOR PROCESSING         */ 00992000
MODESET3 MODESET EXTKEY=SUPR                                            00993000
*   RFY                                                         01S0246 00994000
*     R2 UNRSTD;                    /* RELEASE REGISTER FOR     01S0246 00995000
*                                      OPTIMIZATION                  */ 00996000
*MODESET4:                          /* TESTING LABEL                 */ 00997000
*                                                               01S0247 00998000
*   /*****************************************************************/ 00999000
*   /*                                                               */ 01000000
*   /* (SPIE PROCESSING CONCLUDED.)                                  */ 01001000
*   /*                                                               */ 01002000
*   /*****************************************************************/ 01003000
*                                                               01S0247 01004000
*/* P  MOVE R14-R2 FROM PIE TO TCB                                   */ 01005000
*                                                               01S0247 01006000
*   ADDR(TCBGRS14)->WORDS2=ADDR(PIEGR14)->WORDS2;/* MOVE R14-R15 FROM   01007000
*                                      PIE TO TCB                    */ 01008000
MODESET4 L     @12,TCBPIE(,R4TCB)                               01S0247 01009000
         L     @12,SCAPIE(,@12)                                 01S0247 01010000
         MVC   WORDS2+104(8,R4TCB),WORDS2+12(@12)               01S0247 01011000
*   ADDR(TCBGRS0)->WORDS3=ADDR(PIEGR0)->WORDS3;/* MOVE R0-R2 FROM PIE   01012000
*                                      TO TCB                        */ 01013000
         MVC   WORDS3+48(12,R4TCB),WORDS3+20(@12)               01S0248 01014000
*/* P  TRANSLATE S360 PSW RH IN PIE INTO S370R PSW FIELDS IN RB      */ 01015000
*                                                               01S0249 01016000
*   PSWECIA=PSWBCIA;                /* TRANSLATE INSTRUCTION ADDRESS */ 01017000
         L     @11,PSWBCIA-1(,@12)                              01S0249 01018000
         LA    @11,0(,@11)                                      01S0249 01019000
         ST    @11,PSWECIA(,R5RB)                               01S0249 01020000
*   PSWECB=PSWBCB;                  /* MOVE ILC-CC-PM                */ 01021000
         MVC   PSWECB(1,R5RB),PSWBCB(@12)                       01S0250 01022000
*   PSWECZ='00'B;                   /* CLEAR ILC                     */ 01023000
         NI    PSWECZ(R5RB),B'00111111'                         01S0251 01024000
*/* R  RETURN TO EXIT PROLOGUE WITH PIE R15-1                        */ 01025000
*                                                               01S0252 01026000
*   RFY                                                         01S0252 01027000
*     R15 RSTD;                     /* PRESERVE R15 FOR EXIT PROLOG  */ 01028000
*   R15=TCBGRS15;                   /* PASS R15 TO RETRY             */ 01029000
         L     R15,TCBGRS15(,R4TCB)                             01S0253 01030000
*   R0=TCBGRS0;                     /* PASS R0 TO RETRY              */ 01031000
         L     R0,TCBGRS0(,R4TCB)                               01S0254 01032000
*   R1=TCBGRS1;                     /* PASS R1 TO RETRY              */ 01033000
         L     R1,TCBGRS1(,R4TCB)                               01S0255 01034000
*PROLOG2:                           /* TESTING LABEL                 */ 01035000
*   GO TO PROLOGUE;                 /* CLEAN UP AND EXIT TO     01S0256 01036000
*                                      DISPATCHER                    */ 01037000
PROLOG2  L     @14,R14SAVE                                      01S0256 01038000
         BR    @14                                              01S0256 01039000
*   RFY                                                         01S0257 01040000
*     R15 UNRSTD;                   /* RELEASE R15 FOR SUBROUTINE       01041000
*                                      CALLS                         */ 01042000
*                                                               01S0258 01043000
*   /*****************************************************************/ 01044000
*   /*                                                               */ 01045000
*   /* EXIT INITIATES NORMAL TASK TERMINATION BY INVOKING SVC 13     */ 01046000
*   /* UNDER THE LAST RB. EXIT MUST ASSUME TASK MODE IN ORDER TO     */ 01047000
*   /* ISSUE THE SVC. LOCAL LOCK RELEASE CAUSES REGISTER STATUS      */ 01048000
*   /* SAVING ON INTERRUPT IN TCB.                                   */ 01049000
*   /*                                                               */ 01050000
*   /*****************************************************************/ 01051000
*                                                               01S0258 01052000
*/* DOSVC13: N  TASK EXECUTION COMPLETE                              */ 01053000
*                                                               01S0258 01054000
*DOSVC13:                           /* ISSUE SVC 13 FOR INITIAL 01S0258 01055000
*                                      NORMAL EOT                    */ 01056000
*/* P  SAVE COMPLETION CODE FROM TASK REGISTER SAVE AREA             */ 01057000
*                                                               01S0258 01058000
*   R1=TCBGRS15;                    /* PRESERVE RETURN CODE AGAINST     01059000
*                                      TASK MODE                     */ 01060000
DOSVC13  L     R1,TCBGRS15(,R4TCB)                              01S0258 01061000
*/* P  CLEAR TYPE 1 SVC FLAG BECAUSE BYPASSING EXIT PROLOGUE         */ 01062000
*                                                               01S0259 01063000
*   ASCBTYP1='0'B;                  /* CLEAR TYPE 1 SVC SWITCH  01S0259 01064000
*                                      BECAUSE BYPASSING PROLOGUE    */ 01065000
         NI    ASCBTYP1(R7ASCB),B'11111101'                     01S0259 01066000
*/* S SETLOCK:  FREE LOCAL LOCK                                      */ 01067000
*                                                               01S0260 01068000
*   GEN(DROP R8DSECT);              /* RELEASE AUTOMATIC STORAGE     */ 01069000
         DROP R8DSECT                                                   01070000
*SETLOCK1:                          /* TESTING LABEL                 */ 01071000
*   GEN(SETLOCK RELEASE,TYPE=LOCAL,RELATED=(LOCALSUPV,IEAVESVC,GETRTN)) 01072000
*   REFS(PSALITA) SETS(R11,R12,R13AREA,R14);/* SWITCH TO TASK MODE   */ 01073000
SETLOCK1 SETLOCK RELEASE,TYPE=LOCAL,RELATED=(LOCALSUPV,IEAVESVC,GETRTN) 01074000
*SETLOCK2:                          /* TESTING LABEL                 */ 01075000
*/* R  ISSUE SVC 13 TO TERMINATE TASK NORMALLY                       */ 01076000
*                                                               01S0262 01077000
*   R1=R1&'00FFFFFF'X|'08000000'X;  /* INDICATE NORMAL TASK     01S0262 01078000
*                                      COMPLETION                    */ 01079000
SETLOCK2 LR    @12,R1                                           01S0262 01080000
         N     @12,@CF02155                                     01S0262 01081000
         O     @12,@CF02156                                     01S0262 01082000
         LR    R1,@12                                           01S0262 01083000
*ABEND1:                            /* TESTING LABEL                 */ 01084000
*   GEN(SVC 13);                    /* GO TO TASK TERMINATION        */ 01085000
ABEND1   SVC 13                                                         01086000
*   GEN(USING @DATD,R8DSECT);       /* RESUME AUTOMATIC STORAGE      */ 01087000
         USING @DATD,R8DSECT                                            01088000
*                                                               01S0265 01089000
*   /*****************************************************************/ 01090000
*   /*                                                               */ 01091000
*   /* TASK TERMINATION NEEDED MAIN STORAGE RESOURCES TASK           */ 01092000
*   /* DISPATCHABILITY AND A TCB TO RUN AS A TYPE 4 SVC UNDER THE    */ 01093000
*   /* TASK.                                                         */ 01094000
*   /*                                                               */ 01095000
*   /*****************************************************************/ 01096000
*                                                               01S0265 01097000
*/* DODETACH: N  TASK TERMINATION COMPLETE                           */ 01098000
*                                                               01S0265 01099000
*DODETACH:                          /* PERFORM FINAL END-OF-TASK        01100000
*                                      CLEANUP                       */ 01101000
*/* S SPET:  FREE MAIN STORAGE SUBPOOLS                              */ 01102000
*                                                               01S0265 01103000
*SPET1:                             /* TESTING LABEL                 */ 01104000
*   CALL SPET;                      /* CALL MSS TTRM                 */ 01105000
DODETACH DS    0H                                               01S0265 01106000
SPET1    L     @15,CVTQSAS(,R3CVT)                              01S0265 01107000
         BALR  @14,@15                                          01S0265 01108000
*SPET2:                             /* TESTING LABEL                 */ 01109000
*/* S CSPROC:  DECREMENT READY TCB COUNT                             */ 01110000
*                                                               01S0266 01111000
*   CALL CSPROC;                    /* DECREMENT READY TASK COUNT    */ 01112000
SPET2    BAL   @14,CSPROC                                       01S0266 01113000
*/* S DETACH:  ERASE TCB OR SCHEDULE EOT SERVICES                    */ 01114000
*                                                               01S0267 01115000
*   R1=ADDR(TCB);                   /* PASS TCB ADDRESS              */ 01116000
         LR    R1,R4TCB                                         01S0267 01117000
*   R0=0;                           /* INDICATE BRANCH ENTRY FOR EOT    01118000
*                                      NOT ABEND                     */ 01119000
         SLR   R0,R0                                            01S0268 01120000
*DETACH1:                           /* TESTING LABEL                 */ 01121000
*   CALL DETACH;                    /* CALL TCB TTRM                 */ 01122000
DETACH1  L     @15,CVT062R1(,R3CVT)                             01S0269 01123000
         BALR  @14,@15                                          01S0269 01124000
*DETACH2:                           /* TESTING LABEL                 */ 01125000
*                                                               01S0270 01126000
*   /*****************************************************************/ 01127000
*   /*                                                               */ 01128000
*   /* NORMALLY END-OF-TASK MEANS LAST EXIT FROM A PRB.              */ 01129000
*   /*                                                               */ 01130000
*   /*****************************************************************/ 01131000
*                                                               01S0270 01132000
*/* S MSS:  FREE PRB OR SVRB IF DYNAMIC                              */ 01133000
*                                                               01S0270 01134000
*   IF RBFTP='000'B                 /* IF PRB EXITING                */ 01135000
*       &RBFDYN='1'B THEN           /* AND PRB DYNAMIC THEN          */ 01136000
DETACH2  TM    RBFTP(R5RB),B'11100000'                          01S0270 01137000
         BNZ   @RF00270                                         01S0270 01138000
         TM    RBFDYN(R5RB),B'00000010'                         01S0270 01139000
         BNO   @RF00270                                         01S0270 01140000
*     DO;                           /* FREEMAIN PRB                  */ 01141000
*       R0=RBSIZE*8;                /* PASS RB BYTE SIZE INCLUDING      01142000
*                                      THAT OF PARTIAL PREFIX        */ 01143000
         LH    R0,RBSIZE(,R5RB)                                 01S0272 01144000
         SLA   R0,3                                             01S0272 01145000
*       R1=ADDR(RBPRFXST);          /* PASS ADDRESS OF GOTTEN PARTIAL   01146000
*                                      PREFIX                        */ 01147000
         LR    R1,R5RB                                          01S0273 01148000
         AL    R1,@CF02211                                      01S0273 01149000
*       R10WORK=R3CVT;              /* SAVE REGISTER CLOBBERED BY       01150000
*                                      FREEMAIN                      */ 01151000
         LR    R10WORK,R3CVT                                    01S0274 01152000
*MAINP3:                            /* TESTING LABEL                 */ 01153000
*       GEN(FREEMAIN RC,LV=(0),A=(1),SP=255,BRANCH=YES)         01S0275 01154000
*       REFS(R13AREA,R0,R1) SETS(R14,R15,R3CVT);/* FREEMAIN PRB FROM    01155000
*                                      SUBPOOL 255                   */ 01156000
MAINP3   FREEMAIN RC,LV=(0),A=(1),SP=255,BRANCH=YES                     01157000
*MAINP4:                            /* TESTING LABEL                 */ 01158000
*       R3CVT=R10WORK;              /* RESTORE REGISTER CLOBBERED BY    01159000
*                                      FREEMAIN                      */ 01160000
MAINP4   LR    R3CVT,R10WORK                                    01S0276 01161000
*TESTPR:                                                        01S0277 01162000
*       GEN(DS 0H);                 /* TESTING LABEL                 */ 01163000
TESTPR   DS 0H                                                          01164000
*     END;                          /* PRB STORAGE FREED IF DYNAMIC  */ 01165000
*                                                               01S0279 01166000
*   /*****************************************************************/ 01167000
*   /*                                                               */ 01168000
*   /* AN ATTACH FALIURE MAY CAUSE SVRB EXIT FOR END-OF-TASK.        */ 01169000
*   /*                                                               */ 01170000
*   /*****************************************************************/ 01171000
*                                                               01S0279 01172000
*   ELSE                            /* IF NON-PRB EXITING THEN       */ 01173000
*     IF RBFTP='110'B               /* IF SVRB EXITING               */ 01174000
*         &RBFDYN='1'B THEN         /* AND SVRB FREEABLE THEN        */ 01175000
         B     @RC00270                                         01S0279 01176000
@RF00270 TM    RBFTP(R5RB),B'11000000'                          01S0279 01177000
         BNO   @RF00279                                         01S0279 01178000
         TM    RBFTP(R5RB),B'00100000'                          01S0279 01179000
         BNZ   @RF00279                                         01S0279 01180000
         TM    RBFDYN(R5RB),B'00000010'                         01S0279 01181000
         BNO   @RF00279                                         01S0279 01182000
*       DO;                         /* FREEMAIN OR FREECELL RB       */ 01183000
*/* D (YES,,NO,PGMGRCK) VALID SVRB ?                                 */ 01184000
*                                                               01S0281 01185000
*         RFY                                                   01S0281 01186000
*           MBCB BASED(MBCBPTR);                                01S0281 01187000
*         MBCBPTR=R5RB-LENGTH(MBCBMAIN)-ADDR(RBPRFLNA);/* START OF      01188000
*                                      THE SVRB BUFFER POOL  @Z40FPYK*/ 01189000
         LR    @12,R5RB                                         01S0282 01190000
         SL    @12,@CF00061                                     01S0282 01191000
         LA    @11,RBPRFLNA                                     01S0282 01192000
         SLR   @12,@11                                          01S0282 01193000
         ST    @12,MBCBPTR                                      01S0282 01194000
*/* P SET UP TO RETURN SVRB TO POOL                                  */ 01195000
*                                                               01S0283 01196000
*         IF RBNOCELL='1'B THEN                                 01S0283 01197000
         TM    RBNOCELL(R5RB),B'10000000'                       01S0283 01198000
         BO    @RT00283                                         01S0283 01199000
*           GO TO PGMGRCK;          /*                       @ZM41810*/ 01200000
*         IF MBCBID=CHARSVRB THEN                               01S0285 01201000
         CLC   MBCBID(4,@12),CHARSVRB                           01S0285 01202000
         BNE   @RF00285                                         01S0285 01203000
*           DO;                     /* DETERMINE IF THIS IS A VALID     01204000
*                                      SVRB THAT IS BEING RETURNED TO   01205000
*                                      THE SVRB POOL. THIS IS   01S0286 01206000
*                                      DETERMINED BY A VERIFICATION     01207000
*                                      OF WHETHER THE MBCB IDENTIFIER   01208000
*                                      IS 'SVRB'. IF YES THEN THIS IS   01209000
*                                      INDEED AN SVRB WHICH BELONGS     01210000
*                                      TO THE COMMON SVRB MEMORY        01211000
*                                      POOL.                 @Z40FPYK*/ 01212000
*             R0=ASCBSVRB;          /* SET UP TO RETURN THE SVRB TO     01213000
*                                      THE COMMON MEMORY POOL   01S0287 01214000
*                                                            @Z40FPYK*/ 01215000
         L     R0,ASCBSVRB(,R7ASCB)                             01S0287 01216000
*             R1=ASCBSYNC;          /* SYNCHRONIZATION COUNTER TO       01217000
*                                      CONTROL MULTIPLE ACCESSES TO     01218000
*                                      THE ASCB SVRB POOL    @Z40FPYK*/ 01219000
         L     R1,ASCBSYNC(,R7ASCB)                             01S0288 01220000
*/*RELESVRB: P SET UP SVRB LINK FIELD FOR POOL                       */ 01221000
*                                                               01S0289 01222000
*RELESVRB:                                                      01S0289 01223000
*             MBCBLINK=ASCBSVRB;    /* UPDATE CURRENT LINK FIELD IN     01224000
*                                      THE SVRB BEING FREED. @Z40FPYK*/ 01225000
RELESVRB L     @12,ASCBSVRB(,R7ASCB)                            01S0289 01226000
         L     @11,MBCBPTR                                      01S0289 01227000
         ST    @12,MBCBLINK(,@11)                               01S0289 01228000
*/* P INCREMENT SYNCHRONOUS COUNTER                                  */ 01229000
*                                                               01S0290 01230000
*             RFY                                               01S0290 01231000
*              (R14,                                            01S0290 01232000
*               R15) RSTD;          /* RESTRICT REGISTERS 14 AND 15     01233000
*                                                            @Z40FPYK*/ 01234000
*             R15=R1+1;             /* INCREMENT SYNCHRONOUS COUNT IN   01235000
*                                      ASCB                  @Z40FPYK*/ 01236000
         LA    R15,1                                            01S0291 01237000
         ALR   R15,R1                                           01S0291 01238000
*/* P SVRB BEING RETURNED TO POOL                                    */ 01239000
*                                                               01S0292 01240000
*             R14=MBCBPTR;          /* SVRB WHICH IS BEING RETURNED     01241000
*                                      TO POOL               @Z40FPYK*/ 01242000
         L     R14,MBCBPTR                                      01S0292 01243000
*/* P RETURN SVRB TO POOL                                            */ 01244000
*                                                               01S0293 01245000
*             CDS(R0,R14,ASCBSUPC); /* RETURN SVRB TO COMMON MEMORY     01246000
*                                      POOL                  @Z40FPYK*/ 01247000
         CDS   R0,R14,ASCBSUPC(R7ASCB)                          01S0293 01248000
*/* D (YES,RELESVRB,NO,) SVRB RETURNED ?                             */ 01249000
*                                                               01S0294 01250000
*             BC(7,RELESVRB);       /* WAS SVRB RETURNED TO POOL ?      01251000
*                                      NO--                  @Z40FPYK*/ 01252000
         BC    7,RELESVRB                                       01S0294 01253000
*/* P (,STNSM1) SVRB RETURNED SUCCESSFULLY                           */ 01254000
*                                                               01S0295 01255000
*           END;                    /* YES, WE HAVE FINISHED @Z40FPYK*/ 01256000
*         ELSE                                                  01S0296 01257000
*           DO;                     /* DETERMINE IF INVALID SVRB OR     01258000
*                                      PROGRAM MGR SVRB      @Z40FPYK*/ 01259000
         B     @RC00285                                         01S0296 01260000
@RF00285 DS    0H                                               01S0297 01261000
*/*PGMGRCK: D (YES,,NO,%ABND) PROGRAM MGR SVRB ?                     */ 01262000
*                                                               01S0297 01263000
*PGMGRCK:                                                       01S0297 01264000
*             IF RBNOCELL='1'B THEN                             01S0297 01265000
PGMGRCK  TM    RBNOCELL(R5RB),B'10000000'                       01S0297 01266000
         BNO   @RF00297                                         01S0297 01267000
*               DO;                 /* PGM MANAGER SVRB OR REQUEST TO   01268000
*                                      FREE SVRB ?           @ZM41810*/ 01269000
*/* P SET UP TO FREEMAIN RB                                          */ 01270000
*                                                               01S0299 01271000
*                 R1=ADDR(RBPRFXST);/* POINT TO PREFIX WHICH MUST BE    01272000
*                                      FREED                 @Z40FPYK*/ 01273000
         LR    R1,R5RB                                          01S0299 01274000
         AL    R1,@CF02211                                      01S0299 01275000
*                 R0=RBSIZE*8;      /* SIZE OF RB TO BE FREED   01S0300 01276000
*                                                            @Z40FPYK*/ 01277000
         LH    R0,RBSIZE(,R5RB)                                 01S0300 01278000
         SLA   R0,3                                             01S0300 01279000
*                 R10WORK=R3CVT;    /* SAVE REGISTER CLOBBERED BY       01280000
*                                      FREEMAIN              @Z40FPYK*/ 01281000
         LR    R10WORK,R3CVT                                    01S0301 01282000
*/* S (,STNSM1)FREEMAIN:GO FREE THE SVRB                             */ 01283000
*                                                               01S0302 01284000
*                 GEN(FREEMAIN RC,LV=(0),A=(1),SP=255,BRANCH=YES)       01285000
*                 REFS(R13AREA,R0,R1) SETS(R14,R15,R3CVT);/* FREEMAIN   01286000
*                                      SVRB FROM SUBPOOL 255 @Z40FPYK*/ 01287000
         FREEMAIN RC,LV=(0),A=(1),SP=255,BRANCH=YES                     01288000
*                 R3CVT=R10WORK;    /* RESTORE REGISTER CLOBBERED BY    01289000
*                                      FREEMAIN              @Z40FPYK*/ 01290000
         LR    R3CVT,R10WORK                                    01S0303 01291000
*               END;                                            01S0304 01292000
*             ELSE                                              01S0305 01293000
*               DO;                                             01S0305 01294000
*                                                               01S0305 01295000
         B     @RC00297                                         01S0305 01296000
@RF00297 DS    0H                                               01S0306 01297000
*/*%ABND:  P SET UP ABEND CONDITION = 4                              */ 01298000
*                                                               01S0306 01299000
*                 R15=ABENDCND;     /* ABEND CONDITION CODE = 4 01S0306 01300000
*                                                            @Z40FPYK*/ 01301000
         LA    R15,4                                            01S0306 01302000
*/* R X'0F9' ABEND                                                   */ 01303000
*                                                               01S0307 01304000
*                 GEN SETS(R0,R1) EXIT(ABEND X'0F9',DUMP,,SYSTEM);/*    01305000
*                                      ABEND CALLER WITH A X'0F9' R15   01306000
*                                      = 4 ABEND CODE        @Z40FPYK*/ 01307000
         ABEND X'0F9',DUMP,,SYSTEM                                      01308000
*                 RFY                                           01S0308 01309000
*                  (R14,                                        01S0308 01310000
*                   R15) UNRSTD;    /* UNRESTRICT REGS 14 AND 15        01311000
*                                                            @Z40FPYK*/ 01312000
*               END;                /* END OF ABEND INVALID SVRB        01313000
*                                      FUNCTION              @Z40FPYK*/ 01314000
*           END;                    /* END OF FREE VALID SVRB   01S0310 01315000
*                                      FUNCTION              @Z40FPYK*/ 01316000
@RC00297 DS    0H                                               01S0311 01317000
*       END;                        /* END OF ALL SVRB FUNCTIONS        01318000
*                                                            @Z40FPYK*/ 01319000
@RC00285 DS    0H                                               01S0312 01320000
*                                                               01S0312 01321000
*   /*****************************************************************/ 01322000
*   /*                                                               */ 01323000
*   /* THE DISPATCHER HAS AN ENTRY POINT FOR END OF TASK WHICH       */ 01324000
*   /* CIRCUMVENTS USE OF THE CURRENTLY DISPATCHED TCB AND SWITCHES  */ 01325000
*   /* TO DISPATCHING ANOTHER TASK. ENTRY TO THE DISPATCHER MUST TAKE*/ 01326000
*   /* PLACE UNDER INTERRUPT HANDLER MODE WITH EXIT PROLOG CLEANUP   */ 01327000
*   /* COMPLETED.                                                    */ 01328000
*   /*                                                               */ 01329000
*   /*****************************************************************/ 01330000
*                                                               01S0312 01331000
*/* P  DISABLE I/O AND EXTERNAL INTERRUPTS                           */ 01332000
*                                                               01S0312 01333000
*STNSM1:                            /* TESTING LABEL                 */ 01334000
*   GEN(STNSM REGSAVE,B'11111100')                              01S0312 01335000
*   SETS(REGSAVE);                  /* & OFF INTERRUPT ENABLEMENT       01336000
*                                      BITS (6=I/O, 7=EXT) IN PSW       01337000
*                                      SYSTEM MASK                   */ 01338000
@RF00279 DS    0H                                               01S0312 01339000
@RC00270 DS    0H                                               01S0312 01340000
STNSM1   STNSM REGSAVE,B'11111100'                                      01341000
*STNSM2:                            /* TESTING LABEL                 */ 01342000
*/* P  CLEAR TYPE 1 SVC FLAG BECAUSE BYPASSING EXIT PROLOGUE         */ 01343000
*                                                               01S0313 01344000
*   ASCBTYP1='0'B;                  /* INDICATE NO TYPE 1 SVC   01S0313 01345000
*                                      EXECUTING                     */ 01346000
STNSM2   NI    ASCBTYP1(R7ASCB),B'11111101'                     01S0313 01347000
*/* S SETLOCK:  FREE LOCAL LOCK                                      */ 01348000
*                                                               01S0314 01349000
*   GEN(DROP R8DSECT);              /* RELEASE AUTOMATIC STORAGE     */ 01350000
         DROP R8DSECT                                                   01351000
*SETLOCK3:                          /* TESTING LABEL                 */ 01352000
*   GEN(SETLOCK RELEASE,TYPE=LOCAL,RELATED=(LOCALSUPV,IEAVESVC,GETRTN)) 01353000
*   REFS(PSALITA) SETS(R11,R12,R13AREA,R14);/* RELEASE LOCK BECAUSE     01354000
*                                      BYPASSING EXIT PROLOGUE       */ 01355000
SETLOCK3 SETLOCK RELEASE,TYPE=LOCAL,RELATED=(LOCALSUPV,IEAVESVC,GETRTN) 01356000
*/* R  EXIT TO EOT DISPATCHER ENTRY                                  */ 01357000
*                                                               01S0316 01358000
*   GEN(USING @DATD,R8DSECT);       /* RESUME AUTOMATIC STORAGE      */ 01359000
         USING @DATD,R8DSECT                                            01360000
*SETLOCK4:                          /* TESTING LABEL                 */ 01361000
*SWITCH1:                           /* TESTING LABEL                 */ 01362000
*   GO TO IEAPDS6;                  /* SPECIAL ENTRY POINT FOR END OF   01363000
*                                      TASK                          */ 01364000
SETLOCK4 DS    0H                                               01S0317 01365000
SWITCH1  L     @12,@CV02027                                     01S0317 01366000
         BR    @12                                              01S0317 01367000
*/* SVC3: END                                                        */ 01368000
*                                                               01S0318 01369000
*CSPROC:                                                        01S0318 01370000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/* DECREMENT TCB COUNT           */ 01371000
*                                                               01S0318 01372000
CSPROC   DS    0H                                               01S0319 01373000
*   /*****************************************************************/ 01374000
*   /*                                                               */ 01375000
*   /* COMPARE-AND-SWAP INSTRUCTIONS SERIALIZE THE COUNT OF          */ 01376000
*   /* DISPATCHABLE TASKS IN AN ADDRESS SPACE.                       */ 01377000
*   /*                                                               */ 01378000
*   /*****************************************************************/ 01379000
*                                                               01S0319 01380000
*CSLOOP:                            /* CS LOOP                       */ 01381000
*   R0=ASCBTCBS;                    /* LOAD COUNT                    */ 01382000
CSLOOP   L     R0,ASCBTCBS(,R7ASCB)                             01S0319 01383000
*   R1=R0;                          /* COPY COUNT                    */ 01384000
         LR    R1,R0                                            01S0320 01385000
*   R1=R1-1;                        /* DECREMENT COUNT               */ 01386000
         BCTR  R1,0                                             01S0321 01387000
*CSOP:                              /* TESTING LABEL                 */ 01388000
*   CS(R0,R1,ASCBTCBS);             /* ATTEMPT UPDATE                */ 01389000
CSOP     CS    R0,@01,ASCBTCBS(R7ASCB)                          01S0322 01390000
*   BC(7,CSLOOP);                   /* RETRY UPDATE ON INTERFERENCE  */ 01391000
         BC    7,CSLOOP                                         01S0323 01392000
*TESTCS:                            /* TESTING LABEL                 */ 01393000
*   END CSPROC;                     /* READY TASK COUNT DECREMENTED  */ 01394000
@EL00002 DS    0H                                               01S0324 01395000
@EF00002 DS    0H                                               01S0324 01396000
@ER00002 BR    @14                                              01S0324 01397000
*   END IGC003                      /* END                           */ 01398000
*                                                               01S0325 01399000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01400000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 01401000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */ 01402000
*/*%INCLUDE SYSLIB  (IHARB   )                                       */ 01403000
*/*%INCLUDE SYSLIB  (IKJRB   )                                       */ 01404000
*/*%INCLUDE SYSLIB  (IHAIQE  )                                       */ 01405000
*/*%INCLUDE SYSLIB  (IHASCA  )                                       */ 01406000
*/*%INCLUDE SYSLIB  (IHAPIE  )                                       */ 01407000
*/*%INCLUDE SYSLIB  (IHAMBCB )                                       */ 01408000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 01409000
*/*%INCLUDE SYSLIB  (IHAASXB )                                       */ 01410000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 01411000
*/*%INCLUDE SYSLIB  (IHAWSAVT)                                       */ 01412000
*/*%INCLUDE SYSUT5  (SVC3RB  )                                       */ 01413000
*                                                               01S0325 01414000
*       ;                                                       01S0325 01415000
@DATA    DS    0H                                                       01416000
@DATD    DSECT                                                          01417000
         DS    0F                                                       01418000
IGC003   CSECT                                                          01419000
         DS    0F                                                       01420000
@CF00061 DC    F'8'                                                     01421000
@CF02211 DC    F'-32'                                                   01422000
@CF02210 DC    F'-8'                                                    01423000
@CF02155 DC    XL4'00FFFFFF'                                            01424000
@CF02156 DC    XL4'08000000'                                            01425000
@DATD    DSECT                                                          01426000
         DS    0D                                                       01427000
MBCBPTR  DS    A                                                        01428000
STORAGE  DS    CL84                                                     01429000
         ORG   STORAGE                                                  01430000
UNUSED   DS    FL4                                                      01431000
FLAGS    DS    FL4                                                      01432000
         ORG   FLAGS                                                    01433000
NEXT     DS    BL1                                                      01434000
         ORG   STORAGE+8                                                01435000
R14SAVE  DS    AL4                                                      01436000
REGSAVE  DS    18F                                                      01437000
         ORG   STORAGE+84                                               01438000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01439000
@ENDDATD EQU   *                                                        01440000
IGC003   CSECT                                                          01441000
         NOPR  ((@ENDDATD-@DATD)/129*16)                                01442000
         DS    0F                                                       01443000
@SIZDATD DC    AL1(0)                                                   01444000
         DC    AL3(@ENDDATD-@DATD)                                      01445000
@CV02027 DC    V(IEAPDS6)                                               01446000
@CA02028 DC    A(IEAPSVC3)                                              01447000
@CV02049 DC    V(IEAVESSS)                                              01448000
@CV02075 DC    V(IEAPPGMX)                                              01449000
@CV02098 DC    V(IECVX025)                                              01450000
         DS    0D                                                       01451000
CHARSVRB DC    CL4'SVRB'                                                01452000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01453000
@01      EQU   01                                                       01454000
@02      EQU   02                                                       01455000
@03      EQU   03                                                       01456000
@04      EQU   04                                                       01457000
@05      EQU   05                                                       01458000
@06      EQU   06                                                       01459000
@07      EQU   07                                                       01460000
@08      EQU   08                                                       01461000
@09      EQU   09                                                       01462000
@10      EQU   10                                                       01463000
@11      EQU   11                                                       01464000
@12      EQU   12                                                       01465000
@13      EQU   13                                                       01466000
@14      EQU   14                                                       01467000
@15      EQU   15                                                       01468000
R3CVT    EQU   @03                                                      01469000
R4TCB    EQU   @04                                                      01470000
R5RB     EQU   @05                                                      01471000
R7ASCB   EQU   @07                                                      01472000
R9UNUSED EQU   @09                                                      01473000
R10WORK  EQU   @10                                                      01474000
R15      EQU   @15                                                      01475000
R0       EQU   @00                                                      01476000
R1       EQU   @01                                                      01477000
R11      EQU   @11                                                      01478000
R12      EQU   @12                                                      01479000
R2       EQU   @02                                                      01480000
R6CSECT  EQU   @06                                                      01481000
R14      EQU   @14                                                      01482000
R8DSECT  EQU   @08                                                      01483000
R13AREA  EQU   @13                                                      01484000
         EXTRN IEAPSVC3                                                 01485000
PSA      EQU   0                                                        01486000
FLCRNPSW EQU   PSA                                                      01487000
FLCROPSW EQU   PSA+8                                                    01488000
FLCICCW2 EQU   PSA+16                                                   01489000
PSAEEPSW EQU   PSA+132                                                  01490000
PSAESPSW EQU   PSA+136                                                  01491000
FLCSVILC EQU   PSAESPSW+1                                               01492000
PSAEPPSW EQU   PSA+140                                                  01493000
FLCPIILC EQU   PSAEPPSW+1                                               01494000
FLCPICOD EQU   PSAEPPSW+2                                               01495000
PSAPICOD EQU   FLCPICOD+1                                               01496000
FLCTEA   EQU   PSAEPPSW+4                                               01497000
FLCPER   EQU   PSA+152                                                  01498000
FLCMCLA  EQU   PSA+168                                                  01499000
FLCIOEL  EQU   FLCMCLA+4                                                01500000
FLCIOA   EQU   FLCMCLA+16                                               01501000
FLCFSA   EQU   FLCMCLA+80                                               01502000
PSASUPER EQU   PSA+552                                                  01503000
PSASUP1  EQU   PSASUPER                                                 01504000
PSASUP2  EQU   PSASUPER+1                                               01505000
PSASUP3  EQU   PSASUPER+2                                               01506000
PSASUP4  EQU   PSASUPER+3                                               01507000
PSACLHT  EQU   PSA+640                                                  01508000
PSALKSA  EQU   PSA+696                                                  01509000
PSAHLHI  EQU   PSA+760                                                  01510000
PSALITA  EQU   PSA+764                                                  01511000
PSADSSFL EQU   PSA+836                                                  01512000
PSADSSF1 EQU   PSADSSFL                                                 01513000
PSADSSF3 EQU   PSADSSFL+2                                               01514000
PSADSSF4 EQU   PSADSSFL+3                                               01515000
PSARSVT  EQU   PSA+896                                                  01516000
CVTMAP   EQU   0                                                        01517000
CVTDAR   EQU   CVTMAP+72                                                01518000
CVTFLGS1 EQU   CVTDAR                                                   01519000
CVTDCB   EQU   CVTMAP+116                                               01520000
CVTIOQET EQU   CVTMAP+120                                               01521000
CVTIERLC EQU   CVTMAP+144                                               01522000
CVTHEAD  EQU   CVTMAP+160                                               01523000
CVTSV76C EQU   CVTHEAD                                                  01524000
CVTOPTA  EQU   CVTMAP+182                                               01525000
CVTOPTB  EQU   CVTMAP+183                                               01526000
CVTGTF   EQU   CVTMAP+236                                               01527000
CVTGTFST EQU   CVTGTF                                                   01528000
CVTGTFS  EQU   CVTGTFST                                                 01529000
CVTSTATE EQU   CVTGTFST                                                 01530000
CVTTMODE EQU   CVTGTFST                                                 01531000
CVTFORM  EQU   CVTGTFST                                                 01532000
CVTAQAVT EQU   CVTMAP+240                                               01533000
CVTTCMFG EQU   CVTAQAVT                                                 01534000
CVTVOLM2 EQU   CVTMAP+244                                               01535000
CVTTATA  EQU   CVTVOLM2                                                 01536000
CVTTSKS  EQU   CVTTATA                                                  01537000
CVTVOLF2 EQU   CVTTSKS                                                  01538000
CVTTAT   EQU   CVTTATA+1                                                01539000
CVTATER  EQU   CVTMAP+248                                               01540000
CVTEXT1  EQU   CVTMAP+252                                               01541000
CVTPURG  EQU   CVTMAP+260                                               01542000
CVTQMSG  EQU   CVTMAP+268                                               01543000
CVTDMSR  EQU   CVTMAP+272                                               01544000
CVTRSV37 EQU   CVTDMSR                                                  01545000
CVTDMSRF EQU   CVTRSV37                                                 01546000
CVTERPV  EQU   CVTMAP+316                                               01547000
CVTINTLA EQU   CVTMAP+320                                               01548000
CVTAPF   EQU   CVTMAP+324                                               01549000
CVTEXT2  EQU   CVTMAP+328                                               01550000
CVTHJES  EQU   CVTMAP+332                                               01551000
CVTPGSIA EQU   CVTMAP+348                                               01552000
CVTA1F1  EQU   CVTMAP+356                                               01553000
CVTSYSK  EQU   CVTMAP+357                                               01554000
CVTVOLM1 EQU   CVTMAP+380                                               01555000
CVTVOLF1 EQU   CVTVOLM1                                                 01556000
CVTATMCT EQU   CVTMAP+388                                               01557000
CVTXTNT1 EQU   0                                                        01558000
CVTXTNT2 EQU   0                                                        01559000
CVTDSSV  EQU   CVTXTNT2                                                 01560000
CVTFLGBT EQU   CVTXTNT2+5                                               01561000
CVTQID   EQU   CVTXTNT2+24                                              01562000
CVTRV400 EQU   CVTXTNT2+52                                              01563000
CVTRV409 EQU   CVTXTNT2+53                                              01564000
CVTATCVT EQU   CVTXTNT2+64                                              01565000
CVTRV429 EQU   CVTXTNT2+84                                              01566000
CVTRV438 EQU   CVTXTNT2+85                                              01567000
CVTRV457 EQU   CVTXTNT2+112                                             01568000
CVTRV466 EQU   CVTXTNT2+113                                             01569000
CVTFIX   EQU   0                                                        01570000
CVTRELNO EQU   CVTFIX+252                                               01571000
TCBFIX   EQU   0                                                        01572000
TCBFRS   EQU   TCBFIX                                                   01573000
TCB      EQU   0                                                        01574000
TCBRBP   EQU   TCB                                                      01575000
TCBPIE   EQU   TCB+4                                                    01576000
TCBPMASK EQU   TCBPIE                                                   01577000
TCBPIEA  EQU   TCBPIE+1                                                 01578000
TCBCMP   EQU   TCB+16                                                   01579000
TCBCMPF  EQU   TCBCMP                                                   01580000
TCBCPP   EQU   TCBCMPF                                                  01581000
TCBSTCC  EQU   TCBCMPF                                                  01582000
TCBCDBL  EQU   TCBCMPF                                                  01583000
TCBCWTO  EQU   TCBCMPF                                                  01584000
TCBCIND  EQU   TCBCMPF                                                  01585000
TCBCMSG  EQU   TCBCMPF                                                  01586000
TCBTRN   EQU   TCB+20                                                   01587000
TCBABF   EQU   TCBTRN                                                   01588000
TCBMSS   EQU   TCB+24                                                   01589000
TCBPKF   EQU   TCB+28                                                   01590000
TCBFLGS  EQU   TCB+29                                                   01591000
TCBFLGS1 EQU   TCBFLGS                                                  01592000
TCBNONPR EQU   TCBFLGS1                                                 01593000
TCBFLGS2 EQU   TCBFLGS+1                                                01594000
TCBFLGS3 EQU   TCBFLGS+2                                                01595000
TCBFLGS4 EQU   TCBFLGS+3                                                01596000
TCBFLGS5 EQU   TCBFLGS+4                                                01597000
TCBABWF  EQU   TCBFLGS5                                                 01598000
TCBPNDSP EQU   TCBFLGS5                                                 01599000
TCBJPQ   EQU   TCB+44                                                   01600000
TCBPURGE EQU   TCBJPQ                                                   01601000
TCBGRS   EQU   TCB+48                                                   01602000
TCBGRS0  EQU   TCBGRS                                                   01603000
TCBGRS1  EQU   TCBGRS+4                                                 01604000
TCBGRS2  EQU   TCBGRS+8                                                 01605000
TCBGRS14 EQU   TCBGRS+56                                                01606000
TCBGRS15 EQU   TCBGRS+60                                                01607000
TCBFSA   EQU   TCB+112                                                  01608000
TCBTME   EQU   TCB+120                                                  01609000
TCBJSTCB EQU   TCB+124                                                  01610000
TCBTSFLG EQU   TCB+148                                                  01611000
TCBTSTSK EQU   TCBTSFLG                                                 01612000
TCBSTPPR EQU   TCBTSFLG                                                 01613000
TCBATT   EQU   TCBTSFLG                                                 01614000
TCBSTAB  EQU   TCB+160                                                  01615000
TCBNSTAE EQU   TCBSTAB                                                  01616000
TCBTCT   EQU   TCB+164                                                  01617000
TCBTCTGF EQU   TCBTCT                                                   01618000
TCBSCNDY EQU   TCB+172                                                  01619000
TCBNDSP  EQU   TCBSCNDY                                                 01620000
TCBNDSP1 EQU   TCBNDSP+1                                                01621000
TCBNDSP2 EQU   TCBNDSP+2                                                01622000
TCBSTPP  EQU   TCBNDSP2                                                 01623000
TCBNDSP3 EQU   TCBNDSP+3                                                01624000
TCBJSCB  EQU   TCB+180                                                  01625000
TCBRECDE EQU   TCBJSCB                                                  01626000
TCBEXT1  EQU   TCB+196                                                  01627000
TCBBITS  EQU   TCB+200                                                  01628000
TCBNDSP4 EQU   TCBBITS                                                  01629000
TCBNDSP5 EQU   TCBBITS+1                                                01630000
TCBFLGS6 EQU   TCBBITS+2                                                01631000
TCBFLGS7 EQU   TCBBITS+3                                                01632000
TCBDAR   EQU   TCB+204                                                  01633000
TCBDARC  EQU   TCBDAR                                                   01634000
TCBEXT2  EQU   TCB+208                                                  01635000
TCBXSCT  EQU   TCB+240                                                  01636000
TCBXSCT1 EQU   TCBXSCT                                                  01637000
TCBFOE   EQU   TCB+244                                                  01638000
TCBESTAE EQU   TCB+264                                                  01639000
TCBESTRM EQU   TCBESTAE+1                                               01640000
TCBFBYT1 EQU   TCB+276                                                  01641000
TCBEOT   EQU   TCBFBYT1                                                 01642000
TCBFBYT2 EQU   TCB+277                                                  01643000
TCBRV124 EQU   TCB+278                                                  01644000
TCBRV133 EQU   TCB+279                                                  01645000
TCBXTNT2 EQU   0                                                        01646000
TCBGTF   EQU   TCBXTNT2                                                 01647000
TCBTFLG  EQU   TCBGTF                                                   01648000
TCBRV146 EQU   TCBXTNT2+28                                              01649000
TCBRV155 EQU   TCBXTNT2+29                                              01650000
TCBRV164 EQU   TCBXTNT2+30                                              01651000
TCBRV173 EQU   TCBXTNT2+31                                              01652000
RBPRFX   EQU   0                                                        01653000
RBBASIC  EQU   0                                                        01654000
RBEXRTNM EQU   RBBASIC                                                  01655000
RBTMFLD  EQU   RBEXRTNM                                                 01656000
RBSTAB   EQU   RBBASIC+10                                               01657000
XSTAB    EQU   RBSTAB                                                   01658000
RBSTAB1  EQU   XSTAB                                                    01659000
XSTAB1   EQU   RBSTAB1                                                  01660000
RBFTCKPT EQU   XSTAB1                                                   01661000
RBSTAB2  EQU   XSTAB+1                                                  01662000
XSTAB2   EQU   RBSTAB2                                                  01663000
RBTCBNXT EQU   XSTAB2                                                   01664000
RBFACTV  EQU   XSTAB2                                                   01665000
RBFDYN   EQU   XSTAB2                                                   01666000
RBECBWT  EQU   XSTAB2                                                   01667000
RBOPSW   EQU   RBBASIC+16                                               01668000
XRBPSW   EQU   RBOPSW                                                   01669000
RBOPSWB2 EQU   XRBPSW+1                                                 01670000
RBLINK   EQU   RBBASIC+28                                               01671000
XRBLNK   EQU   RBLINK                                                   01672000
RBWCF    EQU   XRBLNK                                                   01673000
RBLINKB  EQU   XRBLNK+1                                                 01674000
RBGRSAVE EQU   RBBASIC+32                                               01675000
XRBREG   EQU   RBGRSAVE                                                 01676000
RBGRS0   EQU   XRBREG                                                   01677000
RBGRS1   EQU   XRBREG+4                                                 01678000
RBGRS2   EQU   XRBREG+8                                                 01679000
RBGRS3   EQU   XRBREG+12                                                01680000
RBGRS4   EQU   XRBREG+16                                                01681000
RBGRS5   EQU   XRBREG+20                                                01682000
RBGRS6   EQU   XRBREG+24                                                01683000
RBGRS7   EQU   XRBREG+28                                                01684000
RBGRS8   EQU   XRBREG+32                                                01685000
RBGRS9   EQU   XRBREG+36                                                01686000
RBGRS10  EQU   XRBREG+40                                                01687000
RBGRS11  EQU   XRBREG+44                                                01688000
RBGRS12  EQU   XRBREG+48                                                01689000
RBGRS13  EQU   XRBREG+52                                                01690000
RBGRS14  EQU   XRBREG+56                                                01691000
RBGRS15  EQU   XRBREG+60                                                01692000
XRBESA   EQU   RBBASIC+96                                               01693000
RBPREFIX EQU   0                                                        01694000
RBRSV019 EQU   RBPREFIX+14                                              01695000
RBRSV028 EQU   RBPREFIX+15                                              01696000
RBRSV041 EQU   RBPREFIX+27                                              01697000
RBPRFXST EQU   RBPREFIX+32                                              01698000
RBRSV054 EQU   RBPREFIX+39                                              01699000
RBRTOPSW EQU   RBPREFIX+40                                              01700000
RBRTPSW2 EQU   RBRTOPSW+8                                               01701000
RBRTICIL EQU   RBRTPSW2                                                 01702000
RBFLAGS1 EQU   RBPREFIX+56                                              01703000
RBSCB    EQU   RBFLAGS1                                                 01704000
RBINTCDA EQU   RBPREFIX+61                                              01705000
RBSECT   EQU   0                                                        01706000
RBPPSAV  EQU   RBSECT                                                   01707000
RBPPSAV1 EQU   RBPPSAV+1                                                01708000
RBSIZE   EQU   RBSECT+8                                                 01709000
@NM00018 EQU   RBSECT+10                                                01710000
@NM00019 EQU   @NM00018                                                 01711000
RBFTP    EQU   @NM00019                                                 01712000
RBTRSVRB EQU   @NM00019                                                 01713000
RBATNXIT EQU   @NM00019                                                 01714000
@NM00021 EQU   @NM00018+1                                               01715000
RBATTN   EQU   @NM00021                                                 01716000
RBETXR   EQU   @NM00021                                                 01717000
RBIQETP  EQU   @NM00021                                                 01718000
RBEP     EQU   RBSECT+12                                                01719000
RBPGMQ   EQU   RBSECT+24                                                01720000
@NM00028 EQU   RBSECT+28                                                01721000
@NM00029 EQU   @NM00028                                                 01722000
IRBEND   EQU   RBSECT+96                                                01723000
@NM00032 EQU   RBSECT+96                                                01724000
RBRSV138 EQU   @NM00032+7                                               01725000
RBSCBB   EQU   RBSECT+144                                               01726000
RBSPARM  EQU   RBSCBB+8                                                 01727000
RBSFLGS1 EQU   RBSPARM                                                  01728000
RBSIOPRC EQU   RBSFLGS1                                                 01729000
RBSOWNR  EQU   RBSCBB+12                                                01730000
RBSFLGS2 EQU   RBSOWNR                                                  01731000
RBSDATA  EQU   RBSCBB+16                                                01732000
RBSFLG3  EQU   RBSDATA                                                  01733000
RBRSV150 EQU   RBSECT+167                                               01734000
IQESECT  EQU   0                                                        01735000
IQELNK   EQU   IQESECT                                                  01736000
IQELNKA  EQU   IQELNK+1                                                 01737000
IQEIRB   EQU   IQESECT+8                                                01738000
IQEFLAGS EQU   IQEIRB                                                   01739000
IQETCB   EQU   IQESECT+12                                               01740000
SCA      EQU   0                                                        01741000
SCAPIE   EQU   SCA                                                      01742000
PIE      EQU   0                                                        01743000
PIEPICA  EQU   PIE                                                      01744000
PIEFLGS  EQU   PIEPICA                                                  01745000
PIENOPI  EQU   PIEFLGS                                                  01746000
PIEPICAA EQU   PIEPICA+1                                                01747000
PIEPSW   EQU   PIE+4                                                    01748000
PIEGR14  EQU   PIE+12                                                   01749000
PIEGR0   EQU   PIE+20                                                   01750000
MBCB     EQU   0                                                        01751000
MBCBMAIN EQU   MBCB                                                     01752000
MBCBID   EQU   MBCBMAIN                                                 01753000
MBCBLINK EQU   MBCBMAIN+4                                               01754000
ASCB     EQU   0                                                        01755000
ASCBSUPC EQU   ASCB+16                                                  01756000
ASCBSVRB EQU   ASCBSUPC                                                 01757000
ASCBSYNC EQU   ASCBSUPC+4                                               01758000
ASCBRSM  EQU   ASCB+52                                                  01759000
ASCBRSMF EQU   ASCBRSM                                                  01760000
ASCBFW1  EQU   ASCB+100                                                 01761000
ASCBRCTF EQU   ASCBFW1+2                                                01762000
ASCBFLG1 EQU   ASCBFW1+3                                                01763000
ASCBTYP1 EQU   ASCBFLG1                                                 01764000
ASCBASXB EQU   ASCB+108                                                 01765000
ASCBDSP1 EQU   ASCB+114                                                 01766000
ASCBFLG2 EQU   ASCB+115                                                 01767000
ASCBTCBS EQU   ASCB+124                                                 01768000
ASCBLKGP EQU   ASCB+128                                                 01769000
ASCBSRQ  EQU   ASCB+180                                                 01770000
ASCBSRQ1 EQU   ASCBSRQ                                                  01771000
ASCBSRQ2 EQU   ASCBSRQ+1                                                01772000
ASCBSRQ3 EQU   ASCBSRQ+2                                                01773000
ASCBSRQ4 EQU   ASCBSRQ+3                                                01774000
ASXB     EQU   0                                                        01775000
ASXBSPSA EQU   ASXB+112                                                 01776000
ASXBAEQ  EQU   ASXB+168                                                 01777000
ASXBSECR EQU   ASXB+199                                                 01778000
ASCBSFLG EQU   ASXBSECR                                                 01779000
ASXBCASW EQU   ASXB+216                                                 01780000
ASXBCRB1 EQU   ASXBCASW                                                 01781000
WSAL     EQU   0                                                        01782000
WSALEXIT EQU   WSAL+28                                                  01783000
WORDS3   EQU   0                                                        01784000
WORDS13  EQU   0                                                        01785000
WORDS2   EQU   0                                                        01786000
PROLOGUE EQU   0                                                        01787000
SPET     EQU   0                                                        01788000
SCBPURGE EQU   0                                                        01789000
ATTNEPLG EQU   0                                                        01790000
DETACH   EQU   0                                                        01791000
IQEEND   EQU   0                                                        01792000
CVTS01   EQU   CVTPGSIA                                                 01793000
CVTLPDIA EQU   CVTS01+12                                                01794000
CVTDIRST EQU   CVTLPDIA                                                 01795000
CVTSLIDA EQU   CVTS01+24                                                01796000
CVTCTLFG EQU   CVTS01+50                                                01797000
CVTCRMN  EQU   CVTS01+156                                               01798000
CVTQSAS  EQU   CVTS01+164                                               01799000
CVTSTXU  EQU   CVTS01+184                                               01800000
CVTSCBP  EQU   CVTS01+236                                               01801000
CVTEXPRO EQU   CVTS01+260                                               01802000
CVT062R1 EQU   CVTS01+324                                               01803000
CVTRV210 EQU   CVTS01+424                                               01804000
CVTRV219 EQU   CVTS01+425                                               01805000
CVTRV228 EQU   CVTS01+426                                               01806000
CVTRV237 EQU   CVTS01+427                                               01807000
CVTMFRTR EQU   CVTS01+452                                               01808000
CVTRV262 EQU   CVTS01+468                                               01809000
CVTRV271 EQU   CVTS01+469                                               01810000
CVTRV280 EQU   CVTS01+470                                               01811000
CVTRV289 EQU   CVTS01+471                                               01812000
CVTEXP1  EQU   CVTS01+572                                               01813000
CVTGSDA  EQU   CVTS01+600                                               01814000
RBSECS03 EQU   RBEP                                                     01815000
RBCDE    EQU   RBSECS03                                                 01816000
RBCDFLGS EQU   RBCDE                                                    01817000
RBNOCELL EQU   RBCDFLGS                                                 01818000
RBCDSAVE EQU   RBCDFLGS                                                 01819000
RBCDSYNC EQU   RBCDFLGS                                                 01820000
RBSECS05 EQU   RBPGMQ                                                   01821000
RBSQE    EQU   RBSECS05                                                 01822000
RBSECS06 EQU   RBPGMQ                                                   01823000
RBIQE    EQU   RBSECS06                                                 01824000
RBUSE    EQU   RBIQE                                                    01825000
RBIQE1   EQU   RBIQE+1                                                  01826000
RBSECS07 EQU   RBPGMQ                                                   01827000
RBIQE2   EQU   RBSECS07                                                 01828000
RBSECS08 EQU   IRBEND                                                   01829000
RBNEXAV  EQU   RBSECS08                                                 01830000
RBIQEWRK EQU   RBSECS08+4                                               01831000
RBSECS09 EQU   IRBEND                                                   01832000
PSARSVTE EQU   PSARSVT                                                  01833000
PSWBC    EQU   PIEPSW                                                   01834000
PSWBCRH  EQU   PSWBC+4                                                  01835000
PSWBCB   EQU   PSWBCRH                                                  01836000
PSWBCIA  EQU   PSWBCRH+1                                                01837000
PSWEC    EQU   RBOPSW                                                   01838000
PSWECB   EQU   PSWEC+2                                                  01839000
PSWECZ   EQU   PSWECB                                                   01840000
PSWECIA  EQU   PSWEC+4                                                  01841000
FLC      EQU   PSA                                                      01842000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01843000
@NM00068 EQU   PSWEC+3                                                  01844000
PSWECPM  EQU   PSWECB                                                   01845000
PSWECCC  EQU   PSWECB                                                   01846000
@NM00067 EQU   PSWEC                                                    01847000
PSWBCPM  EQU   PSWBCB                                                   01848000
PSWBCCC  EQU   PSWBCB                                                   01849000
PSWBCILC EQU   PSWBCB                                                   01850000
@NM00066 EQU   PSWBC                                                    01851000
PSARSAV  EQU   PSARSVTE+60                                              01852000
PSARSTK  EQU   PSARSVTE+56                                              01853000
PSAESAV3 EQU   PSARSVTE+52                                              01854000
PSAESTK3 EQU   PSARSVTE+48                                              01855000
PSAESAV2 EQU   PSARSVTE+44                                              01856000
PSAESTK2 EQU   PSARSVTE+40                                              01857000
PSAESAV1 EQU   PSARSVTE+36                                              01858000
PSAESTK1 EQU   PSARSVTE+32                                              01859000
PSAPSAV  EQU   PSARSVTE+28                                              01860000
PSAPSTK  EQU   PSARSVTE+24                                              01861000
PSAMSAV  EQU   PSARSVTE+20                                              01862000
PSAMSTK  EQU   PSARSVTE+16                                              01863000
PSASSAV  EQU   PSARSVTE+12                                              01864000
PSASSTK  EQU   PSARSVTE+8                                               01865000
PSANSTK  EQU   PSARSVTE+4                                               01866000
PSACSTK  EQU   PSARSVTE                                                 01867000
RBRSV161 EQU   RBSECS09+64                                              01868000
RBSIRBWA EQU   RBSECS09                                                 01869000
RBIQEA   EQU   RBIQE2                                                   01870000
RBSQEA   EQU   RBSQE+1                                                  01871000
@NM00033 EQU   RBSQE                                                    01872000
RBCDE1   EQU   RBCDE+1                                                  01873000
RBCDLOAD EQU   RBCDFLGS                                                 01874000
RBCDXCTL EQU   RBCDFLGS                                                 01875000
RBCDNODE EQU   RBCDFLGS                                                 01876000
RBCDATCH EQU   RBCDFLGS                                                 01877000
RBRSV009 EQU   RBCDFLGS                                                 01878000
CVTRV628 EQU   CVTS01+728                                               01879000
CVTRV627 EQU   CVTS01+724                                               01880000
CVTRV626 EQU   CVTS01+720                                               01881000
CVTRV625 EQU   CVTS01+716                                               01882000
CVTRV624 EQU   CVTS01+712                                               01883000
CVTRV623 EQU   CVTS01+708                                               01884000
CVTRV622 EQU   CVTS01+704                                               01885000
CVTRV621 EQU   CVTS01+700                                               01886000
CVTIHASU EQU   CVTS01+696                                               01887000
CVTSUSP  EQU   CVTS01+692                                               01888000
CVTT6SVC EQU   CVTS01+688                                               01889000
CVTCDAL  EQU   CVTS01+684                                               01890000
CVTTCTL  EQU   CVTS01+680                                               01891000
CVTRSUME EQU   CVTS01+676                                               01892000
CVTJTERM EQU   CVTS01+672                                               01893000
CVTASMRM EQU   CVTS01+668                                               01894000
CVTTCASP EQU   CVTS01+664                                               01895000
CVT0PT03 EQU   CVTS01+660                                               01896000
CVT0PT0E EQU   CVTS01+656                                               01897000
CVTRV609 EQU   CVTS01+652                                               01898000
CVTCGK   EQU   CVTS01+648                                               01899000
CVTRAC   EQU   CVTS01+644                                               01900000
CVTHSM   EQU   CVTS01+640                                               01901000
CVTRV605 EQU   CVTS01+636                                               01902000
CVTRV604 EQU   CVTS01+632                                               01903000
CVTEFF02 EQU   CVTS01+628                                               01904000
CVTCBBR  EQU   CVTS01+624                                               01905000
CVTSSCR  EQU   CVTS01+620                                               01906000
CVTEVENT EQU   CVTS01+616                                               01907000
CVTCRCA  EQU   CVTS01+612                                               01908000
CVTTPIO  EQU   CVTS01+608                                               01909000
CVTADV   EQU   CVTS01+604                                               01910000
CVTGSDAB EQU   CVTGSDA                                                  01911000
CVTQV3   EQU   CVTS01+596                                               01912000
CVTQV2   EQU   CVTS01+592                                               01913000
CVTQV1   EQU   CVTS01+588                                               01914000
CVTRPT   EQU   CVTS01+584                                               01915000
CVTSSRB  EQU   CVTS01+580                                               01916000
CVTCSDRL EQU   CVTS01+576                                               01917000
CVTRMPMT EQU   CVTS01+568                                               01918000
CVTRMPTT EQU   CVTS01+564                                               01919000
CVTVPSA  EQU   CVTS01+560                                               01920000
CVTVSTOP EQU   CVTS01+556                                               01921000
CVTGTFR8 EQU   CVTS01+552                                               01922000
CVTQUIT  EQU   CVTS01+548                                               01923000
CVTVACR  EQU   CVTS01+544                                               01924000
CVTWTCB  EQU   CVTS01+540                                               01925000
CVTSTPRS EQU   CVTS01+536                                               01926000
CVT0PT02 EQU   CVTS01+532                                               01927000
CVTDARCM EQU   CVTS01+528                                               01928000
CVTIRECM EQU   CVTS01+524                                               01929000
CVTJRECM EQU   CVTS01+520                                               01930000
CVTVEMS0 EQU   CVTS01+516                                               01931000
CVTSPFRR EQU   CVTS01+512                                               01932000
CVTRLSTG EQU   CVTS01+508                                               01933000
CVT0TC0A EQU   CVTS01+504                                               01934000
CVTGMBR  EQU   CVTS01+500                                               01935000
CVTLFRM  EQU   CVTS01+496                                               01936000
CVTRMBR  EQU   CVTS01+492                                               01937000
CVTVIOP  EQU   CVTS01+488                                               01938000
CVTRV307 EQU   CVTS01+486                                               01939000
CVTRV306 EQU   CVTS01+484                                               01940000
CVTRV305 EQU   CVTS01+482                                               01941000
CVTRV304 EQU   CVTS01+480                                               01942000
CVTRV303 EQU   CVTS01+478                                               01943000
CVTRV302 EQU   CVTS01+476                                               01944000
CVTTRCA  EQU   CVTS01+472                                               01945000
CVTRV297 EQU   CVTRV289                                                 01946000
CVTRV296 EQU   CVTRV289                                                 01947000
CVTRV295 EQU   CVTRV289                                                 01948000
CVTRV294 EQU   CVTRV289                                                 01949000
CVTRV293 EQU   CVTRV289                                                 01950000
CVTRV292 EQU   CVTRV289                                                 01951000
CVTRV291 EQU   CVTRV289                                                 01952000
CVTRV290 EQU   CVTRV289                                                 01953000
CVTRV288 EQU   CVTRV280                                                 01954000
CVTRV287 EQU   CVTRV280                                                 01955000
CVTRV286 EQU   CVTRV280                                                 01956000
CVTRV285 EQU   CVTRV280                                                 01957000
CVTRV284 EQU   CVTRV280                                                 01958000
CVTRV283 EQU   CVTRV280                                                 01959000
CVTRV282 EQU   CVTRV280                                                 01960000
CVTRV281 EQU   CVTRV280                                                 01961000
CVTRV279 EQU   CVTRV271                                                 01962000
CVTRV278 EQU   CVTRV271                                                 01963000
CVTRV277 EQU   CVTRV271                                                 01964000
CVTRV276 EQU   CVTRV271                                                 01965000
CVTRV275 EQU   CVTRV271                                                 01966000
CVTRV274 EQU   CVTRV271                                                 01967000
CVTRV273 EQU   CVTRV271                                                 01968000
CVTRV272 EQU   CVTRV271                                                 01969000
CVTRV270 EQU   CVTRV262                                                 01970000
CVTRV269 EQU   CVTRV262                                                 01971000
CVTRV268 EQU   CVTRV262                                                 01972000
CVTRV267 EQU   CVTRV262                                                 01973000
CVTRV266 EQU   CVTRV262                                                 01974000
CVTRV265 EQU   CVTRV262                                                 01975000
CVTRV264 EQU   CVTRV262                                                 01976000
CVTRV263 EQU   CVTRV262                                                 01977000
CVTVFP   EQU   CVTS01+464                                               01978000
CVTVSI   EQU   CVTS01+460                                               01979000
CVTVPSIB EQU   CVTS01+456                                               01980000
CVTMFACT EQU   CVTMFRTR                                                 01981000
CVTMFCTL EQU   CVTS01+448                                               01982000
CVTPVBP  EQU   CVTS01+444                                               01983000
CVTPWI   EQU   CVTS01+440                                               01984000
CVTRV254 EQU   CVTS01+438                                               01985000
CVTRV253 EQU   CVTS01+436                                               01986000
CVTRV252 EQU   CVTS01+434                                               01987000
CVTRV251 EQU   CVTS01+433                                               01988000
CVTRV250 EQU   CVTS01+432                                               01989000
CVTRV249 EQU   CVTS01+431                                               01990000
CVTRV248 EQU   CVTS01+430                                               01991000
CVTRV247 EQU   CVTS01+429                                               01992000
CVTRV246 EQU   CVTS01+428                                               01993000
CVTRV245 EQU   CVTRV237                                                 01994000
CVTRV244 EQU   CVTRV237                                                 01995000
CVTRV243 EQU   CVTRV237                                                 01996000
CVTRV242 EQU   CVTRV237                                                 01997000
CVTRV241 EQU   CVTRV237                                                 01998000
CVTRV240 EQU   CVTRV237                                                 01999000
CVTRV239 EQU   CVTRV237                                                 02000000
CVTRV238 EQU   CVTRV237                                                 02001000
CVTRV236 EQU   CVTRV228                                                 02002000
CVTRV235 EQU   CVTRV228                                                 02003000
CVTRV234 EQU   CVTRV228                                                 02004000
CVTRV233 EQU   CVTRV228                                                 02005000
CVTRV232 EQU   CVTRV228                                                 02006000
CVTRV231 EQU   CVTRV228                                                 02007000
CVTRV230 EQU   CVTRV228                                                 02008000
CVTRV229 EQU   CVTRV228                                                 02009000
CVTRV227 EQU   CVTRV219                                                 02010000
CVTRV226 EQU   CVTRV219                                                 02011000
CVTRV225 EQU   CVTRV219                                                 02012000
CVTRV224 EQU   CVTRV219                                                 02013000
CVTRV223 EQU   CVTRV219                                                 02014000
CVTRV222 EQU   CVTRV219                                                 02015000
CVTRV221 EQU   CVTRV219                                                 02016000
CVTRV220 EQU   CVTRV219                                                 02017000
CVTRV218 EQU   CVTRV210                                                 02018000
CVTRV217 EQU   CVTRV210                                                 02019000
CVTRV216 EQU   CVTRV210                                                 02020000
CVTRV215 EQU   CVTRV210                                                 02021000
CVTRV214 EQU   CVTRV210                                                 02022000
CVTRV213 EQU   CVTRV210                                                 02023000
CVTRV212 EQU   CVTRV210                                                 02024000
CVTRV211 EQU   CVTRV210                                                 02025000
CVTLCCAT EQU   CVTS01+420                                               02026000
CVTPCCAT EQU   CVTS01+416                                               02027000
CVTIPCRP EQU   CVTS01+412                                               02028000
CVTIPCRI EQU   CVTS01+408                                               02029000
CVTIPCDS EQU   CVTS01+404                                               02030000
CVTAIDVT EQU   CVTS01+400                                               02031000
CVTSSAP  EQU   CVTS01+396                                               02032000
CVTEHCIR EQU   CVTS01+392                                               02033000
CVTEHDEF EQU   CVTS01+388                                               02034000
CVTDAIR  EQU   CVTS01+384                                               02035000
CVTPERFM EQU   CVTS01+380                                               02036000
CVT044R2 EQU   CVTS01+376                                               02037000
CVTFETCH EQU   CVTS01+372                                               02038000
CVTRSTWD EQU   CVTS01+368                                               02039000
CVTSPOST EQU   CVTS01+364                                               02040000
CVTIOBP  EQU   CVTS01+360                                               02041000
CVTASMVT EQU   CVTS01+356                                               02042000
CVTRECRQ EQU   CVTS01+352                                               02043000
CVTWSAC  EQU   CVTS01+348                                               02044000
CVTRV149 EQU   CVTS01+344                                               02045000
CVTWSAL  EQU   CVTS01+340                                               02046000
CVTSPSA  EQU   CVTS01+336                                               02047000
CVTGLMN  EQU   CVTS01+332                                               02048000
CVTVEAC0 EQU   CVTS01+328                                               02049000
CVTRPOST EQU   CVTS01+320                                               02050000
CVTDQIQE EQU   CVTS01+316                                               02051000
CVTCSD   EQU   CVTS01+312                                               02052000
CVTLKRMA EQU   CVTS01+308                                               02053000
CVTRSPIE EQU   CVTS01+304                                               02054000
CVTRENQ  EQU   CVTS01+300                                               02055000
CVTLQCB  EQU   CVTS01+296                                               02056000
CVTFQCB  EQU   CVTS01+292                                               02057000
CVTQCS01 EQU   CVTS01+288                                               02058000
CVTAPFT  EQU   CVTS01+284                                               02059000
CVTPARRL EQU   CVTS01+280                                               02060000
CVTVWAIT EQU   CVTS01+276                                               02061000
CVTGSPL  EQU   CVTS01+272                                               02062000
CVTLSMQ  EQU   CVTS01+268                                               02063000
CVTGSMQ  EQU   CVTS01+264                                               02064000
CVTOPCTP EQU   CVTS01+256                                               02065000
CVTSIC   EQU   CVTS01+252                                               02066000
CVTTPIOS EQU   CVTS01+248                                               02067000
CVTRTMS  EQU   CVTS01+244                                               02068000
CVTSDBF  EQU   CVTS01+240                                               02069000
CVTSDMP  EQU   CVTS01+232                                               02070000
CVTSV60  EQU   CVTS01+228                                               02071000
CVTRTMCT EQU   CVTS01+224                                               02072000
CVTASCBL EQU   CVTS01+220                                               02073000
CVTASCBH EQU   CVTS01+216                                               02074000
CVTGDA   EQU   CVTS01+212                                               02075000
CVTASVT  EQU   CVTS01+208                                               02076000
CVTVVMDI EQU   CVTS01+204                                               02077000
CVTAQTOP EQU   CVTS01+200                                               02078000
CVTIOSCS EQU   CVTS01+196                                               02079000
CVTSDRM  EQU   CVTS01+192                                               02080000
CVTOPTE  EQU   CVTS01+188                                               02081000
CVTQUIS  EQU   CVTS01+180                                               02082000
CVTPARS  EQU   CVTS01+176                                               02083000
CVTS1EE  EQU   CVTS01+172                                               02084000
CVTFRAS  EQU   CVTS01+168                                               02085000
CVTCRAS  EQU   CVTS01+160                                               02086000
CVTDELCP EQU   CVTS01+152                                               02087000
CVTFRECL EQU   CVTS01+148                                               02088000
CVTGETCL EQU   CVTS01+144                                               02089000
CVTBLDCP EQU   CVTS01+140                                               02090000
CVTAUTHL EQU   CVTS01+136                                               02091000
CVTSCAN  EQU   CVTS01+132                                               02092000
CVTRV144 EQU   CVTS01+130                                               02093000
CVTMAXMP EQU   CVTS01+128                                               02094000
CVTSTCK  EQU   CVTS01+124                                               02095000
CVTRV139 EQU   CVTS01+123                                               02096000
CVTDSSAC EQU   CVTS01+122                                               02097000
CVTRV513 EQU   CVTS01+121                                               02098000
CVTIOSPL EQU   CVTS01+120                                               02099000
CVTPTGT  EQU   CVTS01+116                                               02100000
CVTCSPIE EQU   CVTS01+112                                               02101000
CVTSMFEX EQU   CVTS01+108                                               02102000
CVTOLT0A EQU   CVTS01+104                                               02103000
CVTSRBRT EQU   CVTS01+100                                               02104000
CVTPUTL  EQU   CVTS01+96                                                02105000
CVTASCRL EQU   CVTS01+92                                                02106000
CVTASCRF EQU   CVTS01+88                                                02107000
CVTRV326 EQU   CVTS01+84                                                02108000
CVTRV325 EQU   CVTS01+80                                                02109000
CVTRV324 EQU   CVTS01+76                                                02110000
CVT0VL01 EQU   CVTS01+72                                                02111000
CVTSHRVM EQU   CVTS01+68                                                02112000
CVTRV332 EQU   CVTS01+64                                                02113000
CVTTAS   EQU   CVTS01+60                                                02114000
CVTRSCN  EQU   CVTS01+56                                                02115000
CVTTRAC2 EQU   CVTS01+54                                                02116000
CVTTRACE EQU   CVTS01+52                                                02117000
CVTAPG   EQU   CVTS01+51                                                02118000
CVTSDTRC EQU   CVTCTLFG                                                 02119000
CVTGTRCE EQU   CVTCTLFG                                                 02120000
CVTNOMP  EQU   CVTCTLFG                                                 02121000
CVTRSV79 EQU   CVTCTLFG                                                 02122000
CVTDSTAT EQU   CVTCTLFG                                                 02123000
CVTRSV78 EQU   CVTCTLFG                                                 02124000
CVTRV333 EQU   CVTCTLFG                                                 02125000
CVTRV323 EQU   CVTCTLFG                                                 02126000
CVTSPVLK EQU   CVTS01+49                                                02127000
CVTRSV77 EQU   CVTS01+48                                                02128000
CVTRV331 EQU   CVTS01+44                                                02129000
CVTRV330 EQU   CVTS01+40                                                02130000
CVTRV329 EQU   CVTS01+36                                                02131000
CVTRV328 EQU   CVTS01+32                                                02132000
CVTRV322 EQU   CVTS01+28                                                02133000
CVTSLID  EQU   CVTSLIDA+1                                               02134000
CVTSYLK  EQU   CVTSLIDA                                                 02135000
CVTRV321 EQU   CVTS01+20                                                02136000
CVTRV320 EQU   CVTS01+16                                                02137000
CVTLPDIR EQU   CVTLPDIA+1                                               02138000
CVTRSV69 EQU   CVTDIRST                                                 02139000
CVTRSV68 EQU   CVTDIRST                                                 02140000
CVTRSV67 EQU   CVTDIRST                                                 02141000
CVTRSV66 EQU   CVTDIRST                                                 02142000
CVTRSV65 EQU   CVTDIRST                                                 02143000
CVTRSV64 EQU   CVTDIRST                                                 02144000
CVTRSV63 EQU   CVTDIRST                                                 02145000
CVTDICOM EQU   CVTDIRST                                                 02146000
CVTPVTP  EQU   CVTS01+8                                                 02147000
CVTLPDSR EQU   CVTS01+4                                                 02148000
CVTGETL  EQU   CVTS01                                                   02149000
WSALACHP EQU   WSAL+56                                                  02150000
WSALRSM  EQU   WSAL+52                                                  02151000
WSALEVNT EQU   WSAL+48                                                  02152000
WSALSTAE EQU   WSAL+44                                                  02153000
WSALSTAT EQU   WSAL+40                                                  02154000
WSALWAIT EQU   WSAL+36                                                  02155000
WSALPOST EQU   WSAL+32                                                  02156000
WSALS2EE EQU   WSAL+24                                                  02157000
WSALCIRB EQU   WSAL+20                                                  02158000
WSALABTM EQU   WSAL+16                                                  02159000
WSALSDMP EQU   WSAL+12                                                  02160000
WSALRTM2 EQU   WSAL+8                                                   02161000
WSALVALC EQU   WSAL+4                                                   02162000
WSALCWSA EQU   WSAL                                                     02163000
ASXBEND  EQU   ASXB+232                                                 02164000
ASXBRV25 EQU   ASXB+228                                                 02165000
ASXBRV24 EQU   ASXB+224                                                 02166000
ASXBPT0E EQU   ASXB+220                                                 02167000
ASXBCRB4 EQU   ASXBCASW+3                                               02168000
ASXBCRB3 EQU   ASXBCASW+2                                               02169000
ASXBCRB2 EQU   ASXBCASW+1                                               02170000
ASXBCR06 EQU   ASXBCRB1                                                 02171000
ASXBCR05 EQU   ASXBCRB1                                                 02172000
ASXBCR04 EQU   ASXBCRB1                                                 02173000
ASXBCR03 EQU   ASXBCRB1                                                 02174000
ASXBCR02 EQU   ASXBCRB1                                                 02175000
ASXBCR01 EQU   ASXBCRB1                                                 02176000
ASXBTFD  EQU   ASXBCRB1                                                 02177000
ASXBPIP  EQU   ASXBCRB1                                                 02178000
ASXBCTDC EQU   ASXB+212                                                 02179000
ASXBTDCB EQU   ASXB+208                                                 02180000
ASXBRV19 EQU   ASXB+204                                                 02181000
ASXBSENV EQU   ASXBSECR+1                                               02182000
ASXBRV34 EQU   ASCBSFLG                                                 02183000
ASXBRV33 EQU   ASCBSFLG                                                 02184000
ASXBRV32 EQU   ASCBSFLG                                                 02185000
ASXBRV31 EQU   ASCBSFLG                                                 02186000
ASXBRV30 EQU   ASCBSFLG                                                 02187000
ASXBRV29 EQU   ASCBSFLG                                                 02188000
ASXBRV28 EQU   ASCBSFLG                                                 02189000
ASXBRV27 EQU   ASCBSFLG                                                 02190000
ASXBUSER EQU   ASXB+192                                                 02191000
ASXBLSRB EQU   ASXBAEQ+20                                               02192000
ASXBFSRB EQU   ASXBAEQ+16                                               02193000
ASXBLRQE EQU   ASXBAEQ+12                                               02194000
ASXBFRQE EQU   ASXBAEQ+8                                                02195000
ASXBLIQE EQU   ASXBAEQ+4                                                02196000
ASXBFIQE EQU   ASXBAEQ                                                  02197000
ASXBETSK EQU   ASXB+164                                                 02198000
ASXBSIRB EQU   ASXB+160                                                 02199000
ASXBPSWD EQU   ASXB+152                                                 02200000
ASXBPRG  EQU   ASXB+136                                                 02201000
ASXBRV26 EQU   ASXB+132                                                 02202000
ASXBOUSB EQU   ASXB+128                                                 02203000
ASXBDDR  EQU   ASXB+124                                                 02204000
ASXBRCTD EQU   ASXB+120                                                 02205000
ASXBRSMD EQU   ASXB+116                                                 02206000
ASXBFRWA EQU   ASXB+108                                                 02207000
ASXBFLSA EQU   ASXB+36                                                  02208000
ASXBIHSA EQU   ASXB+32                                                  02209000
ASXBRV15 EQU   ASXB+28                                                  02210000
ASXBRV14 EQU   ASXB+24                                                  02211000
ASXBLWA  EQU   ASXB+20                                                  02212000
ASXBMPST EQU   ASXB+16                                                  02213000
ASXBRS00 EQU   ASXB+14                                                  02214000
ASXBTCBS EQU   ASXB+12                                                  02215000
ASXBLTCB EQU   ASXB+8                                                   02216000
ASXBFTCB EQU   ASXB+4                                                   02217000
ASXBASXB EQU   ASXB                                                     02218000
ASXBEGIN EQU   ASXB                                                     02219000
ASCBEND  EQU   ASCB+208                                                 02220000
ASCBSRBT EQU   ASCB+200                                                 02221000
ASCBSWTL EQU   ASCB+196                                                 02222000
ASCBRS14 EQU   ASCB+195                                                 02223000
ASCBSMCT EQU   ASCB+194                                                 02224000
ASCBRS12 EQU   ASCB+192                                                 02225000
ASCBPCTT EQU   ASCB+188                                                 02226000
ASCBVGTT EQU   ASCB+184                                                 02227000
ASCBRV43 EQU   ASCBSRQ4                                                 02228000
ASCBRV42 EQU   ASCBSRQ4                                                 02229000
ASCBRV41 EQU   ASCBSRQ4                                                 02230000
ASCBRV40 EQU   ASCBSRQ4                                                 02231000
ASCBRV39 EQU   ASCBSRQ4                                                 02232000
ASCBRV38 EQU   ASCBSRQ4                                                 02233000
ASCBRV37 EQU   ASCBSRQ4                                                 02234000
ASCBRV36 EQU   ASCBSRQ4                                                 02235000
ASCBRV35 EQU   ASCBSRQ3                                                 02236000
ASCBRV34 EQU   ASCBSRQ3                                                 02237000
ASCBRV33 EQU   ASCBSRQ3                                                 02238000
ASCBRV32 EQU   ASCBSRQ3                                                 02239000
ASCBRV31 EQU   ASCBSRQ3                                                 02240000
ASCBRV30 EQU   ASCBSRQ3                                                 02241000
ASCBRV29 EQU   ASCBSRQ3                                                 02242000
ASCBRV28 EQU   ASCBSRQ3                                                 02243000
ASCBRV27 EQU   ASCBSRQ2                                                 02244000
ASCBRV26 EQU   ASCBSRQ2                                                 02245000
ASCBRV25 EQU   ASCBSRQ2                                                 02246000
ASCBRV24 EQU   ASCBSRQ2                                                 02247000
ASCBRV23 EQU   ASCBSRQ2                                                 02248000
ASCBRV22 EQU   ASCBSRQ2                                                 02249000
ASCBRV21 EQU   ASCBSRQ2                                                 02250000
ASCBRV20 EQU   ASCBSRQ2                                                 02251000
ASCBRV19 EQU   ASCBSRQ1                                                 02252000
ASCBRV18 EQU   ASCBSRQ1                                                 02253000
ASCBRV17 EQU   ASCBSRQ1                                                 02254000
ASCBRV16 EQU   ASCBSRQ1                                                 02255000
ASCBRV15 EQU   ASCBSRQ1                                                 02256000
ASCBRV14 EQU   ASCBSRQ1                                                 02257000
ASCBRV13 EQU   ASCBSRQ1                                                 02258000
ASCBSTA  EQU   ASCBSRQ1                                                 02259000
ASCBJBNS EQU   ASCB+176                                                 02260000
ASCBJBNI EQU   ASCB+172                                                 02261000
ASCBMCC  EQU   ASCB+168                                                 02262000
ASCBRTWA EQU   ASCB+164                                                 02263000
ASCBIQEA EQU   ASCB+160                                                 02264000
ASCBXMPQ EQU   ASCB+156                                                 02265000
ASCBRS01 EQU   ASCB+154                                                 02266000
ASCBFMCT EQU   ASCB+152                                                 02267000
ASCBOUXB EQU   ASCB+148                                                 02268000
ASCBOUCB EQU   ASCB+144                                                 02269000
ASCBMECB EQU   ASCB+140                                                 02270000
ASCBQECB EQU   ASCB+136                                                 02271000
ASCBLSQH EQU   ASCBLKGP+4                                               02272000
ASCBLOCK EQU   ASCBLKGP                                                 02273000
ASCBNVSC EQU   ASCB+122                                                 02274000
ASCBVSC  EQU   ASCB+120                                                 02275000
ASCBSRBS EQU   ASCB+118                                                 02276000
ASCBSSRB EQU   ASCB+116                                                 02277000
ASCBRV06 EQU   ASCBFLG2                                                 02278000
ASCBRV05 EQU   ASCBFLG2                                                 02279000
ASCBRV04 EQU   ASCBFLG2                                                 02280000
ASCBSNQS EQU   ASCBFLG2                                                 02281000
ASCBS2S  EQU   ASCBFLG2                                                 02282000
ASCBCEXT EQU   ASCBFLG2                                                 02283000
ASCBPXMT EQU   ASCBFLG2                                                 02284000
ASCBXMPT EQU   ASCBFLG2                                                 02285000
ASCBRF07 EQU   ASCBDSP1                                                 02286000
ASCBRF06 EQU   ASCBDSP1                                                 02287000
ASCBRF05 EQU   ASCBDSP1                                                 02288000
ASCBRF04 EQU   ASCBDSP1                                                 02289000
ASCBRF03 EQU   ASCBDSP1                                                 02290000
ASCBRF02 EQU   ASCBDSP1                                                 02291000
ASCBFAIL EQU   ASCBDSP1                                                 02292000
ASCBNOQ  EQU   ASCBDSP1                                                 02293000
ASCBSWCT EQU   ASCB+112                                                 02294000
ASCBTMCH EQU   ASCB+104                                                 02295000
ASCBNSWP EQU   ASCBFLG1                                                 02296000
ASCBSTND EQU   ASCBFLG1                                                 02297000
ASCBABNT EQU   ASCBFLG1                                                 02298000
ASCBTERM EQU   ASCBFLG1                                                 02299000
ASCBS3S  EQU   ASCBFLG1                                                 02300000
ASCBCMSH EQU   ASCBFLG1                                                 02301000
ASCBTOFF EQU   ASCBFLG1                                                 02302000
ASCBRF01 EQU   ASCBRCTF                                                 02303000
ASCBTMLW EQU   ASCBRCTF                                                 02304000
ASCBOUT  EQU   ASCBRCTF                                                 02305000
ASCBWAIT EQU   ASCBRCTF                                                 02306000
ASCBRV08 EQU   ASCBRCTF                                                 02307000
ASCBFQU  EQU   ASCBRCTF                                                 02308000
ASCBFRS  EQU   ASCBRCTF                                                 02309000
ASCBTMNO EQU   ASCBRCTF                                                 02310000
ASCBAFFN EQU   ASCBFW1                                                  02311000
ASCBDUMP EQU   ASCB+96                                                  02312000
ASCBRV44 EQU   ASCB+92                                                  02313000
ASCBUBET EQU   ASCB+88                                                  02314000
ASCBECB  EQU   ASCB+84                                                  02315000
ASCBJSTL EQU   ASCB+80                                                  02316000
ASCBEWST EQU   ASCB+72                                                  02317000
ASCBEJST EQU   ASCB+64                                                  02318000
ASCBTSB  EQU   ASCB+60                                                  02319000
ASCBCSCB EQU   ASCB+56                                                  02320000
ASCBRSMA EQU   ASCBRSM+1                                                02321000
ASCBRV54 EQU   ASCBRSMF                                                 02322000
ASCBRV53 EQU   ASCBRSMF                                                 02323000
ASCBRV52 EQU   ASCBRSMF                                                 02324000
ASCBRV51 EQU   ASCBRSMF                                                 02325000
ASCBVEQR EQU   ASCBRSMF                                                 02326000
ASCBN2LP EQU   ASCBRSMF                                                 02327000
ASCB1LPU EQU   ASCBRSMF                                                 02328000
ASCB2LPU EQU   ASCBRSMF                                                 02329000
ASCBLDA  EQU   ASCB+48                                                  02330000
ASCBSTOR EQU   ASCB+44                                                  02331000
ASCBDP   EQU   ASCB+43                                                  02332000
ASCBRV07 EQU   ASCB+42                                                  02333000
ASCBIOSM EQU   ASCB+40                                                  02334000
ASCBSEQN EQU   ASCB+38                                                  02335000
ASCBASID EQU   ASCB+36                                                  02336000
ASCBCPUS EQU   ASCB+32                                                  02337000
ASCBSPL  EQU   ASCB+28                                                  02338000
ASCBIOSP EQU   ASCB+24                                                  02339000
ASCBCMSF EQU   ASCB+12                                                  02340000
ASCBBWDP EQU   ASCB+8                                                   02341000
ASCBFWDP EQU   ASCB+4                                                   02342000
ASCBASCB EQU   ASCB                                                     02343000
ASCBEGIN EQU   ASCB                                                     02344000
MBCBBUFF EQU   MBCB+232                                                 02345000
MBCBSVRB EQU   MBCB+8                                                   02346000
PIEGR2   EQU   PIE+28                                                   02347000
PIEGR1   EQU   PIE+24                                                   02348000
PIEGR15  EQU   PIE+16                                                   02349000
@NM00041 EQU   PIEFLGS                                                  02350000
SCASRB   EQU   SCA+32                                                   02351000
SCAFRPPQ EQU   SCA+28                                                   02352000
SCARPPTR EQU   SCA+24                                                   02353000
SCAPARMS EQU   SCA+8                                                    02354000
SCARESV  EQU   SCA+5                                                    02355000
SCAPMASK EQU   SCA+4                                                    02356000
IQEOUTLM EQU   IQESECT+20                                               02357000
IQEDCB   EQU   IQESECT+16                                               02358000
IQETCBA  EQU   IQETCB+1                                                 02359000
IQESTAT2 EQU   IQETCB                                                   02360000
IQEIRBA  EQU   IQEIRB+1                                                 02361000
@NM00040 EQU   IQEFLAGS                                                 02362000
@NM00039 EQU   IQEFLAGS                                                 02363000
@NM00038 EQU   IQEFLAGS                                                 02364000
@NM00037 EQU   IQEFLAGS                                                 02365000
@NM00036 EQU   IQEFLAGS                                                 02366000
@NM00035 EQU   IQEFLAGS                                                 02367000
@NM00034 EQU   IQEFLAGS                                                 02368000
IQEPURGE EQU   IQEFLAGS                                                 02369000
IQEPARAM EQU   IQESECT+4                                                02370000
IQESTAT1 EQU   IQELNK                                                   02371000
SVRBEND  EQU   RBSECT+192                                               02372000
RBFEPARM EQU   RBSECT+168                                               02373000
SIRBEND  EQU   RBSECT+168                                               02374000
RBRSV158 EQU   RBRSV150                                                 02375000
RBRSV157 EQU   RBRSV150                                                 02376000
RBRSV156 EQU   RBRSV150                                                 02377000
RBRSV155 EQU   RBRSV150                                                 02378000
RBRSV154 EQU   RBRSV150                                                 02379000
RBRSV153 EQU   RBRSV150                                                 02380000
RBRSV152 EQU   RBRSV150                                                 02381000
RBRSV151 EQU   RBRSV150                                                 02382000
RBRSV149 EQU   RBSECT+166                                               02383000
RBRSV148 EQU   RBSECT+164                                               02384000
RBRSV169 EQU   RBSDATA+3                                                02385000
RBSID    EQU   RBSDATA+2                                                02386000
RBSPKEY  EQU   RBSDATA+1                                                02387000
RBRSV168 EQU   RBSFLG3                                                  02388000
RBSTERMO EQU   RBSFLG3                                                  02389000
RBSBRNTR EQU   RBSFLG3                                                  02390000
RBSPRNTR EQU   RBSFLG3                                                  02391000
RBSCNCEL EQU   RBSFLG3                                                  02392000
RBSRECRD EQU   RBSFLG3                                                  02393000
RBSTERMI EQU   RBSFLG3                                                  02394000
RBRSV167 EQU   RBSFLG3                                                  02395000
RBSOWNRA EQU   RBSOWNR+1                                                02396000
RBSSUPER EQU   RBSFLGS2                                                 02397000
RBSKEY0  EQU   RBSFLGS2                                                 02398000
RBRSV166 EQU   RBSFLGS2                                                 02399000
RBRSV165 EQU   RBSFLGS2                                                 02400000
RBSINUSE EQU   RBSFLGS2                                                 02401000
RBRSV164 EQU   RBSFLGS2                                                 02402000
RBSXCTL2 EQU   RBSFLGS2                                                 02403000
RBRSV163 EQU   RBSFLGS2                                                 02404000
RBSPARMA EQU   RBSPARM+1                                                02405000
RBSHALT  EQU   RBSIOPRC                                                 02406000
RBSNOIOP EQU   RBSIOPRC                                                 02407000
RBSASYNC EQU   RBSFLGS1                                                 02408000
RBRSV162 EQU   RBSFLGS1                                                 02409000
RBSESTAE EQU   RBSFLGS1                                                 02410000
RBSDUMMY EQU   RBSFLGS1                                                 02411000
RBSSTAR  EQU   RBSFLGS1                                                 02412000
RBSSTAI  EQU   RBSFLGS1                                                 02413000
RBSEXIT  EQU   RBSCBB+4                                                 02414000
RBSCHAIN EQU   RBSCBB                                                   02415000
TIRBEND  EQU   @NM00032+8                                               02416000
PRBEND   EQU   @NM00032+8                                               02417000
RBRSV146 EQU   RBRSV138                                                 02418000
RBRSV145 EQU   RBRSV138                                                 02419000
RBRSV144 EQU   RBRSV138                                                 02420000
RBRSV143 EQU   RBRSV138                                                 02421000
RBRSV142 EQU   RBRSV138                                                 02422000
RBRSV141 EQU   RBRSV138                                                 02423000
RBRSV140 EQU   RBRSV138                                                 02424000
RBRSV139 EQU   RBRSV138                                                 02425000
RBRSV137 EQU   @NM00032+6                                               02426000
RBRSV136 EQU   @NM00032+4                                               02427000
RBRSV135 EQU   @NM00032                                                 02428000
@NM00031 EQU   RBSECT+32                                                02429000
@NM00030 EQU   @NM00028+1                                               02430000
RBSCF    EQU   @NM00029                                                 02431000
RBPGMQ1  EQU   RBPGMQ+1                                                 02432000
@NM00027 EQU   RBPGMQ                                                   02433000
@NM00026 EQU   RBSECT+16                                                02434000
@NM00025 EQU   @NM00021                                                 02435000
@NM00024 EQU   @NM00021                                                 02436000
RBUSIQE  EQU   RBETXR                                                   02437000
@NM00023 EQU   @NM00021                                                 02438000
@NM00022 EQU   @NM00021                                                 02439000
RBPMSVRB EQU   @NM00019                                                 02440000
@NM00020 EQU   @NM00019                                                 02441000
RBWAITP  EQU   @NM00019                                                 02442000
RBFNSVRB EQU   RBTRSVRB                                                 02443000
RBABOPSW EQU   RBSECT+4                                                 02444000
@NM00017 EQU   RBPPSAV                                                  02445000
RBPRFXND EQU   RBPREFIX+64                                              02446000
RBINTCOD EQU   RBINTCDA+1                                               02447000
RBINLNTH EQU   RBINTCDA                                                 02448000
RBWCSA   EQU   RBPREFIX+60                                              02449000
RBRSV004 EQU   RBPREFIX+57                                              02450000
RBSSSYN  EQU   RBFLAGS1                                                 02451000
RBLONGWT EQU   RBFLAGS1                                                 02452000
RBASIR   EQU   RBFLAGS1                                                 02453000
RBRSV159 EQU   RBFLAGS1                                                 02454000
RBABEND  EQU   RBFLAGS1                                                 02455000
RBXWAIT  EQU   RBFLAGS1                                                 02456000
RBSLOCK  EQU   RBFLAGS1                                                 02457000
RBRTRAN  EQU   RBRTPSW2+4                                               02458000
RBRTINCD EQU   RBRTICIL+2                                               02459000
RBRTILC  EQU   RBRTICIL+1                                               02460000
RBRSV160 EQU   RBRTICIL                                                 02461000
RBRTPSW1 EQU   RBRTOPSW                                                 02462000
RBRSV062 EQU   RBRSV054                                                 02463000
RBRSV061 EQU   RBRSV054                                                 02464000
RBRSV060 EQU   RBRSV054                                                 02465000
RBRSV059 EQU   RBRSV054                                                 02466000
RBRSV058 EQU   RBRSV054                                                 02467000
RBRSV057 EQU   RBRSV054                                                 02468000
RBRSV056 EQU   RBRSV054                                                 02469000
RBRSV055 EQU   RBRSV054                                                 02470000
RBRSV053 EQU   RBPREFIX+38                                              02471000
RBRSV052 EQU   RBPREFIX+36                                              02472000
RBRSV051 EQU   RBPREFIX+32                                              02473000
RBRSV050 EQU   RBPREFIX+28                                              02474000
RBRSV049 EQU   RBRSV041                                                 02475000
RBRSV048 EQU   RBRSV041                                                 02476000
RBRSV047 EQU   RBRSV041                                                 02477000
RBRSV046 EQU   RBRSV041                                                 02478000
RBRSV045 EQU   RBRSV041                                                 02479000
RBRSV044 EQU   RBRSV041                                                 02480000
RBRSV043 EQU   RBRSV041                                                 02481000
RBRSV042 EQU   RBRSV041                                                 02482000
RBRSV040 EQU   RBPREFIX+26                                              02483000
RBRSV039 EQU   RBPREFIX+24                                              02484000
RBRSV038 EQU   RBPREFIX+20                                              02485000
RBRSV037 EQU   RBPREFIX+16                                              02486000
RBRSV036 EQU   RBRSV028                                                 02487000
RBRSV035 EQU   RBRSV028                                                 02488000
RBRSV034 EQU   RBRSV028                                                 02489000
RBRSV033 EQU   RBRSV028                                                 02490000
RBRSV032 EQU   RBRSV028                                                 02491000
RBRSV031 EQU   RBRSV028                                                 02492000
RBRSV030 EQU   RBRSV028                                                 02493000
RBRSV029 EQU   RBRSV028                                                 02494000
RBRSV027 EQU   RBRSV019                                                 02495000
RBRSV026 EQU   RBRSV019                                                 02496000
RBRSV025 EQU   RBRSV019                                                 02497000
RBRSV024 EQU   RBRSV019                                                 02498000
RBRSV023 EQU   RBRSV019                                                 02499000
RBRSV022 EQU   RBRSV019                                                 02500000
RBRSV021 EQU   RBRSV019                                                 02501000
RBRSV020 EQU   RBRSV019                                                 02502000
RBRSV018 EQU   RBPREFIX+13                                              02503000
RBRSV017 EQU   RBPREFIX+12                                              02504000
RBSRV016 EQU   RBPREFIX+11                                              02505000
RBRSV015 EQU   RBPREFIX+10                                              02506000
RBRSV014 EQU   RBPREFIX+8                                               02507000
RBRSV013 EQU   RBPREFIX+4                                               02508000
RBRSV012 EQU   RBPREFIX                                                 02509000
RBEXSAVE EQU   XRBESA                                                   02510000
XRBREG15 EQU   RBGRS15                                                  02511000
XRBREG14 EQU   RBGRS14                                                  02512000
XRBREG13 EQU   RBGRS13                                                  02513000
XRBREG12 EQU   RBGRS12                                                  02514000
XRBREG11 EQU   RBGRS11                                                  02515000
XRBREG10 EQU   RBGRS10                                                  02516000
XRBREG9  EQU   RBGRS9                                                   02517000
XRBREG8  EQU   RBGRS8                                                   02518000
XRBREG7  EQU   RBGRS7                                                   02519000
XRBREG6  EQU   RBGRS6                                                   02520000
XRBREG5  EQU   RBGRS5                                                   02521000
XRBREG4  EQU   RBGRS4                                                   02522000
XRBREG3  EQU   RBGRS3                                                   02523000
XRBREG2  EQU   RBGRS2                                                   02524000
XRBREG1  EQU   RBGRS1                                                   02525000
XRBREG0  EQU   RBGRS0                                                   02526000
XRBLNKA  EQU   RBLINKB                                                  02527000
XRBWT    EQU   RBWCF                                                    02528000
@NM00016 EQU   RBBASIC+24                                               02529000
RBOPSWPS EQU   RBOPSWB2                                                 02530000
@NM00015 EQU   RBOPSWB2                                                 02531000
@NM00014 EQU   XRBPSW                                                   02532000
@NM00013 EQU   RBBASIC+12                                               02533000
XRBWAIT  EQU   RBECBWT                                                  02534000
XRBFRRB  EQU   RBFDYN                                                   02535000
@NM00012 EQU   XSTAB2                                                   02536000
XRBACTV  EQU   RBFACTV                                                  02537000
XRBTCBP  EQU   RBTCBNXT                                                 02538000
@NM00011 EQU   XSTAB1                                                   02539000
XRBCKPT  EQU   RBFTCKPT                                                 02540000
@NM00010 EQU   XSTAB1                                                   02541000
@NM00009 EQU   RBBASIC+8                                                02542000
@NM00008 EQU   RBEXRTNM+1                                               02543000
RBTMIND3 EQU   RBTMFLD                                                  02544000
RBTMIND2 EQU   RBTMFLD                                                  02545000
RBTMCMP  EQU   RBTMFLD                                                  02546000
RBWLIM   EQU   RBTMFLD                                                  02547000
RBRSV005 EQU   RBTMFLD                                                  02548000
RBTMTOD  EQU   RBTMFLD                                                  02549000
RBTMQUE  EQU   RBTMFLD                                                  02550000
@NM00007 EQU   RBPRFX                                                   02551000
@NM00006 EQU   TCBXTNT2+32                                              02552000
TCBRV181 EQU   TCBRV173                                                 02553000
TCBRV180 EQU   TCBRV173                                                 02554000
TCBRV179 EQU   TCBRV173                                                 02555000
TCBRV178 EQU   TCBRV173                                                 02556000
TCBRV177 EQU   TCBRV173                                                 02557000
TCBRV176 EQU   TCBRV173                                                 02558000
TCBRV175 EQU   TCBRV173                                                 02559000
TCBRV174 EQU   TCBRV173                                                 02560000
TCBRV172 EQU   TCBRV164                                                 02561000
TCBRV171 EQU   TCBRV164                                                 02562000
TCBRV170 EQU   TCBRV164                                                 02563000
TCBRV169 EQU   TCBRV164                                                 02564000
TCBRV168 EQU   TCBRV164                                                 02565000
TCBRV167 EQU   TCBRV164                                                 02566000
TCBRV166 EQU   TCBRV164                                                 02567000
TCBRV165 EQU   TCBRV164                                                 02568000
TCBRV163 EQU   TCBRV155                                                 02569000
TCBRV162 EQU   TCBRV155                                                 02570000
TCBRV161 EQU   TCBRV155                                                 02571000
TCBRV160 EQU   TCBRV155                                                 02572000
TCBRV159 EQU   TCBRV155                                                 02573000
TCBRV158 EQU   TCBRV155                                                 02574000
TCBRV157 EQU   TCBRV155                                                 02575000
TCBRV156 EQU   TCBRV155                                                 02576000
TCBRV154 EQU   TCBRV146                                                 02577000
TCBRV153 EQU   TCBRV146                                                 02578000
TCBRV152 EQU   TCBRV146                                                 02579000
TCBRV151 EQU   TCBRV146                                                 02580000
TCBRV150 EQU   TCBRV146                                                 02581000
TCBRV149 EQU   TCBRV146                                                 02582000
TCBRV148 EQU   TCBRV146                                                 02583000
TCBRV147 EQU   TCBRV146                                                 02584000
TCBRV145 EQU   TCBXTNT2+26                                              02585000
TCBRV144 EQU   TCBXTNT2+24                                              02586000
TCBCAUF  EQU   TCBXTNT2+20                                              02587000
TCBRV142 EQU   TCBXTNT2+16                                              02588000
TCBRSV49 EQU   TCBXTNT2+12                                              02589000
TCBEVENT EQU   TCBXTNT2+8                                               02590000
TCBRCMP  EQU   TCBXTNT2+5                                               02591000
TCBRSVAB EQU   TCBXTNT2+4                                               02592000
TCBGTFA  EQU   TCBGTF+1                                                 02593000
TCBRSV47 EQU   TCBTFLG                                                  02594000
TCBRSV46 EQU   TCBTFLG                                                  02595000
TCBRSV45 EQU   TCBTFLG                                                  02596000
TCBRSV44 EQU   TCBTFLG                                                  02597000
TCBRSV43 EQU   TCBTFLG                                                  02598000
TCBDSPIT EQU   TCBTFLG                                                  02599000
TCBERRTN EQU   TCBTFLG                                                  02600000
TCBASYNC EQU   TCBTFLG                                                  02601000
@NM00005 EQU   TCB+296                                                  02602000
TCBSVCA2 EQU   TCB+292                                                  02603000
TCBSWASA EQU   TCB+288                                                  02604000
TCBDBTB  EQU   TCB+284                                                  02605000
TCBRPT   EQU   TCB+280                                                  02606000
TCBRV141 EQU   TCBRV133                                                 02607000
TCBRV140 EQU   TCBRV133                                                 02608000
TCBRV139 EQU   TCBRV133                                                 02609000
TCBRV138 EQU   TCBRV133                                                 02610000
TCBRV137 EQU   TCBRV133                                                 02611000
TCBRV136 EQU   TCBRV133                                                 02612000
TCBRV135 EQU   TCBRV133                                                 02613000
TCBRV134 EQU   TCBRV133                                                 02614000
TCBRV132 EQU   TCBRV124                                                 02615000
TCBRV131 EQU   TCBRV124                                                 02616000
TCBRV130 EQU   TCBRV124                                                 02617000
TCBRV129 EQU   TCBRV124                                                 02618000
TCBRV128 EQU   TCBRV124                                                 02619000
TCBRV127 EQU   TCBRV124                                                 02620000
TCBRV126 EQU   TCBRV124                                                 02621000
TCBRV125 EQU   TCBRV124                                                 02622000
TCBRV123 EQU   TCBFBYT2                                                 02623000
TCBRV122 EQU   TCBFBYT2                                                 02624000
TCBECBNV EQU   TCBFBYT2                                                 02625000
TCBSSSYN EQU   TCBFBYT2                                                 02626000
TCBFPRAP EQU   TCBFBYT2                                                 02627000
TCBFDW   EQU   TCBFBYT2                                                 02628000
TCBFMW   EQU   TCBFBYT2                                                 02629000
TCBCNCB  EQU   TCBFBYT2                                                 02630000
TCBLLH   EQU   TCBFBYT1                                                 02631000
TCBRV113 EQU   TCBFBYT1                                                 02632000
TCBRTM2  EQU   TCBFBYT1                                                 02633000
TCBPGNLY EQU   TCBFBYT1                                                 02634000
TCBNDIOS EQU   TCBFBYT1                                                 02635000
TCBRV327 EQU   TCBFBYT1                                                 02636000
TCBEOTFM EQU   TCBFBYT1                                                 02637000
TCBAFFN  EQU   TCB+274                                                  02638000
TCBRV326 EQU   TCB+272                                                  02639000
TCBUKYSP EQU   TCB+268                                                  02640000
TCBMODE  EQU   TCBESTAE+3                                               02641000
TCBERTYP EQU   TCBESTAE+2                                               02642000
TCBRV314 EQU   TCBESTRM                                                 02643000
TCBRV313 EQU   TCBESTRM                                                 02644000
TCBRV312 EQU   TCBESTRM                                                 02645000
TCBRV311 EQU   TCBESTRM                                                 02646000
TCBRV310 EQU   TCBESTRM                                                 02647000
TCBRV309 EQU   TCBESTRM                                                 02648000
TCBSTAFX EQU   TCBESTRM                                                 02649000
TCBETERM EQU   TCBESTRM                                                 02650000
TCBSCBKY EQU   TCBESTAE                                                 02651000
TCBRTM12 EQU   TCB+260                                                  02652000
TCBTCBID EQU   TCB+256                                                  02653000
TCBSTAWA EQU   TCB+252                                                  02654000
TCBSWA   EQU   TCB+248                                                  02655000
TCBFOEA  EQU   TCBFOE+1                                                 02656000
TCBRSV42 EQU   TCBFOE                                                   02657000
TCBCCPVI EQU   TCBXSCT+2                                                02658000
TCBRV325 EQU   TCBXSCT+1                                                02659000
TCBRV324 EQU   TCBXSCT1                                                 02660000
TCBRV323 EQU   TCBXSCT1                                                 02661000
TCBRV322 EQU   TCBXSCT1                                                 02662000
TCBRV321 EQU   TCBXSCT1                                                 02663000
TCBRV320 EQU   TCBXSCT1                                                 02664000
TCBRV319 EQU   TCBXSCT1                                                 02665000
TCBS3A   EQU   TCBXSCT1                                                 02666000
TCBACTIV EQU   TCBXSCT1                                                 02667000
TCBRSV41 EQU   TCB+239                                                  02668000
TCBTID   EQU   TCB+238                                                  02669000
TCBRSVAA EQU   TCB+237                                                  02670000
TCBABCUR EQU   TCB+236                                                  02671000
TCBTMSAV EQU   TCB+232                                                  02672000
TCBIOTIM EQU   TCB+228                                                  02673000
TCBRTWA  EQU   TCB+224                                                  02674000
TCBBACK  EQU   TCB+220                                                  02675000
TCBTIRB  EQU   TCB+216                                                  02676000
TCBAECB  EQU   TCB+212                                                  02677000
TCBEXT2A EQU   TCBEXT2+1                                                02678000
TCBRSV39 EQU   TCBEXT2                                                  02679000
TCBSTMCT EQU   TCB+207                                                  02680000
TCBSYSCT EQU   TCB+206                                                  02681000
TCBRSV37 EQU   TCB+205                                                  02682000
TCBEXSVC EQU   TCBDAR                                                   02683000
TCBDARMS EQU   TCBDAR                                                   02684000
TCBDARWT EQU   TCBDAR                                                   02685000
TCBDARO  EQU   TCBDAR                                                   02686000
TCBDARMC EQU   TCBDARC                                                  02687000
TCBDARD  EQU   TCBDAR                                                   02688000
TCBDARS  EQU   TCBDAR                                                   02689000
TCBDARP  EQU   TCBDAR                                                   02690000
TCBGTOFM EQU   TCBFLGS7                                                 02691000
TCBADMP  EQU   TCBFLGS7                                                 02692000
TCBRSTSK EQU   TCBFLGS7                                                 02693000
TCBSVCS  EQU   TCBFLGS7                                                 02694000
TCBSTACK EQU   TCBFLGS7                                                 02695000
TCBRSV34 EQU   TCBFLGS7                                                 02696000
TCBRSV33 EQU   TCBFLGS7                                                 02697000
TCBGPECB EQU   TCBFLGS7                                                 02698000
TCBNTJS  EQU   TCBFLGS6                                                 02699000
TCBAPG   EQU   TCBFLGS6                                                 02700000
TCBMIGR  EQU   TCBFLGS6                                                 02701000
TCBRV303 EQU   TCBFLGS6                                                 02702000
TCBSPVLK EQU   TCBFLGS6                                                 02703000
TCBCPU   EQU   TCBFLGS6                                                 02704000
TCBPIE17 EQU   TCBFLGS6                                                 02705000
TCBRV    EQU   TCBFLGS6                                                 02706000
TCBRSV79 EQU   TCBNDSP5                                                 02707000
TCBRSV78 EQU   TCBNDSP5                                                 02708000
TCBRSV77 EQU   TCBNDSP5                                                 02709000
TCBRSV76 EQU   TCBNDSP5                                                 02710000
TCBRSV75 EQU   TCBNDSP5                                                 02711000
TCBRSV74 EQU   TCBNDSP5                                                 02712000
TCBRSV95 EQU   TCBNDSP5                                                 02713000
TCBRSV94 EQU   TCBNDSP5                                                 02714000
TCBRSV93 EQU   TCBNDSP4                                                 02715000
TCBRSV92 EQU   TCBNDSP4                                                 02716000
TCBRSV91 EQU   TCBNDSP4                                                 02717000
TCBRSV90 EQU   TCBNDSP4                                                 02718000
TCBRSV89 EQU   TCBNDSP4                                                 02719000
TCBRSV88 EQU   TCBNDSP4                                                 02720000
TCBRSV87 EQU   TCBNDSP4                                                 02721000
TCBRSV86 EQU   TCBNDSP4                                                 02722000
TCBEXT1A EQU   TCBEXT1+1                                                02723000
TCBRSV32 EQU   TCBEXT1                                                  02724000
TCBEXCPD EQU   TCB+192                                                  02725000
TCBIOBRC EQU   TCB+188                                                  02726000
TCBDDWTC EQU   TCB+186                                                  02727000
TCBDDEXC EQU   TCB+184                                                  02728000
TCBJSCBB EQU   TCBJSCB+1                                                02729000
@NM00004 EQU   TCBRECDE                                                 02730000
TCBREC   EQU   TCBRECDE                                                 02731000
TCBMDIDS EQU   TCB+176                                                  02732000
TCBNDINT EQU   TCBNDSP3                                                 02733000
TCBRSV27 EQU   TCBNDSP3                                                 02734000
TCBRSV26 EQU   TCBNDSP3                                                 02735000
TCBRSV25 EQU   TCBNDSP3                                                 02736000
TCBRSV24 EQU   TCBNDSP3                                                 02737000
TCBSRBND EQU   TCBNDSP3                                                 02738000
TCBRV302 EQU   TCBNDSP3                                                 02739000
TCBLJSND EQU   TCBNDSP3                                                 02740000
TCBABE   EQU   TCBNDSP2                                                 02741000
TCBDSS   EQU   TCBNDSP2                                                 02742000
TCBOWAIT EQU   TCBNDSP2                                                 02743000
TCBIWAIT EQU   TCBNDSP2                                                 02744000
TCBNDTS  EQU   TCBNDSP2                                                 02745000
TCBNDSVC EQU   TCBNDSP2                                                 02746000
TCBABD   EQU   TCBNDSP2                                                 02747000
TCBRSV22 EQU   TCBNDSP1                                                 02748000
TCBPIEND EQU   TCBNDSP1                                                 02749000
TCBTPSP  EQU   TCBNDSP1                                                 02750000
TCBDDRND EQU   TCBNDSP1                                                 02751000
TCBRSPND EQU   TCBNDSP1                                                 02752000
TCBRSTND EQU   TCBNDSP1                                                 02753000
TCBDARPN EQU   TCBNDSP1                                                 02754000
TCBDARTN EQU   TCBNDSP1                                                 02755000
TCBNDSP0 EQU   TCBNDSP                                                  02756000
TCBUSER  EQU   TCB+168                                                  02757000
TCBTCTB  EQU   TCBTCT+1                                                 02758000
TCBRSV9C EQU   TCBTCTGF                                                 02759000
TCBRSV9B EQU   TCBTCTGF                                                 02760000
TCBRSV9A EQU   TCBTCTGF                                                 02761000
TCBRSV99 EQU   TCBTCTGF                                                 02762000
TCBRSV98 EQU   TCBTCTGF                                                 02763000
TCBRSV97 EQU   TCBTCTGF                                                 02764000
TCBRSV20 EQU   TCBTCTGF                                                 02765000
TCBSMFGF EQU   TCBTCTGF                                                 02766000
TCBSTABB EQU   TCBSTAB+1                                                02767000
TCBSTCUR EQU   TCBNSTAE                                                 02768000
TCBRV301 EQU   TCBNSTAE                                                 02769000
TCBSYNCH EQU   TCBNSTAE                                                 02770000
TCBHALT  EQU   TCBNSTAE                                                 02771000
TCBPPSUP EQU   TCBNSTAE                                                 02772000
TCB33E   EQU   TCBNSTAE                                                 02773000
TCBQUIES EQU   TCBNSTAE                                                 02774000
TCBSTABE EQU   TCBNSTAE                                                 02775000
TCBAQE   EQU   TCB+156                                                  02776000
TCBPQE   EQU   TCB+152                                                  02777000
TCBTSDP  EQU   TCB+151                                                  02778000
TCBTSLP  EQU   TCB+150                                                  02779000
TCBSTPCT EQU   TCB+149                                                  02780000
TCBCPUBN EQU   TCBTSFLG                                                 02781000
TCBDYDSP EQU   TCBTSFLG                                                 02782000
TCBRSV18 EQU   TCBTSFLG                                                 02783000
TCBRSV17 EQU   TCBTSFLG                                                 02784000
TCBTIOTG EQU   TCBTSFLG                                                 02785000
TCBRV300 EQU   TCBTSTSK                                                 02786000
TCBECB   EQU   TCB+144                                                  02787000
TCBIQE   EQU   TCB+140                                                  02788000
TCBLTC   EQU   TCB+136                                                  02789000
TCBOTC   EQU   TCB+132                                                  02790000
TCBNTC   EQU   TCB+128                                                  02791000
TCBJSTCA EQU   TCBJSTCB+1                                               02792000
TCBRSV16 EQU   TCBJSTCB                                                 02793000
TCBTQET  EQU   TCBTME                                                   02794000
TCBTCB   EQU   TCB+116                                                  02795000
TCBFSAB  EQU   TCBFSA+1                                                 02796000
TCBQEL   EQU   TCBFSA                                                   02797000
TCBGRS13 EQU   TCBGRS+52                                                02798000
TCBGRS12 EQU   TCBGRS+48                                                02799000
TCBGRS11 EQU   TCBGRS+44                                                02800000
TCBGRS10 EQU   TCBGRS+40                                                02801000
TCBGRS9  EQU   TCBGRS+36                                                02802000
TCBGRS8  EQU   TCBGRS+32                                                02803000
TCBGRS7  EQU   TCBGRS+28                                                02804000
TCBGRS6  EQU   TCBGRS+24                                                02805000
TCBGRS5  EQU   TCBGRS+20                                                02806000
TCBGRS4  EQU   TCBGRS+16                                                02807000
TCBGRS3  EQU   TCBGRS+12                                                02808000
TCBJPQB  EQU   TCBJPQ+1                                                 02809000
TCBRSV15 EQU   TCBPURGE                                                 02810000
TCBRSV14 EQU   TCBPURGE                                                 02811000
TCBRSV13 EQU   TCBPURGE                                                 02812000
TCBRSV12 EQU   TCBPURGE                                                 02813000
TCBRSV11 EQU   TCBPURGE                                                 02814000
TCBRSV10 EQU   TCBPURGE                                                 02815000
TCBRSV09 EQU   TCBPURGE                                                 02816000
TCBJPQF  EQU   TCBPURGE                                                 02817000
TCBJLB   EQU   TCB+40                                                   02818000
TCBLLS   EQU   TCB+36                                                   02819000
TCBDSP   EQU   TCB+35                                                   02820000
TCBLMP   EQU   TCB+34                                                   02821000
TCBFCD1  EQU   TCBFLGS5                                                 02822000
TCBSTP   EQU   TCBFLGS5                                                 02823000
TCBSYS   EQU   TCBFLGS5                                                 02824000
TCBANDSP EQU   TCBFLGS5                                                 02825000
TCBPAGE  EQU   TCBFLGS5                                                 02826000
TCBUXNDF EQU   TCBABWF                                                  02827000
TCBFC    EQU   TCBFLGS5                                                 02828000
TCBONDSP EQU   TCBFLGS4                                                 02829000
TCBMPCND EQU   TCBFLGS4                                                 02830000
TCBMPCVQ EQU   TCBFLGS4                                                 02831000
TCBUXNDV EQU   TCBFLGS4                                                 02832000
TCBHNDSP EQU   TCBFLGS4                                                 02833000
TCBRQENA EQU   TCBFLGS4                                                 02834000
TCBSER   EQU   TCBFLGS4                                                 02835000
TCBNDUMP EQU   TCBFLGS4                                                 02836000
TCBDWSTA EQU   TCBFLGS3                                                 02837000
TCBRSV08 EQU   TCBFLGS3                                                 02838000
TCBRSV07 EQU   TCBFLGS3                                                 02839000
TCBRSV06 EQU   TCBFLGS3                                                 02840000
TCBABGM  EQU   TCBFLGS3                                                 02841000
TCBABTRM EQU   TCBFLGS3                                                 02842000
TCBADINP EQU   TCBFLGS3                                                 02843000
TCBFSM   EQU   TCBFLGS3                                                 02844000
TCBFTS   EQU   TCBFLGS2                                                 02845000
TCBFETXR EQU   TCBFLGS2                                                 02846000
TCBFDSOP EQU   TCBFLGS2                                                 02847000
TCBFJMC  EQU   TCBFLGS2                                                 02848000
TCBFSMC  EQU   TCBFLGS2                                                 02849000
TCBFABOP EQU   TCBFLGS2                                                 02850000
TCBFSTI  EQU   TCBFLGS2                                                 02851000
TCBFOINP EQU   TCBFLGS2                                                 02852000
TCBFX    EQU   TCBFLGS1                                                 02853000
TCBFS    EQU   TCBFLGS1                                                 02854000
TCBFT    EQU   TCBFLGS1                                                 02855000
TCBPDUMP EQU   TCBFLGS1                                                 02856000
TCBFERA  EQU   TCBFLGS1                                                 02857000
TCBFE    EQU   TCBFLGS1                                                 02858000
TCBFA    EQU   TCBFLGS1                                                 02859000
TCBZERO  EQU   TCBPKF                                                   02860000
TCBFLAG  EQU   TCBPKF                                                   02861000
TCBMSSB  EQU   TCBMSS+1                                                 02862000
TCBRSV03 EQU   TCBMSS                                                   02863000
TCBTRNB  EQU   TCBTRN+1                                                 02864000
TCBRSV02 EQU   TCBABF                                                   02865000
TCBOLTEP EQU   TCBABF                                                   02866000
TCBTCP   EQU   TCBABF                                                   02867000
TCBTCPP  EQU   TCBABF                                                   02868000
TCBRSV01 EQU   TCBABF                                                   02869000
TCBGRPH  EQU   TCBABF                                                   02870000
TCBNOCHK EQU   TCBABF                                                   02871000
TCBMOD91 EQU   TCBABF                                                   02872000
TCBCMPC  EQU   TCBCMP+1                                                 02873000
TCBRV318 EQU   TCBCMSG                                                  02874000
TCBRV317 EQU   TCBCIND                                                  02875000
TCBRV316 EQU   TCBCWTO                                                  02876000
TCBCASID EQU   TCBCDBL                                                  02877000
TCBNOCC  EQU   TCBSTCC                                                  02878000
TCBDMPO  EQU   TCBCPP                                                   02879000
TCBCSTEP EQU   TCBCMPF                                                  02880000
TCBCREQ  EQU   TCBCMPF                                                  02881000
TCBTIO   EQU   TCB+12                                                   02882000
TCBDEB   EQU   TCB+8                                                    02883000
TCBPM    EQU   TCBPMASK                                                 02884000
@NM00003 EQU   TCBPMASK                                                 02885000
TCBFRS6  EQU   TCBFRS+24                                                02886000
TCBFRS4  EQU   TCBFRS+16                                                02887000
TCBFRS2  EQU   TCBFRS+8                                                 02888000
TCBFRS0  EQU   TCBFRS                                                   02889000
CVTLEVL  EQU   CVTRELNO+2                                               02890000
CVTNUMB  EQU   CVTRELNO                                                 02891000
CVTMDL   EQU   CVTFIX+250                                               02892000
@NM00002 EQU   CVTFIX+248                                               02893000
@NM00001 EQU   CVTFIX                                                   02894000
CVTRV482 EQU   CVTXTNT2+128                                             02895000
CVTRV481 EQU   CVTXTNT2+124                                             02896000
CVTRV480 EQU   CVTXTNT2+120                                             02897000
CVTRV479 EQU   CVTXTNT2+118                                             02898000
CVTRV478 EQU   CVTXTNT2+117                                             02899000
CVTRV477 EQU   CVTXTNT2+116                                             02900000
CVTRV476 EQU   CVTXTNT2+115                                             02901000
CVTRV475 EQU   CVTXTNT2+114                                             02902000
CVTRV474 EQU   CVTRV466                                                 02903000
CVTRV473 EQU   CVTRV466                                                 02904000
CVTRV472 EQU   CVTRV466                                                 02905000
CVTRV471 EQU   CVTRV466                                                 02906000
CVTRV470 EQU   CVTRV466                                                 02907000
CVTRV469 EQU   CVTRV466                                                 02908000
CVTRV468 EQU   CVTRV466                                                 02909000
CVTRV467 EQU   CVTRV466                                                 02910000
CVTRV465 EQU   CVTRV457                                                 02911000
CVTRV464 EQU   CVTRV457                                                 02912000
CVTRV463 EQU   CVTRV457                                                 02913000
CVTRV462 EQU   CVTRV457                                                 02914000
CVTRV461 EQU   CVTRV457                                                 02915000
CVTRV460 EQU   CVTRV457                                                 02916000
CVTRV459 EQU   CVTRV457                                                 02917000
CVTRV458 EQU   CVTRV457                                                 02918000
CVTRV456 EQU   CVTXTNT2+108                                             02919000
CVTRV455 EQU   CVTXTNT2+104                                             02920000
CVTRV454 EQU   CVTXTNT2+100                                             02921000
CVTRV453 EQU   CVTXTNT2+96                                              02922000
CVTRV452 EQU   CVTXTNT2+94                                              02923000
CVTRV451 EQU   CVTXTNT2+92                                              02924000
CVTRV450 EQU   CVTXTNT2+90                                              02925000
CVTRV449 EQU   CVTXTNT2+88                                              02926000
CVTRV448 EQU   CVTXTNT2+87                                              02927000
CVTRV447 EQU   CVTXTNT2+86                                              02928000
CVTRV446 EQU   CVTRV438                                                 02929000
CVTRV445 EQU   CVTRV438                                                 02930000
CVTRV444 EQU   CVTRV438                                                 02931000
CVTRV443 EQU   CVTRV438                                                 02932000
CVTRV442 EQU   CVTRV438                                                 02933000
CVTRV441 EQU   CVTRV438                                                 02934000
CVTRV440 EQU   CVTRV438                                                 02935000
CVTRV439 EQU   CVTRV438                                                 02936000
CVTRV437 EQU   CVTRV429                                                 02937000
CVTRV436 EQU   CVTRV429                                                 02938000
CVTRV435 EQU   CVTRV429                                                 02939000
CVTRV434 EQU   CVTRV429                                                 02940000
CVTRV433 EQU   CVTRV429                                                 02941000
CVTRV432 EQU   CVTRV429                                                 02942000
CVTRV431 EQU   CVTRV429                                                 02943000
CVTRV430 EQU   CVTRV429                                                 02944000
CVTRV428 EQU   CVTXTNT2+80                                              02945000
CVTRV427 EQU   CVTXTNT2+76                                              02946000
CVTRV426 EQU   CVTXTNT2+72                                              02947000
CVTRV425 EQU   CVTXTNT2+68                                              02948000
CVTATACT EQU   CVTATCVT                                                 02949000
CVTRV423 EQU   CVTXTNT2+62                                              02950000
CVTRV422 EQU   CVTXTNT2+60                                              02951000
CVTRV421 EQU   CVTXTNT2+58                                              02952000
CVTRV420 EQU   CVTXTNT2+56                                              02953000
CVTRV419 EQU   CVTXTNT2+55                                              02954000
CVTRV418 EQU   CVTXTNT2+54                                              02955000
CVTRV417 EQU   CVTRV409                                                 02956000
CVTRV416 EQU   CVTRV409                                                 02957000
CVTRV415 EQU   CVTRV409                                                 02958000
CVTRV414 EQU   CVTRV409                                                 02959000
CVTRV413 EQU   CVTRV409                                                 02960000
CVTRV412 EQU   CVTRV409                                                 02961000
CVTRV411 EQU   CVTRV409                                                 02962000
CVTRV410 EQU   CVTRV409                                                 02963000
CVTRV408 EQU   CVTRV400                                                 02964000
CVTRV407 EQU   CVTRV400                                                 02965000
CVTRV406 EQU   CVTRV400                                                 02966000
CVTRV405 EQU   CVTRV400                                                 02967000
CVTRV404 EQU   CVTRV400                                                 02968000
CVTRV403 EQU   CVTRV400                                                 02969000
CVTRV402 EQU   CVTRV400                                                 02970000
CVTRV401 EQU   CVTRV400                                                 02971000
CVTICB   EQU   CVTXTNT2+48                                              02972000
CVTSKTA  EQU   CVTXTNT2+44                                              02973000
CVTCCVT  EQU   CVTXTNT2+40                                              02974000
CVTRSV98 EQU   CVTXTNT2+36                                              02975000
CVTRSV97 EQU   CVTXTNT2+34                                              02976000
CVTRSV96 EQU   CVTXTNT2+32                                              02977000
CVTOLTEP EQU   CVTXTNT2+28                                              02978000
CVTQIDA  EQU   CVTQID+1                                                 02979000
CVTRSV95 EQU   CVTQID                                                   02980000
CVTRSV94 EQU   CVTXTNT2+20                                              02981000
CVTRSV93 EQU   CVTXTNT2+16                                              02982000
CVTRSV92 EQU   CVTXTNT2+12                                              02983000
CVTDEBVR EQU   CVTXTNT2+8                                               02984000
CVTRSV91 EQU   CVTXTNT2+6                                               02985000
CVTRSV9H EQU   CVTFLGBT                                                 02986000
CVTRSV9G EQU   CVTFLGBT                                                 02987000
CVTRSV9F EQU   CVTFLGBT                                                 02988000
CVTRSV9E EQU   CVTFLGBT                                                 02989000
CVTRSV9D EQU   CVTFLGBT                                                 02990000
CVTRSV9C EQU   CVTFLGBT                                                 02991000
CVTVME   EQU   CVTFLGBT                                                 02992000
CVTNPE   EQU   CVTFLGBT                                                 02993000
CVTNUCLS EQU   CVTXTNT2+4                                               02994000
CVTDSSVA EQU   CVTDSSV+1                                                02995000
CVTRSV89 EQU   CVTDSSV                                                  02996000
CVTRSV88 EQU   CVTXTNT1+8                                               02997000
CVTRSV87 EQU   CVTXTNT1+4                                               02998000
CVTFACHN EQU   CVTXTNT1                                                 02999000
CVTRV488 EQU   CVTMAP+412                                               03000000
CVTRV487 EQU   CVTMAP+408                                               03001000
CVTRV486 EQU   CVTMAP+404                                               03002000
CVTRV485 EQU   CVTMAP+400                                               03003000
CVTACTAP EQU   CVTMAP+396                                               03004000
CVTAUTH  EQU   CVTMAP+392                                               03005000
CVTATMCA EQU   CVTATMCT+1                                               03006000
CVTATMST EQU   CVTATMCT                                                 03007000
CVTRSV61 EQU   CVTMAP+384                                               03008000
CVTVOLT1 EQU   CVTVOLM1+1                                               03009000
CVTVOLI1 EQU   CVTVOLF1                                                 03010000
CVTSTOA  EQU   CVTMAP+376                                               03011000
CVTRSV58 EQU   CVTMAP+374                                               03012000
CVTRSV57 EQU   CVTMAP+372                                               03013000
CVTDDCE  EQU   CVTMAP+368                                               03014000
CVTPNWFR EQU   CVTMAP+364                                               03015000
CVTSMF   EQU   CVTMAP+360                                               03016000
CVTSULK  EQU   CVTMAP+358                                               03017000
CVTSLKO  EQU   CVTSYSK                                                  03018000
CVTSLKP  EQU   CVTSYSK                                                  03019000
CVTSLKQ  EQU   CVTSYSK                                                  03020000
CVTSLKR  EQU   CVTSYSK                                                  03021000
CVTRSV56 EQU   CVTSYSK                                                  03022000
CVTRSV55 EQU   CVTSYSK                                                  03023000
CVTRSV54 EQU   CVTSYSK                                                  03024000
CVTRSV53 EQU   CVTSYSK                                                  03025000
CVTRSV52 EQU   CVTA1F1                                                  03026000
CVTRSV51 EQU   CVTA1F1                                                  03027000
CVTRSV50 EQU   CVTA1F1                                                  03028000
CVTRSV49 EQU   CVTA1F1                                                  03029000
CVTRSV48 EQU   CVTA1F1                                                  03030000
CVTRSV47 EQU   CVTA1F1                                                  03031000
CVTSRSW  EQU   CVTA1F1                                                  03032000
CVTPFSW  EQU   CVTA1F1                                                  03033000
CVTPCVT  EQU   CVTMAP+352                                               03034000
CVTRSV46 EQU   CVTMAP+344                                               03035000
CVTRSV45 EQU   CVTMAP+340                                               03036000
CVTRSV44 EQU   CVTMAP+338                                               03037000
CVTRSV43 EQU   CVTMAP+336                                               03038000
CVTHJESA EQU   CVTHJES+1                                                03039000
CVTRSV42 EQU   CVTHJES                                                  03040000
CVTEXT2A EQU   CVTEXT2+1                                                03041000
CVTRSV41 EQU   CVTEXT2                                                  03042000
CVTAPFA  EQU   CVTAPF+1                                                 03043000
CVTRSV40 EQU   CVTAPF                                                   03044000
CVTRV518 EQU   CVTINTLA                                                 03045000
CVTRV517 EQU   CVTERPV                                                  03046000
CVTEORM  EQU   CVTMAP+312                                               03047000
CVTMCHPR EQU   CVTMAP+308                                               03048000
CVTTZ    EQU   CVTMAP+304                                               03049000
CVTJEPS  EQU   CVTMAP+300                                               03050000
CVTJESCT EQU   CVTMAP+296                                               03051000
CVTMODE  EQU   CVTMAP+292                                               03052000
CVTPTRV  EQU   CVTMAP+288                                               03053000
CVTREAL  EQU   CVTMAP+284                                               03054000
CVTRSV39 EQU   CVTMAP+280                                               03055000
CVTRSV38 EQU   CVTMAP+276                                               03056000
CVTDMSRA EQU   CVTDMSR+1                                                03057000
CVTRV634 EQU   CVTDMSRF                                                 03058000
CVTRV633 EQU   CVTDMSRF                                                 03059000
CVTRV632 EQU   CVTDMSRF                                                 03060000
CVTRV631 EQU   CVTDMSRF                                                 03061000
CVTRV630 EQU   CVTDMSRF                                                 03062000
CVTRV629 EQU   CVTDMSRF                                                 03063000
CVTUDUMP EQU   CVTDMSRF                                                 03064000
CVTSDUMP EQU   CVTDMSRF                                                 03065000
CVTQMSGA EQU   CVTQMSG+1                                                03066000
CVTRSV36 EQU   CVTQMSG                                                  03067000
CVTAMFF  EQU   CVTMAP+264                                               03068000
CVTPURGA EQU   CVTPURG+1                                                03069000
CVTRSV35 EQU   CVTPURG                                                  03070000
CVTCBSP  EQU   CVTMAP+256                                               03071000
CVTATERA EQU   CVTATER+1                                                03072000
CVTSYST  EQU   CVTATER                                                  03073000
CVTVOLT2 EQU   CVTTAT                                                   03074000
CVTVOLI2 EQU   CVTVOLF2                                                 03075000
CVTAQAVB EQU   CVTAQAVT+1                                               03076000
CVTRSV34 EQU   CVTTCMFG                                                 03077000
CVTRSV33 EQU   CVTTCMFG                                                 03078000
CVTRSV32 EQU   CVTTCMFG                                                 03079000
CVTRSV31 EQU   CVTTCMFG                                                 03080000
CVTRSV30 EQU   CVTTCMFG                                                 03081000
CVTRSV29 EQU   CVTTCMFG                                                 03082000
CVTLDEV  EQU   CVTTCMFG                                                 03083000
CVTTCRDY EQU   CVTTCMFG                                                 03084000
CVTGTFA  EQU   CVTGTF+1                                                 03085000
CVTRSV27 EQU   CVTGTFST                                                 03086000
CVTRNIO  EQU   CVTGTFST                                                 03087000
CVTUSR   EQU   CVTGTFST                                                 03088000
CVTRV318 EQU   CVTFORM                                                  03089000
CVTRV317 EQU   CVTTMODE                                                 03090000
CVTRV316 EQU   CVTSTATE                                                 03091000
CVTRV315 EQU   CVTGTFS                                                  03092000
CVTGTFAV EQU   CVTGTFS                                                  03093000
CVT0SCR1 EQU   CVTMAP+232                                               03094000
CVTRV515 EQU   CVTMAP+228                                               03095000
CVTRMS   EQU   CVTMAP+224                                               03096000
CVTPATCH EQU   CVTMAP+220                                               03097000
CVTTSCE  EQU   CVTMAP+216                                               03098000
CVTLNKSC EQU   CVTMAP+214                                               03099000
CVTQABST EQU   CVTMAP+212                                               03100000
CVTMDLDS EQU   CVTMAP+208                                               03101000
CVTUSER  EQU   CVTMAP+204                                               03102000
CVTABEND EQU   CVTMAP+200                                               03103000
CVTSMCA  EQU   CVTMAP+196                                               03104000
CVTRSV18 EQU   CVTMAP+192                                               03105000
CVTQLPAQ EQU   CVTMAP+188                                               03106000
CVTQCDSR EQU   CVTMAP+184                                               03107000
CVTRSV17 EQU   CVTOPTB                                                  03108000
CVTRSV16 EQU   CVTOPTB                                                  03109000
CVTFP    EQU   CVTOPTB                                                  03110000
CVTAPTHR EQU   CVTOPTB                                                  03111000
CVTNLOG  EQU   CVTOPTB                                                  03112000
CVTTOD   EQU   CVTOPTB                                                  03113000
CVTCTIMS EQU   CVTOPTB                                                  03114000
CVTPROT  EQU   CVTOPTB                                                  03115000
CVTXPFP  EQU   CVTOPTA                                                  03116000
CVTASCII EQU   CVTOPTA                                                  03117000
CVTRSV13 EQU   CVTOPTA                                                  03118000
CVTRSV12 EQU   CVTOPTA                                                  03119000
CVTNIP   EQU   CVTOPTA                                                  03120000
CVTDDR   EQU   CVTOPTA                                                  03121000
CVTAPR   EQU   CVTOPTA                                                  03122000
CVTCCH   EQU   CVTOPTA                                                  03123000
CVTSNCTR EQU   CVTMAP+180                                               03124000
CVTQMWR  EQU   CVTMAP+176                                               03125000
CVTQOCR  EQU   CVTMAP+172                                               03126000
CVT1EF00 EQU   CVTMAP+168                                               03127000
CVTMZ00  EQU   CVTMAP+164                                               03128000
CVTSV76Q EQU   CVTSV76C                                                 03129000
CVTRSV11 EQU   CVTMAP+156                                               03130000
CVT0PT01 EQU   CVTMAP+152                                               03131000
CVTMSER  EQU   CVTMAP+148                                               03132000
CVTRV516 EQU   CVTIERLC                                                 03133000
CVTILCH  EQU   CVTMAP+140                                               03134000
CVT0DS   EQU   CVTMAP+136                                               03135000
CVTFBOSV EQU   CVTMAP+132                                               03136000
CVTNUCB  EQU   CVTMAP+128                                               03137000
CVTIXAVL EQU   CVTMAP+124                                               03138000
CVTSV76M EQU   CVTIOQET                                                 03139000
CVTDCBA  EQU   CVTMAP+117                                               03140000
CVTMVS2  EQU   CVTDCB                                                   03141000
CVT6DAT  EQU   CVTDCB                                                   03142000
CVT4MPS  EQU   CVTDCB                                                   03143000
CVTRSV09 EQU   CVTDCB                                                   03144000
CVT4MS1  EQU   CVTDCB                                                   03145000
CVT2SPS  EQU   CVTDCB                                                   03146000
CVT1SSS  EQU   CVTDCB                                                   03147000
CVTRSV08 EQU   CVTDCB                                                   03148000
CVTSTB   EQU   CVTMAP+112                                               03149000
CVTQTD00 EQU   CVTMAP+108                                               03150000
CVTQTE00 EQU   CVTMAP+104                                               03151000
CVTCUCB  EQU   CVTMAP+100                                               03152000
CVTSJQ   EQU   CVTMAP+96                                                03153000
CVTPBLDL EQU   CVTMAP+92                                                03154000
CVTTPC   EQU   CVTMAP+88                                                03155000
CVTSVDCB EQU   CVTMAP+84                                                03156000
CVTBRET  EQU   CVTMAP+82                                                03157000
CVTEXIT  EQU   CVTMAP+80                                                03158000
CVT0FN00 EQU   CVTMAP+76                                                03159000
CVTDARA  EQU   CVTDAR+1                                                 03160000
CVTRSV07 EQU   CVTFLGS1                                                 03161000
CVTRSV06 EQU   CVTFLGS1                                                 03162000
CVTRSV05 EQU   CVTFLGS1                                                 03163000
CVTRSV04 EQU   CVTFLGS1                                                 03164000
CVTRSV03 EQU   CVTFLGS1                                                 03165000
CVTRSV02 EQU   CVTFLGS1                                                 03166000
CVTRSV01 EQU   CVTFLGS1                                                 03167000
CVTDMPLK EQU   CVTFLGS1                                                 03168000
CVTXITP  EQU   CVTMAP+68                                                03169000
CVTZDTAB EQU   CVTMAP+64                                                03170000
CVTMSLT  EQU   CVTMAP+60                                                03171000
CVTDATE  EQU   CVTMAP+56                                                03172000
CVTBTERM EQU   CVTMAP+52                                                03173000
CVTSYSAD EQU   CVTMAP+48                                                03174000
CVTXTLER EQU   CVTMAP+44                                                03175000
CVTILK2  EQU   CVTMAP+40                                                03176000
CVTILK1  EQU   CVTMAP+36                                                03177000
CVTPRLTV EQU   CVTMAP+32                                                03178000
CVTPCNVT EQU   CVTMAP+28                                                03179000
CVT0VL00 EQU   CVTMAP+24                                                03180000
CVTXAPG  EQU   CVTMAP+20                                                03181000
CVTBUF   EQU   CVTMAP+16                                                03182000
CVTJOB   EQU   CVTMAP+12                                                03183000
CVTLINK  EQU   CVTMAP+8                                                 03184000
CVT0EF00 EQU   CVTMAP+4                                                 03185000
CVTTCBP  EQU   CVTMAP                                                   03186000
CVT      EQU   CVTMAP                                                   03187000
@NM00065 EQU   PSA+3668                                                 03188000
PSASTAK  EQU   PSA+3072                                                 03189000
@NM00064 EQU   PSA+1048                                                 03190000
PSAUSEND EQU   PSA+1048                                                 03191000
PSARV062 EQU   PSA+1044                                                 03192000
PSACDAL  EQU   PSA+1040                                                 03193000
PSAWTCOD EQU   PSA+1036                                                 03194000
PSAATCVT EQU   PSA+1032                                                 03195000
PSAPCPSW EQU   PSA+1024                                                 03196000
PSAPIR2  EQU   PSA+1020                                                 03197000
PSARV059 EQU   PSA+1018                                                 03198000
PSASVC13 EQU   PSA+1016                                                 03199000
PSALSFCC EQU   PSA+1012                                                 03200000
PSASFACC EQU   PSA+1008                                                 03201000
PSASTOP  EQU   PSA+992                                                  03202000
PSASTART EQU   PSA+976                                                  03203000
PSARSPSW EQU   PSA+968                                                  03204000
PSASRPSW EQU   PSA+960                                                  03205000
PSARV045 EQU   PSA+892                                                  03206000
PSARV044 EQU   PSA+888                                                  03207000
PSARV043 EQU   PSA+884                                                  03208000
PSARV042 EQU   PSA+880                                                  03209000
PSARV041 EQU   PSA+876                                                  03210000
PSARV040 EQU   PSA+872                                                  03211000
PSARV025 EQU   PSA+868                                                  03212000
PSADSSED EQU   PSA+868                                                  03213000
PSADSSPR EQU   PSA+864                                                  03214000
PSADSSFW EQU   PSA+860                                                  03215000
PSADSS14 EQU   PSA+856                                                  03216000
PSADSSPP EQU   PSA+848                                                  03217000
PSADSSRP EQU   PSA+840                                                  03218000
PSADSS05 EQU   PSADSSF4                                                 03219000
PSADSS10 EQU   PSADSSF4                                                 03220000
PSADSSVE EQU   PSADSSF4                                                 03221000
PSADSSDE EQU   PSADSSF4                                                 03222000
PSADSSC0 EQU   PSADSSF4                                                 03223000
PSADSSIE EQU   PSADSSF4                                                 03224000
PSADSS12 EQU   PSADSSF4                                                 03225000
PSADSSRC EQU   PSADSSF4                                                 03226000
PSARV057 EQU   PSADSSF3                                                 03227000
PSARV056 EQU   PSADSSF3                                                 03228000
PSARV055 EQU   PSADSSF3                                                 03229000
PSADSSMC EQU   PSADSSF3                                                 03230000
PSADSSRW EQU   PSADSSF3                                                 03231000
PSADSSNM EQU   PSADSSF3                                                 03232000
PSADSSES EQU   PSADSSF3                                                 03233000
PSADSSGP EQU   PSADSSF3                                                 03234000
PSADSSF2 EQU   PSADSSFL+1                                               03235000
PSADSSPI EQU   PSADSSF1                                                 03236000
PSADSSOI EQU   PSADSSF1                                                 03237000
PSADSSSP EQU   PSADSSF1                                                 03238000
PSADSSTP EQU   PSADSSF1                                                 03239000
PSADSSDW EQU   PSADSSF1                                                 03240000
PSADSSDD EQU   PSADSSF1                                                 03241000
PSADSSDM EQU   PSADSSF1                                                 03242000
PSADSSMV EQU   PSADSSF1                                                 03243000
PSADSSTS EQU   PSA+816                                                  03244000
PSADSSWK EQU   PSA+812                                                  03245000
PSADSSR3 EQU   PSA+808                                                  03246000
PSADSSR2 EQU   PSA+804                                                  03247000
PSADSSRS EQU   PSA+800                                                  03248000
PSASTOR  EQU   PSA+796                                                  03249000
PSACPUSA EQU   PSA+794                                                  03250000
PSAVSTAP EQU   PSA+792                                                  03251000
PSAWKVAP EQU   PSA+788                                                  03252000
PSAWKRAP EQU   PSA+784                                                  03253000
PSAMCHIC EQU   PSA+783                                                  03254000
PSARV061 EQU   PSA+782                                                  03255000
PSASYMSK EQU   PSA+781                                                  03256000
PSAMCHFL EQU   PSA+780                                                  03257000
PSACR0   EQU   PSA+776                                                  03258000
PSAPSWSV EQU   PSA+768                                                  03259000
PSACLHS  EQU   PSAHLHI                                                  03260000
PSALKR15 EQU   PSALKSA+60                                               03261000
PSALKR14 EQU   PSALKSA+56                                               03262000
PSALKR13 EQU   PSALKSA+52                                               03263000
PSALKR12 EQU   PSALKSA+48                                               03264000
PSALKR11 EQU   PSALKSA+44                                               03265000
PSALKR10 EQU   PSALKSA+40                                               03266000
PSALKR9  EQU   PSALKSA+36                                               03267000
PSALKR8  EQU   PSALKSA+32                                               03268000
PSALKR7  EQU   PSALKSA+28                                               03269000
PSALKR6  EQU   PSALKSA+24                                               03270000
PSALKR5  EQU   PSALKSA+20                                               03271000
PSALKR4  EQU   PSALKSA+16                                               03272000
PSALKR3  EQU   PSALKSA+12                                               03273000
PSALKR2  EQU   PSALKSA+8                                                03274000
PSALKR1  EQU   PSALKSA+4                                                03275000
PSALKR0  EQU   PSALKSA                                                  03276000
PSARV023 EQU   PSACLHT+52                                               03277000
PSALOCAL EQU   PSACLHT+48                                               03278000
PSACMSL  EQU   PSACLHT+44                                               03279000
PSAOPTL  EQU   PSACLHT+40                                               03280000
PSATPACL EQU   PSACLHT+36                                               03281000
PSATPDNL EQU   PSACLHT+32                                               03282000
PSATPNCL EQU   PSACLHT+28                                               03283000
PSAIOSLL EQU   PSACLHT+24                                               03284000
PSAIOSUL EQU   PSACLHT+20                                               03285000
PSAIOSCL EQU   PSACLHT+16                                               03286000
PSAIOSSL EQU   PSACLHT+12                                               03287000
PSASALCL EQU   PSACLHT+8                                                03288000
PSAASML  EQU   PSACLHT+4                                                03289000
PSADISPL EQU   PSACLHT                                                  03290000
PSASRSA  EQU   PSA+636                                                  03291000
PSARV050 EQU   PSA+634                                                  03292000
PSADSSGO EQU   PSA+633                                                  03293000
PSARECUR EQU   PSA+632                                                  03294000
PSAHLHIS EQU   PSA+628                                                  03295000
PSAIPCSA EQU   PSA+624                                                  03296000
@NM00063 EQU   PSA+621                                                  03297000
PSAIPCDM EQU   PSA+620                                                  03298000
PSAIPCD  EQU   PSA+616                                                  03299000
@NM00062 EQU   PSA+613                                                  03300000
PSAIPCRM EQU   PSA+612                                                  03301000
PSAIPCR  EQU   PSA+608                                                  03302000
PSAMCHEX EQU   PSA+600                                                  03303000
PSAMPSW  EQU   PSA+592                                                  03304000
PSAEXPS2 EQU   PSA+584                                                  03305000
PSAEXPS1 EQU   PSA+576                                                  03306000
PSAPIREG EQU   PSA+572                                                  03307000
PSARSREG EQU   PSA+568                                                  03308000
PSAGPREG EQU   PSA+556                                                  03309000
PSARV022 EQU   PSASUP4                                                  03310000
PSARV021 EQU   PSASUP4                                                  03311000
PSARV020 EQU   PSASUP4                                                  03312000
PSARV019 EQU   PSASUP4                                                  03313000
PSARV018 EQU   PSASUP4                                                  03314000
PSARV017 EQU   PSASUP4                                                  03315000
PSARV016 EQU   PSASUP4                                                  03316000
PSARV015 EQU   PSASUP4                                                  03317000
PSARV014 EQU   PSASUP3                                                  03318000
PSAULCMS EQU   PSASUP3                                                  03319000
PSARV012 EQU   PSASUP3                                                  03320000
PSAESTA  EQU   PSASUP3                                                  03321000
PSASPR   EQU   PSASUP3                                                  03322000
PSAPSREG EQU   PSASUP3                                                  03323000
PSAPI2   EQU   PSASUP3                                                  03324000
PSAIOSUP EQU   PSASUP3                                                  03325000
PSALCR   EQU   PSASUP2                                                  03326000
PSARTM   EQU   PSASUP2                                                  03327000
PSAACR   EQU   PSASUP2                                                  03328000
PSAIPCE2 EQU   PSASUP2                                                  03329000
PSAIPCES EQU   PSASUP2                                                  03330000
PSAIPCEC EQU   PSASUP2                                                  03331000
PSAGTF   EQU   PSASUP2                                                  03332000
PSAIPCRI EQU   PSASUP2                                                  03333000
PSATYPE6 EQU   PSASUP1                                                  03334000
PSATCTL  EQU   PSASUP1                                                  03335000
PSADISP  EQU   PSASUP1                                                  03336000
PSALOCK  EQU   PSASUP1                                                  03337000
PSAPI    EQU   PSASUP1                                                  03338000
PSAEXT   EQU   PSASUP1                                                  03339000
PSASVC   EQU   PSASUP1                                                  03340000
PSAIO    EQU   PSASUP1                                                  03341000
PSAAOLD  EQU   PSA+548                                                  03342000
PSAANEW  EQU   PSA+544                                                  03343000
PSATOLD  EQU   PSA+540                                                  03344000
PSATNEW  EQU   PSA+536                                                  03345000
PSALCCAR EQU   PSA+532                                                  03346000
PSALCCAV EQU   PSA+528                                                  03347000
PSAPCCAR EQU   PSA+524                                                  03348000
PSAPCCAV EQU   PSA+520                                                  03349000
PSACPULA EQU   PSA+518                                                  03350000
PSACPUPA EQU   PSA+516                                                  03351000
PSAPSA   EQU   PSA+512                                                  03352000
FLCHDEND EQU   PSA+512                                                  03353000
FLCCRSAV EQU   FLCMCLA+280                                              03354000
FLCGRSAV EQU   FLCMCLA+216                                              03355000
FLCFPSAV EQU   FLCMCLA+184                                              03356000
FLCFLA   EQU   FLCMCLA+88                                               03357000
FLCRGNCD EQU   FLCMCLA+84                                               03358000
FLCFSAA  EQU   FLCFSA+1                                                 03359000
@NM00061 EQU   FLCFSA                                                   03360000
@NM00060 EQU   FLCMCLA+72                                               03361000
FLCMCIC  EQU   FLCMCLA+64                                               03362000
@NM00059 EQU   FLCMCLA+20                                               03363000
FLCIOAA  EQU   FLCIOA+1                                                 03364000
@NM00058 EQU   FLCIOA                                                   03365000
@NM00057 EQU   FLCMCLA+15                                               03366000
@NM00056 EQU   FLCMCLA+14                                               03367000
@NM00055 EQU   FLCMCLA+12                                               03368000
FLCLCL   EQU   FLCMCLA+8                                                03369000
FLCIOELA EQU   FLCIOEL+1                                                03370000
@NM00054 EQU   FLCIOEL                                                  03371000
FLCCHNID EQU   FLCMCLA                                                  03372000
@NM00053 EQU   PSA+160                                                  03373000
FLCMTRCD EQU   PSA+157                                                  03374000
@NM00052 EQU   PSA+156                                                  03375000
FLCPERA  EQU   FLCPER+1                                                 03376000
@NM00051 EQU   FLCPER                                                   03377000
@NM00050 EQU   PSA+151                                                  03378000
FLCPERCD EQU   PSA+150                                                  03379000
FLCMCNUM EQU   PSA+149                                                  03380000
@NM00049 EQU   PSA+148                                                  03381000
FLCTEAA  EQU   FLCTEA+1                                                 03382000
@NM00048 EQU   FLCTEA                                                   03383000
PSAPIPC  EQU   PSAPICOD                                                 03384000
PSAPIMC  EQU   PSAPICOD                                                 03385000
PSAPIPER EQU   PSAPICOD                                                 03386000
PSARV049 EQU   FLCPICOD                                                 03387000
FLCPILCB EQU   FLCPIILC                                                 03388000
@NM00047 EQU   FLCPIILC                                                 03389000
@NM00046 EQU   PSAEPPSW                                                 03390000
FLCSVCN  EQU   PSAESPSW+2                                               03391000
FLCSILCB EQU   FLCSVILC                                                 03392000
@NM00045 EQU   FLCSVILC                                                 03393000
@NM00044 EQU   PSAESPSW                                                 03394000
FLCEICOD EQU   PSAEEPSW+2                                               03395000
PSASPAD  EQU   PSAEEPSW                                                 03396000
@NM00043 EQU   PSA+128                                                  03397000
FLCINPSW EQU   PSA+120                                                  03398000
FLCMNPSW EQU   PSA+112                                                  03399000
FLCPNPSW EQU   PSA+104                                                  03400000
FLCSNPSW EQU   PSA+96                                                   03401000
FLCENPSW EQU   PSA+88                                                   03402000
FLCTRACE EQU   PSA+84                                                   03403000
FLCTIMER EQU   PSA+80                                                   03404000
FLCCVT2  EQU   PSA+76                                                   03405000
FLCCAW   EQU   PSA+72                                                   03406000
FLCCSW   EQU   PSA+64                                                   03407000
FLCIOPSW EQU   PSA+56                                                   03408000
FLCMOPSW EQU   PSA+48                                                   03409000
FLCPOPSW EQU   PSA+40                                                   03410000
FLCSOPSW EQU   PSA+32                                                   03411000
FLCEOPSW EQU   PSA+24                                                   03412000
@NM00042 EQU   FLCICCW2+4                                               03413000
FLCCVT   EQU   FLCICCW2                                                 03414000
FLCICCW1 EQU   FLCROPSW                                                 03415000
FLCIPPSW EQU   FLCRNPSW                                                 03416000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03417000
@RT00079 EQU   DOSPIE                                                   03418000
@RT00109 EQU   DOSVC13                                                  03419000
@RT00129 EQU   PGMGR                                                    03420000
@RC00125 EQU   @RC00121                                                 03421000
@RC00218 EQU   @RC00178                                                 03422000
@RT00233 EQU   DODETACH                                                 03423000
@RT00283 EQU   PGMGRCK                                                  03424000
TESTCS   EQU   @EL00002                                                 03425000
@RC00131 EQU   @RC00125                                                 03426000
@RC00143 EQU   @RC00125                                                 03427000
@ENDDATA EQU   *                                                        03428000
         END   IGC003,(C'PLS2132',0701,78093)                           03429000
./  ADD  SSI=81280227,NAME=IEAVEVT0
         TITLE 'IEAVEVT0  EVENTS SERVICE ROUTINE                       *00001000
                        '                                               00002000
IEAVEVT0 CSECT ,                                                   0001 00003000
@PROLOG  DS    0H                                                  0002 00004000
JSCBDISP EQU 188                                                        00005000
JSCBAOS1 EQU  72                                                        00006000
JSCBAOS2 EQU 192                                                        00007000
RBPRFXLN EQU 64                                                         00008000
RBPRFLNA EQU 32                                                         00009000
PRBLEN   EQU 136                                                        00010000
SIRBLEN  EQU 200                                                        00011000
TIRBLEN  EQU 136                                                        00012000
IRBLEN   EQU 128                                                        00013000
SVRBLEN  EQU 200                                                        00014000
DISABLE  EQU  X'FC'                    MASK FOR DISABLEING SYSTEM       00015000
*                                                                  0090 00016000
         ENTRY IGC125                                                   00017000
         ENTRY IEAVEVT1                                                 00018000
*/*      P     ESTABLISH ADDRESSIBILITY                              */ 00019000
         USING IEAVEVT0,R15            ESTABLISH ADDRESSABILITY FOR     00020000
*                                      MODULE                           00021000
         MODID BR=YES                                                   00022000
*/*      P     SAVE CALLERS REGISTERS IN LOCAL SAVE AREA             */ 00023000
         L     R15,PSAAOLD             CURRENT ASCB ADDR                00024000
         L     R15,ASCBASXB-ASCB(,R15) GET ADDR OF ASXB                 00025000
         L     R15,ASXBSPSA-ASXB(,R15) GET ADDR OF LOCAL WSAVT          00026000
         L     R15,WSALEVNT-WSAL(,R15) GET ADDR OF EVENTS WSA           00027000
         STM   R0,R15,0(R15)           SAVE REGS                        00028000
         BALR  R15,0                   RESTABLISH ADDRESSIBILITY        00029000
         USING *,R15                   FOR MODULE                       00030000
*/*      P     ESTABLISH REGISTERS FOR TYPE ONE ENTRY                */ 00031000
*                                                                  0091 00032000
*   R4=PSATOLD;                     /* LOAD TCB ADDRESS              */ 00033000
         L     R4,PSATOLD                                          0091 00034000
*   R5=TCBRBP;                      /* LOAD RB ADDRESS               */ 00035000
         L     R5,TCBRBP(,TCBPTR)                                  0092 00036000
*   R6=ADDR(IGC125);                /* LOAD ADDRESS OF TYPE ONE ENTRY*/ 00037000
         LA    R6,IGC125                                           0093 00038000
*   R7=PSAAOLD;                     /* LOAD ADDRESS OF ASCB          */ 00039000
         L     R7,PSAAOLD                                          0094 00040000
*/*      S     IGC125: CALL TYPE ONE EVENT MAINLINE                  */ 00041000
*                                                                  0095 00042000
*   CALL IGC125;                    /* CALL MAINLINE CODE            */ 00043000
         BAL   @14,IGC125                                          0095 00044000
*   GENERATE;                                                      0096 00045000
*                                                                  0096 00046000
         USING *,R14                                                    00047000
*/*      D     (YES,,NO,RETURN) WAS WAIT=YES SPECIFIED               */ 00048000
*                                                                  0097 00049000
*   IF R0<ZERO THEN                 /* CHECK IF WAIT=YES WAS       0097 00050000
*                                      SPECIFIED                     */ 00051000
         LTR   R0,R0                                               0097 00052000
         BNM   @RF00097                                            0097 00053000
*     DO;                           /* WAIT=YES SPECIFIED RETURN TO     00054000
*                                      DISPATCHER                    */ 00055000
*       TCBGRS1=R1;                 /* SAVE REG 1 IN TCB             */ 00056000
         ST    R1,TCBGRS1(,TCBPTR)                                 0099 00057000
*       GENERATE;                                                  0100 00058000
*                                                                  0100 00059000
*/*      P     DISABLE CPU USING STNSM                               */ 00060000
         STNSM WOS,DISABLE             DISABLE SYSTEM MASK              00061000
*/*      S     SETFRR: PURGE THE FRR STACK                           */ 00062000
         SETFRR P,WRKREGS=(R10,R11)    PURGE THE FRR STACK              00063000
*/*      S     SETLOCK: RELEASE LOCAL LOCK                           */ 00064000
         SETLOCK RELEASE,TYPE=LOCAL,RELATED='INPUT PARM'                00065000
*/*      R     DISPATCHER                                            */ 00066000
*                                                                  0101 00067000
*       GOTO IEA0DS;                /* RETURN TO DISPATCHER          */ 00068000
         L     @12,CVTPTR                                          0101 00069000
         L     @12,CVT0DS(,@12)                                    0101 00070000
         BR    @12                                                 0101 00071000
*     END;                                                         0102 00072000
*   ELSE                            /* WAIT=YES NOT SPECIFIED        */ 00073000
*     DO;                           /* SET UP RETURN TO CALLER       */ 00074000
@RF00097 DS    0H                                                  0104 00075000
*/*RETURN:  P     RESTORE CALLERS REGS                               */ 00076000
*                                                                  0104 00077000
*       RFY                                                        0104 00078000
*        (R2) RSTD;                                                0104 00079000
*       LM(R2,R14,R2R14SAV);        /* RESTORE CALLERS REGS          */ 00080000
         L     @12,ASXBPTR(,ASCBPTR)                               0105 00081000
         L     @12,ASXBSPSA(,@12)                                  0105 00082000
         L     @12,WSALEVNT(,@12)                                  0105 00083000
         LM    R2,R14,R2R14SAV(@12)                                0105 00084000
*/*      R     TO CALLER                                             */ 00085000
*                                                                  0106 00086000
*       GOTO CALLER;                /* RETURN TO CALLER              */ 00087000
         BR    R14                                                 0106 00088000
*     END;                                                         0107 00089000
*   RFY                                                            0108 00090000
*    (R2,                                                          0108 00091000
*     R15) UNRSTD;                                                 0108 00092000
*                                                                  0108 00093000
*/* IEAVEVT0: END                                                    */ 00094000
*                                                                  0109 00095000
*                                                                  0109 00096000
*/* ******************************************************************/ 00097000
*/*                                                                  */ 00098000
*/*  TYPE ONE SVC ENTRY FOR WAIT PROCESSING                          */ 00099000
*/*                                                                  */ 00100000
*/*    IGC125 IS THE ENTRY POINT FOR SVC 125. IGC125                 */ 00101000
*/*    SETS UP AN FRR (SETFRR). CALLS A ROUTINE TO VALIDATE THE      */ 00102000
*/*    TABLE ADDRESS (EVNTTVAL). IF WAIT= WAS SPECIFIED, CALLS       */ 00103000
*/*    THE TABLE UPDATE ROUTINE (EVNTTUPD). NEXT IT PROCESSES        */ 00104000
*/*    THE ECB= REQUEST BY CALLING THE SUBROUTINE (ECBINIT).         */ 00105000
*/*    IF WAIT= WAS REQUESTED, CALLS THE SUBROUTINE TO               */ 00106000
*/*    PERFORM WAIT PROCESSING (EVNTWAIT). IT THEN DELETES           */ 00107000
*/*    THE FRR(DELFRR). SET REG 15 = 0, RELOADS RETURN ADDRESS       */ 00108000
*/*    AND RETURNS.                                                  */ 00109000
*/*                                                                  */ 00110000
*/* ******************************************************************/ 00111000
*                                                                  0109 00112000
*IGC125:                                                           0109 00113000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA,NOPARMREG,NOENTREG,RETREG);     0109 00114000
*                                                                  0109 00115000
@EL00001 DS    0H                                                  0109 00116000
@EF00001 DS    0H                                                  0109 00117000
@ER00001 BR    @14                                                 0109 00118000
IGC125   DS    0H                                                  0110 00119000
*/* IGC125: CHART                                                    */ 00120000
*/*      E     IGC125                                                */ 00121000
*/*      P     ESTABLISH ADDRESSIBILITY                              */ 00122000
*                                                                  0110 00123000
*   GENERATE REFS(IGC125,R6);                                      0110 00124000
*                                                                  0110 00125000
         USING IGC125,R6               ESTABLISH ADDRESSIBILITY FOR     00126000
*                                      MODULE                           00127000
*/*      P     SAVE RETURN ADDRESS                                   */ 00128000
*                                                                  0111 00129000
*   R13=R14;                        /* SAVE RETURN ADDRESS           */ 00130000
         LR    R13,R14                                             0111 00131000
*/*      S     SETFRR: CALL SET FRR ROUTINE                          */ 00132000
*                                                                  0112 00133000
*   CALL SETFRR;                    /* CALL SET FRR ROUTINE          */ 00134000
         BAL   @14,SETFRR                                          0112 00135000
*/*      P     LOAD 17D ABEND CODE                                   */ 00136000
*                                                                  0113 00137000
*   R8=ABEND17D;                    /* LOAD ABEND CODE IN REG 8      */ 00138000
         L     R8,@CF02566                                         0113 00139000
*/*      S     EVNTTVAL: CALL ROUTINE TO VALIDATE TABLE ADDRESS      */ 00140000
*                                                                  0114 00141000
*   CALL EVNTTVAL;                  /* CALL ROUTINE TO VALIDATE TABLE   00142000
*                                      ADDRESS                       */ 00143000
         BAL   @14,EVNTTVAL                                        0114 00144000
*/*      D     (NO,%WCONT5,YES,) WAS WAIT REQUESTED                  */ 00145000
*                                                                  0115 00146000
*   IF WAITYES=ON|WAITNO=ON THEN    /* WAS WAIT PROCESSING REQUESTED */ 00147000
         TM    WAITYES(FRRWKAR),B'11000000'                        0115 00148000
         BZ    @RF00115                                            0115 00149000
*     DO;                           /* WAIT PROCESSING REQUESTED     */ 00150000
*/*      D     (NO,,YES,%WCONT6) WAS WAIT CORRECTLY REQUESTED        */ 00151000
*                                                                  0117 00152000
*       IF WAITYES=ON&WAITNO=ON THEN/* CHECK IF WAIT WAS CORRECTLY 0117 00153000
*                                      REQUESTED                     */ 00154000
         TM    WAITYES(FRRWKAR),B'11000000'                        0117 00155000
         BNO   @RF00117                                            0117 00156000
*         DO;                       /* PARMS BAD ABEND CALLER        */ 00157000
*/*      S     EVNTABND: ABEND CALLER CODE 77D                       */ 00158000
*                                                                  0119 00159000
*           R1=ABEND77D;            /* LOAD 77D ABEND CODE           */ 00160000
         L     R1,@CF02576                                         0119 00161000
*           GOTO EVNTABND;          /* CALL ROUTINE TO CLEAN UP AND     00162000
*                                      ISSUE ABEND                   */ 00163000
         B     EVNTABND                                            0120 00164000
*         END;                                                     0121 00165000
*                                                                  0121 00166000
*/* %WCONT6: S     EVNTTUPD: GO UPDATE EVENT TABLE                   */ 00167000
*                                                                  0122 00168000
*       CALL EVNTTUPD;              /* CALL ROUTINE TO UPDATE EVENT     00169000
*                                      TABLE                         */ 00170000
@RF00117 BAL   @14,EVNTTUPD                                        0122 00171000
*     END;                                                         0123 00172000
*                                                                  0123 00173000
*/* %WCONT5: D (YES,,NO,%WCONT3) WAS ECB INIT REQUESTED              */ 00174000
*                                                                  0124 00175000
*   IF ECBYES=ON THEN               /* CHECK IF ECB INITIALIZATION 0124 00176000
*                                      REQUESTED                     */ 00177000
@RF00115 TM    ECBYES(FRRWKAR),B'00100000'                         0124 00178000
         BNO   @RF00124                                            0124 00179000
*     DO;                           /* ECB INITIALIZATION REQUESTED  */ 00180000
*/*      S     ECBINIT: CALL ROUTINE TO INITIALIZE ECB               */ 00181000
*                                                                  0126 00182000
*       CALL ECBINIT;               /* CALL ROUTINE TO INITIALIZE ECB*/ 00183000
         BAL   @14,ECBINIT                                         0126 00184000
*     END;                                                         0127 00185000
*                                                                  0127 00186000
*/* %WCONT3: D (NO,%WCONT7,YES,) WAS WAIT SPECIFIED                  */ 00187000
*                                                                  0128 00188000
*   IF WAITYES=ON|WAITNO=ON THEN    /* WAS WAIT SPECIFIED            */ 00189000
@RF00124 TM    WAITYES(FRRWKAR),B'11000000'                        0128 00190000
         BZ    @RF00128                                            0128 00191000
*     DO;                           /* WAIT PROCESSING REQUESTED     */ 00192000
*/*      S     EVNTWAIT: GO DO WAIT PROCESSING                       */ 00193000
*                                                                  0130 00194000
*       CALL EVNTWAIT;              /* CALL ROUTINE TO DO WAIT     0130 00195000
*                                      PROCESSING                    */ 00196000
         BAL   @14,EVNTWAIT                                        0130 00197000
*     END;                                                         0131 00198000
*                                                                  0131 00199000
*/* %WCONT7:  S DELFRR: GO DELETE FRR                                */ 00200000
*                                                                  0132 00201000
*   CALL DELFRR;                    /* GO DELETE FRR                 */ 00202000
@RF00128 BAL   @14,DELFRR                                          0132 00203000
*/*      P     RESTORE RETURN ADDRESS                                */ 00204000
*                                                                  0133 00205000
*   RFY                                                            0133 00206000
*    (R15) RSTD;                                                   0133 00207000
*   R15=ZERO;                       /* CLEAR REGISTER 15             */ 00208000
         SLR   R15,R15                                             0134 00209000
*   R14=R13;                        /* LOAD RETURN ADDRESS           */ 00210000
         LR    R14,R13                                             0135 00211000
*/*      R     RETURN                                                */ 00212000
*                                                                  0136 00213000
*   END IGC125;                                                    0136 00214000
@EL00002 DS    0H                                                  0136 00215000
@EF00002 DS    0H                                                  0136 00216000
@ER00002 BR    @14                                                 0136 00217000
*   RFY                                                            0137 00218000
*    (R15) UNRSTD;                                                 0137 00219000
*                                                                  0137 00220000
*/* IGC125: END                                                      */ 00221000
*                                                                  0138 00222000
*                                                                  0138 00223000
*/********************************************************************/ 00224000
*/*                                                                  */ 00225000
*/* TYPE TWO EVENTS ENTRY FOR TABLE CREATION AND DELETION            */ 00226000
*/*                                                                  */ 00227000
*/*      IEAVEVT1 IS THE ENTRY POINT FOR THE TYPE II SVC 122 ESR     */ 00228000
*/*      CODE # 5 (THERE IS NO BRANCH ENTRY SUPPORT FOR THIS SVC) .  */ 00229000
*/*      SET UP AN FRR (SETFRR). DETERMINES IF THE REQUEST IS FOR    */ 00230000
*/*      TABLE CREATION OR DELETION.                                 */ 00231000
*/*      IF FOR TABLE DELETION (REGISTER 0 = ZERO). CALLS A          */ 00232000
*/*      SUBROUTINE TO VALIDATE THE TABLE ADDRESS (EVNTTVAL).        */ 00233000
*/*      IF VALID CALLS A SUBROUTINE TO DEQUEUE AND FREE THE         */ 00234000
*/*      INDICATED TABLE (EVNTDEQT).                               0138 00235000
*/*      IF FOR TABLE CREATION (BIT 1 OF REGISTER 0 EQUAL 1),        */ 00236000
*/*      CHECKS THE NUMBER OF ENTRIES REQUESTED IF IT IS NOT         */ 00237000
*/*      BETWEEN 1 AND 32767 ABEND THE CALLER WITH A 47A. IF         */ 00238000
*/*      THE NUMBER OF ENTRIES IS VALID, CALLS A SUBROUTINE TO       */ 00239000
*/*      GETMAIN, INITIALIZE, AND QUEUE THE NEW EVENT TABLE          */ 00240000
*/*      (EVNTQUET).                                                 */ 00241000
*/*      UPON RETURN FROM EITHER EVNTDEQT OR EVNTQUET THE FRR IS     */ 00242000
*/*      DELETED (DELFRR); CLEARS REGISTER 15; LOADS THE RETURN      */ 00243000
*/*      ADDRESS AND RETURNS.                                        */ 00244000
*/*                                                                  */ 00245000
*/********************************************************************/ 00246000
*                                                                  0138 00247000
*IEAVEVT1:                                                         0138 00248000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA,NOPARMREG,NOENTREG,RETREG);     0138 00249000
*                                                                  0138 00250000
IEAVEVT1 DS    0H                                                  0139 00251000
*/* IEAVEVT1: CHART                                                  */ 00252000
*/*      E     IEAVEVT1                                              */ 00253000
*/*      P     ESTABLISH ADDRESSIBILITY                              */ 00254000
*                                                                  0139 00255000
*   GENERATE REFS(IEAVEVT1,IGC125A,R6);                            0139 00256000
*                                                                  0139 00257000
         USING IEAVEVT1,R6             ESTABLISH ADDRESSIBILITY         00258000
*                                      FOR MODULE                       00259000
         L     R6,IGC125A              LOAD ADDRESS OF TYPE ONE         00260000
*                                      ENTRY POINT                      00261000
         USING IGC125,R6               RESTABLISH ADDRESSIBILITY        00262000
*/*      P     SAVE RETURN ADDRESS                                   */ 00263000
*                                                                  0140 00264000
*   R13=R14;                        /* SAVE RETURN ADDRESS           */ 00265000
         LR    R13,R14                                             0140 00266000
*/*      S     SETFRR: GO SET FRR                                    */ 00267000
*                                                                  0141 00268000
*   CALL SETFRR;                    /* CALL ROUTINE TO SET FRR       */ 00269000
         BAL   @14,SETFRR                                          0141 00270000
*/*      D     (NO,,YES,CREATE) IS THIS A CREATE REQUEST             */ 00271000
*                                                                  0142 00272000
*   IF R0=ZERO THEN                 /* CHECK IF THIS A DELETE REQUEST*/ 00273000
         LTR   R0,R0                                               0142 00274000
         BNZ   @RF00142                                            0142 00275000
*DELETE:                                                           0143 00276000
*     DO;                           /* DELETE TABLE REQUESTED        */ 00277000
DELETE   DS    0H                                                  0144 00278000
*/*      P     LOAD ABEND CODE 17A                                   */ 00279000
*                                                                  0144 00280000
*       R8=ABEND17A;                /* LOAD ABEND CODE IN REG        */ 00281000
         L     R8,@CF02580                                         0144 00282000
*/*      S     EVNTTVAL: GO VALIDATE TABLE ADDRESS                   */ 00283000
*                                                                  0145 00284000
*       CALL EVNTTVAL;              /* CALL ROUTINE TO VALIDATE EVENT   00285000
*                                      TABLE ADDRESS                 */ 00286000
         BAL   @14,EVNTTVAL                                        0145 00287000
*/*     S  (,%DCONT2) EVNTDEQT:  GO DEQUEUE AND FREE TABLE           */ 00288000
*                                                                  0146 00289000
*       CALL EVNTDEQT;              /* CALL ROUTINE TO DEQUEUE AND 0146 00290000
*                                      FREE TABLE                    */ 00291000
         BAL   @14,EVNTDEQT                                        0146 00292000
*     END DELETE;                                                  0147 00293000
*   ELSE                            /* CREATE REQUEST                */ 00294000
*CREATE:                                                           0148 00295000
*     DO;                           /* DO CREATE PROCESSING          */ 00296000
         B     @RC00142                                            0148 00297000
@RF00142 DS    0H                                                  0148 00298000
CREATE   DS    0H                                                  0149 00299000
*/* CREATE: D (NO,,YES,%DCONT3) IS ENTRIES VALID                     */ 00300000
*                                                                  0149 00301000
*       IF ENTRIES=ZERO|ENTRIES>MAXE THEN/* CHECK ENTRIES PARM       */ 00302000
         LH    @15,ENTRIES(,FRRWKAR)                               0149 00303000
         N     @15,@CF02690                                        0149 00304000
         LTR   @15,@15                                             0149 00305000
         BZ    @RT00149                                            0149 00306000
         CLC   ENTRIES(2,FRRWKAR),@CH02602                         0149 00307000
         BNH   @RF00149                                            0149 00308000
@RT00149 DS    0H                                                  0150 00309000
*         DO;                       /* ENTRIES PARM INVALID          */ 00310000
*/*      S     EVNTABND: GO ABEND CALLER CODE 47A                    */ 00311000
*                                                                  0151 00312000
*           R1=ABEND47A;            /* LOAD ABEND CODE               */ 00313000
         L     R1,@CF02584                                         0151 00314000
*           GOTO EVNTABND;          /* CALL ROUTINE TO CLEAN UP AND     00315000
*                                      ISSUE ABEND                   */ 00316000
         B     EVNTABND                                            0152 00317000
*         END;                                                     0153 00318000
*                                                                  0153 00319000
*/* %DCONT3: S EVNTQUET: GO GET AND QUEUE NEW TABLE                  */ 00320000
*                                                                  0154 00321000
*       CALL EVNTQUET;              /* CALL ROUTINE TO GETMAIN AND 0154 00322000
*                                      QUEUE EVENT TABLE             */ 00323000
@RF00149 BAL   @14,EVNTQUET                                        0154 00324000
*     END CREATE;                                                  0155 00325000
*                                                                  0155 00326000
*/* %DCONT2:  S     DELFRR: CALL DELETE FRR ROUTINE                  */ 00327000
*                                                                  0156 00328000
*   CALL DELFRR;                    /* GO DELETE FRR                 */ 00329000
@RC00142 BAL   @14,DELFRR                                          0156 00330000
*/*      P     RESTORE RETURN ADDRESS                                */ 00331000
*                                                                  0157 00332000
*   RFY                                                            0157 00333000
*    (R15) RSTD;                                                   0157 00334000
*   R15=ZERO;                       /* CLEAR REGISTER 15             */ 00335000
         SLR   R15,R15                                             0158 00336000
*   R14=R13;                        /* RESTORE RETURN ADDRESS        */ 00337000
         LR    R14,R13                                             0159 00338000
*/*      R     RETURN                                                */ 00339000
*                                                                  0160 00340000
*   END IEAVEVT1;                                                  0160 00341000
@EL00003 DS    0H                                                  0160 00342000
@EF00003 DS    0H                                                  0160 00343000
@ER00003 BR    @14                                                 0160 00344000
*   RFY                                                            0161 00345000
*    (R15) UNRSTD;                                                 0161 00346000
*                                                                  0161 00347000
*/* IEAVEVT1: END                                                    */ 00348000
*                                                                  0162 00349000
*                                                                  0162 00350000
*/********************************************************************/ 00351000
*/*                                                                  */ 00352000
*/* ROUTINE TO VALIDATE EVENT TABLE ADDRESS                          */ 00353000
*/*                                                                  */ 00354000
*/*      THIS ROUTINE IS CALLED BY BOTH IGC125 AND IEAVEVT1          */ 00355000
*/*      ENTRIES TO VALIDATE THE TABLE ADDRESSED BY REG ONE          */ 00356000
*/*      INPUT TO THIS ROUTINE IS:                                   */ 00357000
*/*      REGISTER 1 - TABLE ADDRESS                                  */ 00358000
*/*      REGISTER 4 - TCB ADDRESS                                    */ 00359000
*/*      REGISTER 8 - ABEND CODE                                     */ 00360000
*/*      OUTPUT FROM THIS ROUTINE IS:                                */ 00361000
*/*      SUCCESSFULLY LOCATING THE EVENT TABLE, RETURN.              */ 00362000
*/*      EVENT TABLE NOT FOUND OR EVENT TABLE WAITING, ABEND.        */ 00363000
*/*           THE TCB EVENT TABLE QUEUE IS SEARCHED TO               */ 00364000
*/*      FIND A MATCHING EVENT TABLE ADDRESS. IF FOUND THE           */ 00365000
*/*      EVENT TABLE IS CHECKED FOR A WAITING CONDITION. IF          */ 00366000
*/*      THE TABLE IS NOT WAITING, RETURN.                           */ 00367000
*/*                                                                  */ 00368000
*/********************************************************************/ 00369000
*                                                                  0162 00370000
*EVNTTVAL:                                                         0162 00371000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA,NOPARMREG,NOENTREG,RETREG);     0162 00372000
*                                                                  0162 00373000
EVNTTVAL DS    0H                                                  0163 00374000
*/* EVNTTVAL: CHART                                                  */ 00375000
*/*      E     EVNTTVAL                                              */ 00376000
*/*      P     FIND EVENT TABLE QUEUE                                */ 00377000
*                                                                  0163 00378000
*   RFY                                                            0163 00379000
*    (R11) RSTD;                                                   0163 00380000
*   R11=TCBEVENT;                   /* LOAD ADDRESS OF FIRST EVENT 0164 00381000
*                                      TABLE                         */ 00382000
         L     @15,TCBEXT2(,TCBPTR)                                0164 00383000
         L     R11,TCBEVENT(,@15)                                  0164 00384000
*/*      D     (NO,,YES,CKWAIT) IS TABLE ON QUEUE                    */ 00385000
*                                                                  0165 00386000
*   DO WHILE R11Â¬=ZERO;             /* SEARCH QUEUE FOR TABLE        */ 00387000
         B     @DE00165                                            0165 00388000
@DL00165 DS    0H                                                  0166 00389000
*     IF R11=EVNTPTR THEN           /* CHECK IF TABLE FOUND          */ 00390000
         CR    R11,EVNTPTR                                         0166 00391000
         BE    @RT00166                                            0166 00392000
*       GOTO CKWAIT;                /* CHECK FOR WAITING TABLE       */ 00393000
*     R11=R11->EVNTLNK;             /* POINT TO NEXT TABLE           */ 00394000
         L     R11,EVNTLNK(,R11)                                   0168 00395000
*   END;                                                           0169 00396000
*                                                                  0169 00397000
@DE00165 LTR   R11,R11                                             0169 00398000
         BNZ   @DL00165                                            0169 00399000
*/*     S   EVNTABND: GO ABEND CALLER                                */ 00400000
*                                                                  0170 00401000
*   R1=R8;                          /* LOAD ABEND CODE INTO REG ONE  */ 00402000
         LR    R1,R8                                               0170 00403000
*   GOTO EVNTABND;                  /* GO ABEND CALLER               */ 00404000
         B     EVNTABND                                            0171 00405000
*/* CKWAIT: D (YES,,NO,TABLEOK) IS TABLE WAITING                     */ 00406000
*                                                                  0172 00407000
*CKWAIT:                                                           0172 00408000
*   IF EVNTRBPÂ¬=ZERO THEN           /* IS TABLE WAITING              */ 00409000
CKWAIT   L     @15,EVNTRBP(,EVNTPTR)                               0172 00410000
         LTR   @15,@15                                             0172 00411000
         BZ    @RF00172                                            0172 00412000
*     DO;                           /* TABLE WAITING ABEND CALLER    */ 00413000
*/*     P CHANGE ABEND CODE                                          */ 00414000
*                                                                  0174 00415000
*       R1=R8|ABEND3XX;             /* OR ABEND CODE TO 3XX          */ 00416000
         LR    R1,R8                                               0174 00417000
         O     R1,@CF02586                                         0174 00418000
*/*      S  EVNTABND: GO ABEND CALLER                                */ 00419000
*                                                                  0175 00420000
*       GOTO EVNTABND;              /* GO TO ROUTINE TO CLEAN UP AND    00421000
*                                      ABEND CALLER                  */ 00422000
         B     EVNTABND                                            0175 00423000
*     END;                                                         0176 00424000
*                                                                  0176 00425000
*/* TABLEOK: R  RETURN                                               */ 00426000
*                                                                  0177 00427000
*   RFY                                                            0177 00428000
*    (R11) UNRSTD;                                                 0177 00429000
*TABLEOK:                                                          0178 00430000
*   END EVNTTVAL;                   /* END OF VALIDITY CHECK ROUTINE */ 00431000
@EL00004 DS    0H                                                  0178 00432000
@EF00004 DS    0H                                                  0178 00433000
@ER00004 BR    @14                                                 0178 00434000
*/* EVNTTVAL: END                                                    */ 00435000
*                                                                  0179 00436000
*                                                                  0179 00437000
*/********************************************************************/ 00438000
*/*                                                                  */ 00439000
*/* ROUTINE TO UPDATE EVENT TABLE                                    */ 00440000
*/*                                                                  */ 00441000
*/*      THIS ROUTINE IS CALLED BY ENTRY IGC125 WHEN                 */ 00442000
*/*      WAIT=YES OR WAIT=NO IS SPECIFIED. THIS ROUTINE CHECKS       */ 00443000
*/*      FOR A VALID LAST SPECIFIED (THE LAST ADDRESS FALLS IN       */ 00444000
*/*      THE RANGE OF EVENT ENTRIES AND THE TABLE IS ELIGIBLE        */ 00445000
*/*      FOR UPDATE (EVNTUPR = ON)). IF THE TABLE IS ELIGIBLE FOR    */ 00446000
*/*      UPDATE ALL UNPROCESSED ENTRIES ARE MOVED TO THE TOP OF      */ 00447000
*/*      THE TABLE.                                                  */ 00448000
*/*      INPUT TO THIS ROUTINE IS:                                   */ 00449000
*/*      LAST= ADDRESS                                               */ 00450000
*/*      TABLE= ADDRESS                                              */ 00451000
*/*      VALID EVENT TABLE                                           */ 00452000
*/*      OUTPUT FROM THIS ROUTINE IS:                                */ 00453000
*/*      UPDATED EVENT TABLE                                         */ 00454000
*/*      OR ABEND 47A                                                */ 00455000
*/*                                                                  */ 00456000
*/********************************************************************/ 00457000
*                                                                  0179 00458000
*EVNTTUPD:                                                         0179 00459000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA,NOPARMREG,NOENTREG,RETREG);     0179 00460000
*                                                                  0179 00461000
EVNTTUPD DS    0H                                                  0180 00462000
*/* EVNTUPD: CHART                                                   */ 00463000
*/*      E     EVNTTUPD                                              */ 00464000
*                                                                  0180 00465000
*   RFY                                                            0180 00466000
*    (R10) RSTD;                                                   0180 00467000
*                                                                  0180 00468000
*/*      D     (YES,,NO,%UCONT1) WAS LAST SPECIFIED                  */ 00469000
*                                                                  0181 00470000
*   IF ECBYES=OFF&LASTÂ¬=ZERO THEN   /* WAS LAST SPECIFIED            */ 00471000
         TM    ECBYES(FRRWKAR),B'00100000'                         0181 00472000
         BNZ   @RF00181                                            0181 00473000
         L     @15,LAST-1(,FRRWKAR)                                0181 00474000
         LA    @15,0(,@15)                                         0181 00475000
         LTR   @15,@15                                             0181 00476000
         BZ    @RF00181                                            0181 00477000
*     DO;                           /* LAST SPECIFIED                */ 00478000
*/*      D     (NO,,YES,%UCONT1) WAS LAST VALID                      */ 00479000
*                                                                  0183 00480000
*       IF LAST>EVNTLSTA|LAST<EVNTFST|EVNTUPR=OFF THEN/* WAS LAST A     00481000
*                                      VALID REQUEST                 */ 00482000
         C     @15,EVNTLSTA(,EVNTPTR)                              0183 00483000
         BH    @RT00183                                            0183 00484000
         C     @15,EVNTFST(,EVNTPTR)                               0183 00485000
         BL    @RT00183                                            0183 00486000
         TM    EVNTUPR(EVNTPTR),B'10000000'                        0183 00487000
         BNZ   @RF00183                                            0183 00488000
@RT00183 DS    0H                                                  0184 00489000
*         DO;                       /* LAST INVALID ABEND CALLER     */ 00490000
*/*      S     EVNTABND: ABEND CALLER CODE 47D                       */ 00491000
*                                                                  0185 00492000
*           R1=ABEND47D;            /* LOAD 47D ABEND CODE           */ 00493000
         L     R1,@CF02570                                         0185 00494000
*           GOTO EVNTABND;          /* CALL ROUTINE TO CLEAN UP AND     00495000
*                                      ABEND                         */ 00496000
         B     EVNTABND                                            0186 00497000
*         END;                                                     0187 00498000
*       R10=LAST;                   /* LOAD LAST POINTER             */ 00499000
@RF00183 L     R10,LAST-1(,FRRWKAR)                                0188 00500000
         LA    R10,0(,R10)                                         0188 00501000
*     END;                                                         0189 00502000
*   ELSE                            /* LAST IS VALID                 */ 00503000
*     R10=EVNTFST;                  /* LOAD POINTER TO FIRST POSTED     00504000
*                                      ENTRY                         */ 00505000
         B     @RC00181                                            0190 00506000
@RF00181 L     R10,EVNTFST(,EVNTPTR)                               0190 00507000
*/* %UCONT1: D  (YES,,NO,%UCONT3) SHOULD EVENT TABLE BE UPDATED      */ 00508000
*                                                                  0191 00509000
*   IF EVNTUPR=ON THEN              /* SHOULD EVENT TABLE BE UPDATED */ 00510000
@RC00181 TM    EVNTUPR(EVNTPTR),B'10000000'                        0191 00511000
         BNO   @RF00191                                            0191 00512000
*     DO;                           /* TABLE IS OK TO UPDATE         */ 00513000
*/*     D  (YES,,NO,%UCONT3) IS TABLE POSTED                         */ 00514000
*                                                                  0193 00515000
*       IF EVNTLSTAÂ¬=ADDR(EVNTDUMY) THEN/* IS TABLE POSTED           */ 00516000
         L     @15,EVNTLSTA(,EVNTPTR)                              0193 00517000
         LA    @12,EVNTDUMY(,EVNTPTR)                              0193 00518000
         CR    @15,@12                                             0193 00519000
         BE    @RF00193                                            0193 00520000
*         DO;                       /* TABLE IS POSTED               */ 00521000
*/*     D   (NO,,YES,%UCONT2) ANY UNPROCESSED ENTRIES                */ 00522000
*                                                                  0195 00523000
*           IF R10=EVNTLSTA THEN    /* ARE ALL ENTRIES PROCESSED     */ 00524000
         CR    R10,@15                                             0195 00525000
         BNE   @RF00195                                            0195 00526000
*             DO;                   /* LAST POINTED TO LAST          */ 00527000
*/*      P     (,%UCONT3) REINITIALIZE ENTRIES POINTERS              */ 00528000
*                                                                  0197 00529000
*               EVNTLSTA=ADDR(EVNTDUMY);/* STORE CORRECT LAST ACTIVE    00530000
*                                      POINTER                       */ 00531000
         ST    @12,EVNTLSTA(,EVNTPTR)                              0197 00532000
*               EVNTFST->EVNTENTY(1)=ZERO;/* ZERO FIRST EVENT ENTRY  */ 00533000
         L     @15,EVNTFST(,EVNTPTR)                               0198 00534000
         SLR   @12,@12                                             0198 00535000
         ST    @12,EVNTENTY(,@15)                                  0198 00536000
*             END;                                                 0199 00537000
*           ELSE                    /* LAST DID NOT POINT TO LAST    */ 00538000
*             DO;                   /* MOVE UNPROCESSED ENTRIES TO 0200 00539000
*                                      TOP OF TABLE                  */ 00540000
         B     @RC00195                                            0200 00541000
@RF00195 DS    0H                                                  0201 00542000
*               RFY                                                0201 00543000
*                (R11,                                             0201 00544000
*                 R12) RSTD;                                       0201 00545000
*                                                                  0201 00546000
*/* %UCONT2: P  MOVE ALL UNPROCESSED ENTRIES TO TOP OF TABLE         */ 00547000
*                                                                  0202 00548000
*               R11=EVNTFST;        /* GET TOP OF TABLE ADDRESS      */ 00549000
         L     R11,EVNTFST(,EVNTPTR)                               0202 00550000
*               DO WHILE R10Â¬=EVNTLSTA;/* DO UNTIL ALL ENTRIES ARE 0    00551000
*                                      MOVED TO TOP                  */ 00552000
         B     @DE00203                                            0203 00553000
@DL00203 DS    0H                                                  0204 00554000
*                 R10=R10+4;        /* INCRUMENT NEXT UNPROCESSED  0204 00555000
*                                      EVENT ADDRRESS                */ 00556000
         LA    @15,4                                               0204 00557000
         ALR   R10,@15                                             0204 00558000
*                 R12=R10->EVNTENTY(1);/* MOVE EVENT ENTRY UP        */ 00559000
         L     R12,EVNTENTY(,R10)                                  0205 00560000
*                 R11->EVNTENTY(1)=R12;/* MOVE EVENT ENTRY UP        */ 00561000
         ST    R12,EVNTENTY(,R11)                                  0206 00562000
*                 R11=R11+4;        /* INCREMENT NEXT EVENT ENTRY  0207 00563000
*                                      ADDRESS                       */ 00564000
         ALR   R11,@15                                             0207 00565000
*               END;                                               0208 00566000
@DE00203 C     R10,EVNTLSTA(,EVNTPTR)                              0208 00567000
         BNE   @DL00203                                            0208 00568000
*               EVNTLSTA=R11-4;     /* STORE LAST ACTIVE EVENT ENTRY    00569000
*                                      ADDRESS                       */ 00570000
         LR    @15,R11                                             0209 00571000
         SL    @15,@CF00037                                        0209 00572000
         ST    @15,EVNTLSTA(,EVNTPTR)                              0209 00573000
*             END;                                                 0210 00574000
*         END;                                                     0211 00575000
*     END;                                                         0212 00576000
*                                                                  0212 00577000
*/* %UCONT3: R RETURN                                                */ 00578000
*                                                                  0213 00579000
*   RFY                                                            0213 00580000
*    (R10,                                                         0213 00581000
*     R11,                                                         0213 00582000
*     R12) UNRSTD;                                                 0213 00583000
*   END EVNTTUPD;                                                  0214 00584000
*                                                                  0214 00585000
@EL00005 DS    0H                                                  0214 00586000
@EF00005 DS    0H                                                  0214 00587000
@ER00005 BR    @14                                                 0214 00588000
*/* EVNTUPD: END                                                     */ 00589000
*                                                                  0215 00590000
*                                                                  0215 00591000
*/********************************************************************/ 00592000
*/*                                                                  */ 00593000
*/* ROUTINE TO INITIALIZE ECB                                        */ 00594000
*/*                                                                  */ 00595000
*/*      THIS ROUTINE IS CALLED BY ENTRY IGC125 WHEN                 */ 00596000
*/*      ECB INITIALIZATION IS REQUESTED                             */ 00597000
*/*      INPUT TO THIS ROUTINE IS:                                   */ 00598000
*/*      ECB= ADDRESS                                                */ 00599000
*/*      TABLE= ADDRESS                                              */ 00600000
*/*      OUTPUT FROM THIS ROUTINE IS:                                */ 00601000
*/*      IF THE ECB WAS POSTED ITS ADDRESS IS ADDED TO               */ 00602000
*/*           THE LIST OF COMPLETED EVENT ENTRIES                    */ 00603000
*/*      IF THE ECB WAS NOT POSTED IT WILL BE INITIALIZED TO THE     */ 00604000
*/*           EVENT FORMAT X'80XXXXX1'                               */ 00605000
*/*      IF THE ECB WAS WAITED ON ABEND 67D                          */ 00606000
*/*      IF THE TABLE IS FULL AND ECB POSTED ABEND 87D               */ 00607000
*/*      IF THE ECB ADDRESS IS NOT VALID FOR CALLER ABEND 57D        */ 00608000
*/*                                                                  */ 00609000
*/********************************************************************/ 00610000
*                                                                  0215 00611000
*ECBINIT:                                                          0215 00612000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA,NOPARMREG,NOENTREG,RETREG);     0215 00613000
*                                                                  0215 00614000
ECBINIT  DS    0H                                                  0216 00615000
*/* ECBINIT: CHART                                                   */ 00616000
*/*      E     ECBINIT                                               */ 00617000
*                                                                  0216 00618000
*   RFY                                                            0216 00619000
*    (R10,                                                         0216 00620000
*     R11,                                                         0216 00621000
*     R12) RSTD;                                                   0216 00622000
*   FRRABEND=ABEND57D;              /* STORE ABEND CODE TO PASS TO 0217 00623000
*                                      FRR IF ECB NOT VALID          */ 00624000
         MVC   FRRABEND(4,FRRWKAR),@CF02572                        0217 00625000
*EVNTPCK:                                                          0218 00626000
*   R12=ECBPTR;                     /* GET POINTER TO ECB            */ 00627000
EVNTPCK  L     R12,ECBPTR-1(,FRRWKAR)                              0218 00628000
         LA    R12,0(,R12)                                         0218 00629000
*   RFY                                                            0219 00630000
*    (ECB) BASED(R12);              /* ECB NOW BASED ON R12          */ 00631000
*   IF RBUSKEY=ON THEN              /* IS CALLER PROBLEM KEY @ZA31793*/ 00632000
         TM    RBUSKEY(RBSECPTR),B'10000000'                       0220 00633000
         BNO   @RF00220                                            0220 00634000
*     DO;                           /*                       @ZA31793*/ 00635000
*       SPKA(TCBPKF);               /* GO TO USER KEY        @ZA31793*/ 00636000
         SLR   @15,@15                                             0222 00637000
         IC    @15,TCBPKF(,TCBPTR)                                 0222 00638000
         SPKA  0(@15)                                              0222 00639000
*       R11=ECB;                    /* SAVE ECB FOR WAITING/POSTED 0223 00640000
*                                      CHECK AND FOR COMPARE AND SWAP   00641000
*                                      (SO IT CANNOT BE UPDATED)   0223 00642000
*                                                            @ZA31793*/ 00643000
         L     R11,ECB(,R12)                                       0223 00644000
*       SPKA(ZERO);                 /* GO BACK TO KEY ZERO   @ZA31793*/ 00645000
         SLR   @15,@15                                             0224 00646000
         SPKA  0(@15)                                              0224 00647000
*     END;                          /*                       @ZA31793*/ 00648000
*   ELSE                                                           0226 00649000
*     R11=ECB;                      /* SAVE ECB FOR COMPARE AND SWAP */ 00650000
         B     @RC00220                                            0226 00651000
@RF00220 L     R11,ECB(,R12)                                       0226 00652000
*/* EVNTPCK: D     (YES,,NO,%ICONT1) IS ECB POSTED                   */ 00653000
*                                                                  0227 00654000
*   IF(R11&POSTED)Â¬=0 THEN          /* IS ECB POSTED         @ZA31793*/ 00655000
@RC00220 SLR   @15,@15                                             0227 00656000
         LR    @03,R11                                             0227 00657000
         N     @03,@CF02600                                        0227 00658000
         CR    @03,@15                                             0227 00659000
         BE    @RF00227                                            0227 00660000
*     DO;                           /* ECB POSTED PLACE ADDRESS IN 0228 00661000
*                                      TABLE                         */ 00662000
*       FRRABEND=ZERO;              /* ZERO ABEND CODE ECB OK        */ 00663000
         ST    @15,FRRABEND(,FRRWKAR)                              0229 00664000
*/*      D     (YES,,NO,%ICONT2) IS TABLE FULL                       */ 00665000
*                                                                  0230 00666000
*       IF EVNTLST=EVNTLSTA THEN    /* IS TABLE FULL                 */ 00667000
         CLC   EVNTLST(4,EVNTPTR),EVNTLSTA(EVNTPTR)                0230 00668000
         BNE   @RF00230                                            0230 00669000
*         DO;                       /* TABLE FULL ABEND CALLER       */ 00670000
*/*      S     EVNTABND: ABEND CALLER CODE 87D                       */ 00671000
*                                                                  0232 00672000
*           R1=ABEND87D;            /* LOAD 87D ABEND CODE           */ 00673000
         L     R1,@CF02578                                         0232 00674000
*           GOTO EVNTABND;          /* CALL ROUTINE TO CLEAN UP AND     00675000
*                                      ABEND                         */ 00676000
         B     EVNTABND                                            0233 00677000
*         END;                                                     0234 00678000
*                                                                  0234 00679000
*/* %ICONT2: P (,ECBOK) POST COMPLETED EVENT TO TABLE                */ 00680000
*                                                                  0235 00681000
*       EVNTEPTR=EVNTLSTA;          /* GET POINTER TO LAST POSTED  0235 00682000
*                                      ENTRY                         */ 00683000
@RF00230 L     EVNTEPTR,EVNTLSTA(,EVNTPTR)                         0235 00684000
*       EVNTENTY(2)=R12;            /* POST ECB TO TABLE             */ 00685000
         ST    R12,EVNTENTY+4(,EVNTEPTR)                           0236 00686000
*       EVNTENDL(2)=ON;             /* TURN ON END OF LIST INDICATOR */ 00687000
         OI    EVNTENDL+4(EVNTEPTR),B'10000000'                    0237 00688000
*       EVNTLSTA=ADDR(EVNTENTY(2)); /* UPDATE LAST ACTIVE EVENT    0238 00689000
*                                      POINTER                       */ 00690000
         LA    @15,EVNTENTY+4(,EVNTEPTR)                           0238 00691000
         ST    @15,EVNTLSTA(,EVNTPTR)                              0238 00692000
*       EVNTENDL(1)=OFF;            /* TURN OFF END OF LIST IN     0239 00693000
*                                      PREVIOUS ENTRY                */ 00694000
         NI    EVNTENDL(EVNTEPTR),B'01111111'                      0239 00695000
*     END;                                                         0240 00696000
*   ELSE                            /* ECB NOT POSTED                */ 00697000
*     DO;                           /* INITIALIZE ECB                */ 00698000
         B     @RC00227                                            0241 00699000
@RF00227 DS    0H                                                  0242 00700000
*/* %ICONT1: D (YES,,NO,%ICONT4) WAS ECB WAITED ON                   */ 00701000
*                                                                  0242 00702000
*       IF(R11&WAITING)Â¬=0 THEN     /* WAS ECB WAIT BIT ON   @ZA31793*/ 00703000
         LR    @15,R11                                             0242 00704000
         N     @15,@CF02598                                        0242 00705000
         LTR   @15,@15                                             0242 00706000
         BZ    @RF00242                                            0242 00707000
*         DO;                       /* ECB WAITED ON ABEND CALLER    */ 00708000
*/*      S     EVNTABND: ABEND CALLER CODE 67D                       */ 00709000
*                                                                  0244 00710000
*           R1=ABEND67D;            /* LOAD 67D ABEND CODE           */ 00711000
         L     R1,@CF02574                                         0244 00712000
*           GOTO EVNTABND;          /* CALL ROUTINE TO CLEAN UP AND     00713000
*                                      ABEND CALLER                  */ 00714000
         B     EVNTABND                                            0245 00715000
*         END;                                                     0246 00716000
*                                                                  0246 00717000
*/* %ICONT4: D (NO,,YES,%ICONT5) WAS CALLER SYSTEM KEY               */ 00718000
*                                                                  0247 00719000
*       IF RBUSKEY=ON THEN          /* IS CALLER SYSTEM KEY          */ 00720000
@RF00242 TM    RBUSKEY(RBSECPTR),B'10000000'                       0247 00721000
         BNO   @RF00247                                            0247 00722000
*         DO;                       /* CALLER NOT IN SYSTEM KEY      */ 00723000
*/*      D     (NO,,YES,%ICONT5) ECB COM TASK ECB                    */ 00724000
*                                                                  0249 00725000
*           IF R12Â¬=CHECBP THEN     /* IS ECB COM TASK ECB           */ 00726000
         L     @15,TCBJSCB(,TCBPTR)                                0249 00727000
         L     @15,CSCBPTR(,@15)                                   0249 00728000
         C     R12,CHECBP(,@15)                                    0249 00729000
         BE    @RF00249                                            0249 00730000
*             DO;                   /* NO VALIDITY CHECK ECB ADDRESS */ 00731000
*/*      P     VALIDITY CHECK ECB                                    */ 00732000
*                                                                  0251 00733000
*               /*****************************************************/ 00734000
*               /*                                                   */ 00735000
*               /* VALIDITY CHECK ECB ADDRESS IF NOT IN USER KEY FRR */ 00736000
*               /* WILL GET CONTROL AND CHANGE COMPLETION CODE TO    */ 00737000
*               /* THAT IN FRRABEND                                  */ 00738000
*               /*                                                   */ 00739000
*               /*****************************************************/ 00740000
*                                                                  0251 00741000
*               SPKA(TCBPKF);       /* GO TO USER KEY                */ 00742000
         SLR   @15,@15                                             0251 00743000
         IC    @15,TCBPKF(,TCBPTR)                                 0251 00744000
         SPKA  0(@15)                                              0251 00745000
*               R10=ECB;            /* GET ECB CONTENTS FOR VALIDITY    00746000
*                                      CHECK                         */ 00747000
         L     R10,ECB(,R12)                                       0252 00748000
*LOOP3:                                                            0253 00749000
*               CS(R10,R10,ECB);    /* COMPARE AND SWAP ECB CONTENTS    00750000
*                                      TO CHECK VALIDITY             */ 00751000
LOOP3    CS    R10,@10,ECB(R12)                                    0253 00752000
*               BC(7,LOOP3);        /* BRANCH TILL ECB STORED        */ 00753000
         BC    7,LOOP3                                             0254 00754000
*               SPKA(ZERO);         /* GO BACK TO KEY ZERO           */ 00755000
         SLR   @15,@15                                             0255 00756000
         SPKA  0(@15)                                              0255 00757000
*             END;                                                 0256 00758000
*         END;                                                     0257 00759000
*                                                                  0257 00760000
@RF00249 DS    0H                                                  0258 00761000
*/* %ICONT5:  L COMPARE AND SWAP ECB INITIALIZED                     */ 00762000
*                                                                  0258 00763000
*       R10=R1|EVENTECB;            /* SET UP EVENTS ECB CONTENTS    */ 00764000
@RF00247 LR    R10,R1                                              0258 00765000
         O     R10,@CF02596                                        0258 00766000
*LOOP2:                                                            0259 00767000
*       CS(R11,R10,ECB);            /* COMPARE AND SWAP ECB        0259 00768000
*                                      INITIALIZED                   */ 00769000
LOOP2    CS    R11,@10,ECB(R12)                                    0259 00770000
*/*      D     (YES,ECBOK,NO,EVNTPCK) COMPARE AND SWAP OK            */ 00771000
*                                                                  0260 00772000
*       BC(7,EVNTPCK);              /* COMPARE AND SWAP FAILED START    00773000
*                                      OVER                          */ 00774000
         BC    7,EVNTPCK                                           0260 00775000
*ECBOK:                                                            0261 00776000
*                                                                  0261 00777000
*/* ECBOK: R RETURN                                                  */ 00778000
*                                                                  0261 00779000
*       FRRABEND=ZERO;              /* CLEAR ABEND CODE ECB OK       */ 00780000
ECBOK    SLR   @15,@15                                             0261 00781000
         ST    @15,FRRABEND(,FRRWKAR)                              0261 00782000
*     END;                                                         0262 00783000
*   RFY                                                            0263 00784000
*    (R10,                                                         0263 00785000
*     R11,                                                         0263 00786000
*     R12) UNRSTD;                                                 0263 00787000
*   RFY                                                            0264 00788000
*    (ECB) BASED(ECBPTR);           /* ECB NOW BASED ON ECBPTR       */ 00789000
*   END ECBINIT;                                                   0265 00790000
*                                                                  0265 00791000
@EL00006 DS    0H                                                  0265 00792000
@EF00006 DS    0H                                                  0265 00793000
@ER00006 BR    @14                                                 0265 00794000
*/* ECBINIT: END                                                     */ 00795000
*                                                                  0266 00796000
*                                                                  0266 00797000
*/********************************************************************/ 00798000
*/*                                                                  */ 00799000
*/* ROUTINE TO DO EVENT WAIT PROCESSING                              */ 00800000
*/*                                                                  */ 00801000
*/*      THIS ROUTINE IS CALLED BY ENTRY IGC125 WHEN                 */ 00802000
*/*      WAIT=YES OR WAIT=NO IS SPECIFIED                            */ 00803000
*/*      OUTPUT FROM THIS ROUTINE IS:                                */ 00804000
*/*      IF THE CALLER SHOULD WAIT (NO POSTED ENTRIES TO THE TABLE   */ 00805000
*/*      AND WAIT=YES SPECIFIED) THE RB ADDRESS IS STORED IN THE     */ 00806000
*/*      EVENT TABLE, THE RB WAIT COUNT IS SET TO 1, THE RB EXPLICIT */ 00807000
*/*      WAIT BIT IS TURNED ON, THE ASCB COUNT OF READY TCBS IS      */ 00808000
*/*      DECREMENTED BY ONE, AND IF THE COUNT OF READY TCBS WENT TO  */ 00809000
*/*      ZERO THE ASCB SHORT WAIT COUNT IS INCREMENTED BY ONE.       */ 00810000
*/*      REGISTER ONE IS UPDATED TO POINT AT THE FIRST COMPLETED     */ 00811000
*/*      EVENT OR IF THE CALLER SPECIFIED WAIT=NO AND THERE ARE NO   */ 00812000
*/*      COMPLETED EVENTS REGISTER ONE IS SET TO ZERO.               */ 00813000
*/*                                                                  */ 00814000
*/********************************************************************/ 00815000
*                                                                  0266 00816000
*EVNTWAIT:                                                         0266 00817000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA,NOPARMREG,NOENTREG,RETREG);     0266 00818000
*                                                                  0266 00819000
EVNTWAIT DS    0H                                                  0267 00820000
*/* EVNTWAIT: CHART                                                  */ 00821000
*/*      E  EVNTWAIT                                                 */ 00822000
*/*      D    (YES,,NO,%WTCONT1) SHOULD RB WAIT                      */ 00823000
*                                                                  0267 00824000
*   IF EVNTLSTA=ADDR(EVNTDUMY)&WAITYES=ON THEN/* NO POSTED EVENTS AND   00825000
*                                      WAIT YES REQUESTED            */ 00826000
         LA    @15,EVNTDUMY(,EVNTPTR)                              0267 00827000
         C     @15,EVNTLSTA(,EVNTPTR)                              0267 00828000
         BNE   @RF00267                                            0267 00829000
         TM    WAITYES(FRRWKAR),B'10000000'                        0267 00830000
         BNO   @RF00267                                            0267 00831000
*     DO;                           /* CALLER IS GOING TO WAIT       */ 00832000
*/*      P     STORE RB ADDRESS IN EVENT TABLE                       */ 00833000
*                                                                  0269 00834000
*       EVNTRBP=RBSECPTR;           /* STORE RB ADDRESS IN EVENT   0269 00835000
*                                      TABLE                         */ 00836000
         ST    RBSECPTR,EVNTRBP(,EVNTPTR)                          0269 00837000
*/*      P     TURN ON EXPLICIT WAIT INDICATOR IN RB                 */ 00838000
*                                                                  0270 00839000
*       RBXWAIT=ON;                 /* TURN ON EXPLICIT WAIT       0270 00840000
*                                      INDICATOR IN RB               */ 00841000
         LR    @15,RBSECPTR                                        0270 00842000
         AL    @15,@CF02693                                        0270 00843000
         OI    RBXWAIT-56(@15),B'01000000'                         0270 00844000
*/*      L     COMPARE AND SWAP ASCBTCBS -1                          */ 00845000
*                                                                  0271 00846000
*       RFY                                                        0271 00847000
*        (R11,                                                     0271 00848000
*         R12) RSTD;                                               0271 00849000
*       R11=ASCBTCBS;               /* LOAD COUNT OF READY TCBS      */ 00850000
         L     R11,ASCBTCBS(,ASCBPTR)                              0272 00851000
*LOOP1:                                                            0273 00852000
*       R12=R11-1;                  /* DECRUMENT COUNT               */ 00853000
LOOP1    LR    R12,R11                                             0273 00854000
         BCTR  R12,0                                               0273 00855000
*       CS(R11,R12,ASCBTCBS);       /* COMPARE AND SWAP READY COUNT  */ 00856000
         CS    R11,@12,ASCBTCBS(ASCBPTR)                           0274 00857000
*       BC(7,LOOP1);                /* COMPARE AND SWAP FAILED TRY 0275 00858000
*                                      AGAIN                         */ 00859000
         BC    7,LOOP1                                             0275 00860000
*       RFY                                                        0276 00861000
*        (R11) UNRSTD;                                             0276 00862000
*                                                                  0276 00863000
*/*      P     STORE WAIT COUNT OF ONE IN RB                         */ 00864000
*                                                                  0277 00865000
*       RBWCF=1;                    /* STORE WAIT COUNT OF ONE IN RB */ 00866000
         MVI   RBWCF(RBSECPTR),X'01'                               0277 00867000
*/*      D     (YES,,NO,%WTCONT1) IS ASCBTCBS ZERO                   */ 00868000
*                                                                  0278 00869000
*       IF R12=ZERO THEN            /* DID ASCBTCBS GO TO ZERO       */ 00870000
         LTR   R12,R12                                             0278 00871000
         BNZ   @RF00278                                            0278 00872000
*         DO;                       /* ASCBTCBS WENT TO ZERO         */ 00873000
*/*      P     INCREMENT SHORT WAIT COUNT IN ASCB                    */ 00874000
*                                                                  0280 00875000
*           ASCBSWCT=ASCBSWCT+1;    /* INCREMENT SHORT WAIT COUNT    */ 00876000
         LA    @15,1                                               0280 00877000
         AH    @15,ASCBSWCT(,ASCBPTR)                              0280 00878000
         STH   @15,ASCBSWCT(,ASCBPTR)                              0280 00879000
*         END;                                                     0281 00880000
*       RFY                                                        0282 00881000
*        (R12) UNRSTD;                                             0282 00882000
@RF00278 DS    0H                                                  0283 00883000
*     END;                                                         0283 00884000
*                                                                  0283 00885000
*/* %WTCONT1: D  (YES,,NO,%WTCONT4) WAS WAIT=NO & NONE POSTED        */ 00886000
*                                                                  0284 00887000
*   IF EVNTLSTA=ADDR(EVNTDUMY)&WAITNO=ON THEN/* CALLER NOT WAITING 0284 00888000
*                                      AND NO POSTED EVENTS          */ 00889000
@RF00267 LA    @15,EVNTDUMY(,EVNTPTR)                              0284 00890000
         C     @15,EVNTLSTA(,EVNTPTR)                              0284 00891000
         BNE   @RF00284                                            0284 00892000
         TM    WAITNO(FRRWKAR),B'01000000'                         0284 00893000
         BNO   @RF00284                                            0284 00894000
*     DO;                           /* NO POSTED EVENTS AND WAIT=NO  */ 00895000
*/*      P     (,%WTCONT3) RETURN ZERO IN REG ONE                    */ 00896000
*                                                                  0286 00897000
*       EVNTUPR=OFF;                /* TURN OFF UPDATE TABLE       0286 00898000
*                                      INDICATOR                     */ 00899000
         NI    EVNTUPR(EVNTPTR),B'01111111'                        0286 00900000
*       R1=ZERO;                    /* RETURN A ZERO IN REG ONE      */ 00901000
         SLR   R1,R1                                               0287 00902000
*     END;                                                         0288 00903000
*   ELSE                            /* POSTED EVENTS OR WAIT=YES     */ 00904000
*     DO;                           /* RETURN FIRST POSTED           */ 00905000
         B     @RC00284                                            0289 00906000
@RF00284 DS    0H                                                  0290 00907000
*/* %WTCONT4: P  RETURN POINTER TO FIRST POSTED EVENT                */ 00908000
*                                                                  0290 00909000
*       EVNTUPR=ON;                 /* TURN ON UPDATE TABLE INDICATOR*/ 00910000
         OI    EVNTUPR(EVNTPTR),B'10000000'                        0290 00911000
*       R1=EVNTFST;                 /* RETURN POINTER TO FIRST POSTED*/ 00912000
         L     R1,EVNTFST(,EVNTPTR)                                0291 00913000
*     END;                                                         0292 00914000
*                                                                  0292 00915000
*/* %WTCONT3:  R     RETURN                                          */ 00916000
*                                                                  0293 00917000
*   END EVNTWAIT;                                                  0293 00918000
*                                                                  0293 00919000
@EL00007 DS    0H                                                  0293 00920000
@EF00007 DS    0H                                                  0293 00921000
@ER00007 BR    @14                                                 0293 00922000
*/* EVNTWAIT: END                                                    */ 00923000
*                                                                  0294 00924000
*                                                                  0294 00925000
*/********************************************************************/ 00926000
*/*                                                                  */ 00927000
*/* ROUTINE TO DEQUEUE AND FREE EVENT TABLE                          */ 00928000
*/*                                                                  */ 00929000
*/*      THIS ROUTINE IS CALLED BY ENTRY IEAVEVT1 WHEN               */ 00930000
*/*      EVENT TABLE DELETION IS REQUESTED.                          */ 00931000
*/*      THIS ROUTINE WILL FIND THE EVENT TABLE , DEQUEUE IT FROM    */ 00932000
*/*      THE EVENT TABLE QUEUE, GET THE EVENT TABLE LENGTH FROM      */ 00933000
*/*      THE DEQUEUED EVENT TABLE , AND GO TO FREEMAIN TO FREE THE   */ 00934000
*/*      TABLE.                                                    0294 00935000
*/*                                                                  */ 00936000
*/********************************************************************/ 00937000
*                                                                  0294 00938000
*EVNTDEQT:                                                         0294 00939000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA,NOPARMREG,NOENTREG,RETREG);     0294 00940000
*                                                                  0294 00941000
EVNTDEQT DS    0H                                                  0295 00942000
*/* EVNTDEQT: CHART                                                  */ 00943000
*/*      E     EVNTDEQT                                              */ 00944000
*                                                                  0295 00945000
*   RFY                                                            0295 00946000
*    (R10,                                                         0295 00947000
*     R12) RSTD;                                                   0295 00948000
*   R10=TCBEVENT;                   /* GET TOP EVENT TABLE POINTER   */ 00949000
         L     @15,TCBEXT2(,TCBPTR)                                0296 00950000
         L     R10,TCBEVENT(,@15)                                  0296 00951000
*/*      P     FIND AND DEQUEUE EVENT TABLE                          */ 00952000
*                                                                  0297 00953000
*   IF EVNTPTR=R10 THEN             /* DEQUEUE TOP TABLE             */ 00954000
         CR    EVNTPTR,R10                                         0297 00955000
         BNE   @RF00297                                            0297 00956000
*     DO;                           /* TABLE IS FIRST IN QUEUE       */ 00957000
*       TCBEVENT=EVNTLNK;           /* DEQUEUE TOP EVENT TABLE       */ 00958000
         L     @11,EVNTLNK(,EVNTPTR)                               0299 00959000
         ST    @11,TCBEVENT(,@15)                                  0299 00960000
*     END;                                                         0300 00961000
*   ELSE                            /* TABLE NOT HEAD OF QUEUE       */ 00962000
*     DO;                           /* FIND TABLE                    */ 00963000
         B     @RC00297                                            0301 00964000
@RF00297 DS    0H                                                  0302 00965000
*       DO WHILE R10->EVNTLNKÂ¬=EVNTPTR;                            0302 00966000
         B     @DE00302                                            0302 00967000
@DL00302 DS    0H                                                  0303 00968000
*         R10=R10->EVNTLNK;         /* POINT TO NEXT EVENT TABLE     */ 00969000
         L     R10,EVNTLNK(,R10)                                   0303 00970000
*       END;                                                       0304 00971000
@DE00302 C     EVNTPTR,EVNTLNK(,R10)                               0304 00972000
         BNE   @DL00302                                            0304 00973000
*       R10->EVNTLNK=EVNTLNK;       /* DEQUEUE EVENT TABLE           */ 00974000
         L     @15,EVNTLNK(,EVNTPTR)                               0305 00975000
         ST    @15,EVNTLNK(,R10)                                   0305 00976000
*     END;                                                         0306 00977000
*   R0=EVNTLNTH;                    /* GET EVENT TABLE LENGTH        */ 00978000
@RC00297 L     R0,EVNTLNTH-1(,EVNTPTR)                             0307 00979000
         ICM   R0,8,@CB02695                                       0307 00980000
*/*      S     FREEMAIN: FREE EVENT TABLE                            */ 00981000
*                                                                  0308 00982000
*   R12=R14;                        /* SAVE RETURN ADDRESS           */ 00983000
         LR    R12,R14                                             0308 00984000
*   GENERATE;                                                      0309 00985000
         FREEMAIN RC,SP=253,BRANCH=YES,LV=(0),A=(1)                     00986000
*   R14=R12;                        /* RESTORE RETURN ADDRESS        */ 00987000
         LR    R14,R12                                             0310 00988000
*   RFY                                                            0311 00989000
*    (R10,                                                         0311 00990000
*     R12) UNRSTD;                                                 0311 00991000
*                                                                  0311 00992000
*/*      R     RETURN                                                */ 00993000
*/* EVNTDEQT: END                                                    */ 00994000
*                                                                  0312 00995000
*   END EVNTDEQT;                                                  0312 00996000
@EL00008 DS    0H                                                  0312 00997000
@EF00008 DS    0H                                                  0312 00998000
@ER00008 BR    @14                                                 0312 00999000
*                                                                  0313 01000000
*/********************************************************************/ 01001000
*/*                                                                  */ 01002000
*/* ROUTINE TO GET AND QUEUE EVENT TABLE                             */ 01003000
*/*                                                                  */ 01004000
*/*      THIS ROUTINE IS CALLED BY ENTRY IEAVEVT1 WHEN               */ 01005000
*/*      EVENT TABLE CREATION IS REQUESTED.                          */ 01006000
*/*      THIS ROUTINE WILL COMPUTE THE EVENT TABLE LENGTH ROUNDING   */ 01007000
*/*      IT UP TO A DOUBLE WORD LENGTH, REQUEST THE STORAGE IN SP    */ 01008000
*/*      253 FROM GETMAIN, CLEAR THE EVENT TABLE HEADER AND THE      */ 01009000
*/*      FIRST ENTRY, INITIALIZE THE HEADER WITH THE TCB ADDRESS,    */ 01010000
*/*      THE LENGTH OF THE EVENT TABLE, THE ADDRESS OF THE FIRST     */ 01011000
*/*      EVENT TABLE ENTRY AND THE LAST ENTRY, AND THEN THE EVENT    */ 01012000
*/*      TABLE WILL BE QUEUED TO THE TOP OF THE EVENT TABLE QUEUE.   */ 01013000
*/*                                                                  */ 01014000
*/********************************************************************/ 01015000
*                                                                  0313 01016000
*EVNTQUET:                                                         0313 01017000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA,NOPARMREG,NOENTREG,RETREG);     0313 01018000
*                                                                  0313 01019000
EVNTQUET DS    0H                                                  0314 01020000
*/* EVNTQUET: CHART                                                  */ 01021000
*/*      E     EVNTQUET                                              */ 01022000
*/*      P     COMPUTE TABLE LENGTH                                  */ 01023000
*                                                                  0314 01024000
*   RFY                                                            0314 01025000
*    (R10,                                                         0314 01026000
*     R11,                                                         0314 01027000
*     R12) RSTD;                                                   0314 01028000
*   R10=ENTRIES;                    /* LOAD NUMBER OF ENTRIES      0315 01029000
*                                      REQUESTED                     */ 01030000
         LH    R10,ENTRIES(,FRRWKAR)                               0315 01031000
         N     R10,@CF02690                                        0315 01032000
*   R11=((((R10*4+(LENGTH(EVNTBEGN)))+7)/8)*8);/* COMPUTE LENGTH OF     01033000
*                                      EVENT TABLE                   */ 01034000
         LR    @02,R10                                             0316 01035000
         SLA   @02,2                                               0316 01036000
         AL    @02,@CF02688                                        0316 01037000
         SRDA  @02,32                                              0316 01038000
         D     @02,@CF00053                                        0316 01039000
         SLA   @03,3                                               0316 01040000
         LR    R11,@03                                             0316 01041000
*/*      S     GETMAIN: GET EVENT TABLE SP 253                       */ 01042000
*                                                                  0317 01043000
*   R12=R14;                        /* SAVE RETURN ADDRESS           */ 01044000
         LR    R12,R14                                             0317 01045000
*   GENERATE;                                                      0318 01046000
         GETMAIN RU,SP=253,LV=(R11),BRANCH=YES                 @YM30458 01047000
*   R14=R12;                        /* RESTORE RETURN ADDRESS        */ 01048000
         LR    R14,R12                                             0319 01049000
*/*      L     INITIALIZE EVENT TABLE HEADER                         */ 01050000
*                                                                  0320 01051000
*   EVNTPTR=R1;                     /* GET EVENT TABLE POINTER       */ 01052000
*   EVNT=EVNT&&EVNT;                /* CLEAR EVENT TABLE HEADER      */ 01053000
         XC    EVNT(44,EVNTPTR),EVNT(EVNTPTR)                      0321 01054000
*   EVNTLNTH=R11;                   /* STORE LENGTH OF TABLE IN    0322 01055000
*                                      HEADER                        */ 01056000
         STCM  R11,7,EVNTLNTH(EVNTPTR)                             0322 01057000
*   EVNTTCBP=TCBPTR;                /* STORE ADDRESS OF TCB IN TABLE */ 01058000
         ST    TCBPTR,EVNTTCBP(,EVNTPTR)                           0323 01059000
*   EVNTFST=ADDR(EVNTHEND);         /* STORE ADDRESS OF FIRST ENTRY  */ 01060000
         LA    @15,EVNTHEND(,EVNTPTR)                              0324 01061000
         ST    @15,EVNTFST(,EVNTPTR)                               0324 01062000
*   EVNTLST=(ADDR(EVNTHEND)+((R10-1)*4));/* STORE LAST VALID EVENT 0325 01063000
*                                      ENTRY ADDRESS                 */ 01064000
         LR    @03,R10                                             0325 01065000
         BCTR  @03,0                                               0325 01066000
         SLA   @03,2                                               0325 01067000
         ALR   @15,@03                                             0325 01068000
         ST    @15,EVNTLST(,EVNTPTR)                               0325 01069000
*   EVNTLSTA=ADDR(EVNTDUMY);        /* STORE FIRST ACTIVE POINTER FOR   01070000
*                                      NO ENTRIES IN TABLE           */ 01071000
         LA    @15,EVNTDUMY(,EVNTPTR)                              0326 01072000
         ST    @15,EVNTLSTA(,EVNTPTR)                              0326 01073000
*/*      P     QUEUE EVENT TABLE AT TOP OF QUEUE                     */ 01074000
*                                                                  0327 01075000
*   EVNTLNK=TCBEVENT;               /* QUEUE TABLE AT TOP OF QUEUE   */ 01076000
         L     @15,TCBEXT2(,TCBPTR)                                0327 01077000
         L     @03,TCBEVENT(,@15)                                  0327 01078000
         ST    @03,EVNTLNK(,EVNTPTR)                               0327 01079000
*   TCBEVENT=EVNTPTR;               /* STORE ADDRESS OF TABLE IN TCB */ 01080000
         ST    EVNTPTR,TCBEVENT(,@15)                              0328 01081000
*/*      R     RETURN                                                */ 01082000
*                                                                  0329 01083000
*   RFY                                                            0329 01084000
*    (R10,                                                         0329 01085000
*     R11,                                                         0329 01086000
*     R12) UNRSTD;                                                 0329 01087000
*   END EVNTQUET;                                                  0330 01088000
*                                                                  0330 01089000
@EL00009 DS    0H                                                  0330 01090000
@EF00009 DS    0H                                                  0330 01091000
@ER00009 BR    @14                                                 0330 01092000
*/* EVNTQUET: END                                                    */ 01093000
*                                                                  0331 01094000
*                                                                  0331 01095000
*/* SUBROUT: CHART                                                   */ 01096000
*/********************************************************************/ 01097000
*/*                                                                  */ 01098000
*/* ROUTINE TO SET FRR                                               */ 01099000
*/*                                                                  */ 01100000
*/*      THIS ROUTINE IS CALLED BY ENTRIES IGC125 AND IEAVEVT1       */ 01101000
*/*      TO ESTABLISH THE EVENTS RECOVERY ENVIRONMENT                */ 01102000
*/*      THIS ROUTINE WILL SET FRR WITH THE FRR ENTRY POINT EVENTFRR */ 01103000
*/*      IT WILL THEN SAVE THE EVENTS INPUT PARAMETERS IN THE FRR    */ 01104000
*/*      WORK AREA, AND RETURN THE ADDRESS OF THAT WORK AREA IN      */ 01105000
*/*      REGISTER FRRWKAR.                                           */ 01106000
*/*                                                                  */ 01107000
*/********************************************************************/ 01108000
*                                                                  0331 01109000
*SETFRR:                                                           0331 01110000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA,NOPARMREG,NOENTREG,RETREG);     0331 01111000
*                                                                  0331 01112000
SETFRR   DS    0H                                                  0332 01113000
*/*  E    SETFRR                                                     */ 01114000
*/*      L     ADD FRR TO FRR STACK                                  */ 01115000
*                                                                  0332 01116000
*   RFY                                                            0332 01117000
*    (R8) RSTD;                                                    0332 01118000
*   R8=ADDR(EVENTFRR);              /* LOAD ADDRESS OF EVENT FRR     */ 01119000
         LA    R8,EVENTFRR                                         0333 01120000
*   GENERATE REFS(R8,FRRWKAR,R10,R11);                             0334 01121000
*                                          /* SET FRR */                01122000
         SETFRR A,FRRAD=(R8),PARMAD=(FRRWKAR),WRKREGS=(R11,R12)         01123000
*   RFY                                                            0335 01124000
*    (R8) UNRSTD;                                                  0335 01125000
*                                                                  0335 01126000
*/*      P     SAVE INPUT PARAMETERS IN FRR WORK AREA                */ 01127000
*                                                                  0336 01128000
*   FRRR0SAV=R0;                    /* SAVE REG ZERO                 */ 01129000
         ST    R0,FRRR0SAV(,FRRWKAR)                               0336 01130000
*   FRRR1SAV=R1;                    /* SAVE REG ONE                  */ 01131000
         ST    R1,FRRR1SAV(,FRRWKAR)                               0337 01132000
*/*  R    RETURN                                                     */ 01133000
*                                                                  0338 01134000
*   END SETFRR;                                                    0338 01135000
*                                                                  0338 01136000
@EL00010 DS    0H                                                  0338 01137000
@EF00010 DS    0H                                                  0338 01138000
@ER00010 BR    @14                                                 0338 01139000
*/********************************************************************/ 01140000
*/*                                                                  */ 01141000
*/* ROUTINE TO DELETE FRR                                            */ 01142000
*/*                                                                  */ 01143000
*/*      THIS ROUTINE IS CALLED BY ENTRIES IGC125 AND IEAVEVT1 IT    */ 01144000
*/*      IS ALSO CALLED BY ROUTINE EVNTABND TO DELETE THE EVENTS     */ 01145000
*/*      RECOVERY ENVIRONMENT.                                       */ 01146000
*/*                                                                  */ 01147000
*/********************************************************************/ 01148000
*                                                                  0339 01149000
*DELFRR:                                                           0339 01150000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA,NOPARMREG,NOENTREG,RETREG);     0339 01151000
*                                                                  0339 01152000
DELFRR   DS    0H                                                  0340 01153000
*/*  E    DELFRR                                                     */ 01154000
*/*  L    DELETE FRR                                                 */ 01155000
*                                                                  0340 01156000
*   GENERATE REFS(R10,R11);                                        0340 01157000
*                                                                  0340 01158000
         SETFRR D,WRKREGS=(R10,R11)                                     01159000
*/*  R    RETURN                                                     */ 01160000
*                                                                  0341 01161000
*   END DELFRR;                                                    0341 01162000
@EL00011 DS    0H                                                  0341 01163000
@EF00011 DS    0H                                                  0341 01164000
@ER00011 BR    @14                                                 0341 01165000
*                                                                  0342 01166000
*/********************************************************************/ 01167000
*/*                                                                  */ 01168000
*/* ROUTINE TO ISSUE ABEND                                           */ 01169000
*/*                                                                  */ 01170000
*/*      THIS ROUTINE IS CALLED BY ENTRIES IGC125 AND IEAVEVT1       */ 01171000
*/*      AND ROUTINES EVNTTVAL, EVNTTUPD, AND ECBINIT.               */ 01172000
*/*      THIS ROUTINE IS PASSED THE ABEND CODE IN REGISTER ONE.      */ 01173000
*/*      IT WILL THEN DELETE THE FRR AND ISSUE THE ABEND.            */ 01174000
*/*                                                                  */ 01175000
*/********************************************************************/ 01176000
*                                                                  0342 01177000
*EVNTABND:                                                         0342 01178000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA,NOPARMREG,NOENTREG,RETREG);     0342 01179000
*                                                                  0342 01180000
EVNTABND DS    0H                                                  0343 01181000
*/*      E     EVNTABND                                              */ 01182000
*/*      S     DELFRR: DELETE FRR                                    */ 01183000
*                                                                  0343 01184000
*   CALL DELFRR;                    /* CALL ROUTINE TO DELETE FRR    */ 01185000
         BAL   @14,DELFRR                                          0343 01186000
*/*      S     ABEND: ABEND CALLER CODE IN REG ONE                   */ 01187000
*                                                                  0344 01188000
*   SVC(ABEND);                     /* ISSUE ABEND SVC               */ 01189000
         SVC   13                                                  0344 01190000
*/*      R     ABEND                                                 */ 01191000
*                                                                  0345 01192000
*   END EVNTABND;                                                  0345 01193000
*                                                                  0345 01194000
@EL00012 DS    0H                                                  0345 01195000
@EF00012 DS    0H                                                  0345 01196000
@ER00012 BR    @14                                                 0345 01197000
*/* SUBROUT:   END                                                   */ 01198000
*                                                                  0346 01199000
*                                                                  0346 01200000
*/********************************************************************/ 01201000
*/*                                                                  */ 01202000
*/* FRR ROUTINE FOR EVENTS PROCESSING                                */ 01203000
*/*                                                                  */ 01204000
*/*      THIS ROUTINE IS BRANCH ENTERED VIA RTM. IT                  */ 01205000
*/*      ESTABLISHED ADDRESSIBILITY AT ITS OWN ENTRY POINT.          */ 01206000
*/*      DETERMINES IF THE ERROR OCCURRED IN THIS ADDRESS SPACE      */ 01207000
*/*      AND IF IT WAS EXPECTED - DOES FRRABEND (IN THE FRR WORK     */ 01208000
*/*      AREA) CONTAIN A PRESET ABEND CODE. IF BOTH CONDITIONS       */ 01209000
*/*      ARE TRUE, IT ISSUES A SETRP WITH COMPCOD= TO FRRABEND,      */ 01210000
*/*      DUMP=YES AND CONTINUE WITH TERMINATION.                     */ 01211000
*/*      IF THE ERROR WAS IN THIS ADDRESS BUT NOT EXPECTED EVENTS    */ 01212000
*/*      CALLS CHAP RECOVERY (IGC044R2) TO VERIFY THE COUNT OF READY */ 01213000
*/*      TCBS (ASCBTCBS). EVENTS THEN DEQUEUES THE ENTIRE EVENT      */ 01214000
*/*      TABLE QUEUE BY STORING ZEROES IN TCBEVENT. EVENTS THEN      */ 01215000
*/*      ISSUES SETRP INDICATING THE EVENTS RECORDING INFORMATION    */ 01216000
*/*      AND CONTINUE WITH TERMINATION.                              */ 01217000
*/*      IF THE ERROR WAS NOT IN THIS ADDRESS SPACE EVENTS RETURNS   */ 01218000
*/*      TO RTM INDICATING CONTINUE WITH TERMINATION.                */ 01219000
*/*                                                                  */ 01220000
*/********************************************************************/ 01221000
*                                                                  0346 01222000
*EVENTFRR:                                                         0346 01223000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA,NOPARMREG,NOENTREG,RETREG);     0346 01224000
*                                                                  0346 01225000
EVENTFRR DS    0H                                                  0347 01226000
*/* EVENTFRR: CHART                                                  */ 01227000
*/*      E     EVENTFRR                                              */ 01228000
*/*      P     ESTABLISH ADDRESSIBILITY                              */ 01229000
*                                                                  0347 01230000
*   GENERATE;                                                      0347 01231000
*                                                                  0347 01232000
         USING EVENTFRR,R6             ESTABLISH ADDRESSIBILITY         01233000
*                                      FOR THIS ENTRY                   01234000
         LR    R6,R15                  LOAD ENTRY POINT                 01235000
*/*      D     (YES,,NO,%FRRCNT1) WAS ERROR IN THIS ADDRESS SPACE    */ 01236000
*                                                                  0348 01237000
*   IF SDWAFMID=ZERO THEN           /* WAS ERROR IN THIS ADDRESS   0348 01238000
*                                      SPACE                         */ 01239000
         SLR   @15,@15                                             0348 01240000
         LH    @12,SDWAFMID(,SDWAPTR)                              0348 01241000
         N     @12,@CF02690                                        0348 01242000
         CR    @15,@12                                             0348 01243000
         BNE   @RF00348                                            0348 01244000
*     DO;                           /* ERROR IN THIS ADDRESS SPACE   */ 01245000
*       FRRWKAR=SDWAPARM;           /* LOAD ADDRESS OF WORK AREA     */ 01246000
         L     FRRWKAR,SDWAPARM(,SDWAPTR)                          0350 01247000
*       FRRRETN=R14;                /* SAVE RETURN ADDRESS           */ 01248000
         ST    R14,FRRRETN(,FRRWKAR)                               0351 01249000
*/*      D     (YES,,NO,%FRRCNT2) WAS ERROR EXPECTED                 */ 01250000
*                                                                  0352 01251000
*       IF FRRABENDÂ¬=ZERO THEN      /* WAS ABEND EXPECTED            */ 01252000
         L     @12,FRRABEND(,FRRWKAR)                              0352 01253000
         CR    @12,@15                                             0352 01254000
         BE    @RF00352                                            0352 01255000
*         DO;                       /* ABEND EXPECTED CHANGE       0353 01256000
*                                      COMPLETION CODE               */ 01257000
*/*      S   (,%FRRCNT1) SETRP: CHANGE COMPLETION CODE AND PERCOLATE */ 01258000
*                                                                  0354 01259000
*           DO;                     /* SETRP COMPCOD(FRRABEND)DUMP(YE   01260000
*                                      S)RECORD(NO)                  */ 01261000
*             RESPECIFY                                            0355 01262000
*              (GPR00P,                                            0355 01263000
*               GPR01P,                                            0355 01264000
*               GPR14P,                                            0355 01265000
*               GPR15P) RSTD;                                      0355 01266000
*             GPR01P->SDWARCDE=0;   /* SAVE RC VALUE                 */ 01267000
         MVI   SDWARCDE(GPR01P),X'00'                              0356 01268000
*             GPR01P->SDWARCRD='0'B;/* TURN OFF RECORD INDICATOR     */ 01269000
         NI    SDWARCRD(GPR01P),B'01111111'                        0357 01270000
*             GPR01P->SDWAREQ='1'B; /* TURN ON DUMP INDICATOR        */ 01271000
         OI    SDWAREQ(GPR01P),B'10000000'                         0358 01272000
*             GPR14P=FRRABEND;      /* ACCESS COMPLETION CODE        */ 01273000
         LR    GPR14P,@12                                          0359 01274000
*             GPR01P->SDWACMPC=GPR14P;/* STORE COMPLETION CODE       */ 01275000
         STCM  GPR14P,7,SDWACMPC(GPR01P)                           0360 01276000
*             RESPECIFY                                            0361 01277000
*              (GPR00P,                                            0361 01278000
*               GPR01P,                                            0361 01279000
*               GPR14P,                                            0361 01280000
*               GPR15P) UNRSTD;                                    0361 01281000
*           END;                                                   0362 01282000
*         END;                                                     0363 01283000
*       ELSE                        /* ABEND NOT EXPECTED            */ 01284000
*         DO;                       /* DO FRR PROCESSING             */ 01285000
         B     @RC00352                                            0364 01286000
@RF00352 DS    0H                                                  0365 01287000
*           RFY                                                    0365 01288000
*            (R2) RSTD;                                            0365 01289000
*                                                                  0365 01290000
*/* %FRRCNT2: S     IGC044R2: CALL CHAP RECOVERY                     */ 01291000
*                                                                  0366 01292000
*           R2=ZERO;                /* CLEAR DUMP INDICATOR          */ 01293000
         SLR   R2,R2                                               0366 01294000
*           R9=R6;                  /* SAVE BASE REG                 */ 01295000
         LR    R9,R6                                               0367 01296000
*           CALL IGC044R2;          /* CALL CHAP RECOVERY TO VERIFY     01297000
*                                      ASCBTCBS                      */ 01298000
         L     @12,CVTPTR                                          0368 01299000
         L     @15,CVT044R2(,@12)                                  0368 01300000
         BALR  @14,@15                                             0368 01301000
*           R6=R9;                  /* RESTORE BASE REG              */ 01302000
         LR    R6,R9                                               0369 01303000
*           RFY                                                    0370 01304000
*            (R2) UNRSTD;                                          0370 01305000
*           TCBPTR=PSATOLD;         /* GET TCB POINTER               */ 01306000
         L     TCBPTR,PSATOLD                                      0371 01307000
*/*      P     DEQUEUE EVENT TABLE QUEUE                             */ 01308000
*                                                                  0372 01309000
*           TCBEVENT=ZERO;          /* DEQUEUE EVENT TABLE QUEUE     */ 01310000
         L     @15,TCBEXT2(,TCBPTR)                                0372 01311000
         SLR   @12,@12                                             0372 01312000
         ST    @12,TCBEVENT(,@15)                                  0372 01313000
*/* %FRRCNT4: S     SETRP: RECORD=YES RECPARM=                       */ 01314000
*                                                                  0373 01315000
*           DO;                     /* SETRP RECORD(YES)WKAREA(SDWAPT   01316000
*                                      R)RECPARM(FRRMODID)           */ 01317000
*             RESPECIFY                                            0374 01318000
*              (GPR00P,                                            0374 01319000
*               GPR01P,                                            0374 01320000
*               GPR14P,                                            0374 01321000
*               GPR15P) RSTD;                                      0374 01322000
*             GPR01P=SDWAPTR;                                      0375 01323000
*             GPR01P->SDWARCDE=0;   /* SAVE RC VALUE                 */ 01324000
         MVI   SDWARCDE(GPR01P),X'00'                              0376 01325000
*             GPR01P->SDWARCRD='1'B;/* TURN ON RECORD INDICATOR      */ 01326000
         OI    SDWARCRD(GPR01P),B'10000000'                        0377 01327000
*             GPR15P=ADDR(FRRMODID);/* ACCESS RECORD PARAMETER LIST  */ 01328000
         LA    GPR15P,FRRMODID                                     0378 01329000
*             GPR01P->SDWARECP=GPR15P->I256C(1:24);/* COPY RECORD  0379 01330000
*                                      PARAMETERS                    */ 01331000
         MVC   SDWARECP(24,GPR01P),I256C(GPR15P)                   0379 01332000
*             RESPECIFY                                            0380 01333000
*              (GPR00P,                                            0380 01334000
*               GPR01P,                                            0380 01335000
*               GPR14P,                                            0380 01336000
*               GPR15P) UNRSTD;                                    0380 01337000
*           END;                                                   0381 01338000
*         END;                                                     0382 01339000
*       R9=SDWAPARM;                /* RELOAD FRR WORK AREA ADDRESS  */ 01340000
@RC00352 L     R9,SDWAPARM(,SDWAPTR)                               0383 01341000
*       R14=FRRRETN;                /* LOAD RETURN ADDRESS           */ 01342000
         L     R14,FRRRETN(,FRRWKAR)                               0384 01343000
*     END;                                                         0385 01344000
*                                                                  0385 01345000
*/* %FRRCNT1: S (,%FRRCNT3) SETRP: RC=0                              */ 01346000
*                                                                  0386 01347000
*   DO;                             /* SETRP WKAREA(SDWAPTR)RC(0)    */ 01348000
@RF00348 DS    0H                                                  0387 01349000
*     RESPECIFY                                                    0387 01350000
*      (GPR00P,                                                    0387 01351000
*       GPR01P,                                                    0387 01352000
*       GPR14P,                                                    0387 01353000
*       GPR15P) RSTD;                                              0387 01354000
*     GPR01P=SDWAPTR;                                              0388 01355000
*     GPR01P->SDWARCDE=0;           /* SAVE RC VALUE                 */ 01356000
         MVI   SDWARCDE(GPR01P),X'00'                              0389 01357000
*     RESPECIFY                                                    0390 01358000
*      (GPR00P,                                                    0390 01359000
*       GPR01P,                                                    0390 01360000
*       GPR14P,                                                    0390 01361000
*       GPR15P) UNRSTD;                                            0390 01362000
*   END;                                                           0391 01363000
*                                                                  0391 01364000
*/* %FRRCNT3: R     RETURN                                           */ 01365000
*                                                                  0392 01366000
*   END EVENTFRR;                                                  0392 01367000
*                                                                  0392 01368000
@EL00013 DS    0H                                                  0392 01369000
@EF00013 DS    0H                                                  0392 01370000
@ER00013 BR    @14                                                 0392 01371000
*/* EVENTFRR: END                                                    */ 01372000
*                                                                  0393 01373000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 01374000
*     GPR00P PTR(31) REG(0),                                       0393 01375000
*     GPR01P PTR(31) REG(1),                                       0393 01376000
*     GPR14P PTR(31) REG(14),                                      0393 01377000
*     GPR15P PTR(31) REG(15);                                      0393 01378000
*   DECLARE                         /* COMMON VARIABLES              */ 01379000
*     I256C CHAR(256) BASED,                                       0394 01380000
*     I031F FIXED(31) BASED,                                       0394 01381000
*     I031P PTR(31) BASED,                                         0394 01382000
*     I015F FIXED(15) BASED,                                       0394 01383000
*     I015P PTR(15) BASED,                                         0394 01384000
*     I008P PTR(8) BASED,                                          0394 01385000
*     I001C CHAR(1) BASED;                                         0394 01386000
*   END IEAVEVT0                                                   0395 01387000
*                                                                  0395 01388000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01389000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 01390000
*/*%INCLUDE SYSLIB  (IHAASXB )                                       */ 01391000
*/*%INCLUDE SYSLIB  (IEECHAIN)                                       */ 01392000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 01393000
*/*%INCLUDE SYSLIB  (IHAECB  )                                       */ 01394000
*/*%INCLUDE SYSLIB  (IHAEVNT )                                       */ 01395000
*/*%INCLUDE SYSLIB  (IEZJSCB )                                       */ 01396000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 01397000
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */ 01398000
*/*%INCLUDE SYSLIB  (IHARB   )                                       */ 01399000
*/*%INCLUDE SYSLIB  (IKJRB   )                                       */ 01400000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */ 01401000
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */ 01402000
*/*%INCLUDE SYSLIB  (IHAWSAVT)                                       */ 01403000
*                                                                  0395 01404000
*       ;                                                          0395 01405000
@DATA    DS    0H                                                       01406000
@CH02602 DC    H'32767'                                                 01407000
@DATD    DSECT                                                          01408000
         DS    0F                                                       01409000
IEAVEVT0 CSECT                                                          01410000
         DS    0F                                                       01411000
@CF00037 DC    F'4'                                                     01412000
@CF00053 DC    F'8'                                                     01413000
@CF02688 DC    F'47'                                                    01414000
@CF02693 DC    F'-8'                                                    01415000
@CF02566 DC    XL4'8017D000'                                            01416000
@CF02570 DC    XL4'8047D000'                                            01417000
@CF02572 DC    XL4'8057D000'                                            01418000
@CF02574 DC    XL4'8067D000'                                            01419000
@CF02576 DC    XL4'8077D000'                                            01420000
@CF02578 DC    XL4'8087D000'                                            01421000
@CF02580 DC    XL4'8017A000'                                            01422000
@CF02584 DC    XL4'8047A000'                                            01423000
@CF02586 DC    XL4'00300000'                                            01424000
@CF02596 DC    XL4'80000001'                                            01425000
@CF02598 DC    XL4'80000000'                                            01426000
@CF02600 DC    XL4'40000000'                                            01427000
@CF02690 DC    XL4'0000FFFF'                                            01428000
@DATD    DSECT                                                          01429000
         DS    0D                                                       01430000
@ENDDATD EQU   *                                                        01431000
IEAVEVT0 CSECT                                                          01432000
         NOPR  ((@ENDDATD-@DATD)*16)                                    01433000
         DS    0F                                                       01434000
@SIZDATD DC    AL1(0)                                                   01435000
         DC    AL3(@ENDDATD-@DATD)                                      01436000
         DS    0D                                                       01437000
IGC125A  DC    AL4(IGC125)                                              01438000
WOS      DS    AL1                                                      01439000
@CB02695 DC    X'00'                                                    01440000
FRRMODID DC    CL24'IEAVEVT0IEAVEVT0EVENTFRR'                           01441000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01442000
@01      EQU   01                                                       01443000
@02      EQU   02                                                       01444000
@03      EQU   03                                                       01445000
@04      EQU   04                                                       01446000
@05      EQU   05                                                       01447000
@06      EQU   06                                                       01448000
@07      EQU   07                                                       01449000
@08      EQU   08                                                       01450000
@09      EQU   09                                                       01451000
@10      EQU   10                                                       01452000
@11      EQU   11                                                       01453000
@12      EQU   12                                                       01454000
@13      EQU   13                                                       01455000
@14      EQU   14                                                       01456000
@15      EQU   15                                                       01457000
ASCBPTR  EQU   @07                                                      01458000
EVNTPTR  EQU   @01                                                      01459000
EVNTEPTR EQU   @10                                                      01460000
RBSECPTR EQU   @05                                                      01461000
TCBPTR   EQU   @04                                                      01462000
SDWAPTR  EQU   @01                                                      01463000
R0       EQU   @00                                                      01464000
R1       EQU   @01                                                      01465000
R2       EQU   @02                                                      01466000
R4       EQU   @04                                                      01467000
R5       EQU   @05                                                      01468000
R6       EQU   @06                                                      01469000
R7       EQU   @07                                                      01470000
R8       EQU   @08                                                      01471000
FRRWKAR  EQU   @09                                                      01472000
R9       EQU   @09                                                      01473000
R10      EQU   @10                                                      01474000
R11      EQU   @11                                                      01475000
R12      EQU   @12                                                      01476000
R13      EQU   @13                                                      01477000
R14      EQU   @14                                                      01478000
R15      EQU   @15                                                      01479000
GPR00P   EQU   @00                                                      01480000
GPR01P   EQU   @01                                                      01481000
GPR14P   EQU   @14                                                      01482000
GPR15P   EQU   @15                                                      01483000
ENTRYPTR EQU   @06                                                      01484000
R3       EQU   @03                                                      01485000
CVTPTR   EQU   16                                                       01486000
PSA      EQU   0                                                        01487000
FLCRNPSW EQU   PSA                                                      01488000
FLCROPSW EQU   PSA+8                                                    01489000
FLCICCW2 EQU   PSA+16                                                   01490000
PSAEEPSW EQU   PSA+132                                                  01491000
PSAESPSW EQU   PSA+136                                                  01492000
FLCSVILC EQU   PSAESPSW+1                                               01493000
PSAEPPSW EQU   PSA+140                                                  01494000
FLCPIILC EQU   PSAEPPSW+1                                               01495000
FLCPICOD EQU   PSAEPPSW+2                                               01496000
PSAPICOD EQU   FLCPICOD+1                                               01497000
FLCTEA   EQU   PSAEPPSW+4                                               01498000
FLCPER   EQU   PSA+152                                                  01499000
FLCMCLA  EQU   PSA+168                                                  01500000
FLCIOEL  EQU   FLCMCLA+4                                                01501000
FLCIOA   EQU   FLCMCLA+16                                               01502000
FLCFSA   EQU   FLCMCLA+80                                               01503000
PSATOLD  EQU   PSA+540                                                  01504000
PSAAOLD  EQU   PSA+548                                                  01505000
PSASUPER EQU   PSA+552                                                  01506000
PSASUP1  EQU   PSASUPER                                                 01507000
PSASUP2  EQU   PSASUPER+1                                               01508000
PSASUP3  EQU   PSASUPER+2                                               01509000
PSASUP4  EQU   PSASUPER+3                                               01510000
PSACLHT  EQU   PSA+640                                                  01511000
PSALKSA  EQU   PSA+696                                                  01512000
PSAHLHI  EQU   PSA+760                                                  01513000
PSADSSFL EQU   PSA+836                                                  01514000
PSADSSF1 EQU   PSADSSFL                                                 01515000
PSADSSF3 EQU   PSADSSFL+2                                               01516000
PSADSSF4 EQU   PSADSSFL+3                                               01517000
PSARSVT  EQU   PSA+896                                                  01518000
ASCB     EQU   0                                                        01519000
ASCBFW1  EQU   ASCB+100                                                 01520000
ASCBRCTF EQU   ASCBFW1+2                                                01521000
ASCBFLG1 EQU   ASCBFW1+3                                                01522000
ASCBASXB EQU   ASCB+108                                                 01523000
ASCBSWCT EQU   ASCB+112                                                 01524000
ASCBDSP1 EQU   ASCB+114                                                 01525000
ASCBFLG2 EQU   ASCB+115                                                 01526000
ASCBTCBS EQU   ASCB+124                                                 01527000
ASXB     EQU   0                                                        01528000
ASXBSPSA EQU   ASXB+112                                                 01529000
ASXBAEQ  EQU   ASXB+168                                                 01530000
ASXBSECR EQU   ASXB+199                                                 01531000
ASCBSFLG EQU   ASXBSECR                                                 01532000
ASXBCASW EQU   ASXB+216                                                 01533000
ASXBCRB1 EQU   ASXBCASW                                                 01534000
CHAIN    EQU   0                                                        01535000
CHFLG    EQU   CHAIN+4                                                  01536000
CHSTS    EQU   CHFLG+2                                                  01537000
CHACT    EQU   CHFLG+3                                                  01538000
CHIFY    EQU   CHACT                                                    01539000
CHKEY    EQU   CHAIN+8                                                  01540000
CHPARM   EQU   CHKEY                                                    01541000
CHPKE    EQU   CHAIN+28                                                 01542000
CHTJID   EQU   CHAIN+30                                                 01543000
CHPROCSN EQU   CHAIN+32                                                 01544000
CHACT1   EQU   CHPROCSN+3                                               01545000
CHASM    EQU   CHAIN+40                                                 01546000
CHECBP   EQU   CHASM                                                    01547000
CHCIBP   EQU   CHASM+4                                                  01548000
CHRGNSZ  EQU   CHASM+8                                                  01549000
CHSTEP   EQU   CHASM+24                                                 01550000
CHSWT    EQU   CHSTEP                                                   01551000
CHSHORT  EQU   CHASM+32                                                 01552000
CVTMAP   EQU   0                                                        01553000
CVTDAR   EQU   CVTMAP+72                                                01554000
CVTFLGS1 EQU   CVTDAR                                                   01555000
CVTDCB   EQU   CVTMAP+116                                               01556000
CVTIOQET EQU   CVTMAP+120                                               01557000
CVT0DS   EQU   CVTMAP+136                                               01558000
CVTIERLC EQU   CVTMAP+144                                               01559000
CVTHEAD  EQU   CVTMAP+160                                               01560000
CVTSV76C EQU   CVTHEAD                                                  01561000
CVTOPTA  EQU   CVTMAP+182                                               01562000
CVTOPTB  EQU   CVTMAP+183                                               01563000
CVTGTF   EQU   CVTMAP+236                                               01564000
CVTGTFST EQU   CVTGTF                                                   01565000
CVTGTFS  EQU   CVTGTFST                                                 01566000
CVTSTATE EQU   CVTGTFST                                                 01567000
CVTTMODE EQU   CVTGTFST                                                 01568000
CVTFORM  EQU   CVTGTFST                                                 01569000
CVTAQAVT EQU   CVTMAP+240                                               01570000
CVTTCMFG EQU   CVTAQAVT                                                 01571000
CVTVOLM2 EQU   CVTMAP+244                                               01572000
CVTTATA  EQU   CVTVOLM2                                                 01573000
CVTTSKS  EQU   CVTTATA                                                  01574000
CVTVOLF2 EQU   CVTTSKS                                                  01575000
CVTTAT   EQU   CVTTATA+1                                                01576000
CVTATER  EQU   CVTMAP+248                                               01577000
CVTEXT1  EQU   CVTMAP+252                                               01578000
CVTPURG  EQU   CVTMAP+260                                               01579000
CVTQMSG  EQU   CVTMAP+268                                               01580000
CVTDMSR  EQU   CVTMAP+272                                               01581000
CVTRSV37 EQU   CVTDMSR                                                  01582000
CVTDMSRF EQU   CVTRSV37                                                 01583000
CVTERPV  EQU   CVTMAP+316                                               01584000
CVTINTLA EQU   CVTMAP+320                                               01585000
CVTAPF   EQU   CVTMAP+324                                               01586000
CVTEXT2  EQU   CVTMAP+328                                               01587000
CVTHJES  EQU   CVTMAP+332                                               01588000
CVTPGSIA EQU   CVTMAP+348                                               01589000
CVTA1F1  EQU   CVTMAP+356                                               01590000
CVTSYSK  EQU   CVTMAP+357                                               01591000
CVTVOLM1 EQU   CVTMAP+380                                               01592000
CVTVOLF1 EQU   CVTVOLM1                                                 01593000
CVTATMCT EQU   CVTMAP+388                                               01594000
CVTXTNT1 EQU   0                                                        01595000
CVTXTNT2 EQU   0                                                        01596000
CVTDSSV  EQU   CVTXTNT2                                                 01597000
CVTFLGBT EQU   CVTXTNT2+5                                               01598000
CVTQID   EQU   CVTXTNT2+24                                              01599000
CVTRV400 EQU   CVTXTNT2+52                                              01600000
CVTRV409 EQU   CVTXTNT2+53                                              01601000
CVTATCVT EQU   CVTXTNT2+64                                              01602000
CVTRV429 EQU   CVTXTNT2+84                                              01603000
CVTRV438 EQU   CVTXTNT2+85                                              01604000
CVTRV457 EQU   CVTXTNT2+112                                             01605000
CVTRV466 EQU   CVTXTNT2+113                                             01606000
CVTFIX   EQU   0                                                        01607000
CVTRELNO EQU   CVTFIX+252                                               01608000
ECB      EQU   0                                                        01609000
ECBRB    EQU   ECB                                                      01610000
ECBEVTB  EQU   ECBRB                                                    01611000
ECBEXTB  EQU   ECBEVTB                                                  01612000
ECBCC    EQU   ECBEXTB                                                  01613000
ECBCCCNT EQU   ECBEXTB+1                                                01614000
ECBRBA   EQU   ECBCCCNT                                                 01615000
ECBEVTBA EQU   ECBRBA                                                   01616000
ECBEXTBA EQU   ECBEVTBA                                                 01617000
ECBBYTE3 EQU   ECBEXTBA+2                                               01618000
ECBEXTND EQU   ECBBYTE3                                                 01619000
EVNT     EQU   0                                                        01620000
EVNTBEGN EQU   EVNT                                                     01621000
EVNTHEDR EQU   EVNTBEGN                                                 01622000
EVNTLNK  EQU   EVNTHEDR                                                 01623000
EVNTTCBP EQU   EVNTBEGN+4                                               01624000
EVNTRBP  EQU   EVNTBEGN+8                                               01625000
EVNTFST  EQU   EVNTBEGN+12                                              01626000
EVNTLST  EQU   EVNTBEGN+16                                              01627000
EVNTLSTA EQU   EVNTBEGN+20                                              01628000
EVNTFLG1 EQU   EVNTBEGN+24                                              01629000
EVNTUPR  EQU   EVNTFLG1                                                 01630000
EVNTLNTH EQU   EVNTBEGN+25                                              01631000
EVNTDUMY EQU   EVNTBEGN+36                                              01632000
EVNTHEND EQU   EVNT+40                                                  01633000
EVNTENTY EQU   0                                                        01634000
EVNTFLGS EQU   EVNTENTY                                                 01635000
EVNTENDL EQU   EVNTFLGS                                                 01636000
IEZJSCB  EQU   0                                                        01637000
JSCBSEC1 EQU   IEZJSCB+188                                              01638000
JSCHPCE  EQU   JSCBSEC1+4                                               01639000
JSCBDCB  EQU   JSCBSEC1+36                                              01640000
JSCBOPTS EQU   JSCBSEC1+48                                              01641000
JSCBSWT1 EQU   JSCBSEC1+55                                              01642000
JSCBWTP  EQU   JSCBSEC1+64                                              01643000
JSCBWTFG EQU   JSCBWTP                                                  01644000
JSCBCSCB EQU   JSCBSEC1+68                                              01645000
JSCBEND1 EQU   IEZJSCB+260                                              01646000
FRRS     EQU   0                                                        01647000
FRRSHEAD EQU   FRRS                                                     01648000
FRRSCURR EQU   FRRSHEAD+12                                              01649000
FRRSENTR EQU   0                                                        01650000
FRRSFLGS EQU   FRRSENTR+4                                               01651000
FRRSFLG1 EQU   FRRSFLGS                                                 01652000
RBPRFX   EQU   0                                                        01653000
RBBASIC  EQU   0                                                        01654000
RBEXRTNM EQU   RBBASIC                                                  01655000
RBTMFLD  EQU   RBEXRTNM                                                 01656000
RBSTAB   EQU   RBBASIC+10                                               01657000
XSTAB    EQU   RBSTAB                                                   01658000
RBSTAB1  EQU   XSTAB                                                    01659000
XSTAB1   EQU   RBSTAB1                                                  01660000
RBFTCKPT EQU   XSTAB1                                                   01661000
RBSTAB2  EQU   XSTAB+1                                                  01662000
XSTAB2   EQU   RBSTAB2                                                  01663000
RBTCBNXT EQU   XSTAB2                                                   01664000
RBFACTV  EQU   XSTAB2                                                   01665000
RBFDYN   EQU   XSTAB2                                                   01666000
RBECBWT  EQU   XSTAB2                                                   01667000
RBOPSW   EQU   RBBASIC+16                                               01668000
XRBPSW   EQU   RBOPSW                                                   01669000
RBOPSWB2 EQU   XRBPSW+1                                                 01670000
RBLINK   EQU   RBBASIC+28                                               01671000
XRBLNK   EQU   RBLINK                                                   01672000
RBWCF    EQU   XRBLNK                                                   01673000
RBLINKB  EQU   XRBLNK+1                                                 01674000
RBGRSAVE EQU   RBBASIC+32                                               01675000
XRBREG   EQU   RBGRSAVE                                                 01676000
RBGRS0   EQU   XRBREG                                                   01677000
RBGRS1   EQU   XRBREG+4                                                 01678000
RBGRS2   EQU   XRBREG+8                                                 01679000
RBGRS3   EQU   XRBREG+12                                                01680000
RBGRS4   EQU   XRBREG+16                                                01681000
RBGRS5   EQU   XRBREG+20                                                01682000
RBGRS6   EQU   XRBREG+24                                                01683000
RBGRS7   EQU   XRBREG+28                                                01684000
RBGRS8   EQU   XRBREG+32                                                01685000
RBGRS9   EQU   XRBREG+36                                                01686000
RBGRS10  EQU   XRBREG+40                                                01687000
RBGRS11  EQU   XRBREG+44                                                01688000
RBGRS12  EQU   XRBREG+48                                                01689000
RBGRS13  EQU   XRBREG+52                                                01690000
RBGRS14  EQU   XRBREG+56                                                01691000
RBGRS15  EQU   XRBREG+60                                                01692000
XRBESA   EQU   RBBASIC+96                                               01693000
RBPREFIX EQU   0                                                        01694000
RBRSV019 EQU   RBPREFIX+14                                              01695000
RBRSV028 EQU   RBPREFIX+15                                              01696000
RBRSV041 EQU   RBPREFIX+27                                              01697000
RBRSV054 EQU   RBPREFIX+39                                              01698000
RBRTOPSW EQU   RBPREFIX+40                                              01699000
RBRTPSW2 EQU   RBRTOPSW+8                                               01700000
RBRTICIL EQU   RBRTPSW2                                                 01701000
RBFLAGS1 EQU   RBPREFIX+56                                              01702000
RBXWAIT  EQU   RBFLAGS1                                                 01703000
RBINTCDA EQU   RBPREFIX+61                                              01704000
RBSECT   EQU   0                                                        01705000
RBPPSAV  EQU   RBSECT                                                   01706000
@NM00053 EQU   RBSECT+10                                                01707000
@NM00054 EQU   @NM00053                                                 01708000
RBTRSVRB EQU   @NM00054                                                 01709000
@NM00056 EQU   @NM00053+1                                               01710000
RBETXR   EQU   @NM00056                                                 01711000
RBEP     EQU   RBSECT+12                                                01712000
RBPGMQ   EQU   RBSECT+24                                                01713000
@NM00063 EQU   RBSECT+28                                                01714000
IRBEND   EQU   RBSECT+96                                                01715000
@NM00067 EQU   RBSECT+96                                                01716000
RBRSV138 EQU   @NM00067+7                                               01717000
RBRSV150 EQU   RBSECT+167                                               01718000
TCBFIX   EQU   0                                                        01719000
TCBFRS   EQU   TCBFIX                                                   01720000
TCB      EQU   0                                                        01721000
TCBRBP   EQU   TCB                                                      01722000
TCBPIE   EQU   TCB+4                                                    01723000
TCBPMASK EQU   TCBPIE                                                   01724000
TCBCMP   EQU   TCB+16                                                   01725000
TCBCMPF  EQU   TCBCMP                                                   01726000
TCBCPP   EQU   TCBCMPF                                                  01727000
TCBSTCC  EQU   TCBCMPF                                                  01728000
TCBCDBL  EQU   TCBCMPF                                                  01729000
TCBCWTO  EQU   TCBCMPF                                                  01730000
TCBCIND  EQU   TCBCMPF                                                  01731000
TCBCMSG  EQU   TCBCMPF                                                  01732000
TCBTRN   EQU   TCB+20                                                   01733000
TCBABF   EQU   TCBTRN                                                   01734000
TCBMSS   EQU   TCB+24                                                   01735000
TCBPKF   EQU   TCB+28                                                   01736000
TCBFLGS  EQU   TCB+29                                                   01737000
TCBFLGS1 EQU   TCBFLGS                                                  01738000
TCBFLGS2 EQU   TCBFLGS+1                                                01739000
TCBFLGS3 EQU   TCBFLGS+2                                                01740000
TCBFLGS4 EQU   TCBFLGS+3                                                01741000
TCBFLGS5 EQU   TCBFLGS+4                                                01742000
TCBABWF  EQU   TCBFLGS5                                                 01743000
TCBJPQ   EQU   TCB+44                                                   01744000
TCBPURGE EQU   TCBJPQ                                                   01745000
TCBGRS   EQU   TCB+48                                                   01746000
TCBGRS1  EQU   TCBGRS+4                                                 01747000
TCBFSA   EQU   TCB+112                                                  01748000
TCBTME   EQU   TCB+120                                                  01749000
TCBJSTCB EQU   TCB+124                                                  01750000
TCBTSFLG EQU   TCB+148                                                  01751000
TCBTSTSK EQU   TCBTSFLG                                                 01752000
TCBSTAB  EQU   TCB+160                                                  01753000
TCBNSTAE EQU   TCBSTAB                                                  01754000
TCBTCT   EQU   TCB+164                                                  01755000
TCBTCTGF EQU   TCBTCT                                                   01756000
TCBSCNDY EQU   TCB+172                                                  01757000
TCBNDSP  EQU   TCBSCNDY                                                 01758000
TCBNDSP1 EQU   TCBNDSP+1                                                01759000
TCBNDSP2 EQU   TCBNDSP+2                                                01760000
TCBNDSP3 EQU   TCBNDSP+3                                                01761000
TCBJSCB  EQU   TCB+180                                                  01762000
TCBRECDE EQU   TCBJSCB                                                  01763000
TCBEXT1  EQU   TCB+196                                                  01764000
TCBBITS  EQU   TCB+200                                                  01765000
TCBNDSP4 EQU   TCBBITS                                                  01766000
TCBNDSP5 EQU   TCBBITS+1                                                01767000
TCBFLGS6 EQU   TCBBITS+2                                                01768000
TCBFLGS7 EQU   TCBBITS+3                                                01769000
TCBDAR   EQU   TCB+204                                                  01770000
TCBDARC  EQU   TCBDAR                                                   01771000
TCBEXT2  EQU   TCB+208                                                  01772000
TCBFOE   EQU   TCB+244                                                  01773000
TCBESTAE EQU   TCB+264                                                  01774000
TCBESTRM EQU   TCBESTAE+1                                               01775000
TCBFBYT1 EQU   TCB+276                                                  01776000
TCBFBYT2 EQU   TCB+277                                                  01777000
TCBRV124 EQU   TCB+278                                                  01778000
TCBRV133 EQU   TCB+279                                                  01779000
TCBXTNT2 EQU   0                                                        01780000
TCBGTF   EQU   TCBXTNT2                                                 01781000
TCBTFLG  EQU   TCBGTF                                                   01782000
TCBEVENT EQU   TCBXTNT2+8                                               01783000
TCBRV146 EQU   TCBXTNT2+28                                              01784000
TCBRV155 EQU   TCBXTNT2+29                                              01785000
TCBRV164 EQU   TCBXTNT2+30                                              01786000
TCBRV173 EQU   TCBXTNT2+31                                              01787000
SDWA     EQU   0                                                        01788000
SDWAPARM EQU   SDWA                                                     01789000
SDWAFIOB EQU   SDWA+4                                                   01790000
SDWAABCC EQU   SDWAFIOB                                                 01791000
SDWACMPF EQU   SDWAABCC                                                 01792000
SDWAREQ  EQU   SDWACMPF                                                 01793000
SDWACMPC EQU   SDWAABCC+1                                               01794000
SDWACTL1 EQU   SDWA+8                                                   01795000
SDWACMKA EQU   SDWACTL1                                                 01796000
SDWAMWPA EQU   SDWACTL1+1                                               01797000
SDWAPMKA EQU   SDWACTL1+4                                               01798000
SDWACTL2 EQU   SDWA+16                                                  01799000
SDWACMKP EQU   SDWACTL2                                                 01800000
SDWAMWPP EQU   SDWACTL2+1                                               01801000
SDWAPMKP EQU   SDWACTL2+4                                               01802000
SDWAGRSV EQU   SDWA+24                                                  01803000
SDWANAME EQU   SDWA+88                                                  01804000
SDWAEC1  EQU   SDWA+104                                                 01805000
SDWAEMK1 EQU   SDWAEC1                                                  01806000
SDWAMWP1 EQU   SDWAEC1+1                                                01807000
SDWAINT1 EQU   SDWAEC1+2                                                01808000
SDWANXT1 EQU   SDWAEC1+4                                                01809000
SDWAAEC1 EQU   SDWA+112                                                 01810000
SDWAILC1 EQU   SDWAAEC1+1                                               01811000
SDWAINC1 EQU   SDWAAEC1+2                                               01812000
SDWAICD1 EQU   SDWAINC1+1                                               01813000
SDWAEC2  EQU   SDWA+120                                                 01814000
SDWAEMK2 EQU   SDWAEC2                                                  01815000
SDWAMWP2 EQU   SDWAEC2+1                                                01816000
SDWAINT2 EQU   SDWAEC2+2                                                01817000
SDWANXT2 EQU   SDWAEC2+4                                                01818000
SDWAAEC2 EQU   SDWA+128                                                 01819000
SDWAILC2 EQU   SDWAAEC2+1                                               01820000
SDWAINC2 EQU   SDWAAEC2+2                                               01821000
SDWAICD2 EQU   SDWAINC2+1                                               01822000
SDWASRSV EQU   SDWA+136                                                 01823000
SDWAIDNT EQU   SDWA+200                                                 01824000
SDWAMCH  EQU   SDWA+204                                                 01825000
SDWASTCK EQU   SDWAMCH                                                  01826000
SDWAMCHI EQU   SDWAMCH+8                                                01827000
SDWAMCHS EQU   SDWAMCHI                                                 01828000
SDWAMCHD EQU   SDWAMCHI+1                                               01829000
SDWARSR1 EQU   SDWAMCH+12                                               01830000
SDWARSR2 EQU   SDWAMCH+13                                               01831000
SDWAFLGS EQU   SDWA+232                                                 01832000
SDWAERRA EQU   SDWAFLGS                                                 01833000
SDWAERRB EQU   SDWAFLGS+1                                               01834000
SDWAERRC EQU   SDWAFLGS+2                                               01835000
SDWAERRD EQU   SDWAFLGS+3                                               01836000
SDWAFMID EQU   SDWA+236                                                 01837000
SDWAIOFS EQU   SDWA+238                                                 01838000
SDWACPUA EQU   SDWA+248                                                 01839000
SDWAPARQ EQU   SDWA+252                                                 01840000
SDWARCDE EQU   SDWAPARQ                                                 01841000
SDWAACF2 EQU   SDWAPARQ+1                                               01842000
SDWARCRD EQU   SDWAACF2                                                 01843000
SDWAACF3 EQU   SDWAPARQ+2                                               01844000
SDWAACF4 EQU   SDWAPARQ+3                                               01845000
SDWALKWA EQU   SDWA+256                                                 01846000
SDWALKWS EQU   SDWALKWA                                                 01847000
SDWARECP EQU   SDWA+292                                                 01848000
SDWASNPA EQU   SDWA+320                                                 01849000
SDWADUMP EQU   SDWASNPA                                                 01850000
SDWADPFS EQU   SDWADUMP+1                                               01851000
SDWADDAT EQU   SDWASNPA+4                                               01852000
SDWASDAT EQU   SDWADDAT                                                 01853000
SDWAPDAT EQU   SDWADDAT+2                                               01854000
SDWADPSA EQU   SDWA+328                                                 01855000
SDWADPSL EQU   SDWADPSA                                                 01856000
SDWARA   EQU   SDWA+400                                                 01857000
SDWADPVA EQU   SDWARA+2                                                 01858000
WSAL     EQU   0                                                        01859000
WSALEVNT EQU   WSAL+48                                                  01860000
IGC044R2 EQU   0                                                        01861000
IEA0DS   EQU   0                                                        01862000
CALLER   EQU   0                                                        01863000
LOCALSAV EQU   0                                                        01864000
R2R14SAV EQU   LOCALSAV+8                                               01865000
FRRWKARA EQU   0                                                        01866000
FRRR0SAV EQU   FRRWKARA                                                 01867000
@NM00123 EQU   FRRR0SAV                                                 01868000
WAITYES  EQU   @NM00123                                                 01869000
WAITNO   EQU   @NM00123                                                 01870000
ECBYES   EQU   @NM00123                                                 01871000
ECBPTR   EQU   FRRR0SAV+1                                               01872000
LAST     EQU   ECBPTR                                                   01873000
ENTRIES  EQU   LAST+1                                                   01874000
FRRR1SAV EQU   FRRWKARA+4                                               01875000
FRRABEND EQU   FRRWKARA+8                                               01876000
FRRRETN  EQU   FRRWKARA+12                                              01877000
I256C    EQU   0                                                        01878000
I001C    EQU   0                                                        01879000
I008P    EQU   0                                                        01880000
I015F    EQU   0                                                        01881000
I015P    EQU   0                                                        01882000
I031F    EQU   0                                                        01883000
I031P    EQU   0                                                        01884000
ASXBPTR  EQU   ASCBASXB                                                 01885000
CSCBPTR  EQU   JSCBCSCB                                                 01886000
CHAINS01 EQU   CHASM                                                    01887000
CHTYPE   EQU   CHAINS01+124                                             01888000
CHTRSTAT EQU   CHAINS01+125                                             01889000
CHCSYSO  EQU   CHAINS01+134                                             01890000
CVTS01   EQU   CVTPGSIA                                                 01891000
CVTLPDIA EQU   CVTS01+12                                                01892000
CVTDIRST EQU   CVTLPDIA                                                 01893000
CVTSLIDA EQU   CVTS01+24                                                01894000
CVTCTLFG EQU   CVTS01+50                                                01895000
CVT044R2 EQU   CVTS01+376                                               01896000
CVTRV210 EQU   CVTS01+424                                               01897000
CVTRV219 EQU   CVTS01+425                                               01898000
CVTRV228 EQU   CVTS01+426                                               01899000
CVTRV237 EQU   CVTS01+427                                               01900000
CVTMFRTR EQU   CVTS01+452                                               01901000
CVTRV262 EQU   CVTS01+468                                               01902000
CVTRV271 EQU   CVTS01+469                                               01903000
CVTRV280 EQU   CVTS01+470                                               01904000
CVTRV289 EQU   CVTS01+471                                               01905000
CVTGSDA  EQU   CVTS01+600                                               01906000
JSCBSEC2 EQU   JSCBEND1                                                 01907000
JSCBSEC3 EQU   JSCBEND1                                                 01908000
JSCBJCT  EQU   JSCBSEC3                                                 01909000
JSCBJCTA EQU   JSCBJCT+1                                                01910000
JSCBASID EQU   JSCBSEC3+8                                               01911000
JSCBFBYT EQU   JSCBSEC3+10                                              01912000
JSCBJNL  EQU   JSCBSEC3+28                                              01913000
JSCBJJSB EQU   JSCBJNL                                                  01914000
JSCBSUB  EQU   JSCBSEC3+40                                              01915000
JSCSCT   EQU   JSCBSEC3+68                                              01916000
JSCRSV45 EQU   JSCBSEC3+112                                             01917000
JSCRSV46 EQU   JSCRSV45                                                 01918000
JSCRSV47 EQU   JSCRSV45+2                                               01919000
PSARSVTE EQU   PSARSVT                                                  01920000
PSACSTK  EQU   PSARSVTE                                                 01921000
FRRSPTR  EQU   PSACSTK                                                  01922000
FRREPTR  EQU   FRRSCURR                                                 01923000
RBSECS03 EQU   RBEP                                                     01924000
RBCDE    EQU   RBSECS03                                                 01925000
RBCDFLGS EQU   RBCDE                                                    01926000
RBSECS05 EQU   RBPGMQ                                                   01927000
RBSQE    EQU   RBSECS05                                                 01928000
RBSECS06 EQU   RBPGMQ                                                   01929000
RBIQE    EQU   RBSECS06                                                 01930000
RBSECS07 EQU   RBPGMQ                                                   01931000
RBIQE2   EQU   RBSECS07                                                 01932000
RBSECS08 EQU   IRBEND                                                   01933000
RBSECS09 EQU   IRBEND                                                   01934000
@NM00121 EQU   RBOPSW                                                   01935000
RBUSKEY  EQU   @NM00121+1                                               01936000
FLC      EQU   PSA                                                      01937000
WSALPTR  EQU   ASXBSPSA                                                 01938000
*                                      START UNREFERENCED COMPONENTS    01939000
@NM00122 EQU   @NM00121                                                 01940000
RBRSV161 EQU   RBSECS09+64                                              01941000
RBSIRBWA EQU   RBSECS09                                                 01942000
RBIQEWRK EQU   RBSECS08+4                                               01943000
RBNEXAV  EQU   RBSECS08                                                 01944000
RBIQEA   EQU   RBIQE2                                                   01945000
RBIQE1   EQU   RBIQE+1                                                  01946000
RBUSE    EQU   RBIQE                                                    01947000
RBSQEA   EQU   RBSQE+1                                                  01948000
@NM00068 EQU   RBSQE                                                    01949000
RBCDE1   EQU   RBCDE+1                                                  01950000
RBCDLOAD EQU   RBCDFLGS                                                 01951000
RBCDXCTL EQU   RBCDFLGS                                                 01952000
RBCDSYNC EQU   RBCDFLGS                                                 01953000
RBCDNODE EQU   RBCDFLGS                                                 01954000
RBCDSAVE EQU   RBCDFLGS                                                 01955000
RBCDATCH EQU   RBCDFLGS                                                 01956000
RBRSV009 EQU   RBCDFLGS                                                 01957000
RBNOCELL EQU   RBCDFLGS                                                 01958000
PSARSAV  EQU   PSARSVTE+60                                              01959000
PSARSTK  EQU   PSARSVTE+56                                              01960000
PSAESAV3 EQU   PSARSVTE+52                                              01961000
PSAESTK3 EQU   PSARSVTE+48                                              01962000
PSAESAV2 EQU   PSARSVTE+44                                              01963000
PSAESTK2 EQU   PSARSVTE+40                                              01964000
PSAESAV1 EQU   PSARSVTE+36                                              01965000
PSAESTK1 EQU   PSARSVTE+32                                              01966000
PSAPSAV  EQU   PSARSVTE+28                                              01967000
PSAPSTK  EQU   PSARSVTE+24                                              01968000
PSAMSAV  EQU   PSARSVTE+20                                              01969000
PSAMSTK  EQU   PSARSVTE+16                                              01970000
PSASSAV  EQU   PSARSVTE+12                                              01971000
PSASSTK  EQU   PSARSVTE+8                                               01972000
PSANSTK  EQU   PSARSVTE+4                                               01973000
JSCBEND3 EQU   JSCBSEC3+120                                             01974000
JSCRSV52 EQU   JSCBSEC3+116                                             01975000
JSCRSV51 EQU   JSCRSV47+1                                               01976000
JSCRSV50 EQU   JSCRSV47                                                 01977000
JSCRSV49 EQU   JSCRSV46+1                                               01978000
JSCRSV48 EQU   JSCRSV46                                                 01979000
JSCRSV44 EQU   JSCBSEC3+108                                             01980000
JSCRSV43 EQU   JSCBSEC3+104                                             01981000
JSCRSV42 EQU   JSCBSEC3+100                                             01982000
JSCBASWA EQU   JSCBSEC3+96                                              01983000
JSCBUFPT EQU   JSCBSEC3+92                                              01984000
JSCBACT  EQU   JSCBSEC3+88                                              01985000
JSCBSWSP EQU   JSCBSEC3+87                                              01986000
JSCRSV33 EQU   JSCBSEC3+86                                              01987000
JSCDDNUM EQU   JSCBSEC3+84                                              01988000
JSCRSV53 EQU   JSCBSEC3+82                                              01989000
JSCDDNNO EQU   JSCBSEC3+80                                              01990000
JSCBVATA EQU   JSCBSEC3+76                                              01991000
JSCTMCOR EQU   JSCBSEC3+72                                              01992000
JSCSCTP  EQU   JSCSCT+1                                                 01993000
JSCRSV55 EQU   JSCSCT                                                   01994000
JSCRSV54 EQU   JSCBSEC3+64                                              01995000
JSCDSABQ EQU   JSCBSEC3+60                                              01996000
JSCBSSIB EQU   JSCBSEC3+56                                              01997000
JSCBFRBA EQU   JSCBSEC3+48                                              01998000
JSCRSV28 EQU   JSCBSEC3+46                                              01999000
JSCBSONO EQU   JSCBSEC3+44                                              02000000
JSCBSUBA EQU   JSCBSUB+1                                                02001000
JSCRSV31 EQU   JSCBSUB                                                  02002000
JSCBSMLR EQU   JSCBSEC3+36                                              02003000
JSCBJNLR EQU   JSCBSEC3+32                                              02004000
JSCBJNLA EQU   JSCBJNL+1                                                02005000
JSCBJSBT EQU   JSCBJJSB                                                 02006000
JSCBJSBX EQU   JSCBJJSB                                                 02007000
JSCBJSBA EQU   JSCBJJSB                                                 02008000
JSCBJSBI EQU   JSCBJJSB                                                 02009000
@NM00015 EQU   JSCBJJSB                                                 02010000
JSCBJNLE EQU   JSCBJJSB                                                 02011000
JSCBJNLF EQU   JSCBJJSB                                                 02012000
JSCBJNLN EQU   JSCBJJSB                                                 02013000
@NM00014 EQU   JSCBSEC3+24                                              02014000
JSCBJRBA EQU   JSCBSEC3+16                                              02015000
JSCBIECB EQU   JSCBSEC3+12                                              02016000
JSCBRV08 EQU   JSCBSEC3+11                                              02017000
JSCBRV07 EQU   JSCBFBYT                                                 02018000
JSCBRV06 EQU   JSCBFBYT                                                 02019000
JSCBRV05 EQU   JSCBFBYT                                                 02020000
JSCBRV04 EQU   JSCBFBYT                                                 02021000
JSCBRV03 EQU   JSCBFBYT                                                 02022000
JSCBRV02 EQU   JSCBFBYT                                                 02023000
JSCBADSP EQU   JSCBFBYT                                                 02024000
JSCBRV01 EQU   JSCBFBYT                                                 02025000
JSCBTJID EQU   JSCBASID                                                 02026000
JSCBPSCB EQU   JSCBSEC3+4                                               02027000
JSCJCTP  EQU   JSCBJCTA                                                 02028000
JSCRSV24 EQU   JSCBJCT                                                  02029000
JSCBEND2 EQU   JSCBSEC2                                                 02030000
CVTRV628 EQU   CVTS01+728                                               02031000
CVTRV627 EQU   CVTS01+724                                               02032000
CVTRV626 EQU   CVTS01+720                                               02033000
CVTRV625 EQU   CVTS01+716                                               02034000
CVTRV624 EQU   CVTS01+712                                               02035000
CVTRV623 EQU   CVTS01+708                                               02036000
CVTRV622 EQU   CVTS01+704                                               02037000
CVTRV621 EQU   CVTS01+700                                               02038000
CVTIHASU EQU   CVTS01+696                                               02039000
CVTRV619 EQU   CVTS01+692                                               02040000
CVTRV618 EQU   CVTS01+688                                               02041000
CVTRV617 EQU   CVTS01+684                                               02042000
CVTRV616 EQU   CVTS01+680                                               02043000
CVTRV615 EQU   CVTS01+676                                               02044000
CVTRV614 EQU   CVTS01+672                                               02045000
CVTRV613 EQU   CVTS01+668                                               02046000
CVTTCASP EQU   CVTS01+664                                               02047000
CVT0PT03 EQU   CVTS01+660                                               02048000
CVT0PT0E EQU   CVTS01+656                                               02049000
CVTRV609 EQU   CVTS01+652                                               02050000
CVTCGK   EQU   CVTS01+648                                               02051000
CVTRAC   EQU   CVTS01+644                                               02052000
CVTHSM   EQU   CVTS01+640                                               02053000
CVTRV605 EQU   CVTS01+636                                               02054000
CVTRV604 EQU   CVTS01+632                                               02055000
CVTEFF02 EQU   CVTS01+628                                               02056000
CVTCBBR  EQU   CVTS01+624                                               02057000
CVTSSCR  EQU   CVTS01+620                                               02058000
CVTEVENT EQU   CVTS01+616                                               02059000
CVTCRCA  EQU   CVTS01+612                                               02060000
CVTTPIO  EQU   CVTS01+608                                               02061000
CVTADV   EQU   CVTS01+604                                               02062000
CVTGSDAB EQU   CVTGSDA                                                  02063000
CVTQV3   EQU   CVTS01+596                                               02064000
CVTQV2   EQU   CVTS01+592                                               02065000
CVTQV1   EQU   CVTS01+588                                               02066000
CVTRPT   EQU   CVTS01+584                                               02067000
CVTSSRB  EQU   CVTS01+580                                               02068000
CVTCSDRL EQU   CVTS01+576                                               02069000
CVTEXP1  EQU   CVTS01+572                                               02070000
CVTRMPMT EQU   CVTS01+568                                               02071000
CVTRMPTT EQU   CVTS01+564                                               02072000
CVTVPSA  EQU   CVTS01+560                                               02073000
CVTVSTOP EQU   CVTS01+556                                               02074000
CVTGTFR8 EQU   CVTS01+552                                               02075000
CVTQUIT  EQU   CVTS01+548                                               02076000
CVTVACR  EQU   CVTS01+544                                               02077000
CVTWTCB  EQU   CVTS01+540                                               02078000
CVTSTPRS EQU   CVTS01+536                                               02079000
CVT0PT02 EQU   CVTS01+532                                               02080000
CVTDARCM EQU   CVTS01+528                                               02081000
CVTIRECM EQU   CVTS01+524                                               02082000
CVTJRECM EQU   CVTS01+520                                               02083000
CVTVEMS0 EQU   CVTS01+516                                               02084000
CVTSPFRR EQU   CVTS01+512                                               02085000
CVTRLSTG EQU   CVTS01+508                                               02086000
CVT0TC0A EQU   CVTS01+504                                               02087000
CVTGMBR  EQU   CVTS01+500                                               02088000
CVTLFRM  EQU   CVTS01+496                                               02089000
CVTRMBR  EQU   CVTS01+492                                               02090000
CVTVIOP  EQU   CVTS01+488                                               02091000
CVTRV307 EQU   CVTS01+486                                               02092000
CVTRV306 EQU   CVTS01+484                                               02093000
CVTRV305 EQU   CVTS01+482                                               02094000
CVTRV304 EQU   CVTS01+480                                               02095000
CVTRV303 EQU   CVTS01+478                                               02096000
CVTRV302 EQU   CVTS01+476                                               02097000
CVTTRCA  EQU   CVTS01+472                                               02098000
CVTRV297 EQU   CVTRV289                                                 02099000
CVTRV296 EQU   CVTRV289                                                 02100000
CVTRV295 EQU   CVTRV289                                                 02101000
CVTRV294 EQU   CVTRV289                                                 02102000
CVTRV293 EQU   CVTRV289                                                 02103000
CVTRV292 EQU   CVTRV289                                                 02104000
CVTRV291 EQU   CVTRV289                                                 02105000
CVTRV290 EQU   CVTRV289                                                 02106000
CVTRV288 EQU   CVTRV280                                                 02107000
CVTRV287 EQU   CVTRV280                                                 02108000
CVTRV286 EQU   CVTRV280                                                 02109000
CVTRV285 EQU   CVTRV280                                                 02110000
CVTRV284 EQU   CVTRV280                                                 02111000
CVTRV283 EQU   CVTRV280                                                 02112000
CVTRV282 EQU   CVTRV280                                                 02113000
CVTRV281 EQU   CVTRV280                                                 02114000
CVTRV279 EQU   CVTRV271                                                 02115000
CVTRV278 EQU   CVTRV271                                                 02116000
CVTRV277 EQU   CVTRV271                                                 02117000
CVTRV276 EQU   CVTRV271                                                 02118000
CVTRV275 EQU   CVTRV271                                                 02119000
CVTRV274 EQU   CVTRV271                                                 02120000
CVTRV273 EQU   CVTRV271                                                 02121000
CVTRV272 EQU   CVTRV271                                                 02122000
CVTRV270 EQU   CVTRV262                                                 02123000
CVTRV269 EQU   CVTRV262                                                 02124000
CVTRV268 EQU   CVTRV262                                                 02125000
CVTRV267 EQU   CVTRV262                                                 02126000
CVTRV266 EQU   CVTRV262                                                 02127000
CVTRV265 EQU   CVTRV262                                                 02128000
CVTRV264 EQU   CVTRV262                                                 02129000
CVTRV263 EQU   CVTRV262                                                 02130000
CVTVFP   EQU   CVTS01+464                                               02131000
CVTVSI   EQU   CVTS01+460                                               02132000
CVTVPSIB EQU   CVTS01+456                                               02133000
CVTMFACT EQU   CVTMFRTR                                                 02134000
CVTMFCTL EQU   CVTS01+448                                               02135000
CVTPVBP  EQU   CVTS01+444                                               02136000
CVTPWI   EQU   CVTS01+440                                               02137000
CVTRV254 EQU   CVTS01+438                                               02138000
CVTRV253 EQU   CVTS01+436                                               02139000
CVTRV252 EQU   CVTS01+434                                               02140000
CVTRV251 EQU   CVTS01+433                                               02141000
CVTRV250 EQU   CVTS01+432                                               02142000
CVTRV249 EQU   CVTS01+431                                               02143000
CVTRV248 EQU   CVTS01+430                                               02144000
CVTRV247 EQU   CVTS01+429                                               02145000
CVTRV246 EQU   CVTS01+428                                               02146000
CVTRV245 EQU   CVTRV237                                                 02147000
CVTRV244 EQU   CVTRV237                                                 02148000
CVTRV243 EQU   CVTRV237                                                 02149000
CVTRV242 EQU   CVTRV237                                                 02150000
CVTRV241 EQU   CVTRV237                                                 02151000
CVTRV240 EQU   CVTRV237                                                 02152000
CVTRV239 EQU   CVTRV237                                                 02153000
CVTRV238 EQU   CVTRV237                                                 02154000
CVTRV236 EQU   CVTRV228                                                 02155000
CVTRV235 EQU   CVTRV228                                                 02156000
CVTRV234 EQU   CVTRV228                                                 02157000
CVTRV233 EQU   CVTRV228                                                 02158000
CVTRV232 EQU   CVTRV228                                                 02159000
CVTRV231 EQU   CVTRV228                                                 02160000
CVTRV230 EQU   CVTRV228                                                 02161000
CVTRV229 EQU   CVTRV228                                                 02162000
CVTRV227 EQU   CVTRV219                                                 02163000
CVTRV226 EQU   CVTRV219                                                 02164000
CVTRV225 EQU   CVTRV219                                                 02165000
CVTRV224 EQU   CVTRV219                                                 02166000
CVTRV223 EQU   CVTRV219                                                 02167000
CVTRV222 EQU   CVTRV219                                                 02168000
CVTRV221 EQU   CVTRV219                                                 02169000
CVTRV220 EQU   CVTRV219                                                 02170000
CVTRV218 EQU   CVTRV210                                                 02171000
CVTRV217 EQU   CVTRV210                                                 02172000
CVTRV216 EQU   CVTRV210                                                 02173000
CVTRV215 EQU   CVTRV210                                                 02174000
CVTRV214 EQU   CVTRV210                                                 02175000
CVTRV213 EQU   CVTRV210                                                 02176000
CVTRV212 EQU   CVTRV210                                                 02177000
CVTRV211 EQU   CVTRV210                                                 02178000
CVTLCCAT EQU   CVTS01+420                                               02179000
CVTPCCAT EQU   CVTS01+416                                               02180000
CVTIPCRP EQU   CVTS01+412                                               02181000
CVTIPCRI EQU   CVTS01+408                                               02182000
CVTIPCDS EQU   CVTS01+404                                               02183000
CVTAIDVT EQU   CVTS01+400                                               02184000
CVTSSAP  EQU   CVTS01+396                                               02185000
CVTEHCIR EQU   CVTS01+392                                               02186000
CVTEHDEF EQU   CVTS01+388                                               02187000
CVTDAIR  EQU   CVTS01+384                                               02188000
CVTPERFM EQU   CVTS01+380                                               02189000
CVTFETCH EQU   CVTS01+372                                               02190000
CVTRSTWD EQU   CVTS01+368                                               02191000
CVTSPOST EQU   CVTS01+364                                               02192000
CVTIOBP  EQU   CVTS01+360                                               02193000
CVTASMVT EQU   CVTS01+356                                               02194000
CVTRECRQ EQU   CVTS01+352                                               02195000
CVTWSAC  EQU   CVTS01+348                                               02196000
CVTRV149 EQU   CVTS01+344                                               02197000
CVTWSAL  EQU   CVTS01+340                                               02198000
CVTSPSA  EQU   CVTS01+336                                               02199000
CVTGLMN  EQU   CVTS01+332                                               02200000
CVTVEAC0 EQU   CVTS01+328                                               02201000
CVT062R1 EQU   CVTS01+324                                               02202000
CVTRPOST EQU   CVTS01+320                                               02203000
CVTDQIQE EQU   CVTS01+316                                               02204000
CVTCSD   EQU   CVTS01+312                                               02205000
CVTLKRMA EQU   CVTS01+308                                               02206000
CVTRSPIE EQU   CVTS01+304                                               02207000
CVTRENQ  EQU   CVTS01+300                                               02208000
CVTLQCB  EQU   CVTS01+296                                               02209000
CVTFQCB  EQU   CVTS01+292                                               02210000
CVTQCS01 EQU   CVTS01+288                                               02211000
CVTAPFT  EQU   CVTS01+284                                               02212000
CVTPARRL EQU   CVTS01+280                                               02213000
CVTVWAIT EQU   CVTS01+276                                               02214000
CVTGSPL  EQU   CVTS01+272                                               02215000
CVTLSMQ  EQU   CVTS01+268                                               02216000
CVTGSMQ  EQU   CVTS01+264                                               02217000
CVTEXPRO EQU   CVTS01+260                                               02218000
CVTOPCTP EQU   CVTS01+256                                               02219000
CVTSIC   EQU   CVTS01+252                                               02220000
CVTTPIOS EQU   CVTS01+248                                               02221000
CVTRTMS  EQU   CVTS01+244                                               02222000
CVTSDBF  EQU   CVTS01+240                                               02223000
CVTSCBP  EQU   CVTS01+236                                               02224000
CVTSDMP  EQU   CVTS01+232                                               02225000
CVTSV60  EQU   CVTS01+228                                               02226000
CVTRTMCT EQU   CVTS01+224                                               02227000
CVTASCBL EQU   CVTS01+220                                               02228000
CVTASCBH EQU   CVTS01+216                                               02229000
CVTGDA   EQU   CVTS01+212                                               02230000
CVTASVT  EQU   CVTS01+208                                               02231000
CVTVVMDI EQU   CVTS01+204                                               02232000
CVTAQTOP EQU   CVTS01+200                                               02233000
CVTIOSCS EQU   CVTS01+196                                               02234000
CVTSDRM  EQU   CVTS01+192                                               02235000
CVTOPTE  EQU   CVTS01+188                                               02236000
CVTSTXU  EQU   CVTS01+184                                               02237000
CVTQUIS  EQU   CVTS01+180                                               02238000
CVTPARS  EQU   CVTS01+176                                               02239000
CVTS1EE  EQU   CVTS01+172                                               02240000
CVTFRAS  EQU   CVTS01+168                                               02241000
CVTQSAS  EQU   CVTS01+164                                               02242000
CVTCRAS  EQU   CVTS01+160                                               02243000
CVTCRMN  EQU   CVTS01+156                                               02244000
CVTDELCP EQU   CVTS01+152                                               02245000
CVTFRECL EQU   CVTS01+148                                               02246000
CVTGETCL EQU   CVTS01+144                                               02247000
CVTBLDCP EQU   CVTS01+140                                               02248000
CVTAUTHL EQU   CVTS01+136                                               02249000
CVTSCAN  EQU   CVTS01+132                                               02250000
CVTRV144 EQU   CVTS01+130                                               02251000
CVTMAXMP EQU   CVTS01+128                                               02252000
CVTSTCK  EQU   CVTS01+124                                               02253000
CVTRV139 EQU   CVTS01+123                                               02254000
CVTDSSAC EQU   CVTS01+122                                               02255000
CVTRV513 EQU   CVTS01+121                                               02256000
CVTIOSPL EQU   CVTS01+120                                               02257000
CVTPTGT  EQU   CVTS01+116                                               02258000
CVTCSPIE EQU   CVTS01+112                                               02259000
CVTSMFEX EQU   CVTS01+108                                               02260000
CVTOLT0A EQU   CVTS01+104                                               02261000
CVTSRBRT EQU   CVTS01+100                                               02262000
CVTPUTL  EQU   CVTS01+96                                                02263000
CVTASCRL EQU   CVTS01+92                                                02264000
CVTASCRF EQU   CVTS01+88                                                02265000
CVTRV326 EQU   CVTS01+84                                                02266000
CVTRV325 EQU   CVTS01+80                                                02267000
CVTRV324 EQU   CVTS01+76                                                02268000
CVT0VL01 EQU   CVTS01+72                                                02269000
CVTSHRVM EQU   CVTS01+68                                                02270000
CVTRV332 EQU   CVTS01+64                                                02271000
CVTTAS   EQU   CVTS01+60                                                02272000
CVTRSCN  EQU   CVTS01+56                                                02273000
CVTTRAC2 EQU   CVTS01+54                                                02274000
CVTTRACE EQU   CVTS01+52                                                02275000
CVTAPG   EQU   CVTS01+51                                                02276000
CVTSDTRC EQU   CVTCTLFG                                                 02277000
CVTGTRCE EQU   CVTCTLFG                                                 02278000
CVTNOMP  EQU   CVTCTLFG                                                 02279000
CVTRSV79 EQU   CVTCTLFG                                                 02280000
CVTDSTAT EQU   CVTCTLFG                                                 02281000
CVTRSV78 EQU   CVTCTLFG                                                 02282000
CVTRV333 EQU   CVTCTLFG                                                 02283000
CVTRV323 EQU   CVTCTLFG                                                 02284000
CVTSPVLK EQU   CVTS01+49                                                02285000
CVTRSV77 EQU   CVTS01+48                                                02286000
CVTRV331 EQU   CVTS01+44                                                02287000
CVTRV330 EQU   CVTS01+40                                                02288000
CVTRV329 EQU   CVTS01+36                                                02289000
CVTRV328 EQU   CVTS01+32                                                02290000
CVTRV322 EQU   CVTS01+28                                                02291000
CVTSLID  EQU   CVTSLIDA+1                                               02292000
CVTSYLK  EQU   CVTSLIDA                                                 02293000
CVTRV321 EQU   CVTS01+20                                                02294000
CVTRV320 EQU   CVTS01+16                                                02295000
CVTLPDIR EQU   CVTLPDIA+1                                               02296000
CVTRSV69 EQU   CVTDIRST                                                 02297000
CVTRSV68 EQU   CVTDIRST                                                 02298000
CVTRSV67 EQU   CVTDIRST                                                 02299000
CVTRSV66 EQU   CVTDIRST                                                 02300000
CVTRSV65 EQU   CVTDIRST                                                 02301000
CVTRSV64 EQU   CVTDIRST                                                 02302000
CVTRSV63 EQU   CVTDIRST                                                 02303000
CVTDICOM EQU   CVTDIRST                                                 02304000
CVTPVTP  EQU   CVTS01+8                                                 02305000
CVTLPDSR EQU   CVTS01+4                                                 02306000
CVTGETL  EQU   CVTS01                                                   02307000
CHLAST   EQU   CHAINS01+136                                             02308000
CHSPA    EQU   CHAINS01+135                                             02309000
CHUSERID EQU   CHCSYSO                                                  02310000
CHJB     EQU   CHCSYSO                                                  02311000
CHDUMP   EQU   CHCSYSO                                                  02312000
CHQUE    EQU   CHCSYSO                                                  02313000
CHHOLD   EQU   CHCSYSO                                                  02314000
CHOUT    EQU   CHCSYSO                                                  02315000
CHINN    EQU   CHCSYSO                                                  02316000
CHALL    EQU   CHCSYSO                                                  02317000
CHINC    EQU   CHAINS01+132                                             02318000
CHPEND   EQU   CHAINS01+128                                             02319000
CHARID   EQU   CHAINS01+127                                             02320000
CHCNID   EQU   CHAINS01+126                                             02321000
@NM00004 EQU   CHTRSTAT                                                 02322000
CHTSL    EQU   CHTRSTAT                                                 02323000
CHTS     EQU   CHTRSTAT                                                 02324000
CHINITL  EQU   CHTRSTAT                                                 02325000
CHINIT   EQU   CHTRSTAT                                                 02326000
CHJOBSL  EQU   CHTRSTAT                                                 02327000
CHJOBS   EQU   CHTRSTAT                                                 02328000
CHDEF    EQU   CHTYPE                                                   02329000
CHHIAR   EQU   CHTYPE                                                   02330000
CHARSV29 EQU   CHTYPE                                                   02331000
CHARSV28 EQU   CHTYPE                                                   02332000
CHARSV27 EQU   CHTYPE                                                   02333000
CHARSV26 EQU   CHTYPE                                                   02334000
CHARSV25 EQU   CHTYPE                                                   02335000
CHDSTAT  EQU   CHTYPE                                                   02336000
CHBUF    EQU   CHAINS01                                                 02337000
@NM00125 EQU   LAST                                                     02338000
@NM00124 EQU   @NM00123                                                 02339000
CREATYES EQU   WAITYES                                                  02340000
R1SAVE   EQU   LOCALSAV+4                                               02341000
R0SAVE   EQU   LOCALSAV                                                 02342000
WSALACHP EQU   WSAL+56                                                  02343000
WSALRSM  EQU   WSAL+52                                                  02344000
WSALSTAE EQU   WSAL+44                                                  02345000
WSALSTAT EQU   WSAL+40                                                  02346000
WSALWAIT EQU   WSAL+36                                                  02347000
WSALPOST EQU   WSAL+32                                                  02348000
WSALEXIT EQU   WSAL+28                                                  02349000
WSALS2EE EQU   WSAL+24                                                  02350000
WSALCIRB EQU   WSAL+20                                                  02351000
WSALABTM EQU   WSAL+16                                                  02352000
WSALSDMP EQU   WSAL+12                                                  02353000
WSALRTM2 EQU   WSAL+8                                                   02354000
WSALVALC EQU   WSAL+4                                                   02355000
WSALCWSA EQU   WSAL                                                     02356000
@NM00120 EQU   SDWA+512                                                 02357000
SDWAVRA  EQU   SDWARA+4                                                 02358000
SDWAURAL EQU   SDWARA+3                                                 02359000
@NM00119 EQU   SDWADPVA                                                 02360000
SDWAEBC  EQU   SDWADPVA                                                 02361000
SDWAHEX  EQU   SDWADPVA                                                 02362000
SDWAVRAL EQU   SDWARA                                                   02363000
@NM00118 EQU   SDWA+396                                                 02364000
SDWACOMP EQU   SDWA+392                                                 02365000
SDWARCPL EQU   SDWA+364                                                 02366000
@NM00117 EQU   SDWADPSA+32                                              02367000
SDWATO4  EQU   SDWADPSL+28                                              02368000
SDWAFRM4 EQU   SDWADPSL+24                                              02369000
SDWATO3  EQU   SDWADPSL+20                                              02370000
SDWAFRM3 EQU   SDWADPSL+16                                              02371000
SDWATO2  EQU   SDWADPSL+12                                              02372000
SDWAFRM2 EQU   SDWADPSL+8                                               02373000
SDWATO1  EQU   SDWADPSL+4                                               02374000
SDWAFRM1 EQU   SDWADPSL                                                 02375000
@NM00116 EQU   SDWADDAT+3                                               02376000
@NM00115 EQU   SDWAPDAT                                                 02377000
SDWAUSPL EQU   SDWAPDAT                                                 02378000
SDWADPSW EQU   SDWAPDAT                                                 02379000
SDWATJPA EQU   SDWAPDAT                                                 02380000
SDWATLPA EQU   SDWAPDAT                                                 02381000
SDWADREG EQU   SDWAPDAT                                                 02382000
SDWADSAH EQU   SDWAPDAT                                                 02383000
SDWADSAS EQU   SDWAPDAT                                                 02384000
@NM00114 EQU   SDWADDAT+1                                               02385000
@NM00113 EQU   SDWASDAT                                                 02386000
SDWAQQS  EQU   SDWASDAT                                                 02387000
SDWACBS  EQU   SDWASDAT                                                 02388000
SDWAGTF  EQU   SDWASDAT                                                 02389000
SDWASWA  EQU   SDWASDAT                                                 02390000
SDWALSQA EQU   SDWASDAT                                                 02391000
SDWASQA  EQU   SDWASDAT                                                 02392000
SDWANUC  EQU   SDWASDAT                                                 02393000
@NM00112 EQU   SDWADUMP+2                                               02394000
@NM00111 EQU   SDWADPFS                                                 02395000
SDWASLST EQU   SDWADPFS                                                 02396000
@NM00110 EQU   SDWADPFS                                                 02397000
SDWADLST EQU   SDWADPFS                                                 02398000
SDWADPT  EQU   SDWADPFS                                                 02399000
SDWADPID EQU   SDWADUMP                                                 02400000
SDWADPLA EQU   SDWA+316                                                 02401000
SDWAREXN EQU   SDWARECP+16                                              02402000
SDWACSCT EQU   SDWARECP+8                                               02403000
SDWAMODN EQU   SDWARECP                                                 02404000
@NM00109 EQU   SDWA+290                                                 02405000
SDWAASID EQU   SDWA+288                                                 02406000
SDWATALW EQU   SDWALKWS+28                                              02407000
SDWATDLW EQU   SDWALKWS+24                                              02408000
SDWATNLW EQU   SDWALKWS+20                                              02409000
SDWAAPLW EQU   SDWALKWS+16                                              02410000
SDWAIPLW EQU   SDWALKWS+12                                              02411000
SDWAILLW EQU   SDWALKWS+8                                               02412000
SDWAIULW EQU   SDWALKWS+4                                               02413000
SDWAICLW EQU   SDWALKWS                                                 02414000
SDWAFLLK EQU   SDWAACF4                                                 02415000
SDWACMS  EQU   SDWAACF4                                                 02416000
SDWAOPTM EQU   SDWAACF4                                                 02417000
SDWATADB EQU   SDWAACF4                                                 02418000
SDWATDNB EQU   SDWAACF4                                                 02419000
SDWATNCB EQU   SDWAACF4                                                 02420000
SDWAILCH EQU   SDWAACF4                                                 02421000
SDWAIUCB EQU   SDWAACF4                                                 02422000
SDWAICAT EQU   SDWAACF3                                                 02423000
SDWAIPRG EQU   SDWAACF3                                                 02424000
SDWASALL EQU   SDWAACF3                                                 02425000
SDWAASMP EQU   SDWAACF3                                                 02426000
SDWADISP EQU   SDWAACF3                                                 02427000
@NM00108 EQU   SDWAACF3                                                 02428000
@NM00107 EQU   SDWAACF2                                                 02429000
SDWAFREE EQU   SDWAACF2                                                 02430000
SDWAUPRG EQU   SDWAACF2                                                 02431000
@NM00106 EQU   SDWAACF2                                                 02432000
SDWASPIN EQU   SDWAACF2                                                 02433000
@NM00105 EQU   SDWAACF2                                                 02434000
SDWALCPU EQU   SDWACPUA+2                                               02435000
@NM00104 EQU   SDWACPUA                                                 02436000
SDWARECA EQU   SDWA+244                                                 02437000
SDWARTYA EQU   SDWA+240                                                 02438000
@NM00103 EQU   SDWA+239                                                 02439000
@NM00102 EQU   SDWAIOFS                                                 02440000
SDWANIOP EQU   SDWAIOFS                                                 02441000
SDWANOIO EQU   SDWAIOFS                                                 02442000
SDWAIOHT EQU   SDWAIOFS                                                 02443000
SDWAIOQR EQU   SDWAIOFS                                                 02444000
@NM00101 EQU   SDWAERRD                                                 02445000
SDWAMCIV EQU   SDWAERRD                                                 02446000
SDWARPIV EQU   SDWAERRD                                                 02447000
SDWAMABD EQU   SDWAERRD                                                 02448000
SDWACTS  EQU   SDWAERRD                                                 02449000
SDWASTAE EQU   SDWAERRD                                                 02450000
SDWANRBE EQU   SDWAERRD                                                 02451000
SDWACLUP EQU   SDWAERRD                                                 02452000
@NM00100 EQU   SDWAERRC                                                 02453000
SDWAEAS  EQU   SDWAERRC                                                 02454000
SDWAPERC EQU   SDWAERRC                                                 02455000
SDWAIRB  EQU   SDWAERRC                                                 02456000
SDWASTAI EQU   SDWAERRC                                                 02457000
SDWASTAF EQU   SDWAERRC                                                 02458000
SDWASRBM EQU   SDWAERRB                                                 02459000
SDWALDIS EQU   SDWAERRB                                                 02460000
SDWAENRB EQU   SDWAERRB                                                 02461000
SDWATYP1 EQU   SDWAERRB                                                 02462000
@NM00099 EQU   SDWAERRB                                                 02463000
SDWAPGIO EQU   SDWAERRA                                                 02464000
SDWATEXC EQU   SDWAERRA                                                 02465000
SDWASVCE EQU   SDWAERRA                                                 02466000
SDWAABTM EQU   SDWAERRA                                                 02467000
SDWASVCD EQU   SDWAERRA                                                 02468000
SDWARKEY EQU   SDWAERRA                                                 02469000
SDWAPCHK EQU   SDWAERRA                                                 02470000
SDWAMCHK EQU   SDWAERRA                                                 02471000
SDWATIME EQU   SDWAMCH+20                                               02472000
SDWARFSA EQU   SDWAMCH+16                                               02473000
@NM00098 EQU   SDWAMCH+14                                               02474000
SDWAVEQR EQU   SDWARSR2                                                 02475000
SDWAPGFX EQU   SDWARSR2                                                 02476000
SDWAFLSQ EQU   SDWARSR2                                                 02477000
SDWAFSQA EQU   SDWARSR2                                                 02478000
SDWANUCL EQU   SDWARSR2                                                 02479000
SDWASPER EQU   SDWARSR2                                                 02480000
SDWAINTC EQU   SDWARSR2                                                 02481000
SDWAOFLN EQU   SDWARSR2                                                 02482000
SDWACHNG EQU   SDWARSR1                                                 02483000
SDWAMSER EQU   SDWARSR1                                                 02484000
@NM00097 EQU   SDWARSR1                                                 02485000
SDWACPID EQU   SDWAMCH+10                                               02486000
SDWATERR EQU   SDWAMCHD                                                 02487000
SDWAFPRX EQU   SDWAMCHD                                                 02488000
SDWAINSF EQU   SDWAMCHD                                                 02489000
SDWAACR  EQU   SDWAMCHD                                                 02490000
SDWASCK  EQU   SDWAMCHD                                                 02491000
SDWAPSWU EQU   SDWAMCHD                                                 02492000
SDWAREGU EQU   SDWAMCHD                                                 02493000
SDWASKYF EQU   SDWAMCHD                                                 02494000
@NM00096 EQU   SDWAMCHS                                                 02495000
SDWARSRF EQU   SDWAMCHS                                                 02496000
SDWARSRC EQU   SDWAMCHS                                                 02497000
SDWAINVP EQU   SDWAMCHS                                                 02498000
SDWATSVL EQU   SDWAMCHS                                                 02499000
SDWARCDF EQU   SDWAMCHS                                                 02500000
SDWASRVL EQU   SDWAMCHS                                                 02501000
SDWASCKE EQU   SDWASTCK+4                                               02502000
SDWASCKB EQU   SDWASTCK                                                 02503000
SDWALNTH EQU   SDWAIDNT+1                                               02504000
SDWASPID EQU   SDWAIDNT                                                 02505000
SDWASR15 EQU   SDWASRSV+60                                              02506000
SDWASR14 EQU   SDWASRSV+56                                              02507000
SDWASR13 EQU   SDWASRSV+52                                              02508000
SDWASR12 EQU   SDWASRSV+48                                              02509000
SDWASR11 EQU   SDWASRSV+44                                              02510000
SDWASR10 EQU   SDWASRSV+40                                              02511000
SDWASR09 EQU   SDWASRSV+36                                              02512000
SDWASR08 EQU   SDWASRSV+32                                              02513000
SDWASR07 EQU   SDWASRSV+28                                              02514000
SDWASR06 EQU   SDWASRSV+24                                              02515000
SDWASR05 EQU   SDWASRSV+20                                              02516000
SDWASR04 EQU   SDWASRSV+16                                              02517000
SDWASR03 EQU   SDWASRSV+12                                              02518000
SDWASR02 EQU   SDWASRSV+8                                               02519000
SDWASR01 EQU   SDWASRSV+4                                               02520000
SDWASR00 EQU   SDWASRSV                                                 02521000
SDWATRN2 EQU   SDWAAEC2+4                                               02522000
SDWAIPC2 EQU   SDWAICD2                                                 02523000
SDWAIMC2 EQU   SDWAICD2                                                 02524000
SDWAIPR2 EQU   SDWAICD2                                                 02525000
@NM00095 EQU   SDWAINC2                                                 02526000
@NM00094 EQU   SDWAILC2                                                 02527000
SDWAIL2  EQU   SDWAILC2                                                 02528000
@NM00093 EQU   SDWAILC2                                                 02529000
@NM00092 EQU   SDWAAEC2                                                 02530000
SDWAADD2 EQU   SDWANXT2+1                                               02531000
@NM00091 EQU   SDWANXT2                                                 02532000
@NM00090 EQU   SDWAEC2+3                                                02533000
SDWASGN2 EQU   SDWAINT2                                                 02534000
SDWAEXP2 EQU   SDWAINT2                                                 02535000
SDWADEC2 EQU   SDWAINT2                                                 02536000
SDWAFPO2 EQU   SDWAINT2                                                 02537000
SDWACC2  EQU   SDWAINT2                                                 02538000
@NM00089 EQU   SDWAINT2                                                 02539000
SDWAPGM2 EQU   SDWAMWP2                                                 02540000
SDWAWAT2 EQU   SDWAMWP2                                                 02541000
SDWAMCK2 EQU   SDWAMWP2                                                 02542000
SDWAECT2 EQU   SDWAMWP2                                                 02543000
SDWAKEY2 EQU   SDWAMWP2                                                 02544000
SDWAEXT2 EQU   SDWAEMK2                                                 02545000
SDWAIO2  EQU   SDWAEMK2                                                 02546000
SDWATRM2 EQU   SDWAEMK2                                                 02547000
@NM00088 EQU   SDWAEMK2                                                 02548000
SDWAPER2 EQU   SDWAEMK2                                                 02549000
@NM00087 EQU   SDWAEMK2                                                 02550000
SDWATRAN EQU   SDWAAEC1+4                                               02551000
SDWAIPC1 EQU   SDWAICD1                                                 02552000
SDWAIMC1 EQU   SDWAICD1                                                 02553000
SDWAIPR1 EQU   SDWAICD1                                                 02554000
@NM00086 EQU   SDWAINC1                                                 02555000
@NM00085 EQU   SDWAILC1                                                 02556000
SDWAIL1  EQU   SDWAILC1                                                 02557000
@NM00084 EQU   SDWAILC1                                                 02558000
@NM00083 EQU   SDWAAEC1                                                 02559000
SDWAADD1 EQU   SDWANXT1+1                                               02560000
@NM00082 EQU   SDWANXT1                                                 02561000
@NM00081 EQU   SDWAEC1+3                                                02562000
SDWASGN1 EQU   SDWAINT1                                                 02563000
SDWAEXP1 EQU   SDWAINT1                                                 02564000
SDWADEC1 EQU   SDWAINT1                                                 02565000
SDWAFPO1 EQU   SDWAINT1                                                 02566000
SDWACC1  EQU   SDWAINT1                                                 02567000
@NM00080 EQU   SDWAINT1                                                 02568000
SDWAPGM1 EQU   SDWAMWP1                                                 02569000
SDWAWAT1 EQU   SDWAMWP1                                                 02570000
SDWAMCK1 EQU   SDWAMWP1                                                 02571000
SDWAECT1 EQU   SDWAMWP1                                                 02572000
SDWAKEY1 EQU   SDWAMWP1                                                 02573000
SDWAEXT1 EQU   SDWAEMK1                                                 02574000
SDWAIO1  EQU   SDWAEMK1                                                 02575000
SDWATRM1 EQU   SDWAEMK1                                                 02576000
@NM00079 EQU   SDWAEMK1                                                 02577000
SDWAPER1 EQU   SDWAEMK1                                                 02578000
@NM00078 EQU   SDWAEMK1                                                 02579000
SDWAIOBR EQU   SDWA+100                                                 02580000
SDWAEPA  EQU   SDWA+96                                                  02581000
@NM00077 EQU   SDWANAME+4                                               02582000
SDWARBAD EQU   SDWANAME                                                 02583000
SDWAGR15 EQU   SDWAGRSV+60                                              02584000
SDWAGR14 EQU   SDWAGRSV+56                                              02585000
SDWAGR13 EQU   SDWAGRSV+52                                              02586000
SDWAGR12 EQU   SDWAGRSV+48                                              02587000
SDWAGR11 EQU   SDWAGRSV+44                                              02588000
SDWAGR10 EQU   SDWAGRSV+40                                              02589000
SDWAGR09 EQU   SDWAGRSV+36                                              02590000
SDWAGR08 EQU   SDWAGRSV+32                                              02591000
SDWAGR07 EQU   SDWAGRSV+28                                              02592000
SDWAGR06 EQU   SDWAGRSV+24                                              02593000
SDWAGR05 EQU   SDWAGRSV+20                                              02594000
SDWAGR04 EQU   SDWAGRSV+16                                              02595000
SDWAGR03 EQU   SDWAGRSV+12                                              02596000
SDWAGR02 EQU   SDWAGRSV+8                                               02597000
SDWAGR01 EQU   SDWAGRSV+4                                               02598000
SDWAGR00 EQU   SDWAGRSV                                                 02599000
SDWANXTP EQU   SDWACTL2+5                                               02600000
SDWASGP  EQU   SDWAPMKP                                                 02601000
SDWAEUP  EQU   SDWAPMKP                                                 02602000
SDWADOP  EQU   SDWAPMKP                                                 02603000
SDWAFPP  EQU   SDWAPMKP                                                 02604000
SDWACCP  EQU   SDWAPMKP                                                 02605000
SDWAILP  EQU   SDWAPMKP                                                 02606000
SDWAINTP EQU   SDWACTL2+2                                               02607000
SDWASPVP EQU   SDWAMWPP                                                 02608000
SDWAWATP EQU   SDWAMWPP                                                 02609000
SDWAMCKP EQU   SDWAMWPP                                                 02610000
@NM00076 EQU   SDWAMWPP                                                 02611000
SDWAKEYP EQU   SDWAMWPP                                                 02612000
SDWAEXTP EQU   SDWACMKP                                                 02613000
SDWAIOP  EQU   SDWACMKP                                                 02614000
SDWANXTA EQU   SDWACTL1+5                                               02615000
SDWASGA  EQU   SDWAPMKA                                                 02616000
SDWAEUA  EQU   SDWAPMKA                                                 02617000
SDWADOA  EQU   SDWAPMKA                                                 02618000
SDWAFPA  EQU   SDWAPMKA                                                 02619000
SDWACCA  EQU   SDWAPMKA                                                 02620000
SDWAILA  EQU   SDWAPMKA                                                 02621000
SDWAINTA EQU   SDWACTL1+2                                               02622000
SDWASPVA EQU   SDWAMWPA                                                 02623000
SDWAWATA EQU   SDWAMWPA                                                 02624000
SDWAMCKA EQU   SDWAMWPA                                                 02625000
@NM00075 EQU   SDWAMWPA                                                 02626000
SDWAKEYA EQU   SDWAMWPA                                                 02627000
SDWAEXTA EQU   SDWACMKA                                                 02628000
SDWAIOA  EQU   SDWACMKA                                                 02629000
@NM00074 EQU   SDWACMPF                                                 02630000
SDWASTCC EQU   SDWACMPF                                                 02631000
@NM00073 EQU   SDWACMPF                                                 02632000
SDWASTEP EQU   SDWACMPF                                                 02633000
@NM00072 EQU   TCBXTNT2+32                                              02634000
TCBRV181 EQU   TCBRV173                                                 02635000
TCBRV180 EQU   TCBRV173                                                 02636000
TCBRV179 EQU   TCBRV173                                                 02637000
TCBRV178 EQU   TCBRV173                                                 02638000
TCBRV177 EQU   TCBRV173                                                 02639000
TCBRV176 EQU   TCBRV173                                                 02640000
TCBRV175 EQU   TCBRV173                                                 02641000
TCBRV174 EQU   TCBRV173                                                 02642000
TCBRV172 EQU   TCBRV164                                                 02643000
TCBRV171 EQU   TCBRV164                                                 02644000
TCBRV170 EQU   TCBRV164                                                 02645000
TCBRV169 EQU   TCBRV164                                                 02646000
TCBRV168 EQU   TCBRV164                                                 02647000
TCBRV167 EQU   TCBRV164                                                 02648000
TCBRV166 EQU   TCBRV164                                                 02649000
TCBRV165 EQU   TCBRV164                                                 02650000
TCBRV163 EQU   TCBRV155                                                 02651000
TCBRV162 EQU   TCBRV155                                                 02652000
TCBRV161 EQU   TCBRV155                                                 02653000
TCBRV160 EQU   TCBRV155                                                 02654000
TCBRV159 EQU   TCBRV155                                                 02655000
TCBRV158 EQU   TCBRV155                                                 02656000
TCBRV157 EQU   TCBRV155                                                 02657000
TCBRV156 EQU   TCBRV155                                                 02658000
TCBRV154 EQU   TCBRV146                                                 02659000
TCBRV153 EQU   TCBRV146                                                 02660000
TCBRV152 EQU   TCBRV146                                                 02661000
TCBRV151 EQU   TCBRV146                                                 02662000
TCBRV150 EQU   TCBRV146                                                 02663000
TCBRV149 EQU   TCBRV146                                                 02664000
TCBRV148 EQU   TCBRV146                                                 02665000
TCBRV147 EQU   TCBRV146                                                 02666000
TCBRV145 EQU   TCBXTNT2+26                                              02667000
TCBRV144 EQU   TCBXTNT2+24                                              02668000
TCBCAUF  EQU   TCBXTNT2+20                                              02669000
TCBRV142 EQU   TCBXTNT2+16                                              02670000
TCBRSV49 EQU   TCBXTNT2+12                                              02671000
TCBRCMP  EQU   TCBXTNT2+5                                               02672000
TCBRSVAB EQU   TCBXTNT2+4                                               02673000
TCBGTFA  EQU   TCBGTF+1                                                 02674000
TCBRSV47 EQU   TCBTFLG                                                  02675000
TCBRSV46 EQU   TCBTFLG                                                  02676000
TCBRSV45 EQU   TCBTFLG                                                  02677000
TCBRSV44 EQU   TCBTFLG                                                  02678000
TCBRSV43 EQU   TCBTFLG                                                  02679000
TCBDSPIT EQU   TCBTFLG                                                  02680000
TCBERRTN EQU   TCBTFLG                                                  02681000
TCBASYNC EQU   TCBTFLG                                                  02682000
@NM00071 EQU   TCB+296                                                  02683000
TCBSVCA2 EQU   TCB+292                                                  02684000
TCBSWASA EQU   TCB+288                                                  02685000
TCBDBTB  EQU   TCB+284                                                  02686000
TCBRPT   EQU   TCB+280                                                  02687000
TCBRV141 EQU   TCBRV133                                                 02688000
TCBRV140 EQU   TCBRV133                                                 02689000
TCBRV139 EQU   TCBRV133                                                 02690000
TCBRV138 EQU   TCBRV133                                                 02691000
TCBRV137 EQU   TCBRV133                                                 02692000
TCBRV136 EQU   TCBRV133                                                 02693000
TCBRV135 EQU   TCBRV133                                                 02694000
TCBRV134 EQU   TCBRV133                                                 02695000
TCBRV132 EQU   TCBRV124                                                 02696000
TCBRV131 EQU   TCBRV124                                                 02697000
TCBRV130 EQU   TCBRV124                                                 02698000
TCBRV129 EQU   TCBRV124                                                 02699000
TCBRV128 EQU   TCBRV124                                                 02700000
TCBRV127 EQU   TCBRV124                                                 02701000
TCBRV126 EQU   TCBRV124                                                 02702000
TCBRV125 EQU   TCBRV124                                                 02703000
TCBRV123 EQU   TCBFBYT2                                                 02704000
TCBRV122 EQU   TCBFBYT2                                                 02705000
TCBECBNV EQU   TCBFBYT2                                                 02706000
TCBSSSYN EQU   TCBFBYT2                                                 02707000
TCBFPRAP EQU   TCBFBYT2                                                 02708000
TCBFDW   EQU   TCBFBYT2                                                 02709000
TCBFMW   EQU   TCBFBYT2                                                 02710000
TCBCNCB  EQU   TCBFBYT2                                                 02711000
TCBLLH   EQU   TCBFBYT1                                                 02712000
TCBRV113 EQU   TCBFBYT1                                                 02713000
TCBEOT   EQU   TCBFBYT1                                                 02714000
TCBRTM2  EQU   TCBFBYT1                                                 02715000
TCBPGNLY EQU   TCBFBYT1                                                 02716000
TCBNDIOS EQU   TCBFBYT1                                                 02717000
TCBACTIV EQU   TCBFBYT1                                                 02718000
TCBEOTFM EQU   TCBFBYT1                                                 02719000
TCBAFFN  EQU   TCB+274                                                  02720000
TCBCCPVI EQU   TCB+272                                                  02721000
TCBUKYSP EQU   TCB+268                                                  02722000
TCBMODE  EQU   TCBESTAE+3                                               02723000
TCBERTYP EQU   TCBESTAE+2                                               02724000
TCBRV314 EQU   TCBESTRM                                                 02725000
TCBRV313 EQU   TCBESTRM                                                 02726000
TCBRV312 EQU   TCBESTRM                                                 02727000
TCBRV311 EQU   TCBESTRM                                                 02728000
TCBRV310 EQU   TCBESTRM                                                 02729000
TCBRV309 EQU   TCBESTRM                                                 02730000
TCBRV308 EQU   TCBESTRM                                                 02731000
TCBETERM EQU   TCBESTRM                                                 02732000
TCBSCBKY EQU   TCBESTAE                                                 02733000
TCBRTM12 EQU   TCB+260                                                  02734000
TCBTCBID EQU   TCB+256                                                  02735000
TCBRSV96 EQU   TCB+252                                                  02736000
TCBSWA   EQU   TCB+248                                                  02737000
TCBFOEA  EQU   TCBFOE+1                                                 02738000
TCBRSV42 EQU   TCBFOE                                                   02739000
TCBRV306 EQU   TCB+240                                                  02740000
TCBRSV41 EQU   TCB+239                                                  02741000
TCBTID   EQU   TCB+238                                                  02742000
TCBRSVAA EQU   TCB+237                                                  02743000
TCBABCUR EQU   TCB+236                                                  02744000
TCBTMSAV EQU   TCB+232                                                  02745000
TCBIOTIM EQU   TCB+228                                                  02746000
TCBRTWA  EQU   TCB+224                                                  02747000
TCBBACK  EQU   TCB+220                                                  02748000
TCBTIRB  EQU   TCB+216                                                  02749000
TCBAECB  EQU   TCB+212                                                  02750000
TCBEXT2A EQU   TCBEXT2+1                                                02751000
TCBRSV39 EQU   TCBEXT2                                                  02752000
TCBSTMCT EQU   TCB+207                                                  02753000
TCBSYSCT EQU   TCB+206                                                  02754000
TCBRSV37 EQU   TCB+205                                                  02755000
TCBEXSVC EQU   TCBDAR                                                   02756000
TCBDARMS EQU   TCBDAR                                                   02757000
TCBDARWT EQU   TCBDAR                                                   02758000
TCBDARO  EQU   TCBDAR                                                   02759000
TCBDARMC EQU   TCBDARC                                                  02760000
TCBDARD  EQU   TCBDAR                                                   02761000
TCBDARS  EQU   TCBDAR                                                   02762000
TCBDARP  EQU   TCBDAR                                                   02763000
TCBGTOFM EQU   TCBFLGS7                                                 02764000
TCBADMP  EQU   TCBFLGS7                                                 02765000
TCBRSTSK EQU   TCBFLGS7                                                 02766000
TCBSVCS  EQU   TCBFLGS7                                                 02767000
TCBSTACK EQU   TCBFLGS7                                                 02768000
TCBRSV34 EQU   TCBFLGS7                                                 02769000
TCBRSV33 EQU   TCBFLGS7                                                 02770000
TCBGPECB EQU   TCBFLGS7                                                 02771000
TCBNTJS  EQU   TCBFLGS6                                                 02772000
TCBAPG   EQU   TCBFLGS6                                                 02773000
TCBMIGR  EQU   TCBFLGS6                                                 02774000
TCBRV303 EQU   TCBFLGS6                                                 02775000
TCBSPVLK EQU   TCBFLGS6                                                 02776000
TCBCPU   EQU   TCBFLGS6                                                 02777000
TCBPIE17 EQU   TCBFLGS6                                                 02778000
TCBRV    EQU   TCBFLGS6                                                 02779000
TCBRSV79 EQU   TCBNDSP5                                                 02780000
TCBRSV78 EQU   TCBNDSP5                                                 02781000
TCBRSV77 EQU   TCBNDSP5                                                 02782000
TCBRSV76 EQU   TCBNDSP5                                                 02783000
TCBRSV75 EQU   TCBNDSP5                                                 02784000
TCBRSV74 EQU   TCBNDSP5                                                 02785000
TCBRSV95 EQU   TCBNDSP5                                                 02786000
TCBRSV94 EQU   TCBNDSP5                                                 02787000
TCBRSV93 EQU   TCBNDSP4                                                 02788000
TCBRSV92 EQU   TCBNDSP4                                                 02789000
TCBRSV91 EQU   TCBNDSP4                                                 02790000
TCBRSV90 EQU   TCBNDSP4                                                 02791000
TCBRSV89 EQU   TCBNDSP4                                                 02792000
TCBRSV88 EQU   TCBNDSP4                                                 02793000
TCBRSV87 EQU   TCBNDSP4                                                 02794000
TCBRSV86 EQU   TCBNDSP4                                                 02795000
TCBEXT1A EQU   TCBEXT1+1                                                02796000
TCBRSV32 EQU   TCBEXT1                                                  02797000
TCBEXCPD EQU   TCB+192                                                  02798000
TCBIOBRC EQU   TCB+188                                                  02799000
TCBDDWTC EQU   TCB+186                                                  02800000
TCBDDEXC EQU   TCB+184                                                  02801000
TCBJSCBB EQU   TCBJSCB+1                                                02802000
@NM00070 EQU   TCBRECDE                                                 02803000
TCBREC   EQU   TCBRECDE                                                 02804000
TCBMDIDS EQU   TCB+176                                                  02805000
TCBNDINT EQU   TCBNDSP3                                                 02806000
TCBRSV27 EQU   TCBNDSP3                                                 02807000
TCBRSV26 EQU   TCBNDSP3                                                 02808000
TCBRSV25 EQU   TCBNDSP3                                                 02809000
TCBRSV24 EQU   TCBNDSP3                                                 02810000
TCBSRBND EQU   TCBNDSP3                                                 02811000
TCBRV302 EQU   TCBNDSP3                                                 02812000
TCBLJSND EQU   TCBNDSP3                                                 02813000
TCBABE   EQU   TCBNDSP2                                                 02814000
TCBDSS   EQU   TCBNDSP2                                                 02815000
TCBOWAIT EQU   TCBNDSP2                                                 02816000
TCBIWAIT EQU   TCBNDSP2                                                 02817000
TCBNDTS  EQU   TCBNDSP2                                                 02818000
TCBNDSVC EQU   TCBNDSP2                                                 02819000
TCBSTPP  EQU   TCBNDSP2                                                 02820000
TCBABD   EQU   TCBNDSP2                                                 02821000
TCBRSV22 EQU   TCBNDSP1                                                 02822000
TCBPIEND EQU   TCBNDSP1                                                 02823000
TCBTPSP  EQU   TCBNDSP1                                                 02824000
TCBDDRND EQU   TCBNDSP1                                                 02825000
TCBRSPND EQU   TCBNDSP1                                                 02826000
TCBRSTND EQU   TCBNDSP1                                                 02827000
TCBDARPN EQU   TCBNDSP1                                                 02828000
TCBDARTN EQU   TCBNDSP1                                                 02829000
TCBNDSP0 EQU   TCBNDSP                                                  02830000
TCBUSER  EQU   TCB+168                                                  02831000
TCBTCTB  EQU   TCBTCT+1                                                 02832000
TCBRSV9C EQU   TCBTCTGF                                                 02833000
TCBRSV9B EQU   TCBTCTGF                                                 02834000
TCBRSV9A EQU   TCBTCTGF                                                 02835000
TCBRSV99 EQU   TCBTCTGF                                                 02836000
TCBRSV98 EQU   TCBTCTGF                                                 02837000
TCBRSV97 EQU   TCBTCTGF                                                 02838000
TCBRSV20 EQU   TCBTCTGF                                                 02839000
TCBSMFGF EQU   TCBTCTGF                                                 02840000
TCBSTABB EQU   TCBSTAB+1                                                02841000
TCBSTCUR EQU   TCBNSTAE                                                 02842000
TCBRV301 EQU   TCBNSTAE                                                 02843000
TCBSYNCH EQU   TCBNSTAE                                                 02844000
TCBHALT  EQU   TCBNSTAE                                                 02845000
TCBPPSUP EQU   TCBNSTAE                                                 02846000
TCB33E   EQU   TCBNSTAE                                                 02847000
TCBQUIES EQU   TCBNSTAE                                                 02848000
TCBSTABE EQU   TCBNSTAE                                                 02849000
TCBAQE   EQU   TCB+156                                                  02850000
TCBPQE   EQU   TCB+152                                                  02851000
TCBTSDP  EQU   TCB+151                                                  02852000
TCBTSLP  EQU   TCB+150                                                  02853000
TCBSTPCT EQU   TCB+149                                                  02854000
TCBCPUBN EQU   TCBTSFLG                                                 02855000
TCBDYDSP EQU   TCBTSFLG                                                 02856000
TCBRSV18 EQU   TCBTSFLG                                                 02857000
TCBRSV17 EQU   TCBTSFLG                                                 02858000
TCBTIOTG EQU   TCBTSFLG                                                 02859000
TCBATT   EQU   TCBTSFLG                                                 02860000
TCBSTPPR EQU   TCBTSFLG                                                 02861000
TCBRV300 EQU   TCBTSTSK                                                 02862000
TCBECB   EQU   TCB+144                                                  02863000
TCBIQE   EQU   TCB+140                                                  02864000
TCBLTC   EQU   TCB+136                                                  02865000
TCBOTC   EQU   TCB+132                                                  02866000
TCBNTC   EQU   TCB+128                                                  02867000
TCBJSTCA EQU   TCBJSTCB+1                                               02868000
TCBRSV16 EQU   TCBJSTCB                                                 02869000
TCBTQET  EQU   TCBTME                                                   02870000
TCBTCB   EQU   TCB+116                                                  02871000
TCBFSAB  EQU   TCBFSA+1                                                 02872000
TCBQEL   EQU   TCBFSA                                                   02873000
TCBGRS15 EQU   TCBGRS+60                                                02874000
TCBGRS14 EQU   TCBGRS+56                                                02875000
TCBGRS13 EQU   TCBGRS+52                                                02876000
TCBGRS12 EQU   TCBGRS+48                                                02877000
TCBGRS11 EQU   TCBGRS+44                                                02878000
TCBGRS10 EQU   TCBGRS+40                                                02879000
TCBGRS9  EQU   TCBGRS+36                                                02880000
TCBGRS8  EQU   TCBGRS+32                                                02881000
TCBGRS7  EQU   TCBGRS+28                                                02882000
TCBGRS6  EQU   TCBGRS+24                                                02883000
TCBGRS5  EQU   TCBGRS+20                                                02884000
TCBGRS4  EQU   TCBGRS+16                                                02885000
TCBGRS3  EQU   TCBGRS+12                                                02886000
TCBGRS2  EQU   TCBGRS+8                                                 02887000
TCBGRS0  EQU   TCBGRS                                                   02888000
TCBJPQB  EQU   TCBJPQ+1                                                 02889000
TCBRSV15 EQU   TCBPURGE                                                 02890000
TCBRSV14 EQU   TCBPURGE                                                 02891000
TCBRSV13 EQU   TCBPURGE                                                 02892000
TCBRSV12 EQU   TCBPURGE                                                 02893000
TCBRSV11 EQU   TCBPURGE                                                 02894000
TCBRSV10 EQU   TCBPURGE                                                 02895000
TCBRSV09 EQU   TCBPURGE                                                 02896000
TCBJPQF  EQU   TCBPURGE                                                 02897000
TCBJLB   EQU   TCB+40                                                   02898000
TCBLLS   EQU   TCB+36                                                   02899000
TCBDSP   EQU   TCB+35                                                   02900000
TCBLMP   EQU   TCB+34                                                   02901000
TCBPNDSP EQU   TCBFLGS5                                                 02902000
TCBFCD1  EQU   TCBFLGS5                                                 02903000
TCBSTP   EQU   TCBFLGS5                                                 02904000
TCBSYS   EQU   TCBFLGS5                                                 02905000
TCBANDSP EQU   TCBFLGS5                                                 02906000
TCBPAGE  EQU   TCBFLGS5                                                 02907000
TCBUXNDF EQU   TCBABWF                                                  02908000
TCBFC    EQU   TCBFLGS5                                                 02909000
TCBONDSP EQU   TCBFLGS4                                                 02910000
TCBMPCND EQU   TCBFLGS4                                                 02911000
TCBMPCVQ EQU   TCBFLGS4                                                 02912000
TCBUXNDV EQU   TCBFLGS4                                                 02913000
TCBHNDSP EQU   TCBFLGS4                                                 02914000
TCBRQENA EQU   TCBFLGS4                                                 02915000
TCBSER   EQU   TCBFLGS4                                                 02916000
TCBNDUMP EQU   TCBFLGS4                                                 02917000
TCBDWSTA EQU   TCBFLGS3                                                 02918000
TCBRSV08 EQU   TCBFLGS3                                                 02919000
TCBRSV07 EQU   TCBFLGS3                                                 02920000
TCBRSV06 EQU   TCBFLGS3                                                 02921000
TCBABGM  EQU   TCBFLGS3                                                 02922000
TCBABTRM EQU   TCBFLGS3                                                 02923000
TCBADINP EQU   TCBFLGS3                                                 02924000
TCBFSM   EQU   TCBFLGS3                                                 02925000
TCBFTS   EQU   TCBFLGS2                                                 02926000
TCBFETXR EQU   TCBFLGS2                                                 02927000
TCBFDSOP EQU   TCBFLGS2                                                 02928000
TCBFJMC  EQU   TCBFLGS2                                                 02929000
TCBFSMC  EQU   TCBFLGS2                                                 02930000
TCBFABOP EQU   TCBFLGS2                                                 02931000
TCBFSTI  EQU   TCBFLGS2                                                 02932000
TCBFOINP EQU   TCBFLGS2                                                 02933000
TCBFX    EQU   TCBFLGS1                                                 02934000
TCBFS    EQU   TCBFLGS1                                                 02935000
TCBFT    EQU   TCBFLGS1                                                 02936000
TCBPDUMP EQU   TCBFLGS1                                                 02937000
TCBNONPR EQU   TCBFLGS1                                                 02938000
TCBFERA  EQU   TCBFLGS1                                                 02939000
TCBFE    EQU   TCBFLGS1                                                 02940000
TCBFA    EQU   TCBFLGS1                                                 02941000
TCBZERO  EQU   TCBPKF                                                   02942000
TCBFLAG  EQU   TCBPKF                                                   02943000
TCBMSSB  EQU   TCBMSS+1                                                 02944000
TCBRSV03 EQU   TCBMSS                                                   02945000
TCBTRNB  EQU   TCBTRN+1                                                 02946000
TCBRSV02 EQU   TCBABF                                                   02947000
TCBOLTEP EQU   TCBABF                                                   02948000
TCBTCP   EQU   TCBABF                                                   02949000
TCBTCPP  EQU   TCBABF                                                   02950000
TCBRSV01 EQU   TCBABF                                                   02951000
TCBGRPH  EQU   TCBABF                                                   02952000
TCBNOCHK EQU   TCBABF                                                   02953000
TCBMOD91 EQU   TCBABF                                                   02954000
TCBCMPC  EQU   TCBCMP+1                                                 02955000
TCBRV318 EQU   TCBCMSG                                                  02956000
TCBRV317 EQU   TCBCIND                                                  02957000
TCBRV316 EQU   TCBCWTO                                                  02958000
TCBCASID EQU   TCBCDBL                                                  02959000
TCBNOCC  EQU   TCBSTCC                                                  02960000
TCBDMPO  EQU   TCBCPP                                                   02961000
TCBCSTEP EQU   TCBCMPF                                                  02962000
TCBCREQ  EQU   TCBCMPF                                                  02963000
TCBTIO   EQU   TCB+12                                                   02964000
TCBDEB   EQU   TCB+8                                                    02965000
TCBPIEA  EQU   TCBPIE+1                                                 02966000
TCBPM    EQU   TCBPMASK                                                 02967000
@NM00069 EQU   TCBPMASK                                                 02968000
TCBFRS6  EQU   TCBFRS+24                                                02969000
TCBFRS4  EQU   TCBFRS+16                                                02970000
TCBFRS2  EQU   TCBFRS+8                                                 02971000
TCBFRS0  EQU   TCBFRS                                                   02972000
SIRBEND  EQU   RBSECT+168                                               02973000
SVRBEND  EQU   RBSECT+168                                               02974000
RBRSV158 EQU   RBRSV150                                                 02975000
RBRSV157 EQU   RBRSV150                                                 02976000
RBRSV156 EQU   RBRSV150                                                 02977000
RBRSV155 EQU   RBRSV150                                                 02978000
RBRSV154 EQU   RBRSV150                                                 02979000
RBRSV153 EQU   RBRSV150                                                 02980000
RBRSV152 EQU   RBRSV150                                                 02981000
RBRSV151 EQU   RBRSV150                                                 02982000
RBRSV149 EQU   RBSECT+166                                               02983000
RBRSV148 EQU   RBSECT+164                                               02984000
RBSCBB   EQU   RBSECT+144                                               02985000
TIRBEND  EQU   @NM00067+8                                               02986000
PRBEND   EQU   @NM00067+8                                               02987000
RBRSV146 EQU   RBRSV138                                                 02988000
RBRSV145 EQU   RBRSV138                                                 02989000
RBRSV144 EQU   RBRSV138                                                 02990000
RBRSV143 EQU   RBRSV138                                                 02991000
RBRSV142 EQU   RBRSV138                                                 02992000
RBRSV141 EQU   RBRSV138                                                 02993000
RBRSV140 EQU   RBRSV138                                                 02994000
RBRSV139 EQU   RBRSV138                                                 02995000
RBRSV137 EQU   @NM00067+6                                               02996000
RBRSV136 EQU   @NM00067+4                                               02997000
RBRSV135 EQU   @NM00067                                                 02998000
@NM00066 EQU   RBSECT+32                                                02999000
@NM00065 EQU   @NM00063+1                                               03000000
@NM00064 EQU   @NM00063                                                 03001000
RBPGMQ1  EQU   RBPGMQ+1                                                 03002000
@NM00062 EQU   RBPGMQ                                                   03003000
@NM00061 EQU   RBSECT+16                                                03004000
@NM00060 EQU   @NM00056                                                 03005000
@NM00059 EQU   @NM00056                                                 03006000
RBIQETP  EQU   @NM00056                                                 03007000
RBUSIQE  EQU   RBETXR                                                   03008000
RBATTN   EQU   @NM00056                                                 03009000
@NM00058 EQU   @NM00056                                                 03010000
@NM00057 EQU   @NM00056                                                 03011000
RBPMSVRB EQU   @NM00054                                                 03012000
RBATNXIT EQU   @NM00054                                                 03013000
@NM00055 EQU   @NM00054                                                 03014000
RBWAITP  EQU   @NM00054                                                 03015000
RBFNSVRB EQU   RBTRSVRB                                                 03016000
RBFTP    EQU   @NM00054                                                 03017000
RBSIZE   EQU   RBSECT+8                                                 03018000
RBABOPSW EQU   RBSECT+4                                                 03019000
RBPPSAV1 EQU   RBPPSAV+1                                                03020000
@NM00052 EQU   RBPPSAV                                                  03021000
RBPRFXND EQU   RBPREFIX+64                                              03022000
RBINTCOD EQU   RBINTCDA+1                                               03023000
RBINLNTH EQU   RBINTCDA                                                 03024000
RBWCSA   EQU   RBPREFIX+60                                              03025000
RBRSV004 EQU   RBPREFIX+57                                              03026000
RBSSSYN  EQU   RBFLAGS1                                                 03027000
RBSCB    EQU   RBFLAGS1                                                 03028000
RBLONGWT EQU   RBFLAGS1                                                 03029000
RBASIR   EQU   RBFLAGS1                                                 03030000
RBRSV159 EQU   RBFLAGS1                                                 03031000
RBABEND  EQU   RBFLAGS1                                                 03032000
RBSLOCK  EQU   RBFLAGS1                                                 03033000
RBRTRAN  EQU   RBRTPSW2+4                                               03034000
RBRTINCD EQU   RBRTICIL+2                                               03035000
RBRTILC  EQU   RBRTICIL+1                                               03036000
RBRSV160 EQU   RBRTICIL                                                 03037000
RBRTPSW1 EQU   RBRTOPSW                                                 03038000
RBRSV062 EQU   RBRSV054                                                 03039000
RBRSV061 EQU   RBRSV054                                                 03040000
RBRSV060 EQU   RBRSV054                                                 03041000
RBRSV059 EQU   RBRSV054                                                 03042000
RBRSV058 EQU   RBRSV054                                                 03043000
RBRSV057 EQU   RBRSV054                                                 03044000
RBRSV056 EQU   RBRSV054                                                 03045000
RBRSV055 EQU   RBRSV054                                                 03046000
RBRSV053 EQU   RBPREFIX+38                                              03047000
RBRSV052 EQU   RBPREFIX+36                                              03048000
RBRSV051 EQU   RBPREFIX+32                                              03049000
RBPRFXST EQU   RBPREFIX+32                                              03050000
RBRSV050 EQU   RBPREFIX+28                                              03051000
RBRSV049 EQU   RBRSV041                                                 03052000
RBRSV048 EQU   RBRSV041                                                 03053000
RBRSV047 EQU   RBRSV041                                                 03054000
RBRSV046 EQU   RBRSV041                                                 03055000
RBRSV045 EQU   RBRSV041                                                 03056000
RBRSV044 EQU   RBRSV041                                                 03057000
RBRSV043 EQU   RBRSV041                                                 03058000
RBRSV042 EQU   RBRSV041                                                 03059000
RBRSV040 EQU   RBPREFIX+26                                              03060000
RBRSV039 EQU   RBPREFIX+24                                              03061000
RBRSV038 EQU   RBPREFIX+20                                              03062000
RBRSV037 EQU   RBPREFIX+16                                              03063000
RBRSV036 EQU   RBRSV028                                                 03064000
RBRSV035 EQU   RBRSV028                                                 03065000
RBRSV034 EQU   RBRSV028                                                 03066000
RBRSV033 EQU   RBRSV028                                                 03067000
RBRSV032 EQU   RBRSV028                                                 03068000
RBRSV031 EQU   RBRSV028                                                 03069000
RBRSV030 EQU   RBRSV028                                                 03070000
RBRSV029 EQU   RBRSV028                                                 03071000
RBRSV027 EQU   RBRSV019                                                 03072000
RBRSV026 EQU   RBRSV019                                                 03073000
RBRSV025 EQU   RBRSV019                                                 03074000
RBRSV024 EQU   RBRSV019                                                 03075000
RBRSV023 EQU   RBRSV019                                                 03076000
RBRSV022 EQU   RBRSV019                                                 03077000
RBRSV021 EQU   RBRSV019                                                 03078000
RBRSV020 EQU   RBRSV019                                                 03079000
RBRSV018 EQU   RBPREFIX+13                                              03080000
RBRSV017 EQU   RBPREFIX+12                                              03081000
RBSRV016 EQU   RBPREFIX+11                                              03082000
RBRSV015 EQU   RBPREFIX+10                                              03083000
RBRSV014 EQU   RBPREFIX+8                                               03084000
RBRSV013 EQU   RBPREFIX+4                                               03085000
RBRSV012 EQU   RBPREFIX                                                 03086000
RBEXSAVE EQU   XRBESA                                                   03087000
XRBREG15 EQU   RBGRS15                                                  03088000
XRBREG14 EQU   RBGRS14                                                  03089000
XRBREG13 EQU   RBGRS13                                                  03090000
XRBREG12 EQU   RBGRS12                                                  03091000
XRBREG11 EQU   RBGRS11                                                  03092000
XRBREG10 EQU   RBGRS10                                                  03093000
XRBREG9  EQU   RBGRS9                                                   03094000
XRBREG8  EQU   RBGRS8                                                   03095000
XRBREG7  EQU   RBGRS7                                                   03096000
XRBREG6  EQU   RBGRS6                                                   03097000
XRBREG5  EQU   RBGRS5                                                   03098000
XRBREG4  EQU   RBGRS4                                                   03099000
XRBREG3  EQU   RBGRS3                                                   03100000
XRBREG2  EQU   RBGRS2                                                   03101000
XRBREG1  EQU   RBGRS1                                                   03102000
XRBREG0  EQU   RBGRS0                                                   03103000
XRBLNKA  EQU   RBLINKB                                                  03104000
XRBWT    EQU   RBWCF                                                    03105000
@NM00051 EQU   RBBASIC+24                                               03106000
RBOPSWPS EQU   RBOPSWB2                                                 03107000
@NM00050 EQU   RBOPSWB2                                                 03108000
@NM00049 EQU   XRBPSW                                                   03109000
@NM00048 EQU   RBBASIC+12                                               03110000
XRBWAIT  EQU   RBECBWT                                                  03111000
XRBFRRB  EQU   RBFDYN                                                   03112000
@NM00047 EQU   XSTAB2                                                   03113000
XRBACTV  EQU   RBFACTV                                                  03114000
XRBTCBP  EQU   RBTCBNXT                                                 03115000
@NM00046 EQU   XSTAB1                                                   03116000
XRBCKPT  EQU   RBFTCKPT                                                 03117000
@NM00045 EQU   XSTAB1                                                   03118000
@NM00044 EQU   RBBASIC+8                                                03119000
@NM00043 EQU   RBEXRTNM+1                                               03120000
RBTMIND3 EQU   RBTMFLD                                                  03121000
RBTMIND2 EQU   RBTMFLD                                                  03122000
RBTMCMP  EQU   RBTMFLD                                                  03123000
RBWLIM   EQU   RBTMFLD                                                  03124000
RBRSV005 EQU   RBTMFLD                                                  03125000
RBTMTOD  EQU   RBTMFLD                                                  03126000
RBTMQUE  EQU   RBTMFLD                                                  03127000
@NM00042 EQU   RBPRFX                                                   03128000
FRRSPARM EQU   FRRSENTR+8                                               03129000
@NM00041 EQU   FRRSFLGS+1                                               03130000
@NM00040 EQU   FRRSFLG1                                                 03131000
FRRSNEST EQU   FRRSFLG1                                                 03132000
FRRSRCUR EQU   FRRSFLG1                                                 03133000
FRRSFRRA EQU   FRRSENTR                                                 03134000
FRRSENTS EQU   FRRS+84                                                  03135000
FRRSRTMW EQU   FRRS+16                                                  03136000
FRRSELEN EQU   FRRSHEAD+8                                               03137000
FRRSLAST EQU   FRRSHEAD+4                                               03138000
FRRSEMP  EQU   FRRSHEAD                                                 03139000
JSCBPMG  EQU   JSCBWTP+2                                                03140000
JSCBWTSP EQU   JSCBWTP+1                                                03141000
JSCRSV23 EQU   JSCBWTFG                                                 03142000
JSCRSV22 EQU   JSCBWTFG                                                 03143000
JSCRSV21 EQU   JSCBWTFG                                                 03144000
JSCRSV20 EQU   JSCBWTFG                                                 03145000
JSCRSV19 EQU   JSCBWTFG                                                 03146000
JSCRSV18 EQU   JSCBWTFG                                                 03147000
JSCBRET  EQU   JSCBWTFG                                                 03148000
JSCBIOFG EQU   JSCBWTFG                                                 03149000
@NM00013 EQU   JSCBSEC1+60                                              03150000
JSCBQMPI EQU   JSCBSEC1+56                                              03151000
JSCBPMSG EQU   JSCBSWT1                                                 03152000
JSCRSV16 EQU   JSCBSWT1                                                 03153000
JSCRSV15 EQU   JSCBSWT1                                                 03154000
JSCRSV14 EQU   JSCBSWT1                                                 03155000
JSCRSV13 EQU   JSCBSWT1                                                 03156000
JSCRSV12 EQU   JSCBSWT1                                                 03157000
JSCRSV11 EQU   JSCBSWT1                                                 03158000
JSCBPASS EQU   JSCBSWT1                                                 03159000
JSCBTTTR EQU   JSCBSEC1+52                                              03160000
JSCRSV10 EQU   JSCBSEC1+49                                              03161000
JSCBAUTH EQU   JSCBOPTS                                                 03162000
JSCSIOTS EQU   JSCBOPTS                                                 03163000
JSCRSV08 EQU   JSCBOPTS                                                 03164000
JSCRSV07 EQU   JSCBOPTS                                                 03165000
JSCRSV06 EQU   JSCBOPTS                                                 03166000
JSCBLONG EQU   JSCBOPTS                                                 03167000
JSCRSV05 EQU   JSCBOPTS                                                 03168000
JSCRSV04 EQU   JSCBOPTS                                                 03169000
JSCBSECB EQU   JSCBSEC1+44                                              03170000
JSCRSV03 EQU   JSCBSEC1+41                                              03171000
JSCBSTEP EQU   JSCBSEC1+40                                              03172000
JSCBDCBA EQU   JSCBDCB+1                                                03173000
JSCRSV02 EQU   JSCBDCB                                                  03174000
JSCBID   EQU   JSCBSEC1+32                                              03175000
JSCBDBTB EQU   JSCBSEC1+28                                              03176000
JSCBIJSC EQU   JSCBSEC1+24                                              03177000
JSCBTCBP EQU   JSCBSEC1+20                                              03178000
JSCBPCC  EQU   JSCBSEC1+16                                              03179000
JSCBTCP  EQU   JSCBSEC1+12                                              03180000
JSCBSHR  EQU   JSCBSEC1+8                                               03181000
JSCHPCEA EQU   JSCHPCE+1                                                03182000
JSCRSV32 EQU   JSCHPCE                                                  03183000
JSCRSV01 EQU   JSCBSEC1                                                 03184000
@NM00012 EQU   IEZJSCB                                                  03185000
EVNTENTP EQU   EVNTENTY+1                                               03186000
@NM00011 EQU   EVNTFLGS                                                 03187000
EVNTRES3 EQU   EVNTBEGN+32                                              03188000
EVNTRES2 EQU   EVNTBEGN+28                                              03189000
ECBEVNT  EQU   ECBEXTND                                                 03190000
@NM00010 EQU   ECBEXTND                                                 03191000
@NM00009 EQU   ECBBYTE3                                                 03192000
@NM00008 EQU   ECBEXTBA                                                 03193000
@NM00007 EQU   ECBCC                                                    03194000
ECBPOSTB EQU   ECBCC                                                    03195000
ECBWAITB EQU   ECBCC                                                    03196000
CVTLEVL  EQU   CVTRELNO+2                                               03197000
CVTNUMB  EQU   CVTRELNO                                                 03198000
CVTMDL   EQU   CVTFIX+250                                               03199000
@NM00006 EQU   CVTFIX+248                                               03200000
@NM00005 EQU   CVTFIX                                                   03201000
CVTRV482 EQU   CVTXTNT2+128                                             03202000
CVTRV481 EQU   CVTXTNT2+124                                             03203000
CVTRV480 EQU   CVTXTNT2+120                                             03204000
CVTRV479 EQU   CVTXTNT2+118                                             03205000
CVTRV478 EQU   CVTXTNT2+117                                             03206000
CVTRV477 EQU   CVTXTNT2+116                                             03207000
CVTRV476 EQU   CVTXTNT2+115                                             03208000
CVTRV475 EQU   CVTXTNT2+114                                             03209000
CVTRV474 EQU   CVTRV466                                                 03210000
CVTRV473 EQU   CVTRV466                                                 03211000
CVTRV472 EQU   CVTRV466                                                 03212000
CVTRV471 EQU   CVTRV466                                                 03213000
CVTRV470 EQU   CVTRV466                                                 03214000
CVTRV469 EQU   CVTRV466                                                 03215000
CVTRV468 EQU   CVTRV466                                                 03216000
CVTRV467 EQU   CVTRV466                                                 03217000
CVTRV465 EQU   CVTRV457                                                 03218000
CVTRV464 EQU   CVTRV457                                                 03219000
CVTRV463 EQU   CVTRV457                                                 03220000
CVTRV462 EQU   CVTRV457                                                 03221000
CVTRV461 EQU   CVTRV457                                                 03222000
CVTRV460 EQU   CVTRV457                                                 03223000
CVTRV459 EQU   CVTRV457                                                 03224000
CVTRV458 EQU   CVTRV457                                                 03225000
CVTRV456 EQU   CVTXTNT2+108                                             03226000
CVTRV455 EQU   CVTXTNT2+104                                             03227000
CVTRV454 EQU   CVTXTNT2+100                                             03228000
CVTRV453 EQU   CVTXTNT2+96                                              03229000
CVTRV452 EQU   CVTXTNT2+94                                              03230000
CVTRV451 EQU   CVTXTNT2+92                                              03231000
CVTRV450 EQU   CVTXTNT2+90                                              03232000
CVTRV449 EQU   CVTXTNT2+88                                              03233000
CVTRV448 EQU   CVTXTNT2+87                                              03234000
CVTRV447 EQU   CVTXTNT2+86                                              03235000
CVTRV446 EQU   CVTRV438                                                 03236000
CVTRV445 EQU   CVTRV438                                                 03237000
CVTRV444 EQU   CVTRV438                                                 03238000
CVTRV443 EQU   CVTRV438                                                 03239000
CVTRV442 EQU   CVTRV438                                                 03240000
CVTRV441 EQU   CVTRV438                                                 03241000
CVTRV440 EQU   CVTRV438                                                 03242000
CVTRV439 EQU   CVTRV438                                                 03243000
CVTRV437 EQU   CVTRV429                                                 03244000
CVTRV436 EQU   CVTRV429                                                 03245000
CVTRV435 EQU   CVTRV429                                                 03246000
CVTRV434 EQU   CVTRV429                                                 03247000
CVTRV433 EQU   CVTRV429                                                 03248000
CVTRV432 EQU   CVTRV429                                                 03249000
CVTRV431 EQU   CVTRV429                                                 03250000
CVTRV430 EQU   CVTRV429                                                 03251000
CVTRV428 EQU   CVTXTNT2+80                                              03252000
CVTRV427 EQU   CVTXTNT2+76                                              03253000
CVTRV426 EQU   CVTXTNT2+72                                              03254000
CVTRV425 EQU   CVTXTNT2+68                                              03255000
CVTATACT EQU   CVTATCVT                                                 03256000
CVTRV423 EQU   CVTXTNT2+62                                              03257000
CVTRV422 EQU   CVTXTNT2+60                                              03258000
CVTRV421 EQU   CVTXTNT2+58                                              03259000
CVTRV420 EQU   CVTXTNT2+56                                              03260000
CVTRV419 EQU   CVTXTNT2+55                                              03261000
CVTRV418 EQU   CVTXTNT2+54                                              03262000
CVTRV417 EQU   CVTRV409                                                 03263000
CVTRV416 EQU   CVTRV409                                                 03264000
CVTRV415 EQU   CVTRV409                                                 03265000
CVTRV414 EQU   CVTRV409                                                 03266000
CVTRV413 EQU   CVTRV409                                                 03267000
CVTRV412 EQU   CVTRV409                                                 03268000
CVTRV411 EQU   CVTRV409                                                 03269000
CVTRV410 EQU   CVTRV409                                                 03270000
CVTRV408 EQU   CVTRV400                                                 03271000
CVTRV407 EQU   CVTRV400                                                 03272000
CVTRV406 EQU   CVTRV400                                                 03273000
CVTRV405 EQU   CVTRV400                                                 03274000
CVTRV404 EQU   CVTRV400                                                 03275000
CVTRV403 EQU   CVTRV400                                                 03276000
CVTRV402 EQU   CVTRV400                                                 03277000
CVTRV401 EQU   CVTRV400                                                 03278000
CVTICB   EQU   CVTXTNT2+48                                              03279000
CVTSKTA  EQU   CVTXTNT2+44                                              03280000
CVTCCVT  EQU   CVTXTNT2+40                                              03281000
CVTRSV98 EQU   CVTXTNT2+36                                              03282000
CVTRSV97 EQU   CVTXTNT2+34                                              03283000
CVTRSV96 EQU   CVTXTNT2+32                                              03284000
CVTOLTEP EQU   CVTXTNT2+28                                              03285000
CVTQIDA  EQU   CVTQID+1                                                 03286000
CVTRSV95 EQU   CVTQID                                                   03287000
CVTRSV94 EQU   CVTXTNT2+20                                              03288000
CVTRSV93 EQU   CVTXTNT2+16                                              03289000
CVTRSV92 EQU   CVTXTNT2+12                                              03290000
CVTDEBVR EQU   CVTXTNT2+8                                               03291000
CVTRSV91 EQU   CVTXTNT2+6                                               03292000
CVTRSV9H EQU   CVTFLGBT                                                 03293000
CVTRSV9G EQU   CVTFLGBT                                                 03294000
CVTRSV9F EQU   CVTFLGBT                                                 03295000
CVTRSV9E EQU   CVTFLGBT                                                 03296000
CVTRSV9D EQU   CVTFLGBT                                                 03297000
CVTRSV9C EQU   CVTFLGBT                                                 03298000
CVTVME   EQU   CVTFLGBT                                                 03299000
CVTNPE   EQU   CVTFLGBT                                                 03300000
CVTNUCLS EQU   CVTXTNT2+4                                               03301000
CVTDSSVA EQU   CVTDSSV+1                                                03302000
CVTRSV89 EQU   CVTDSSV                                                  03303000
CVTRSV88 EQU   CVTXTNT1+8                                               03304000
CVTRSV87 EQU   CVTXTNT1+4                                               03305000
CVTFACHN EQU   CVTXTNT1                                                 03306000
CVTRV488 EQU   CVTMAP+412                                               03307000
CVTRV487 EQU   CVTMAP+408                                               03308000
CVTRV486 EQU   CVTMAP+404                                               03309000
CVTRV485 EQU   CVTMAP+400                                               03310000
CVTACTAP EQU   CVTMAP+396                                               03311000
CVTAUTH  EQU   CVTMAP+392                                               03312000
CVTATMCA EQU   CVTATMCT+1                                               03313000
CVTATMST EQU   CVTATMCT                                                 03314000
CVTRSV61 EQU   CVTMAP+384                                               03315000
CVTVOLT1 EQU   CVTVOLM1+1                                               03316000
CVTVOLI1 EQU   CVTVOLF1                                                 03317000
CVTSTOA  EQU   CVTMAP+376                                               03318000
CVTRSV58 EQU   CVTMAP+374                                               03319000
CVTRSV57 EQU   CVTMAP+372                                               03320000
CVTDDCE  EQU   CVTMAP+368                                               03321000
CVTPNWFR EQU   CVTMAP+364                                               03322000
CVTSMF   EQU   CVTMAP+360                                               03323000
CVTSULK  EQU   CVTMAP+358                                               03324000
CVTSLKO  EQU   CVTSYSK                                                  03325000
CVTSLKP  EQU   CVTSYSK                                                  03326000
CVTSLKQ  EQU   CVTSYSK                                                  03327000
CVTSLKR  EQU   CVTSYSK                                                  03328000
CVTRSV56 EQU   CVTSYSK                                                  03329000
CVTRSV55 EQU   CVTSYSK                                                  03330000
CVTRSV54 EQU   CVTSYSK                                                  03331000
CVTRSV53 EQU   CVTSYSK                                                  03332000
CVTRSV52 EQU   CVTA1F1                                                  03333000
CVTRSV51 EQU   CVTA1F1                                                  03334000
CVTRSV50 EQU   CVTA1F1                                                  03335000
CVTRSV49 EQU   CVTA1F1                                                  03336000
CVTRSV48 EQU   CVTA1F1                                                  03337000
CVTRSV47 EQU   CVTA1F1                                                  03338000
CVTSRSW  EQU   CVTA1F1                                                  03339000
CVTPFSW  EQU   CVTA1F1                                                  03340000
CVTPCVT  EQU   CVTMAP+352                                               03341000
CVTRSV46 EQU   CVTMAP+344                                               03342000
CVTRSV45 EQU   CVTMAP+340                                               03343000
CVTRSV44 EQU   CVTMAP+338                                               03344000
CVTRSV43 EQU   CVTMAP+336                                               03345000
CVTHJESA EQU   CVTHJES+1                                                03346000
CVTRSV42 EQU   CVTHJES                                                  03347000
CVTEXT2A EQU   CVTEXT2+1                                                03348000
CVTRSV41 EQU   CVTEXT2                                                  03349000
CVTAPFA  EQU   CVTAPF+1                                                 03350000
CVTRSV40 EQU   CVTAPF                                                   03351000
CVTRV518 EQU   CVTINTLA                                                 03352000
CVTRV517 EQU   CVTERPV                                                  03353000
CVTEORM  EQU   CVTMAP+312                                               03354000
CVTMCHPR EQU   CVTMAP+308                                               03355000
CVTTZ    EQU   CVTMAP+304                                               03356000
CVTJEPS  EQU   CVTMAP+300                                               03357000
CVTJESCT EQU   CVTMAP+296                                               03358000
CVTMODE  EQU   CVTMAP+292                                               03359000
CVTPTRV  EQU   CVTMAP+288                                               03360000
CVTREAL  EQU   CVTMAP+284                                               03361000
CVTRSV39 EQU   CVTMAP+280                                               03362000
CVTRSV38 EQU   CVTMAP+276                                               03363000
CVTDMSRA EQU   CVTDMSR+1                                                03364000
CVTRV634 EQU   CVTDMSRF                                                 03365000
CVTRV633 EQU   CVTDMSRF                                                 03366000
CVTRV632 EQU   CVTDMSRF                                                 03367000
CVTRV631 EQU   CVTDMSRF                                                 03368000
CVTRV630 EQU   CVTDMSRF                                                 03369000
CVTRV629 EQU   CVTDMSRF                                                 03370000
CVTUDUMP EQU   CVTDMSRF                                                 03371000
CVTSDUMP EQU   CVTDMSRF                                                 03372000
CVTQMSGA EQU   CVTQMSG+1                                                03373000
CVTRSV36 EQU   CVTQMSG                                                  03374000
CVTAMFF  EQU   CVTMAP+264                                               03375000
CVTPURGA EQU   CVTPURG+1                                                03376000
CVTRSV35 EQU   CVTPURG                                                  03377000
CVTCBSP  EQU   CVTMAP+256                                               03378000
CVTATERA EQU   CVTATER+1                                                03379000
CVTSYST  EQU   CVTATER                                                  03380000
CVTVOLT2 EQU   CVTTAT                                                   03381000
CVTVOLI2 EQU   CVTVOLF2                                                 03382000
CVTAQAVB EQU   CVTAQAVT+1                                               03383000
CVTRSV34 EQU   CVTTCMFG                                                 03384000
CVTRSV33 EQU   CVTTCMFG                                                 03385000
CVTRSV32 EQU   CVTTCMFG                                                 03386000
CVTRSV31 EQU   CVTTCMFG                                                 03387000
CVTRSV30 EQU   CVTTCMFG                                                 03388000
CVTRSV29 EQU   CVTTCMFG                                                 03389000
CVTRSV28 EQU   CVTTCMFG                                                 03390000
CVTTCRDY EQU   CVTTCMFG                                                 03391000
CVTGTFA  EQU   CVTGTF+1                                                 03392000
CVTRSV27 EQU   CVTGTFST                                                 03393000
CVTRNIO  EQU   CVTGTFST                                                 03394000
CVTUSR   EQU   CVTGTFST                                                 03395000
CVTRV318 EQU   CVTFORM                                                  03396000
CVTRV317 EQU   CVTTMODE                                                 03397000
CVTRV316 EQU   CVTSTATE                                                 03398000
CVTRV315 EQU   CVTGTFS                                                  03399000
CVTGTFAV EQU   CVTGTFS                                                  03400000
CVT0SCR1 EQU   CVTMAP+232                                               03401000
CVTRV515 EQU   CVTMAP+228                                               03402000
CVTRMS   EQU   CVTMAP+224                                               03403000
CVTPATCH EQU   CVTMAP+220                                               03404000
CVTTSCE  EQU   CVTMAP+216                                               03405000
CVTLNKSC EQU   CVTMAP+214                                               03406000
CVTQABST EQU   CVTMAP+212                                               03407000
CVTMDLDS EQU   CVTMAP+208                                               03408000
CVTUSER  EQU   CVTMAP+204                                               03409000
CVTABEND EQU   CVTMAP+200                                               03410000
CVTSMCA  EQU   CVTMAP+196                                               03411000
CVTRSV18 EQU   CVTMAP+192                                               03412000
CVTQLPAQ EQU   CVTMAP+188                                               03413000
CVTQCDSR EQU   CVTMAP+184                                               03414000
CVTRSV17 EQU   CVTOPTB                                                  03415000
CVTRSV16 EQU   CVTOPTB                                                  03416000
CVTFP    EQU   CVTOPTB                                                  03417000
CVTAPTHR EQU   CVTOPTB                                                  03418000
CVTNLOG  EQU   CVTOPTB                                                  03419000
CVTTOD   EQU   CVTOPTB                                                  03420000
CVTCTIMS EQU   CVTOPTB                                                  03421000
CVTPROT  EQU   CVTOPTB                                                  03422000
CVTXPFP  EQU   CVTOPTA                                                  03423000
CVTASCII EQU   CVTOPTA                                                  03424000
CVTRSV13 EQU   CVTOPTA                                                  03425000
CVTRSV12 EQU   CVTOPTA                                                  03426000
CVTNIP   EQU   CVTOPTA                                                  03427000
CVTDDR   EQU   CVTOPTA                                                  03428000
CVTAPR   EQU   CVTOPTA                                                  03429000
CVTCCH   EQU   CVTOPTA                                                  03430000
CVTSNCTR EQU   CVTMAP+180                                               03431000
CVTQMWR  EQU   CVTMAP+176                                               03432000
CVTQOCR  EQU   CVTMAP+172                                               03433000
CVT1EF00 EQU   CVTMAP+168                                               03434000
CVTMZ00  EQU   CVTMAP+164                                               03435000
CVTSV76Q EQU   CVTSV76C                                                 03436000
CVTRSV11 EQU   CVTMAP+156                                               03437000
CVT0PT01 EQU   CVTMAP+152                                               03438000
CVTMSER  EQU   CVTMAP+148                                               03439000
CVTRV516 EQU   CVTIERLC                                                 03440000
CVTILCH  EQU   CVTMAP+140                                               03441000
CVTFBOSV EQU   CVTMAP+132                                               03442000
CVTNUCB  EQU   CVTMAP+128                                               03443000
CVTIXAVL EQU   CVTMAP+124                                               03444000
CVTSV76M EQU   CVTIOQET                                                 03445000
CVTDCBA  EQU   CVTMAP+117                                               03446000
CVTMVS2  EQU   CVTDCB                                                   03447000
CVT6DAT  EQU   CVTDCB                                                   03448000
CVT4MPS  EQU   CVTDCB                                                   03449000
CVTRSV09 EQU   CVTDCB                                                   03450000
CVT4MS1  EQU   CVTDCB                                                   03451000
CVT2SPS  EQU   CVTDCB                                                   03452000
CVT1SSS  EQU   CVTDCB                                                   03453000
CVTRSV08 EQU   CVTDCB                                                   03454000
CVTSTB   EQU   CVTMAP+112                                               03455000
CVTQTD00 EQU   CVTMAP+108                                               03456000
CVTQTE00 EQU   CVTMAP+104                                               03457000
CVTCUCB  EQU   CVTMAP+100                                               03458000
CVTSJQ   EQU   CVTMAP+96                                                03459000
CVTPBLDL EQU   CVTMAP+92                                                03460000
CVTTPC   EQU   CVTMAP+88                                                03461000
CVTSVDCB EQU   CVTMAP+84                                                03462000
CVTBRET  EQU   CVTMAP+82                                                03463000
CVTEXIT  EQU   CVTMAP+80                                                03464000
CVT0FN00 EQU   CVTMAP+76                                                03465000
CVTDARA  EQU   CVTDAR+1                                                 03466000
CVTRSV07 EQU   CVTFLGS1                                                 03467000
CVTRSV06 EQU   CVTFLGS1                                                 03468000
CVTRSV05 EQU   CVTFLGS1                                                 03469000
CVTRSV04 EQU   CVTFLGS1                                                 03470000
CVTRSV03 EQU   CVTFLGS1                                                 03471000
CVTRSV02 EQU   CVTFLGS1                                                 03472000
CVTRSV01 EQU   CVTFLGS1                                                 03473000
CVTDMPLK EQU   CVTFLGS1                                                 03474000
CVTXITP  EQU   CVTMAP+68                                                03475000
CVTZDTAB EQU   CVTMAP+64                                                03476000
CVTMSLT  EQU   CVTMAP+60                                                03477000
CVTDATE  EQU   CVTMAP+56                                                03478000
CVTBTERM EQU   CVTMAP+52                                                03479000
CVTSYSAD EQU   CVTMAP+48                                                03480000
CVTXTLER EQU   CVTMAP+44                                                03481000
CVTILK2  EQU   CVTMAP+40                                                03482000
CVTILK1  EQU   CVTMAP+36                                                03483000
CVTPRLTV EQU   CVTMAP+32                                                03484000
CVTPCNVT EQU   CVTMAP+28                                                03485000
CVT0VL00 EQU   CVTMAP+24                                                03486000
CVTXAPG  EQU   CVTMAP+20                                                03487000
CVTBUF   EQU   CVTMAP+16                                                03488000
CVTJOB   EQU   CVTMAP+12                                                03489000
CVTLINK  EQU   CVTMAP+8                                                 03490000
CVT0EF00 EQU   CVTMAP+4                                                 03491000
CVTTCBP  EQU   CVTMAP                                                   03492000
CVT      EQU   CVTMAP                                                   03493000
CHSAVWD2 EQU   CHSHORT+100                                              03494000
CHSAVWD1 EQU   CHSHORT+96                                               03495000
CHJSCBVS EQU   CHSHORT+92                                               03496000
CHUSCVS  EQU   CHSHORT+88                                               03497000
@NM00003 EQU   CHSHORT+84                                               03498000
@NM00002 EQU   CHSHORT+80                                               03499000
CHSQA    EQU   CHSHORT+44                                               03500000
CHQPA    EQU   CHSHORT+8                                                03501000
CHJCL    EQU   CHSHORT+4                                                03502000
CHSPC    EQU   CHSHORT                                                  03503000
CHSPB    EQU   CHSTEP+4                                                 03504000
CHTCB    EQU   CHSTEP+1                                                 03505000
CHARSV23 EQU   CHSWT                                                    03506000
CHARSV22 EQU   CHSWT                                                    03507000
CHARSV21 EQU   CHSWT                                                    03508000
CHAC     EQU   CHSWT                                                    03509000
CHPSF    EQU   CHSWT                                                    03510000
CHPSD    EQU   CHSWT                                                    03511000
CHJCT    EQU   CHSWT                                                    03512000
CHARSV20 EQU   CHSWT                                                    03513000
CHCECB   EQU   CHASM+20                                                 03514000
CHECB    EQU   CHASM+16                                                 03515000
CHRGNAD  EQU   CHASM+12                                                 03516000
CHARSV18 EQU   CHRGNSZ+1                                                03517000
CHRPRTY  EQU   CHRGNSZ                                                  03518000
@NM00001 EQU   CHCIBP                                                   03519000
CHEND    EQU   CHCIBP                                                   03520000
CHDER    EQU   CHPROCSN+4                                               03521000
CHARSV10 EQU   CHACT1                                                   03522000
CHARSV09 EQU   CHACT1                                                   03523000
CHARSV08 EQU   CHACT1                                                   03524000
CHARSV07 EQU   CHACT1                                                   03525000
CHARSV06 EQU   CHACT1                                                   03526000
CHARSV05 EQU   CHACT1                                                   03527000
CHARSV04 EQU   CHACT1                                                   03528000
CHRDWTR  EQU   CHACT1                                                   03529000
CHARSV30 EQU   CHPROCSN+2                                               03530000
CHQID    EQU   CHPROCSN                                                 03531000
CHASID   EQU   CHTJID                                                   03532000
CHUCMP   EQU   CHAIN+29                                                 03533000
CHTRKID  EQU   CHPKE                                                    03534000
CHCIBCTR EQU   CHAIN+27                                                 03535000
CHUNIT   EQU   CHAIN+24                                                 03536000
CHCLS    EQU   CHAIN+16                                                 03537000
CHPCOI   EQU   CHPARM                                                   03538000
CHAFORCE EQU   CHIFY                                                    03539000
CHAIFX   EQU   CHACT                                                    03540000
CHCLD    EQU   CHACT                                                    03541000
CHCL     EQU   CHACT                                                    03542000
CHDSI    EQU   CHACT                                                    03543000
CHDISC   EQU   CHACT                                                    03544000
CHTERM   EQU   CHACT                                                    03545000
CHSWAP   EQU   CHACT                                                    03546000
CHABTERM EQU   CHSTS                                                    03547000
CHFC     EQU   CHSTS                                                    03548000
CHDL     EQU   CHSTS                                                    03549000
CHAD     EQU   CHSTS                                                    03550000
CHQSPC   EQU   CHSTS                                                    03551000
CHSOUT   EQU   CHSTS                                                    03552000
CHSYS    EQU   CHSTS                                                    03553000
CHAP     EQU   CHSTS                                                    03554000
CHSZE    EQU   CHFLG+1                                                  03555000
CHVCD    EQU   CHFLG                                                    03556000
CHPTR    EQU   CHAIN                                                    03557000
ASXBEND  EQU   ASXB+232                                                 03558000
ASXBRV25 EQU   ASXB+228                                                 03559000
ASXBRV24 EQU   ASXB+224                                                 03560000
ASXBPT0E EQU   ASXB+220                                                 03561000
ASXBCRB4 EQU   ASXBCASW+3                                               03562000
ASXBCRB3 EQU   ASXBCASW+2                                               03563000
ASXBCRB2 EQU   ASXBCASW+1                                               03564000
ASXBCR06 EQU   ASXBCRB1                                                 03565000
ASXBCR05 EQU   ASXBCRB1                                                 03566000
ASXBCR04 EQU   ASXBCRB1                                                 03567000
ASXBCR03 EQU   ASXBCRB1                                                 03568000
ASXBCR02 EQU   ASXBCRB1                                                 03569000
ASXBCR01 EQU   ASXBCRB1                                                 03570000
ASXBTFD  EQU   ASXBCRB1                                                 03571000
ASXBPIP  EQU   ASXBCRB1                                                 03572000
ASXBCTDC EQU   ASXB+212                                                 03573000
ASXBTDCB EQU   ASXB+208                                                 03574000
ASXBRV19 EQU   ASXB+204                                                 03575000
ASXBSENV EQU   ASXBSECR+1                                               03576000
ASXBRV34 EQU   ASCBSFLG                                                 03577000
ASXBRV33 EQU   ASCBSFLG                                                 03578000
ASXBRV32 EQU   ASCBSFLG                                                 03579000
ASXBRV31 EQU   ASCBSFLG                                                 03580000
ASXBRV30 EQU   ASCBSFLG                                                 03581000
ASXBRV29 EQU   ASCBSFLG                                                 03582000
ASXBRV28 EQU   ASCBSFLG                                                 03583000
ASXBRV27 EQU   ASCBSFLG                                                 03584000
ASXBUSER EQU   ASXB+192                                                 03585000
ASXBLSRB EQU   ASXBAEQ+20                                               03586000
ASXBFSRB EQU   ASXBAEQ+16                                               03587000
ASXBLRQE EQU   ASXBAEQ+12                                               03588000
ASXBFRQE EQU   ASXBAEQ+8                                                03589000
ASXBLIQE EQU   ASXBAEQ+4                                                03590000
ASXBFIQE EQU   ASXBAEQ                                                  03591000
ASXBETSK EQU   ASXB+164                                                 03592000
ASXBSIRB EQU   ASXB+160                                                 03593000
ASXBPSWD EQU   ASXB+152                                                 03594000
ASXBPRG  EQU   ASXB+136                                                 03595000
ASXBRV26 EQU   ASXB+132                                                 03596000
ASXBOUSB EQU   ASXB+128                                                 03597000
ASXBDDR  EQU   ASXB+124                                                 03598000
ASXBRCTD EQU   ASXB+120                                                 03599000
ASXBRSMD EQU   ASXB+116                                                 03600000
ASXBFRWA EQU   ASXB+108                                                 03601000
ASXBFLSA EQU   ASXB+36                                                  03602000
ASXBIHSA EQU   ASXB+32                                                  03603000
ASXBRV15 EQU   ASXB+28                                                  03604000
ASXBRV14 EQU   ASXB+24                                                  03605000
ASXBLWA  EQU   ASXB+20                                                  03606000
ASXBMPST EQU   ASXB+16                                                  03607000
ASXBRS00 EQU   ASXB+14                                                  03608000
ASXBTCBS EQU   ASXB+12                                                  03609000
ASXBLTCB EQU   ASXB+8                                                   03610000
ASXBFTCB EQU   ASXB+4                                                   03611000
ASXBASXB EQU   ASXB                                                     03612000
ASXBEGIN EQU   ASXB                                                     03613000
ASCBEND  EQU   ASCB+208                                                 03614000
ASCBSRBT EQU   ASCB+200                                                 03615000
ASCBSWTL EQU   ASCB+196                                                 03616000
ASCBRS14 EQU   ASCB+195                                                 03617000
ASCBSMCT EQU   ASCB+194                                                 03618000
ASCBRS12 EQU   ASCB+192                                                 03619000
ASCBPCTT EQU   ASCB+188                                                 03620000
ASCBVGTT EQU   ASCB+184                                                 03621000
ASCBLGCB EQU   ASCB+180                                                 03622000
ASCBJBNS EQU   ASCB+176                                                 03623000
ASCBJBNI EQU   ASCB+172                                                 03624000
ASCBMCC  EQU   ASCB+168                                                 03625000
ASCBRTWA EQU   ASCB+164                                                 03626000
ASCBIQEA EQU   ASCB+160                                                 03627000
ASCBXMPQ EQU   ASCB+156                                                 03628000
ASCBRS01 EQU   ASCB+154                                                 03629000
ASCBFMCT EQU   ASCB+152                                                 03630000
ASCBOUXB EQU   ASCB+148                                                 03631000
ASCBOUCB EQU   ASCB+144                                                 03632000
ASCBMECB EQU   ASCB+140                                                 03633000
ASCBQECB EQU   ASCB+136                                                 03634000
ASCBCMSB EQU   ASCB+132                                                 03635000
ASCBCMSF EQU   ASCB+128                                                 03636000
ASCBNVSC EQU   ASCB+122                                                 03637000
ASCBVSC  EQU   ASCB+120                                                 03638000
ASCBSRBS EQU   ASCB+118                                                 03639000
ASCBSSRB EQU   ASCB+116                                                 03640000
ASCBRV06 EQU   ASCBFLG2                                                 03641000
ASCBRV05 EQU   ASCBFLG2                                                 03642000
ASCBRV04 EQU   ASCBFLG2                                                 03643000
ASCBSNQS EQU   ASCBFLG2                                                 03644000
ASCBS2S  EQU   ASCBFLG2                                                 03645000
ASCBCEXT EQU   ASCBFLG2                                                 03646000
ASCBPXMT EQU   ASCBFLG2                                                 03647000
ASCBXMPT EQU   ASCBFLG2                                                 03648000
ASCBRF07 EQU   ASCBDSP1                                                 03649000
ASCBRF06 EQU   ASCBDSP1                                                 03650000
ASCBRF05 EQU   ASCBDSP1                                                 03651000
ASCBRF04 EQU   ASCBDSP1                                                 03652000
ASCBRF03 EQU   ASCBDSP1                                                 03653000
ASCBRF02 EQU   ASCBDSP1                                                 03654000
ASCBFAIL EQU   ASCBDSP1                                                 03655000
ASCBNOQ  EQU   ASCBDSP1                                                 03656000
ASCBTMCH EQU   ASCB+104                                                 03657000
ASCBNSWP EQU   ASCBFLG1                                                 03658000
ASCBTYP1 EQU   ASCBFLG1                                                 03659000
ASCBSTND EQU   ASCBFLG1                                                 03660000
ASCBABNT EQU   ASCBFLG1                                                 03661000
ASCBTERM EQU   ASCBFLG1                                                 03662000
ASCBS3S  EQU   ASCBFLG1                                                 03663000
ASCBCMSH EQU   ASCBFLG1                                                 03664000
ASCBTOFF EQU   ASCBFLG1                                                 03665000
ASCBRF01 EQU   ASCBRCTF                                                 03666000
ASCBTMLW EQU   ASCBRCTF                                                 03667000
ASCBOUT  EQU   ASCBRCTF                                                 03668000
ASCBWAIT EQU   ASCBRCTF                                                 03669000
ASCBRV08 EQU   ASCBRCTF                                                 03670000
ASCBFQU  EQU   ASCBRCTF                                                 03671000
ASCBFRS  EQU   ASCBRCTF                                                 03672000
ASCBTMNO EQU   ASCBRCTF                                                 03673000
ASCBAFFN EQU   ASCBFW1                                                  03674000
ASCBDUMP EQU   ASCB+96                                                  03675000
ASCBQSVC EQU   ASCB+92                                                  03676000
ASCBUBET EQU   ASCB+88                                                  03677000
ASCBECB  EQU   ASCB+84                                                  03678000
ASCBJSTL EQU   ASCB+80                                                  03679000
ASCBEWST EQU   ASCB+72                                                  03680000
ASCBEJST EQU   ASCB+64                                                  03681000
ASCBTSB  EQU   ASCB+60                                                  03682000
ASCBCSCB EQU   ASCB+56                                                  03683000
ASCBRSM  EQU   ASCB+52                                                  03684000
ASCBLDA  EQU   ASCB+48                                                  03685000
ASCBSTOR EQU   ASCB+44                                                  03686000
ASCBDP   EQU   ASCB+43                                                  03687000
ASCBRV07 EQU   ASCB+42                                                  03688000
ASCBIOSM EQU   ASCB+40                                                  03689000
ASCBSEQN EQU   ASCB+38                                                  03690000
ASCBASID EQU   ASCB+36                                                  03691000
ASCBCPUS EQU   ASCB+32                                                  03692000
ASCBSPL  EQU   ASCB+28                                                  03693000
ASCBLSLQ EQU   ASCB+24                                                  03694000
ASCBFSLQ EQU   ASCB+20                                                  03695000
ASCBIOSP EQU   ASCB+16                                                  03696000
ASCBLOCK EQU   ASCB+12                                                  03697000
ASCBBWDP EQU   ASCB+8                                                   03698000
ASCBFWDP EQU   ASCB+4                                                   03699000
ASCBASCB EQU   ASCB                                                     03700000
ASCBEGIN EQU   ASCB                                                     03701000
@NM00039 EQU   PSA+3668                                                 03702000
PSASTAK  EQU   PSA+3072                                                 03703000
@NM00038 EQU   PSA+1048                                                 03704000
PSAUSEND EQU   PSA+1048                                                 03705000
PSARV062 EQU   PSA+1044                                                 03706000
PSACDAL  EQU   PSA+1040                                                 03707000
PSAWTCOD EQU   PSA+1036                                                 03708000
PSAATCVT EQU   PSA+1032                                                 03709000
PSAPCPSW EQU   PSA+1024                                                 03710000
PSAPIR2  EQU   PSA+1020                                                 03711000
PSARV059 EQU   PSA+1018                                                 03712000
PSASVC13 EQU   PSA+1016                                                 03713000
PSALSFCC EQU   PSA+1012                                                 03714000
PSASFACC EQU   PSA+1008                                                 03715000
PSASTOP  EQU   PSA+992                                                  03716000
PSASTART EQU   PSA+976                                                  03717000
PSARSPSW EQU   PSA+968                                                  03718000
PSASRPSW EQU   PSA+960                                                  03719000
PSARV045 EQU   PSA+892                                                  03720000
PSARV044 EQU   PSA+888                                                  03721000
PSARV043 EQU   PSA+884                                                  03722000
PSARV042 EQU   PSA+880                                                  03723000
PSARV041 EQU   PSA+876                                                  03724000
PSARV040 EQU   PSA+872                                                  03725000
PSARV025 EQU   PSA+868                                                  03726000
PSADSSED EQU   PSA+868                                                  03727000
PSADSSPR EQU   PSA+864                                                  03728000
PSADSSFW EQU   PSA+860                                                  03729000
PSADSS14 EQU   PSA+856                                                  03730000
PSADSSPP EQU   PSA+848                                                  03731000
PSADSSRP EQU   PSA+840                                                  03732000
PSADSS05 EQU   PSADSSF4                                                 03733000
PSADSS10 EQU   PSADSSF4                                                 03734000
PSADSSVE EQU   PSADSSF4                                                 03735000
PSADSSDE EQU   PSADSSF4                                                 03736000
PSADSSC0 EQU   PSADSSF4                                                 03737000
PSADSSIE EQU   PSADSSF4                                                 03738000
PSADSS12 EQU   PSADSSF4                                                 03739000
PSADSSRC EQU   PSADSSF4                                                 03740000
PSARV057 EQU   PSADSSF3                                                 03741000
PSARV056 EQU   PSADSSF3                                                 03742000
PSARV055 EQU   PSADSSF3                                                 03743000
PSADSSMC EQU   PSADSSF3                                                 03744000
PSADSSRW EQU   PSADSSF3                                                 03745000
PSADSSNM EQU   PSADSSF3                                                 03746000
PSADSSES EQU   PSADSSF3                                                 03747000
PSADSSGP EQU   PSADSSF3                                                 03748000
PSADSSF2 EQU   PSADSSFL+1                                               03749000
PSADSSPI EQU   PSADSSF1                                                 03750000
PSADSSOI EQU   PSADSSF1                                                 03751000
PSADSSSP EQU   PSADSSF1                                                 03752000
PSADSSTP EQU   PSADSSF1                                                 03753000
PSADSSDW EQU   PSADSSF1                                                 03754000
PSADSSDD EQU   PSADSSF1                                                 03755000
PSADSSDM EQU   PSADSSF1                                                 03756000
PSADSSMV EQU   PSADSSF1                                                 03757000
PSADSSTS EQU   PSA+816                                                  03758000
PSADSSWK EQU   PSA+812                                                  03759000
PSADSSR3 EQU   PSA+808                                                  03760000
PSADSSR2 EQU   PSA+804                                                  03761000
PSADSSRS EQU   PSA+800                                                  03762000
PSASTOR  EQU   PSA+796                                                  03763000
PSACPUSA EQU   PSA+794                                                  03764000
PSAVSTAP EQU   PSA+792                                                  03765000
PSAWKVAP EQU   PSA+788                                                  03766000
PSAWKRAP EQU   PSA+784                                                  03767000
PSAMCHIC EQU   PSA+783                                                  03768000
PSARV061 EQU   PSA+782                                                  03769000
PSASYMSK EQU   PSA+781                                                  03770000
PSAMCHFL EQU   PSA+780                                                  03771000
PSACR0   EQU   PSA+776                                                  03772000
PSAPSWSV EQU   PSA+768                                                  03773000
PSALITA  EQU   PSA+764                                                  03774000
PSACLHS  EQU   PSAHLHI                                                  03775000
PSALKR15 EQU   PSALKSA+60                                               03776000
PSALKR14 EQU   PSALKSA+56                                               03777000
PSALKR13 EQU   PSALKSA+52                                               03778000
PSALKR12 EQU   PSALKSA+48                                               03779000
PSALKR11 EQU   PSALKSA+44                                               03780000
PSALKR10 EQU   PSALKSA+40                                               03781000
PSALKR9  EQU   PSALKSA+36                                               03782000
PSALKR8  EQU   PSALKSA+32                                               03783000
PSALKR7  EQU   PSALKSA+28                                               03784000
PSALKR6  EQU   PSALKSA+24                                               03785000
PSALKR5  EQU   PSALKSA+20                                               03786000
PSALKR4  EQU   PSALKSA+16                                               03787000
PSALKR3  EQU   PSALKSA+12                                               03788000
PSALKR2  EQU   PSALKSA+8                                                03789000
PSALKR1  EQU   PSALKSA+4                                                03790000
PSALKR0  EQU   PSALKSA                                                  03791000
PSARV023 EQU   PSACLHT+52                                               03792000
PSALOCAL EQU   PSACLHT+48                                               03793000
PSACMSL  EQU   PSACLHT+44                                               03794000
PSAOPTL  EQU   PSACLHT+40                                               03795000
PSATPACL EQU   PSACLHT+36                                               03796000
PSATPDNL EQU   PSACLHT+32                                               03797000
PSATPNCL EQU   PSACLHT+28                                               03798000
PSAIOSLL EQU   PSACLHT+24                                               03799000
PSAIOSUL EQU   PSACLHT+20                                               03800000
PSAIOSCL EQU   PSACLHT+16                                               03801000
PSAIOSSL EQU   PSACLHT+12                                               03802000
PSASALCL EQU   PSACLHT+8                                                03803000
PSAASML  EQU   PSACLHT+4                                                03804000
PSADISPL EQU   PSACLHT                                                  03805000
PSASRSA  EQU   PSA+636                                                  03806000
PSARV050 EQU   PSA+634                                                  03807000
PSADSSGO EQU   PSA+633                                                  03808000
PSARECUR EQU   PSA+632                                                  03809000
PSAHLHIS EQU   PSA+628                                                  03810000
PSAIPCSA EQU   PSA+624                                                  03811000
@NM00037 EQU   PSA+621                                                  03812000
PSAIPCDM EQU   PSA+620                                                  03813000
PSAIPCD  EQU   PSA+616                                                  03814000
@NM00036 EQU   PSA+613                                                  03815000
PSAIPCRM EQU   PSA+612                                                  03816000
PSAIPCR  EQU   PSA+608                                                  03817000
PSAMCHEX EQU   PSA+600                                                  03818000
PSAMPSW  EQU   PSA+592                                                  03819000
PSAEXPS2 EQU   PSA+584                                                  03820000
PSAEXPS1 EQU   PSA+576                                                  03821000
PSAPIREG EQU   PSA+572                                                  03822000
PSARSREG EQU   PSA+568                                                  03823000
PSAGPREG EQU   PSA+556                                                  03824000
PSARV022 EQU   PSASUP4                                                  03825000
PSARV021 EQU   PSASUP4                                                  03826000
PSARV020 EQU   PSASUP4                                                  03827000
PSARV019 EQU   PSASUP4                                                  03828000
PSARV018 EQU   PSASUP4                                                  03829000
PSARV017 EQU   PSASUP4                                                  03830000
PSARV016 EQU   PSASUP4                                                  03831000
PSARV015 EQU   PSASUP4                                                  03832000
PSARV014 EQU   PSASUP3                                                  03833000
PSAULCMS EQU   PSASUP3                                                  03834000
PSARV012 EQU   PSASUP3                                                  03835000
PSAESTA  EQU   PSASUP3                                                  03836000
PSASPR   EQU   PSASUP3                                                  03837000
PSAPSREG EQU   PSASUP3                                                  03838000
PSAPI2   EQU   PSASUP3                                                  03839000
PSAIOSUP EQU   PSASUP3                                                  03840000
PSALCR   EQU   PSASUP2                                                  03841000
PSARTM   EQU   PSASUP2                                                  03842000
PSAACR   EQU   PSASUP2                                                  03843000
PSAIPCE2 EQU   PSASUP2                                                  03844000
PSAIPCES EQU   PSASUP2                                                  03845000
PSAIPCEC EQU   PSASUP2                                                  03846000
PSAGTF   EQU   PSASUP2                                                  03847000
PSAIPCRI EQU   PSASUP2                                                  03848000
PSATYPE6 EQU   PSASUP1                                                  03849000
PSATCTL  EQU   PSASUP1                                                  03850000
PSADISP  EQU   PSASUP1                                                  03851000
PSALOCK  EQU   PSASUP1                                                  03852000
PSAPI    EQU   PSASUP1                                                  03853000
PSAEXT   EQU   PSASUP1                                                  03854000
PSASVC   EQU   PSASUP1                                                  03855000
PSAIO    EQU   PSASUP1                                                  03856000
PSAANEW  EQU   PSA+544                                                  03857000
PSATNEW  EQU   PSA+536                                                  03858000
PSALCCAR EQU   PSA+532                                                  03859000
PSALCCAV EQU   PSA+528                                                  03860000
PSAPCCAR EQU   PSA+524                                                  03861000
PSAPCCAV EQU   PSA+520                                                  03862000
PSACPULA EQU   PSA+518                                                  03863000
PSACPUPA EQU   PSA+516                                                  03864000
PSAPSA   EQU   PSA+512                                                  03865000
FLCHDEND EQU   PSA+512                                                  03866000
FLCCRSAV EQU   FLCMCLA+280                                              03867000
FLCGRSAV EQU   FLCMCLA+216                                              03868000
FLCFPSAV EQU   FLCMCLA+184                                              03869000
FLCFLA   EQU   FLCMCLA+88                                               03870000
FLCRGNCD EQU   FLCMCLA+84                                               03871000
FLCFSAA  EQU   FLCFSA+1                                                 03872000
@NM00035 EQU   FLCFSA                                                   03873000
@NM00034 EQU   FLCMCLA+72                                               03874000
FLCMCIC  EQU   FLCMCLA+64                                               03875000
@NM00033 EQU   FLCMCLA+20                                               03876000
FLCIOAA  EQU   FLCIOA+1                                                 03877000
@NM00032 EQU   FLCIOA                                                   03878000
@NM00031 EQU   FLCMCLA+15                                               03879000
@NM00030 EQU   FLCMCLA+14                                               03880000
@NM00029 EQU   FLCMCLA+12                                               03881000
FLCLCL   EQU   FLCMCLA+8                                                03882000
FLCIOELA EQU   FLCIOEL+1                                                03883000
@NM00028 EQU   FLCIOEL                                                  03884000
FLCCHNID EQU   FLCMCLA                                                  03885000
@NM00027 EQU   PSA+160                                                  03886000
FLCMTRCD EQU   PSA+157                                                  03887000
@NM00026 EQU   PSA+156                                                  03888000
FLCPERA  EQU   FLCPER+1                                                 03889000
@NM00025 EQU   FLCPER                                                   03890000
@NM00024 EQU   PSA+151                                                  03891000
FLCPERCD EQU   PSA+150                                                  03892000
FLCMCNUM EQU   PSA+149                                                  03893000
@NM00023 EQU   PSA+148                                                  03894000
FLCTEAA  EQU   FLCTEA+1                                                 03895000
@NM00022 EQU   FLCTEA                                                   03896000
PSAPIPC  EQU   PSAPICOD                                                 03897000
PSAPIMC  EQU   PSAPICOD                                                 03898000
PSAPIPER EQU   PSAPICOD                                                 03899000
PSARV049 EQU   FLCPICOD                                                 03900000
FLCPILCB EQU   FLCPIILC                                                 03901000
@NM00021 EQU   FLCPIILC                                                 03902000
@NM00020 EQU   PSAEPPSW                                                 03903000
FLCSVCN  EQU   PSAESPSW+2                                               03904000
FLCSILCB EQU   FLCSVILC                                                 03905000
@NM00019 EQU   FLCSVILC                                                 03906000
@NM00018 EQU   PSAESPSW                                                 03907000
FLCEICOD EQU   PSAEEPSW+2                                               03908000
PSASPAD  EQU   PSAEEPSW                                                 03909000
@NM00017 EQU   PSA+128                                                  03910000
FLCINPSW EQU   PSA+120                                                  03911000
FLCMNPSW EQU   PSA+112                                                  03912000
FLCPNPSW EQU   PSA+104                                                  03913000
FLCSNPSW EQU   PSA+96                                                   03914000
FLCENPSW EQU   PSA+88                                                   03915000
FLCTRACE EQU   PSA+84                                                   03916000
FLCTIMER EQU   PSA+80                                                   03917000
FLCCVT2  EQU   PSA+76                                                   03918000
FLCCAW   EQU   PSA+72                                                   03919000
FLCCSW   EQU   PSA+64                                                   03920000
FLCIOPSW EQU   PSA+56                                                   03921000
FLCMOPSW EQU   PSA+48                                                   03922000
FLCPOPSW EQU   PSA+40                                                   03923000
FLCSOPSW EQU   PSA+32                                                   03924000
FLCEOPSW EQU   PSA+24                                                   03925000
@NM00016 EQU   FLCICCW2+4                                               03926000
FLCCVT   EQU   FLCICCW2                                                 03927000
FLCICCW1 EQU   FLCROPSW                                                 03928000
FLCIPPSW EQU   FLCRNPSW                                                 03929000
*                                      END UNREFERENCED COMPONENTS      03930000
@RT00166 EQU   CKWAIT                                                   03931000
TABLEOK  EQU   @EL00004                                                 03932000
@RF00172 EQU   @EL00004                                                 03933000
@RF00191 EQU   @EL00005                                                 03934000
@RF00193 EQU   @EL00005                                                 03935000
@RC00195 EQU   @EL00005                                                 03936000
@RC00227 EQU   @EL00006                                                 03937000
@RC00284 EQU   @EL00007                                                 03938000
@ENDDATA EQU   *                                                        03939000
         END   IEAVEVT0,(C'PLS1353',0701,78128)                         03940000
./  ADD  SSI=33241015,NAME=IEAVMODE
         TITLE 'IEAVMODE - MODESET SERVICE ROUTINE'                     00051002
IEAVMODE START                                                          00052002
* /* START OF SPECIFICATIONS ****                                       00053002
*                                                                       00056002
*01*  MODULE-NAME = IEAVMODE                                            00059002
*                                                                       00062002
*02*     CSECT-NAME = IEAVMODE                                          00065002
*                                                                       00068002
*01*  DESCRIPTIVE-NAME = MODESET SERVICE ROUTINE                        00071002
*                                                                       00074002
*01*  COPYRIGHT = NONE                                                  00077002
*                                                                       00080002
*01*  STATUS = 0                                                        00083002
*                                                                       00086002
*01*  FUNCTION = ANY OF THE FOLLOWING:                                  00089002
*                    1. CHANGE THE KEY IN THE RB OLD PSW TO ZERO        00092002
*                       OR THE KEY VALUE IN THE CURRENT TCB.            00095002
*                    2. CHANGE THE STATE IN THE RB OLD PSW TO           00100002
*                       PROBLEM OR SUPERVISOR.                          00102002
*                                                                       00104002
*02*     OPERATION = SEE METHOD OF OPERATION DIAGRAM.                   00106002
*                                                                       00108002
*01*  NOTES                                                             00110002
*                                                                       00112002
*02*     DEPENDENCIES = THIS MODULE DOES NOT CONTAIN                    00114002
*                       HARDWARE DEPENDENCIES.  MODULE RECEIVES         00116002
*                       CONTROL WITH LOCAL LOCK HELD.                   00117002
*                                                                       00118002
*03*        CHARACTER-CODE-DEPENDENCIES = THIS MODULE IS NOT            00120002
*                                         CHARACTER CODE                00122002
*                                         DEPENDENT.                    00124002
*                                                                       00126002
*02*     RESTRICTIONS = NONE                                            00128002
*                                                                       00130002
*02*     REGISTER-CONVENTIONS = REFER TO 'REGISTER EQUATES'             00132002
*                               PORTION OF THIS MODULE.                 00150002
*                                                                       00152002
*02*     PATCH-LABEL = NONE WITHIN THIS MODULE. THE COMMON              00154002
*                      NUCLEUS MAINTENANCE AREA SHOULD BE               00156002
*                      USED (IEAPATCH).                                 00158002
*                                                                       00160002
*01*  MODULE-TYPE = MODULE                                              00162002
*                                                                       00164002
*02*     PROCESSOR = ASSEMBLER                                          00166002
*                                                                       00168002
*02*     MODULE-SIZE = APPROXIMATELY 200 BYTES.                         00170002
*                                                                       00172002
*02*     ATTRIBUTES = RESIDENT, REFRESHABLE, KEY ZERO,                  00174002
*                     SUPERVISOR MODE, ENABLE,                          00176002
*                     LOCALLY LOCKED, TYPE 1 SVC                        00178002
*                                                                       00180002
*01*  ENTRY-POINT = IGC107                                              00182002
*                                                                       00184002
*02*     LINKAGE = VIA SVC INTERRUPT HANDLER (TYPE 1 SVC)               00186002
*                                                                       00188002
*02*     INPUT = REGISTER                                               00190002
*                  0 - IRRELEVANT                                       00192002
*                  1 - PARAMETER LIST                                   00194002
*                  2 - IRRELEVANT                                       00196002
*                  3 - ADDRESS OF CVT (NOT USED)                        00200002
*                  4 - ADDRESS OF CURRENT TCB                           00203002
*                  5 - ADDRESS OF CURRENT RB                            00206002
*                  6 - ENTRY POINT ADDRESS                              00209002
*                  7 - ADDRESS OF CURRENT ASCB                          00212002
*                  8-13 - IRRELEVANT                                    00215002
*                 14 - RETURN ADDRESS                                   00218002
*                 15 - IRRELEVANT                                       00221002
*                                                                       00224002
*                PARAMETER LIST (CONTENTS OF REGISTER 1)                00227002
*                  BITS 0-25 = RESERVED (MUST BE ZERO)                  00230002
*                  BITS 26-27 = 00 - NO ACTION                          00233002
*                               01 - INVALID                            00236002
*                               10 - PLACE TCB KEY IN RBOPSW            00250002
*                               11 - SET RBOPSW KEY TO ZERO             00251002
*                  BITS 28-29 = 00 - NO ACTION                          00252002
*                               01 - TURN ON STATE BIT (PROB) IN        00253002
*                                    RBOPSW                             00254002
*                               10 - INVALID                            00255002
*                               11 - TURN OFF STATE BIT (SUPR) IN       00256002
*                                    RBOPSW                             00257002
*                  BITS 30-31 = RESERVED (MUST BE ZERO)                 00258002
*                                                                       00259002
*02*     OUTPUT = REFER TO OUTPUT OF EXIT-NORMAL AND                    00260002
*                 EXIT-ERROR                                            00261002
*                                                                       00262002
*02*     REGISTER-SAVED = NONE (SAVED BY SVC INTERRUPT HANDLER)         00263002
*                                                                       00264002
*02*     REGISTER-USAGE = REFER TO 'REGISTER EQUATES'                   00265002
*                         PORTION OF THIS MODULE.                       00266002
*                                                                       00267002
*02*     REGISTERS-RESTORED = NONE (RESTORED AT EXIT TIME)              00268002
*                                                                       00269002
*01*  EXIT-NORMAL = DONE (MAINLINE EXIT)                                00270002
*                                                                       00271002
*02*     CONDITIONS = FUNCTION COMPLETE, RETURN TO CALLER               00272002
*                     VIA BRANCHING TO ADDRESS CONTAINED                00273002
*                     IN REGISTER 14 AT ENTRY                           00274002
*                                                                       00275002
*02*     OUTPUT = REGISTERS                                             00276002
*                   0-1 - UNPREDICTABLE                                 00277002
*                   2-13 - SAME AS ENTRY                                00278002
*                          (RESTORED WHEN REDISPATCHED)                 00279002
*                   14 - UNPREDICTABLE                                  00280002
*                   15 - ZERO (SUCCESSFUL INDICATION                    00281002
*                              FOR COMPATABILITY)                       00282002
*                 DATA                                                  00283002
*                                                                       00284002
*                    RBOPSW - KEY AND STATE MODIFIED AS REQUESTED       00284502
*02*     RETURN-CODES = NONE                                            00285002
*                                                                       00286002
*01*  EXIT-ERROR = ERRTN                                                00287002
*                                                                       00288002
*02*     CONDITIONS = ABEND CALLER, INVALID INPUT DETECTED.             00289002
*                                                                       00300002
*02*     OUTPUT = REGISTERS                                             00301002
*                   0 - ABEND FLAGS                                     00302002
*                   1 - ABEND CODE                                      00303002
*                   2 - INPUT PARAMETER LIST                            00304002
*                   3-15 - IRRELEVANT                                   00305002
*                                                                       00306002
*                                                                       00307002
*02*     RETURN-CODES = NONE                                            00308002
*                                                                       00309002
*01*  EXTERNAL-REFERENCES                                               00310002
*                                                                       00311002
*02*     ROUTINES = ABEND                                               00312002
*                                                                       00313002
*02*     DATA-AREAS = LOCAL WORK/SAVE AREA - SERIALIZED VIA             00314002
*                                            LOCAL LOCK                 00315002
*                                                                       00316002
*02*     CONTROL-BLOCKS = ASCB   R                                      00317002
*                         ASXB   R                                      00318002
*                         RB     R,W                                    00319002
*                         TCB    R                                      00320002
*                         WSAVT  R                                      00321002
*                                                                       00322002
*01*  TABLES = LOCAL SAVE AREA - SEE DSECT (STORAGE)                    00323002
*              COMMENTARY FOR DESCRIPTION                               00324002
*                                                                       00325002
*01*  MACROS = ABEND                                                    00326002
*              MODID                                                    00327002
*                                                                       00328002
*02*     SERIALIZATION = RESOURCES ENQUEUED - NONE                      00329002
*                        LOCKS - LOCAL LOCK HELD WHEN ENTERED AND       00330002
*                                NEVER RELEASED                         00331002
*                                                                       00332002
*01*  CHANGE-ACTIVITY = THIS MODULE HAS BEEN COMPLETELY                 00350002
*                       REWRITTEN FOR VS2 RELEASE 2 (AS THE             00352002
*                       RESULT OF PTM #VS04244), WHICH ELIMINATED       00354002
*                       MOST OF THE PREVIOUS MODESET FUNCTION.          00356002
*                                                                       00358002
*01*  MESSAGES = NONE                                                   00360002
*                                                                       00362002
*01*  ABEND-CODES = 16B - INVALID INPUT PARAMETERS                      00364002
*                                                                       00366002
**** END OF SPECIFICATIONS ***/                                         00368002
* A-000000-999999                                              @YM04244 00370002
         EJECT                                                          00372002
         ENTRY IGC107                                                   00376002
IGC107   EQU   IEAVMODE         ENTRY NAME                              00378002
         BALR  R6BASE,R0        ESTABLISH BASE REGISTER                 00380002
         USING *,R6BASE         DITTO                                   00382002
         USING TCB,R4TCB        ESTABLISH TCB ADDRESSABILITY            00384002
         USING RBBASIC,R5RB     ESTABLISH RB ADDRESSABILITY             00400002
         USING ASCB,R7ASCB      ESTABLISH ASCB ADDRESSABILITY           00450002
         MODID                  IDENTIFY MODULE                         00550002
         LTR   R2PLIST,R1PLIST  Q. NULL PARAMETER LIST                  00600002
         BZ    ERRTN            A. YES. INVALID INPUT                   00650002
         SPACE 2                                                        00670002
         L     R8WK,RSVDBITS    PREPARE TO TEST RESERVED BITS           00700002
         NR    R8WK,R1PLIST     Q. RESERVED BITS SPECIFIED              00750002
         BNZ   ERRTN            A. YES. INVALID INPUT                   00800002
INPUTOK  EQU   *                LOCATE WORK AREA                        00850002
         L     R8WK,ASCBASXB     ADDRESS ASXB                           00900002
         L     R8WK,ASXBSPSA-ASXB(R8WK) ADDRESS WSA VECTOR TABLE        00950002
         L     R3SAVE,WSALCWSA-WSAL(R8WK) ADDRESS LOCAL WORK/SAVE AREA  01000002
         USING STORAGE,R3SAVE   WORK AREA ADDRESSABILITY                01050002
         IC    R8WK,RBOPSW+ONE  GET PSW KEY AND MODE DATA               01100002
         ST    R1PLIST,PARMLIST SAVE INPUT PARAMETER LIST               01150002
         STC   R8WK,WORKBYTE    SAVE PSW KEY AND MODE DATA              01200002
         SPACE 2                                                        01220002
         TM    KEYNMODE,MODEFLGS Q. MODE CHANGE REQUESTED               01250002
         BZ    CHECKKEY         A. NO. SKIP IT                          01300002
         BO    SMODE            A. YES AND SUPR MODE REQUESTED          01350002
         TM    KEYNMODE,MODEBAD Q. INVALID MODE REQUEST                 01400002
         BO    ERRTN            A. YES. INVALID INPUT                   01450002
PMODE    EQU   *                A. NO. VALID PROBLEM MODE REQUEST       01500002
         OI    WORKBYTE,PROBMODE CHANGE TO PROBLEM MODE                 01550002
         B     CHECKKEY          MODE PROCESSING COMPLETE               01600002
SMODE    EQU   *                SUPERVISOR MODE REQUESTED               01650002
         NI    WORKBYTE,SUPRMODE CHANGE TO SUPERVISOR MODE              01700002
         SPACE 2                                                        01720002
CHECKKEY EQU   *                KEY PROCESSING                          01750002
         TM    KEYNMODE,KEYFLGS Q. KEY CHANGE REQUESTED                 01800002
         BZ    DONE             A. NO. SKIP IT.                         01850002
         BO    ZEROKEY          A. YES AND ZERO KEY REQUESTED           01900002
         TM    KEYNMODE,KEYBAD  Q. INVALID KEY REQUEST                  01950002
         BO    ERRTN            A. YES. INVALID INPUT                   01970002
NZEROKEY EQU   *                A. NO. VALID TCB KEY REQUEST            02000002
         MVI   TEMPKEY,CLRBITS  ONLY KEY BITS OF TCB BYTE WANTED        02050002
         NC    TEMPKEY,TCBPKF   ONLY KEY BITS WILL BE ON                02100002
         NI    WORKBYTE,CLEARKEY ZERO CURRENT KEY BITS                  02150002
         OC    WORKBYTE(ONE),TEMPKEY  TURN ON TCB KEY BITS              02200002
         B     DONE             THAT'S ALL FOLKS                        02250002
ZEROKEY  EQU   *                ZERO KEY REQUESTED                      02300002
         NI    WORKBYTE,CLEARKEY ZERO KEY BITS                          02350002
         SPACE 2                                                        02370002
DONE     EQU   *                NORMAL EXIT                             02400002
         IC    R8WK,WORKBYTE    GET NEW PSW KEY AND MODE DATA           02450002
         STC   R8WK,RBOPSW+ONE  PUT NEW KEY AND MODE DATA INTO         X02500002
                                RB OLD PSW                              02550002
         SR    R15RC,R15RC      SUCCESSFUL INDICATOR - COMPATABILITY    02570002
         BR    R14RTURN         RETURN                                  02600002
         SPACE 3                                                        02650002
ERRTN    EQU   *                INVALID INPUT - ABEND                   02700002
         ABEND X'16B',DUMP,,SYSTEM  DUMP IT                             02750002
         EJECT                                                          02800002
* REGISTER EQUATES                                                      02850002
R0       EQU   0                   USED FOR ESTABLISHING ADDRESSABILITY 02900002
R1PLIST  EQU   1                   CONTAINS INPUT PARAMETER LIST        02950002
R2PLIST  EQU   2                   COPY OF INPUT PARAMETER LIST         03000002
R3SAVE   EQU   3                   POINTS TO LOCAL MODESET WORK AREA    03050002
R4TCB    EQU   4                   POINTS TO CURRENT TCB                03194402
R5RB     EQU   5                   POINTS TO CURRENT RB                 03203802
R6BASE   EQU   6                   BASE (ENTRY POINT ADDRESS)           03250802
R7ASCB   EQU   7                   POINTS TO CURRENT ASCB               03309602
R8WK     EQU   8                   WORK REGISTER                        03369602
R14RTURN EQU   14                  RETURN ADDRESS                       03419602
R15RC    EQU   15                  CONTAINS SUCCESSFUL RETURN CODE      03439602
         SPACE 2                                                        03459602
* CONSTANTS                                                             03509602
         DS    0F                  INSURE FULL WORK BOUNDARY            03551602
RSVDBITS DC    X'FFFFFFC3'         RESERVED BITS OF PARAMETER LIST      03619602
ONE      EQU   1                   CONSTANT OF 1                        03659602
         SPACE 2                                                        03709602
* MASKS                                                                 03759602
MODEFLGS EQU   X'0C'               MODE FLAGS                           03819602
KEYFLGS  EQU   X'30'               KEY FLAGS                            03869602
PROBMODE EQU   X'01'               SET PROBLEM MODE                     03919602
SUPRMODE EQU   X'FE'               SET SUPERVISOR MODE                  03959602
CLRBITS  EQU   X'F0'               ZERO NON-KEY BITS                    03979602
CLEARKEY EQU   X'0F'               CLEARS KEY BITS                      04018002
KEYBAD   EQU   X'10'               DETERMINE VALIDITY OF KEY REQUEST    04068002
MODEBAD  EQU   X'08'               DETERMINE VALIDITY OF MODE REQUEST   04118002
         SPACE 2                                                        04168002
STORAGE DSECT                      MAPS WORK AREA                       04218002
PARMLIST DS    F                   SAVE AREA FOR PARAMETER LIST         04318002
KEYNMODE EQU   PARMLIST+3          KEY AND MODE FLAGS OF PARM LIST      04418002
WORKBYTE DS    B                   NEW KEY AND MODE DATA                04518002
TEMPKEY  DS    B                   USED WHEN OBTAINING KEY FROM TCB     04618002
         EJECT                                                          04625002
         IHAASCB                                                        04632002
         EJECT                                                          04639002
         IHAASXB                                                        04646002
         EJECT                                                          04653002
         IKJRB                                                          04674002
         EJECT                                                          04681002
         IKJTCB                                                         04688002
         EJECT                                                          04695002
         IHAWSAVT                                                       04702002
         END   IEAVMODE                                                 04718002
./  ADD  SSI=81880328,NAME=IEAVSETS
         TITLE 'IEAVSETS...AOS/2...PROLOG'                              00050001
IGC079   CSECT                                                          00100002
         USING *,R6                 BR AROUND MODID                     00150002
IGC079   MODID BR=YES               STATUS MACRO'S SERVICE ROUTINE      00382002
         SPACE                                                          00385002
* STATUS - - CHANGE LEVEL 000                                           00388002
   SPACE                                                                00391002
* FUNCTION                                                              00394002
   SPACE                                                                00397002
*      THIS TYPE 1 SVC ROUTINE ALLOWS THE MANIPULATION OF DISPATCHING   00400002
*    STATUS INFORMATION, PARTICULARLY AS IT PRETAINS TO THE             00450001
*    DISPATCHABILITY OF THE TASK.                                       00500001
*    KEY 0 ROUTINES MAY INVOKE STATUS EITHER THROUGH THE SVC            00550002
*    INTERFACE OR VIA A BRANCH ENTRY.  OTHER ROUTINES ARE               00600002
*    RESTRICTED TO THE SVC INTERFACE.                                   00650001
*      ROUTINES WITH A SUPERVISOR PROTECT KEY CAN USE THE STATUS        00700002
*    ROUTINE TO SET OR RESET THE STATUS OF PARTICULAR TASKS.  THE       00750001
*    AFFECTED TASK STATUS CAN BE EITHER THE 'MUST COMPLETE' STATUS      00800001
*    OR THE 'NONDISPATCHABILITY' STATUS.                                00850001
*      FOR KEY 0 CALLERS, THE STATUS ROUTINE SETS (OR RESETS) THE       00900001
*    FOLLOWING CONDITIONS FOR A TASK OR A GROUP OF TASKS.               00950001
*      1. 'MUST COMPLETE' STATUS, SO THAT OTHER TASKS OF THE JOB STEP   01000001
*         ARE MADE NONDISPATCHABLE (OR DISPATCHABLE) WHILE              01050002
*         THE CURRENT TASK IS BEING PERFORMED.                          01100001
*      2. 'NONDISPATCHABILITY' STATUS, SO THAT THE ROUTINES OF THE      01150001
*         TASKS CANNOT (OR CAN) BE RESTARTED BY THE DISPATCHER.         01200001
*      WHEN ENTERED VIA THE MACRO INSTRUCTION                           01250001
*               STATUS SET,MC                                           01300002
*    THE STATUS ROUTINE SETS THE CALLER'S TASK IN 'STEP'                01350002
*    MUST COMPLETE STATUS.  (IF THE RESET OPERAND IS SPECIFIED,         01400001
*    THE 'MUST COMPLETE' STATUS THAT WAS PREVIOUSLY SET IS CLEARED.)    01450001
*    THE ROUTINE SETS THE 'MUST COMPLETE' FLAG IN THE CURRENT TCB,      01500001
*    THE 'PROHIBIT ASYNCHRONOUS EXITS' FLAG IN THE CURRENT TCB,         01550001
*    AND THE STEP 'MUST COMPLETE' NONDISPATCHABILITY FLAG IN            01600002
*    OTHER TCBS OF THE JOB STEP. ALL TASKS IN THE JOB STEP,             01650002
*    INCLUDING THE INITIATOR, ARE AFFECTED.  THE CALLER'S               01750002
*    TASK IS ALWAYS EXEMPT FROM THE SETTING/RESETTING OF DISPATCHABITY. 01900001
*      WHEN ENTERING VIA THE MACRO INSTRUCTION                          01950001
*            STATUS SET,ND,(STEP)(SYSTEM)(TCB ADDR,(MASK)(,E))          02000002
*    THE STATUS ROUTINE SETS THE SPECIFIED PRIMARY NONDISPATCH-         02050001
*    ABILITY FLAGS TCBFLGS4 AND TCBFLGS5 (BYTES 32,33)                  02100001
*    IN THE SPECIFIED SET OF TCB'S.  (IF RESET IS SPECIFIED,  THE       02150001
*    INDICATED PRIMARY NONDISPATCHABILITY FLAGS ARE CLEARED IN THE      02200001
*    SPECIFIED SET OF TCB'S.)  THREE SETS OF TASKS CAN BE SPECIFIED:    02250002
*    THE JOB STEP, A SPECIFIED TASK AND ALL ITS DESCENDANTS,            02300002
*    OR A SINGLE TASK.  IF SYSTEM IS SPECIFIED, A SYSTEM-WIDE           02350002
*    INDICATOR IS SET FOR THE DISPATCHER SO THAT ONLY ADDRESS SPACES    02400002
*    WHICH ARE MARKED EXEMPT WILL BE DISPATCHED. THE CALLER IS          02410002
*    TEMPORARILY MARKED EXEMPT. IF STEP IS SPECIFIED, ALL TASKS OF THE  02450002
*    JOB STEP ARE SET NON-DISPATCHABLE EXCEPT THE CURRENT TASK AND THE  02500001
*    JOB STEP'S INITIATOR.  IF TCB IS SPECIFIED, THE TASK AND ALL ITS   02550001
*    DESCENDANTS ARE SET NONDISPATCHABLE.  IF 'E' IS SPECIFIED,         02600001
*    ONLY THE TASK EXPLICITLY IDENTIFIED IS SET NONDISPATCHABLE.        02650001
*      WHEN ENTERED VIA THE MACRO INSTRUCTION                           02700001
*           STATUS SET,SD,(STEP)(SYSTEM)(TCB ADDR,(MASK)(,E))           02750001
*    THE STATUS ROUTINE SETS THE                                        02800001
*    SPECIFIED SECONDARY NONDISPATCHABILITY FLAGS IN THE SPECIFIED      02850001
*    SET OF TCB'S.  (IF RESET IS SPECIFIED, THE SPECIFIED SECONDARY     02900001
*    NONDISPATCHABILITY FLAGS ARE CLEARED IN THE SPECIFIED SET OF       02950001
*    TCB'S.)  THE SECONDARY NONDISPATCHABILITY FLAGS ARE CONTAINED IN   03000001
*    TCBNDSP0, 1, 2 AND 3.                                              03050002
*    FOUR SETS OF TASKS CAN BE SPECIFIED:                               03100001
*    THE SYSTEM, THE JOB STEP, A SPECIFIED TASK AND ALL ITS             03150001
*    DESCENDANTS, OR A SINGLE TASK.  IF SYSTEM IS SPECIFIED, A SYSTEM-  03200002
*    WIDE INDICATOR IS SET FOR THE DISPATCHER SO THAT ONLY ADDRESS      03250002
*    SPACES WHICH ARE MARKED EXEMPT WILL BE DISPATCHED. THE CALLER      03260002
*    IS TEMPORARILY MARKED EXEMPT.  IF STEP IS SPECIFIED, ALL TASKS     03300002
*    OF THE JOB STEP ARE SET NONDISPATCHABLE EXCEPT THE CURRENT         03350001
*    TASK AND THE JOB STEP'S INITIATOR.  IF A TCB ADDRESS IS SPECIFIED  03400001
*    (TCB ADDRESS,(MASK)), THE TASK AND ITS DESCENDANTS ARE SET NON-    03450001
*    DISPATCHABLE.  IF A TCB ADDRESS IS SPECIFIED, AND ONLY THE TCB     03500001
*    EXPLICITLY IDENTIFIED IS TO BE SET NONDISPATCHABLE, THE 'E'        03550001
*    PARAMETER IS USED.                                                 03600001
*      STATUS WILL AUTOMATICALLY ADJUST THE PRIMARY NONDISPATCH-        03650001
*    ABILITY SUMMARY FLAG (TCBPNDSP) TO INDICATE IF ANY SECONDARY       03700001
*    NONDISPATCHABILITY FLAGS ARE ON.                                   03750001
*      WHEN ENTERED VIA THE MACRO INSTRUCTION                           03760002
*           STATUS STOP,SYNCH                                           03770002
*    THE STATUS ROUTINE DOES ALL NORMAL 'STOP TCB' PROCESSING (FOR ALL  03780002
*    SUBTASKS OF THE CALLER). IN ADDITION, IT PUTS THE CALLER IN A WAIT 03790002
*    CONDITION UNTIL ALL STOP-PENDING CONDITIONS ARE CLEARED.           03792002
*    SUBSEQUENTLY, EXIT AND/OR EXIT PROLOGUE INTERFACE WITH             03792502
*    STATUS WHEN A DEFERED STOP IS COMPLETED TO FOR STATUS TO           03793002
*    DECREMENT THE WAIT COUNT FOR THE ISSUER.                           03793502
*      WHEN ENTERED VIA THE MACRO INSTRUCTION                           03794002
*           STATUS (STOP)(START),SRBS,(ASID=)                           03796002
*    STATUS MAKES QUIESCEABLE SRBS NON-DISPATCHABLE AND SETS TCBS IN    03798002
*    THE ADDRESS SPACE (EXCLUDING THE CALLER) NON-DISPATCHABLE UNTIL    03798402
*    SRBS ARE RESTARTED. THE CALLER IS NOT DISPATCHED UNTIL ALL RUNNING 03798802
*    SRBS HAVE COMPLETED. FOR START, THE CONDITIONS ARE RESET. AN ASID  03799202
*    MAY BE SPECIFIED FOR START ONLY. A BRANCH ENTRY EXISTS FOR START   03799602
*    SRB AT IGC07903. SEE ENTRY INPUT FOR REQUIREMENTS.                 03799702
*    A BRANCH ENTRY EXISTS AT IEAVSSNQ TO STOP NON-QUIESABLE            03801702
*    SRBS (THE SVC STOP SRB IS FOR QUIESABLE SRBS ONLY) WHICH           03803702
*    IS USED BY SWAP - OUT. SEE ENTRY INPUT FOR REQUIREMENTS.           03805702
*      A BRANCH ENTRY EXISTS WHEREBY A CALLER MAY SET HIS OWN TCB NON-  03807702
*    DISPATCHABLE. REGISTERS ARE SET UP AS USUAL FOR THE STATUS BRANCH  03809702
*    ENTRY. CODE 15 INDICATES A SD REQUEST, CODE 16 FOR ND. THE CALLER  03811702
*    IS REQUIRED TO ESTABLISH HIS RESUME PSW/REGISTER ENVIRONMENT       03816602
*    IN HIS RB/TCB.                                                     03826602
*      PROBLEM PROGRAM CALLERS OF STATUS MAY REQUEST ONLY THE STOP/     03833302
*    STOP SYNCH, START SERVICE VIA THE MACRO INSTRUCTION                03850002
*           STATUS (STOP)(START),(TCB=TCB ADDR)(SYNCH)                  03900002
*    WHEN A USER ISSUES A STATUS MACRO INSTRUCTION WITH                 03950001
*    THE START OR STOP OPERAND, THE SET STATUS ROUTINE DETERMINES IF    04000001
*    THE SPECIFIED SUBTASK OF THE CURRENT TASK OR ALL SUBTASKS OF       04050001
*    THE CURRENT TASK ARE TO BE MODIFIED.  WHEN START IS SPECIFIED,     04100001
*    THE STOP/START COUNT IS DECREMENTED IN THE SUBTASK TCB(S) AND      04150001
*    THE NONDISPATCHABILITY FLAGS ARE CLEARED.  WHEN STOP IS SPECIF-    04200001
*    IED, THE STOP/START COUNT IS INCREMENTED IN THE SUBTASK TCB(S)     04250001
*    AND THE NONDISPATCHABILITY FLAGS ARE SET.  A TASK IS SET           04300001
*    NONDISPATCHABLE ONLY IF NO SYSTEM ROUTINES ARE EXECUTING FOR IT    04350001
*    AS INDICATED BY THE TCBATT FLAG.  IF A SYSTEM ROUTINE IS           04400001
*    EXECUTING FOR THE TASK, THE TCBSTPPR FLAG IS SET TO INDICATE THAT  04450001
*    THIS TASK SHOULD BE MADE NONDISPATCHABLE WHEN IT NO LONGER HAS     04500001
*    A SYSTEM ROUTINE EXECUTING.                                        04550001
*      SYSTEM ROUTINES MAY ALSO USE A NEW BRANCH ENTRY POINT TO         04600001
*    STATUS, IEATRSCN.  THIS SUBROUTINE WILL RETURN THE ADDR OF A       04650001
*    SINGLE SUBTASK (IF ANY) EACH TIME IT IS CALLED.  THROUGH MULTIPLE  04700001
*    CALLS TO IEATRSCN, A SYSTEMATIC SEARCH OF A SUBTASK TREE CAN       04750001
*    BE ACCOMPLISHED.                                                   04800001
     EJECT                                                              04850001
* ENTRY POINTS                                                          04900001
     SPACE                                                              04950001
*    1. IGC079  SVC ENTRY                                               05000001
*         ENTERED BY SYSTEM ROUTINES TO MANIPULATE THE                  05050002
*         DISPATCHABILITY OF TASKS, SRBS, AND THE SYSTEM.               05100002
*         ALSO ENTERED BY PROBLEM PROGRAM ROUTINES                      05150001
*         TO PERFORM THE START/STOP, STOP-SYNCH  TCB FUNCTION.          05200002
*    2. IGC07902  BRANCH ENTRY                                          05250001
*         ENTERED BY SYSTEM ROUTINES TO MANIPULATE THE                  05300002
*         DISPATCHABILITY OF TASKS AND SRBS.                            05350002
*    3. IEATRSCN  BRANCH ENTRY                                          05400001
*         ENTERED BY SYSTEM ROUTINES TO CAUSE A                         05450001
*         SEARCH OF A SUBTASK TREE.                                     05500001
*    4. IGC07903 BRANCH ENTRY                                           05504002
*         ENTERED BY SWAP-IN TO START SRBS IN THE                       05508002
*         ADDRESS SPACE TO BE SWAPPED IN.                               05512002
*         (NOTE DURING SWAP-OUT ERROR PROCESSING                        05513002
*          THIS ENTRY POINT IS INVOKEDTO START SRBS)                    05514002
*    5. IEAVSSNQ BRANCH ENTRY                                           05516002
*         ENTERED BY SWAP OUT TO STOP NON-QUIESABLE                     05520002
*         SRBS.                                                         05524002
*    6. IEAVESSS BRANCH ENTRY                                           05528002
*         ENTERED BY EXIT AND EXIT PROLOGUE TO COMPLETE                 05532002
*         STOP SYNCHRONIZED PROCESSING.                                 05536002
*                                                                       05540002
     SPACE                                                              05550001
* INPUT                                                                 05600001
     SPACE                                                              05650001
*    1. IGC079  SVC ENTRY                                               05700001
*        *PSW - TYPE I SVC PSW; LOCAL LOCK HELD                         05750002
*         R0  - BITS 0-15 PRIMARY MASK IF ND, ELSE ASID (OPTIONAL)      05800002
*               BITS 16-31 CODE 0 - RESERVED                            05850001
*                               1 - MC,STEP                             05900001
*                               3 - ND,STEP                             06000001
*                               4 - ND,SYSTEM                           06050001
*                               5 - ND,TCB (INCLUDES SUBTASKS)          06100001
*                               6 - STOP                                06150001
*                               7 - START                               06200001
*                               8 - SD,STEP                             06250001
*                               9 - SD,SYSTEM                           06300001
*                               10 - SD,TCB (INCLUDES SUBTASKS)         06350001
*                               11 - SD,TCB ADDRESS,E                   06400001
*                               12 - ND,TCB ADDRESS,E                   06450001
*                               13 - SRBS                               06460002
*                               14 - SYNCH                              06470002
*                               15 - CALLER,SD                          06480002
*                               16 - CALLER,ND                          06490002
*         R1 - BIT 0  0 = SET, 1 = RESET                                06500001
*              BITS 1-7  0                                              06550001
*              BITS 8-31 TCB ADDRESS (OPTIONAL)                         06600001
*         R2,R8-R13 - IRRELEVANT                                        06650002
*        *R3 - ADDRESS OF CVT                                           06700001
*        *R4 - ADDRESS OF CALLERS TCB                                   06750001
*        *R5 - ADDRESS OF CALLERS RB                                    06800001
*        *R6 - ENTRY POINT ADDRESS (IGC079)                             06850001
*        *R7 - ADDRESS OF ASCB                                          06860002
*        *R14 - RETURN ADDRESS (EXIT PROLOG)                            06900002
*         R15 - SECONDARY MASK IF SD; ELSE ASID (OPTIONAL)              06950002
*         * = SET UP BY SVC FLIH                                        07000001
*    2. IGC07902  BRANCH ENTRY                                          07050001
*         PSW - KEY 0, SUPERVISOR STATE, LOCAL LOCK                     07100002
*         R0,R1 - SAME AS FOR SVC ENTRY                                 07150001
*         R2-R12 - IRRELEVANT                                           07200001
*         R13 - SAME AS R15 IN SVC ENTRY                                07250002
*         R14 - RETURN ADDRESS                                          07300001
*         R15 - ADDRESS OF IGC07902                                     07350001
*    3. IEATRSCN  BRANCH ENTRY                                          07400001
*         PSW - KEY 0, SUPERVISOR STATE, LOCAL LOCK                     07450002
*         R0-R7,R9,R12,R13,R15 - IRRELEVANT                             07500001
*         R8 - ADDRESS OF HIGHEST LEVEL TASK IN TREE TO BE SEARCHED     07550001
*         R10 - ADDRESS OF TASK FROM WHICH SEARCH IS TO START ON        07600001
*               THIS CALL TO IEATRSCN                                   07650001
*         R11 - RETURN ADDRESS (IF NO TCB IS FOUND)                     07700001
*         R14 - RETURN ADDRESS (IF TCB IS FOUND)                        07750001
*    4. IGC07903 BRANCH ENTRY                                   @Y02752 07760002
*        PSW - KEY 0, SUPERVISOR STATE, SALLOC LOCK             @Y02752 07770002
*         R0 - BITS 0-15, ASID                                  @Y02752 07780002
*              BITS 16-31, CODE 13                              @Y02752 07790002
*         R1 - BIT 0 = 1                                        @Y02752 07792002
*         R2-R12 IRRELEVANT                                     @Y02752 07794002
*         R13 - ADDRESS OF 72 BYTE SAVE AREA                    @Y02752 07796002
*         R 14 - RETURN ADDRESS                                 @Y02752 07798002
*         R15 - ADDRESS OF IGC07903                             @Y02752 07798402
*    5. IEAVSSNQ BRANCH ENTRY                                           07798602
*        PSW - KEY 0, SUPERVISOR STATE, LOCAL LOCK                      07798802
*         R0-R13 IRRELEVANT                                             07799002
*         R14 - ENTRY POINT ADDRESS                                     07799202
*         R15 - RETURN ADDRESS                                          07799402
*    6. IEAVESSS BRANCH ENTRY                                           07799602
*        PSW - KEY 0, SUPERVISOR STATE, LOCAL LOCK                      07800002
*         R0-R3, R5-R6, R8-R13 - IRRELEVANT                             07805002
*         R4 -  ADDRESS OF EXITING TCB                                  07810002
*         R7 - ADDRESS OF ASCB                                          07820002
*         R14 - RETURN ADDRESS                                          07830002
*         R15 - ENTRY POINT ADDRESS                                     07835002
   SPACE 2                                                              07840002
* OUTPUT                                                                07850001
   SPACE                                                                07900001
*    1. IGC079  SVC ENTRY                                               07950001
*       **PSW - KEY 0, SUPERVISOR STATE                                 08000002
*       **R0-R13 - UNPREDICTABLE                                        08050001
*       **R14 - UNCHANGED                                               08100001
*         R15 = 0 - NORMAL COMPLETION                                   08150001
*             = 4 - STOP/START FAILED; SPECIFIED TASK NOT A SUBTASK     08200001
*                   OF THE CALLERS TASK                                 08250001
*         ** = USER PSW AND R2-R14 ARE RESTORED BY EXIT PROLOG          08300002
*    2. IGC07902  BRANCH ENTRY                                          08350001
*         R0-R14 - UNCHANGED                                            08400001
*         R15 = 0 (NORMAL COMPLETION)                                   08450001
*    3. IEATRSCN                                                        08500001
*         PSW - SAME STATE AS ENTERED                                   08550002
*         R0-R6,R8,R11-R15 - UNCHANGED                                  08600001
*         R7,R9 - UNPREDICTABLE                                         08650001
*         R10 - ADDRESS OF SELECTED TASK (IF ONE WAS FOUND)             08700001
*    4. IGC07903                                                @Y02752 08710002
*         PSW - KEY 0, SUPERVISOR STATE, SALLOC LOCK            @Y02752 08720002
*         R0-R14 UNCHANGED                                      @Y02752 08730002
*         R15 - 0 (NORMAL COMPLETEION)                          @Y02752 08740002
*    5. IEAVSSNQ                                                        08740902
*        PSW - KEY 0, SUPERVISOR STATE, LOCAL LOCK (NOTE THAT THE       08741802
*                                  LOCAL LOCK MAY HAVE BEEN FREED IN    08742702
*                                  STATUS PROCESSING AND REOBTAINED.)   08743602
*        R0-R10, R15 - UNCHANGED                                        08744502
*        R11-R14 - UNPREDICTABLE                                        08745402
*    6. IEAVESSS                                                        08746302
*        PSW - KEY 0, SUPERVISOR STATE, LOCAL LOCK                      08747202
*        R0-R14 - UNCHANGED                                             08748102
*        R15 UNPREDICTABLE                                              08749002
     SPACE 2                                                            08750001
* EXTERNAL REFERENCES                                                   08800001
     SPACE                                                              08850001
*         IEA0DS DISPATCHER                                             08900002
*         IEAVEMS0 MEMORY SWITCH                                        08950002
*         IGC044R2 CHAP RECOVERY ROUTINE                                09000002
     SPACE 2                                                            09050001
* EXITS,NORMAL                                                          09100001
     SPACE                                                              09150001
*    1. IGC079                                                          09200001
*          TO CALLER VIA BR 14 TO                                       09250002
*         TYPE 1 EXIT TO INDICATE COMPLETION OF STATUS REQUEST.         09300001
*    2. IGC07902                                                        09350001
*          TO CALLER VIA BR 14 TO                                       09400002
*         INDICATE COMPLETION OF STATUS REQUEST.                        09450002
*    3. IGC07903                                                @Y02752 09460002
*          TO CALLER VIA BR 14 TO                               @Y02752 09470002
*          INDICATE COMPLETION OF REQUEST                       @Y02752 09480002
*    4.  IEATRSCN                                                       09600002
*         TO CALLER VIA BR 11 IF NO TASK WAS FOUND IN THE TREE          09650001
*         TO CALLER VIA BR 14 IF A TASK WAS FOUND IN THE TREE.          09700001
*    5. IEAVESSS                                                @Y02752 09707002
*          TO CALLER VIA BR 14 TO                               @Y02752 09714002
*          INDICATE COMPLETION OF REQUEST                       @Y02752 09721002
*    5. IEAVSSNQ                                                @Y02752 09728002
*          TO CALLER VIA BR 15 TO                               @Y02752 09735002
*          INDICATE COMPLETION OF REQUEST                       @Y02752 09742002
       SPACE 2                                                          09750001
* EXITS,ERROR =                                                         09800002
*                                                                       09810002
*    1.  AT THE LABEL 'ABEND14F' THE IMPROPER                           09820002
*         CALLER IS ABENDED.                                            09830002
       SPACE 2                                                          09850001
   SPACE 2                                                              11850001
* ATTRIBUTES                                                            11900001
     SPACE                                                              11950001
*     LOCAL LOCK, KEY 0, SUPERVISOR STATE                               12000002
     SPACE                                                              12050001
*    AOS/2 SYSTEMS                                                      12100001
         SPACE 2                                                        12150001
* CHARACTER CODE DEPENDENCY -- NONE                                     12200001
         SPACE 2                                                        12250001
* NOTES                                                                 12300001
         SPACE                                                          12350001
*    NOTE ***  ALL MANIPULATION OF PRIMARY AND SECONDARY DISPATCH-      12400001
*    ABILITY INFORMATION SHOULD BE DONE VIA THE STATUS INTERFACE.       12450001
*    NOTE ***  KEY 0 CALLERS OF STATUS SHOULD ENSURE THAT THEIR         12500001
*    REQUESTS ARE CONSISTENT WITH SYSTEM INTEGRITY, SINCE THEIR         12550001
*    REQUESTS ARE NOT VALIDITY CHECKED.                                 12600002
         SPACE                                                          12605040
* CHANGE-ACTIVITY                                                       12610040
         SPACE                                                          12615040
*    OZ14227-NO CODE CHANGE. JUST A PTF PROBLEM.               @ZA30358 12620040
*    OZ20174-IMPROPER SERIALIZATION BETWEEN STATUS, DISPATCHER @ZA30358 12625040
*            AND TCTL. STATUS AND DISPATCHER REPLACE NI INSTR  @ZA30358 12630040
*            WITH CS.                                          @ZA30358 12635040
*    OZ30358-FORMERLY, SIGPCPUS WAS CALLED ONLY WHEN STATUS    @ZA30358 12640040
*            STOP OR SET WAS PROCESSED. HOWEVER IT IS ALSO     @ZA30358 12645040
*            NECESSARY TO CLEAR OUT OTHER TASKS WHEN STATUS    @ZA30358 12650040
*            START OR RESET IS BEING PROCESSED. IF A TASK      @ZA30358 12655040
*            BEING STARTED OR RESET IS ACTUALLY ACTIVE ON THE  @ZA30358 12660040
*            OTHER PROCESSOR, THE FOLLOWING MAY OCCUR:         @ZA30358 12665040
*             1. STATUS DECREMENTS ASCBTCBS, BECAUSE THE TASK  @ZA30358 12670040
*                IS DISPATCHABLE.                              @ZA30358 12675040
*             2. THE OTHER TASK ENTERS PAGE WAIT.              @ZA30358 12680040
*             3. BECAUSE THE TASK IS NOW NON-DISPATCHABLE,     @ZA30358 12685040
*                STATUS WILL FAIL TO INCREMENT ASCBTCBS. THIS  @ZA30358 12690040
*                IS INCORRECT.                                 @ZA30358 12695040
*            IT IS NOT NECESSARY TO CALL SIGPCPUS FOR          @ZA30358 12700040
*            STATUS RESET,SMC BECAUSE ASCBTCBS IS NOT          @ZA30358 12704040
*            DECREMENTED THEN.                                 @ZA30358 12708040
*            IT IS NOT NECESSARY TO CALL SIGPCPUS FOR          @ZA30358 12712040
*            STATUS START,SRBS BECAUSE NO PROCESSING IS DONE   @ZA30358 12720040
*            THERE IF STATUS STOP,SRBS IS NOT IN EFFECT.       @ZA30358 12725040
*    OZ32105-AN INTERLOCK WAS POSSIBLE IF THE CALLER HOLDS A   @ZA32105 12727040
*        SPIN LOCK BECAUSE IEAVSETS WILL LOOP ON ASCBCPUS AS   @ZA32105 12729040
*        LONG AS AN ACTIVE TASK IN THE SAME ADDRESS SPACE      @ZA32105 12731040
*        IS SPINNING TO OBTAIN THE SAME SPIN LOCK. THE PROBLEM @ZA32105 12733040
*        DESCRIBED BY THIS SPECIFIC APAR WILL BE SOLVED BY     @ZA32105 12735040
*        HAVING IEAVSETS NOT LOOP ON ASCBCPUS IF IT IS         @ZA32105 12737040
*        CHANGING DISPATCHABILITY FOR A SINGLE TASK AND THAT   @ZA32105 12739040
*        TASK IS NOT ACTIVE.                                   @ZA32105 12741040
         TITLE 'IEAVSETS...AOS/2...COMMUNICATION VECTOR TABLE C.V.T.'   12750001
         CVT   DSECT=YES                                                12800002
         TITLE 'IEAVSETS...AOS/2...PSA'                                 12850002
         IHAPSA                                                         12900002
         TITLE 'IEAVSETS...AOS/2...LCCA'                                12910002
         IHALCCA                                                        12920002
         TITLE 'IEAVSETS...AOS/2...PCCA'                                12930003
         IHAPCCA                                                        12940003
         TITLE 'IEAVSETS...AOS/2...TCB'                                 12950002
         IKJTCB                                                         13000002
         TITLE 'IEAVSETS...AOS/2...RB'                                  13002002
         IHARB                                                          13010002
         TITLE 'IEAVSETS...AOS/2...SRB'                                 13010102
         IHASRB                                                         13010202
         TITLE 'IEAVSETS...AOS/2...ASVT'                                13010402
         IHAASVT                                                        13010802
         TITLE 'IEAVSETS...AOS/2...ASCB'                                13012002
         IHAASCB                                                        13020002
         TITLE 'IEAVSETS...AOS/2...ASXB'                                13030002
         IHAASXB                                                        13040002
         TITLE 'IEAVSETS...AOS/2...CSD'                                 13042002
         IHACSD                                                         13044002
         TITLE 'IEAVSETS...VS/2...CDAL'                        @Z40FPYK 13054040
         CDAL                                                  @Z40FPYK 13064040
         TITLE 'IEAVSETS...AOS/2...JSCB'                                13094002
         IEZJSCB                                                        13144002
         TITLE 'IEAVSETS...AOS/2...WSAVT(LOCAL)'                        13194002
         IHAWSAVT                                                       13244002
         TITLE 'IEAVSETS...AOS/2...WSA(CPU)'                            13244402
         IHAWSAVT CLASS=CPU                                             13244802
         TITLE 'IEAVSETS...AOS/2...WSAVT(GLOBAL)'                       13246002
         IHAWSAVT CLASS=GLOBAL                                          13248002
         TITLE 'IEAVSETS...AOS/2...FRR STACK'                           13249202
         IHAFRRS                                                        13249302
         TITLE ' IEAVSETS...AOS/2...SDWA '                              13252002
         IHASDWA                                                        13252402
         TITLE 'IEAVSETS...AOS/2...WSA'                                 13253302
         SPACE 2                                                        13255202
WSA      DSECT                     SAVE AREA DESECT                     13257102
         DS    3X                  FIRST THREE BYTES OF R0              13258102
ACTCODE  DS    X                   ACTION CODE                          13259102
         DS    14F                 R1-R14                               13260102
         DS    3X                  FIRST THREE BYTES OF R15             13261102
RETNCODE DS    X                   RETURN CODE                          13262102
SWITCHES DS    X                   SWITCHES                             13263102
SAVMSK   DS    X                   MASK IN STNSM                        13264102
RES      DS    2X                  RESERVED                             13265102
STFRRSAV DS    F                   FRR SAVE AREA ADR                    13266102
UNDOIT   EQU   X'80'               RESET SW                             13267102
PRIMARY  EQU   X'40'               PRIMARY NON-DISP SW                  13268102
EXPLICIT EQU   X'20'               EXPLICIT TCB SW                      13269102
BRANCH   EQU   X'10'               BRANCH ENTRY SW                      13270102
XMSTATUS EQU   X'08'               XMSTATUS ENTRY SW                    13271102
SYNCHTCB EQU   X'04'               SYNCH STOP TCB                       13272102
*                                                                       13288802
*        STATUS FRR PARM AREA DSECT          @Y02753                    13290802
*                                                                       13293602
STFRRPAR DSECT                                                          13294002
STFRR15  DS    F                   RESERVED                     @Y02753 13294102
STFRR0   DS    3X                  RESERVED                     @Y02753 13297102
STFRAC   DS    X                   RESERVED                     @Y02753 13300102
STFRR1   DS    F                   RESERVED                     @Y02753 13303102
STFRCURR DS    F                   RESERVED                     @Y02753 13306102
STFRPREV DS    F                   RESERVED                     @Y02753 13309102
STFRE13  EQU   STFRPREV            RESERVED                     @Y02753 13312102
STFRSVSB EQU   STFRPREV            SRB ADDR SAVE AREA           @Y02753 13315102
STFRFLG  DS    X                   FLAG BYTE                    @Y02753 13320202
STFRSALL EQU   X'10'               START SRB CALLER OWNED SALLC @Y02753 13321802
REFRR    EQU   X'08'               STR SRB SRB FRR FLAG         @Y02753 13325302
STBRSRB  EQU   X'04'               STRT SRB BR EN FLAG          @Y02753 13327302
STFRSWIN EQU   X'02'               CALLED BY SWAP-IN           @YM08338 13328102
STFRREXV DS    X                   RESERVED                     @Y02753 13329002
STFRCTH  DS    0H                  RESERVED                     @Y02753 13332502
STFRCTB0 DS    X                   RESERVED                     @Y02753 13335502
STFRCTB1 DS    X                   RESERVED                     @Y02753 13338502
         TITLE 'IEAVSETS...AOS/2...EQUATES'                             13343002
IGC079   CSECT                                                          13346502
         SPACE 2                                                        13350001
*   REGISTER ASSIGNMENT                                                 13400001
R0       EQU   0                   .PARAMETER REG                       13450001
R1       EQU   1                   .PARAMETER REG                       13500001
R2       EQU   2                   .STATUS INTERNAL LINK REG            13550001
R3       EQU   3                   .CVT POINTER                         13600001
R4       EQU   4                   .CALLERS TCB                         13650001
R5       EQU   5                   .SAVE AREA BASE ADDR                 13700002
R6       EQU   6                   .STATUS BASE REG                     13750001
R7       EQU   7                   .ADDR OF TREESCAN RTN                13800001
R8       EQU   8                   .TCB ADDR WORK REG                   13850001
R9       EQU   9                   .TCB ADDR WORK REG                   13900001
R10      EQU   10                  .SEARCHED FOR AND FOUND TCB          13950001
R11      EQU   11                  .ADDR OF 'SCAN COMPLETE' EXIT        14000001
R12      EQU   12                  .STATUS WORK REG                     14050001
R13      EQU   13                  .FRR WORK AREA BASE ADDR             14100002
R14      EQU   14                  .STATUS INTERNAL LINK REG            14150001
R15      EQU   15                  .BR ENTRY BASE AND WORK REG          14200001
*                                                                       14210002
*        FRR REGISTERS                                                  14220002
*                                                                       14230002
STSDWAR1 EQU   1                   SDWA POINTER REG             @Y02753 14240002
STWRK1   EQU   2                   WORK REG 1                   @Y02753 14242002
STPADP   EQU   13                  POINTER TO 6 WORD PARM AREA  @Y02753 14244002
STEPR    EQU   15                  ENTRY REG                    @Y02753 14246002
STRETR   EQU   14                  RETURN REG                   @Y02753 14248002
STBASE   EQU   6                   BASE REG                     @Y02753 14248402
STCODE   EQU   15                  RETURN CODE REG              @Y02753 14248802
STWRK2   EQU   3                   WORK REG 2                   @Y02753 14249202
STWRK3   EQU   11                  WORK REG 3                   @Y02753 14249602
STWSA    EQU   5                   WSA ADDR                     @Y02753 14249702
STWRK0   EQU   0                   WORK REG 0                   @Y02753 14249802
STASCB   EQU   7                   ASCB ADDR REG                @Y02753 14249902
RETSV    EQU   9                   RETURN REG SAVE              @Y02753 14266602
STINTLK  EQU   14                  INTERNAL LINK REG            @Y02753 14276602
         SPACE 2                                                        14283302
*   OTHER 'EQU' DEFINITIONS.                                            14300001
STMC     EQU   1                   .STEP MUST COMPLETE CODE             14350002
STOP     EQU   6                   .STOP CODE MASK                      14600001
START    EQU   7                   .START CODE MASK                     14650001
STOPSYNC EQU   14                  .STOP SYNCH CODE                     14660002
SSRB     EQU   13                  .SRBS CODE                           14700002
ABEND    EQU   13                  .ABEND SVC                           14710002
ONE4FOX  EQU   X'14F'              .ABEND CODE                          14750001
KEYF     EQU   X'80'               .PROTECT KEY MASK                    14800002
OFF      EQU   255                 .OFF MASK                            14850001
C0       EQU   0                   .0                                   14860002
C1       EQU   1                   .1                                   14900001
C2       EQU   2                   .2                                   14950001
C4       EQU   4                   .4                                   15000001
C8       EQU   8                   .8                                   15002002
C16      EQU   16                  .16                                  15010002
C64      EQU   64                  .64                                  15060002
CF       EQU   15                  .MASK FOR ICM                        15070002
E        EQU   8                   .BR CONDITION MASK                   15100001
NE       EQU   7                   .BR CONDITION MASK                   15150001
NZ       EQU   7                   .BR CONDITION MASK                   15200001
NO       EQU   14                  .BR CONDITION MASK                   15250001
DISMASK  EQU   X'FC'                DISABLE MASK IN STNSM               15260002
STREGL   EQU   64                  LENGTH OF MOVE OF REGISTERS  @Y02753 15270002
CXFF     EQU   X'FF'               CONSTANT X'FF'              @Z40FPYK 15280040
         TITLE 'IEAVSETS...AOS/2...INITIALIZING'                        15300001
*   ENTRY POINT TO STATUS VIA SVC ENTRY                                 15350001
         USING PSA,R0                                                   15500002
         USING STFRRPAR,R13                                     @Y02753 15502002
         USING WSA,R5                                                   15510002
         USING ASCB,R3                                                  15550002
*/*STATUS: CHART*/                                                      15552002
*/* E IGC079*/                                                          15554002
*/* P FIND LOCAL SAVE AREA- SAVE REGS*/                                 15556002
         LR    R3,R7                   COPY ASCB ADDR                   15566002
         L     R5,ASCBASXB             ASXB ADDR                        15600002
         L     R5,ASXBSPSA-ASXB(,R5)    WSA TABLE                       15650002
         L     R5,WSALSTAT-WSAL(,R5)    STATUS WSA                      15670002
         STM   R0,R14,WSA              SAVE REGS                        15702002
         MVI   SWITCHES,C0             INIT BITS TO SVC ENTRY           15710002
*/* P (,SUPVTEST) INIT SWITCHES TO SVC ENTRY*/                          15720002
         B     SUPVTEST            .PROCEED TO MAIN PROCESSING          15850001
         SPACE 3                                                        15900001
*   ENTRY POINT TO STATUS VIA A BRANCH ENTRY                            15950001
*   CALLERS BRANCH HERE ON REGISTER 15                                  16000001
*/* E IGC07902*/                                                        16060002
*/* P BOOTSTRAP TO SAVE AREA- SAVE REGS*/                               16070002
IGC07902 L     R15,PSAAOLD             ASCB                             16100002
         L     R15,ASCBASXB-ASCB(,R15)  ASXB                            16150002
         L     R15,ASXBSPSA-ASXB(,R15)  WSA TBL                         16200002
         L     R15,WSALSTAT-WSAL(,R15)  STATUS WSA                      16250002
         STM   R0,R14,0(R15)           SAVE REGS                        16300002
*/* P SET UP ENVIRONMENTAL REGS- INIT SWITCHES TO BRANCH ENTRY*/        16350002
         BALR  R6,R0                    BOOTSTRAP ADDRESSABILITY        16360002
         USING *,R6                                                     16370002
         L     R6,AIGC079          .LOAD NEW BASE REG                   16400001
         USING IGC079,R6                                                16500001
         LR    R5,R15                  SAVE AREA BASE                   16530002
         MVI   SWITCHES,BRANCH         SET BITS TO BRANCH ENTRY         16532002
         LR    R15,R13                 PARM REGS AS IN SVC              16540002
Q01      L     R3,PSAAOLD              ASCB ADDR                        16542002
Q02      L     R4,PSATOLD              CURR TCB                         16552002
*/*SUPVTEST: D (NO,SETTER,YES,) RESET WAS SPECIFIED*/                   16592002
SUPVTEST SR    R13,R13                 ZERO WORK REG                    16710002
         LTR   R1,R1                   TEST FOR RESET SW                16730002
         BNM   SETTER                  BR IF NOT RESET                  16740002
*/* P TURN ON RESET SWITCH*/                                            16740402
         OI    SWITCHES,UNDOIT         SET ON RESET SW                  16742002
*/*SETTER: S SETFRR: SETFRR COVERAGE, GET PARM AREA*/           @Y02753 16744002
*/* D (OTHR,SWCHTEST,STOP,TSTASID,STRT,) STOP/START TCB*/               16752002
SETTER   ST    R13,C4*R15(,R5)          ASSUME RC=0                     16760002
         SETFRR A,FRRAD=ASTNFRR,PARMAD=(R13),WRKREGS=(R8,R2)    @Y02753 16810002
         ST    R13,STFRRSAV        SAVE ADDR OF PARM LIST       @Y02753 16820002
GONONE   CLI   ACTCODE,STOP              LOWER THAN STOP       @YM01681 16850002
         BL    SWCHTEST            .YES, PRIM MASK SW HAS BEEN SET      16900001
         BE    TSTASID                 BR IF STOP                       16910002
         CLI   ACTCODE,STOPSYNC    IS IT STOP SYNCH            @YM04236 16920002
         BE    TSTASID             YES, SKIP AUTHORIZATION CHEC@YM04236 16930002
         CLI   ACTCODE,START             LT OR EQ START        @YM01681 16950002
         BH    SWCHTEST                BR IF NOT START                  17000002
*/* P (,TSTASID) TURN ON RESET SWITCH*/                                 17010002
         OI    SWITCHES,UNDOIT         SET RESET SWITCH                 17050002
         B     TSTASID             GO TO TEST FOR XMSTATUS              17100002
*/*SWCHTEST: D (YES,TSTASID,NO,) BRANCH ENTRY*/                         17150002
SWCHTEST TM    SWITCHES,BRANCH         BRANCH ENTRY                     17200002
         BO    TSTASID                 YES                              17250002
*/* D (NO,ABEND14F,YES,) CALLER IS IN SUPVR KEY*/                       17252002
         L     R2,TCBRBP-TCB(,R4)       CURR RB                         17350002
         TM    RBOPSW+C1-RBSECT(R2),KEYF  SUPUR KEY                     17360002
         BNZ   ABEND14F                NO, SVC ILLEGAL                  17370002
*/*TSTASID: D (YES,NDASID,NO,) REQUEST TO CHG PRIMARY NDISP FLAGS*/     17372002
TSTASID  LA    R2,OFF                  MASK OF FF HEX                   17380002
         NR    R2,R0                   ISOLATE CODE                     17390002
         BZ    ABEND14F                ABEND CALLER IF INVALID          17390402
         LA    R8,QUIRKS(R2)           GET ADDR OF TABLE ENTRY          17392402
         TM    C0(R8),NOTND            TEST IF ND OR SD                 17394402
NDSDB    BZ    NDASID                  BR IF ND                         17398002
*/*SDASID: P (,ASIDTST) GET ASID (IF ANY) FROM REG 0)*/                 17398102
SDASID   LR    R9,R0                   NOT ND, ASID IN 0                17398402
         SRL   R9,C16                  ISOLATE                          17398802
         B     ASIDTST             TEST FOR XMSTATUS                    17399202
*/*NDASID: P GET ASID FROM REG 15- MASK IN REG 0*/                      17399302
NDASID   LR    R9,R15              ND, ASID IN 15                       17399602
         LR    R15,R0              SET UP STATUS MASK REG               17399802
*/* P TURN ON PRIMARY NDISP SWITCH*/                                    17401702
         OI    SWITCHES,PRIMARY        INDICATE PRIMARY (ND)            17403002
*/*ASIDTST: D (NO,NOTSTP,YES,) AN ASID IS SPECIFIED*/                   17405002
ASIDTST  LTR   R9,R9                   ASID IS ZERO                     17406702
         BZ    NOTSTP                  BR IF SO                         17410002
*/* N DEPENDING ON STATUS OPTION, XM IS INVALID, VALID, OR VALID ONLY   17410402
*/* FOR RESET*/                                                         17410802
*/* D (NOXM,NOTSTP,XMOK,XMGO,RSET,) XM VALID FOR THIS FUNCTION*/        17412002
         LA    R10,QUIRKS(R2)           INVALID XM FNS                  17415002
         TM    C0(R10),XMSET+XMRESET    TEST FOR VALID XM CODES         17419302
         BO    XMGO                    BR IF OK                         17426602
         BZ    NOTSTP                  BR NO XMSTATUS          @YM01974 17428602
*/* D (NO,ABEND14F,YES,) RESET SWITCH IS ON*/                           17429002
         LTR   R1,R1                   INVALID IF STOP OR SET           17430602
         BNM   ABEND14F                OK IF RESET, START               17432602
*/* D (NO,XMGO,YES,NOTSTP) REQUEST IS FOR START SRBS*/                  17434602
         CLI   ACTCODE,SSRB            IS CALL FOR START SRBS           17442602
         BNE   XMGO                    IF NOT, NORMAL XMSTATUS          17444602
         B     NOTSTP                GO TO TO ROUTINE                   17446602
*/*ABEND14F: R '14F' ABEND*/                                            17448602
ABEND14F LA    R1,ONE4FOX          .LOAD UP ERROR CODE FOR ABTERM       17450001
         SLL   R1,C4+C8                POSITION CODE                    17500002
         O     R1,HIBIT                TURN ON SYSTEM IND               17550002
QJZ1     SETFRR  D,WRKREGS=(R8,R2)                              @Y02753 17560002
         SVC   ABEND                   ABEND                            17600002
         EJECT                                                          17650001
*/*BADTCB: P SET RETURN CODE FOR INVALID TCB ADDR*/                     17660002
BADTCB   MVI   RETNCODE,C4         .SET 'INVALID TCB' RETURN CODE       17700001
         SPACE                                                          17750001
*/*EXIT: S SETFRR: DELETE FRR COVERAGE */                               17770402
EXIT     SETFRR D,WRKREGS=(R8,R2)                              @Y02752  17770702
         SPACE 2                                               @Z40FPYK 17770840
*/* P RESET STATUS ACTIVE STATE */                             @Z40FPYK 17770940
         NI    ASCBSRQ1,CXFF-ASCBSTA   RESET STATUS ACTIVE     @Z40FPYK 17771040
*                                      FOR NONDISPATCHABLE     @Z40FPYK 17771140
*                                      TESTS NOW BEING VALID   @Z40FPYK 17771240
         SPACE 2                                               @Z40FPYK 17771340
*/*EXIT10: D (NO,EXIT1,YES,) XMSTATUS SWITCH IS ON*/                    17771440
EXIT10   TM    SWITCHES,XMSTATUS       XM STATUS IN OPERATION  @YM02662 17771540
         BZ    EXIT1                   BR IF NOT               @YM02662 17771640
         L     R1,C0(,R5)               RETRIEVE SRB ADDR      @YM02662 17771702
*/*EXFRITL: S EXFREE: FREE SRB SPACE */                                 17772002
EXFRITL  BAL   R8,EXFREE           LINK TO FREE                @YM02662 17773602
*/* S SETLOCK: RELEASE LOCAL LOCK*/                                     17774402
Q41      SETLOCK RELEASE,TYPE=LOCAL,RELATED=Q22                         17775202
*/* R GET  SRB EXIT TO DISP ADDR*/                                      17776002
Q42      L     R14,CVTPTR              ADDR OF CVT                      17776802
         L     R14,CVTSRBRT-CVTMAP(,R14)   ADDR OF SRB EXIT TO DISP     17777602
         BR    R14                 RETURN                               17778402
*/*EXFREE: E FREE SRB*/                                                 17778802
*/* S SETLOCK: OBTAIN SALLOC LOCK*/                                     17779202
EXFREE   EQU   *                   LABEL                       @YM02662 17780002
Q38      SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=Q40             17781002
*/* S FREEMAIN: FREE SRB*/                                              17782002
         LA    R0,SRBSIZE+C4+C4+C4     SIZE OF SRB             @YM02662 17790002
Q39      FREEMAIN RU,A=(1),LV=(0),SP=245,BRANCH=(YES,GLOBAL)            17794002
*/* S SETLOCK: RELEASE SALLOC LOCK*/                                    17794402
Q40      SETLOCK RELEASE,TYPE=SALLOC,RELATED=Q38                        17796002
*/* R RETURN*/                                                          17796402
         BR    R8                      OUT                     @YM02662 17799202
*/*EXIT1: P RESTORE REGS FROM LOCAL WSA */                              17809802
EXIT1    LM    R0,R15,WSA          RESTORE REGS                 @Y02753 17809902
*/* R RETURN*/                                                          17829902
         BR    R14                 .RETURN TO THE STATUS CALLER         17850001
         SPACE 3                                                        17900001
*/*NOTSTP: P SET UP ENTRY CODE AS BR TABLE VECTOR*/                     17910002
NOTSTP   AR    R2,R2                   DOUBLE CODE FOR INDEX            17950002
         LH    R12,BRATAB(R2)     .GO INTO TABLE TO GET RTN'S ADDR      18100002
         B     IGC079(R12)         .BRANCH TO ROUTINE                   18150001
         EJECT                                                          18200002
* BRANCH TABLE TO DETERMINE WHICH ROUTINE TO ENTER                      18250001
*/*BRATAB: D                                                            18362002
*/*(1,MCSTEP,2,ABEND14F,3,NDSTEP,4,NDSYSTEM,5,NDTCB,6,PROCEED,          18364002
*/* 7,PROCEED,8,SDSTEP,9,SDSYSTEM,10,SDTCB,11,SDETCB,12,NDETCB,         18386002
*/* 13,SRBS,14,SYNCH,15,CALLER,16,CALLER) ENTRY CODE*/                  18390002
         TITLE 'IEAVSETS...AOS/2...ND,SYSTEM, SD,SYSTEM'                19300002
* PRIMARY NON-DISPATCHABLE SYSTEM ROUTINE                               21350001
*/*SDSYSTEM: E CODE 9*/                                                 21352002
SDSYSTEM EQU   *                   LABEL                                21360002
*/*NDSYSTEM: E CODE 4*/                                                 21410002
NDSYSTEM L     R2,CVTPTR               ADDR OF CVT                      21650002
         L     R4,CVTCSD-CVTMAP(,R2)       ADDR OF CSD                  21700002
         SR    R1,R1                   PARM REG TO ZERO                 21702002
         L     R15,MEMSW               ADDR OF MEMORY SW                21704002
*/* D (YES,RESETSYS,NO,) THIS REQUEST IS RESET*/                        21704402
         TM    SWITCHES,UNDOIT      .IS THIS A RESET                    21706002
         BO    RESETSYS            .YES                                 21708002
*/*Q04: S SETLOCK: OBTAIN CMS LOCK*/                                    21708403
Q04      SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,RELATED=Q07 OR Q0X         21710003
*/* S SETLOCK: OBTAIN DISPATCHER LOCK*/                                 21714002
Q05      SETLOCK OBTAIN,TYPE=DISP,MODE=UNCOND,RELATED=Q06               21720002
*/* P SET ISSUER ASCB EXEMPT FROM SYS ND*/                              21722002
         OI    ASCBFLG2,ASCBXMPT       SET ISSUER EXEMPT                21730002
*/* P SET SYSTEM ND FLAG ON*/                                           21740002
         OI    CSDSCFL1-CSD(R4),CSDSYSND  SET SYS ND FLG                21750002
*/* D (YES,NOMP,NO,) RUNNING UP?*/                             @YA02383 21751003
CK4MP    EQU   *             FOR TESTING ONLY                  @YA02383 21753003
         LA    R11,C1        VALUE TO INDICATE 1 CPU           @YA02383 21756003
         CH    R11,CSDCPUOL-CSD(R4)  Q. ONLY 1 CPU ALIVE       @YA02383 21759003
         BE    NOMP          A. YES. SKIP MP LOGIC             @YA02383 21762003
*/* S MEMSW: SWITCH OUT OF NON-EXEMPT A.S.''S*/                @YA02383 21763003
         BALR  R14,R15       GO TO MEMSW - ZERO ASCB ADDR      @YA02383 21765003
*/* P GET ADDR OF PCCA TABLE - INIT FOR 16 PASSES*/            @YA02383 21766003
         L     R11,CVTPCCAT-CVTMAP(,R2)    ADDR OF PCCA TABLE  @YA02383 21768003
         LA    R13,C16       MAX CPUS                          @YA02383 21771003
*/*NEXTCPU: D (YES,SKIP1,NO,) IS THIS PCCA ENTRY ZERO?*/       @YA02383 21772003
NEXTCPU  L     R12,C0(,R11)  ADDR OF PCCA                      @YA02383 21774003
         LTR   R12,R12       Q. ZERO                           @YA02383 21777003
         BZ    SKIP1         A. YES. GET NEXT                  @YA02383 21780003
*/* D (YES,SKIP1,NO,) IS THIS PCCA ENTRY FOR OUR CPU?*/        @YA02383 21781003
         C     R12,PSAPCCAV  Q. IS THIS OUR OWN CPU            @YA02383 21783003
         BE    SKIP1         A. YES. GET NEXT                  @YA02383 21786003
*/* D (YES,SKIP1,NO,) EXEMPT ADDR SPACE ? */                   @YA02383 21787040
         L     R12,PCCAPSAV-PCCA(R12)  GET OTHER CPU PSA ADDR  @YA02383 21789003
         L     R12,PSAAOLD-PSA(R12)  GET OTHER CPU ASCB ADDR   @YA02383 21792003
         TM    ASCBFLG2-ASCB(R12),ASCBXMPT+ASCBPXMT  Q. EXEMPT ADDR    X21795003
                               SPACE PROCESSING ON OTHER CPU   @YA02383 21802003
         BNZ   SKIP1         A. YES. INTERLOCK ON CMS LOCK             X21810003
                               NOT POSSIBLE                    @YA02383 21820003
*/* S (,NDSYSTEM) SETLOCK: RELEASE DISP LOCK*/                 @ZM30628 21825003
Q0X      SETLOCK RELEASE,TYPE=DISP,RELATED=Q05                 @YA02383 21830003
         B     NDSYSTEM      STALL FOR TIME                    @ZM30628 21840003
*/*SKIP1: D (YES,NEXTCPU,NO,) MORE CPUS TO CHECK?*/            @YA02383 21845003
SKIP1    EQU   *             SKIP CHECK OF ASSOCIATED PSA      @YA02383 21850003
         LA    R11,C4(R11)   NEXT ENTRY IN PCCA TABLE          @YA02383 21860003
         BCT   R13,NEXTCPU   BR IF MORE CPUS                   @YA02383 21870003
NOMP     EQU   *             USED TO SKIP MP LOGIC             @YA02383 21880003
*/*NOMP: S SETLOCK: RELEASE DISPATCHER LOCK*/                           21960003
Q06      SETLOCK RELEASE,TYPE=DISP,RELATED=Q05                          22000002
*/* S (,EXIT) SETLOCK: RELEASE CMS LOCK*/                               22030002
Q07      SETLOCK RELEASE,TYPE=CMS,RELATED=Q04                           22050002
         B     EXIT                    OUT                              22150002
*/*RESETSYS: S SETLOCK: OBTAIN DISPATCHER LOCK*/                        22200002
RESETSYS SETLOCK OBTAIN,TYPE=DISP,MODE=UNCOND,RELATED=Q09               22282002
*/* P RESET SYS ND FLAG*/                                               22284002
         NI    CSDSCFL1-CSD(R4),OFF-CSDSYSND  SET SYS ND FLG            22290002
*/* D (YES,EXEMPT,NO,) ADDRESS SPACE IS PERM EXEMPT*/                   22290102
         TM    ASCBFLG2,ASCBPXMT       A.S. IS PERMANENTLY ND/SD EXEMPT 22290402
         BO    EXEMPT                  BR IF SO                         22290802
*/* P RESET ASCB EXEMPTION BIT*/                                        22290902
         NI    ASCBFLG2,OFF-ASCBXMPT   RESET ISSUERS EXEMPTION          22291202
*/*EXEMPT: S MEMSW: SWITCH INTO HI-PRI A.S.''S*/                        22291602
EXEMPT   BALR  R14,R15                 GO TO MEMSW WITH ZERO ASCB ADDR  22292002
*/* S (,EXIT) SETLOCK: RELEASE DISPATCHER LOCK*/                        22292402
Q09      SETLOCK RELEASE,TYPE=DISP,RELATED=RESETSYS                     22294002
         B     EXIT                    OUT                              22298402
         TITLE 'IEAVSETS...AOS/2...MC,STEP'                             22300001
*   THIS CODE IS ENTERED WHEN MUST COMPLETE STEP IS INDICATED.          22350001
*   IT FIRST DETERMINES IF SET OR RESET AND THEN SETS THE CURRENT TCB.  22400001
*   THEN IT MAKES ALL TASKS IN THE JOB STEP NON-DISPATCHABLE.           22450001
         SPACE                                                          22500001
         USING TCB,R4                                                   22550001
* MUST COMPLETE STEP ROUTINE                                            22600001
*/*MCSTEP: E CODE 1*/                                                   22610002
*/* D (YES,RESETSTP,NO,) THIS IS A RESET REQUEST*/                      22620002
MCSTEP   TM    SWITCHES,UNDOIT      .IS THIS A RESET                    22650002
         BO    RESETSTP            .YES                                 22700001
*/*SETSTP: P TURN ON SMC FLAG IN CALLER TCB*/                           22710002
SETSTP   OI    TCBFLGS2,TCBFJMC    .SET MUST COMPLETE FLAG              22750001
*/* P TURN ON INHIBIT ASYNCH EXITS BIT IN CALLER TCB*/                  22760002
         OI    TCBFLGS1,TCBFX      .INHIBIT ASYNCHRONOUS EXITS          22800001
         LR    R7,R15                  SAVE REG ACROSS SIGPS            22802002
*/* S (,MAIN1) SIGPCPUS: CLEAR OTHER CPUS OUT OF A.S.*/                 22804002
         BAL   R12,SIGPCPUS            CLEAR OTHER CPUS OUT OF A.S.     22810002
         LR    R15,R7                  RESET REG                        22820002
         B     MAIN1               .PROCEED DOWN TCB TREE               22850001
*/*RESETSTP: P TURN OFF SMC IN CALLER TCB*/                             22860002
RESETSTP NI    TCBFLGS2,OFF-TCBFJMC         .RESET MUST COMPLETE        22900001
*/* P TURN OFF INHIBIT ASYNCH EXITS BIT IN CALLER TCB*/                 22910002
         NI    TCBFLGS1,OFF-TCBFX  .ALLOW ASYNCHRONOUS EXITS            22950001
*/*MAIN1: L GET JSTCB (OR INIT TCB, IF ANY)*/                           23000002
MAIN1    L     R10,TCBJSTCB        .GET CALLERS JOB STEP TCB            23300002
         DROP  R4                                                       23350001
         USING TCB,R10                                                  23400001
         L     R2,TCBJSCB              GET STEP JSCB                    23450002
         L     R2,JSCBTCBP-IEZJSCB(,R2) GET INIT TCB IF ANY             23500002
         LTR   R2,R2                   ANY?                             23550002
         BZ    CHKCURR                 BR IF NOT, USE JSTEP TCB         23560002
         LR    R10,R2                  USE INIT TCB                     23570002
*/*CHKCURR: D (YES,SCANTASK,NO,) AT CALLER TCB*/                        23580002
CHKCURR  CR    R4,R10              .IS THIS THE CURRENT TCB             23600001
         LR    R8,R10              .INITIALIZE REG FOR TREE SCAN        23650001
         BE    SCANTASK            .YES, GO SELECT ANOTHER TASK         23750002
*/*MAIN14: D (YES,DECMCT1,NO,) THIS IS A RESET*/                        23800002
MAIN14   TM    SWITCHES,UNDOIT      .IS THIS A RESET                    23900002
         BO    DECMCT1             .YES                                 23950001
*/*STPON1: P INCREMENT SMC CT IN TREE TCB */                            24000002
*/* N ABEND IF COUNT WRAPS TO X'FF' */                                  24010002
STPON1   IC    R12,TCBSTMCT        .GET JB STEP M.C. COUNT              24050002
         TM    TCBSTMCT,OFF        TEST FOR WRAP COND          @YM00217 24052002
         BO    ABEND14F            ABEND IF TOO MANY           @YM00217 24056002
         LA    R12,R1(,R12)         .INCREMENT IT                       24100002
         STC   R12,TCBSTMCT        .RE-STORE IT                         24150001
*/* S TCBRDYCT: APPLY -1 TO TCB READY COUNT*/                           24150402
         L     R9,FOXES                DELTA OF -1                      24152002
         BAL   R11,TCBRDYCT            GO PROCESS ASCBTCBS              24154002
*/* P (,SCANTASK) TURN ON SMC NDISP BIT IN TREE TCB*/                   24156002
         OI    TCBFLGS5,TCBSTP     .SET JB STEP M.C. SUMMARY FLAG       24160002
         B     SCANTASK            .GO SELECT ANOTHER TASK              24200002
*/*DECMCT1: P DECREMENT SMC CT IN TREE TCB */                           24210002
DECMCT1  IC    R12,TCBSTMCT        .GET JB STEP M.C. COUNT              24250001
         BCTR  R12,R0              .DECREMENT IT                        24300001
         CLI   TCBSTMCT,C0         TEST FOR ALREADY ZERO       @YM00217 24310002
         BE    STPOFF              BR IF ALREADY DOWN TO ZERO  @YM00217 24320002
         STC   R12,TCBSTMCT        .RE-STORE IT                         24350001
*/* D (NO,SCANTASK,YES,) COUNT IS NOW ZERO*/                            24360002
         CLI   TCBSTMCT,C0         .IS IT NOW ZERO                      24400002
         BNE   SCANTASK            .NO, GO SELECT ANOTHER TASK          24450002
*/* P TURN OFF SMC NDISP FLAG IN TREE TCB*/                             24450402
STPOFF   NI    TCBFLGS5,OFF-TCBSTP .RESET JB STEP M.C. SUMMARY FLAG     24452002
*/* S TCBRDYCT: APPLY +1 TO TCB READY COUNT*/                           24454002
         LA    R9,C1                   DELTA IS 1                       24460002
         BAL   R11,TCBRDYCT            PROCESS ASCBTCBS                 24470002
*/*SCANTASK: S (NONE,SETSMCT,NEXT,) IEATRSCN: GET NEXT TCB IN TREE*/    24520002
SCANTASK LA    R11,SETSMCT             FINAL EXIT POINT FROM TREESCAN   24550002
         BAL   R14,IEATRSCN        .GO TO TREESCAN                      24820002
* RETURN HERE MEANS ANOTHER SUBTASK HAS BEEN FOUND. ITS ADDR IS IN R10. 24850001
* RETURN TO THE ADDR IN R11 MEANS SCAN COMPLETED                        24900001
*/* D (YES,SCANTASK,NO,) AT CALLER TCB*/                                24910002
         CR    R10,R4              .IS THIS THE CALLERS TASK            24950001
         BE    SCANTASK            .YES, GO SELECT ANOTHER TASK         25000002
*/*CHECKJS: D (YES,MAIN14,NO,SCANTASK) TCB IN SAME STEP (SAME JSTCBS)*/ 25010002
CHECKJS  CLC   TCBJSTCB,TCBJSTCB-TCB(R4) .NO, IS TASK IN SAME STEP      25050001
         BE    MAIN14              .YES, GO SET/RESET MUST COMPLET FLAG 25100001
         B     SCANTASK            .NO, GO SELECT ANOTHER TASK          25150002
         DROP  R10                                                      25200001
*/*SETSMCT: D (YES,DECRSMCT,NO,) THIS IS A RESET*/                      25210002
SETSMCT  IC    R2,ASCBSMCT             CURRENT SMCT                     25214002
         TM    SWITCHES,UNDOIT          TEST FOR SET/RESET              25220002
         BO    DECRSMCT                BR IF RESET                      25230002
*/* P (,EXIT) INCREMENT ASCBSMCT CT*/                                   25232002
         CLI   ASCBSMCT,OFF        TEST FOR OVERFLOW           @YM00217 25234002
         BE    ABEND14F            ABEND IF TOO MANY           @YM00217 25236002
         LA    R2,C1(,R2)          INCR CT                              25240002
         B     SMCT                GO TO SET COUNT                      25241002
*/*DECRSMCT: P (,EXIT) DECREMENT ASCBSMCT CT*/                          25242402
DECRSMCT BCTR  R2,R0               DECREMENT CT                         25244002
         CLI   ASCBSMCT,C0         TEST FOR ALREADY ZERO       @YM00217 25244402
         BE    EXIT                EXIT IF ALREADY DONE        @YM00217 25244802
SMCT     STC   R2,ASCBSMCT         SET NEW CT                           25246002
         B     EXIT                OUT                                  25248002
         EJECT                                                          25248402
*/*SIGPCPUS: E SIGNAL OTHER PROCESSORS */                               25248640
SIGPCPUS DS    0H                  USES REGS 0 1 13 14 15 (12)  @Y02751 25249202
*                                                                       25249340
*  THE SIGPCPUS SUBROUTINE PERFORMS TWO FUNCTIONS.  THE FIRST  @Z40FPYK 25249440
*  WILL CLEAR ACTIVE DISPATCHERS THAT DO NOT HOLD THE LOCAL    @Z40FPYK 25249540
*  LOCK WHILE DISPATCHING A TASK (E.G. TCTL FUNCTION).  THIS   @Z40FPYK 25249640
*  FUNCTION BASICALLY PROVIDES A SYNCHRONIZATION FUNCTION,     @Z40FPYK 25249740
*  BETWEEN STATUS AND THE NON-LOCALLY LOCKED DISPATCHER.       @Z40FPYK 25249840
*  THE SECOND FUNCTION OF SIGPCPUS IS TO CLEAR ALL OTHER       @Z40FPYK 25249940
*  CPUS OF ACTIVE TASKS OPERATING IN THE STATUS MEMORY.        @Z40FPYK 25250040
*  REGISTER CONVENTIONS ARE AS FOLLOWS:                        @Z40FPYK 25250140
*    R0  WORK REGISTER      R8  UNCHANGED                      @Z40FPYK 25250240
*    R1  WORK REGISTER      R9  UNCHANGED                      @Z40FPYK 25250340
*    R2  UNCHANGED          R10 UNCHANGED                      @Z40FPYK 25250440
*    R3  ASCB ADDRESS       R11 WORK REGISTER                  @Z40FPYK 25250540
*    R4  UNCHANGED          R12 RETURN REGISTER                @Z40FPYK 25251540
*    R5  UNCHANGED          R13 WORK REGISTER                  @Z40FPYK 25251640
*    R6  STATUS BASE REG    R14 WORK REGISTER                  @Z40FPYK 25251740
*    R7  UNCHANGED          R15 WORK REGISTER                  @Z40FPYK 25251840
*                                                              @Z40FPYK 25251940
*/* P ASCBSTA =  ON */                                         @Z40FPYK 25252040
         OI    ASCBSRQ1,ASCBSTA        TURN ON STATUS ACTIVE   @Z40FPYK 25252140
*                                      FLAG TO SET UP A        @Z40FPYK 25252240
*                                      NON-DISPATCHABLE STATE  @Z40FPYK 25252340
*                                      IN THIS MEMORY          @Z40FPYK 25252440
         SPACE 2                                               @Z40FPYK 25252540
*/* P OBTAIN CDAL POINTER */                                   @Z40FPYK 25252640
         SPACE 2                                               @Z40FPYK 25252740
         L     R11,CVTPTR              POINT TO THE CVT        @Z40FPYK 25252840
         USING CVT,R11                                         @Z40FPYK 25252940
         L     R11,CVTCDAL             POINT TO THE CDAL       @Z40FPYK 25253040
         DROP  R11                                             @Z40FPYK 25253140
         SPACE 2                                               @Z40FPYK 25253240
*   INDEED THERE ARE ACTIVE NON-LOCALLY LOCKED DISPATCHERS     @Z40FPYK 25253340
*   CURRENTLY ACTIVE.  THIS ROUTINE MUST ANALYZE WHICH CPUS    @Z40FPYK 25253440
*   HAVE THIS CONDITION AND IF THE DISPATCHERS ARE ACTIVE ON   @Z40FPYK 25253540
*   BEHALF OF THE MEMORY STATUS IS ACTIVE IN, THIS CONDITION   @Z40FPYK 25253640
*   MUST BE CLEARED.                                           @Z40FPYK 25253740
         SPACE 2                                               @Z40FPYK 25253840
*/*%MAXCPU: P MAXCPU COUNT = 16 */                             @Z40FPYK 25253940
         SPACE 2                                               @Z40FPYK 25254040
         LA    R1,C16                   SET UP FOR MAXIMUM     @Z40FPYK 25254140
*                                       NUMBER OF CPUS         @Z40FPYK 25254240
         SPACE 2                                               @Z40FPYK 25254940
*/*DISPLOOP: D (YES,,NO,DISPFND) ACTIVE ENTRY ? */             @Z40FPYK 25255040
         SPACE 2                                               @Z40FPYK 25255240
DISPLOOP DS    0H                                              @Z40FPYK 25255340
         USING CDAL,R11                                        @Z40FPYK 25255440
         L     R14,CDALDSP             A DISPATCHER ACTIVE FOR @Z40FPYK 25255540
*                                      THIS CPU ?              @Z40FPYK 25257940
         LTR   R14,R14                 DISP ELEMENT = 0 ?      @Z40FPYK 25258140
         BNZ   DISPFND                 NO,  STALL              @Z40FPYK 25259840
*                                      UNTIL THIS CONDITION IS @Z40FPYK 25262040
*                                      CLEARED                 @Z40FPYK 25262340
         SPACE 2                                               @Z40FPYK 25262640
*/*DISPNXT: P BUMP TO NEXT CPU ENTRY */                        @Z40FPYK 25262940
         SPACE 2                                               @Z40FPYK 25263240
DISPNXT  DS    0H                                              @Z40FPYK 25263540
         LA    R11,C4(R11)             INCREMENT TO NEXT ENTRY @Z40FPYK 25263840
         SPACE 2                                               @Z40FPYK 25263940
*/* D (YES,DISPLOOP,NO,SIGPCPUM) MORE CPU'S ? */               @Z40FPYK 25264040
         SPACE 2                                               @Z40FPYK 25264140
         BCT   R1,DISPLOOP             HAVE ALL CPUS BEEN      @Z40FPYK 25264240
*                                      CHECKED?  IF NOT, WE    @Z40FPYK 25264340
*                                      MUST CONTINUE CHECKING  @Z40FPYK 25264440
         B     SIGPCPUM                ELSE ALL CPUS HAVE BEEN @Z40FPYK 25264540
*                                      EXAMINED.  THE VARIOUS  @Z40FPYK 25264640
*                                      NON-DISPATCHABILITY     @Z40FPYK 25264740
*                                      STATES CAN BE SET       @Z40FPYK 25264840
         SPACE 2                                               @Z40FPYK 25264940
*/*DISPFND: D (YES,,NO,DISPLOOP) ACR ACTIVE ? */               @Z40FPYK 25265040
         SPACE 2                                               @Z40FPYK 25265140
DISPFND  DS    0H                                              @Z40FPYK 25265240
         L     R13,PSALCCAV            LCCA ADDRESS OF OUR CPU @Z40FPYK 25267540
         USING LCCA,R13                                        @Z40FPYK 25267640
         TM    LCCADSF1,LCCAACR        ACR ACTIVE?             @Z40FPYK 25267740
         BZ    DISPLOOP                NO, SPIN UNTIL CDAL=0   @Z40FPYK 25267840
         DROP  R11                                             @Z40FPYK 25267940
         SPACE 2                                               @Z40FPYK 25270240
*/* S (,DISPLOOP)ACR: CALL ACR TO PREVENT INTERLOCK */         @Z40FPYK 25270340
         SPACE 2                                               @Z40FPYK 25270540
         LR    R0,R10                  SAVE R10 ACROSS THE     @Z40FPYK 25270640
*                                      ACR CALL                @Z40FPYK 25270740
         STNSM SAVMSK,DISMASK          DISABLE AND SAVE THE    @Z40FPYK 25270840
*                                      CURRENT MASK            @Z40FPYK 25273240
         USING WSAC,R10                                        @Z40FPYK 25273340
         CALLRTM TYPE=ACRLM,CCA=(R13)                          @Z40FPYK 25273440
         DROP  R10,R13                                         @Z40FPYK 25273540
         USING STFRRPAR,R13                                    @Z40FPYK 25274140
         LR    R10,R0                  RESTORE R10             @Z40FPYK 25275540
         IC    R14,SAVMSK              RESTORE THE SAVED       @Z40FPYK 25275640
         EX    R14,STOMSK              MASK AND ENABLE         @Z40FPYK 25277640
         B     DISPLOOP                CONTINUE CPU CHECK      @Z40FPYK 25277740
*                                      RESTORING REG 14        @Z40FPYK 25278140
*/*SIGPCPUM: D (TCB,,SRB,SIGNSP) TCB OR SRB CALLER */          @Z40FPYK 25278240
         SPACE 2                                               @Z40FPYK 25278340
SIGPCPUM DS    0H                      CLEAR ACTIVE TASKS IN   @Z40FPYK 25278440
*                                      THIS MEMORY             @Z40FPYK 25278540
         L     R11,PSATOLD             GET CURR TCB POINTER     @Y02751 25278640
         LTR   R11,R11                 TEST FOR ZERO(SRB)       @Y02751 25278740
         BZ    SIGNSP                  BR ZERO (SRB)            @Y02751 25278840
*/* P (,%JT0) SET CHECK COUNT = 1 FOR TCB*/                     @Y02751 25278940
         LA    R11,C1                  SET TCB CHECK COUNT      @Y02751 25279040
*/*SIGNSP: P CHECK COUNT = 0 FOR SRB */                         @Y02751 25279140
*/*%JT0: D (NO,SETSIG,YES,) CHECK COUNT MATCH NUMBER ACT CPUS*/@Y02751  25279240
SIGNSP   CL    R11,ASCBCPUS            CHECK CPU COUNT          @Y02751 25279340
*/* R RETURN */                                                         25279440
         BER   R12                     RETRN IF NEED NO SIGP    @Y02751 25279540
         TM    SWITCHES,EXPLICIT       IS REQUEST FOR 1 TCB?   @ZA32105 25279640
         BZ    SETSIG                  NO, QUIESCE ALL TASKS   @ZA32105 25280140
*                                      IN A. S. EXCEPT CURRENT @ZA32105 25280240
*        WE ARE CHANGING DISPATCHABILITY FOR ONLY 1 TASK. IF   @ZA32105 25280340
*        THAT TASK IS NOW ACTIVE, WE MUST CONTINUE WITH SIGP   @ZA32105 25280440
*        PROCESSING. IF IT IS NOT ACTIVE, DO NOT WORRY ABOUT   @ZA32105 25280540
*        OTHER TASKS (AN INTERLOCK WITH A SPIN LOCK IS         @ZA32105 25280640
*        POSSIBLE).                                            @ZA32105 25280740
         TM    TCBXSCT-TCB(R8),TCBACTIV+TCBS3A IS TASK ACTIVE? @ZA32105 25280840
         BZR   R12                     NO, RETURN WITH NO SIGP @ZA32105 25281340
*/*SETSIG: P GET ADDR OF PCCA TABLE - INIT FOR 16 PASSES */     @Y02751 25281440
SETSIG   DS    0H                      TEST LABEL               @Y02751 25281540
         L     R11,CVTPTR              ADDR OF CVT                      25281640
         L     R11,CVTPCCAT-CVTMAP(,R11)   ADDR OF PCCA TABLE           25281740
         LA    R13,C16                  MAX CPUS                        25281840
*/*SIGPLOOP: D (YES,NOSIGP,NO,) THIS PCCA ENTRY IS ZERO*/               25281940
SIGPLOOP L     R1,C0(,R11)             ADDR OF PCCA                     25282040
         LTR   R1,R1                   IS ZERO                          25282140
         BZ    NOSIGP                  IF SO, DO NOT ISSUE RPSGNL       25282240
*/* D (YES,NOSIGP,NO,) THIS PCCA ENTRY IS FOR OUR CPU*/                 25282340
Q12      C     R1,PSAPCCAV             IS THIS OUR OWN CPU              25282440
         BE    NOSIGP                  YES, BR, DO NOT INTRPT ONESELF   25282540
*/* S RPSGNL: SIGP CPU REPRESENTED BY PCCA ENTRY*/                      25282640
Q13      RPSGNL SWITCH,CPU=(1)         INTERRUPT OTHER CPU              25282740
*/*NOSIGP: D (YES,SIGPLOOP,NO,) MORE CPUS TO CHECK*/                    25282840
NOSIGP   LA    R11,C4(,R11)             TO NEXT ENTRY IN PCCA TABLE     25282940
         BCT   R13,SIGPLOOP             BR IF MORE CPUS                 25283002
         L     R13,STFRRSAV        RESTORE FRR PRM POINTER      @Y02753 25285302
         SR    R0,R0               CLEAR REG                    @Y02753 25287302
*/* D (SRB,SIGPSPIN,TCB,) SPIN CT IS 0- WE ARE AN SRB OR TCB*/          25289602
Q14      C     R0,PSATOLD              IS PSATOLD ZERO                  25291902
         BE    SIGPSPIN                BR IF SO, MEANS SRB MODE         25294202
*/* P MAKE SPIN CT 1 SINCE WE ARE A TCB*/                               25296502
         LA    R0,C1                   IN TCB MODE, COUNT WILL BE 1     25298802
*/*SIGPSPIN: D (FAIL,%D6,TAKE,) CS ASCBCPUS AND SPIN CT*/               25301140
SIGPSPIN LR    R1,R0                   SET UP LOW COUNT FOR CS          25303402
Q10      CS    R1,R1,ASCBCPUS          DO WE HAVE A MATCH YET           25305702
*/* R RETURN*/                                                          25308002
         BZR   R12                     YES, RETURN TO CALLER            25310302
*/*%D6: D (NO,SIGPSPIN,YES,) LCCA ACR ACTIVE BIT ON*/                   25312602
         L     R15,PSALCCAV            GET ADDR OF OUR LCCA             25314902
         USING LCCA,R15                                                 25317202
         TM    LCCADSF1,LCCAACR        ACR IS IN PROGRESS               25319502
         BZ    SIGPSPIN                BR IF NOT SO                     25321802
*/* S (,SIGPSPIN) ACR: CALL ACR TO AVOID INTERLOCK*/                    25324140
         LR    R14,R10                 SAVE REG 10 ACROSS ACR CALL      25326402
         USING WSA,R5                                                   25328702
         STNSM SAVMSK,DISMASK          DISABLE ANS SAVE MASK            25331002
         USING WSAC,R10                                                 25333302
         CALLRTM TYPE=ACRLM,CCA=(R15)                                   25335602
         DROP  R10,R15                                                  25337902
         LR    R10,R14                 RESTORE REG 10                   25340202
         IC    R14,SAVMSK              GET SAVED SYS MASK               25342502
         EX    R14,STOMSK              ENABLE                           25344802
         B     SIGPSPIN                TO LOOP                          25347102
STOMSK   STOSM SAVMSK,C0               EXECUTED                         25349402
         SPACE 4                                               @ZA20174 25350440
*/*TCBRDYCT: E UPDATE ASCBTCBS RTN*/                                    25352702
*/* D (NO,%D1,YES,) TCB IS DISPATCHABLE*/                               25354002
TCBRDYCT DS    0H                      USES REGS 9 12 13 (10 11)        25356302
         SR    R12,R12                 ZERO REG                         25358602
         CH    R12,TCBFLGS4-TCB(,R10)   TCB IS NON-DISPATCHIBLE         25360902
         BNER  R11                     RETURN IF SO                     25362902
*/* P SET TCBS3A TO LOCK OUT RESUME */                         @ZA11584 25363240
         L     R12,TCBXSCT-TCB(,R10)   PICK UP TCB ACTIVE WORD @ZA11584 25363440
STATLOOP N     R12,MASK1               INSURE RESUME NOT ACTIVE@ZA11584 25363640
         LR    R0,R12                  INSURE THAT WE LOCK OUT @ZA11584 25363840
         O     R0,MASK2                RESUME WHILE ADJUSTING  @ZA11584 25364040
         CS    R12,R0,TCBXSCT-TCB(R10) THE ASCBTCBS COUNT      @ZA11584 25365040
         BNE   STATLOOP                NO ON -- RESUME ACTIVE  @ZA11584 25365440
*                                      SPIN UNTIL IT FINISHES  @ZA11584 25365840
*/* D (NO,RESETS3A,YES,) WAIT COUNT IN TOP RB IS ZERO */       @ZA20174 25366740
         L     R12,TCBRBP-TCB(,R10)     GET TOP RBADDR                  25367802
         CLI   RBWCF-RBSECT(R12),C0    IS RB WAITING                    25370102
         BNE   RESETS3A                RETURN IF SO            @ZA20174 25371140
*/* P APPLY SUPPLIED DELTA TO ASCBTCBS CT USING CS*/                    25374702
         L     R12,ASCBTCBS            GET COUNT OF READY TCBS          25377002
TRYRDYCT LR    R0,R12                  SET UP FOR CS                    25379302
         AR    R0,R9                   APPLY SUPPLIED DELTA             25381602
Q15      CS    R12,R0,ASCBTCBS         STORE NEW COUNT                  25383902
         BNZ   TRYRDYCT                MISSED - TRY AGAIN               25386202
         LTR     R0,R0                NEW COUNT=0?     @ZD04015         25386540
         BNZ     RESETS3A             NO,DONE - RETURN         @ZA20174 25386640
         LH      R12,ASCBSWCT          GET WAIT COUNT   @ZD04015        25387140
         LA      R12,1(R12)             INCREMENT COUNT BY ONE @ZD04015 25387440
         STH     R12,ASCBSWCT          SAVE NEW WAIT COUNT @ZD04015     25387740
*/*RESETS3A: P TURN OFF TCBS3A BIT*/                           @ZA20174 25387840
RESETS3A L     R12,TCBXSCT-TCB(R10)    GET TCB INTERSECT WORD  @ZA20174 25387940
LOOPS3A  LR    R0,R12                  INIT SWAP OPERAND       @ZA20174 25388040
         N     R0,MASK1                CLEAR TCBS3A IN SWAP OP @ZA20174 25388240
         CS    R12,R0,TCBXSCT-TCB(R10) CLEAR TCBS3A IN TCB     @ZA20174 25388340
         BNE   LOOPS3A                 UPDATE FAIL, RETRY CS   @ZA20174 25388440
*/*%D1: R RETURN*/                                                      25390240
         BR    R11                     DONE RETURN                      25390802
         TITLE 'IEAVSETS...AOS/2...SD,STEP, ND,STEP'                    25393102
*   THIS CODE IS ENTERED WHEN NON-DISPATCHABLE STEP IS SPECIFIED.       25395402
*   IT OBTAINS THE JOB STEP TCB AND SETS ALL DESCENDENTS EXCEPT THE     25397702
*   CURRENT TASK NON-DISPATCHABLE.                                      25400001
         SPACE                                                          25450001
         USING TCB,R4                                                   25500001
*/*NDSTEP: E CODE 3*/                                                   25510002
NDSTEP   EQU   *                   LABEL                                25550002
*/*SDSTEP: E CODE 8*/                                                   25552002
*/* D (YES,STEPND,NO,) PRIMARY REQUEST*/                                25554002
SDSTEP   LR    R7,R15                  COPY MASK                        25560002
         TM    SWITCHES,PRIMARY        TEST FOR ND/SD                   25610002
         BO    STEPND                  BR IF PRIMARY                    25660002
*/* D (YES,ABEND14F,NO,MAINSTEP) STOP TCB BIT IS PRESENT IN MASK*/      25662002
         N     R15,STOPCHEK            SEE IF STOP TCB BIT IN 2NDY MASK 25670002
         BNZ   ABEND14F                IF SO, THAT IS IMMORAL           25680002
         B     MAINSTEP            CONTINUE                             25690002
*/*STEPND: D (YES,ABEND14F,NO,) SET MC BIT IS PRESENT IN MASK*/         25690402
STEPND   N     R15,SMCCHEK         SEE IF SMC BIT IN PRIM MASK          25692002
         BNZ   ABEND14F            BR IF SO - ALSO ILLEGAL              25693002
*/*MAINSTEP: S SIGPCPUS: CLEAR OTHER CPUS FROM A.S.*/          @ZA30358 25694440
MAINSTEP EQU   *                                               @ZA30358 25700440
         SPACE                                                          25706440
*        SIGPCPUS WAS FORMERLY CALLED ONLY FOR SET             @ZA30358 25712440
         BAL   R12,SIGPCPUS        CLEAR OTHER CPUS FROM A.S.  @ZA30358 25718440
*/* D (NO,GETJSTCB,YES,) RESET REQUEST*/                       @ZA30358 25724440
         TM    SWITCHES,UNDOIT     IS THIS A RESET                      25730440
         BNO   GETJSTCB            NO GET THE JOBSTEP TCB      @ZA30358 25736440
*/* P INVERT MASK*/                                                     25752002
         X     R7,FOXES            INVERT MASK                          25760002
*/* D (NO,GETJSTCB,YES,) RUNNING IN SRB MODE*/                          25762002
Q44      L     R1,PSATOLD          ADDR OF CURRENT TCB                  25770002
         LTR   R1,R1                   TEST RUNNING TCBS COUNT          25792002
         BNZ   GETJSTCB                BR IF NOT IN SRB MODE            25794002
*/* P (,JSTEST) START AT TOP TCB IN A.S.*/                              25794102
         L     R10,ASCBASXB            GET ADDR OF ASXB                 25794402
         L     R10,ASXBFTCB-ASXB(,R10)  TOP TCB IN A.S.                 25796002
         B     JSTEST              CONTINUE                             25816002
*/*GETJSTCB: P GET CALLER JSTCB ADDR*/                                  25948002
GETJSTCB L     R10,TCBJSTCB        .GET THE CALLER'S JSTCB              26500001
*/*JSTEST: P ESTABLISH RETURN AT 'GETNEXT' FOR BITSET, BITRESET*/       26510002
JSTEST   LR    R8,R10              .INIT REG FOR TREE SCAN              26550001
         LR    R15,R7                  SET UP MASK REG                  26560002
         LA    R2,GETNEXT          .INIT FLAG MANIPULATOR LINK REG      26600002
*/* D (YES,SETADDR,NO,) LOOKING AT CALLER TCB*/                         26610002
         CR    R4,R10              .IS CALLER THE JOB STEP TCB          26650001
         BE    SETADDR             .YES, BYPASS HIM                     26700001
*/*SETTSTND: D (YES,BITRESET,NO,BITSET) RESET REQUEST*/                 26710002
SETTSTND TM    SWITCHES,UNDOIT      .IS THIS A RESET                    26750002
         BO    BITRESET            .YES, GO TO FLAG RESETTER            26800001
         B     BITSET              .NO, GO INSTEAD TO FLAG SETTER       26850001
         SPACE                                                          26900001
*/*GETNEXT: D (YES,EXIT,NO,) EXPLICIT TCB REQUEST*/                     26910002
GETNEXT  TM    SWITCHES,EXPLICIT   .IS THIS AN EXPLICIT TCB REQUEST     26950002
         BO    EXIT                .YES, GO TO EXIT                     27100002
         SPACE                                                          27150001
*/*SETADDR: S (NONE,EXIT,NEXT,) IEATRSCN: GET NEXT TCB IN TREE*/        27160002
SETADDR  LA    R11,EXIT                SET NO-MORE EXIT ADDR            27200002
         BAL   R14,IEATRSCN        .GO TO TREESCAN TO GET A RELATIVE    27210002
* RETURN HERE MEANS ANOTHER SUBTASK HAS BEEN FOUND. ITS ADDR IS IN R10. 27250001
* RETURN TO THE ADDR IN R11 MEANS SCAN COMPLETED                        27300001
*/*CURRCHK: D (YES,GETNEXT,NO,SETTSTND) LOOKING AT CALLER TCB*/         27310002
CURRCHK  CR    R10,R4              .WAS CALLER'S TCB SELECTED           27350002
         BCR   E,R2                .YES, GO GET ANOTHER TASK            27400001
         B     SETTSTND            .NO, GO DO IT TO THE RELATIVE        27450001
         DROP  R4                                                       27500001
       TITLE 'IEAVSETS...AOS/2...COMMON TCB FLAG SETTER && RESETTER'    27550001
         USING TCB,R10                                                  27600001
* RESET NON-DISPATCHABILITY FLAG MANIPULATOR ROUTINES                   27650001
         SPACE                                                          27700001
*/*BITRESET: S TCBRDYCT: APPLY -1 TO TCB READY COUNT*/                  27702002
BITRESET L     R9,FOXES                SET DELTA TO -1                  27710002
         BAL   R11,TCBRDYCT            GO TO ASCBTCBS RTN               27720002
         LR    R12,R15                 COPY MASK INTO WORK REG          27730002
*/* D (NO,SDRESET,YES,) PRIMARY BITS TO BE AFFECTED*/                   27740002
         TM    SWITCHES,PRIMARY    .IS 2NDARY MASK TO BE AFFECTED       27750002
         BNO   SDRESET             .YES, BR                             27800002
         SPACE                                                          27850001
* RESET PRIMARY NON-DISPACHABILITY FLAGS                                27900001
*/* P 'AND' PRIMARY BITS WITH INVERTED RESET MASK*/                     27910002
         N     R12,TCBFLGS4            N OFF PRIMARY BITS               27950002
         STCM  R12,C8+C4,TCBFLGS4      STORE UPDATED NON-DISP FLAGS     28000002
*/*PTEST: S TCBRDYCT: APPLY +1 TO TCB READY COUNT*/                     28010002
PTEST    LA    R9,C1                   SET UP DELTA OF +1               28050002
         BAL   R11,TCBRDYCT            UPDATE CT NOW THAT BITS RESET    28100002
*/* R RETURN TO CALLER*/                                                28150002
         BR    R2                  .GO GET ANOTHER TASK                 29100001
         SPACE                                                          29150001
* RESET SECONDARY NON-DISPATCHABILITY FLAGS                             29200001
*/*SDRESET: P 'AND' SECONDARY BITS WITH INVERTED RESET MASK*/           29210002
SDRESET  N     R12,TCBNDSP             N OFF SECONDARY BITS             29250002
         ST    R12,TCBNDSP             STORE UPDATED FLAGS              29300002
*/* D (NO,PTEST,YES,) ALL SECONDARY BITS NOW OFF*/                      29310002
         BNZ   PTEST                   BR IF SOME STILL ON              29350002
*/*PBITOFF: P (,PTEST) TURN OFF PRIMARY SUMMARY BIT*/                   29400002
PBITOFF  NI    TCBFLGS5,OFF-TCBPNDSP .NO, RESET PRIM NON-DISP SUM FLAG  29500001
         B     PTEST               .GO TEST FOR POSSIBLE TASK SWITCH    29550001
         EJECT                                                          29750001
* SET NON-DISPATCHABILITY FLAG MANIPULATOR ROUTINES                     29800001
         SPACE                                                          29850001
*/*BITSET: S TCBRDYCT: APPLY -1 TO TCB READY COUNT*/                    29852002
BITSET   L     R9,FOXES                DELTA OF -1                      29860002
         BAL   R11,TCBRDYCT            GO TO ASCBTCBS UPDATE RTN        29870002
*/* D (NO,SDSET,YES,) PRIMARY BITS TO BE AFFECTED*/                     29872002
         LR    R12,R15                 COPY MASK REG INTO WORK REG      29880002
         TM    SWITCHES,PRIMARY    .IS 2NDARY MASK TO BE AFFECTED       29900002
         BNO   SDSET               .YES, BR                             29950002
         SPACE                                                          30000001
* SET PRIMARY NON-DISPATCHABILITY FLAGS                                 30050001
*/*NDSET2: P 'OR' PRIMARY BITS WITH SET MASK*/                          30060002
NDSET2   O     R12,TCBFLGS4            O INDICATED BITS ON              30100002
         STCM  R12,C8+C4,TCBFLGS4      STORE NEW NON-DISP FLGS          30150002
*/*SSET: S TCBRDYCT: APPLY +1 TO TCB READY COUNT*/                      30160002
SSET     LA    R9,C1                   DELTA OF +1                      30200002
         BAL   R11,TCBRDYCT            UPDATE CT NOW THAT BITS SET      30250002
*/*%D2: R RETURN TO CALLER*/                                            30300002
         BR    R2                  .GO GET ANOTHER TASK                 30650001
         SPACE                                                          30700001
* SET SECONDARY NON-DISPATCHABILITY FLAGS                               30750001
*/*SDSET: P 'OR' SECONDARY BITS WITH SET MASK*/'                        30760002
SDSET    O     R12,TCBNDSP             O SECONDARY BITS ON              30800002
         ST    R12,TCBNDSP             STORE NEW SET OF BITS            30850002
*/* D (YES,SSET,NO,) BITS ARE STILL ALL ZERO*/                          30860002
         BZ    SSET                    BR IF NONE ARE NOW ON            30900002
*/* P (,%D2) TURN ON PRIMARY SUMMARY BIT*/                              30910002
         OI    TCBFLGS5,TCBPNDSP       TURN ON PRIM SUM BIT             30950002
         BR    R2                      GO TO GET DESCENDANT             31000002
         TITLE 'IEAVSETS...AOS/2...ND,TCB, SD,TCB'                      31250001
*   THIS CODE IS ENTERED WHEN NONDISPATCHABLE TCB ADDRESS IS SPECIFIED. 31300001
*   IT SETS ALL DESCENDENTS OF THE SPECIFIED TCB NONDISPATCHABLE.       31350001
*   IF THE 'E' PARAMETER HAS BEEN SPECIFIED, ONLY THE TASK              31400001
*   EXPLICITLY IDENTIFIED IS SET NONDISPATCHABLE.                       31450001
         SPACE                                                          31500001
* NON-DISPATCHABILITY EXPLICIT TCB ROUTINE                              31550002
*/*NDETCB: E CODE 12*/                                                  31552002
NDETCB   EQU   *                   LABEL                                31560002
*/*SDETCB: E CODE 11*/                                                  31570002
*/* P TURN ON EXPLICIT TCB SWITCH*/                                     31580002
SDETCB   OI    SWITCHES,EXPLICIT       SET THE EXPLICIT SW              31600002
         SPACE 2                                                        31650001
* NON-DISPATCHABILITY TCB ROUTINE                                       31700002
*/*NDTCB: E CODE 5*/                                                    31702002
NDTCB    EQU   *                   LABEL                                31710002
*/*SDTCB: E CODE 10*/                                                   31720002
*/* D (YES,TCBND,NO,) REQUEST IS FOR PRIMARY ND*/                       31730002
SDTCB    LA    R8,C0(,R1)          .INIT TREESCAN REGS W/SELECTED TCB   31750002
         LR    R10,R8              .SET THE TCB REGISTER                31800001
         LA    R2,GETNEXT          .INIT SUBROUTINE LINK REG            31850001
         LR    R7,R15                  SAVE MASK ACROSS SIGP            31860002
         TM    SWITCHES,PRIMARY        TEST FOR ND/SD                   31870002
         BO    TCBND                  BR IF PRIMARY                     31880002
*/* D (YES,,NO,MAINTCB) MASK INCLUDES STOP TCB BIT*/                    31882002
         N     R15,STOPCHEK            SEE IF STOP TCB BIT IN 2NDY MASK 31890002
         BZ    MAINTCB             GO TO SET                            31894002
*/* D (YES,,NO,ABEND14F) BOTH EXPLICIT AND RESET */                     31894102
         TM    SWITCHES,EXPLICIT+UNDOIT    TEST FOR EXPL AND RESET      31894202
         BNO   ABEND14F            BR IF NOT BOTH               @Y02752 31894302
*/* P (,MAINTCB) RESET STOP COUNT IF ALREADY STOPPED */                 31902202
         L     R15,STOPCHEK        GET STOP BIT MASK            @Y02752 31904202
         N     R15,TCBNDSP         AND WITH SECONDARY BITS      @Y02752 31906202
         BZ    MAINTCB             BRANCH IF NOT SET            @Y02752 31908202
         MVI   TCBSTPCT,C0         SET TO ZERO                  @Y02752 31910202
         B     MAINTCB             CONTINUE                     @Y02752 31910302
*/*TCBND: D (YES,ABEND14F,NO,) MASK INCLUDES SET MC BIT*/               31910502
TCBND    N     R15,SMCCHEK              SEE IF SMC BIT IN PRIM MASK     31918402
         BNZ   ABEND14F                BR IF SO - ALSO ILLEGAL          31926302
*/*MAINTCB: S SIGPCPUS: CLEAR OTHER CPUS OUT OF A.S.*/         @ZA30358 31934240
MAINTCB  EQU   *                                               @ZA30358 31984240
         SPACE                                                          32084240
*        SIGPCPUS WAS FORMERLY CALLED ONLY FOR SET             @ZA30358 32134240
         BAL   R12,SIGPCPUS            CLEAR OTHER CPUS OUT OF @ZA30358 32184240
*                                      ADDRESS SPACE           @ZA30358 32234240
         LR    R15,R7                  RESTORE MASK            @ZA30358 32244240
*/* D (YES,CURRCHK,NO,) REQUEST IS FOR SET*/                   @ZA30358 32284240
         TM    SWITCHES,UNDOIT      .IS THIS A RESET                    32334240
         BNO   CURRCHK                 NO, GO TO SET BITS ON   @ZA30358 32384240
*/* P (,CURRCHK) INVERT MASK BITS FOR RESET*/                           32434240
         X     R15,FOXES               INVERT MASK FOR RESET            32484240
         B     CURRCHK                 GO TO MAINLINE                   32534240
         DROP  R10                                                      33100001
         TITLE 'IEAVSETS...AOS/2...STOP/START'                          33150001
*   THE FOLLOWING SECTION OF CODE VALIDITY CHECKS THE TCB ADDRESS       33200001
*   PASSED IN REGISTER 1 FOR USE IN THE STOP/START FUNCTION.            33250001
*   IF NO TCB ADDR WAS PASSED IN REG 1 THEN THE CURRENT TCB IS USED.    33300001
*                                                                       33350001
         SPACE                                                          33400001
         USING TCB,R9                                                   33450001
*  STOP/START PRE-PROCESSING                                            33500001
*/*PROCEED: E ENTRY CODES 6,7*/                                         33510002
PROCEED  LA    R1,C0(,R1)             .CLEAR HIGH ORDER BYTE OF TCB ADD 33520040
         SR    R2,R2                   INIT STOP-PENDING CT             33530040
         LR    R7,R1                   SAVE TCB ADDR ACROSS SIGPCPUS    33540040
*/* S SIGPCPUS: CLEAR OTHER CPUS OUT OF A.S.*/                          33550040
         SPACE                                                          33560040
*        SIGPCPUS WAS FORMERLY CALLED ONLY FOR STOP            @ZA30358 33570040
         BAL   R12,SIGPCPUS            CLEAR OUT OTHER CPUS             33590002
*/*NOSTOP: D (NO,SETEXIT,YES,) EXPLICIT TCB ADDR SPECIFIED*/            33590402
NOSTOP   LTR   R1,R7                   RESET AND TEST TCB ADDR          33592002
         BZ    SETEXIT                 IF ZERO, TARGET IS ALL SUBTASKS  33594002
*/* D (YES,STOPTEST,NO,) REQUEST VIA BRANCH ENTRY*/                     33644002
         LR    R10,R1              .INIT R10 IN CASE OF FOLLOWING BR'S  33700001
         TM    SWITCHES,BRANCH    .IS THIS A BRANCH ENTRY               33750002
         BO    STOPTEST           .YES, BYPASS VAL CHECK OF TCB ADDR    33800002
*/* D (YES,STOPTEST,NO,) CALLER SVC OLD PSW KEY IS SUPVR*/              33810002
         L     R7,TCBRBP-TCB(,R4)       GET CURRENT RB                  33850002
         TM    RBOPSW+C1-RBSECT(R7),KEYF  TEST KEY FIELD                33880002
         BZ    STOPTEST                BR IF SUPVR KEY                  33920002
*/* L (NO,BADTCB,YES,STOPTEST) FOUND SPECIFIED TCB ON CALLERS SUBTREE*/ 33930002
         LR    R10,R4              .INIT R10 FOR SCAN WITH CUR TCB ADDR 33950002
SEARCH   LR    R9,R10              .SET TCB REG                         34000002
         L     R10,TCBLTC          .LOAD A DAUGHTER                     34050001
SRCH1    LTR   R10,R10             .IS THERE A DAUGHTER/SISTER          34100001
         BZ    GETSIS              .NO, GO GET ONE                      34150001
TCBHIT   CR    R10,R1              .YES, IS THIS THE SPECIFIED TCB      34200001
         BE    STOPTEST            .YES, GO TO STOP OR START            34250002
         B     SEARCH              .NO, RESEARCH                        34300001
GETSIS   L     R10,TCBNTC          .LOAD THE SISTER                     34350001
         CR    R4,R9               .ARE WE BACK TO TOP OF TREE          34400001
         BE    BADTCB              .YES, THE SPECIFIED TCB WASN'T FOUND 34450001
GETMOM   L     R9,TCBOTC           .NO, LOAD THE MOTHER                 34500001
         B     SRCH1               .AND RESEARCH                        34550001
         SPACE 2                                                        34600001
*/*SETEXIT: S (NONE,OVER,NEXT,) IEATRSCN: GET NEXT TCB IN SUBTREE*/     34610002
SETEXIT  LR    R10,R4              .INIT R10 FOR SCAN                   34650001
         LR    R8,R4               .START SCAN FROM CURR TCB            34700001
STRTSCAN LA    R11,OVER                SET NO-MORE RETURN ADDR          34750002
         BAL   R14,IEATRSCN            GO FIND NEXT RELATIVE            34760002
*  RETURN HERE MEANS A RELATIVE WAS FOUND.  ITS ADDRESS IS IN R10.      34800001
*  RETURN TO THE ADDR IN R11 MEANS SCAN COMPLETED.                      34850001
*/*STOPTEST: S TCBRDYCT: APPLY -1 TO TCB READY COUNT*/                  34852002
STOPTEST L     R9,FOXES                DELTA OF -1                      34860002
         BAL   R11,TCBRDYCT            GO TO ASCBTCBS UPDATER           34870002
*/* S TESTSTOP: START/STOP PROCESSING ROUTINE*/                         34880002
         BAL   R14,TESTSTOP        .GO TO STOP OR START RTN             34900002
*/* S TCBRDYCT: APPLY +1 TO TCB READY COUNT*/                           34902002
         LA    R9,C1                   DELTA OF +1                      34910002
         BAL   R11,TCBRDYCT            GO TO ASCBTCBS UPDATER           34920002
*/*CKALTST: D (YES,,NO,SETEXIT) REQUEST IS FOR EXPLICIT TCB*/           34930002
CKALTST  LTR   R1,R1               IS THERE AN ADDR IN R1               34950002
         BZ    STRTSCAN            .NO, GO SCAN FOR MORE DECENDENTS     35000002
*/*OVER: D (NO,EXIT,YES,) ENTRY FOR SYNCH STOP*/                        35010002
OVER     TM    SWITCHES,SYNCHTCB       ENTRY FOR SYNCH STOP             35050002
         BZ    EXIT                BR IF NOT SYNCH                      35060002
*/* D (NO,SYNCHXIT,YES,) THERE ARE PENDING STOPS*/                      35062002
         LTR   R2,R2               ARE ANY STOPS PENDING                35070002
         BZ    SYNCHXIT            BR IF NO NEED TO WAIT                35075002
*/* S TCBRDYCT: APPLY DELTA OF -1*/                                     35080102
Q28      L     R10,PSATOLD         ADDR OF CURRENT TCB                  35080202
         L     R9,FOXES            DELTA OF -1                          35084202
         BAL   R11,TCBRDYCT        GO TO ASCBTCBS UPDATER               35090202
*/* P TURN ON TCB AND RB SYNCH BITS- SET RB WAIT CT*/                   35094802
         L     R7,TCBRBP-TCB(,R4)       GET ADDR OF RB TO WAIT          35099402
         S     R7,CRBPRFXL             ADJUST ADDR TO PREFIX            35104002
         OI    RBFLAGS1-RBPRFX(R7),RBSSSYN SET SYNCH BIT IN WAITING RB  35108602
         LA    R7,RBPRFXLN(,R7)         RESET TO RBSECT                 35113202
         STC   R2,RBWCF-RBSECT(,R7)     STORE WAIT COUNT                35117202
         OI    TCBFBYT2-TCB(R4),TCBSSSYN SET SUMMARY BIT IN TCB         35122402
*/*SYNCHXIT: D (YES,BREXIT,NO,EXIT) BRANCH ENTRY TO SYNCH*/             35127002
SYNCHXIT TM    SWITCHES,BRANCH         TEST FOR BRANCH ENTRY            35131602
         BO    BREXIT                  BR IF BRANCH ENTRY               35136202
         B     EXIT                SVC, BR                              35140802
         DROP  R9                                                       35145402
         EJECT                                                          35150001
*   THE FOLLOWING CODE IS ENTERED ON BEHALF OF THE STOP/START OPTION.   35200001
*   THIS CODE SETS OR RESETS THE STOP/START                             35250001
*   SECONDARY NON-DISPATCHABILITY BIT.  IF NO SECONDARY NON-            35300001
*   DISPATCHABILITY BITS ARE SET THE PRIMARY NON-DISPATCHABILITY        35350001
*   BIT IS RESET.  THE TCB STOP/START COUNT IS ALSO MAINTAINED          35400001
         SPACE                                                          35450001
*/*TESTSTOP: E ADJ TCB BITS */                                 @Z40FPYK 35455040
*/* N ADJUST START STOP COUNT */                               @Z40FPYK 35456040
*/* N ADJUST SD/ND BITS */                                     @Z40FPYK 35457040
*/* D (YES,STCBSTAR,NO,) REQUEST FOR START*/                            35460002
TESTSTOP TM    ACTCODE,START       .IS THIS A START                     35500001
         BO    STCBSTAR            .YES GO TO START                     35550001
         SPACE                                                          35600001
*  STOP ROUTINE                                                         35650001
         USING TCB,R10                                                  35700001
*/*STCBSTOP: P INCREMENT STOP TCB COUNT IN STOPPED TCB */               35710002
*/* N ABEND IF COUNT WRAPS FROM X'FF'             */            @Y02753 35720002
STCBSTOP IC    R12,TCBSTPCT        .GET STOP/START COUNT                35750001
         TM    TCBSTPCT,OFF        TEST FOR WRAP CONDITION     @YM00217 35752002
         BO    ABEND14F            ABEND IF GOING TO WRAP      @YM00217 35756002
         LA    R12,R1(,R12)         .INCREMENT THE COUNT                35800002
         STC   R12,TCBSTPCT        .STORE NEW COUNT                     35850001
*/*TESTRB: D (YES,SETWCPLT,NO,) ATTNS DEFERRED BIT IS ON IN TCB*/       35860002
TESTRB   TM    TCBTSFLG,TCBATT     .ARE ATTENTION EXITS BLOCKED         35900001
         BO    SETWCPLT            .YES                                 35950001
*/* STPPON: P TURN ON STOP BIT AND PRIMARY SUMMARY BIT*/                35960002
STPPON   OI    TCBNDSP2,TCBSTPP    .SET THE STOP FLAG                   36000001
         OI    TCBFLGS5,TCBPNDSP   .SET PRIMARY NON-DISPATCH FLAG       36050001
*/*%D3: R RETURN TO CALLER*/                                            36060002
         BR    R14                 .RETURN TO STOP CALLER               36100001
*/*SETWCPLT: P  TURN ON STOP PENDING BIT*/                              36110002
SETWCPLT OI    TCBTSFLG,TCBSTPPR   .SET STOP PENDING FLAG               36150001
*/* D (YES,%D3,NO,) HAS TASK TERMINATED */                              36152002
         TM    TCBFLGS5,TCBFC       IS TASK TERMINATED         @YM04151 36154002
         BOR   R14                  YES,RETURN AND DONT INCR CT@YM04151 36156002
*/* P (,%D3) INCR COUNT OF STOP PENDING TASKS FOR STOP SYNCH*/          36158002
         LA    R2,C1(,R2)           .BUMP STOP-PENDING CT               36160002
         BR    R14                 .RETURN TO STOP CALLER               36200001
         SPACE 2                                                        36250001
* START ROUTINE                                                         36300001
*/*STCBSTAR: D (YES,STOPOFF,NO,) STOP COUNT IS ALREADY ZERO*/           36310002
STCBSTAR CLI   TCBSTPCT,R0         .IS STOP/START COUNT 0               36350001
         BE    STOPOFF             .YES, RESET STOP PENDING FLAG        36400001
*/* P DECREMENT STOP COUNT */                                           36402002
         SR    R12,R12                 CLEAR WORK REG                   36410002
         IC    R12,TCBSTPCT        .GET STOP/START COUNT                36450001
         BCTR  R12,R0              .DECREMENT THE COUNT                 36500002
         STC   R12,TCBSTPCT        .STORE IT                            36550001
*/* D (NO,%D3,YES,) STOP COUNT IS NOW ZERO*/                            36560002
         LTR   R12,R12             .IS STOP/START COUNT NOW 0           36600002
         BNZR  R14              .NO, RETURN TO START CALLER             36650002
*/*STOPOFF: P TURN OFF STOP BIT AND STOP PENDING BIT*/                  36660002
*/* D (NO,%D3,YES,) ALL SECONDARY BITS ARE NOW OFF*/                    36670002
STOPOFF  NI    TCBTSFLG,OFF-TCBSTPPR     .YES, RESET STOP PEND FLAG     36700001
         NI    TCBNDSP2,OFF-TCBSTPP      .RESET THE STOP FLAG           36750001
         C     R12,TCBNDSP          ANY 2NDARY NON-DISP FLAGS ON?       36800002
         BNZR  R14                 .YES, RETURN TO START CALLER         36850002
*/* P (,%D3) TURN OFF PRIMARY SUMMARY BIT*/                             36860002
         NI    TCBFLGS5,OFF-TCBPNDSP   .NO, RESET PRIM NON-DISP FLAG    36900002
         BR    R14                 .RETURN TO START CALLER              37150002
         DROP  R10                                                      37200001
         TITLE 'IEAVSETS...AOS/2...SYNCHRONOUS STOP SUBTASKS'           37202002
*/*SYNCH: E CODE 14*/                                                   37202402
*/* P (,PROCEED) TURN ON SYNCH TCB SWITCH- INDICATE ALL SUBTASKS*/      37202802
SYNCH    OI    SWITCHES,SYNCHTCB       SET SYNCH STOP BIT               37204002
         SR    R1,R1                   INDICATE ALL SUBTASKS TO STOP    37206002
         NI    SWITCHES,OFF-UNDOIT     CLEAR RESET INDICATOR   @YM08379 37207002
         B     PROCEED                 GO TO STOP CODE                  37208002
         SPACE 2                                                        37208402
*/*IEAVESSS: E SYNCH EP FOR EXIT*/                                      37208502
         ENTRY IEAVESSS                                                 37209102
*/* P SAVE AND SET UP REGS*/                                            37212802
IEAVESSS L     R15,PSAAOLD             ASCB                             37213402
         L     R15,ASCBASXB-ASCB(,R15)  ASXB                            37214002
         L     R15,ASXBSPSA-ASXB(,R15)  WSA TBL                         37214602
         L     R15,WSALSTAT-WSAL(,R15)  STATUS WSA                      37215202
         STM   R0,R14,C0(R15)          SAVE REGS                        37215802
         BALR  R6,R0                    BOOTSTRAP ADDRESSABILITY        37216402
         USING *,R6                                                     37217002
         L     R6,AIGC079          .LOAD NEW BASE REG                   37217602
         USING IGC079,R6                                                37218202
         LR    R5,R15                  WSA BASE                         37218802
         LR    R3,R7                   ASCB BASE                        37219402
*/* P GET MOTHER OF CURRENT TCB*/                                       37220002
         L     R10,TCBOTC-TCB(,R4)       GET NEXT TCB UP                37220602
*/*CHKTCBSS: D (NO,NEXTUP,YES,) THIS TCB WAITING FOR STOP*/             37221202
CHKTCBSS TM    TCBFBYT2-TCB(R10),TCBSSSYN THIS TCB WAITING ON STOPS     37221802
         BZ    NEXTUP                  BR IF NOT                        37222402
*/* P RESET TCB SYNCH BIT */                                            37222602
         NI    TCBFBYT2-TCB(R10),OFF-TCBSSSYN RESET TCB BIT    @YM06115 37222802
*/* S TCBRDYCT: APPLY DELTA OF -1*/                                     37223002
         L     R9,FOXES                DELTA OF -1                      37223602
         BAL   R11,TCBRDYCT            GO TO ASCBTCBS UPDATER           37224202
*/* P GET ADDR OF TOP RB*/                                              37224802
         L     R7,TCBRBP-TCB(,R10)      ADDR OF TOP RB                  37225402
*/*CHKRBSSS: D (NO,NEXTOVER,YES,) THIS RB WAITING FOR STOP*/            37226002
CHKRBSSS S     R7,CRBPRFXL             ADJUST TO PREFIX                 37226402
         TM    RBFLAGS1-RBPRFX(R7),RBSSSYN THIS RB WAITING ON STOPS     37226602
         LA    R7,RBPRFXLN(,R7)         RESET TO RBSECT                 37227002
         BZ    NEXTOVER                BR IF NOT                        37227202
*/* P DECREMENT RB WAIT COUNT*/                                         37227402
         IC    R2,RBWCF-RBSECT(,R7)     GET WAIT COUNT                  37233402
         BCTR  R2,R0                   DECR                             37239802
         STC   R2,RBWCF-RBSECT(,R7)     RESET RB WAIT COUNT             37241002
*/* D (YES,NEXTOVET,NO,) COUNT IS NOW ZERO*/                            37242802
         CLI   RBWCF-RBSECT(R7),C0     IS COUNT NOW ZERO       @YM02758 37243402
         BE    NEXTOVET                BR IF YES               @YM06115 37245202
*/* P (,NEXTOVER) SET TCB SYNCH BIT */                                  37245802
         OI    TCBFBYT2-TCB(R10),TCBSSSYN SET TCB BIT          @YM06115 37246402
         B     NEXTOVER            GO TO NEXT RB               @YM06115 37248202
*/*NEXTOVET: P TURN OFF SYNCH BIT IN RB */                              37248802
NEXTOVET S     R7,CRBPRFXL         ADJUST TO PREFIX            @YM06115 37250002
         NI    RBFLAGS1-RBPRFX(R7),OFF-RBSSSYN RESET RB SYNCH BIT       37251202
         LA    R7,RBPRFXLN(,R7)         RESET TO RBSECT                 37251902
*/*NEXTOVER: D (YES,CHKRBSSS,NO,) NEXT ELEMENT IS RB*/                  37254002
NEXTOVER TM    RBSTAB2-RBSECT(R7),RBTCBNXT TCB IS NEXT ON CHAIN         37254702
         L     R7,RBLINK-RBSECT(,R7)    TO NEXT RB IF ANY               37255402
         BZ    CHKRBSSS                BR IF ANOTHER RB                 37256802
*/* S TCBRDYCT: APPLY DELTA OF +1*/                                     37257502
         LA    R9,C1                   DELTA OF +1                      37258902
         BAL   R11,TCBRDYCT            GO TO ASCBTCBS UPDATER           37259602
*/*NEXTUP: P GET NEXT TCB FROM TCBOTC*/                                 37261702
NEXTUP   L     R10,TCBOTC-TCB(,R10)     ADDR OF NEXT UP TCB             37262402
*/* D (YES,CHKTCBSS,NO,) THERE IS ANOTHER TCB*/                         37263802
         LTR   R10,R10                 IS THERE ANOTHER                 37264502
         BNZ   CHKTCBSS                BR IF THERE IS A TCB             37265202
*/* P RESTORE REGS FROM WSA*/                                           37266602
         LM    R0,R14,WSA              RESTORE REGS                     37267502
*/* R RETURN TO EXIT*/                                                  37268402
         BR    R14                 RETURN TO EXIT                       37270202
         TITLE 'IEAVSETS...AOS/2...STOP/START SRBS'                     37271102
*   THE FOLLOWING CODE IS THE INFAMOUS STATUS STOP/START SRB ROUTINE.   37272002
*   IT CAUSES THE QUIESCING AND RESTARTING OF SYSTEM LEVEL SRBS WITHIN  37273802
*   AN ADDRESS SPACE.                                                   37274702
         SPACE                                                          37275602
*/*SRBS: E CODE 13*/                                                    37276602
*/* D (YES,STARTSRB,NO,) REQUEST IS FOR START*/                         37277602
SRBS     LTR   R1,R1                   TEST FOR START OR STOP           37278602
         BM    STARTSRB                BR IF SIGN BIT ON - MEANS START  37279602
*/* S SIGPCPUS: CLEAR OTHER CPUS OUT OF A.S.*/                          37280602
*/* P GET FIRST TCB IN A.S. TCB Q*/                                     37281602
         LR    R9,R14                  SAVE RETURN ADDR ACROSS CALL     37282602
         BAL   R12,SIGPCPUS            BR TO CLEAR OUT OTHER CPUS       37284302
         LR    R14,R9                  RESTORE REG 14                   37285302
         L     R10,ASCBASXB            ADDR OF ASXB                     37286302
         L     R10,ASXBFTCB-ASXB(,R10)  TOP TCB IN A.S.                 37287002
*/*SRBSTCBS: D (YES,DOWNQ,NO,) THIS IS CURRENT TCB*/                    37288302
SRBSTCBS CR    R10,R4                  AT THE CURRENT TCB               37289602
         BE    DOWNQ                   YES, SKIP TO NEXT TCB            37290902
*/* S TCBRDYCT: APPLY -1 TO TCB READY COUNT*/                           37291902
         L     R9,FOXES                DELTA OF -1                      37292902
         BAL   R11,TCBRDYCT            GO TO ASCBTCBS UPDATER           37293902
*/* P TURN ON STOP SRB BIT AND PRIMARY SUMMARY BIT IN TCB*/             37294902
         OI    TCBNDSP3-TCB(R10),TCBSRBND   TCB ND WHILE SRBS STOPPED   37296102
         OI    TCBFLGS5-TCB(R10),TCBPNDSP  SET PRIMARY SUMMARY BIT      37297402
*/*DOWNQ: P GET ADDR OF NEXT SUBTASK*/                                  37298702
DOWNQ    L     R10,TCBTCB-TCB(,R10)     NEXT TCB ON RDY Q               37300002
*/* D (YES,SRBSTCBS,NO,) MORE TCBS ON Q*/                               37301302
         LTR   R10,R10                 TEST FOR END OF Q                37301902
         BNZ   SRBSTCBS                BR IF MORE TCBS                  37302602
QJFY1    L     R3,CVTPTR           GET ADDR OF CVT              @Y02753 37303902
         MVC   WSA+C4*R14(C4),CVTEXP1-CVTMAP(R3) FORCE DISP ENT @Y02753 37305203
*/* S SETLOCK: OBTAIN DISPATCHER LOCK*/                                 37306502
Q16      SETLOCK OBTAIN,TYPE=DISP,MODE=UNCOND,RELATED=QK17B             37307802
*/* P INCREMENT STOP SRB COUNT IN ASCB */                               37308402
         L     R3,PSAAOLD          GET ADDRESS OF ASCB          @Y02753 37309102
         LH    R7,ASCBSSRB         GET STOP SRB CT                      37310402
         LA    R7,C1(,R7)               INCR CT                         37311702
         STH   R7,ASCBSSRB             SET NEW CT                       37312702
*/* P SET EXIT REG 9 TO EXIT*/                                          37314302
         LA    R9,EXIT                 SET EXIT REG                     37315602
*/* D (NO,RELDISPL,YES,) ARE ANY SRBS RUNNING*/                         37316202
         CH    R10,ASCBSRBS            TEST FOR ANY RUNNING SRBS        37316902
         BZ    RELDISPL                BR IF NONE TO CALLER RIGHT AWAY  37318202
*/* P SET BIT IN ASCB MAKING ALL TCBS NDISP*/                           37319202
         OI    ASCBFLG1,ASCBSTND       SET TCBS ND WHILE COUNTING DOWN  37320202
*/* P SET PSAANEW TO ZERO*/                                             37321402
Q17      ST    R10,PSAANEW             SET PSAANEW TO ZERO FOR DISP     37322402
*/*     R BR REG 9*/                                                    37322803
         BR R9                         RETURN                  @YA02383 37323203
*/*RELDISPL: S SETLOCK: RELEASE DISPATCHER LOCK */                      37323802
RELDISPL EQU   *                   LABEL                                37324802
QK17B    SETLOCK RELEASE,TYPE=DISP,RELATED=(Q16,SSRBTEST)               37325802
*/*%D4: R BR REG 9*/                                                    37326802
         BR    R9                      OUT                              37328802
         SPACE                                                          37328902
*/*STARTSRB: D (NO,SSRBTEST,YES,) ASID IS SPECIFIED*/                   37329902
STARTSRB SLA   R9,C2                   MULT ASID BY FOUR                37332002
         BZ    SSRBTEST                BR IF NONE SUPPLIED              37332802
*/* P GET ASCB ADDR USING ASID AND ASVT*/                               37333602
Q18      L     R3,CVTPTR               ADDR OF CVT                      37334602
         L     R3,CVTASVT-CVTMAP(,R3)      ADDR OF ASVT                 37335602
         L     R3,ASVTENTY-ASVT-C4(R3,R9) ASID IS INDEX TO ASCB ADDR    37336602
*/*SSRBTEST: S SETLOCK: OBTAIN DISPATCHER LOCK*/                        37337602
SSRBTEST SETLOCK OBTAIN,TYPE=DISP,MODE=UNCOND,RELATED=(QK17B,STQP)      37339202
*/* P SET RETURN REG 9 TO EXIT*/                                        37340702
         LA    R9,EXIT                 SET RETURN ADDR                  37341002
*/* D (NO,DECRSSRB,YES,RELDISPL) STOP SRB COUNT IS ALREADY ZERO*/       37342802
         LH    R7,ASCBSSRB             GET STOP SRB CT                  37343202
         LTR   R7,R7               TEST IF ZERO ALREADY         @Y02753 37344602
         BNZ   DECRSSRB                BR IF NOT NOW ZERO               37346402
TESTLOCK B     RELDISPL                GO TO RELEASE DISP LOCK          37346802
*/*DECRSSRB: P DECREMENT STOP SRB COUNT*/                               37348202
DECRSSRB BCTR  R7,R0                   DECR CT IN REG                   37349102
         STH   R7,ASCBSSRB             SET CT IN ASCB                   37350002
*/* D (NO,RELDISPL,YES,) COUNT IS NOW ZERO*/                            37351002
         LTR   R7,R7                   NOW CT IS ZERO                   37352502
         BNZ   RELDISPL                NO, EXIT                         37353502
*/* P TURN OFF ASCBSTND ENSURING TCBS CAN RUN; RESET ASCBSNQS*/         37354502
         NI    ASCBFLG2,OFF-ASCBSNQS   RESET TO LET NQ SRBS RUN @Y02752 37355502
         NI    ASCBFLG1,OFF-ASCBSTND   ENSURE TCBS DISPATCHABLE         37356502
*/* S SETLOCK: RELEASE DISP LOCK*/                                      37357502
         BAL   R9,RELDISPL             RELEASE DISP LOCK AND COME BACK  37358502
*/* D (YES,EXIT,NO,) INVOKED BY SWAP-IN? */                    @YM08338 37358702
         L     R13,STFRRSAV        GET FRR PARM ADDR           @YM08338 37358802
         TM    STFRFLG,STFRSWIN    INVOKED BY SWAP-IN?         @YM08338 37358902
         BO    EXIT                SKIP MAKING TCBS DISP.      @YM08338 37359102
*/*SRBFRRT: D (YES,DOSLOCAL,NO,) THIS A REQUEST FOR CURRENT MEMORY*/    37359502
SRBFRRT  LH    R0,WSA              GET INPUT R0-ASID           @YM01997 37360502
         LTR   R0,R0               TEST FOR ZERO-CURRENT       @YM01997 37361502
         BZ    DOSLOCAL            BR IF A LOCAL REQUEST       @YM01997 37364002
         LA    R0,SRBSIZE+C4+C4+C4 SIZE OF SRB                 @YM01997 37364402
         LR    R7,R3               SAVE ASCB ADDR                       37372002
*/* S SETLOCK: OBTAIN SALLOC LOCK */                                    37372502
Q19      SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=Q11             37373002
*/* S GETMAIN: GET SRB TO FINISH START SRBS*/                           37374002
Q20      GETMAIN RU,LV=(0),SP=245,BRANCH=(YES,GLOBAL)                   37376702
*/* D (YES,NORLS,NO,) CALLER ALREADY HELD SALLOC LOCK*/                 37377302
         L     R13,STFRRSAV        GET FRR PARM ADDR            @Y02752 37378502
         TM    STFRFLG,STFRSALL    TEST FOR SALL LOCK ON ENTRY  @Y02752 37380502
         BNZ   NORLS                   BR IF CALLER ALREADY HELD IT     37382602
*/* S SETLOCK: RELEASE SALLOC LOCK*/                                    37383602
Q11      SETLOCK RELEASE,TYPE=SALLOC,RELATED=Q19                        37384602
*/*NORLS: P SET UP SRB FOR START SRBS*/                                 37385602
NORLS    LR    R3,R7                   RESET ASCB ADDR                  37388302
         USING SRB,R1                                                   37389902
         XC    SRB(SRBSIZE),SRB         CLEAR OUT FIELDS                37391902
         ST    R3,SRBASCB              TARGET ADDR SPACE                37393502
         LA    R7,SRBEPSRB             SRB ROUTINE ENTRY PT             37396002
         ST    R7,SRBEP                SET UP IN SRB                    37396302
         LA    R7,RMTRADDR         STATUS RMTR ADDR            @YM02662 37397802
         ST    R7,SRBRMTR              FOR RMTR ADDR                    37398802
Q46      L     R10,PSATOLD             GET CURRENT TCB ADDR             37399802
         LH    R9,ASCBASID             CURRENT ASID                     37400802
         LTR   R10,R10                 IN SRB MODE                      37401802
         BNZ   SRBSCHED                 BR IF IN TCB MODE               37407202
Q47      L     R10,PSALCCAV            GET POINTER TO LCCA              37408102
         LM    R9,R10,LCCASRBF-LCCA(R10) PICK UP ASSOCIATED TCB/ASID    37409102
SRBSCHED STM   R9,R10,SRBFLC           SET UP PARENT TCB/ASID IDS       37410102
*/* S (,EXIT) SCHEDULE: SCHEDULE SRB- EP=SRBEPSRB*/                     37413102
Q21      SCHEDULE SRB=(1),SCOPE=LOCAL                                   37414102
         DROP  R1                                                       37415102
         B     EXIT                      OUT                            37418202
*/*DOSLOCAL: S (,EXIT) SRBFRD0: SET TCBS DISPATCHABLE*/                 37419502
DOSLOCAL BAL   R7,SRBFRD0          LINK TO SET TCBSDISP        @YM01997 37419902
         B     EXIT                LEAVE                       @YM01997 37420302
         SPACE                                                          37420802
         USING *,R15                                                    37421402
*/*SRBEPSRB: E SRB ENTRY FOR START SRBS*/                               37422102
SRBEPSRB L     R6,AIGC079              LOAD COMMON BASE ADDR            37423402
         DROP  R15                                                      37427302
*/* S SETLOCK: OBTAIN LOCAL LOCK*/                                      37428602
Q25      L     R3,PSAAOLD              GET CURRENT ASCB ADDR            37431202
Q26      SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=Q27              37432502
*/* S SETFRR: SET FRR COVERAGE */                                       37433802
QZJ67    SETFRR A,FRRAD=ASTNFRR,PARMAD=(R13),WRKREGS=(R8,R2)            37435102
         OI    STFRFLG,REFRR       SET FLAG FOR RECOVERY RTN            37436402
         ST    R0,STFRSVSB         SET ADDRESS OF SRB FOR FRR           37437702
         LR    R1,R0               PUT ADDRESS IN REG 1 FOR FREEMAIN    37440302
*/*SRBFRTRY: S (,SRBFRD00) SRBFRD0: SET TCBS DISPATCHABLE*/             37441602
SRBFRTRY LA    R7,SRBFRD00         LINK ADDR                   @YM01997 37442902
*/*SRBFRD0: E SET TCBS DISPATCHABLE RTN*/                               37443502
*/* P GET TOP TCB IN ADDR. SPACE*/                                      37444202
SRBFRD0  L     R10,ASCBASXB        GET ADDR OF ASXB            @YM01997 37445002
         L     R10,ASXBFTCB-ASXB(,R10)  GET TOP TCB ADDR       @YM01997 37445902
*/*SRBEPRDY: S TCBRDYCT: APPLY -1 TO READY TCB COUNT*/                  37446302
SRBEPRDY L     R9,FOXES                DELTA OF -1                      37448102
         BAL   R11,TCBRDYCT            GO TO ASCBTCBS UPDATER           37448902
*/* P TURN OFF STOP SRB BIT IN TCB*/                                    37452002
         NI    TCBNDSP3-TCB(R10),OFF-TCBSRBND  TURN OFF NON-DISP BIT    37453302
*/* D (NO,SRBEPTCB,YES,) ALL SECONDARY BITS ARE NOW OFF*/               37454602
         SR    R8,R8                   ZERO FOR COMP                    37455902
         C     R8,TCBNDSP-TCB(,R10)     SECONDARY BITS ALL 0            37457202
         BNE   SRBEPTCB                BR IF NOT                        37458502
*/* P TURN OFF PRIMARY SUMMARY BIT*/                                    37461102
         NI    TCBFLGS5-TCB(R10),OFF-TCBPNDSP  YES, RESET SUMMARY BIT   37462402
*/* S TCBRDYCT: APPLY +1 TO READY TCB COUNT*/                           37463702
         LA    R9,C1                   DELTA OF +1                      37465002
         BAL   R11,TCBRDYCT            GO TO ASCBTCBS UPDATER           37467602
*/*SRBEPTCB: P GET NEXT TCB ON A.S. READY Q*/                           37468902
SRBEPTCB L     R10,TCBTCB-TCB(,R10)     NEXT TCB ON RDY Q               37470202
*/* D (YES,SRBEPRDY,NO,) THERE IS ANOTHER TCB*/                         37472802
         LTR   R10,R10                 ARE THERE ANY MORE               37474102
         BNZ   SRBEPRDY                BR IF MORE                       37475402
         BR    R7                  RETURN                      @YM01997 37476702
SRBFRD00 EQU   *                   LABEL                       @YM01997 37477102
*/*SRBFRD00: S SETFRR: DELETE FRR COVERAGE */                   @Y02753 37477502
QJZ2     SETFRR D,WRKREGS=(R8,R2)                               @Y02753 37478002
*/* P (,EXFRITL) FREE SRB AND RELEASE LOCAL LOCK*/                      37479302
QJZRL    B     EXFRITL             BR TO FREE SRB AND LOCK     @YM02662 37488402
         TITLE 'IEAVSETS...AOS/2... BR ENTRY FOR STARTSRBS'             37497502
         ENTRY IGC07903                                         @Y02752 37498802
*/*IGC07903: E START SRBS BR ENTRY*/                            @Y02752 37500102
*/* P (,STARTSRB) SAVE CALLER REGS, SET UP ENVIRNM. REGS*/              37502702
*                                                                       37504002
*        THIS ROUTINE IS BRANCH ENTERED TO DO A START SRB FUNCTION      37505302
*        SEE PROLOGUE FOR ENTRY REQUIREMENTS                            37506602
*                                                                       37509202
         DROP  R6                                                       37510502
         USING IGC07903,R15                                             37511802
IGC07903 STM   R0,R14,C0(R13)      SAVE REGS                    @Y02752 37514402
         L     R6,AIGC079          GET BASE REG                 @Y02752 37515702
         DROP  R15                                              @Y02752 37517002
         USING IGC079,R6                                        @Y02752 37518302
         LR    R9,R0               SETASID REG                  @Y02752 37519602
         SRL   R9,C16              ADJUST FOR TEST              @Y02752 37520902
         L     R3,PSAAOLD          SET  CURRENT ASCB ADDR       @Y02752 37523502
         SR    R15,R15             CLEAR                        @Y02752 37524802
         ST    R15,R15*C4(,R13)    SET ZERO RET CODE            @Y02752 37526102
         LR    R5,R13              SET SAVE AREA ADDR REG       @Y02752 37527102
         USING WSA,R5                                           @Y02752 37528102
         MVI   SWITCHES,C0         CLEAR, ASSURE BR ENTRY EXIT  @Y02752 37529102
QJYF0    SETFRR A,FRRAD=ASTNFRR,PARMAD=(R13),WRKREGS=(R8,R2)    @Y02752 37532402
QJYF00   ST    R13,STFRRSAV        SAV PARM AREA ADDR           @Y02752 37534502
         OI    STFRFLG,STFRSALL+STBRSRB+STFRSWIN  SALLOC LOCK, BRANCH  X37536602
                                   ENTRY, INVOKED BY SWAP-IN   @YM08338 37537602
         B     STARTSRB            GO TO STARTSRB RTN           @Y02752 37538702
         TITLE 'IEAVSETS...AOS/2...SET CALLER TCB ND,SD'                37540802
*   THIS ROUTINE APPLIES THE GIVEN MASK OF NON-DISPATCHABILITY BITS TO  37542902
*   THE CALLING TCB AND THEN INTERFACES TO THE DISPATCHER.              37543902
         SPACE                                                          37545002
*/*CALLER: E CODE 15,16*/                                               37547102
CALLER   LR    R10,R4                  CURRENT TCB ADDRESS              37549202
*/* S BITSET: SET NDISP BITS ON*/                                       37550202
         BAL   R2,BITSET               GO TO BIT SETTING ROUTINE        37551302
*/*BREXIT: P DISABLE CURRENT PSW USING STNSM*/                          37553402
BREXIT   STNSM C0(R5),OFF-C2-C1        DISABLE TO ENTER DISP            37555502
*/* S SETFRR: PURGE EXISTING FRR STACK*/                                37557602
Q29      SETFRR P,WRKREGS=(R7,R8)      PURGE FRR STACK                  37558602
*/* S SETLOCK: RELEASE LOCAL LOCK*/                                     37559702
Q30      SETLOCK RELEASE,TYPE=LOCAL,RELATED='INPUT REQUIREMENT'         37561802
*/* R DISPATCHER IEA0DS*/                                               37563902
         L     R15,DISPTCHR            GET ENTRY POINT IEA0DS           37564902
         BR    R15                     GO TO DISPATCHER                 37566002
         EJECT                                                          37568102
*/*XMGO: S SETLOCK: OBTAIN SALLOC LOCK*/                                37570202
XMGO     SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=Q33             37571202
*/* S GETMAIN: GET SRB FOR XMSTATUS OPERATION*/                         37572302
         LR    R10,R15                 SAVE                             37574402
         LR    R11,R0                      PARM                         37576502
         ICM   R11,C2,SWITCHES         SAVE FLAGS FOR XMSTATUS          37577502
         LR    R12,R1                          REGS                     37578602
         LA    R0,SRBSIZE+C4+C4+C4     SIZE OF SRB                      37580702
         LR    R2,R3                   SAVE ASCB BASE REG               37582802
Q32      GETMAIN RU,LV=(0),SP=245,BRANCH=(YES,GLOBAL)                   37583802
         USING SRB,R1                                                   37584902
         LR    R3,R2                   RESET ASCB BASE                  37587002
         STM   R10,R12,SRBEND          SET UP PARMS                     37589102
*/* S SETLOCK: RELEASE SALLOC LOCK*/                                    37591102
Q33      SETLOCK RELEASE,TYPE=SALLOC,RELATED=XMGO                       37592002
*/*OWNEDSAL: P INIT FIELDS IN XMSTATUS SRB*/                            37592902
OWNEDSAL XC    SRB(SRBSIZE),SRB        ZERO MAIN PART OF SRB            37594902
         SLA   R9,C2                   MULTIPLY ASID BY FOUR            37597302
Q34      L     R10,CVTPTR              GET ADDR OF CVT                  37598402
         L     R10,CVTASVT-CVTMAP(,R10)    ADDR OF ASVT                 37600002
         L     R15,ASVTENTY-ASVT-C4(R9,R10)  ADDR OF DESIRED ASCB       37602002
         ST    R15,SRBASCB             SET TARGET ASCB ADDR IN SRB      37603002
         LA    R9,XMENTRY              XM STATUS ENTRY POINT            37605602
         LA    R10,RMTRADDR            RMTR ADDR                        37606302
         STM   R9,R10,SRBEP            SET IN SRB                       37607402
Q35      L     R10,PSATOLD             GET CURRENT TCB ADDR             37609202
         LH    R9,ASCBASID             CURRENT ASID                     37611002
         LTR   R10,R10                 IN SRB MODE                      37612802
         BZ    NOASTCB                 BR IF IN SRB MODE       @YM06167 37614602
*                                      TASK MODE                        37615502
Q36      CH    R9,ASCBASID-ASCB(,R15)  SCHEDULE TO CURRENT A.S.@YM06167 37616402
         BE    NOASTCB                 YES, OMIT ASSOCIATION   @YM06167 37617002
*   NOTE THAT THE SRB IS ONLY ASSOCIATED WITH THE ISSUING TCB/ASID FOR  37617302
*   A TASK MODE CROSS MEMORY FUNCTION TO OTHER THAN THE CURRENT A.S.    37617602
*   THIS AVOIDS HAVING A SCHEDULED SRB PURGED AT TASK TERMINATION (IF   37617802
*   IT HAD NOT YET BEEN DISPATCHED). ALSO NOTE, NOW SOME SRBS DO NOT    37618002
*   CONTAIN ISSUER INFORMATION SUCH THAT AN SRB FAILURE CAN BE RELATED  37618202
*   BACK TO THE ISSUING TASK.                                  @YM06167 37620902
         STM   R9,R10,SRBFLC           SET ASSOCIATION FIELDS  @YM06167 37621302
NOASTCB  LA    R9,SRBEND               PARM ADDR                        37621802
         ST    R9,SRBPARM              SET ADDR                         37623602
*/* S (,EXIT) SCHEDULE: XMSTATUS SRB- EP=XMENTRY*/                      37625402
Q37      SCHEDULE SRB=(1),SCOPE=LOCAL                                   37627202
         B     EXIT                    DONE                             37628102
         SPACE 3                                                        37629002
         USING *,R15                                                    37630802
*/*XMENTRY: E SRB ENTRY FOR XMSTATUS OTHER THAN START SRBS*/            37632602
*/* S SETLOCK: OBTAIN LOCAL LOCK*/                                      37633502
XMENTRY  SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=Q41              37634402
*/* S SETFRR: SET FRR COVERAGE */                                       37636202
QXMJ     SETFRR A,FRRAD=ASTNFRR,PARMAD=(R13),WRKREGS=(R8,R3)            37638002
QXMRJ    DS    0H                  TEST LABEL                   @Y02752 37639802
         ST    R0,STFRSVSB         SAVE SRB ADDR IN FRR PARM    @Y02752 37640702
*/*XMRTRY: P (,NOTSTP) BOOTSTRAP REGS AND SWITCHES FOR XMSTATUS*/       37642602
XMRTRY   DS    0H                  TEST LABEL                   @Y02752 37643302
Q43      L     R3,PSAAOLD              CURRENT ASCB ADDR                37644102
         L     R5,ASCBASXB             ASXB ADDR                        37646102
         L     R5,ASXBSPSA-ASXB(,R5)    ADDR OF WSAVT                   37647102
         L     R5,WSALSTAT-WSAL(,R5)    ADDR OF STATUS LOCAL WSA        37649602
         ST    R13,STFRRSAV        SAVE PARM AREA ADDRESS      @YM03288 37650602
         ST    R0,WSA                  SAVE SRB ADDR IN WSA             37652202
         L     R6,AIGC079              ESTABLISH COMMON BASE            37654802
         DROP  R15                                                      37655802
         LR    R1,R0                   ADDR OF SRB                      37657402
         LM    R15,R1,SRBEND                                            37660002
         STCM  R0,C2,SWITCHES          SET UP SAME FLAGS HERE           37661002
         OI    SWITCHES,XMSTATUS       ALSO, TURN ON XMSTATUS BIT       37662002
         NI    SWITCHES,OFF-BRANCH     ORIG ENTRY IS IRRELEVANT NOW     37663002
         DROP  R1                                                       37664002
         SR    R4,R4                   CLEAR TCB POINTER                37665002
         LA    R2,OFF                  MASK                             37666002
         NR    R2,R0                   ISOLATE CODE IN R2               37667002
         B     NOTSTP                  BR TO MAINLINE                   37669202
         SPACE 2                                                        37669402
*/*RMTRADDR: E RMTR FOR XMSTATUS */                                     37672002
         USING RMTRADDR,R15                                             37672502
RMTRADDR LR    R8,R14              SAVE RETURN                 @YM02662 37674002
*/* N (,EXFREE) GO TO FREE SRB */                                       37675002
         L     R6,AIGC079          GET COMMON BASE             @YM02662 37677002
         DROP  R15                                                      37679002
         USING IGC079,R6                                                37680002
         B     EXFREE              GO TO FREE                  @YM02662 37680502
         TITLE 'IEAVSETS...AOS/2...IEATRSCN(TREESCAN)'                  37682002
*   THIS IS THE NOTORIOUS TREESCAN ROUTINE.  THE ROUTINE PASSES BACK IN 37684002
*   R10 A DESCENDENT OF THE TCB WHOSE ADDRESS WAS PASSED TO IT IN R10.  37685002
*   R8, R11 AND R14 MUST BE SETUP AS DESCRIBED IN THE PROLOG.           37686002
         SPACE                                                          37687002
         USING TCB,R9                                                   37688002
         USING TREESCAN,R7                                              37689002
*/*IEATRSCN: E TREESCAN - TCB FAMILY SEARCH RTN*/                       37690002
*/* P R9<--R10*/                                                        37691002
IEATRSCN BALR  R7,R0               .LOAD BASE REG                       37692002
TREESCAN LR    R9,R10              .INIT REG FOR SCAN                   37693002
*/* P R10<--LTC(R9)*/                                                   37694002
         L     R10,TCBLTC          .LOAD THE DOTTER                     37700001
*/*SCAN1: D (YES,%D5,NO,) R10=0*/                                       37710002
SCAN1    LTR   R10,R10             .IS THERE A DOTTER/SISTER            37750001
*/* R RETURN REG 14*/                                                   37760002
         BNZR   R14               .YES, RETURN W/DECENDENT IN R10       37800002
*/*%D5: P R10<--NTC(R9)*/                                               37820002
         L     R10,TCBNTC          .NO, LOAD THE SISTER                 37850002
*/* D (NO,GETOTC,YES,) R8=R9*/                                          37860002
         CR    R8,R9               .IS THIS THE TOP TCB                 37900001
*/* R RETURN REG 11*/                                                   37910002
         BER   R11                 .YES, THE TREE'S BEEN SCANNED        37950002
*/*GETOTC: P (,SCAN1) R9<--OTC(R9)*/                                    37960002
GETOTC   L     R9,TCBOTC           .NO, BACKUP ONE RELATIVE             38000001
         B     SCAN1               .GO CHECK HER                        38050001
         DROP  R7,R9                                                    38100001
         TITLE 'IEAVSETS...AOS/2...STOP NON-Q''BLE SRBS (BRANCH ENTRY)' 38110002
*   THIS ROUTINE IS BRANCH-ENTERED BY SWAP TO STOP NON-QUIESCEABLE SRBS 38120002
*   ENTRY-REQUIREMENTS ARE THAT REG 15 CONTAIN THE RETURN ADDRESS, AND  38122002
*   THAT REGS 11-14 MAY NOT BE PRESERVED.                               38126002
         SPACE 2                                                        38130002
*/* E IEAVNQSS*/                                                        38130402
*/* S SETLOCK: OBTAIN LOCAL LOCK*/                                      38130802
IEAVNQSS SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=Q45              38132002
         SPACE 2                                                        38134002
         ENTRY IEAVSSNQ                                                 38140002
*/* E IEAVSSNQ*/                                                        38144002
*/* P BOOTSTRAP TO SAVE AREA- SAVE REGS*/                               38144402
IEAVSSNQ L     R14,PSAAOLD             ASCB                             38144802
         L     R14,ASCBASXB-ASCB(,R14)  ASXB                            38145202
         L     R14,ASXBSPSA-ASXB(,R14)  WSA TBL                         38145502
         L     R14,WSALSTAT-WSAL(,R14)  STATUS WSA                      38145802
         STM   R0,R15,C0(R14)      SAVE REGS                            38146102
         LR    R2,R14              SAVE WSA ADDR                        38146402
*/* P ESTABLISH ADDRESSABILITY*/                                        38148602
         BALR  R6,R0                    BOOTSTRAP ADDRESSABILITY        38149202
         USING *,R6                                                     38149802
         L     R6,AIGC079          .LOAD NEW BASE REG                   38150402
         USING IGC079,R6                                                38151002
Q51      L     R3,PSAAOLD              ADDR OF ASCB                     38151602
*/* S SETLOCK: OBTAIN SALLOC LOCK*/                                     38152202
Q03      SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=(Q48,Q50)       38152802
*/* S SETLOCK: OBTAIN DISPATCHER LOCK*/                                 38153402
Q08      SETLOCK OBTAIN,TYPE=DISP,MODE=UNCOND,RELATED=(Q49,OUT)         38154002
*/* P SET NONQ SRBS NDISP BIT IN ASCB*/                                 38154602
         OI    ASCBFLG2,ASCBSNQS SET NON-Q SRBS NDISP                   38155202
*/* D (YES,OUT,NO,) COUNT OF RUNNING SRBS IS ZERO*/                     38155802
         SR    R12,R12             CLEAR WORK REG                       38156402
         LH    R12,ASCBSRBS        GET COUNT OF RUNNING SRBS            38157002
         LTR   R12,R12             IS COUNT ZERO                        38157602
         BZ    OUT                 RETURN IF ZERO                       38158202
*/* P RESET NONQ SRBS NDISP BIT IN ASCB*/                               38158802
         NI    ASCBFLG2,OFF-ASCBSNQS OFF NON-Q SRB NDISP BIT            38159402
*/* P SET ALL TCBS IN A.S. NDISP*/                                      38160002
         OI    ASCBFLG1,ASCBSTND MAKE ALL TCBS IN A.S. NDISP            38199902
*/* P ESTABLISH RESUME ENVIRONMENT IN CURRENT TCB/RB*/                  38201902
Q31      L     R13,PSATOLD         GET ADDR OF CURRENT TCB              38209902
         L     R14,TCBRBP-TCB(,R13) GET ADDR OF CURRENT RB              38219902
         LA    R12,IEAVNQSS        REDISP ADDRESS                       38229902
         ST    R12,RBOPSW+C4-RBSECT(,R14) SET UP REDISP PSW ADDR        38239902
         MVC   TCBGRS-TCB(C64,R13),C0(R2) SAVE RESUME REGS              38240902
*/* S SETLOCK: RELEASE LOCAL LOCK*/                                     38242302
Q45      SETLOCK RELEASE,TYPE=LOCAL,RELATED=IEAVNQSS                    38243902
*/* S SETLOCK: RELEASE SALLOC LOCK*/                                    38244302
Q48      SETLOCK RELEASE,TYPE=SALLOC,RELATED=Q03                        38245902
*/* S SETLOCK: RELEASE DISPATCHER LOCK (DISABLED)*/                     38246302
Q49      SETLOCK RELEASE,DISABLED,TYPE=DISP,RELATED=Q08                 38247902
*/* R DISPATCHER*/                                                      38248002
         L     R15,DISPTCHR        GET ADDR OF DISP BR E                38248302
         BR    R15                 GO                                   38248702
*/*OUT: S SETLOCK: RELEASE DISPATCHER LOCK*/                            38248802
OUT      SETLOCK RELEASE,TYPE=DISP,RELATED=Q08                          38249102
*/* S SETLOCK: RELEASE SALLOC LOCK*/                                    38249202
Q50      SETLOCK RELEASE,TYPE=SALLOC,RELATED=Q03                        38249502
*                                                                       38249602
*        NOTE : SINCE TCBS ARE NON-DISPATCHABLE (VIA RCT QUIESCE),      38251602
*        THE NON-DISPATCHABILITY BIT, SET WHEN SRBS WERE STOPPED, IS    38254602
*        RESET NOW TO AVOID SCHEDULING AN SRB DURING SWAP-IN TO RESET   38255602
*        THE TASKS DISPATCHABLE                                @YM08338 38257602
*                                                                       38259802
*/* S SRBFRD0: SET TCBS DISPATCHABLE */                        @YM08338 38260802
         BAL   R7,SRBFRD0          SET TCBS DISPATCHABLE       @YM08338 38261802
*/* P RESTORE INPUT REGS*/                                              38262802
         L     R15,ASCBASXB        ASXB                                 38263802
         L     R15,ASXBSPSA-ASXB(,R15)  WSA TBL                         38264802
         L     R15,WSALSTAT-WSAL(,R15)  STATUS WSA                      38265802
         LM    R0,R15,C0(R15)      LOAD REGS                            38269802
*/* R BR R14*/                                                          38295202
         BR    R15                 RETURN                               38303202
*/*STATUS: END */                                                       38303602
         TITLE 'IEAVSETS...AOS/2...CONSTANTS'                           38303702
*        THESE CONSTANTS ARE ADDRESSABLE BY BOTH THE FRR RTN            38303802
*        AND THE MAIN LINE STATUS CODE.  THE TECHNIQUE USED             38303902
*        IS THAT THE FRR USES THE START OF THE CONSTANTS                38305102
*        AS THE BEGINING OF ADDRESSABILITY AND THE MAINLINE             38307102
*        USES THEN AT THE END OF ITS ADDRESSABILITY.                    38307502
*                                                                       38307902
*        THE FOLLOWING DUMMY CONSTANT MUST BE FIRST                     38308002
*                                                                       38308102
CONST    DS    0D                   DUMMY FOR FRR ADDRESSABILITY        38309002
*        THE FOLLOWING CONSTANTS ARE USED FOR INTRAMODULE               38311002
*        ADDRESSABILITY.                                                38311602
*                                                                       38312002
*                                                                       38314902
AIGC079  DC    A(IGC079)           .ADDR OF STATUS                      38315002
MEMSW    DC    V(IEAVEMS0)         .MEMORY SWITCH EP                    38315102
DISPTCHR DC    V(IEA0DS)           .DISPATCHER EP                       38315502
CRBPRFXL DC    A(RBPRFXLN)         CONSTANT TO ADJUST TO RB PRFX        38316702
ASTNFRR  DC    A(STNFRRE)          ADDRESS OF FRR               @Y02753 38316902
STREMS   DC    AL1(ENDMSGH-STRECPM)  SDUMP RECPM LIST           @Y02753 38317102
STRECPM  DC    CL8'IEAVSETS'       SETRP RECPARM LIST - MOD NM  @Y02753 38317502
         DC    CL8'IGC079'         PARMLIST - CSECT NAME        @Y02753 38317902
         DC    CL8'IGC079'         PARMLIST - FRR ID            @Y02753 38319602
MOREMSG  DC    C' ERROR IN STATUS' END OF SDUMP MSG                     38320202
ENDMSGH  EQU   *                   TAG FOR END OF MSG                   38320802
AIGCR244 DC    V(IGC044R2)         ADDR OF CHAP Q VERIFYER      @Y02753 38321602
SFLAGOFF DC    X'00001002'         DISP AND CMS LOCK STRING    @YA02710 38321703
SFLAGON  DC    X'00001402'         DISP, SALLOC,AND CMS LOCK   @YA02710 38321803
FOXES    DC    4X'FF'              .A WORD OF FOXES                     38322002
SMLHC    DC    X'0000FFFF'         .MASK TO LEAVE ONLY AC       @Y02753 38322102
MASK1    DC    AL1(255-(TCBS3A)),X'FFFFFF' TCBS3A MASK FOR CS  @ZA11584 38322240
MASK2    DC    AL1(TCBS3A),X'000000' SETTING TCBS3A MASK FOR CS@ZA11584 38322340
HIBIT    DC    X'80000000'         .SIGN BIT ONLY                       38322940
SMCCHEK  DC    F'0'                .MASK FOR SMC BIT                    38323040
         ORG   SMCCHEK+TCBFLGS5-TCBFLGS4                                38323140
         DC    AL1(TCBSTP)         .SMC BIT                             38323240
         ORG                                                            38323340
STOPCHEK DC    F'0'                .MASK FOR STOP BIT                   38323640
         ORG   STOPCHEK+TCBNDSP2-TCBNDSP                                38323702
         DC    AL1(TCBSTPP)        .STOP BIT                            38324102
         ORG                                                            38324502
QUIRKS   EQU   *-1                 .CHARACTERISTICS TABLE               38324802
         DC    AL1(NOTND+NOXM)         1                                38325202
         DC    AL1(0)                  2                                38325602
         DC    AL1(ND+XMRESET+ACPMSK+ACSFT)   3                         38325702
         DC    AL1(ND+NOXM+ACSFT)      4                                38326002
         DC    AL1(ND+XMSET+XMRESET+ACPTCB+ACPMSK+ACSFT)  5             38326402
         DC    AL1(NOTND+NOXM+ACPTCB)  6                                38326502
         DC    AL1(NOTND+NOXM+ACPTCB)  7                                38326602
         DC    AL1(NOTND+XMRESET+ACPMSK+ACSFT)   8                      38326702
         DC    AL1(NOTND+NOXM+ACSFT)   9                                38327102
         DC    AL1(NOTND+XMSET+XMRESET+ACPTCB+ACPMSK+ACSFT)  10         38328102
         DC    AL1(NOTND+XMSET+XMRESET+ACPTCB+ACPMSK+ACSFT)  11         38330102
         DC    AL1(ND+XMSET+XMRESET+ACPTCB+ACPMSK+ACSFT) 12             38330502
         DC    AL1(NOTND+XMRESET)      13                               38330902
         DC    AL1(NOTND+NOXM)         14                               38331302
         DC    AL1(NOTND+NOXM+ACPMSK+ACSFT) 15                          38331702
         DC    AL1(ND+NOXM+ACPMSK+ACSFT)  16                            38331802
         SPACE 2                                                        38331902
NOXM     EQU   X'00'                   XM NOT ALLOWED                   38332002
XMSET    EQU   X'02'                   XM ALLOWED FOR SET               38332302
XMRESET  EQU   X'01'                   XM ALLOWED FOR RESET ONLY        38332702
NOTND    EQU   X'40'                   NOT PRIMARY N-DISP PROCESS       38333102
ND       EQU   X'00'                   PRIMARY N-DISP PROCESS           38333202
ACPTCB   EQU   X'20'               FLAG TO SAY TCB ADDR IS PASSED       38333302
ACPMSK   EQU   X'10'               FLAG TO SAY MASK IS PASSED           38333702
ACSFT    EQU   X'08'               FLAG TO SAY RETRY IF FROM TOP        38334002
BRATAB   DC    AL2(ABEND14F-IGC079)  .RESERVED SHOULD NEVER BRANCH HERE 38334602
         DC    AL2(MCSTEP-IGC079)   1 .MUST COMPLETE STEP               38334902
         DC    AL2(ABEND14F-IGC079) 2 .MUST COMPLETE SYSTEM             38335302
         DC    AL2(NDSTEP-IGC079)   3 .NON-DISPATCHABLE STEP            38335702
         DC    AL2(NDSYSTEM-IGC079) 4 .NON-DISPATCHABLE SYSTEM          38335802
         DC    AL2(NDTCB-IGC079)    5 .NON-DISPATCHABL TCB ADDR-ALL SUB 38335902
         DC    AL2(PROCEED-IGC079)  6 .STOP                             38336102
         DC    AL2(PROCEED-IGC079)  7 .START                            38336502
         DC    AL2(SDSTEP-IGC079)   8 .2NDARY DISPATCHABILITY STEP      38336902
         DC    AL2(SDSYSTEM-IGC079) 9 .2NDARY DISPATCHABILITY SYSTEM    38337002
         DC    AL2(SDTCB-IGC079)   10 .2NDARY DISPATCH TCB ADDR-ALL SUB 38337102
         DC    AL2(SDETCB-IGC079)  11 .2NDARY DISPATCH TCB ADDR- 1TASK  38337202
         DC    AL2(NDETCB-IGC079)  12 .NON-DISP TCB ADDR - 1 TASK       38337602
         DC    AL2(SRBS-IGC079)    13 .SYSTEM LEVEL SRBS                38338002
         DC    AL2(SYNCH-IGC079)   14 .STOP SUBTASKS SYNCH              38338302
         DC    AL2(CALLER-IGC079)  15 .SET CALLER SD                    38338702
         DC    AL2(CALLER-IGC079)  16 .SET CALLER ND                    38339102
*/*STFRR: CHART */                                                      38340440
         TITLE 'IEAVSETS...AOS/2...FUNCTIONAL RECOVERY RTNS'            38340540
*/*STNFRRE: E  STATUS  FRR ENTRY */                                     38340640
**********************************************************************  38340740
*        THIS ENTRY FROM RTM IS USED BY ALL STATUS SVC AND SVC       *  38340840
*        FUNCTIONAL BRANCH ENTRIES. THE GENERAL PATH THROUGH         *  38340940
*        THE RECOVERY ROUTINE IS AS FOLLOWS: (NOTE, ACTIONS OF       *  38341002
*        P= PERCOLATE, PD - PERCOLATE AFTER DUMP                        38341302
*                                                                    *  38341602
*        1. MEMEMORY TABLES OK - SDWAFMID=0 - (P)                    *  38342202
*        2. VERIFY ASCB & TCBS - CHAP ENTRY   (P)                    *  38342602
*        3. TEST FOR PECOLATED TO (P)                                *  38344002
*        4. RECORD USING DEFAULTS                                    *  38347002
*        5. ISSUE SDUMP IF ERROR OCCURED IN STATUS (PD)              *  38347502
*                                                                    *  38349002
**********************************************************************  38350002
         DROP  R3                                                       38352002
         USING ASCB,STASCB                                              38354002
         USING SDWA,STSDWAR1                                            38359602
STNFRRE  DS    0H                  TESTING LABEL                        38369602
         BALR  STBASE,C0           ESTAB ADDRESSABILITY                 38369702
         USING *,STBASE                                                 38369802
         L     STBASE,ACONST       GET CONSTANT ADDR FOR BASE           38369902
         USING CONST,STBASE        USE IT FOR ADDRESSABILITY            38371402
*/* P SAVE RETURN REG */                                                38373502
         LR    RETSV,R14           SAVE RETURN REG                      38373902
*/* P GET ADDRESS OF FRR WORK AREA */                                   38374302
         L     STPADP,SDWAPARM     GET WORK AREA ADDRESS                38374702
         L     STWRK1,PSAHLHI      GET LOCKS HELD STRING       @YA02710 38374903
*/* D (YES,STYSALL,NO,) SALLOC LOCK HELD ON ENTRY */                    38375102
         TM    STFRFLG,STFRSALL    TEST IF SALLOC FLAG SET              38375502
         BO    STYSALL             BR IF DONT WANT RELEASED ON FRR ERR  38375902
*/* P (,CKFID) MODIFY SDWA TO REL CMS, DISP, SALLOC WHEN HELD*/         38376303
QSTN0    N     STWRK1,SFLAGON      MODIFY STRING TO REFLECT LOCKS TO   *38376503
                                     BE FREED                  @YA02710 38376703
         B     STOREIT             BR TO SAVE STRING IN SDWA   @YA02710 38377103
*/*STYSALL: P MODIFY SDWA TO RELEASE CMS AND DISP WHEN HELD*/           38377203
STYSALL  N     STWRK1,SFLAGOFF     MODIFY STRING TO REFLECT LOCKS TO   *38377303
                                     BE FREED                  @YA02710 38378003
STOREIT  STH   STWRK1,SDWAACF3-SDWA(STSDWAR1) PUT IN SDWA      @YA02710 38378703
*/*CKFID: D (NO,STPERC,YES,) SDWAFID EQ 0 (TRAN TABLES OK)  */          38379602
CKFID    SR    STWRK1,STWRK1       CLEAR                                38380602
         CH    STWRK1,SDWAFMID      TEST IF RIGHT ASCB TABLES           38382002
         BNE   STPERC              BR NOT TO PERCOLATE                  38383502
*/* D (YES,STPERC,NO,) WAS STATUS PECOLATED TO */                       38385002
         TM    SDWAERRC,SDWAPERC   TEST FOR PECOLATED TO                38386502
         BO    STPERC              PERCOLATE IF SO                      38388002
         OI    SDWADPVA,SDWAHEX    VRA TO CONTAIN HEX DATA              38388702
*                                                                       38389502
*        STATUS RECOVERY DOES NOT COPE WITH UNRECOVERABLE ERRORS        38391002
*        IN ROUTINES CALLED BY STATUS (GETMAIN, SETLOCK, ETC.)          38392502
*                                                                       38394002
         USING STFRRPAR,STPADP                                          38413102
*/* S IGC044R2:  CHAP RECOVERY TO VER. ASCB AND TCB FAM.Q*/             38423302
*                                                                       38425402
*        BRANCH TO CHAP TO VERIFY ASCB AND TCB FAMILY QUEUES            38427502
*        SEE PROLOG FOR INTERFACE                                       38429602
*                                                                       38431702
         LA    R2,STREMS           ADDR OF PARM LIST FOR CHAP           38432702
TQ0      L     STEPR,AIGCR244      GET ADDR OF CHAP ROUTINE             38433802
LKTCH    BALR  STRETR,STEPR        LINK TO CHAP ROUTINE                 38435902
         BALR  STBASE,R0           REGAIN ADDRESSABLITY                 38445302
         USING *,STBASE                                                 38446402
         L     STBASE,ACONST       GET ADDR OF NORM BASE                38456402
         USING CONST,STBASE                                             38466402
*/*STPERC: S SETRP: CONTINUE WITH TERM(PERCOLATE)*/                     39287902
STPERC   SETRP RC=0,RECPARM=STRECPM                                     39289002
*/* R RETURN TO RTM*/                                                   39289502
         BR    RETSV               RETURN TO RTM                        39290102
         SPACE 2                                                        39291202
*        THE FOLLOWING CONSTANT MUST STAY AT FRR END TO ALLOW           39294502
*        ADDRESSABILITY OF THE COMMON CONSTANTS.                        39295602
ACONST   DC    A(CONST)            ADDRESS OF CONSTANTS FOR BASE        39296702
*                                                                       39297802
*/*STFRR: END */                                                        39298902
         EJECT                                                          39300002
         ENTRY IGC07902                                                 39900001
         ENTRY IEATRSCN                                                 39950001
         END                                                            40000001
./  ADD  SSI=81940247,NAME=IEAVSY50
         TITLE 'IEAVSY50....WAIT * POST * TCB SWITCHING'                00095040
*ROUTINE NAME-           IGC001, WAIT SVC ROUTINE                       00102002
*                                                                       00109002
*FUNCTIONS-            1.CAUSES THE ISSUING RB CONTROL LEVEL TO         00116002
*                        STOP PROCESSING AND WAIT ON THE OCCURANCE      00123002
*                        OF ONE OR MORE EVENTS.                         00130002
*                                                                       00137002
*ENTRY POINT NAMES-      IGC001, WAIT SVC ENTRY POINT                   00144002
*                        IEAVWAIT - WAIT BRANCH ENTRY                   00147002
*                                                                       00151002
*CONTAINED IN MODULE-    IEAVSY50- WAIT/POST SYNCHRONIZATION MODULE     00158002
*                                                                       00165002
*ATTRIBUTES-             RESIDENT,RE-ENTRANT,SUPERVISOR STATE,          00172002
*                        LOCAL LOCK, KEY 0, TYPE 1 SVC.                 00179002
*                                                                       00186002
*                                                                       00193002
*EXTERNAL REFERENCES    IEA0VL01- VALIDITY CHECK ROUTINE                00200002
*                                                                       00207002
*                        SYSTEM RESOURCES MANAGER                       00214002
*                                                                       00221002
*                        WHEN ASCBTCBS GOES TO ZERO (ALL TCBS IN        00228002
*                        ADDRESS SPACE NON-DISPATCHABLE OR IN WAIT)     00235002
*                        BECAUSE OF A LONGWAIT BEING ISSUED, THE        00242002
*                        NIOWAIT SYSEVENT IS ISSUED.                    00249002
*                                                                       00256002
*                        MACRO CALL -                                   00263002
*                                                                       00270002
*                        SYSEVENT NIOWAIT,ENTRY=BRANCH                  00277002
*                                                                       00284002
*                        INPUT - REGISTER 13 HAS ADDR OF 72 BYTE SAVE   00291002
*                        AREA                                           00298002
*                        _ REGISTER 0 HAS  NIOWAIT CODE AND             00305002
*                        DEFAULT ASID = 0 IN HIGH TWO BYTES             00312002
*                                                                       00319002
*INPUT-                  REGISTER 0 CONTAINS A COUNT OF THE NUMBER      00326002
*                        OF EVENTS THAT MUST OCCUR BEFORE THE           00333002
*                        ISSUING TASK CAN CONTINUE IN CONTROL. IF THE   00340002
*                        SIGN BIT IS ON, THE REQUEST IS A LONGWAIT.     00347002
*                                                                       00354002
*                        REGISTER 1 CONTAINS 0, OR THE ADDRESS OF A     00361002
*                        SINGLE ECB(EVENT CONTROL BLOCK) OR             00368002
*                        THE ADDRESS OF A LIST OF ECB'S TO BE           00375002
*                        WAITED UPON.  A COMPLEMENTED REGISTER, IF SET  00382002
*                        SIGNALS THE PRESENCE OF A LIST.  0 INDICATES   00389002
*                        WAIT WITHOUT ECB AND IS VALID ONLY FOR         00396002
*                        BRANCH ENTRY.                                  00403002
*                                                                       00410002
*                                                                       00417002
*OUTPUT-                 NONE                                           00424002
*                                                                       00431002
*ENTRY POINTS-         1.IGC001,GIVEN CONTROL VIA THE SVC               00438002
*                        INTERRUPT HANDLER(FLIH).                       00445002
*                                                                       00452002
*                      2. IEAVWAIT, BRANCH ENTRY, LOCAL LOCK,           00459002
*                         KEY 0.                                        00466002
*                                                                       00473002
*EXIT POINT-           1.TO TYPE I EXIT PROLOGUE FORCE DISP ENTRY       00480002
*                        IF SVC CALLER AND RB IS PUT INTO WAIT STATE    00487002
*                                                                       00488002
*                      2.TO TYPE 1 EXIT PROLOGUE IF SVC CALLER AND RB   00489002
*                        IS NOT PUT IN WAIT (REG 14 ON ENTRY)           00490002
*                                                                       00494002
*                      3.TO THE DISPATCHER IF BRANCH ENTRY              00501002
*                        THE LOCAL LOCK IS FREED AND THE PSW            00503002
*                        IS DISABLED PRIOR TO DISPATCHER ENTRY.         00505002
*                                                                       00508002
*ERROR EXIT POINTS-    1.TO ABEND                                       00515002
*                                                                       00522002
*                        THE ERROR CODES ARE.                           00529002
*                        X'0101' ERROR CODE #1 NUMBER OF ECBS TO        00536002
*                                              BE WAITED UPON EX-       00543002
*                                              CEEDS THE NUMBER OF      00550002
*                                              ECBS GIVEN.              00557002
*                        X'0201' ERROR CODE #2 THE ECB ADDRESS IS       00564002
*                                              INVALID.                 00571002
*                        X'0301' ERROR CODE #3 AN ATTEMPT IS BEING      00578002
*                                              MADE TO SET THE WAIT     00585002
*                                              FLAG IN AN ECB WHICH     00592002
*                                              IS ALREADY SET.          00599002
*                                                                       00606002
*                                                                       00613002
         EJECT                                                          00620002
*                                                                       00627002
IGC001   START                                                          00695001
         USING *,R6                                                     00705002
         MODID BR=YES                                                   00715002
         DROP  R6                                                       00725002
         SPACE 2                                                        00745001
*WAITING ECB                                                            00795001
*************************                                               00845001
* S     *               *                                               00895001
*  BIT  * WAITING RB'S  *                                               00945001
*   ON  *   ADDRESS     *                                               00995001
*************************                                               01045001
         SPACE 1                                                        01095001
*POSTED ECB                                                             01145001
*************************                                               01195001
* 1       BITS 2-31     *                                               01245001
*  BIT     COMPLETION   *                                               01295001
*   ON      CODE        *                                               01345001
*************************                                               01395001
         SPACE 2                                                        01445001
         SPACE 1                                                   MTS0 02895001
* GENERAL EQUATES                                                       02945001
ERRWAIT1 EQU   X'0101'               WAIT'S, WAIT COUNT TO BIG          03045001
ERRWAIT2 EQU   X'0201'               WAIT ECB ADDRESS INVALID           03095001
ERRWAIT3 EQU   X'0301'               TRYING TO PUT WAITING ECB IN WAIT  03145001
ERRPOST1 EQU   X'0102'               POST ECB ADDRESS INVALID           03195001
ERRPOST2 EQU   X'0202'               POST ECB'S RB ADDRESS INVALID      03245001
ECBPTFLG EQU   X'40'                 ECB POST FLAG                      03295040
RECBWTF  EQU   X'7F'                 RESET ECB WAIT FLAG/LAST ECB PT    03545040
LSTIND   EQU   X'80'                 LAST ECB INDICATOR                 03595040
TCBIND   EQU   X'80'                 RBLINK INDICATES TCB ADDRESS       03645040
ECBWTFLG EQU   X'80'                 ECB WAIT FLAG                      03695040
SUPTST   EQU   X'80'                 PSW PROTECT KEY FIELD       Y02139 03745040
RRBECBWT EQU   X'FE'                 RESET RB'S ECB SEARCH FLAG         03795040
ANYONE   EQU   X'FF'                 TEST FOR ANY BIT IN A BYTE         03845040
XFF      EQU   X'FF'                 ALL ONES                  @Z40EPVD 03895040
M0011    EQU   B'0011'               MASK USED IN ICM INST     @Z40EPVD 03915040
L2       EQU   2                     LENG OF 2                          03925040
L3       EQU   3                     LENGTH OF 3                        03945040
L8       EQU   8                     VALUE OF 8                  Y02139 04195040
C12      EQU 12                      CONST OF 12                        04205040
WDBOUND  EQU   X'03'                 TO TEST FOR WD BOUNDARY            04215040
FOUR     EQU   4                     FOUR                         20021 04295040
ZERO     EQU   0                     CONSTANT                     20021 04345040
LAST     EQU   1                     TESTS FOR LAST PARM IN A LIST      04395040
ON2      EQU   1                     CONDITION FOR ALL BITS ON          04445040
OFF2     EQU   12                    CONDITION FOR ALL BITS NOT ON      04495040
KEY0     EQU   8                     CONDITION FOR ALL BITS OFF         04895040
ECBADDR  EQU   0                     ADDRESS OF ECB IN PARMLIST         04945040
ERRTADDR EQU   8                     ADDR OF ERRET IN PARMS      Y02139 04995040
ASCBADDR EQU   4                     ADDR OF ASCB IN PARMS       Y02139 05045040
ENABON   EQU   X'03'                 TESTS FOR ENABLED PSW              05095040
DISABLE  EQU   X'FC'                 DISABLE MASK                Y02139 05145040
XWTOFF   EQU   X'BF'                 TURNS OFF RBXWAIT BIT              05155040
DISAB    EQU   12                    CONDITION FOR DISABLED PSW         05245040
HBYTE    EQU   4                     SHIFT OF 4 BITS                    05295040
NOTKEY0  EQU   5                     CONDITION FOR NOT KEY ZERO         05345040
ABNDALGN EQU   12                    SHIFTS ABEND CODE 12 BITS          05395040
ABENINST EQU   13                    FOR ISSUEING SVC 13 FOR ABEND      05445040
XMASASID EQU   4                     MASTER SCHED ASID X 4      @Y02752 05495040
ONE      EQU   1                     CONST OF 1                  Y02139 05545040
SRBSV    EQU   0                     DISP IN SAVE AREA FOR SRB @YM01534 05555040
SPOSTRT  EQU   4                     DISP IN SV AREA-RET ADDR  @YM01534 05565040
         SPACE 1                                                        05565540
*        INPUT PARAMETER LIST FORMAT FOR                       @ZA15373 05566040
*        SVC ENTRY CROSS MEMORY POST REQUESTS                  @ZA15373 05566540
         SPACE 1                                                        05567540
ECBPTR   EQU   0                     OFFSET TO ECB ADDRESS     @ZA15373 05568040
ASCBPTR  EQU   4                     OFFSET TO TARGET ASCB ADDR@ZA15373 05569040
ERRETPTR EQU   8                     OFFSET TO ERRET ADDRESS   @ZA15373 05570040
ECBKEY   EQU   12                    OFFSET TO ECB VAL CHK KEY @ZA15373 05571040
         SPACE 1                                                        05573040
CCODE    EQU   4                     CREATE FUNCTION CODE      @Z40EPVD 05575040
DCODE    EQU   8                     DELETE FUNCTION CODE      @Z40EPVD 05577040
EIGHT    EQU   8                     NUMERIC 8                 @Z40EPVD 05579040
HIGHBIT  EQU   1                     WAIT BIT                  @Z40EPVD 05581040
LOWBITS  EQU   3                     EXTENDED ECB INDICATORS   @Z40EPVD 05585040
RC0      EQU   0                     REASON CODE 0             @Z40EPVD 05595040
RC4      EQU   4                     REASON CODE 0             @Z40EPVD 05598040
RC8      EQU   8                     REASON CODE 8             @Z40EPVD 05600040
RCC      EQU   12                    REASON CODE C             @Z40EPVD 05602040
RC10     EQU   16                    REASON CODE 10            @Z40EPVD 05609040
RC14     EQU   20                    REASON CODE 14            @Z40EPVD 05616040
         SPACE 2                                                        05630040
* REGISTER EQUATES.                                                     05645001
         SPACE 1                                                        05695001
* WAIT AND POST                                                         05745001
R0       EQU   0                   INPUT REG 0                   Y02139 05765040
WS0      EQU   4*R0                SA OFFSET FOR R0              Y02139 05795040
R1       EQU   1                   INPUT REG 1                   Y02139 05795440
WS1      EQU   4*R1                SA OFFSET FOR R1              Y02139 05799040
XRSCRTCH EQU   2                   SCRATCH PAD REG                20002 06045002
R2       EQU   2                   REG 2                                06055002
ECBE2    EQU   2                   ADDR OF ECB EXT             @Z40EPVD 06060040
FRRWA3   EQU   3                   FRR WORK AREA ADDR          @Z40EPVD 06065040
XRWORK   EQU   3                   WORK REG                             06095002
R3       EQU   3                   REG 3                                06145002
XRTCB    EQU   4                   ADDRESS OF  TCB               Y02139 06195002
R4       EQU   4                   REG 4                                06205002
XRRB     EQU   5                   ADDRESS OF  RB                Y02139 06245002
R5       EQU   5                   REG 5                                06255002
XRECB    EQU   6                   ECB ADDR REG                         06265002
R6       EQU   6                   REG 6                                06275002
XRASCB   EQU   7                   ASCB POINTER                  Y02139 06285040
R7       EQU   7                   REG 7                                06297002
XRWAITCT EQU   8                   WAIT COUNT                           06303002
R8       EQU   8                   REG 8                                06309002
XRPTCODE EQU   9                   INPUT POST CODE                      06315002
XRECBCTR EQU   9                   COUNT OF ECBS                        06355002
R9       EQU   9                   UPPER REG SAVED IN POST       Y02139 06365002
XRECBPTR EQU   10                  UPDATED ECB ADDRESS                  06395002
R10      EQU   10                  BR ENTRY POST INPUT REG       Y02139 06445002
XRSAVE   EQU   11                  SAVE REGISTER FOR REG. 1      Y02139 06495002
R11      EQU   11                  BR ENTRY POST INPUT REG       Y02139 06505002
XRLINKR  EQU   12                  LINK REGISTER                 Y02139 06545002
R12      EQU   12                  REG 12                               06595002
R13      EQU   13                  SAVE AREA PTR                 Y02139 06645002
XRRETURN EQU   14                  TYPE 1 SVC HANDLER ADDRESS (SVCXT)   06695001
R14      EQU   14                  SUBRTN LINK REG               Y02139 06705002
XRBASE   EQU   15                  BASE REGISTER                        06745001
R15      EQU   15                  SUBRTN BASE REG               Y02139 06795002
         SPACE 2                                                        09195001
* ENTRY AND EXTRN STATMENTS.                                            09245001
         ENTRY IEAVWAIT             WAIT BRANCH ENTRY            Y02139 09265040
         ENTRY IEA0PT01             POST 1                              09345001
         ENTRY IEA0PT02             POST 2                              09395001
         ENTRY IEA0PT03             POST EXIT ROUTINE E.P.     @Z40EPVD 09400040
         ENTRY IEA0PT0E             EXIT IDENTIFY/DELETE E.P.  @Z40EPVD 09415040
         ENTRY IGC002               POST                                09445001
         ENTRY IEASPOST             PURGEDQ PARAMETER LIST FOR SPOST    09455002
         ENTRY IEARPOST             POST RMTR                           09465002
         EXTRN IEA0DS               DISPATCHER                   Y02139 09495002
         EXTRN IEA0VL01             VAL CHECK                    Y02139 09645002
         EJECT                                                          09795001
* WAIT SVC ROUTINE.                                                     09798002
*     THE WAIT SVC ROUTINE WILL PLACE THE RB (REQUEST BLOCK)            09801002
*  OF THE REQUESTING ROUTINE INTO A WAIT STATE.  THIS IS                09804002
*  ACCOMPLISHED BY SETTING THE WAIT COUNT FIELD IN THE RB.              09807002
*  AN RB WAIT STATE WILL PREVAIL UNTIL THE WAIT COUNT IS REDUCED        09810002
*  TO ZERO BY THE SVC POST ROUTINE.  THE WAIT FLAG AND REQUESTING       09813002
*  RB ADDRESS ARE SET IN EACH ECB.  FOR EVERY ECB WHOSE POST            09816002
*  FLAG IS ALREADY SET, THE WAIT COUNT IN REGISTER 0 IS                 09819002
*  DECREMENTED.  IF THIS COUNT GOES TO ZERO,(INDICATING THAT            09822002
*  POSTING HAS ALREADY COMPLETED) WAIT RESETS ALL PROCESSED ECBS        09825002
*  AND RETURNS.  THE WAIT COUNT IS ALWAYS STORED IN THE REQUESTORS      09828002
*  RB.                                                                  09829040
*/*WAIT: CHART*/                                                        21689002
*/*IGC001: E SVC ENTRY*/                                                21755002
IGC001   CSECT                                                          21795001
*/* P SET UP BASE REG*/                                                 21805002
         BALR  XRBASE,ZERO             ADDRESSABILITY                   21825040
         USING *,XRBASE                PROGRAM BASE                     21845040
WAITBAS  EQU   *                       BASE STARTING POINT              21945040
         USING RBSECT,XRRB             RB BASE                   Y02139 22015040
         USING TCB,XRTCB               TCB BASE                  Y02139 22035040
         USING FLC,0                   FIXED LOW CORE BASE       Y02139 22055040
         USING ASCB,XRASCB             ASCB BASE REG             Y02139 22075040
*/* P SET R14 TO EXIT PROLOG FORCE DISPATCHER ENTRY ADDR*/              22156002
         L     R14,CVTEXP1-CVTMAP(,R3) GET FORCE ENTRY ADDR             22157002
*/*BRENTRY: P ENABLE RB OLD PSW*/                                       22159002
BRENTRY  OI    RBOPSW,ENABON           ENABLE OLD PSW                   22161002
*/* P ADDRESS LOCAL SAVE AREA AND SAVE REGS*/                           22163002
         L     XRSAVE,ASCBASXB         ADDRESS OF ASXB           Y02139 22164040
         USING ASXB,XRSAVE             BASE FOR ASXB             Y02139 22165040
         L     XRSAVE,ASXBSPSA         ADDR OF LOCAL WSAVT       Y02139 22175040
         USING WSAL,XRSAVE             ADDR OF WSAVT             Y02139 22185040
         L     XRSAVE,WSALWAIT         ADDR OF WAIT WSA          Y02139 22189002
         DROP  XRSAVE                                            Y02139 22189402
         STM   R0,R1,WS0(XRSAVE)       SAVE INPUT REGS           Y02139 22191002
*/* P ENSURE POSITIVE WAIT COUNT*/                                      22191402
*                                                                       22191602
*              ALL THIS CODE IS NECESSARY AS WAIT HAS A DOUBLE          22191802
*              INTERFACE.  THE COUNT OF EVENTS MAY BE (FOR LONG WAIT    22192002
*              ONLY) IN COMPLEMENTED FORM OR SIMPLY WITH THE HIGH       22192202
*              ORDER BIT ON.  THE FOLLOWING CODE ASSURES THE CORRECT    22192402
*              WAIT COUNT.                                              22192602
*                                                                       22192802
         LR    XRECB,R1                SET UP ECB REG            Y02139 22193402
         LR    XRWAITCT,R0             DUPLICATE WAIT CT                22213440
         ALR   XRWAITCT,XRWAITCT       DOUBLE WAIT COUNT                22233440
         LPR   XRWAITCT,XRWAITCT       MAKE COUNT POSITIVE              22253440
         SRL   XRWAITCT,ONE            DIVIDE BY 2                      22273440
*/*ENDWTCT: D (YES,WAITEXIT,NO,) WAIT COUNT IS ZERO*/                   22435002
ENDWTCT  LTR   XRWAITCT,XRWAITCT       Q.REQUESTOR WAIT COUNT ZERO      22440040
         BC    8,WAITEXIT              *YES RETURN TO CALLER            22495002
         LA    XRECBCTR,ONE            INITIALIZE ECB COUNTER TO 1      22515040
         SPACE                                                          22545503
         LR    XRWORK,XRWAITCT         DUPLICATE WAIT COUNT    @Y30HPVA 22545740
         SPACE                                                          22546503
*/* D (BR,WSUPENT,SVC,) BR OR SVC ENTRY*/                               22547002
         LTR   XRRETURN,XRRETURN       BRANCH ENTRY              Y02139 22555002
         BM    WSUPENT                 BR IF SO                  Y02139 22560040
*/* D (YES,WSUPENT,NO,) CALLER IS SUPVR KEY*/                           22615002
         TM    RBOPSW+ONE,SUPTST       ENTRY FROM A SUPERVISOR KEY CALL 22665040
         BZ    WSUPENT                 YES - TAKE BRANCH                23395040
*/* D (YES,WNON0ENT,NO,) ECBLIST SPECIFIED*/                            23495002
         LCR   XRECBPTR,XRECB          Q. LIST REQUEST ?                23545040
         BP    WNON0ENT                YES - BRANCH                     23595040
*/* S ADDROK: VALIDITY CHECK ECB*/                                      23695002
         BAL   XRLINKR,ADDROK          GO CHECK ADDRESS OUT             23715040
*/* D (GOOD,ECBWT,FAIL,) RESULTS OF VALIDITY CHECK*/                    23755002
*/* S (,ECBWT) CHKCOMTS: CHECK FOR COMM TASK ECB*/                      23765002
         BNE   CHKCOMTS                INVALID - CHECK FOR CSCB ECB     23775040
         B     ECBWT                   GO EXIT FROM PREFIX              23795040
*/*WNON0ENT: S ADDROK: VALIDITY CHECK LIST WORD*/              @YM32396 24005003
WNON0ENT DS    0H                      LIST REQUEST            @Y30HPVA 24010040
         LR    R1,XRECBPTR             ADDR IN R1 FOR VAL CHK  @YM32396 24015040
         BAL   XRLINKR,ADDROK          SUBRTN INVOKES VAL CHK  @YM32396 24025040
*/* D (FAIL,ERROR201,GOOD,) RESULTS OF VALIDITY CHECK*/        @YM32396 24037003
         BNE   ERROR201                INVALID ECBLIST                  24041040
*/* S ADDROK: VALIDITY CHECK ECB*/                                      24095002
         L     XRECB,ZERO(,XRECBPTR)   GET ECB ADDRESS         @YM01876 24115040
         LR    R1,XRECB                SAVE ADDR TO CHK LIST END  AS2PR 24175040
         BAL   XRLINKR,ADDROK          VALIDATE IT                      24205040
*/* D (GOOD,%W1,FAIL,) RESULTS OF VALIDITY CHECK*/                      24255002
*/* S CHKCOMTS: CHECK FOR COMM TASK ECB*/                               24265002
         BNE   CHKCOMTS                CHK FOR CSCB ECB                 24295002
         SPACE                                                          24296003
*/*%W1: D (NO,NEXT1,YES,) ECB POSTED*/                         @Y30HPVA 24296503
         TM    0(XRECB),ECBPTFLG       ECB POSTED              @Y30HPVA 24297003
         BZ    NEXT1                   NO. DO NOT COUNT IT     @Y30HPVA 24297503
*/* P COUNT POSTED ECB*/                                       @Y30HPVA 24298003
*/* D (YES,GETOUT,NO,) REQUESTED WAIT CT. = POSTED CT.*/       @Y30HPVA 24298503
         BCTR  XRWORK,R0               DECR REQ # ECBS POSTED  @ZA05968 24298640
         LTR   XRWORK,XRWORK           COUNT GONE TO ZERO?     @ZA05968 24298740
         BZ    GETOUT                  YES, TERMINATE PROCESS  @ZA05968 24298840
NEXT1    EQU   *                       BYPASSES COUNTING ECB   @Y30HPVA 24300003
         SPACE                                                          24301003
*/*NEXT1: P COUNT ECB- GET NEXT ECBLIST ENTRY*/                         24305003
         TM    0(XRECBPTR),LSTIND      CHK FOR END-OF-LIST IND          24345002
         BC    1,ECBWT                 BR IF SO                         24395002
*/* D (YES,ECBWT,NO,WNON0ENT) END OF ECBLIST*/                          24445002
         LA    XRECBCTR,ONE(XRECBCTR)  INCR ECB COUNTER                 24495040
         LA    XRECBPTR,FOUR(XRECBPTR) POINT TO NEXT ECB IN LIST        24795040
         B     WNON0ENT                GO HANDLE NEXT ELEMENT IN LIST   24845040
*/*WSUPENT: D (ZERO,NOZERO,ECB,ECBWT,LIST,) TEST HOW ECB SPECIFIED*/    24945002
WSUPENT  DS    0H                                                       25195002
         LCR   XRECBPTR,XRECB          Q. LIST REQUEST                  25215040
         BM    ECBWT                   IF NOT A LIST - BRANCH           25245040
         BZ    NOZERO                  BR IF WAIT WITHOUT ECB           25305002
         SPACE                                                          25325003
*/*WSLIST: D (NO,NEXT2,YES,) ECB POSTED*/                      @Y30HPVA 25375003
WSLIST   EQU   *                       LOOP THRU ECB LIST      @Y30HPVA 25400003
         L     XRECB,ZERO(,XRECBPTR)   GET ECB ADDRESS         @Y30HPVA 25404003
         TM    0(XRECB),ECBPTFLG       ECB POSTED              @Y30HPVA 25408003
         BZ    NEXT2                   NO. DO NOT COUNT IT     @Y30HPVA 25412003
*/* P COUNT POSTED ECB*/                                       @Y30HPVA 25416003
*/* D (YES,GETOUT,NO,) REQ. WAIT CT. = POSTED CT.*/            @Y30HPVA 25418003
         BCTR  XRWORK,R0               DECR REQ # ECBS POSTED  @ZA05968 25419040
         LTR   XRWORK,XRWORK           COUNT GONE TO ZERO?     @ZA05968 25420040
         BZ    GETOUT                  YES, TERMINATE PROCESS  @ZA05968 25420640
*/*NEXT2: P COUNT ECB AND GET NEXT LIST ENTRY*/                @Y30HPVA 25422003
NEXT2    EQU   *                       BYPASS COUNTING ECB     @Y30HPVA 25425003
         SPACE                                                          25430003
WSLIST1  TM    0(XRECBPTR),LSTIND      TEST FOR LAST ECB ADDR           25435003
         BC    1,ECBWT                 BR IF SO                         25445002
*/* D (NO,WSLIST,YES,) END OF LIST*/                                    25495002
         LA    XRECBCTR,ONE(XRECBCTR)  INCREASE ECB COUNTER (SEE ABOVE) 25545040
         LA    XRECBPTR,FOUR(XRECBPTR) BUMP TO NEXT ECB ADDR            25895040
         B     WSLIST                  BRANCH                           25945040
         EJECT                                                          26345001
*/*ECBWT: D (EQ,ECBWT1,GT,ERROR101,LT,) WAIT COUNT VS # ECBS*/          26395002
ECBWT    DS    0H                                                       26745002
         L     XRECBPTR,WS1(XRSAVE)     ESTABLISH ORIG ECBPTR           26765040
         CR    XRECBCTR,XRWAITCT        Q.ECB CT. LT WAIT CT.           26795040
         BE    ECBWT1                   EQUAL, TAKE BRANCH        AS2PR 27445001
         BL    ERROR101                 *** YES, TAKE BRANCH            27495002
*/* P SET ON RB SEARCH BIT*/                                            27505002
         OI    RBSTAB2,RBECBWT          SET RB'S ECB SEARCH FLAG        27545001
*/*ECBWT1: P INITIALIZE ECB POINTER*/                                   27845402
ECBWT1   LCR   XRECBPTR,XRECBPTR        ECB OR ECBLIST            AS2PR 27846240
         BM    PKEY1                    BR IF ECB                       27847040
PKEY     L     XRECB,0(XRECBPTR)        GET ECB ADDR FRM LIST           27875040
*/*PKEY1: P PICK UP ECB FOR LATER COMPARE AND SWAP*/                    27937002
PKEY1    L     R0,ZERO(,XRECB)          GET ECB NOW            @YM02795 27942040
*/*PKEY2: D (YES,CFLAGON,NO,) ECB ALREADY POSTED*/                      27957002
PKEY2    TM    0(XRECB),ECBPTFLG        Q.ECB'S POST FLAG SET           27995002
         BO    CFLAGON                  YES,TAKE BRANCH                 28045001
*/* D (YES,ERROR301,NO,) IS ECB ALREADY WAITED UPON*/                   28095002
         TM    ZERO(XRECB),ECBWTFLG     Q.IS ECB WAIT FLAG SET          28145040
         BO    ERROR301                 *** YES TAKE BRANCH TO ABTERM   28245001
*/* P CS RB ADDR AND WAIT BIT IN ECB*/                                  28255002
         LR    R1,XRRB                  SET RB ADR IN REG       @Y02752 28295040
         O     R1,TIDBIT                SET WAIT BIT            @Y02752 28345040
         CS    R0,R1,ZERO(XRECB)      CS RB ADDR/WAIT BIT TO ECB@Y02752 28415040
*/* D (NO,PKEY2,YES,) COMPARE AND SWAP GO */                            28515002
         BNZ   PKEY2                    GO CHECK WHAT HAPPENED  @Y02752 28535040
         SPACE 2                                                        28645001
*/*UPDATE: P UPDATE ECB LIST POINTER*/                                  28655002
UPDATE   LA    XRECBPTR,FOUR(XRECBPTR)  UPDATE ECB LIST ADR             28675040
*/* D (MORE,PKEY1,DONE,) BCT CHECK FOR MORE ECBS*/                      28705002
         BCT   XRECBCTR,PKEY            Q.DECREMENT ECB CTR (NOT 0 BR)  28725040
*/*NOZERO: P SET EXPLICIT WAIT BIT IN RB*/                              28795002
NOZERO   S     XRRB,WPRBPREL            GET PREFIX ADDRESS       AS2708 28845040
         OI    RBFLAGS1-RBPREFIX(XRRB),RBXWAIT SET RBXWAIT BIT   AS2708 29655040
         A     XRRB,WPRBPREL            RESET RB BASE REG               29665040
*/* P DECR ASCBTCBS USING CS*/                                          29717002
         L     XRWORK,ASCBTCBS          GET TCB RDY CT                  29737040
CSTCBSDN LR    XRSCRTCH,XRWORK          DUPLICATE VALUE                 29767040
         BCTR  XRSCRTCH,R0              DECREMENT                       29817040
         CS    XRWORK,XRSCRTCH,ASCBTCBS  COMP/SWAP CT                   29867040
         BNZ   CSTCBSDN                 BR IF DID NOT GO                29919040
*/* P SET RB WAIT COUNT*/                                               29925002
         STC   XRWAITCT,RBWCF           ST WAIT COUNT IN REQUESTING RB  29926040
*/* D (NO,LONGWAIT,YES,) ALL TCBS IN A.S. NOT READY*/                   29937002
         LTR   XRSCRTCH,XRSCRTCH        TEST FOR CT GO TO ZERO @YM01524 29947040
         BNZ   LONGWAIT                 BR IF AS NOT ALL IN WAIT        29967040
*/* P INCREMENT ASCB SHORT WAIT COUNT*/                                 30027002
         LH    XRWORK,ASCBSWCT          GET AS SHORT WAIT CTR           30047040
         LA    XRWORK,ONE(XRWORK)       INCR CTR                        30067040
         STH   XRWORK,ASCBSWCT          RESET CTR                       30117040
*/*LONGWAIT: D (NO,WAITEXIT,YES,) LONG WAIT SPECIFIED*/                 30169002
LONGWAIT TM    WS0(XRSAVE),LSTIND      TEST FOR LONG WAIT IND           30177002
         BZ    WAITEXIT                BR IF NOT LONG WAIT              30217002
*/* P SET LONG WAIT BIT IN RB*/                                         30267002
         S     XRRB,WPRBPREL           ADDR RB PREFIX                   36897002
         OI    RBFLAGS1-RBPRFX(XRRB),RBLONGWT  SET LONG WAIT  IND       36899002
*/* D (YES,,NO,WAITEXIT) HAS COUNT OF READY TCBS GONE TO ZERO */        36905002
         LTR   XRSCRTCH,XRSCRTCH       TEST COUNT              @YM02607 36908040
         BNZ   WAITEXIT                BR IF STILL ANY RDY TCBS@YM02607 36911040
LONGRBCK DS    0H                      TESTING LABEL                    36925002
*/* S SYSEVENT: NOTIFY LONGWAIT*/                                       36944302
         LR    XRSCRTCH,XRRETURN       SAVE REG14 ACROSS                36948102
         LR    R13,XRSAVE              SET REG 13 SAVE AREA PTR@YM01599 36950140
         LR    XRWORK,XRBASE           SAVE BASE REG ACROSS SRM CALL    36953240
         LM    R5,R6,WS0(XRSAVE)       SAVE REGS 0 AND 1       @YM01682 36956040
         SYSEVENT NIOWAIT,ENTRY=BRANCH                                  36963602
         STM   R5,R6,WS0(XRSAVE)       SET REGS 0&1            @YM01682 36964640
         LR    XRBASE,XRWORK           RESTORE BASE REG                 36967440
         LR    XRRETURN,XRSCRTCH       RESTORE RETURN REG               36975002
*/*WAITEXIT: D (BR,%Q1,SVC,) ENTRY TYPE*/                               37205002
WAITEXIT DS    0H                      COMMON EXIT ROUTINE              37225040
         LM    R0,R1,WS0(XRSAVE)       RESTORE REGS 0 AND 1    @YM01682 37245040
         LTR   XRRETURN,XRRETURN       TEST BR OR SVC ENTRY             37295002
*/* R BPR 14*/                                                          37345002
         BPR   XRRETURN                SVC, AND AWAY WE GO              37395002
*/*%Q1: P DISABLE CPU USING STNSM*/                                     37397002
         STNSM WOS,DISABLE             DISABLE SYSTEM MASK              37401040
*/* S SETFRR: PURGE FRR STACK*/                                         37405402
         SETFRR P,WRKREGS=(XRWORK,XRSCRTCH)  PURGE FRR STACK            37407002
*/* S SETLOCK: RELEASE LOCAL LOCK*/                                     37409002
         SETLOCK RELEASE,TYPE=LOCAL,RELATED='INPUT PARAM'               37415002
*/* R IEA0DS*/                                                          37417002
         L     XRBASE,DISPTCHR         GET DISP ENTRY ADDR              37425002
         BR    XRBASE                  GO THERE                         37455002
*/*CFLAGON: D (MORE,UPDATE,ZERO,) BCT WAITCOUNT*/                       37485002
CFLAGON  BCT   XRWAITCT,UPDATE         Q.DECREMENT WAIT COUNT NOT 0 BR  37795001
*/* D (YES,TISWBR,NO,) BRANCH ENTRY */                                  37796002
         LTR   R14,R14                 TEST HIGH BIT ON FOR BR ENTRY    37796540
         BM    TISWBR                  BRANCH IF BRANCH ENTRY           37797040
*/* P RESET R14 TO NORMAL EXIT PROLOG ADDR*/                            37799002
         L     R14,CVTPTR              GET CVT POINTER                  37799540
         L     R14,CVTEXPRO-CVTMAP(,R14)  ADDR OF EXIT PROLOGUE         37801003
*/*TISWBR: D (NO,WAITEXIT,YES,) RB SEARCH BIT IS ON*/                   37805002
TISWBR   TM    RBSTAB2,RBECBWT         Q.IS RB'S ECB SEARCH FLAG SET    37845002
         BZ    WAITEXIT                *NO GO TO EXIT POINT             37895001
*/* P RESET RB SEARCH BIT*/                                             37905002
         NI    RBSTAB2,RRBECBWT        RESET RB ECB SEARCH FLAG         37945001
         LA    XRWORK,ZERO(,XRECB)     SET LAST ECB ADDR       @YM07244 37965002
         L     XRECBPTR,WS1(XRSAVE)    GET ORIG ECBLIST PTR             37975040
         LCR   XRECBPTR,XRECBPTR       MAKE POSITIVE                    38005002
*/* P (,WAITEXIT) RESET WAIT BIT IN EACH ECB IN LIST*/                  38015002
LOOP1    L     XRECB,ZERO(,XRECBPTR)   OBTAIN ECB ADDRESS               38025040
         LA    XRECB,ZERO(,XRECB)      CLEAR                   @YM07244 38045040
         CLR   XRECB,XRWORK            TEST FOR LAST TO CLEAR  @YM07244 38055040
         BE    WAITEXIT                EXIT IF LAST            @YM07244 38065040
         NI    0(XRECB),RECBWTF        RESET ECB'S WAIT FLAG            38095002
         LA    XRECBPTR,FOUR(XRECBPTR) UPDATE LIST POINTER              38145040
         B     LOOP1                   BRANCH UNCONDITIONALLY           38245040
         SPACE                                                          38305003
*/*GETOUT: D (YES,WAITEXIT,NO,) BRANCH ENTRY */                @Y30HPVA 38310003
GETOUT   SR    XRWAITCT,XRWAITCT       ZERO WAIT COUNT         @Y30HPVA 38312040
         NI    RBSTAB2,RRBECBWT        TURN OFF SEARCH FLAG    @Y30HPVA 38315040
         LTR   R14,R14                 HI BIT ON FOR BR ENTRY  @Y30HPVA 38325040
         BM    WAITEXIT                BRANCH IF BRANCH ENTRY  @Y30HPVA 38335040
*/* P (,WAITEXIT) RESET R14 TO NORMAL EXIT PROLOG ADDR*/       @Y30HPVA 38339003
         L     R14,CVTPTR              GET CVT POINTER         @Y30HPVA 38340040
         L     R14,CVTEXPRO-CVTMAP(,R14)  ADDR OF EXIT PROL    @Y30HPVA 38343003
         B     WAITEXIT                                        @Y30HPVA 38345003
         EJECT                                                          38395001
*/* E ADDROK */                                                         38415003
*/*ADDROK: P INITIALIZE FOR CALL TO VALIDITY CHECK*/                    38445002
ADDROK   DS    0H                                                       39245002
         LA    XRSCRTCH,L3(,R1)        LOAD END ADDR OF ECB             39295040
         STM   R14,R15,FOUR*R14(XRSAVE) SAVE REGS 14-15                 39395040
*/* S IEA0VL01: CHECK ADDRESS*/                                         39415002
         L     R15,CHECK               GET VAL CHK RTN ADDR             39425002
         BALR  R14,R15                 GO TO VAL CHK RTN                39435002
*/* R RETURN WITH CCODE SET*/                                           39435402
         LM    R14,R15,FOUR*R14(XRSAVE) RESTORE REGS 14 -15             39436240
         BR    XRLINKR                 RETURN                           39439002
*/* E CHKCOMTS */                                                       39459003
*/*CHKCOMTS: P GET CSCB ADDR VIA JSCB*/                                 39489002
CHKCOMTS DS    0H                                                       39795002
         L     XRSCRTCH,TCBJSCB        GET JSCB ADDRESS                 39815040
         USING IEZJSCB,XRSCRTCH                                         39895002
         L     XRSCRTCH,JSCBCSCB       GET CSCB ADDRESS                 39915040
         USING CSCB,XRSCRTCH                                            39995002
         LA    XRECB,0(XRECB)          CLEAR HI ORDER BYTE/USE SCR REG  40045040
*/* D (NO,ERROR201,YES,) INVALID ECB OWNED BY COMM TASK*/               40155002
         C     XRECB,CHECBP            Q. IS ECB EQUAL TO ECB OF COM    40175040
         BNE   ERROR201                NO - THAT IS BAD GO TO ERROR RTN 40195040
*/* R RETURN*/                                                          40255002
         B     FOUR(XRLINKR)           ADDR THOUGH INVALID - IS OK      40275040
         EJECT                                                          42195001
*   ERROR EXITS FROM WAIT                                               42295001
**********************************************************************  42345001
*/*ERROR101: P (,ERRORALL) SET ABEND CODE 101*/                         42355002
ERROR101 DS    0H                      *                                42375040
         LA    R1,ERRWAIT1             NO TO WAIT ON GRT THAN NO GIVEN  42395040
         B     ERRORALL                GO TO COMMON ABEND CODE          42445040
*/*ERROR201: P (,ERRORALL) SET ABEND CODE 201*/                         42505002
ERROR201 DS    0H                      *                                42525040
         LA    R1,ERRWAIT2             INVALID ECB ADDRESS CODE         42545040
         B     ERRORALL                GO TO COMMON ABEND CODE          42595040
*/*ERROR301: P SET ABEND CODE 301*/                                     42655002
ERROR301 DS    0H                      *                                42675040
         LA    R1,ERRWAIT3             WAIT FLAG ALREADY SET            42695040
         B     ERRORALL                GO TO COMMON ABEND CODE          42745040
*                                                                       42845001
*/*ERRORALL: R ABEND*/                                                  42855002
ERRORALL SLL   R1,ABNDALGN             MOVE COMP CODE LEFT/ SHOW SYSTEM 42875040
         ICM   R1,L8,ERRORFLG          TAKE DUMP                        42895040
         SVC   ABENINST                ISSUE SVC 13                     42945040
*                                                                       43045001
**********************************************************************  43095001
         EJECT                                                          43195001
*                                                                       43205002
*        BRANCH ENTRY TO WAIT                                           43215002
*                                                                       43225002
*        THE CALLER HAS ESTABLISHED HIS RESUME ENVIRONMENT (REGS/PSW)   43225402
*        IN HIS TCB/PSW. REGS 0,1 ARE THE SAME AT ENTRY AS FOR THS SVC  43225802
*        WITH THE POSSIBILITY THAT THE USER MAY SPECIFY NO ECB (REG1    43226202
*        IS ZERO).                                                      43226602
*                                                                       43226702
*/* E IEAVWAIT*/                                                        43227002
IEAVWAIT DS    0H                                                       43235002
         USING *,XRBASE                BR ENTRY BASE REG                43237002
*/* P INITIALIZE ENVIRONMENTAL REGS*/                                   43237402
         L     XRASCB,PSAAOLD          CURRENT ASCB ADDR                43239002
         L     XRTCB,PSATOLD           CURRENT TCB ADDR                 43240040
         ST    R1,TCBGRS1              SAVE ECBLIST ADDR FOR POST       43243002
         L     XRRB,TCBRBP             CURRENT RB ADDR                  43243240
         L     XRBASE,BASEWT           COMMON WAIT BASE VALUE           43243502
         USING WAITBAS,XRBASE          COMMON WAIT BASE ADDR            43243640
*/* P (,BRENTRY) SET BR ENTRY SW- REG 14 NEGATIVE*/                     43244002
         O     XRRETURN,TIDBIT         SET SIGN BIT AS BR ENTRY SW      43244202
         B     BRENTRY                 GO TO MAINLINE                   43244440
*/*WAIT: END*/                                                          43257202
         EJECT                                                          43269802
*********************************************************************** 43273840
*                                                                       43277840
*ROUTINE NAME-           IGC002,POST SVC SERVICE ROUTINE                43282402
*                                                                       43295001
*FUNCTIONS-            1.POST WILL SIGNAL THE COMPLETION OF AN EVENT    43345001
*                          SPECIFIED BY AN EVENT CONTROL BLOCK(ECB)     43395001
*                          BY SETTING IT APPROPRIATELY.                 43445001
*                                                                       43452003
*                      2.POST WILL SIGNAL THE COMPLETION OF AN EVENT    43459003
*                          TYPE ECB BY STORING ITS ADDRESS IN THE       43466003
*                          ADDRESS IN THE APPROPIATE EVENT TABLE        43480003
*                          AND SETTING THE COMPLETE BIT AND COMPLETION  43487003
*                          CODE IN THE ECB.                             43491003
*                                                                       43495001
*                      3.POST WILL DETERMINE IF THE TASK IN A WAIT      43545003
*                          STATE HAS BEEN MADE READY.                   43565040
*                                                                       43625040
*                      4.GIVE AN AUTHORIZED USER EXIT ROUTINE           43655040
*                          CONTROL WHEN AN EXTENDED ECB IS              43685040
*                          POSTED.                                      43695040
*                                                                       43718040
*                      5.POST EXIT INTERFACE SERVICE                    43721040
*                          A. IDENTIFY POST EXIT ROUTINES TO POST       43724040
*                             MAINLINE BY QUEUEING A BLOCK NO THE       43727040
*                             POST EXIT QUEUE, HEADED BY ASXBPT0E.      43730040
*                          B. DELETE POST EXITS BY DEQUEING THE         43733040
*                             BLOCK IDENTIFIED WITH THE EXIT            43736040
*                             FROM THE POST EXIT QUEUE.                 43737040
*                                                                       43745001
*ENTRY POINT NAMES-    1.IGC002,ENTRY POINT VIA SVC 02                  44045001
*                                                                       44095001
*                      2. IEA0PT01,  BRANCH ENTRY                       44245002
*                                                                       44345001
*                      3. IEA0PT02, BRANCH ENTRY                        44395002
*                                                                       44445040
*                      4. IEA0PT03, BRANCH ENTRY - USED FOR             44495040
*                           REINVOCATION OF POST FROM A POST            44545040
*                           EXIT ROUTINE                                44595040
*                                                                       44600040
*                      5. IEA0PT0E, BRANCH ENTRY TO                     44605040
*                           IDENTIFY/DELETE POST EXITS                  44615040
*                                                                       44645001
*CONTAINED IN MODULE-    IEAVSY50- WAIT/POST SYNCHRONIZATION MODULE     44695001
*                                                                       44745001
*ATTRIBUTES-            LOCAL LOCK, ENABLED, KEY0, SUPERVISOR STATE     44795002
*                                                                       44895001
*EXTERNAL REFERENCES-                                                   45045001
*                         IEA0VL01--VALIDITY CHECK ROUTINE              45295001
*                                                                       45495001
*                         POST EXIT ROUTINES - INTERFACE AS FOLLOWS:    45500040
*                           ENTRY TO EXIT - KEY 0,SUP STATE,LOCAL LOC   45515040
*                             R0 POSTED ECB ADDR                        45525040
*                             R1 ECBREXTENSION ADDR                     45535040
*                             R14 RETURN ADDR                           45545040
*                             R15 ENTRY POINT ADDR                      45555040
*                             REMAINING REGS IRRELEVANT                 45565040
*                           RETURN - KEY 0,SUP STATE,LOCAL LOCK         45575040
*                             R11 UNCHANGED                             45585040
*                             R14 UNCHANGED                             45595040
*                             REMAINING REGS IRRELEVANT                 45605040
*INPUT-                  SVC ENTRY                                      45645002
*                        R0 CONTAINS THE POST CODE.                     45745002
*                                                                       45845001
*                        R1 CONTAINS THE ADDRESS OF THE ECB TO BE       45855002
*                        POSTED.                                        45860040
*                                                                       45875002
*                        IF HI ORDER BIT OF REG 1 IS ON, THEN           45895001
*                        REGISTER ONE POINTS TO A PARAMETER LIST.       45915040
*                        THE PARAMETER LIST IS THREE FULLWORDS          45945040
*                        AS FOLLOWS:                                    45995040
*                          WORD ONE---ADDRESS OF ECB                    46095001
*                          WORD TWO---ADDRESS OF ASCB                   46145002
*                          WORD THREE---ADDRESS OF ERRET                46195002
*                                                                       46215002
*                        IF HIGH ORDER BIT OF REG 0 IS ON, THE          46221040
*                        PARAMETER LIST CONTAINS A FOURTH WORD:         46227040
*                          WORD FOUR--BYTE 0 - ECBKEY IN FORMAT X'K0'   46233040
*                                     BYTES 1-3 - RESERVED              46239040
*                        (REG 0 CONTAINS THE POST CODE)                 46245002
*                        THIS PARAMETER LIST IS USED FOR                46295002
*                        CROSS-MEMORY POST                              46345002
*                                                                       46355040
*                        IEA0PT0E -BRANCH ONLY,SVC NOT AVAILABLE        46365040
*                          R0 FUNCTION CODE                             46375040
*                             4 - EXIT CREATION REQUEST                 46385040
*                             8 - EXIT DELETION REQUEST                 46395040
*                          R1 EXIT ROUTINE ADDR TO BE CREATED OR        46405040
*                            DELETED                                    46415040
*                          R14 RETURN ADDR                              46425040
*                          R15 ENTRY POINT ADDR (IEA0PT0E)              46435040
*                                                                       46445001
*OUTPUT-                 NONE                                           47995001
*                                                                       48045001
*ENTRY POINTS-        1A.IGC002,POST SVC ROUTINE ENTRY POINT            48095001
*                                                                       48245001
*                        2. (IEA0PT01) BRANCH ENTRY                     49895002
*                       THE USER MUST PROVIDE THE FOLLOWING.            50095001
*                        1. ADDRESS OF IEA0PT01 IN REGISTER 15.         50115040
*                        2. RETURN ADDRESS IN REGISTER 14.              50145040
*                        3. THE COMPLETION CODE IN REGISTER 10.         50195040
*                           IF POST WITHOUT ECB,                        50255002
*                           THEN R10 CONTAINS THE RB ADDRESS.           50265002
*                           THE HIGH ORDER BIT ON IN R10 FOR CROSS      50272040
*                           MEMORY POSTS INDICATES ECBKEY OPTION        50279040
*                           HAS BEEN REQUESTED.                         50286040
*                        4. THE ECB ADDRESS IN REGISTER 11,             50295002
*                           WITH X'00' IN HI ORDER BYTE IF NORMAL POST, 50345001
*                           AND X'80' IF CROSS-MEMORY POST.             50395002
*                           IF REG 11 IS ALL ZERO, THEN POST            50425002
*                           WITHOUT ECB (SEE REG 10).                   50455002
*                        5. IF XMPOST, REG 12 HAS ERRET ADDR            50495002
*                        6.  REG 13 HAS ASCB ADDR IF XMPOST             50545002
*                        7. IF ECBKEY OPTION HAS BEEN REQUESTED THEN    50555040
*                           BYTE 3 OF REG 0 CONTAINS THE KEY IN         50565040
*                           FORMAT X'K0'.                               50575040
*                                                                       50595001
*                                                                       50695001
*                     B. (IEA0PT02) BRANCH ENTRY                        50745002
*                        PERFORMS THE SAME                              50795002
*                        FUNCTION AS IEA0PT01 WITH NO XMPOST            50845002
*                        AND NO POST WITHOUT ECB.                       50915002
*                                                                       50995001
*                     C. (IEA0PT03) BRANCH ENTRY                        51002040
*                        PERFORMS SAME FUNCTION AS IEA0PT01             51009040
*                        AND HAS SAME INPUT REQUIREMENTS.               51016040
*                        THIS ENTRY POINT USES THE LOCAL                51023040
*                        SAVE AREA EXTENSION.                           51030040
*                     D. (IEA0PT0E) BRANCH ENTRY - CVT0PT0E             51031040
*                        CALLER MUST HAVE LOCAL LOCK, KEY 0,            51032040
*                        SUPERVISOR STATE                               51033040
*                        THIS ENTRY USES MAIN SAVE AREA                 51034040
*                                                                       51037040
*EXIT POINT-           1.TO TYPE I EXIT PROLOGUE FORCE DISPATCHER       51045002
*                        ENTRY IF SVC CALLER                            51145002
*                                                                       51155002
*                      2.TO REG 14 IF BRANCH ENTRY                      51195002
*                                                                       51895001
*                        IEA0PT01 BRANCH ENTRY FOR NORMAL POST          51945002
*                        LOCAL LOCK HELD                                52045002
*                        REGISTERS 0-9 AND 12-14 ARE TRANSPARENT        52095002
*                        REGISTERS 10-11 AND 15 ARE VOLATILE            52145002
*                                                                       52195001
*                        IEA0PT01 BRANCH ENTRY FOR XMPOST               52205002
*                        NO LOCK REQUIRED                               52207002
*                        REGS 9,14 ARE SAVED OTHERS ARE LOST            52217002
*                        IF LOCAL LOCK IS NOT HELD                      52219002
*                                                                       52221002
*                        REGS 0-9 AND 14 ARE SAVED IF                   52223002
*                        LOCAL LOCK IS HELD & MEM RELETED AT BR ENTRY   52223402
*                                                                       52225002
*                        (IEA0PT02) BRANCH ENTRY                        52245002
*                        LOCAL LOCK HELD                                52295002
*                        REGISTERS 0-9 AND 12-14 ARE TRANSPARENT        52345002
*                        REGISTERS 10-11 AND 15 ARE VOLATILE            52395002
*                                                                       52445001
*                                                                       52495001
*                        IEA0PT03 BRANCH ENTRY FOR POST                 52505040
*                        REINVOCATION, LOCAL LOCK HELD.                 52515040
*                        REGISTERS 1-14 ARE TRANSPARENT                 52525040
*                        REGISTER 15 IS UNPREDICTABLE                   52535040
*                                                                       52537040
*                      3.IEAV0PT0E, RETURN VIA CALLERS REG14,           52539040
*                        LOCAL LOCK HELD,KEY 0,SUPR STATE               52541040
*                                                                       52545001
*ERROR EXIT POINTS-    1. TO ABEND                                      52595002
*                                                                       52695001
*                       THE ERROR CODES ARE.                            53445002
*                        X'0102' ERROR CODE #1 POST ECB ADDRESS         53495001
*                                              INVALID.                 53545001
*                        X'0202' ERROR CODE #2 POST ECB'S RB            53595001
*                                              ADDRESS INVALID.         53645001
*                        X'0402' ERROR CODE #4 EVENTS ECB EVENTS        54345003
*                                              TABLE ADDRESS INVALID    55045003
*                        X'0502' ERROR CODE #5 POST TO FULL             55745003
*                                              EVENTS TABLE             56445003
*                                                                       57145003
*                        X'702' ERROR CODE #7 INVALID ECB               57195040
*                                             EXTENSION                 57245040
*                                             RELATED DATA              57295040
*                               REASON CODE                             57345040
*                                  0 - INVALID FUNCTION CODE FOR        57353040
*                                      ENTRY TO IEA0PT0E                57361040
*                                  4 - INVALID EXIT ROUTINE ADDR        57369040
*                                      FOR DELETE REQUEST AT            57377040
*                                      ENTRY TO IEA0PT0E                57385040
*                                  8 - INVALID VALUE OR                 57395040
*                                      RESERVED FIELDS USED             57445040
*                                      IN ECB EXTENSION                 57465040
*                                  C - INVALID EXIT ROUTINE             57495040
*                                      ADDRESS IN ECB EXTENSION         57545040
*                                 10 - ATTEMPT TO POST                  57595040
*                                      EXTENDED ECB FROM                57645040
*                                      POST EXIT ROUTINE                57695040
*                                 14 - INVALID ECB EXTENSION            57745040
*                                      ADDRESS IN ECB                   57795040
*                                                                       57845040
*CHANGE ACTIVITY-                                              @ZA30491 57865040
*  OZ11895--CHANGE TO MARK THE ECB POSTED BEFORE UPDATING THE  @ZA30491 57885040
*           EVENTS TABLE.                                      @ZA30491 57905040
*  OZ15375--PROVIDE NEW OPTION ECBKEY FOR XMPOST.              @ZA30491 57925040
*  OZ20188--CHANGE TO MAKE EVNTFRR (EVENTS FRR) SAVE REG 14    @ZA30491 57945040
*           ACROSS SETRP.                                      @ZA30491 57965040
*  OZ30491--REGISTERS 12 AND 13 WEREN'T SAVED WHEN A POST EXIT @ZA30491 57985040
*           ROUTINE WAS INVOKED. IF THEY ARE UPDATED BY THE    @ZA30491 58005040
*           EXIT, THE ORIGINAL VALUES OF REGS 12 AND 13 WILL   @ZA30491 58025040
*           NOT BE RETURNED TO A BRANCH ENTRY CALLER OF POST.  @ZA30491 58045040
*  OZ33186--FOR POST, IEAVSY50 CURRENTLY ASSUMES AS ECB WITH   @ZA33186 58048040
*           THE 2 LOW ORDER BITS OFF WILL BE UPDATED USING THE @ZA33186 58051040
*           LOCAL LOCK FOR SERIALIZATION. HOWEVER, CS SHOULD   @ZA33186 58054040
*           BE SUFFICIENT SERIALIZATION TO POINT TO AN         @ZA33186 58057040
*           EXTENDED ECB. THIS MAY RESULT IN A LOST POST.      @ZA33186 58060040
*                                                                       58065040
*********************************************************************** 58085040
         EJECT                                                          58195001
* SVC POST (SVC 2)                                                      58245001
*  ENTER WITH ECB ADDRESS IN REGISTER 1.                                58295001
*  ENTER WITH POST CODE IN REGISTER 0.                                  58345001
* FUNCTION.                                                             58395001
*  POST WILL SET COMPLETION FLAG AND CODE IN ECB. IF POST TRIES TO POST 58445001
*  A POSTED TCB, IT IGNORES POSTING AND EXITS.                          58465040
*  INPUT ECB'S PROTECT KEY IS TESTED IF EQUAL TO WAITING TCB, IF ENTRY  58545001
*  BY NON SUPERVISER. IF ECB'S PROTECT KEY IS NOT CORRECT GO TO ABEND.  58565040
*  STORE POST CODE AND POST FLAG IS ECB. THEN DECREMENT WAITING RB'S    58645002
*  WAIT COUNT. IF DECREMENTED WAIT COUNT IS ZERO, CHECK THE SEARCH ECB  58665040
*  FLAG IN THE RB. IF THE FLAG IS ON, FIND OUT THE POSITION OF THE RB   58695040
*  IN ITS QUEUE. IF RB IS THE TOP RB, GET ECB LIST ADDRESS FROM TCB     58745040
*  SAVE REGISTER 1. IF RB IS NOT TOP OF IT'S QUEUE, GET THE RB JUST     58795040
*  ABOVE THE REQUESTING RB. FIND OUT THE TYPE OF RB IT IS, AND GET THE  58845040
*  ECB LIST ADDRESS FROM REGISTER 1 SAVE AREA ACCORDANTLY. AFTER LIST   58895040
*  ADDRESS HAS BEEN FOUND, RESET ALL ECB WAIT FLAG.                     58945040
         SPACE 2                                                        59045001
*/*POST: CHART*/                                                        59055002
IGC001   CSECT                                                          59095001
         SPACE 2                                                        59145001
         CNOP  0,8                                                      59195001
*        SET UP BASE REGISTERS FOR DSECTS                               59245001
         USING RBSECT,XRRB             RB                               59265040
         USING TCB,XRTCB               TCB                              59295040
*/* E IGC002*/                                                          59395002
IGC002   BALR  XRBASE,ZERO             SET UP ADDRESSABILITY            59445040
*/* P INITIALIZE REGISTERS*/                                            60905002
         USING *,XRBASE                INCLUDING THE BASE REG           60925040
         L     XRRETURN,CVTEXP1-CVTMAP(,R3)  GET EXIT PROL FORCE ENTRY  60955002
         USING ASCB,XRASCB             ASCB BASE REG                    60995002
         L     XRSAVE,ASCBASXB         GET ASXB ADDR                    61045002
         USING ASXB,XRSAVE             ASXB BASE                        61095002
         L     XRSAVE,ASXBSPSA         ADDR OF SAVT                     61145002
         USING WSAL,XRSAVE                                              61195002
         L     XRSAVE,WSALPOST         POST WSA                         61245002
         DROP  XRSAVE                                                   61295002
         LR    XRECB,R1                                                 61345002
         LR    XRPTCODE,R0             SAVE INPUT REGS                  61395002
*/* D (NO,AUTHXMP,YES,) SUPVR KEY CALLER*/                              61445002
         TM    RBOPSW+ONE-RBSECT(XRRB),SUPTST  SUPERVISOR KEY CALLER    63245002
         BC    ONE,AUTHXMP          NO,BRANCH                           63295002
*/* D (YES,XMPROC,NO,RBCHECK) XMPOST REQUEST*/                          63305002
         LTR   XRECB,XRECB              IS THIS AN XMP REQUEST?         63345002
         BM    XMPROC                   YES, GO TO PROCESS IT           63395002
         B     RBCHECK                  NO, GO TO MAINLINE CODE         63445002
*/*TESTADOM: D (YES,XMPROC,NO,ECBVALID) XMPOST REQUEST*/                63495002
TESTADOM LTR   XRECB,XRECB              IS THIS AN XMP REQUEST?  SRB467 63595002
         BM    XMPROC                   YES, GO TO PROCESS IT  @YM02645 63645002
         B     ECBVALID                 ELSE, PROCESS NORMALLY   SRB467 63695001
*/*AUTHXMP: S TESTAUTH: PP CALLER*/                                     63705002
AUTHXMP  DS    0H                                                       63745002
* GO TO TEST HIS AUTHORITY TO SEE IF HE CAN ISSUE A CROSS MEMORY POST   63795002
         STM   XRRETURN,XRBASE,FOUR*XRRETURN(XRSAVE) SAVE RET AND BASE  63845002
*/* D (AUTH,TESTADOM,FAIL,) RESULTS OF TESTAUTH*/                       63855002
         TESTAUTH RBLEVEL=1,FCTN=1,STATE=YES,BRANCH=YES                 63895002
* RETURN CODE OF 0 OR 4 IN REG 15 TELLS THE STORY                SRB467 64345002
         LR    XRWORK,XRBASE           GET RETURN CODE                  64365040
         LM    XRRETURN,XRBASE,FOUR*XRRETURN(XRSAVE)                    64445002
*  THE FOLLOWING BRANCH TABLE WILL HANDLE THE RETURN CODE FROM TESTAUTH 64645001
TESTAUBR B     TESTAUBR+FOUR(XRWORK)   CHECK THE RETURN CODE     SRB467 64665040
         B     TESTADOM                IF ZERO, HE IS AUTHORIZED SRB467 64745001
*                                      IF NOT-IGNORE THE XMP REQ SRB467 64795002
*                                      AND FALL THROUGH          SRB467 64845001
*/*ECBVALID: S IEA0VL01: VALIDITY CHECK ADDRESS*/                       64895002
ECBVALID DS    0H                                                       65045002
         LR    R1,XRECB                SET UP REGISTER 1                65145002
         LA    XRSCRTCH,L3(,R1)        GET WORD END ADDR                65165040
         STM   R14,R15,FOUR*R14(XRSAVE) SAVE REGS 14-15                 65195040
         L     R15,CHECK               GET VAL CHK ADR                  65215002
         BALR  R14,R15                 BR TO VAL CHK RTN                65225002
         LM    R14,R15,FOUR*R14(XRSAVE) RESTORE REGS                    65230040
*/* D (OK,RBCHECK,FAIL,ERROR1) RESULTS OF VALIDITY CHECK*/              65285002
         BNE   ERROR1                  BRANCH TO ABTERM                 65345002
         B     RBCHECK                 UNCONDITIONALLY BRANCH           65395002
         EJECT                                                          65445001
*  ENTRY POINT IEA0PT01                                                 65545001
         SPACE 1                                                        65595001
         USING *,XRBASE                                                 65645001
*/* E IEA0PT01*/                                                        65695002
*                                                                       65701002
*              FOR LOCAL POST, THE CODE IS SUCH THAT REGS 12-13         65707002
*              ARE IMPLICITLY SAVED. SEE COMMENT ON IEA0PT02            65713002
*              ENTRY.                                                   65719002
*              NOTE THAT ONLY REGS 0-9 ARE SAVED ON A XMPOST            65725002
*              BRANCH ENTRY (WITH THE LOCAL LOCK AND MEMORY RELATED).   65731002
*                                                                       65737002
*/*IEA0PT01: P SET BRANCH ENTRY SWITCH- REG 14 NEG*/                    65745002
IEA0PT01 O     XRRETURN,TIDBIT         SET BR ENTRY SW                  65765040
*/* D (YES,XMPOST,NO,) XMPOST REQUEST*/                                 65797002
         LTR   R11,R11                 TEST FOR XMPOST REQ              65801040
         BM    XMPOST                  BR IF SO                         65805040
*/* P GET ADDR OF LOCAL SAVE AREA- SAVE REGS*/                          65817002
         L     XRBASE,PSAAOLD          GET CURRENT ASCB ADDR            65821040
         L     XRBASE,ASCBASXB-ASCB(,XRBASE)  GET ADDR OF ASXB          65845002
         L     XRBASE,ASXBSPSA-ASXB(,XRBASE)  GET ADDR OF LCL WSAVT     65905002
         L     XRBASE,WSALPOST-WSAL(,XRBASE)  GET ADDR OF POST WSA      65965002
         STM   R0,R9,0(XRBASE)         SAVE REGS 0-9                    66045002
         LR    XRECB,R11               ECB ADDR                         66095002
         LR    XRSAVE,XRBASE           SAVE AREA BASE REG               66195002
         BALR  XRBASE,R0               ESTABLISH BASE REG               66245002
         USING *,XRBASE                ADDRESSABILITY                   66255002
         L     XRBASE,BASE             GET COMMON BASE ADDR             66265002
         USING IGC002+2,XRBASE         COMMON BASE                      66275002
*/*SETMREGS: P INITIALIZE MAINLINE REGS*/                               66275140
SETMREGS EQU   *                       SET MAINLINE REGS       @Z40EPVD 66275240
         LR    XRPTCODE,R10            POST CODE               @Z40EPVD 66275340
         L     XRASCB,PSAAOLD          ADDR OF CURR ASCB                66275402
*/*ECBCHECK: D (NO,RBCHECK,YES,) POST WITHOUT ECB*/                     66277402
ECBCHECK LTR   XRECB,XRECB             TEST FOR POST W/O ECB            66279002
         BNZ   RBCHECK                 NO, GO TO MAINLINE               66285002
*/* P GET WAITING RB ADDR*/                                             66285402
         LR    XRRB,XRPTCODE           INSTEAD OF POST CODE, RB ADDR    66287002
         LR    XRTCB,XRRB              DUPLICATE                        66287140
*/*TCBLOOP: P FIND TCB ADDR FROM RBCHAIN*/                              66287402
TCBLOOP  TM    RBSTAB2-RBSECT(XRTCB),TCBIND  NEXT RB OR TCB             66289102
         L     XRTCB,RBLINK-RBSECT(XRTCB)    GET CHAIN PTR FROM RB      66290140
         BZ    TCBLOOP                 BR IF RB LINK                    66294102
*/* EVSWCF: D (YES,EXIT,NO,) WAIT COUNT ALREADY ZERO */                 66294503
EVSWCF   SR    XRWAITCT,XRWAITCT       CLEAR REG               @Y30HPVA 66296003
         CLI   RBWCF,ONE               WAIT COUNT IS ALREADY ZERO       66297902
         BL    EXIT                    YES, BR                          66299802
*/* EVNTLP1: D (YES,,NO,EVNTCK1) ARE THERE ANY MORE EVENT TABLES */     66305503
         LA    XRRB,0(,XRRB)           CLEAR HIGH BYTE         @Y30HPVA 66305603
         L     XRWORK,TCBEXT2-TCB(,XRTCB) GET PTR TO EXTENSION @Y30HPVA 66305703
         L     XRWORK,TCBEVENT-TCBXTNT2(,XRWORK) GET POINTER   @Y30HPVA 66309303
*                                      TO FIRST EVENT TABLE    @Y30HPVA 66312303
EVNTLP1  LTR   XRWORK,XRWORK          ARE THERE ANY MORE TABLES@Y30HPVA 66317203
         BZ    EVNTCK1                 NO, BRANCH              @Y30HPVA 66317603
*/* EVN1:   D (YES,,NO,EVNTCT1) IS TABLE WAITING ON POSTED RB*/         66320603
         CL    XRRB,EVNTRBP-EVNT(,XRWORK) IS TABLE WAITING ON  @Y30HPVA 66321640
*                                      POSTED RB               @Y30HPVA 66325803
         BNE   EVNTCT1                 NO, BRANCH              @Y30HPVA 66328503
*/* EVN2: P ZERO TABLE WAITING RB POINTER */                            66332003
         ST    XRWAITCT,EVNTRBP-EVNT(,XRWORK)  ZERO RB POINTER @Y30HPVA 66336503
*/* EVNTCT1: P (,EVNTLP1) POINT TO NEXT EVENT TABLE */                  66338503
EVNTCT1  L     XRWORK,EVNTLNK-EVNT(,XRWORK) POINT TO NEXT TABLE@Y30HPVA 66341503
         B     EVNTLP1                 LOOP TILL NO            @Y30HPVA 66347003
*                                      MORE TABLES             @Y30HPVA 66349503
*/*EVNTCK1: P DECREMENT WAIT COUNT IN RB*/                              66350203
EVNTCK1  IC    XRWAITCT,RBWCF          GET RB WAIT COUNT                66350903
         BCTR  XRWAITCT,R0             DECREMENT IT                     66351603
         STC   XRWAITCT,RBWCF          RESET IT IN RB                   66352303
*/*  D (YES,SETRBPFX,NO,EXIT)WAIT COUNT IS NOW ZERO */                  66353003
         LTR   XRWAITCT,XRWAITCT       IS WAIT COUNT ZERO      @Y30HPVA 66354003
         BNZ   EXIT                    BR IF COUNT STILL NOT ZERO       66355003
         B     SETRBPFX                COUNT ZERO, CLEAN UP             66357003
         SPACE 2                                                        66360503
         USING IEA0PT01,XRBASE                                          66363503
*/*XMPOST: D (YES,,NO,XMPOSTNL) LOCAL LOCK HELD AT ENTRY */             66367003
XMPOST   SETLOCK TEST,TYPE=LOCAL,BRANCH=(NOTHELD,XMPOSTNL)     @Y02752  66369003
*/* D (YES,,NO,XMPOSTNL) IS XMPOST REQ MEMORY RELATED */                66370503
         LTR    R12,R12                TEST ERRET ADDRESS HI BIT@Y02752 66371540
         BM     XMPOSTNL               BR IF NOT MEMORY RELATED @Y02752 66374040
*/* P SET BR ENTRY FLAG TO ZERO FOR LATER FLIP*/                        66377503
         LA     XRRETURN,0(,XRRETURN)  RESET HI BIT FOR XOR             66378540
*/* P SAVE REGS 0-9 */                                                  66384503
QJ10     L     XRBASE,PSAAOLD          GET SAVE AREA ADDRESS            66385040
         L     XRBASE,ASCBASXB-ASCB(,XRBASE)  GET ADDR OF ASXB          66388003
         L     XRBASE,ASXBSPSA-ASXB(,XRBASE)  GET ADDR OF SPSA          66391503
         L     XRBASE,WSALPOST-WSAL(,XRBASE)  GET ADDR OF SAVE AREA     66395003
         STM   R0,R9,0(XRBASE)         SAVE REGS 0-9                    66396040
         LR    R9,XRBASE               SAVE ADDR OF SAVE AREA           66397040
*/*XMPOSTNL: P FLIP BRANCH ENTRY FLAG*/                                 66401040
XMPOSTNL DS    0H                      INITIALIZE BASE REG              66403040
         BALR  XRBASE,R0               ESTAB ADDRESSABILITY             66405040
         USING *,XRBASE                                                 66409003
         L     XRBASE,BASE             GET MODULE BASE                  66410040
         USING IGC002+2,XRBASE                                          66413003
         X     XRRETURN,TIDBIT         FLIP BR ENTRY FLAG       @Y02752 66414040
*/*XMPOST1: P (,XMPPROC) INITIALIZE MAINLINE REGS*/                     66416040
XMPOST1  L     XRASCB,PSAAOLD          CURRENT ASCB ADDR       @Z40EPVD 66416540
         LR    R5,R11                  SAVE ECB ADDR                    66417040
         LR    R6,R12                  SAVE ERRET ADDR                  66419040
         LR    R8,R13                  SAVE TARGET ASCB ADDR            66421040
         B     XMPPROC                 TO MAINLINE XMPOST               66423040
         SPACE 2                                                        66427003
*/* E IEA0PT02 */                                                       66428003
*   ENTRY POINT IEA0PT02                                                66429003
         SPACE 1                                                        66431003
         USING *,XRBASE                SET TEMP BASE                    66438040
*/*IEA0PT02: P FIND LOCAL SAVE AREA AND SAVE REGS*/                     66455002
*              ACROSS THIS INTERFACE REGISTERS 0-9 ARE                  66460002
*              SAVED, BUT THE NON-USE OF REGS 12-13 IS SUFFICIENT       66465002
*              TO ALLOW THAT THEY ARE SAVED...IF THE REGISTER USAGE     66470002
*              IS CHANGED, THE POST LOCAL SAVE AREA MUST BE             66475002
*              UTILIZED TO SAVE REGS 12-13.                             66480002
*                                                                       66485002
IEA0PT02 L     XRBASE,PSAAOLD          GET CURRENT ASCB                 66495002
         L     XRBASE,ASCBASXB-ASCB(,XRBASE)  ASXB ADDR                 66505002
         L     XRBASE,ASXBSPSA-ASXB(,XRBASE)  LCL WSAVT                 66515002
         L     XRBASE,WSALPOST-WSAL(,XRBASE)  POST WSA                  66525002
         STM   R0,R9,0(XRBASE)         SAVE REGS                        66539002
*/* P SET UP MAINLINE REGS*/                                            66539402
         LR    XRECB,R11               ECB ADDR                         66541002
         LR    XRPTCODE,R10            POST CODE                        66543002
         LR    XRSAVE,XRBASE           WSA BASE REG                     66543402
         BALR  XRBASE,R0               EST ADDR                         66543802
         USING *,XRBASE                EST BASE REG                     66544202
         L     XRBASE,BASE             COMMON BASE ADDR                 66544602
         USING IGC002+2,XRBASE         COMMON BASE ADDR                 66544702
Q72Z     L     XRASCB,PSAAOLD          ADDR OF CURR ASCB                66554702
*/* P SET BR ENTRY SW- REG 14 NEG*/                                     66564702
         O     XRRETURN,TIDBIT         SET BR ENTRY SW                  66594702
         EJECT                                                          67545001
*/*RBCHECK: P LOAD ECB BEFORE IT IS CHECKED*/                  @ZA33186 67595040
RBCHECK  EQU   *                                               @ZA33186 67645040
*        LOAD ECB BEFORE IT IS CHECKED, IN CASE IT IS          @ZA33186 67695040
*        INITIALLY NEITHER WAITING OR POSTED BUT IT            @ZA33186 67745040
*        IS INITIALIZED TO POINT TO AN ECB EXTENSION BEFORE IT @ZA33186 67795040
*        IS POSTED.                                            @ZA33186 67845040
         L     R1,ZERO(,XRECB)         GET ECB                 @ZA33186 67895040
*/*RBCHECK2: D (YES,EVN3,NO,) IS ECB ALREADY WAITED UPON*/     @ZA33186 67945040
RBCHECK2 TM    ECBCC-ECB(XRECB),ECBWAIT  Q.IS ECB WAITING      @ZA33186 67995040
         BO    EVN3                    YES, GO PROCESS         @ZA33186 68045040
*/* D (YES,EXIT,NO,) IS ECB ALREADY POSTED*/                   @ZA33186 68095040
         TM    ECBCC-ECB(XRECB),ECBPOST  Q. IS ECB POSTED      @ZA33186 68145040
         BO    EXIT                    YES, EXIT               @ZA33186 68195040
*/* P MARK ECB POSTED USING CS*/                               @ZA33186 68245040
*        THE ECB IS NOT WAITING OR POSTED                      @ZA33186 68295040
         N     XRPTCODE,OFFWAIT        RESET WAIT BIT          @ZA33186 68345040
         O     XRPTCODE,ONCOMPL        SET POST BIT            @ZA33186 68395040
         CS    R1,XRPTCODE,ZERO(XRECB) POST IT                 @ZA33186 68445040
*/* D (YES,EXIT,NO,RBCHECK2) WAS CS SUCCESSFUL*/               @ZA33186 68495040
         BZ    EXIT                    EXIT IF SUCCESSFUL      @ZA33186 69034040
         B     RBCHECK2                ECB WAS MODIFIED, TRY   @ZA33186 69037040
*                                      AGAIN                   @ZA33186 69040040
*/*  EVN3: D (YES,,NO,TCBRBCHN) IS ECB EVENTS ECB*/                     69055003
EVN3     TM    ECBBYTE3-ECB(XRECB),ECBEVNT ECB EVENTS ECB?     @ZA15373 69055240
         BZ    NOEVENTS                NO, BRANCH              @Y30HPVA 69055940
*/* D (YES,EXTECB,NO,) DOES ECB EXTENSION EXIST*/                       69056140
         TM    ECBBYTE3-ECB(XRECB),ECBEXTND EXTENSION EXIST?   @Z40EPVD 69056240
         BO    EXTECB                  YES, EXT EXISTS         @Z40EPVD 69056340
*********************************************************************** 69056640
*                                                                     * 69056740
*        THE FOLLOWING CODE PROCESSES THE EVENT TYPE ECB              * 69056840
*                                                                     * 69056940
*********************************************************************** 69057040
*/* EVN4: S SETFRR: SET FRR FOR EVENTS PROCESSING */                    69057103
         LA    R1,EVNTFRR              LOAD FRR ADDRESS        @Y30HPVA 69057703
         SETFRR A,FRRAD=(1),WRKREGS=(XRWORK,XRSCRTCH)          @Y30HPVA 69058003
*                                                                       69058103
*        DETERMINE IF TABLE POINTER IN ECB IS VALID                     69058303
*        ENTRY TO FRR WILL CAUSE A 402 ABEND CODE                       69058603
*                                                                       69058703
*/* EVN5: N CHECK IF TCB ADDR IN TABLE POINTED TO BY ECB IS VALID TCB*/ 69058903
*/* EVN6: D (YES,,NO,ABEND402) TCB ADDR VALID*/                         69059203
         L     XRSCRTCH,ZERO(,XRECB)   GET TABLE POINTER       @Y30HPVA 69059303
         BCTR  XRSCRTCH,ZERO           CLEAR LOW BIT           @Y30HPVA 69059603
         L     XRTCB,ASCBASXB          GET ASXB ADDR           @Y30HPVA 69059703
         L     XRTCB,ASXBLTCB-ASXB(,XRTCB)  GET LAST TCB ADDR  @Y30HPVA 69059903
         L     XRWORK,EVNTTCBP-EVNT(,XRSCRTCH) GET TCB ADDR    @Y30HPVA 69060103
*                                 FROM TABLE                   @Y30HPVA 69060403
EVNTTCBL CLR   XRWORK,XRTCB       TABLE TCB POINTER ON READY   @Y30HPVA 69060503
*                                 QUEUE                        @Y30HPVA 69060703
         BE    TCBOK              YES, BR FOR GOOD TCB         @Y30HPVA 69061003
         L     XRTCB,TCBBACK-TCB(,XRTCB)    BACK ONE TCB       @Y30HPVA 69061103
         LTR   XRTCB,XRTCB        END OF READY QUEUE           @Y30HPVA 69061303
         BNZ   EVNTTCBL           NO, CONTINUE LOOKING         @Y30HPVA 69061603
         B     ABEND402           YES, BAD TABLE ABEND         @Y30HPVA 69061703
*/* EVN7: N CHECK VALID TCB FOR VALID TABLE OFF THAT TCB */             69061903
*/*  TCBOK: D (YES,,NO,ABEND402) IS TABLE VALID FOR TCB */              69062203
TCBOK    LA    XRSCRTCH,ZERO(,XRSCRTCH)     CLEAR HIGH BYTE    @Y30HPVA 69062303
         L     XRWORK,TCBEXT2-TCB(,XRTCB) GET PTR TO EXTENSION @Y30HPVA 69062603
         L     XRWORK,TCBEVENT-TCBXTNT2(,XRWORK) GET FIRST     @Y30HPVA 69062803
*                                 TABLE ADDRESS                @Y30HPVA 69063003
EVNTTLP1 CLR   XRWORK,XRSCRTCH    TABLE ADDR MATCH             @Y30HPVA 69063403
         BE    TABLEOK            YES, TABLE IS GOOD           @Y30HPVA 69063703
         LTR   XRWORK,XRWORK      END OF TABLE QUEUE FOR TCB   @Y30HPVA 69063803
         BZ    ABEND402           YES, ABEND 402               @Y30HPVA 69063903
         L     XRWORK,EVNTLNK-EVNT(,XRWORK) NO, GET NEXT TABLE @Y30HPVA 69064003
*                                 IN QUEUE                     @Y30HPVA 69064103
         B     EVNTTLP1           CHECK FOR END                @Y30HPVA 69064303
*                                                                       69064603
*        TABLE AND TCB POINTER ARE VALID                                69064903
*        NEXT CHECK FOR WAITING RB ON TABLE - IF NOT WAITING            69065203
*        UPDATE TABLE AND ECB THEN EXIT                                 69065503
*        IF WAITING AND VALID RB UPDATE TABLE AND ECB AND USE           69065803
*        POST W/O ECB TO UPDATE THE RB AND ASCB                         69066103
*                                                                       69066403
*/* TABLEOK: D (YES,,NO,EVCKSP) DOES TABLE HAVE RB POINTER */           69066703
TABLEOK  L     XRRB,EVNTRBP-EVNT(,XRSCRTCH) RB POINTER FROM    @Y30HPVA 69067003
*                                 TABLE                        @Y30HPVA 69067103
         L     XRWORK,TCBRBP-TCB(,XRTCB) RB POINTER FORM TCB   @Y30HPVA 69067303
         LTR   XRRB,XRRB          IS RB IN TABLE               @Y30HPVA 69067603
         BZ    UPDEVT             NO, NOT WAITING              @Y30HPVA 69067903
EVRBCHK  LA    XRWORK,ZERO(,XRWORK)    CLEAR HIGH              @Y30HPVA 69068203
         CLR   XRWORK,XRRB        TEST FOR GOOD RB             @Y30HPVA 69068503
         BE    EVRBOK             BR IF RB OK                  @Y30HPVA 69068803
         TM    RBSTAB2-RBSECT(XRWORK),TCBIND TEST FOR LAST RB  @Y30HPVA 69069103
         L     XRWORK,RBLINK-RBSECT(,XRWORK) GET NEXT RB       @Y30HPVA 69069403
         BZ    EVRBCHK            CONTINUE CHECKING RB'S       @Y30HPVA 69069703
         B     ABEND402           ABEND FOR BAD RB PTR         @Y30HPVA 69070003
*                                                                       69070303
*        NOW HAVE GOOD RB. NEED TO CHECK FOR P.P. POSTEE                69070603
*        IF P.P. POSTEE, CHECK FOR SAME KEY ETC.                        69070903
*                                                                       69071203
*/* EVRBOK: D (YES,,NO,ABEND402) RB ENABLED */                          69071503
EVRBOK   TM    RBOPSW,ENABON      TEST FOR ENABLED             @Y30HPVA 69071803
         BNO   ABEND402           BR TO ABEND                  @Y30HPVA 69072103
*                                                                       69072403
*/* EVN8: D (YES,,NO,EVALCK) IS POSTEE SUPERVISOR KEY */                69072703
         TM    RBOPSW+ONE,SUPTST  CHECK FOR SUPV WAITER        @Y30HPVA 69073003
         BO    EVALCK             BR IF PROB PROG              @Y30HPVA 69073303
*/* EVCKSP: D (YES,UPDEVT,NO,EVALCK) IS POSTER SUPERVISOR */            69073603
EVCKSP   LTR   XRRETURN,XRRETURN  TEST FOR BRANCH ENTRY        @Y30HPVA 69073903
         BM    UPDEVT             BR IF BR                     @Y30HPVA 69074203
         L     XRWORK,PSATOLD     TEST FOR SRB                 @Y30HPVA 69074503
         LTR   XRWORK,XRWORK      CALLER                       @Y30HPVA 69074803
         BZ    UPDEVT             BR IF SRB CALLER             @Y30HPVA 69075103
         L     XRWORK,TCBRBP-TCB(,XRWORK) TEST IF SUPVR SVC    @Y30HPVA 69075403
         TM    RBOPSW+ONE-RBSECT(XRWORK),SUPTST  WAITER        @Y30HPVA 69075703
         BZ    UPDEVT             BR IF SUPVR WAITER           @Y30HPVA 69076003
*/* EVALCK: D (YES,UPDEVT,NO,) COM TASK ECB */                          69076303
EVALCK   L     XRSCRTCH,TCBJSCB   GET JSCB ADDR                @Y30HPVA 69077340
         USING IEZJSCB,XRSCRTCH                                @Y30HPVA 69080203
         L     XRSCRTCH,JSCBCSCB  GET CSCB ADDR                @Y30HPVA 69081240
         USING CSCB,XRSCRTCH                                   @Y30HPVA 69082603
         L     XRSCRTCH,CHECBP    GET COMMUNICATION'S          @Y30HPVA 69082740
*                                 ECB ADDRESS                  @Y30HPVA 69082840
         DROP  XRSCRTCH                                        @Y30HPVA 69083240
         LA    R1,ZERO(,R6)       CLEAR THE HIGH BYTE          @ZA08089 69083340
         CLR   XRSCRTCH,R1        CHECK ADDRS                  @Y30HPVA 69083540
         BE    UPDEVT             BRANCH IF EQUAL              @Y30HPVA 69083840
         SPACE                                                          69084240
*/*      L     CHECK VALIDITY OF ECB AGAINST USER KEY */                69084340
*                                                                       69084440
*        GOING TO USER KEY TO TEST ECB                                  69084540
*        IF STORE FAILS FRR WILL GET CONTROL                            69084640
*                                                                       69084703
         SR    XRSCRTCH,XRSCRTCH       CLEAR REGISTER          @Y30HPVA 69085003
         IC    XRSCRTCH,TCBPKF         GET USER PROTECT KEY    @Y30HPVA 69086003
         SPKA  ZERO(XRSCRTCH)          GO TO USER PROTECT KEY  @ZA08089 69087040
         L     XRSCRTCH,ZERO(,XRECB)   GET CONTENTS OF ECB     @Y30HPVA 69088003
EVNTLPC  CS    XRSCRTCH,XRSCRTCH,ZERO(XRECB) STORE INTO ECB    @Y30HPVA 69089003
         BNE   EVNTLPC                 LOOP TILL STORE COMPLETE@Y30HPVA 69090503
         SR    XRSCRTCH,XRSCRTCH       CLEAR REGISTER          @Y30HPVA 69091003
         SPKA  ZERO(XRSCRTCH)          GO TO KEY ZERO          @ZA08089 69091540
         SPACE                                                          69092003
*/* UPDEVT: P UPDATE TABLE POINTERS AND ECB */                          69092503
UPDEVT   L     XRWORK,ZERO(,XRECB)     GET TABLE ADDRESS       @Y30HPVA 69093503
         BCTR  XRWORK,ZERO             CLEAR LOW BIT           @Y30HPVA 69093703
         LA    XRWORK,ZERO(XRWORK)     CLEAR HIGH BYTE         @Y30HPVA 69093803
         L     XRSCRTCH,EVNTLSTA-EVNT(,XRWORK) GET PTR TO LAST @Y30HPVA 69094003
*                                      ACTIVE EVENT ENTRY      @Y30HPVA 69094740
*/* D (NO,,YES,ABEND502) IS TABLE FULL */                               69096503
         CL    XRSCRTCH,EVNTLST-EVNT(,XRWORK) CHECK FOR NO MORE@Y30HPVA 69097503
*                                 EVENT ENTRIES IN THIS TABLE  @Y30HPVA 69100503
         BE    ABEND502           TABLE FULL ABEND             @Y30HPVA 69102503
         SPACE 2                                                        69102840
*        THE ORDER IN WHICH THE EVENTS TABLE AND ECB WERE      @ZA11895 69103140
*        PROCESSED WAS CHANGED TO POST THE ECB FIRST AND THEN  @ZA11895 69103440
*        UPDATE THE EVENTS TABLE.                              @ZA11895 69103740
         SPACE 2                                                        69104040
         SR    R1,R1              INDICATE PROCES COMP         @Y30HPVA 69116503
         N     XRPTCODE,OFFWAIT   TURN OFF WAIT BIT            @Y30HPVA 69117503
         O     XRPTCODE,ONCOMPL   TURN ON POST IND             @Y30HPVA 69119503
         ST    XRPTCODE,ZERO(,XRECB)   UPDATE ECB              @Y30HPVA 69122503
         O     XRECB,TIDBIT       SET END OF LIST IND          @Y30HPVA 69122640
         ST    XRECB,FOUR(,XRSCRTCH) STOR PTR TO COMP ECB      @Y30HPVA 69122740
         MVI   ZERO(XRSCRTCH),ZERO   ZERO PREV END OF LIST IND @Y30HPVA 69122840
         LA    XRSCRTCH,FOUR(,XRSCRTCH) UPDATE PTR TO LAST     @Y30HPVA 69122940
*                                    EVENT ENTRY               @Y30HPVA 69123040
         ST    XRSCRTCH,EVNTLSTA-EVNT(,XRWORK) STORE PTR IN    @Y30HPVA 69123140
*                                 EVENT TABLE HEADER           @Y30HPVA 69123240
*/* EVN11: S DELETEFRR: DELETE FRR FOR EVENTS */                        69123503
DFRR     SETFRR D,WRKREGS=(XRWORK,XRSCRTCH) DELETE FRR         @Y30HPVA 69124503
         LTR   R1,R1              TEST FOR GOOD POST           @Y30HPVA 69126503
         BNE   EVSVC13            NO GOOD ISSUE ABEND          @Y30HPVA 69128503
*/* EVN12: D (NO,EXIT,YES,EVSWCF) CHECK IF RB WAITING */                69129503
         LTR   XRRB,XRRB          CHECK FOR WAITING RB         @Y30HPVA 69131503
         BZ    EXIT               NO RB EXIT                   @Y30HPVA 69133503
         B     EVSWCF             BRANCH TO POST W / O ECB     @Y30HPVA 69135503
*/* ABEND402: S DELETEFRR: DELETE FRR FOR EVENTS*/                      69136503
*/* EVN13: R ABEND 402*/                                                69139503
ABEND402 L     R1,ABND402         LOAD 402 ABEND CODE          @Y30HPVA 69140503
         B     DFRR               GO DELETE FRR                @Y30HPVA 69141503
*/* ABEND502: S DELETEFRR: DELETE FRR FOR EVENTS*/                      69142503
*/* EVN14: R ABEND 502*/                                                69145003
ABEND502 L     R1,ABND502         LOAD 502 ABEND CODE          @Y30HPVA 69148003
         B     DFRR               GO DELETE FRR                @Y30HPVA 69149003
EVSVC13  SVC   ABENINST           CALL ABEND                   @Y30HPVA 69150003
         EJECT                                                          69152003
*/* TCBRBCHN: L CHECK TCB/RB Q TO FIND WAITING RB */                    69154003
NOEVENTS L     XRRB,ZERO(,XRECB)   GET WAITING RB ADDRESS      @Y30HPVA 69155040
         LA    XRRB,0(XRRB)        PERFECT ADDR                         69158003
         L     XRWORK,ASCBASXB     ADDR OF ASXB                         69160003
         L     XRTCB,ASXBLTCB-ASXB(XRWORK)  ADDR OF LOWEST TCB          69165002
TCBRBCHN L     XRWORK,TCBRBP       ADDR OF TOP RB                       69175002
*/*RBADDR: D (NO,ERROR2,YES,) RB IS ON TCB/RB QUEUES*/                  69177002
RBADDR   CR    XRRB,XRWORK         CHK IF ADDR SAME AS ADDR IN ECB      69185002
         BE    RBOK                BR IF SO                             69187002
         TM    RBSTAB2-RBSECT(XRWORK),TCBIND  BACK TO TCB YET           69189002
         L     XRWORK,RBLINK-RBSECT(,XRWORK) ADDR OF NEXT BLOCK         69191002
         LA    XRWORK,ZERO(,XRWORK)   PERFECT ADDR                      69192002
         BZ    RBADDR              BR IF RB IS NEXT                     69193402
         L     XRTCB,TCBBACK       NEXT TCB IN RDY Q                    69193802
         LTR   XRTCB,XRTCB         TEST FOR TOP OF Q                    69194202
         BNZ   TCBRBCHN            BR IF NOT                            69194602
         B     ERROR2              RB NOT FOUND - ERROR                 69194702
*/*RBOK: D (NO,ERROR2,YES,) WAITING RB OPSW IS ENABLED*/                69244702
RBOK     TM    RBOPSW,ENABON       IS WAITER ENABLED                    69294740
         BC    DISAB,ERROR2        NO,ABEND                             69745040
*/* D (YES,SUPKEY1,NO,) WAITING RB OPSW IS SUPVR KEY*/                  69805002
         TM    RBOPSW+ONE,SUPTST   RBOPSW=KEY 0?                        69835002
         BZ    SUPKEY1             YES,BR                               69865002
*/* S IEA0VL01: VALIDITY CHECK ADDRESS*/                                69905002
         LR    R1,XRECB            START ADDR                           69945002
         LA    XRSCRTCH,L3(,R1)    END ADDR                             69995002
         STM   R14,R15,FOUR*R14(XRSAVE)  SAVE 14-15                     70045002
         L     R15,CHECK           ADDR OF VAL CHK RTN                  70095002
         BALR  R14,R15             GO WITH WAITING TCB ADDR IN 4        70145002
         LM    R14,R15,FOUR*R14(XRSAVE)  RESET 14-15                    70195002
*/* D (FAIL,,OK,SUPKEY) RESULTS OF VALIDITY CHECK*/                     70245002
         BZ    SUPKEY              BR IF OK                    @YM04972 70250002
         L     XRSCRTCH,TCBJSCB    GET JSCB ADDR               @YM04972 70255002
         USING IEZJSCB,XRSCRTCH                                @YM04972 70260002
         L     XRSCRTCH,JSCBCSCB   GET CSCB ADDR               @YM04972 70265002
         USING CSCB,XRSCRTCH                                   @YM04972 70270002
         L     XRSCRTCH,CHECBP     GET COMMUNICATION'S         @YM04972 70275002
*                                  ECB ADDRESS                 @YM04972 70287002
         DROP  XRSCRTCH                                                 70288002
         LA    R1,ZERO(,R1)        CLEAR THE HIGH BYTE         @YM04972 70289002
*/* D (YES,SUPKEY,NO,ERROR2) COMM. ECB */                               70291040
         CLR   XRSCRTCH,R1         CHECK ADDRS                 @YM04972 70291240
         BNE   ERROR2              BRANCH IFF ERROR            @YM04972 70291540
*/*SUPKEY: D (YES,POSTTEST,NO,) EXPLICIT WAIT BIT IS ON IN RB*/         70292502
SUPKEY   DS    0H                                                       70293002
         S     XRRB,WPRBPREL       SUBTRACT FROM BASE                   70295040
         TM    RBFLAGS1-RBPREFIX(XRRB),RBXWAIT    DID RB ISSUE A WAIT?  70299002
         LA    XRRB,RBPRFXLN(XRRB) RESTORE BASE                         70300040
         BO    POSTTEST            YES,BRANCH TO MAINLINE CODE          70301040
*/*SUPPL: P (,QENTRY2) SET TO POST ECB */                               70309002
*              THE RB THE ECB POINTS TO IS NOT WAITING. SET             70311002
*              UP TO MAKE THE ECB LOOK POSTED.                          70314002
SUPPL    L     R1,ZERO(,XRECB)     GET ECB FOR CS              @YM02496 70317002
         B     QENTRY2             GO TO SET IT POSTED         @YM02496 70321002
         SPACE 1                                                        70323002
*/*SUPKEY1: D (YES,SUPKEY,NO,)   SUPERVISOR (KEY) CALLER*/              70325002
*              THESE TESTS ASSURE THAT A SUPERVISOR KEY WAITER          70330002
*              IS POSTED ONLY BY A SUPERVISOR KEY POSTER OR THE         70332002
*              ECB TO BE POSTED IS THE SAME AS THE ECB WAITED ON.       70335002
SUPKEY1  LTR   XRRETURN,XRRETURN   TEST IF BR ENTRY            @YM00429 70338002
         BM    SUPKEY              BR IF BRANCH ENTRY          @YM00429 70341002
SUPKEYX  L     R1,PSATOLD          GET CURRENT TCB POINTER     @YM00429 70345002
         LTR   R1,R1               TEST IF SRB MODE FOR XMPOST @YM00429 70355002
         BZ    SUPKEY              BR IF XMPOST                @YM00429 70365002
         L     R1,TCBRBP-TCB(,R1)  GET TOP RB POINTER          @YM00429 70375002
         TM    RBOPSW+ONE-RBSECT(R1),SUPTST CALLER SUPER KEY   @YM00429 70385002
         BZ    SUPKEY              BR IF SUPER CALLER          @YM04247 70390040
*/* D (NO,SUPPL,YES,) IS RB IN EXPLICIT WAIT*/                          70395802
         S     XRRB,WPRBPREL       SUBTRACT FROM BASE                   70396240
         TM    RBFLAGS1-RBPREFIX(XRRB),RBXWAIT    DID RB ISSUE A WAIT?  70397402
         LA    XRRB,RBPRFXLN(XRRB) RESTORE BASE                         70397840
         BZ    SUPPL               BR NOT EXPLICIT WAIT        @YM02496 70399002
*/* D (YES,POSTTEST,NO,ERROR2) ECB ADDRESSES MATCH */                   70400002
         L     R1,TCBGRS1          SET ECB ADDR REG            @YM04247 70413002
         LA    XRECB,ZERO(,XRECB)  CLEAR HIGH                  @YM04247 70417002
         CL    XRRB,TCBRBP         WAITER TOP RB               @YM04247 70421002
         BE    SUPKEY2             YES, TCBGRS1 IS OK          @YM04247 70429002
         L     R1,TCBRBP           GET TOP RB                  @YM04247 70437002
SUPKEYN  L     XRWORK,RBLINK-RBSECT(,R1)    GET NEXT RB        @YM04247 70445002
         LA    XRWORK,ZERO(,XRWORK)  CLEAR HIGH BYTE           @YM04247 70453002
         CLR   XRWORK,XRRB         CHECK FOR WAITER RB         @YM04247 70461002
         BE    SUPKEYR             BR IF MATCH(R1 HAS IRB ADDR)@YM04247 70469002
         LR    R1,XRWORK           SET FOR NEXT CHECK          @YM04247 70477002
         B     SUPKEYN             CHECK NEXT RB               @YM04247 70485002
SUPKEYR  L     R1,RBGRS1-RBSECT(,R1) GET ADDR OF ECB           @YM04247 70493002
SUPKEY2  LCR   XRWORK,R1           TEST FOR LIST               @YM04247 70501002
         BP    SUPKGL              BR IF LIST                  @YM04247 70509002
         LA    R1,ZERO(,R1)        CLEAR HIGH                  @YM04247 70517002
         CLR   R1,XRECB            TEST FOR SAME ECB           @YM04247 70525002
         BE    POSTTEST            SAME ECB IS OK              @YM04247 70533002
         B     ERROR2              ABEND THE BAD GUY           @YM04247 70541002
SUPKGL   L     R1,ZERO(,XRWORK)    GET ECB ADDR                @YM04247 70549002
         LA    R1,ZERO(,R1)        CLEAR HIGH                  @YM04247 70557002
         CLR   R1,XRECB            CHECK FOR SAME              @YM04247 70565002
         BE    POSTTEST            BR IF OK                    @YM04247 70573002
         TM    ZERO(XRWORK),TCBIND TEST FOR LAST               @YM04247 70581002
         BO    ERROR2              ABEND IF END OF LIST        @YM04247 70589002
         LA    XRWORK,FOUR(,XRWORK) INCR LIST ADDR             @YM04247 70593002
         B     SUPKGL              CONTINUE                    @YM04247 70597002
         EJECT                                                          70627040
*/* E IEA0PT03*/                                                        70657040
IEA0PT03 EQU   *                   BRANCH ENTRY LABEL          @Z40EPVD 70687040
*/* P GET ADDR OF LOCAL SAVE AREA - SAVE REGS*/                         70717040
         L     XRBASE,PSAAOLD      GET CURRENT ASCB ADDR       @Z40EPVD 70747040
         L     XRBASE,ASCBASXB-ASCB(XRBASE) ASXB ADDR          @Z40EPVD 70777040
         L     XRBASE,ASXBSPSA-ASXB(XRBASE) LOCAL WSAVT ADDR   @Z40EPVD 70807040
         L     XRBASE,WSALPOST-WSAL(XRBASE) POST WSA ADDR      @Z40EPVD 70827040
         STM   R0,R14,LSAEXT-LSA(XRBASE)    SAVE CALLERS REGS  @Z40EPVD 70837040
*/* P INDICATE EXT SAVE AREA IN USE*/                                   70897040
         OI    LSAFLGS-LSA(XRBASE),EXTSA  EXTSAVE AREA IN USE  @Z40EPVD 70927040
         LR    R9,XRBASE                SAVE AREA BASE REG     @Z40EPVD 70937040
         BALR  XRBASE,R0                ESTABLISH BASE REG     @Z40EPVD 70967040
         USING *,XRBASE                 ESTAB ADDRESSABILITY   @Z40EPVD 70987040
         L XRBASE,BASE                  GET COMMON BASE ADDR   @Z40EPVD 71007040
         USING IGC002+2,XRBASE          COMMON BASE            @Z40EPVD 71027040
*/* P SET BRANCH ENTRY SWITCH - REG 14 NEGATIVE*/                       71107040
         O     XRRETURN,TIDBIT          SET BR ENTRY SWITCH    @Z40EPVD 71137040
*/* D (YES,XMPOST1,NO,SETMREGS) XMPOST REQUEST*/                        71167040
         LTR   R11,R11                  XMPOST REQUEST         @Z40EPVD 71197040
         BM    XMPOST1                  YES GO PROCESS         @Z40EPVD 71217040
         LR    XRECB,R11                SAVE INPUT ECB ADDR    @Z40EPVD 71237040
         LR    XRSAVE,R9                INIT SAVE AREA BASE    @Z40EPVD 71257040
         B     SETMREGS                 GO INIT MAINLINE REGS  @Z40EPVD 71277040
         EJECT                                                          71317040
*  TEST IF POST FLAG IN ECB ON. YES ON, GO TO EXIT SECTION. NO NOT ON,  71645001
* STORE POST CODE AND SET POST FLAG IN ECB.                             71695001
*  DECREMENT RB'S WAIT COUNT. DECREMENTED WAIT COUNT ZERO GO TO EXIT    71745001
* SECTION. COUNT NOT ZERO CONTINUE PROCESS.                             71795001
         SPACE 2                                                        71845001
*/*POSTTEST: P PICK UP ECB FOR LATER COMPARE AND SWAP*/                 71855002
POSTTEST L     R1,ZERO(,XRECB)         GET OLD ECB             @YM02795 71865040
*/* D (YES,EXIT,NO,) ECB'S POST BIT IS ALREADY ON*/                     71885002
         TM    0(XRECB),ECBPTFLG       Q. ECB'S POST FLAG SET           71890040
         BO    EXIT                    YES,EXIT                         71945002
*/* D (NO,QENTRY2,YES,) SOMEONE IS WAITING ON THIS ECB*/                71955002
         TM    0(XRECB),ECBWTFLG       Q. POST BEFOR WAIT               71995002
         BZ    QENTRY2                 YES,BRANCH                       72045002
*/* D (YES,QENTRY2,NO,) RB WAIT COUNT IS ALREADY ZERO*/                 72095002
         TM    RBWCF,ANYONE            Q. IS WAIT COUNT ZERO            72395001
         BZ    QENTRY2                 YES.BRANCH                 19472 72445001
*/* P DECREMENT WAIT COUNT*/                                            72455002
         SR    XRWAITCT,XRWAITCT       INIT REG TO ZERO           19472 72475040
         IC    XRWAITCT,RBWCF          LOAD ECBS RB WAIT COUNT          72495040
*/* D (NO,QENTRY,YES,) WAIT COUNT IS NOW ZERO*/                         72595002
         BCT   XRWAITCT,QENTRY         DECR WAIT CT.NOT 0,BR     A33247 72615040
         EJECT                                                          72695001
*  WAIT COUNT IS ZERO. TEST RB'S ECB SEARCH FLAG. IF FLAG NOT ON GO TO  72745001
* NEXT SECTION. IF FLAG IS ON RESET IT AND TEST IF RB ON TOP OF IT'S    72795001
* QUEUE. IF RB IS TOP OF IT'S QUEUE GET ECB LIST ADDRESS FROM TCB'S     72845001
* REGISTER 1 SAVE AREA. IF RB NOT TOP OF IT'S QUEUE FIND OUT WHAT TYPE  72895001
* OF RB IS ON TOP OF IT. THEN GET ECB LIST ADDRESS FROM WHEREVER THE    72945001
* REGISTER 1 IS SAVED IN THAT TYPE OF RB. AFTER GETTING ECB LIST        72995001
* ADDRESS, GO AND RESET  ALL THE ECB'S WAIT FLAGS TO ZERO.              73045001
         SPACE 2                                                        73095001
*/* D (NO,TCBREADY,YES,) RB SEARCH BIT IS ON*/                          73105002
         TM    RBSTAB2,RBECBWT          Q.ECB'S SEARCH FLAG SET         73125040
         BZ    TCBREADY                 NO BRANCH                       73195001
*/*LOOP3: P FIND TCB- GET SAVED ECBLIST ADDRESS*/                       73205002
         C     XRRB,TCBRBP              Q.ECB'S RB TOP OF QUEUE         73225040
         BE    TCBXR1                   YES BRANCH                      73295001
         L     XRWORK,TCBRBP            LD TOP RB'S ADR                 73315040
LOOP3    L     XRECBPTR,RBGRS1-RBSECT(XRWORK)   LD RB REG 1             73355002
         L     XRWORK,RBLINK-RBSECT(XRWORK)     LD NEXT RB'S ADR        73395002
         LA    XRWORK,0(XRWORK)         ZERO BITS S-7                   73445002
         CR    XRWORK,XRRB              Q.FOUND WAITING RB              73465040
         BNE   LOOP3                    NO, BRANCH                      73545002
         B     RESETWT                  AVOID NEXT INST                 73745001
TCBXR1   L     XRECBPTR,TCBGRS1         LD TCB REG 1                    73795002
RESETWT  LCR   XRECBPTR,XRECBPTR        LD TRUE ECB LIST ADR            73845001
         EJECT                                                          74745001
         LR    XRWORK,XRECBPTR          SAVE ECB PTR REG                74795040
*/* D (YES,NOCHECK,NO,) WAITER IS SUPVR KEY*/                           75715002
         TM    RBOPSW+ONE,SUPTST        IS WAITER SUPVR KEY?            75745002
         BC    KEY0,NOCHECK             YES,BYPASS VALIDTY CHECK        75795001
*/*LOOP4: S IEA0VL01: VALIDITY CHECK ALL ADDRS IN ECBLIST*/             75845002
LOOP4    L     R1,ZERO(XRECBPTR)        GET ECB ADDRESS                 75895040
         LA    XRSCRTCH,L3(,R1)         END ADDR FOR VAL CHK            75995002
         STM   R14,R15,FOUR*R14(XRSAVE) SAVE REGS 14-15                 76015040
         L     R15,CHECK                GET RTN ADDR                    76045040
         BALR  R14,R15                  GO TO VAL CHK                   76065040
         LM    R14,R15,FOUR*R14(XRSAVE) RESTORE REGS 14-15              76075040
*/* D (FAIL,COMMCHEK,OK,) RESULTS OF VALIDITY CHECK*/                   76087002
         BNZ   COMMCHEK                 BRANCH IF NOT VALID             76095001
*/*LSTWRD: D (END,NOCHECK,MORE,LOOP4) NEXT ECB IN LIST, IF ANY*/        76105002
LSTWRD   TM    ZERO(XRECBPTR),LSTIND    Q. LAST WORD OF LIST?           76145001
         BC    LAST,NOCHECK             YES, BRANCH                     76195002
         LA    XRECBPTR,FOUR(XRECBPTR)  NO,INCREMENT POINTER            76245001
         B     LOOP4                    CHECK NEXT ECB                  76295001
         EJECT                                                          76395001
*/*NOCHECK: P  TURN OFF WAIT BIT IN EACH ECB IN LIST*/                  76445003
*/* N (,TCBREADY) THE ECB BEING POSTED DOES NOT HAVE ITS WAIT BIT       76505002
*/*TURNED OFF*/                                                         76565002
*              THE WAIT BIT IN THE ECB BEING POSTED BECAUSE OF THE MP   76645002
*              CONSIDERATIONS ON UPDATING ECBS.  THAT IS, ONCE THE WAIT 76745002
*              BIT IS TURNED OFF, ANOTHER CPU MAY UPDATE THE ECB.       76845002
NOCHECK  LR    XRECBPTR,XRWORK          RESET POINTER                   76895040
LOOP9    L     XRWORK,ZERO(XRECBPTR)    SET PTR TO ECB                  77595001
         CLR   XRWORK,XRECB             THIS THE POSTING ECB   @YM02795 77600040
         BE    LOOP9A                   YES, BRANCH PAST NI    @YM02795 77605040
         NI    ZERO(XRWORK),RECBWTF     TURN OFF WAIT BIT               77645001
LOOP9A   TM    ZERO(XRECBPTR),LSTIND    Q.  LAST ECB?                   77695002
         BC    LAST,TCBREADY            YES, BRANCH                     77715040
         LA    XRECBPTR,FOUR(XRECBPTR)  NO, INCREMENT PTR TO NEXT ECB   77795001
         B     LOOP9                    PROCESS NEXT ECB                77845001
*********************************************************************** 77895001
*/*COMMCHEK: P GET CSCB VIA JSCB*/                                      77905002
COMMCHEK L     XRSCRTCH,TCBJSCB         GET JSCB ADDR             20002 77945002
         USING IEZJSCB,XRSCRTCH                                   20002 77995002
         L     XRSCRTCH,JSCBCSCB        GET CSCB ADDR             20002 78045002
         USING CSCB,XRSCRTCH                                      20002 78095002
         L     XRSCRTCH,CHECBP          GET COMMUNICATION'S       20002 78145002
*                                       ECB ADDRESS               20002 78165040
         LA    R1,ZERO(,R1)             CLEAR THE HIGH BYTE       20002 78195040
*/* D (YES,LSTWRD,NO,) INVALID ECB BELONGS TO CSCB*/                    78255040
         CR    XRSCRTCH,R1              Q.ECB EQUAL TO COMM. ECB  20002 78275040
         BE    LSTWRD                   YES.CONTINUE              20002 78295040
*/*ERROR1: P SET ABEND CODE TO 102*/                                    78395002
ERROR1   LA    R1,ERRPOST1              GET ABEND CODE                  78445040
*/*ABND2: R ABEND*/                                                     78605002
ABND2    SLL   R1,ABNDALGN              MOVE IT OVER                    78625040
         O     R1,TIDBIT                TURN ON DUMP BIT                78645040
         SVC   ABENINST                 ABEND                           78745001
*********************************************************************** 78795001
         SPACE 1                                                        78995001
*            RB'S WAIT COUNT HAS GONE TO ZERO                           79045001
*                                                                       79095001
*/*TCBREADY: P STORE POST CODE  AND POST BIT IN ECB*/                   79255002
*/* N COMPARE AND SWAP NOT NECESSARY AS ECB CANNOT BE CHANGED */        79265002
*/* N WITH THE WAIT BIT ON. SUFFICE TO CHANGE IN ONE INSTRUCTION.*/     79275002
TCBREADY LA    XRTCB,0(XRTCB)           LOAD TCB ADDRESS                79285040
         N     XRPTCODE,OFFWAIT         REST WAIT BIT           @Y02752 79295040
         O     XRPTCODE,ONCOMPL         SET POST BIT            @Y02752 79345040
         ST    XRPTCODE,ZERO(,XRECB)    SET CODE AND BIT       @YM02795 79395040
*/*SETRBPFX: P RESET RB LONG-WAIT AND EXPLICIT WAIT BITS*/              79495002
SETRBPFX S     XRRB,WPRBPREL            SUBTRACT FROM BASE              79515040
         NI    RBFLAGS1-RBPREFIX(XRRB),ANYONE-RBXWAIT-RBLONGWT          79595002
         LA    XRRB,RBPRFXND-RBPREFIX(,XRRB) RESET RBSECT ADDR @YM04158 79605002
*/* P RESET RB SEARCH BIT*/                                             79605402
         NI    RBSTAB2,RRBECBWT         RESET RB ECB SEARCH FLAG        79605802
*/* D (NO,SETWTCT,YES,) READIED RB IS TOP RB ON TCB CHAIN*/             79607002
         C     XRRB,TCBRBP              IS READIED RB TOP RB            79611040
         BNE   SETWTCT                  BR IF NOT                       79615040
*/* D (YES,SETWTCT,NO,) TCB IS NON-DISP*/                               79627002
         CH    XRWAITCT,TCBFLGS4        TEST NON-DISP FLGS FOR ZERO     79631040
         BNZ   SETWTCT                  BR IF NOT ZERO                  79635040
*/*CSTCBSUP: P INCREMENT # READY TCBS IN A.S.*/                         79639002
         L     XRWORK,ASCBTCBS          GET TCB COUNT                   79642040
CSTCBSUP LA    XRSCRTCH,ONE(XRWORK)     BUMP                            79645040
         CS    XRWORK,XRSCRTCH,ASCBTCBS STORE CT                        79695040
         BNZ   CSTCBSUP                 BR IF DID NOT GO                79747002
*/*SETWTCT: P (,EXIT) STORE RESULTANT WAIT COUNT IN RB*/                79749002
SETWTCT  STC   XRWAITCT,RBWCF           STORE WAIT COUNT                79755002
         B     EXIT                     DONE                            79775040
         SPACE 1                                                 A33247 81445001
*/*QENTRY: P STORE RESULTANT WAIT COUNT IN RB*/                         81455002
QENTRY   STC   XRWAITCT,RBWCF           STORE WAIT COUNT                81495002
*/*QENTRY2: P SET POST CODE AND COMPL BIT IN REG FOR CS*/               81505002
QENTRY2  N     XRPTCODE,OFFWAIT         REST WAIT BIT           @Y02752 81525040
         O     XRPTCODE,ONCOMPL         SET POST BIT            @Y02752 81555040
*/*QENTRY3: P COMPARE AND SWAP COMPLETION CODE AND POST BIT TO ECB*/    81625002
QENTRY3  CS    R1,XRPTCODE,ZERO(XRECB)  SET CODE AND BIT        @Y02752 81645040
*/* D (YES,EXIT,NO,) COMPARE AND SWAP GO*/                              81668002
         BZ    EXIT                     BR CS GOES OK           @Y02752 81670040
*/* D (YES,,NO,QENTRY3)  POST BIT ON NOW */                             81673002
*        IF THE POST BIT IS ON NOW, THAT IS OK AND NO                   81674040
*        FURTHER CHANGE OF THE ECB IS REQUIRED.                         81684002
*        IF THE WAIT BIT IS ON, SOMETHING BAD (A WAIT IN                81695002
*        ANOTHER MEMORY ON THE ECB OR AN INVALID USER                   81696002
*        UPDATE) HAS HAPPENED. IN EITHER CASE, SET THE ECB              81697002
*        TO LOOK VALID FOR THE VALID CALLER AND WE'LL CATCH             81697540
*        THE INVALID CALLER LATER.                                      81699002
*        THE ECB MAY HAVE BEEN CHANGED TO HAVE NEITHER                  81700002
*        WAIT OR POST BIT SET, IN WHICH CASE THE ECB SHOULD REFLECT     81701002
*        THE POSTED CONDITION.                                          81702002
         TM    ZERO(XRECB),ECBPTFLG    IS NOW POSTED           @YM02795 81703040
         BZ    QENTRY3                 NO,PUT IN NEW POST CODE @YM02795 81705040
*/*EXIT: D (POS,SRBEXIT,NEG,) TEST R14 ENTRY SW*/                       81725002
EXIT     LTR   XRRETURN,XRRETURN       TEST BR/SVC SW                   81755002
         BP    SRBEXIT                 BR IF SVC ENTRY                  81760040
*/* D (YES,RESTALL,NO,) EXTENDED SAVE AREA IN USE*/                     81767040
         TM    LSAFLGS-LSA(XRSAVE),EXTSA EXT SA IN USE         @Z40EPVD 81769040
         BO    RESTALL                 YES GO PROCESS          @Z40EPVD 81770040
*/* R RESTORE 0-9 RETURN 14*/                                           81775002
         LM    R0,R9,WS0(XRSAVE)       RESTORE REGS 0-9           M0113 81785040
         BR    XRRETURN                LEAVE                            81845001
*/*RESTALL: P RESET EXT SA IN USE FLAG; RESTORE REGS 0-14*/             81845240
RESTALL  EQU   *                       EXT SAVE AREA IN USE    @Z40EPVD 81845340
         NI    LSAFLGS-LSA(XRSAVE),XFF-EXTSA RESET IN USE FLAG @ZA30491 81845540
         LM    R0,R14,LSAEXT-LSA(XRSAVE) RESTORE REGS          @Z40EPVD 81845740
         BR    XRRETURN                RETURN TO CALLER        @Z40EPVD 81845840
*/* R RETURN ON 14*/                                                    81846240
*/*SRBEXIT: D (SRB,%Q2,TCB,) RUNNING UNDER TCB OR XMPOST SRB*/          81847002
SRBEXIT  L     XRWORK,PSATOLD          ADDR OF CURRENT TCB              81851040
         LTR   XRWORK,XRWORK           TEST FOR TCB ADDR                81855040
*/* R REG 14*/                                                          81867002
         BNZR  XRRETURN                BR IF TCB MODE                   81871040
*/*%Q2: S SETFRR: DELETE XMPOST FRR*/                                   81877002
QPFY9    SETFRR D,WRKREGS=(XRWORK,XRSCRTCH)                             81885002
         LR    R1,R0                   ADDR OF XMPOST SRB               81886040
         USING SRBSECT,R1              SRB BASE                         81887040
*/* S SETLOCK: OBTAIN SALLOC LOCK*/                                     81887602
         LR    XRSCRTCH,R14            SAVE REG 14 ACROSS      @YM02663 81887740
LK3      SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=LK4    @YM02663 81889802
*/* D (YES,EXITGONE,NO,) ORIG ASCB HAS GONE AWAY*/                      81891802
         L     R0,XMPQ                 XMPOST SRB CHAIN FLD             81892840
         LTR   R0,R0                   SRBS ARE ORPHANS                 81894340
         BM    EXITGONE                BR IF ORIG ASCB GONE             81896640
         L     XRWORK,XMASCB           ADDR OF ORIG ASCB                81898940
         LA    XRWORK,ASCBXMPQ-ASCB(XRWORK)     ADDR OF CHAIN HEADER    81902202
*/*EXITLOOP: D (YES,EXITDEQ,NO,) THIS IS OUR SRB*/                      81903502
EXITLOOP C     R1,ZERO(,XRWORK)        IS THIS OUR SRB                  81904540
         BE    EXITDEQ                 BR IF SO                         81905840
*/* P (,EXITLOOP) GET NEXT SRB*/                                        81910102
         L     XRWORK,ZERO(,XRWORK)    GET TO NEXT SRB                  81912102
         LA    XRWORK,XMPQ-SRBSECT(,XRWORK) ADDR OF NEXT CHAIN          81914102
         B     EXITLOOP                DO IT AGAIN                      81916140
*/*EXITDEQ: P DEQ XMPOST SRB FROM ITS PARENT ASCB*/                     81921602
EXITDEQ  ST    R0,0(,XRWORK)           DEQ OUR SRB                      81921840
*/*EXITGONE: P PUT XMPOST SRB BACK ON CHAIN */                          81923002
EXITGONE L     R13,CHAINHD             GETCHAIN HEADER         @YM02663 81943040
         ST    R13,ZERO(,R1)           SAVE OLD CHAIN PTR IN   @YM02663 81982240
*                                      THIS SRBS POINTER FIELD @YM02663 81989240
         ST    R1,CHAINHD              CHAIN THIS SRB ON TOP   @YM02663 81996240
*/* S SETLOCK: RELEASE SALLOC LOCK*/                                    82011802
LK4      SETLOCK RELEASE,TYPE=SALLOC,RELATED=LK3                        82026602
*/* S SETLOCK: RELEASE LOCAL LOCK*/                                     82041402
LK5      SETLOCK RELEASE,TYPE=LOCAL,RELATED=LK10                        82056202
*/* R DISPATCHER SRB EXIT*/                                             82071002
         BR    XRSCRTCH                RETURN TO DISP                   82085802
*  ERROR EXIT                                                           82100602
*/*ERROR2: R ABEND 202*/                                                82115402
ERROR2   LA    R1,ERRPOST2             LOAD ERROR CODE                  82130202
         B     ABND2                   BRANCH                           82145002
         EJECT                                                          82152040
*                                                                       82159040
*  PROCESS ECB EXTENSION                                                82166040
*                                                                       82173040
         SPACE                                                          82180040
EXTECB   EQU   *                      ECB EXTENSION PROCESSING @Z40EPVD 82187040
*/*EXTECB: S SETFRR: ESTABLISH RECOVERY ENVIRONMENT*/                   82194040
         LA    R1,EXECBFRR            GET FRR ADDR             @Z40EPVD 82201040
         SETFRR A,FRRAD=(R1),WRKREGS=(XRWORK,XRSCRTCH),PARMAD=(FRRWA3)  82208040
*/* P PRIME FRR WORK AREA WITH FAILURE CODE - 14*/                      82222040
         LA    R1,RC14                GET REASON CODE 14       @Z40EPVD 82229040
         ST    R1,ZERO(FRRWA3)        PUT RC IN WORK AREA      @Z40EPVD 82233040
*/* D (NO,CHNGRC1,YES,) EXIT ROUTINE REQUEST*/                          82243040
         L     ECBE2,ECB-ECB(XRECB)   ADDR OF ECB EXT          @Z40EPVD 82246040
         SLL   ECBE2,HIGHBIT          CLEAR WAIT BIT           @Z40EPVD 82250040
         SRL   ECBE2,LOWBITS          CLEAR EXT ECB BITS       @Z40EPVD 82256040
         SLL   ECBE2,LOWBITS-HIGHBIT  PURE ECB EXT ADDR        @Z40EPVD 82262040
         CLC   ZERO(FOUR,ECBE2),PXITCODE VALID FIRST WORD      @Z40EPVD 82274040
         BNE   CHNGRC1                NO, PREPARE TO ABEND     @Z40EPVD 82277040
*/* MOREEXIT: D (NO,CHNGRC2,YES,) ANY MORE EXIT ROUTINES*/              82292040
         L     R1,ASCBASXB-ASCB(XRASCB) ASXB ADDR              @Z40EPVD 82299040
         L     R1,ASXBPT0E-ASXB(R1)   POST EXIT QUEUE HEADER   @Z40EPVD 82301040
MOREEXIT EQU   *                      EXIT QUEUE LOOP LABEL    @Z40EPVD 82304040
         LTR   R1,R1                  ANY MORE EXITS?          @Z40EPVD 82309040
         BZ    CHNGRC2                NO PREPARE TO ABEND      @Z40EPVD 82314040
*/* D (YES,VALEXIT,NO,) EXIT ROUTINE ADDRESSES MATCH*/                  82334040
         CLC   FOUR(FOUR,ECBE2),FOUR(R1) EXIT ADDRS MATCH      @Z40EPVD 82341040
         BE    VALEXIT                YES, EXIT LOOP           @Z40EPVD 82343040
*/* P (,MOREEXIT) GET ADDR OF NEXT BLOCK*/                              82355040
         L     R1,ZERO(R1)            NO, GET NEXT BLOCK ADDR  @Z40EPVD 82358040
         B     MOREEXIT               LOOP BACK                @Z40EPVD 82362040
*/*VALEXIT: D (YES,CHNGRC3,NO,) EXTENDED SAVE AREA IN USE*/             82376040
VALEXIT  EQU   *                      VALID EXIT ADDR          @Z40EPVD 82379040
         TM    LSAFLGS-LSA(XRSAVE),EXTSA+PEXITSA SA IN USE     @Z40EPVD 82388040
         BNZ   CHNGRC3                YES, PREPARE TO ABEND    @Z40EPVD 82390040
*/* P SET COMPLETE BIT AND COMPLETION CODE IN ECB*/                     82404040
         N     XRPTCODE,OFFWAIT       TURN OFF WAIT BIT        @Z40EPVD 82407040
         O     XRPTCODE,ONCOMPL       TURN ON COMPLETE BIT     @Z40EPVD 82411040
         ST    XRPTCODE,ECB-ECB(,XRECB) UPDATE ECB             @Z40EPVD 82421040
*/* P SAVE POST REGS ACROSS INTERFACE - MARK EXIT SA IN USE*/           82432040
         OI    LSAFLGS-LSA(XRSAVE),PEXITSA TEMP SA IN USE      @Z40EPVD 82436040
         STM   R12,R1,LSAPEXI2-LSA(XRSAVE) SAVE REGS NEEDED    @ZA30491 82441040
*        THE ABOVE INSTRUCTION WAS CHANGED TO ALSO SAVE R12-13 @ZA30491 82445040
*/* P RESET FAILURE CODE IN FRR WORK AREA*/                             82453040
         LA    R15,RC0                GET ZERO REASON CODE     @Z40EPVD 82456040
         ST    R15,ZERO(FRRWA3)       PUT RC IN WORK AREA      @Z40EPVD 82460040
*/* P PREPARE INTERFACE FOR EXIT ROUTINE*/                              82474040
         L     R15,FOUR(R1)           EXIT ENTRY PT ADDR       @Z40EPVD 82477040
         ST    R15,LSAXITEP-LSA(,XRSAVE) SAVE E.P. ADDR        @Z40EPVD 82483040
         LR    R1,ECBE2               ECB EXTENSION ADDR       @Z40EPVD 82485040
         LR    R0,XRECB               PASS POSTED ECB ADDR     @Z40EPVD 82488040
*/* S EXIT RTN: INVOKE EXIT ROUTINE*/                                   82495040
         BALR  R14,R15                CALL EXIT ROUTINE        @Z40EPVD 82498040
*/* P RESET POST REGS*/                                                 82509040
         LM    R12,R1,LSAPEXI2-LSA(XRSAVE) RESTORE REGS        @ZA30491 82516040
*/* P INDICATE EXTENDED AND EXIT SAVE AREAS NOT IN USE*/                82523040
         NI    LSAFLGS-LSA(XRSAVE),XFF-EXTSA-PEXITSA NOT USED  @Z40EPVD 82530040
*/* S (,EXIT) SETFRR: DELETE POST EXIT FRR*/                            82537040
         SETFRR D,WRKREGS=(XRWORK,XRSCRTCH) DELETE FRR         @Z40EPVD 82544040
         B     EXIT                   MAINLINE EXIT CODE       @Z40EPVD 82546040
*/*CHNGRC1: P (,ABEND702) SET ABEND REASON CODE TO 8*/                  82558040
CHNGRC1  LA    R1,RC8                 SET REASON CODE TO 8     @Z40EPVD 82561040
         B     ABEND702               GO ISSUE ABEND           @Z40EPVD 82565040
*/* CHNGRC2: P (,ABEND702) SET ABEND REASON CODE TO C*/                 82576040
CHNGRC2  LA    R1,RCC                 SET REASON CODE TO C     @Z40EPVD 82581040
         B     ABEND702               GO ISSUE ABEND           @Z40EPVD 82586040
*/*CHNGRC3: P SET ABEND REASON CODE TO 10*/                             82600040
CHNGRC3  LA    R1,RC10                SET REASON CODE TO 10    @Z40EPVD 82603040
*/*ABEND702: S SETFRR: DELETE FRR BEFORE ABENDING*/                     82614040
ABEND702 EQU   *                      PREPARE FOR 702 ABEND    @Z40EPVD 82616040
         LR    R0,ECBE2               SAVE ECB EXT ADDR        @Z40EPVD 82618040
         SETFRR D,WRKREGS=(XRWORK,XRSCRTCH) DELETE FRR         @Z40EPVD 82630040
*/* R ABEND 702*/                                                       82642040
         LR    R3,R1                  SAVE REASON CODE         @Z40EPVD 82643040
         L     R1,ABND702             GET 702 ABEND CODE       @Z40EPVD 82645040
         LR    R15,R3                 SET REASON CODE          @Z40EPVD 82649040
         SVC   ABENINST               ISSUE ABEND              @Z40EPVD 82659040
         EJECT                                                          82670040
*********************************************************************** 82795001
*********************************************************************** 82845001
*     THE FOLLOWING CODE IS ENTERED IF A PARAMETER LIST FOR AN        * 82895001
*       CROSS MEMORY POST WAS SPECIFIED.                             *  82945002
*                                                                       85145001
*/*XMPROC: P SET UP REGS FROM XMPOST PARM LIST*/                        85147002
XMPROC   LR    R10,XRPTCODE        SAVE POST CODE                       85155002
         LTR   R10,R10             CHECK FOR ECBKEY OPTION     @ZA15373 85156040
         BNM   XMPECBAD            NOT REQ, SKIP ECBKEY SAVE   @ZA15373 85159040
         IC    R0,ECBKEY(,XRECB)   SAVE ECBKEY FOR VAL CHK     @ZA15373 85162040
XMPECBAD L     R5,ECBPTR(,XRECB)   SAVE ECB ADDR               @ZA15373 85165040
         L     R8,ASCBPTR(,XRECB)  SAVE TARGET ASCB ADDR       @ZA15373 85168040
         L     R6,ERRETPTR(,XRECB) SAVE ERRET ADDR             @ZA15373 85171040
         LA    R6,ZERO(,R6)        SKIP MEM RELATED TESTS       @Y02752 85185402
*/*XMPPROC: D (YES,XMPEROK,NO,) THIS REQUEST MEMORY RELATED*/   @Y02752 85187002
XMPPROC  LR    XRSCRTCH,XRRETURN   SAVE RETURN ADDR ACROSS MACROS       85205002
         LTR   R6,R6               TEST FOR NOT MEMORY RELATED  @Y02752 85210040
         BP    XMPEROK             BR IF MEMORY RELATED         @Y02752 85225002
*/* P GET ADDRESS OF MASTER SCHED ASCB */                       @Y02752 85227002
         LA    XRASCB,XMASASID     MASTER SCHED  ASID TIMES 4   @Y02752 85235002
QJ11     L     R3,CVTPTR           GET POINTER TO CVT           @Y02752 85237002
         L     R3,CVTASVT-CVTMAP(,R3) ADDR OF ASVT              @Y02752 85239002
         L     XRASCB,ASVTENTY-ASVT-FOUR(R3,XRASCB)   HAVE ADDR @Y02752 85241002
*                                  OF MASTER SCHED ASCB         @Y02752 85243002
*/*XMPEROK: S SETLOCK: GET SALLOC LOCK */                       @Y02752 85243102
XMPEROK  EQU   *                   TESTING LABEL                @Y02752 85243402
LK6      SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=LK7             85245002
*/* D (NO,,YES,HAVEIT) ARE THERE ANY SRBS ON CHAIN */                   85247402
         L     R1,CHAINHD          GET CHAIN HEADER            @YM02663 85247802
         LTR   R1,R1               ANY THERE                   @YM02663 85248102
         BNZ   HAVEIT              YES, BRANCH                 @YM02663 85248402
         LR    XRLINKR,XRBASE      SAVE BASE REG ACROSS GM              85248702
         LR    XRSAVE,R0           SAVE ECBKEY BY GM INTERFACE @ZA15373 85248840
         LA    R0,SRBLENTH         SRB LENGTH                           85252040
*/* S (,GOTTEN) GETMAIN: XMPOST SRB*/                                   85253040
QJ12     GETMAIN RU,LV=(0),SP=245,BRANCH=(YES,GLOBAL)  GET SRB          85255002
         LR    R0,XRSAVE           RESTORE ECBKEY AFTER GM     @ZA15373 85255740
         LR    XRBASE,XRLINKR      RESET BASE REG                       85256440
         B     GOTTEN              GO AROUND CHAIN UPDATE      @YM02663 85257102
*/*HAVEIT: P UPDATE CHAIN - TAKE OFF GOTTEN SRB */                      85260202
HAVEIT   L     XRWORK,ZERO(,R1)    GET NEXT ONE IN CHAIN       @YM02663 85261202
         ST    XRWORK,CHAINHD      SAVE POINTER TO NEXT        @YM02663 85262202
         USING SRBSECT,R1          BASE REG FOR GOTTEN CORE             85264202
*/*GOTTEN: P CHAIN NEW SRB TO ASCB XMPOST SRB LIFO Q*/                  85266202
GOTTEN   L     XRWORK,ASCBXMPQ     GET XMPOST SRB Q ANCHOR     @YM02663 85267202
         ST    R1,ASCBXMPQ         ADDR OF NEW SRB TO TOP               85268202
         ST    XRWORK,XMPQ         CHAIN NEW TO REST OF Q               85269202
*/* D (YES,NORLSE,NO,) CALLER ALREADY HAD SALLOC LOCK*/                 85275402
         LTR   R13,R13             WAS SALLOC LOCK ALREADY HELD         85280302
         BNZ   NORLSE              YES - NO RELEASE                     85285202
*/* S SETLOCK: RELEASE SALLOC LOCK*/                                    85290102
LK7      SETLOCK RELEASE,TYPE=SALLOC,RELATED=LK6                        85295002
*/*NORLSE: P SET UP XMPOST SRB FIELDS*/                                 85297002
NORLSE   LR    XRRETURN,XRSCRTCH   RESET RETURN REG                     85305002
         XC    SRBSECT(SRBSIZE),SRBSECT  ZERO SRB BASE                  85345002
         ST    R8,SRBASCB          TARGET ADDR SPC                      85355002
         LA    XRSCRTCH,SRBPOST    ADDR OF EP                           85395002
         LA    XRWORK,SPOST        RMTR ADDR                            85415040
         STM   XRSCRTCH,XRWORK,SRBEP  SET EP AND RMTR                   85495002
QK18Z    L     XRWORK,PSATOLD      GET CURRENT TCB ADDR                 85595002
         LH    XRSCRTCH,ASCBASID   CURRENT ASID                         85645002
         LTR   XRWORK,XRWORK       TEST FOR TCB MODE                    85695002
         BNZ   MODETCB             IF NOT ZERO, TCBMODE                 85745002
         L     XRWORK,PSALCCAV     ADDR OF LCCA                         85795002
         LM    XRSCRTCH,XRWORK,LCCASRBF-LCCA(XRWORK)  SRB'S ASID/TCB    85845002
MODETCB  STM   XRSCRTCH,XRWORK,SRBFLC  SET FIELDS                       85895002
         STM   R5,R6,XMECB         SET ECB,ERRET ADDRS                  85945002
         NI    XMECB,RECBWTF       TURN OFF HI BIT                      85955002
         ST    R10,XMCCODE         SET POST CODE                        85995002
         STC   R0,XMECBKEY         SET ECBKEY FOR VAL CHECK    @ZA15373 86025040
         ST    XRASCB,XMASCB       SAVE ORIG ASCB ADDR                  86055002
         LA    XRWORK,SRBEND       ADDR OF PARMS                        86095002
         ST    XRWORK,SRBPARM      SET PARM POINTER                     86145002
         LR    XRWORK,R15          SAVE REG OVER SCHEDULE               86155002
         DROP  R1,R15                                                   86195002
         USING IGC002+2,XRWORK                                          86205002
*/* S SCHEDULE: SRB TO TARGET A.S. EP=SRBPOST*/                         86215002
QK19Z    SCHEDULE SRB=(1),SCOPE=LOCAL                                   86245002
*/* D (YES,XMP00,NO,) SVC OR BR CALLER W/O LOCAL LOCK */                86255040
QK20Z    LTR   XRRETURN,XRRETURN   TEST FOR SVC ENTRY                   86265002
         BPR   XRRETURN            RETURN IF SVC                        86275002
*/* D (NO,,YES,XMPLKH) LOCAL LOCK HELD */                               86305002
QK21Z    SETLOCK TEST,TYPE=LOCAL,BRANCH=(HELD,XMPLKH)                   86315002
*/* R RETURN ON REG 14*/                                                86335002
         BR    XRRETURN            RETURN IF REGS NOT SAVED             86337002
*/*XMPLKH: D (YES,EXTSAVE,NO,) EXTENDED SAVE AREA IN USE */             86337540
XMPLKH   TM    LSAFLGS-LSA(R9),EXTSA   EXT SA IN USE           @Z40EPVD 86338040
         BO    EXTSAVE             YES, RESET FROM EXT SA      @Z40EPVD 86338540
*/* P RESTORE REGS 0-9 */                                               86339040
         LM    R0,R9,0(R9)         RESTORE REGS                         86340040
*/* XMP00: R  RETURN ON REG 14 */                                       86343002
XMP00    BR    XRRETURN            RETURN                               86345002
*/*EXTSAVE: P (,RESTALL) RESET BASE REG FOR LOCAL SAVE AREA */          86355040
EXTSAVE  LR    XRSAVE,R9           RESET DATA REG              @Z40EPVD 86365040
         B     RESTALL             GO RESTORE REGS             @Z40EPVD 86375040
         DROP  XRWORK                                                   86385040
         EJECT                                                          86395002
         USING *,R15                                                    86405002
*/* E SRBPOST*/                                                         86415002
*/* P SET REG 14 POSITIVE FOR XMPOST SW*/                               86425002
SRBPOST  LA    R10,0(,R14)         POSITIVE RETURN ADDRESS     @ZA15373 86430040
*/* S SETLOCK: OBTAIN LOCAL LOCK*/                                      86455002
LK10     SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(LK5,LK16)       86495002
*/* P FIND LOCAL SAVE AREA- SAVE REGS*/                                 86497002
QPFYZ    L     XRASCB,PSAAOLD      CURRENT ASCB                         86505002
         L     XRSAVE,ASCBASXB     ASXB ADDR                            86515002
         L     XRSAVE,ASXBSPSA-ASXB(,XRSAVE) WSA TABLE                  86525002
         L     XRSAVE,WSALPOST-WSAL(,XRSAVE) POST WSA                   86531002
         ST    R0,0(XRSAVE)        STASH SRB ADDR                       86537002
         LR    R14,R10             RESTORE R14 WITH POS ADDR   @ZA15373 86541040
         LA    R1,SRBFRR           FRR ADDRESS                          86595002
*/* S SETFRR: ESTABLISH XMPOST FRR*/                                    86595402
QJ14Z    SETFRR A,FRRAD=(R1),WRKREGS=(XRWORK,XRSCRTCH)                  86597002
*/* P SET UP MAINLINE REGS*/                                   @ZA15373 86598040
         L     XRBASE,BASE         COMMON ADDRESSABILITY POINT          86605002
         USING IGC002+2,XRBASE                                          86615002
         LR    XRWORK,R0           ADDR OF SRB                          86845002
         L     XRECB,XMECB-SRBSECT(XRWORK) GET ECB ADDR FOR POST        86895002
         L     XRPTCODE,XMCCODE-SRBSECT(XRWORK)  POST CODE              86945002
*/* D (YES,,NO,ECBCHECK) ECBKEY OPTION SPECIFIED*/             @ZA15373 86945940
ECBVALCK LTR   XRPTCODE,XRPTCODE   TEST ECBKEY OPTION          @ZA15373 86946440
         BNM   ECBCHECK            NOT REQ, ENTER IEAVPT01     @ZA15373 86946940
         SPACE 2                                                        86948140
*        CODE TO SUPPORT ECBKEY OPTION FOR XMPST REQUESTS.     @ZA15373 86948640
*        ECB WILL BE VALIDITY CHECKED WITH ECBKEY ONLY WHEN    @ZA15373 86949240
*        THE ECB HAS NOT BEEN WAITED ON. (NORMAL VALIDITY      @ZA15373 86949840
*        CHECK IS DONE OTHERWISE).                             @ZA15373 86950440
         SPACE 1                                                        86951740
*/* D (YES,EVN3,NO,) ECB WAITED ON */                          @ZA15373 86952240
         TM    ZERO(XRECB),ECBWAIT CHECK FOR WAITING ECB       @ZA15373 86955240
         BO    EVN3                WAITING, ENTER IEAVPT01     @ZA15373 86958240
*/* P GET ECBKEY FROM XMPOST SRB*/                             @ZA15373 86961240
         IC    R4,XMECBKEY-SRBSECT(,R3) GET ECBKEY FROM SRB    @ZA15373 86964240
*/* P SET UP INTERFACE TO IEAVEVAL TO VAL CHK ECB*/            @ZA15373 86967240
         O     R4,TIDBIT           INDICATE KEY, NOT TCB       @ZA15373 86970240
         LR    R1,XRECB            ADDRESS OF ECB AND          @ZA15373 86973240
         LA    R2,L3(,XRECB)       END ADDR FOR IEAVEVAL       @ZA15373 86976240
         LR    R12,R15             SAVE BASE REG 15            @ZA15373 86979240
         L     R15,CHECK           ENTER AT IEA0VL01           @ZA15373 86982240
*/* S IEA0VL01: CALL IEAVEVAL */                               @ZA15373 86985240
         BALR  R14,R15             CALL IEAVEVAL               @ZA15373 86988240
         LR    R15,R12             RESTORE BASE REG 15         @ZA15373 86991240
         LR    R14,R10             RESTORE POS RETURN REG      @ZA15373 86994240
*/* D (FAIL,ERROR1,PASS,RBCHECK)   RESULTS OF VAL CHK*/        @ZA33186 86995240
         BNZ   ERROR1              FAIL VAL CHK, ABEND         @ZA15373 86997240
*        BRANCH TO RBCHECK INSTEAD OF POSTTEST, IN CASE AN ECB @ZA33186 86999240
*        WHOSE TWO HIGH ORDER BITS HAD INITIALLY BEEN ZERO     @ZA33186 87001240
*        HAS BEEN INITIALIZED TO POINT TO AN ECB EXTENSION.    @ZA33186 87003240
         B     RBCHECK             ECBVALID, ENTER PT01        @ZA33186 87009240
*/* POST: END */                                                        87015003
         EJECT                                                          87045002
*/* POSTR: CHART */                                                     87050003
         USING *,15                                                     87055002
*/* E SPOST*/                                                           87057002
*/* P SET UP ADDRESSABILITY TO POST CODE*/                     @ZA15373 87057640
SPOST    L     XRBASE,BASE          COMMON ADDRESSABILITY      @ZA15373 87060640
         USING IGC002+2,XRBASE      POINT FOR POST CODE        @ZA15373 87063640
*/* P PICK UP POST PARMS FROM XMPOST SRB*/                     @ZA15373 87066640
         LR    R3,R1                SAVE SRB ADDR              @ZA15373 87069640
         USING SRBSECT,R3                                      @ZA15373 87072640
         LR    R8,R14               SAVE RETURN ADDR           @ZA15373 87075640
*/* D (YES,,NO,NOPOST) TASK TERM; IE ASCBS MATCH */                     87085102
Q45      L     R7,PSAAOLD           GET CURRENT ASCB ADDR      @YM01534 87085202
         CL    R7,SRBASCB           COMPARE TO ASCB ADDR IN SRB@YM01534 87085302
         BNE   NOPOST               DONT POST IF MEM TERM      @YM01534 87085502
*/* D (YES,SPRESCH,NO,) IS THIS AN ERRET SRB */                         87085902
         LA    R5,ERRET             GET POSTS ERRET ADDR       @YM01534 87086302
         CL    R5,SRBEP             COMPARE TO ENTRY POINT     @YM01534 87086702
         BE    SPRESCH              BR IF ERRET TO RESCHEDULE  @YM01534 87086802
*/* S SETLOCK: OBTAIN LOCAL LOCK */                                     87092802
SPQ1     SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(SPQ2,QK16)      87093002
*/* S SETFRR: SET FRR COVERAGE FOR LOCAL POST */                        87094602
         LA    R1,SPOSTFRR          SET ADDR OF FRR RTN        @YM01534 87095802
QSP0     SETFRR A,FRRAD=(R1),WRKREGS=(R11,R12),PARMAD=(R10)    @YM01534 87096202
*/* P SET PARM AREA FOR POSSIBLE FRR ENTRY */                           87096702
         ST    R3,SRBSV(,R10)       SET SAVED SRB ADDR         @YM01534 87097202
         ST    R8,SPOSTRT(,R10)     SET SAVED RETR ADDR        @ZA15373 87097540
*/* P SET UP INTERFACE FOR BRANCH ENTRY TO IEAVPT01*/          @ZA15373 87097740
         L     R10,XMCCODE          SET COMPLETION CODE        @ZA15373 87097940
         L     R11,XMECB            SET ADDR OF ECB            @ZA15373 87098140
*/* D (YES,,NO,GOXMPOST) WAS ECBKEY OPTION IN EFFECT*/         @ZA15373 87098340
         LTR   R10,R10              TEST ECBKEY OPTION         @ZA15373 87098540
         BNM   GOXMPOST             NOT REQ, GO COMPLETE XMPOST@ZA15373 87098740
*/* D (YES,GOXMPOST,NO,) ECB WAITED ON*/                       @ZA15373 87098840
         TM    ZERO(R11),ECBWTFLG   CHK IF ECB WAITING         @ZA15373 87098940
         BO    GOXMPOST             WAITING, GO COMPLETE XMPOST@ZA15373 87099040
*/* P GET ECBKEY FROM XMPOST SRB*/                             @ZA15373 87099240
         IC    R4,XMECBKEY          GET ECBKEY FROM SRB        @ZA15373 87099340
*/* P SET UP INTERFACE TO IEAVEVAL TO VAL CHK ECB*/            @ZA15373 87099540
         O     R4,TIDBIT           INDICATE KEY, NOT TCB       @ZA15373 87099640
         LR    R1,R11               ADDR OF ECB AND            @ZA15373 87099740
         LA    R2,L3(,R11)          END ADDR FOR IEAVEVAL      @ZA15373 87099940
         LR    R12,R15              SAVE BASE REG 15           @ZA15373 87100140
         L     R15,CHECK            ENTER AT IEAOVL01          @ZA15373 87100340
*/* S IEA0VL01: CALL IEAVEVAL*/                                @ZA15373 87100440
         BALR  R14,R15              CALL IEAVEVAL              @ZA15373 87100740
         LR    R15,R12              RESTORE BASE REG 15        @ZA15373 87100940
*/* D (FAIL,ERROR1,PASS,) RESULTS OF VAL CHK */                @ZA15373 87101040
         BNZ   ERROR1               FAIL VAL CHK, ABEND        @ZA15373 87101340
*/*GOXMPOST: S IEA0PT01: ENTER TO COMPLETE XMPOST*/            @ZA15373 87101440
GOXMPOST L     R15,ADDRPT01         GET ADDR OF BR ENTRY       @ZA15373 87101740
         BALR  R14,R15              CALL IEAVPT01              @ZA15373 87101940
         SPACE 2                                                        87102540
*        NOTE: BASE REG 15 IS STILL VALID ON RETURN FROM       @ZA15373 87102640
*        IEAVPT01 (IEAVPT01 ESTABLISHES ADDRESSABILITY BY      @ZA15373 87102740
*        REG 15 FROM IGC002+2 ALSO).                           @ZA15373 87102840
         SPACE 1                                                        87103040
*/*SPFRRT: S SETFRR:  DELETE FRR COVERAGE  */                           87103440
SPFRRT   SETFRR D,WRKREGS=(R11,R12)                            @YM01534 87103640
*/* S SETLOCK: RELEASE LOCAL LOCK */                                    87103740
SPQ2     SETLOCK RELEASE,TYPE=LOCAL,RELATED=(SPQ1)             @YM01534 87103840
SPQG     L     R7,PSAAOLD           GET ADDR OF ASCB           @YM01534 87104040
*/*NOPOST: S SETLOCK: OBTAIN SALLOC LOCK*/                              87104140
NOPOST   DS    0H                                              @ZA10133 87104240
LK11     SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=(LK12,LK012)    87104340
*/* D (YES,SPSTGONE,NO,) ORIG ASCB HAS GONE AWAY*/                      87104502
         L     R4,XMPQ              XMPOST SRB CHAIN FLD                87105040
         LTR   R4,R4                SRBS ARE ORPHANS                    87105540
         BM    SPSTGONE             BR IF ORIG ASCB GONE                87106040
         L     XRSCRTCH,XMASCB      ORIG ASCB ADDR                      87106540
         LA    XRSCRTCH,ASCBXMPQ-ASCB(XRSCRTCH) ADDR OF CHAIN HEADER    87109402
*/*SPSTLOOP: D (YES,SPSTDEQ,NO,) THIS IS OUR SRB*/                      87111402
SPSTLOOP C     R3,0(XRSCRTCH)       IS THIS OUR SRB                     87112440
         BE    SPSTDEQ              BR IF SO                            87113440
*/* P (,SPSTLOOP) GET NEXT SRB*/                                        87117702
         L     XRSCRTCH,0(XRSCRTCH) GET TO NEXT SRB                     87117940
         LA    XRSCRTCH,XMPQ-SRBSECT(XRSCRTCH) ADDR OF NEXT CHAIN       87118502
         B     SPSTLOOP             DO IT AGAIN                         87118740
*/*SPSTDEQ: P DEQ XMPOST SRB FROM ITS PARENT ASCB*/                     87119302
SPSTDEQ  ST    R4,0(XRSCRTCH)       DEQ OUR SRB                         87119540
*/* D (YES,SCHERRET,NO,) SRB DEQ'ED ERRET SRB */                        87119740
         SR    R4,R4                ERRET SRB INDICATED BY ZERO@ZA10133 87120140
         CL    R4,SRBEP             SRB EPA SET BY SPOST FRR   @ZA10133 87120240
         BE    SCHERRET             GO SCHED SRB IF ERRET      @ZA10133 87120640
*/*SPSTGONE: P PUT XMPOST SRB BACK ON CHAIN*/                           87120702
SPSTGONE L     R13,CHAINHD          GETCHAIN HEADER            @YM02663 87121240
         ST    R13,ZERO(,R3)        SAVE OLD CHAIN PTR IN THIS @ZA10133 87122240
*                                   SRBS POINTER FIELD         @YM02663 87122540
         ST    R3,CHAINHD           CHAIN THIS SRB TO TOP      @ZA10133 87123740
*/* S SETLOCK: RELEASE SALLOC LOCK*/                                    87125002
LK12     SETLOCK RELEASE,TYPE=SALLOC,RELATED=LK11                       87126002
*/*SPRT: R RETURN TO PURGEDQ*/                                          87127002
         BR    R8                   RETURN                     @ZA15373 87127540
         SPACE 2                                                        87130140
*/*SCHERRET: P INIT SRB TO SCHEDULE POST ERRET IN USER ASCB */          87130240
SCHERRET DS    0H                                              @ZA10133 87130340
         LA    XRSCRTCH,ERRET       ERRET ADDR                 @YM01534 87130440
         ST    XRSCRTCH,SRBEP       ENTRY POINT                @YM01534 87130640
         MVC   SRBASCB,XMASCB       ADDR OF ORIGINATING ASCB   @YM01534 87130840
         ST    XRASCB,XMASCB        SAVE FAILING ASCB ADDR     @YM01534 87131040
*/* S SETLOCK: RELEASE SALLOC */                                        87131440
LK012    SETLOCK RELEASE,TYPE=SALLOC,RELATED=LK11              @ZA10133 87131640
         SPACE 2                                                        87131840
*/*SPRESCH: S (,SPRT) SCHEDULE: RESCHEDULE ERRET SRB */                 87132002
         DROP  R15                                                      87133002
SPRESCH  LR    R1,R3                SET REG                    @YM01534 87135002
         BALR  R4,R0                NEW ADDRESSABLIITY                  87135140
         USING *,R4                 NEW BASE                            87135240
         SCHEDULE SRB=(1),SCOPE=LOCAL                          @YM01534 87136940
         BR    R8                   RETURN                     @ZA15373 87137140
         DROP  R3                                                       87137940
         DROP  R4                                                       87138402
*/*ERROR1: P SET ABEND CODE TO 102 */                          @ZA15373 87138940
*/* R ABEND */                                                 @ZA15373 87139440
         EJECT                                                          87140002
         USING *,15                                                     87141002
*/* E IEARPOST*/                                                        87142002
IEARPOST STM   R14,R12,C12(R13)     SAVE REGS                           87143040
*/* D (MEM,RMEMTERM,TASK,) TYPE TERMINATION */                          87146002
         L     R1,0(,R1)            GET ADDR OF RMPL           @YM01534 87147002
         USING RMPL,R1                                         @YM01534 87150002
         TM    RMPLFLG1,RMPLTERM    TEST TYPE TERMINATION      @YM01534 87151002
         BO    RMEMTERM             BR IF MEM TERM             @YM01534 87152002
*/* S (,RPRETR) PURGEDQ: PURGE ALL INCOMING XMPOST AND ERRET SRBS*/     87155002
QSZ17    PURGEDQ MF=(E,IEASPOST)  CLEAR XMPOST SRBS COMING HERE         87157002
         BALR  R15,R0               SET UP BASE                @YM01534 87160002
         USING *,R15                                           @YM01534 87161002
         B     RPRETR               GO TO RETURN               @YM01534 87162002
*/*RMEMTERM: P SET UP TO CLEANUP POSTS XMPQ */                          87165002
RMEMTERM BALR  R15,R0               RESET BASE                          87165540
         USING *,R15                                                    87167002
         LR    R4,R13               SAVE SAVE AREA REG                  87168040
*/* S SETLOCK: OBTAIN SALLOC LOCK*/                                     87171002
LK13     SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=RPSTEND         87172002
*/* P ZERO Q HEADER FOR XMPOST SRBS FROM THIS A.S.*/                    87175002
         L     R7,RMPLASCB          GET TERMINATING ASCB ADDR  @YM01534 87176040
         L     R2,ASCBXMPQ          GET XMPOST SRB Q ANCHOR             87177040
         XC    ASCBXMPQ,ASCBXMPQ    ZERO IT                             87180040
         USING SRBSECT,R1           SRB BASE                            87181040
*/*RPSTLOOP: D (YES,RPSTEND,NO,) Q IS EMPTY*/                           87185002
RPSTLOOP LTR   R1,R2                TEST FOR EMPTY Q                    87187040
         BZ    RPSTEND              BR IF SO                            87190040
*/* P SET FLAG IN EACH SRB INDICATING ORIG ASCB HAS GONE AWAY*/         87200002
         L     R2,XMPQ              GET Q CHAIN ADDR                    87202040
         OI    XMPQ,LSTIND          INDICATE SRB IS ADRIFT              87205040
         B     RPSTLOOP             LOOP                                87215002
*/*RPSTEND: S SETLOCK: RELEASE SALLOC LOCK*/                            87220002
RPSTEND  SETLOCK RELEASE,TYPE=SALLOC,RELATED=LK13                       87225002
*/*RPRETR: R RETURN*/                                                   87230002
         LR    R13,R4               RESET SAVE AREA ADDR                87235002
RPRETR   LM    R14,R12,C12(R13)     RESTORE REGS               @YM01534 87237040
         SR    R15,R15              CLEAR CONDITION CODE       @YM01534 87242002
         BR    R14                  RETURN                              87243040
         DROP  R1                   DROP RMPL ADDRESSABILITY            87247002
         EJECT                                                          87250002
IEASPOST PURGEDQ RMTR=SPOST,MF=L,ASIDTCB=DBLZERO LST FOR SPOST @YM01534 87255002
         DS    0D                   ALIGHN                     @YM01534 87257402
DBLZERO  DC    2F'0'                PARM FOR SPOST MACRO       @YM01534 87259002
         EJECT                                                          87260002
*/*SPOSTFRR: E FRR FOR SPOST */                                         87262002
         DROP  R15                                                      87263002
*/* S SETRP: RETRY TO SCHEDULE ERRET */                                 87264002
         USING *,R4                                                     87264102
         USING SDWA,R1                                                  87264202
SPOSTFRR L     XRSAVE,SDWAPARM      GET PARM AREA ADDR         @YM01534 87264302
         L     R3,SRBSV(,XRSAVE)    GET SRB ADDR               @YM01534 87264402
         LR    R4,R15               SET BASE REG               @YM01534 87264702
         ST    R3,SDWASR03          SET IN REGISTER AREA       @YM01534 87265002
         L     R3,SPOSTRT(,XRSAVE)  GET RETURN ADDRESS         @YM01534 87267002
         ST    R3,SDWASR08          SAVE IN REGISTER AREA      @ZA15373 87267240
         L     R3,PSAAOLD           GET ASCB ADDR              @YM01534 87267502
         ST    R3,SDWASR07          SET IN RETRY REG 7         @YM01534 87267602
         SETRP RETADDR=SPOSTFR0,RC=4,RETREGS=YES,              @YM01534X87267702
               RECPARM=POSTRPRM                                @YM01534 87268002
*/* R BACK TO RTM */                                                    87268402
         BR    R14                  RETURN                     @YM01534 87269102
         DROP  R4                                                       87269402
         SPACE 3                                                        87269640
*/* E SPOST RETRY  */                                                   87269802
*/*SPOSTFR0: N SCHEDULE ERRET BACK TO CALLER */                         87270540
SPOSTFR0 BALR  R15,R0               BOOTSTRAP ADDRESSABILITY   @YM01534 87271440
         USING *,R15                ASSUME NOTHING ABOUT REGS  @YM01534 87273340
         L     R15,BASE             COMMON ADDRESSABILITY      @ZA15373 87273540
         USING IGC002+2,XRBASE      POINT FOR POST CODE        @ZA15373 87273840
*/* P (,SPFRRT) INDICATE SRB TO BE SCHEDULED FOR POST ERRET */          87277240
         USING SRB,R3                                                   87278202
         SR    R4,R4                ERRET INDICATOR IS         @ZA10133 87278940
         ST    R4,SRBEP             ZERO SRB EPA               @ZA10133 87283140
         B     SPFRRT               GO TO SCHEDULE ERRET SRB   @ZA10133 87283840
         DROP  R3                                                       87296202
         EJECT                                                          87298202
         USING *,R4                                                     87300602
*/* E SRBFRR*/                                                          87301602
*/* S SETRP: SPECIFY RETRY AT SRBRETRY*/                                87302602
SRBFRR   LR    R4,R15              SET BASE                             87303140
         L     R3,SDWAABCC-SDWA(,R1)   GET ABEND CODE          @Y30HPVA 87303903
         ST    R3,SDWASR10-SDWA(,R1)   STORE SYSTEM COMPLETION CODE     87304203
*                                      TO PASS TO ERRET        @Y30HPVA 87304503
         SETRP RETADDR=SRBRETRY,RC=4,RECPARM=POSTRPRM RETRY FOR ERROR   87305002
*/* R RETURN*/                                                          87307002
         BR    R14                 BACK TO RTM-WILL SEE YOU AT SRBRETRY 87308040
         DROP  R4                                                       87310002
         SPACE 3                                                        87311002
*/* E SRBRETRY*/                                                        87313002
*/* P BOOTSTRAP ALL ENVIRONMENTAL REGS*/                                87315002
SRBRETRY BALR  R15,R0              BOOTSTRAP ADDRESSABILITY             87345002
         USING *,R15               ASSUME NOTHING ABOUT REGS            87395002
         L     XRASCB,PSAAOLD      CURRENT ASCB                         87405002
         L     XRSAVE,ASCBASXB     ASXB ADDR                            87415002
         L     XRSAVE,ASXBSPSA-ASXB(,XRSAVE) WSA TABLE                  87425002
         L     XRSAVE,WSALPOST-WSAL(,XRSAVE) POST WSA                   87431002
         L     R1,0(XRSAVE)        RELOAD SRB ADDR                      87437002
         LR    R8,XRSAVE           SAVE SAVE AREA POINTER               87441002
         USING SRBSECT,R1                                               87445002
*/* S SETLOCK: OBTAIN SALLOC LOCK*/                                     87445402
LK14     SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=(LK15,RLK14)    87445802
*/* D (YES,RTRYGONE,NO,) ORIG ASCB HAS GONE AWAY*/                      87447002
         L     R3,XMPQ             XMPOST SRB CHAIN FLD                 87449002
         LTR   R3,R3               SRBS ARE ORPHANS                     87451002
         BM    RTRYGONE            BR IF ORIG ASCB GONE                 87453002
         L     R4,XMASCB           ORIG ASCB ADDR                       87453140
         LA    R4,ASCBXMPQ-ASCB(,R4) ADDR OF CHAIN HEADER               87453340
*/*RTRYLOOP: D (YES,RTRYDEQ,NO,) THIS IS OUR SRB*/                      87453802
RTRYLOOP C     R1,0(,R4)           IS THIS OUR SRB                      87454040
         BE    RTRYDEQ             BR IF SO                             87454602
*/* P (,RTRYLOOP) GET NEXT SRB*/                                        87454702
         L     R4,ZERO(,R4)        GET TO NEXT SRB                      87454802
         LA    R4,XMPQ-SRBSECT(,R4) ADDR OF NEXT CHAIN                  87454902
         B     RTRYLOOP            DO IT AGAIN                          87468202
*/*RTRYGONE: P PUT XMPOST SRB BACK ON CHAIN*/                           87468502
RTRYGONE L     R13,CHAINHD         GETCHAIN HEADER             @YM02663 87468802
         ST    R13,ZERO(,R1)       SAVE OLD CHAIN PTR IN THIS  @YM02663 87469340
*                                  SRBS POINTER FIELD          @YM02663 87470802
         ST    R1,CHAINHD          PUT THIS SRB IN CHAIN AS TOP@YM02663 87471802
*/* S SETLOCK: RELEASE SALLOC LOCK*/                                    87476202
LK15     SETLOCK RELEASE,TYPE=SALLOC,RELATED=LK14                       87476602
*/* S SDUMP: DUMP SQA AND LSQA */                                       87477002
         LH    R4,ASCBASID         GET ASID                             87477102
         LR    R13,R8              SET SAVE AREA ADDR                   87477202
SDU5C    SDUMP HDRAD=POSTHDRL,                                         X87477302
               ASID=(R4),SDATA=(TRT,SQA,LSQA),BRANCH=YES                87477402
*/* S SETLOCK: RELEASE LOCAL LOCK */                           @YA02708 87477503
LK19     SETLOCK RELEASE,TYPE=LOCAL,RELATED=LK10               @YA02708 87477603
*/* R SRB EXIT*/                                                        87477703
         L     R14,CVTPTR          GET ADDR OF CVT             @YM02645 87477902
         L     R14,CVTSRBRT-CVTMAP(,R14) GET ADDR OF DISP      @YM02645 87478002
         BR    R14                 RETURN TO DISP              @YM02645 87478202
*/*RTRYDEQ: P DEQ XMPOST SRB FROM ITS PARENT ASCB*/                     87482202
RTRYDEQ  ST    R3,0(,R4)           DEQ OUR SRB                          87484240
*/* S SETLOCK: RELEASE SALLOC LOCK*/                                    87491702
RLK14    SETLOCK RELEASE,TYPE=SALLOC,RELATED=LK14                       87492102
*/* P SET UP SRB FOR SCHEDULE TO ERRET*/                                87493702
         LA    XRWORK,ERRET                                             87495002
         ST    XRWORK,SRBEP        ENTRY POINT                          87545002
         MVC   SRBASCB,XMASCB      ADDR OF ORIGINATING ASCB             87595002
         ST    XRASCB,XMASCB       SAVE FAILING ASCB ADDR               87645002
         ST    R10,XMPQ            PASS SYS COMP CODE          @Y30HPVA 87647040
*/* S SCHEDULE: SRB TO USERS ERRET*/                                    87655002
         DROP  R15                                                      87665002
         BALR  R4,R0               SET NEW BASE                         87675002
         USING *,R4                USE NEW BASE                         87685002
         SCHEDULE SRB=(1),SCOPE=LOCAL                                   87695002
*/* S SETFRR: DELETE XMPOST SRB FRR*/                                   87697002
         SETFRR D,WRKREGS=(XRWORK,XRSCRTCH)  DELETE FRR                 87705002
*/* S SETLOCK: RELEASE LOCAL LOCK*/                                     87707002
LK16     SETLOCK RELEASE,TYPE=LOCAL,RELATED=LK10                        87715002
*/* R SRB EXIT*/                                                        87725002
         L     R14,CVTPTR          ADDR OF CVT                          87735002
         L     R14,CVTSRBRT-CVTMAP(,R14) SRB EXIT TO DISP               87737002
         BR    R14                 NEXT STOP, ERRET IN ORIG ADDR SPACE  87745002
         DROP  R4                                                       87795002
         SPACE 3                                                        87845002
         USING *,R15                                                    87895002
*/* E ERRET*/                                                           87905002
*/* P PICK UP XMPOST PARMS FROM SRB*/                                   87915002
ERRET    LR    R1,R0               ADDR OF SRB                          87945002
         LR    R5,R14              SAVE R14 ACROSS FM                   88045002
         LM    R6,R10,SRBEND       SAVE PARMS                  @Y30HPVA 88065040
*/* S SETLOCK: OBTAIN SALLOC LOCK*/                                     88097002
LK17     SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=LK18            88105002
*/* P PUT XMPOST SRB BACK ON CHAIN*/                                    88106002
         L     R13,CHAINHD         GETCHAIN HEADER             @YM02663 88107002
         ST    R13,ZERO(,R1)       SAVE OLD CHAIN PTR IN THIS  @YM02663 88112040
*                                  SRBS POINTER FIELD          @YM02663 88127002
         ST    R1,CHAINHD          PUT THIS SRB IN CHAIN AS TOP@YM02663 88137002
*/* S SETLOCK: RELEASE SALLOC LOCK*/                                    88147002
LK18     SETLOCK RELEASE,TYPE=SALLOC,RELATED=LK17                       88155002
*/* P SET UP REGS FOR ENTRY TO USERS ERRET*/                            88165002
         LR    R1,R6               ASCB ADDR                            88195002
         LR    R0,R7               ECB ADDR                             88245002
         LR    R14,R5              DISPATCHER SRB EXIT ADDR             88295002
         LR    R2,R9               CCODE                                88305002
         LR    R3,R10              SYSTEM COMP CODE            @Y30HPVA 88315040
         LR    R15,R8              ERRET ADDR                           88345002
*/* R REG 15*/                                                          88355002
         BR    R15                 TO USER ERRET                        88395002
         EJECT                                                          88395703
         USING *,R4                                            @Y30HPVA 88396403
*/* E EVNTFRR */                                                        88397103
EVNTFRR  LR    R4,R15              SET BASE                    @Y30HPVA 88397440
         LR    R5,R14              SAVE RTM RETURN ADDRESS     @ZA20188 88397940
*/* P CHANGE COMPLETION CODE TO 402 ABEND */                            88398503
*/* S SETRP: PERCOLATE TO CALLER */                                     88401340
         SETRP RECORD=NO,RC=0,COMPCOD=(X'402',SYSTEM),DUMP=YES @Y30HPVA 88402003
*/* R RETURN */                                                         88402703
         LR    R14,R5              RESTORE RTM RETURN ADDRESS  @ZA20188 88402840
         BR    R14                 BACK TO RTM                 @Y30HPVA 88403040
         DROP  R4                                              @Y30HPVA 88404203
         EJECT                                                          88445002
CHECK    DC    A(IEA0VL01)         ADDRESS OF VALIDITY CHECK            88495040
ADDRPT01 DC    A(IEA0PT01)         ADDR OF POST BR ENTRY       @YM01534 93847040
DISPTCHR DC    A(IEA0DS)           ADDR OF DISPATCHER                   93855040
BASE     DC    A(IGC002+2)         POST BASE                            93895040
BASEWT   DC    A(WAITBAS)          WAIT BASE                       MTS0 93945040
POSTHDRL DC    AL1(PSTMSE-POSTRPRM)  LENGTH OF SDUMP HEADER             94095002
POSTRPRM DC    CL8'IEAVSY50'       MODULE NAME FOR RECPARM              94145002
         DC    CL8'IGC001'         CSECT NAME FOR RECPARM               94245002
         DC    CL8'IGC002'         POST AS FRR NAME                     94345002
         DC    C'XMPOST FAIL-NO ERRET'   MSG FOR SDUMP                  94375002
PSTMSE   EQU   *                   LABEL FOR SETUP OF ADCON             94405002
CHAINHD  DC    F'0'                CHAIN HEADER FOR XMPOST SRBS@YM02663 94445002
RBVALID  DC    X'0000000F'         USED TO ZERO ALL BUT LAST 4 BITS     94495040
WPRBPREL DC    AL4(RBPRFXND-RBPREFIX)    LENGTH OF RB PREFIX            95345001
OFFWAIT  DC    XL4'7FFFFFFF'       MASK TO SET OFF WAIT BIT             95355002
ONCOMPL  DC    XL4'40000000'       MASK TO T                            95365002
ABND402  DC    XL4'80402000'       ABEND CODE 402              @Y30HPVA 95372040
ABND502  DC    XL4'80502000'       ABEND CODE 502              @Y30HPVA 95379040
ABND702  DC    XL4'80702000'       ABEND CODE 702              @Z40EPVD 95386040
PXITCODE DC    XL4'01000000'       POST EXIT FUNCTION CODE     @Z40EPVD 95389040
TIDBIT   DC    X'80000000'         WORD WITH HIGH ORDER BIT             95392040
ERRORFLG DC    X'80'               TO TELL ABEND TO DUMP                95395040
WOS      DS    X                   WRITE-ONLY-STORAGE FOR STNSM         95398040
         EJECT                                                          95404040
*     EXECBFRR - RECOVERY FOR POST EXIT FUNCTION                        95407040
         SPACE 2                                                        95410040
*/* E EXECBFRR*/                                                        95413040
EXECBFRR EQU   *                        POST EXIT RECOVERY     @Z40EPVD 95414040
         BALR  R12,ZERO                 ESTABLISH BASE REG     @Z40EPVD 95416040
         USING *,R12                    ESTAB ADDRESSABILITY   @Z40EPVD 95418040
*/* D (NO,NOTREF,YES,) LSQA REFERENCEABLE*/                             95422040
         ICM   R0,M0011,SDWAFMID-SDWA(R1) LSQA REFERENCEABLE   @Z40EPVD 95425040
         BNZ   NOTREF                   NO, SKIP PROCESSING    @Z40EPVD 95427040
*/* D (YES,SURPRISE,NO,) WAS ERROR EXPECTED*/                           95431040
         L     R5,SDWAPARM-SDWA(R1)     GET FRR WORK AREA      @Z40EPVD 95434040
         L     R6,ZERO(R5)              GET FAILURE CODE       @Z40EPVD 95436040
         LTR   R6,R6                    ZERO REASON CODE       @Z40EPVD 95438040
         BZ    SURPRISE                 YES, ERROR NOT EXPTD   @Z40EPVD 95440040
*/* P SET FAILURE REASON CODE*/                                         95446040
         ST    R6,SDWAGR15-SDWA(R1)     SET RC IN SDWA         @Z40EPVD 95449040
*/* S SETRP: NO RECORD, DUMP, 702 ABEND CODE, PERC*/                    95452040
         LR    R6,R14                   SAVE RETURN ADDR       @ZM40133 95453040
         SETRP RECORD=NO,RC=0,COMPCOD=(X'702',SYSTEM),DUMP=YES @Z40EPVD 95454040
*/* R RETURN*/                                                          95458040
         LR    R14,R6                   RESET RETURN ADDR      @ZM40133 95459040
         BR    R14                      RETURN TO RTM          @Z40EPVD 95461040
*/*SURPRISE: P PRIME SDWA WITH PERTINENT DATA */                        95464040
SURPRISE EQU   *                        UNEXPECTED ERROR       @Z40EPVD 95467040
*        ALTHOUGH A CHANGE WAS MADE TO SAVE REGS 12 AND 13,    @ZA30491 95467740
*        THOSE REGISTERS WOULD NOT BE USEFUL IF SAVED IN THE   @ZA30491 95468440
*        VRA. (THEY CONTAIN USER DATA WHICH IS MEANINGLESS TO  @ZA30491 95469140
*        POST.) THEREFORE, NO CHANGE WAS MADE HERE IN THE FRR. @ZA30491 95469440
         L     XRSAVE,PSAAOLD           CURRENT ASCB           @Z40EPVD 95470040
         L     XRSAVE,ASCBASXB-ASCB(XRSAVE) ASXB ADDR          @Z40EPVD 95471040
         L     XRSAVE,ASXBSPSA-ASXB(,XRSAVE) LOCAL WSAVT ADDR  @Z40EPVD 95474040
         L     XRSAVE,WSALPOST-WSAL(,XRSAVE) POST WSA ADDR     @Z40EPVD 95476040
         OI    SDWADPVA-SDWA(R1),SDWAHEX VRA CONTAINS HEX DATA @Z40EPVD 95485040
         SR    R5,R5                     ZERO WORK REG         @Z40EPVD 95488040
         IC    R5,SDWAURAL-SDWA(R1)      GET USED VRA          @Z40EPVD 95491040
         LA    R6,LSAEND-LSAPEXIT(,R0)   SIZE OF DATA          @Z40EPVD 95494040
         ICM   R7,M0011,SDWAVRAL-SDWA(R1) POSSIBLE SIZE        @Z40EPVD 95497040
         CR    R5,R7                     VRA FULL              @Z40EPVD 95498040
         BE    SAVENONE                  YES, SKIP SAVE        @Z40EPVD 95499040
         SR    R7,R5                     AVAILABLE SIZE        @Z40EPVD 95500040
         CR    R6,R7                     WILL MAX DATA FIT     @Z40EPVD 95503040
         BH    STORESUM                  NO, GO STORE SOME     @Z40EPVD 95506040
         EX    R6,MVC4FRR                MOVE DATA TO VRA      @Z40EPVD 95509040
         AR    R5,R6                     UPDATE USED SIZE      @Z40EPVD 95512040
         B     SAVEIT                    GO SAVE IT            @Z40EPVD 95515040
STORESUM EQU   *                         STORE MAX POSSIBLE    @Z40EPVD 95518040
         LR    R2,R1                     SAVE SDWA ADDR        @Z40EPVD 95521040
         LA    R1,ZERO(R5,R1)            RESET REG1 - EX INST  @Z40EPVD 95524040
         EX    R7,MVC4FRR                PUT DATA IN VRA       @Z40EPVD 95527040
         LR    R1,R2                     RESET SDWA ADDR       @Z40EPVD 95533040
         AR    R5,R7                     UPDATE SIZE USED      @Z40EPVD 95536040
SAVEIT   EQU   *                         SAVE SIZE USED        @Z40EPVD 95536540
         STC   R5,SDWAURAL-SDWA(R1)      DITTO                 @Z40EPVD 95538040
*/* P CLEAR TEMP AND EXT SAVE AREA IN USE FLAGS */                      95539040
SAVENONE EQU   *                         VRA FULL LABEL        @Z40EPVD 95540040
         NI    LSAFLGS-LSA(XRSAVE),XFF-EXTSA-PEXITSA  NOT USED @Z40EPVD 95541040
*/*NOTREF: S SETRP: RECORD, DUMP, PERC*/                                95542040
NOTREF   EQU   *                         PREPARE TO EXIT       @Z40EPVD 95545040
         SETRP RECORD=YES,RC=0,DUMP=YES,RECPARM=MODCID         @Z40EPVD 95547040
*/* R RETURN*/                                                          95551040
         BR    R14                       RETURN TO RTM         @Z40EPVD 95554040
MVC4FRR  MVC   SDWAVRA-SDWA(1,R1),LSAPEXIT-LSA(XRSAVE) SAVE    @Z40EPVD 95557040
MODCID   DC    CL24'IGC001  IGC002  EXECBFRR' MOD CSECT FRR ID @Z40EPVD 95558040
         DROP  R12                       DROP BASE                      95559040
*/* POSTR: END*/                                                        95561040
         EJECT                                                          95563040
*/*EXITCD: CHART*/                                                      95564040
*     ENTRY POINT - IEA0PT0E                                   @Z40EPVD 95566040
         SPACE                                                          95569040
IEA0PT0E EQU   *                         IDENTIFY/DELETE EXITS @Z40EPVD 95570040
         USING *,XRBASE                                        @Z40EPVD 95571040
*/* E IEA0PT0E*/                                                        95575040
*    IEA0PT0E - IDENTIFIES/DELETES POST EXIT ROUTINE ADDRESSES @Z40EPVD 95578040
*               FROM THE POST EXIT ROUTINE QUEUE (ASXBPT0E)    @Z40EPVD 95581040
         SPACE                                                          95584040
*               REGISTER USAGE                                 @Z40EPVD 95587040
*                 0 - FUNCTION CODE AND GET FREE LENGTH        @Z40EPVD 95589040
*                 1,11 - POST EXIT ROUTINE ADDR                @Z40EPVD 95591040
*                 3,6 - WORK REGS                              @Z40EPVD 95592040
*                 4 - TCB ADDRESS                              @Z40EPVD 95593040
*                 7 - ASCB ADDRESS                             @Z40EPVD 95595040
*                 8 - ASXB ADDRESS                             @Z40EPVD 95597040
*                 9 - POST EXIT QUEUE HEADER OR ACTIVE BLOCK   @Z40EPVD 95599040
*                 12 - BASE REG                                @Z40EPVD 95600040
*                 13 - POST WSA ADDRESS                        @Z40EPVD 95601040
*                 14,15 - GETMAIN/FREEMAIN INTERFACE REGS      @Z40EPVD 95602040
         SPACE 2                                                        95614040
*/* P GET ADDRESS OF LOCAL SAVE AREA - SAVE REGS*/                      95617040
         L     XRBASE,PSAAOLD           CURRENT ASCB ADDR      @Z40EPVD 95620040
         L     XRBASE,ASCBASXB-ASCB(,XRBASE) ASXB ADDR         @Z40EPVD 95623040
         L     XRBASE,ASXBSPSA-ASXB(,XRBASE) LOCAL WSAVT ADDR  @Z40EPVD 95626040
         L     XRBASE,WSALPOST-WSAL(,XRBASE) POST WSA ADDR     @Z40EPVD 95629040
         STM   R0,R14,LSAMAIN-LSA(XRBASE) SAVE CALLERS REGS    @Z40EPVD 95632040
         LR    R13,XRBASE               RETAIN WSA ADDR        @Z40EPVD 95635040
         BALR  R12,R0                   ESTAB BASE REG         @Z40EPVD 95638040
         USING *,R12                    ESTAB ADDRESSABILITY   @Z40EPVD 95640040
*/* P INIT MAINLINE REGS*/                                              95644040
         L     R7,PSAAOLD               CURRENT ASCB ADDR      @Z40EPVD 95647040
         L     R8,ASCBASXB-ASCB(,R7)    ASXB ADDR              @Z40EPVD 95650040
         L     R9,ASXBPT0E-ASXB(,R8)    POST EXIT QUEUE HEADER @Z40EPVD 95653040
         LR    R11,R1                   SAVE EXIT ROUTINE ADDR @Z40EPVD 95656040
         L     R4,ASXBFTCB-ASXB(,R8)    NEED A TCB ADDR        @Z40EPVD 95659040
*/* D (YES,CREATE,NO,) EXIT CREATION REQUEST*/                          95662040
         LA    R3,CCODE                 GET CREATE CODE        @Z40EPVD 95663040
         CR    R0,R3                    CREATE REQUEST         @Z40EPVD 95665040
         BE    CREATE                   YES, GO PROCESS        @Z40EPVD 95668040
*/* D (YES,DELETE,NO,) EXIT DELETION REQUEST*/                          95671040
         LA    R3,DCODE                 GET DELETE CODE        @Z40EPVD 95672040
         CR    R0,R3                    DELETE REQUEST         @Z40EPVD 95674040
         BE    DELETE                   YES, GO PROCESS        @Z40EPVD 95675040
*/* P ABEND REASON CODE - 0*/                                           95677040
         LA    R6,RC0                   SET ABEND REASON CODE  @Z40EPVD 95680040
*/*AB702: R ABEND 702*/                                                 95683040
AB702    EQU   *                        ABEND CALLER           @Z40EPVD 95684040
         L     R1,ABNDC702              GET 702 ABEND CODE     @Z40EPVD 95689040
         LR    R15,R6                   ESTABLISH REASON CODE  @Z40EPVD 95690040
         SVC   ABENINST                 ABEND                  @Z40EPVD 95692040
*/*CREATE: S GETMAIN: GET 8 BYTES FROM SUBPOOL 255*/                    95695040
CREATE   EQU   *                        PROCESS CREATE REQUEST @Z40EPVD 95698040
         LA    R0,EIGHT                 PRIME LENGTH - 8       @Z40EPVD 95701040
         GETMAIN RU,LV=(0),SP=255,BRANCH=YES,RELATED=(GOTEXIT) @Z40EPVD 95704040
*/* P INITIALIZE EXIT ADDRESS IN BLOCK*/                                95710040
         ST    R11,FOUR(R1)             INIT EXIT ADDR         @Z40EPVD 95713040
*/* P (,PT0EDONE) PLACE BLOCK ON TOP OF POST EXIT QUEUE*/               95716040
         ST    R9,ZERO(,R1)             CURRENT HEADER INTO BLK@Z40EPVD 95719040
         ST    R1,ASXBPT0E-ASXB(,R8)    POINT HEAD TO NEW BLK  @Z40EPVD 95722040
         B     PT0EDONE                 GO EXIT                @Z40EPVD 95725040
*/*DELETE: D (NO,AB702RC4,YES,) ANY MORE EXITS*/                        95728040
DELETE   EQU   *                        PROCESS DELETE REQUEST @Z40EPVD 95731040
         LA    R10,ASXBPT0E-ASXB(,R8)   GET HEADER ADDR        @Z40EPVD 95732040
DELLOOP  EQU   *                        LOOP LABEL             @Z40EPVD 95733040
         LTR   R9,R9                    ANY MORE EXITS         @Z40EPVD 95734040
         BZ    AB702RC4                 NO, GO ABEND           @Z40EPVD 95737040
*/* D (YES,GOTEXIT,NO,) EXIT ADDRESSES MATCH*/                          95743040
         C     R11,FOUR(R9)             EXIT ADDRESSES MATCH   @Z40EPVD 95845040
         BE    GOTEXIT                  YES, EXIT LOOP         @Z40EPVD 95845440
*/* P (,DELETE) GET ADDR OF NEXT BLOCK*/                                95845840
         LR    R10,R9                   NO, SAVE CURRENT ADDR  @Z40EPVD 95846240
         L     R9,ZERO(,R9)             GET NEXT BLOCK ADDR    @Z40EPVD 95846640
         B     DELLOOP                  LOOP BACK              @Z40EPVD 95847040
*/*AB702RC4: P (,AB702) SET REASON CODE TO 4*/                          95847440
AB702RC4 LA    R6,RC4                   SET RC TO 4            @Z40EPVD 95847840
         B     AB702                    GO ABEND               @Z40EPVD 95847940
*/*GOTEXIT: P REMOVE BLOCK FROM QUEUE*/                                 95848040
GOTEXIT  EQU   *                        FOUND BLK TO DELETE    @Z40EPVD 95848140
         L     R6,ZERO(,R9)             GET FORWARD PTR        @Z40EPVD 95848240
         ST    R6,ZERO(,R10)            CHAIN AROUND SUBJECT   @Z40EPVD 95848640
*/* S FREEMAIN: FREE BLOCK STORAGE*/                                    95849040
         LA    R0,EIGHT                 PRIME LENGTH - 8       @Z40EPVD 95849440
         FREEMAIN RU,LV=(0),A=(R9),SP=255,BRANCH=YES,RELATED=(CREATE)   95849840
*/*PT0EDONE: P RESTORE CALLERS REGS*/                                   95850640
PT0EDONE EQU   *                        EXIT CODE              @Z40EPVD 95850840
         LM    R0,R14,LSAMAIN-LSA(R13)  RESET CALLERS REGS     @Z40EPVD 95851040
*/* R RETURN*/                                                          95851440
         BR    R14                      RETURN TO CALLER       @Z40EPVD 95851840
         SPACE                                                          95852240
         DS    0F                       FULL WORD ALIGN        @Z40EPVD 95852440
ABNDC702 DC    XL4'80702000'            ABEND CODE 702         @Z40EPVD 95852640
*/*EXITCD: END*/                                                        95853640
         TITLE 'IEAVSY50.. ..LOCAL.SAVE.AREA'                           95855640
LSA      DSECT                                                          95856240
LSAMAIN  DS    0F                     MAIN SAVE AREA           @Z40EPVD 95856840
         DS    16F                    NORMAL SAVE AREA         @ZA30491 95857540
LSAPEXI2 DS    0F                     ADDITION TO POST EXT S.A.@ZA30491 95857640
         DS    F                      SLOT FOR REG 12          @ZA30491 95857740
         DS    F                      SLOT FOR REG 13          @ZA30491 95857840
LSAPEXIT DS    0F                     POST EXIT SAVE AREA      @Z40EPVD 95858240
         DS    4F                     EXIT INTERFACE SAVE AREA @Z40EPVD 95859840
LSAFLGS  DS    B                      POST FLAGS BYTES         @Z40EPVD 95860440
EXTSA    EQU   X'80'                  EXT SAVE AREA IN USE     @Z40EPVD 95861040
PEXITSA  EQU   X'40'                  POST EXIT SA IN USE      @Z40EPVD 95861640
LSARES1  DS    B                      RESERVED                 @Z40EPVD 95862240
LSARES2  DS    B                      RESERVED                 @Z40EPVD 95862840
LSARES3  DS    B                      RESERVED                 @Z40EPVD 95863440
LSAXITEP DS    1F                     EXIT ENTRY POINT         @Z40EPVD 95863540
LSAEXT   DS    0F                     EXTENDED SAVE AREA       @Z40EPVD 95863740
         DS    15F                    REGS 0-14                @Z40EPVD 95864140
LSAEND   DS    0B                     END OF WSA               @Z40EPVD 95864740
         TITLE 'IEAVSY50....ECB'                                        95865040
         IHAECB EXT=YES                                                 95875040
         TITLE 'IEAVSY50....EVNT'                                       95885040
         IHAEVNT                                                        95895003
         TITLE 'IEAVSY50....CSCB'                                       95945040
CSCB     DSECT                                                    20002 95995001
         IEECHAIN                                                 20002 96045001
         TITLE 'IEAVSY50....RMPL '                                      96047040
         IHARMPL                                                        96049002
         TITLE 'IEAVSY50....RTCA'                                       96055040
         IHASDWA                                                        96065002
         TITLE 'IEAVSY50....CVT'                                        96095040
         CVT   DSECT=YES                                                96145002
         TITLE 'IEAVSY50....JSCB'                                       96245040
         IEZJSCB                                                  20002 96295001
         TITLE 'IEAVSY50....ASCB'                                       96305040
         IHAASCB                                                        96315002
         TITLE 'IEAVSY50....ASXB'                                       96317040
         IHAASXB                                                        96319002
         TITLE 'IEAVSY50....SRB'                                        96319440
         IHASRB                                                         96321002
XMASCB   DS    F                   ASCB ADDR                            96322040
XMECB    DS    F                   ECB ADDR                             96323040
XMERRET  DS    F                   ERROR RETURN ADDR                    96323802
XMCCODE  DS    F                   ECBKEY BIT; COMPLETION CODE @ZA15373 96323940
XMPQ     DS    F                   ORIGINATING ASCB XMP Q               96324340
XMECBKEY DS    B                   ECB STORAGE KEY FOR VAL CHK @ZA15373 96324440
         DS    BL3                 RESERVED                    @ZA15373 96324540
SRBLENTH EQU   *-SRBSECT           LENGTH OF POST SRB                   96324840
         TITLE 'IEAVSY50....FIXED LOW CORE'                             96325040
         IHAPSA                                                         96335002
         TITLE 'IEAVSY50....LCCA'                                       96335440
         IHALCCA                                                        96335802
         TITLE 'IEAVSY50....FRRSTACK'                                   96336240
         IHAFRRS                                                        96336602
         TITLE 'IEAVSY50....GLOBAL SAVE AREA'                           96336740
         IHAWSAVT CLASS=GLOBAL                                          96336940
         TITLE 'IEAVSY50....WSAVT'                                      96337040
         IHAWSAVT                                                       96339002
         TITLE 'IEAVSY50....ASVT'                                       96341040
         IHAASVT                                                        96343002
         TITLE 'IEAVSY50....RB'                                         96345040
         IHARB                                                          96405002
         TITLE 'IEAVSY50....TCB'                                        96445040
         IKJTCB                                                         96495001
         END                                                            97145001
./  ADD  SSI=80870457,NAME=IEAVTB00
         TITLE 'IEAVTB00...IGC0001D...SPIE PROCESSING'                  00100002
*/* START OF SPECIFICATIONS ****                                        00104002
*                                                                       00106002
*01*  MODULE-NAME = IEAVTB00                                            00112002
*                   NOTE - AT SYSGEN TIME THE MODULE                    00114002
*                   NAME IS CHANGED TO IGC0004X                         00116002
*                   WHERE X IS A 12-0 PUNCH.                            00118002
*                   THE ENTRY POINT IS IGC00040.                        00120002
*                                                                       00124002
*02*     CSECT-NAME = IGC0001D                                          00128002
*                                                                       00136002
*01*  DESCRIPTIVE-NAME = SPIE/EXTRACT SERVICE ROUTINES                  00140002
*                                                                       00148002
*01*  COPYRIGHT = NONE                                                  00152002
*                                                                       00156002
*01*  STATUS = OSVS2 RELEASE 2                                          00172002
*                                                                       00180002
*01*  FUNCTION = SPIE - SPIE PROVIDES A PROBLEM PROGRAM WITH A MEANS OF 00184002
*     SPECIFYING AN ERROR EXIT ROUTINE IN RESPONSE TO ONE OR MORE       00186002
*     PROGRAM ERROR INTERRUPTS.                                         00188002
*                EXTRACT - PROVIDES A MEANS OF OBTAINING                00188502
*     THE ADDRESS OR THE VALUES OF A PREDEFINED SET OF FIELDS WITHOUT   00189002
*     CHASING THROUGH VARIOUS SYSTEM QUEUES.                            00190002
*                                                                       00192002
*02*     OPERATION = SPIE - INITIALLY DOES GETMAIN FOR SCA AND PIE AND  00196002
*        CHAINS THEM ALONG WITH THE USER INPUT (PICA) TO THE TCBPIE     00200002
*        FIELD IN THE TCB. WHEN THE INPUT FROM THE CALLER REFLECTS A    00208002
*        CANCEL REQUEST THE SCA & PIE ARE FREED AND TCBPIE RESET TO     00209002
*        ZERO. SPIE WILL ALSO GETMAIN A RECOVERY PIE PICA WHICH WILL BE 00210003
*        USED TO MAINTAIN A SPIE ENVIRONMENT WHEN AN RB TERMINATES      00210103
*        ABNORMALLY. THE RPP WILL CONTAIN THE PIE,PICA,AND RB POINTERS  00210203
*        FOR THE RB ISSUING THE SPIE.                                   00210303
*                                                                       00210803
*                EXTRACT - OBTAINS SYSTEM DATA AND RETURNS IT OR THE    00210903
*        ADDRESS OF IT IN A USER SUPPLIED ANSWER AREA.                  00211002
*                                                                       00212002
*01*   NOTES = BOTH PROGRAMS RUN PARTICALLY IN USER KEY AND KEY ZERO.   00216002
*      BE CAREFUL WHEN MAKING CODE CHANGES.                             00218002
*                                                                       00220002
*02*     DEPENDENCIES = BOTH SPIE AND EXTRACT MUST BE ENTERED WITH THE  00224002
*        LOCAL LOCK HELD, KEY 0 AND IN SUPERVISOR STATE.                00228002
*                                                                       00244002
*03*        CHARACTER-CODE-DEPENDENCIES = NONE                          00248002
*                                                                       00252002
*02*     RESTRICTIONS = SPIE-CALLER MUST BE AUTHORIZED FOR SPIE PROGRAM 00264002
*        CHECK 17.  CALLER MUST BE IN PROBLEM MODE AND KEY MUST EQUAL   00266002
*        TO THE TCBPKF KEY.                                             00268002
*                                                                       00272002
*02*     REGISTER-CONVENTIONS = R12 IS USED TO COMMUNICATE BETWEEN THE  00276002
*        MAINLINE AND THE FRR.                                          00280002
*                                                                       00292002
*02*     PATCH-LABEL = IEAVTBP                                          00296002
*                                                                       00298002
*01*  MODULE-TYPE = TYPE 3 SVC ROUTINE                                  00306002
*                                                                       00310002
*02*     PROCESSOR = ASSEMBLER                                          00312002
*                                                                       00314002
*02*     MODULE-SIZE = 1400 BYTES                                       00316002
*                                                                       00322002
*02*     ATTRIBUTES = PAGED-LPA, ZERO PROTECT KEY, ENABLED,             00324002
*        REENTERABLE, REFRESHABLE, LOCALLY LOCKED                       00330002
*        SUPERVISOR MODE;                                               00332002
*                                                                       00334002
*01*  ENTRY-POINT = IGC0001D - SPIE;                                    00336002
*                                                                       00336102
*02*     INPUT =                                                        00336202
*        REGISTERS - 0, 15 IRRELEVANT                                   00336302
*                  - 1 ADDRESS OF PICA OR ZERO(FOR CANCEL)              00336402
*                  - 2-14 NORMAL SVC REG SET UP                         00336802
*                                                                       00346002
*01*  ENTRY-POINT = IEAVSPIE - SPIE RESOURCE MANAGER                    00348002
*                                                                       00350002
*02*     INPUT =                                                        00352002
*        REGISTERS - 1 ADDRESS OF WORD WHICH CONTAINS THE ADDRESS       00354002
*                      OF THE RMPL.                                     00356002
*                  - 13 ADDRESS OF 72 BYTE SAVE AREA                    00358002
*                  - 14 RETURN ADDRESS                                  00360002
*                  - 15 ENTRY ADDRESS                                   00362002
*                  - 0, 2-12 IRRELEVANT                                 00364002
*01*  ENTRY-POINT = IGC00040 - EXTRACT SVC ENTRY                        00366002
*                                                                       00368002
*02*     INPUT =                                                        00370002
*        REGISTERS - 0, 15 IRRELEVANT                                   00372002
*                  - 1 ADDRESS OF EXTRACT PARAMETER LIST                00374002
*                 - 2-14 NORMAL SVC REGISTERS                           00376002
*01*  ENTRY-POINT = IGC00040+8 - BRANCH ENTRY TO EXTRACT                00378002
*                                                                       00380002
*02*     INPUT =                                                        00382002
*        REGISTERS - 1 ADDRESS OF EXTRACT PARM LIST                     00384002
*                  - 4 ADDRESS OF TCB                                   00386002
*                  - 14 RETURN ADDRESS                                  00388002
*                  - 15 ENTRY ADDRESS                                   00390002
*                  - 3 CVT ADDRESS                                      00392002
*                  - 0,2,5-13 IRRELEVANT                                00394002
*01*  ENTRY-POINT = IEAVSPI - CHECKPOINT/RESTART SUBROUTINE             00396002
*                                                                       00400002
*02*     INPUT =                                                        00402002
*        REGISTERS - 1 SSCA ADDRESS                                     00404002
*                  - 13 ADDRESS OF 72 BYTE SAVE AREA                    00406002
*                  - 14 RETURN ADDRESS                                  00408002
*                  - 15 ENTRY ADDRESS                                   00410002
*                  - 0 2-12 IRRELEVANT                                  00412002
*                                                                       00414002
*                                                                       00416002
*01*  EXIT-NORMAL = RETURN TO CALLER ON REGISTER 14.                    00426002
*                   SPIE - R1 CONTAINS  THE ADDRESS OF THE PREVIOUS     00426602
*                          PICA OR 0. NO RETURN CODES.                  00427202
*                   EXTRACT - NO RETURN CODES.                          00428002
*                   IEAVSPIE - RETURN CODE 0.                           00430002
*                   IEAVSPI - RETURN CODE 0                             00432002
*                                                                       00434002
*                                                                       00462002
*01*  EXIT-ERROR = SPIE - ABEND CODES:                                  00464002
*                       - '10E' INVALID PICA;                           00464202
*                       - '20E' INVALID PIE                             00464402
*                       - '30E' NOT AUTHORIZED FOR INTERRUPT            00464602
*                            CODE 17 OR CALLED  SPIE IN SUPERVISOR      00465002
*                            STATE OR HAD A PSW KEY OTHER THAN          00465602
*                            THAT CONTAINED IN THE TCBPICF.             00466202
*                  EXTRACT - ABEND CODES:                               00466802
*                       - '128' INVALID ANSWER LIST                     00467402
*                       - '228' INVALID PARM LIST                       00468002
*                       - '338' INVALID TCB ADDRESS                     00468302
*                  IEAVSPIE - NONE                                      00468602
*                  IEAVSPI - NONE                                       00469002
*                                                                       00472002
*01*  EXTERNAL-REFERENCES = ROUTINES                                    00512002
*                           SPIE - ABEND, GETMAIN, FREEMAIN, TESTAUTH   00513002
*                                  PURGEDQ                              00513502
*                           EXTRACT - ABEND                             00514002
*                                                                       00519002
*02*     DATA-AREAS = SPIE - NONE                                       00520002
*                     EXTRACT - ANSWER LIST SUPPLIED BY CALLER          00521002
*                     IEAVSPI - SSCRDATA MAPPED BY THE DATA DSECT.      00522002
*                                                                       00525002
*02*     CONTROL-BLOCKS = SPIE - TCB, RB, PIE, PICA, SCA                00526002
*                         EXTRACT - TCB,  ASCB, JSCB, CSCB, IQE, RB;    00527002
*                         IEAVSPIE - RMPL, TCB, RB, PIE, PICA,          00528002
*                         IEAVSPI - SSCR, TCB, PIE, PICA                00529002
*                                                                       00530002
*                                                                       00531002
*01*  TABLES = NONE                                                     00532002
*                                                                       00534002
*01*  MACROS = SPIE - ABEND, FREEMAIN, GETMAIN, MODESET, SETFRR,        00536002
*                     SETLOCK, SETRP, TESTAUTH, PURGEDQ.                00538002
*              EXTRACT - ABEND, MODESET, SETFRR, SETRP.                 00538502
*                                                                       00539002
*02*    SERIALIZATION = THE LOCAL LOCK IS USED FOR SERIALIZATION        00540002
*                                                                       00543002
*01*  CHANGE-ACTIVITY = Y02752 FOR OS/VS2 FOR RELEASE 2                 00544002
*                       OZ06785 - HANDLE PROBLEM PROGRAM SPIE COVERAGE  00547003
*                                 AND MULTIPLE LOGREC ENTRIES BY        00547103
*                                 PROGRAM MANAGER.             @ZA28693 00548203
*                       OZ11839 - SPIE CONTROL BLOCKS WILL BE FREED ON  00548303
*                                 TERMINATION.                 @ZA28693 00548403
*                       OZ12729 - CHECKPOINT/RESTART SUPPORT. THE       00548603
*                                 RPIEPICA IS REBUILT AFTER RESTART IF  00548703
*                                 THERE WAS AN OUTSTANDING SPIE AT THE  00548803
*                                 CHECKPOINT.                  @ZA28693 00548903
*                       OZ20162 - ISSUE MODESET TO USER KEY BEFORE      00549103
*                                 REFERENCING THE USERS PICA. IF A PAGE 00549203
*                                 FAULT OCCURS AND IS INVALID FOR ANY   00549303
*                                 REASON THE USER WILL BE ABENDED WITH  00549403
*                                 A 10E COMPLETION CODE.       @ZA28693 00549503
*                       OZ28693 - IF THE NEXT RPIEPICA IS ZERO THEN THE 00549603
*                                 PIE WILL BE FREED AND THE SCAPIE SET  00549703
*                                 TO ZERO DURING RB TERMINATION WITH A  00549803
*                                 RETRY TO AN ESTAE ROUTINE.   @ZA28693 00550603
*                       OZ29414 - CHANGE THE PURGEDQ MACRO FROM STAND-  00550703
*                                 ARD FORM TO LIST AND EXECUTE FORMS SO 00550803
*                                 THAT IEAVTB00 WILL NOT STORE INTO     00550903
*                                 ITSELF.                      @ZA29414 00551003
*                       OZ31066 - FIX PE FOR OZ28693 BY ISSUING         00551103
*                                 FREEMAIN SVC INSTEAD OF THE BRANCH    00551203
*                                 ENTRY USED IN THE ORIGINAL.  @ZA31066 00551303
*01*  MESSAGES = NONE                                                   00551403
*                                                                       00552203
*01*  ABEND-CODES = (SEE EXITS ERROR)                                   00554002
*                                                                       00557002
**** END OF SPECIFICATIONS ***/                                         00558002
IGC0001D CSECT                                                          00560002
         EJECT                                                          00560502
         ENTRY IEAVSPIE       E.P. FOR THE RESOURCE MANAGER             00561002
         ENTRY IEAVSPI        E.P. SPECIFICALLY FOR CHECKPT/RESTART     00562002
         ENTRY IGC00040       E.P. FOR EXTRACT SVC ENTRY                00563002
         USING PSA,0          PSA AT LOC 0                              00564002
*        R0 THRU R3 ARE WORK REGISTERS                                  00600002
         USING TCB,R4         CURRENT TCB REGISTER                      00700002
         USING RBSECT,R5      SPIE'S SVRB ADDRESS                       00800002
         USING IGC0001D,R6    SPIE'S BASE REGISTER                      00900002
         USING ASCB,R7        CURRENT ASCB ADDRESS                      01000002
         USING PIE,R8         PIE ADDRESS                               01100002
         USING PICA,R9        NEW PICA REGISTER                         01200002
*        R10 IS THE OLD PICA REGISTER                                   01300002
         USING SCA,R11        SCA ADDRESS                               01400002
*        R12 CONTAINS INPUT TO THE FRR SHOULD AN ABEND OCCUR            01500002
*        R13=CODE17INDICATOR/NEWRBOPSWMASK/NEWTCBPMASK/CALLERPROTECTKEY 01600002
*        R14 AND R15 ARE WORK REGISTERS                                 01700002
         LA    R9,0(R1)       SAVE THE NEW PICA ADDRESS                 01800002
         B     SPID           GO AROUND ID                              01900002
         DC    CL8'IGC0001D'  SPIE'S I.D.                               02000002
SPID     EQU   *              BEGIN HERE                                02100002
         LA    R15,SPFRR      FRR E.P. ADDRESS                          02200002
         SETFRR A,FRRAD=(R15),WRKREGS=(R1,R2) SETUP FRR                 02300002
TEST1    EQU   *                                                        02400002
         EJECT                                                          02430002
*        SPIE MAIN PROCESSING STARTS HERE                               02460002
         NI    TCBFLGS6,XFF-TCBPIE17 RESET TCBPIE17 BIT                 02500002
         SR    R10,R10        INIT OLD PICA ADDRESS TO ZERO             02600002
         L     R5,RBLINK-RBSECT(R5)  GET SPIES CALLERS' RB              02700002
         SR    R13,R13        INITIALIZE TO ZERO (VERY IMPORTANT)       02800002
         IC    R13,RBOPSWKY-RBSECT(R5) OBTAIN USERS PROTECT KEY         02900002
         N     R13,FFFFFFF0   ZERO NON KEY BITS.                        03000002
*        CALLER MUST BE PROBLEM STATE AND HAVE A KEY MATCHING           03100002
*        THE TCBPKF (PROTECTION KEY) FIELD                              03200002
         CLM   R13,M0001,TCBPKF Q. IS CALLER'S KEY VALID                03300002
         BNE   SPABEND        INVALID CALLER                            03400002
         TM    RBOPSW+AMWP-RBSECT(R5),PBIT Q. IS CALLER PROBLEM STATE   03500002
         BNO   SPABEND        A. NO. ABEND INVALID CALLER.              03600002
         LTR   R9,R9          Q. CANCEL (NEW PICA = 0)                  03700002
         BZ    SPCANCEL       A. YES                                    03800002
         LR    R2,R13         GET USERS KEY FOR KEY SWITCH.             03900002
         MODESET  KEYADDR=(2)  SWITCH TO KEY OF CALLER                  04000002
TEST1A   EQU   *              *                                         04100002
         EJECT                                                          04120002
*        CHECK CANCEL                                                   04140002
*           IF YES, GO TO SPCANCEL                                      04160002
*           IF NO, GO TO SPNOCNCL                                       04180002
         L     R12,SP10E      Q. BAD PICA.                              04200002
         TM    PICITMK1-PICA(R9),PICAEXT  Q. EXTENDED PICA              04300002
*        A PROGRAM CHECK HERE RESULTS IN A 10E ABEND                    04400002
         BZ    SPNOEXTN       A. NO                                     04500002
         CLC   PICITMK1-PICA(FOUR,R9),HIGHBIT Q. CANCEL                 04600002
*        A PROGRAM CHECK HERE RESULTS IN A 10E ABEND                    04700002
         BE    SPCANCEL       A. YES.                                   04800002
SPNOEXTN EQU   *              *                                         04900002
         CLC   PICITMK1-PICA(TWO,R9),HZERO Q. CANCEL                    05000002
*        A PROGRAM CHECK HERE RESULTS IN A 10E ABEND.                   05100002
         BNE   SPNOCNCL       A. NO.                                    05200002
         EJECT                                                          05300002
*        THIS IS A REQUEST TO CANCEL                                    05400002
SPCANCEL EQU   *              *                                         05500002
         EJECT                                                          05510002
*        CHECK IF SPIE ENVIRONMENT EXISTS                               05520002
*           IF NO, GO TO SPFINISH                                       05530002
*           IF YES, FREE THE SCA & PIE                                  05540002
*                   RESTORE THE ORIGINAL                                05550002
*                   PSW PROGRAM MASK                                    05560002
*                   ZERO THE TCBPIE                                     05570002
*                   AND THEN GO TO                                      05580002
*                   SPFINISH                                            05590002
         MODESET EXTKEY=SUPR  SWITCH INTO KEY 0.                        05600002
TEST1B   EQU   *              *                                         05700002
         SR    R12,R12        RESET ABEND CODE REG.                     05800002
         ICM   R13,M0100,TCBPMASK  USER'S ORIG MASK RESTORED.           05900002
         L     R11,TCBPIE     Q. SCA ADDRESS                            06000002
         LA    R11,ZERO(R11)  DITTO                                     06100002
         LTR   R11,R11        DITTO                                     06200002
         BZ    SPFINISH       A. NO.                                    06300002
         SR    R0,R0          CLEAR FOR STORE                           06400002
         ST    R0,TCBPIE      ZERO TCBPIE FIELD.                        06500002
         L     R8,SCARPPTR    GET TOP ACTIVE RPIEPICA         @ZA11839  06510003
         LTR   R8,R8              DOES RPIEPICA EXIST?         @ZA28693 06520003
         BZ    NOFREERP           NO DONT TRY TO FREE IT       @ZA28693 06522003
         BAL   R12,FREERPPS   GO FREE ALL ACTIVE RPIEPICAS    @ZA11839  06524003
NOFREERP DS    0H                 CONTINUE TO FREE SPIE BLOCKS @ZA28693 06526003
         L     R8,SCAFRPPQ      GET TOP FREE RPIEPICA         @ZA11839  06530003
         LTR   R8,R8            Q. ANY FREE RPIEPICAS         @ZA11839  06540003
         BZ    FREESCA          A. NO - GO FREE THE SCA       @ZA11839  06550003
         BAL   R12,FREERPPS     A. YES - GO FREE ACTIVE RPP   @ZA11839  06560003
FREESCA  L     R8,SCAPIE      GET PIE ADDRESS.                          06600003
         SR    R12,R12          RESET ABEND REG               @ZA11839  06620003
         FREEMAIN RU,LV=SCALEN1,A=(R11),SP=245,BRANCH=YES  FREE SCA     06650003
*                                                                       06800003
*        AT THIS TIME REGISTER 10 IS ZERO AS IT SHOULD BE FOR RETURN    06820003
*        TO THE USER. IF A PIE EXISTS THE PIEPICA WILL BE LOADED.       06840003
*                                                                       06860003
         LTR   R8,R8              DOES THE PIE EXIST?          @ZA28693 06880003
         BZ    SPFINISH           CLEANUP AND RETURN           @ZA28693 06900003
TEST1C   EQU   *              *                                         06920003
         LR    R2,R13         GET USER'S KEY                            06940003
         MODESET KEYADDR=(2)   SWITCH TO THAT KEY                       07000002
TEST1X   EQU   *              *                                         07100002
         L     R12,SP20E      CODE FOR BAD PIE                          07200002
         L     R10,PIEPICA    SAVE OLD PICA ADDRESS                     07300002
*        A PROGRAM CHECK HERE RESULTS IN A 20E ABEND                    07400002
         SR    R12,R12        RESET THE ABEND CODE REGISTER             07500002
         MODESET EXTKEY=SUPR   SWITCH TO KEY 0                          07600002
TEST1Y   EQU   *              *                                         07700002
         FREEMAIN RU,LV=PIELEN,A=(R8),SP=250,BRANCH=YES FREE THE PIE    07800002
TEST1D   EQU   *              *                                         07900002
         B     SPFINISH       CLEANUP AND RETURN.                       08000002
         SPACE 3                                                        08001003
FREERPPS EQU   *              ROUTINE TO FREE RPIEPICAS     @ZA11839    08002003
         L     R2,RPIEPICA-RPPNPTR(,R8) GET NEXT RPIEPICA   @ZA11839    08003003
         FREEMAIN RU,LV=RPPLEN,A=(R8),SP=253,BRANCH=YES     @ZA11839    08004003
         LTR   R2,R2          Q. ANY MORE RPIEPICAS         @ZA11839    08005003
         BNZ   LOOP           A. YES - GO GET NEXT          @ZA11839    08006003
         BR    R12            A. NO - RETURN                @ZA11839    08007003
LOOP     LR    R8,R2          GET NEW TOP RPP               @ZA11839    08008003
         B     FREERPPS         GO FREE IT                  @ZA11839    08009003
               EJECT                                                    08010002
*              CHECK FOR INTERRUPT CODE 17                              08020002
*                     IF NO, GO TO SPNO17                               08030002
*                     IF YES, CHECK IF AUTHORIZED                       08040002
*                     IF NOT AUTHORIZED ABEND                           08050002
*                          IF AUTHORIZED DEFER                          08060002
*                          SETTING OF TCBPIE17                          08070002
*                          GO TO SPNO17                                 08080002
SPNOCNCL EQU   *              *                                         08100002
         ICM   R13,M0100,PICAPRMK-PICA(R9)  GET THE NEW PGM MASK        08200002
*        A PROGRAM CHECK HERE RESULTS IN A 10E ABEND.                   08300002
         TM    PICITMK1-PICA(R9),PICAEXT  Q. EXTENDED PICA.             08400002
*        A PROGRAM CHECK HERE RESULTS IN A 10E ABEND.                   08500002
         BZ    SPNO17         A. NO. CAN'T BE CODE 17                   08600002
         TM    PICITMK3,PICACD17   Q. CODE 17 REQUESTED                 08700002
*        A PROGRAM CHECK HERE RESULTS IN A 10E ABEND.                   08800002
         BZ    SPNO17         A. NO.                                    08900002
         SR    R12,R12        RESET ABEND CODE REG.                     09000002
         MODESET EXTKEY=SUPR     SWITCH TO KEY 0.                       09100002
TEST1E   EQU   *              *                                         09200002
         TESTAUTH FCTN=1,KEY=YES,BRANCH=YES  Q.AUTHORIZED FOR CODE 17   09300002
TEST1F   EQU   *                                                        09400002
         LTR   R15,R15        DITTO                                     09500002
         BNZ   SPABEND        A. NO. BOMB INVALID CALLER                09600002
         LR    R2,R13         GET USER'S KEY                            09700002
         MODESET KEYADDR=(2)   SWITCH KEY                               09800002
TEST1G   EQU   *              *                                         09900002
         ICM   R13,M1000,HIGHBIT   SET HIGH BIT ON TO INDICATE CODE 17  10000002
        EJECT                                                           10005002
*       CHECK IF SPIE ENVIRONMENT EXISTS                                10010002
*          IF NO, GETMAIN SCA AND PIE,                                  10015002
*                 SAVE CALLERS MASK                                     10020002
*                 IN TCBPMASK, SET                                      10025002
*                 HIS MASK FROM PICA                                    10030002
*                 MASK AND CHAIN                                        10035002
*                 THE PICA TO PIE,                                      10040002
*                 PIE TO SCA, AND                                       10045002
*                 SCA TO TCB THEN RETURN                                10050002
*                 TO CALLER WITH REG1=0                                 10055002
*          IF YES, SET THE CALLERS                                      10060002
*                 PSW MASK WITH                                         10065002
*                 PICA MASK, SAVE                                       10070002
*                 OLD PICA, CHAIN NEW                                   10075002
*                 PICA TO PIE THEN                                      10080002
*                 RETURN TO CALLER                                      10100002
*                 WITH REG1=PREVIOUS PICA                               10130002
SPNO17   EQU   *              CHECK OUT THE OLD PICA                    10160002
         EJECT                                                          10200002
*        THIS IS A NEW OR NESTED REQUEST                                10300002
         SR    R12,R12        RESET ABEND CODE REG.                     10400002
         L     R11,TCBPIE     OBTAIN SCA ADDRESS                        10500002
         LA    R11,ZERO(R11)  CLEAR THE HIGH BYTE                       10600002
         LTR   R11,R11        Q. DOES A SPIE ENVIRONMENT EXIST          10700002
         BNZ   SCANOGET       A. YES, SCA  ALREADY EXISTS      @ZA06785 10750003
*        THIS IS A NEW REQUEST                                          10900002
         MODESET EXTKEY=SUPR  SWITCH TO KEY 0.                          11000002
TEST1H   EQU   *              *                                         11100002
         GETMAIN RU,LV=PIELEN,SP=250,BRANCH=YES GET A PIE               11200002
TEST2    EQU   *                                                        11300002
         LA    R8,ZERO(R1)    SAVE PIE ADDRESS                          11400002
         GETMAIN RU,LV=SCALEN1,SP=245,BRANCH=YES  GET THE SCA           11500003
TEST3    EQU   *                                                        11600002
         LA    R11,ZERO(R1)   SAVE THE SCA ADDRESS                      11700002
         XC     SCA(SCALEN1),SCA      ZERO THE SCA         @ZA06785     11750003
         SR    R10,R10        INDICATE NO OLD PICA.                     11800002
         LR    R2,R13         GET USER'S KEY                            11900002
         MODESET  KEYADDR=(2)  SWITCH TO THAT KEY                       12000002
TEST3A   EQU   *              *                                         12100002
         B     SPNPICA        CHECK THE NEW PICA.                       12200002
SCANOGET EQU  *               CHECK IF PIE ALREADY EXISTS     @ZA06785  12206003
         L     R8,SCAPIE      OBTAIN PIE ADDRESS              @ZA06785  12212003
         LTR   R8,R8          Q. DOES PIE EXIST               @ZA06785  12218003
         BNZ   SPNOGET        A. YES                          @ZA06785  12224003
TEST23   EQU    *                                             @ZA06785  12230003
       MODESET  EXTKEY=SUPR  GET IN SUPERVISOR STATE         @ZA06785   12236003
         GETMAIN  RU,LV=PIELEN,SP=250,BRANCH=YES  GET A PIE   @ZA06785  12242003
         ST     R1,SCAPIE      SAVE PIE ADDRESS               @ZA06785  12248003
         LR     R8,R1         GET PIE ADDRESSABILITY          @ZA06785  12254003
         L      R12,SP20E     SET ABEND CODE                  @ZA06785  12260003
         XC     PIEPICA(FOUR),PIEPICA  INDICATE NO OLD PICA   @ZA06785  12266003
*      PROGRAM CHECK HERE RESULTS IN 20E ABEND                          12272003
         SR     R12,R12       RESET ABEND REGISTER            @ZA06785  12278003
         LR    R2,R13       GET USER KEY                     @ZA06785   12284003
         MODESET KEYADDR=(2)    RETURN TO USER KEY           @ZA06785   12290003
SPNOGET  EQU   *              NO GETMAIN ON THIS PATH.                  12300002
*        THIS IS A NESTED REQUEST                                       12400002
         L     R8,SCAPIE      SAVE PIE ADDRESS                          12500002
         L     R12,SP20E      Q. BAD PIE                                12600002
         L     R10,PIEPICA    SAVE OLD PICA ADDRESS                     12700002
*        A PROGRAM CHECK HERE RESULTS IN A 20E ABEND.                   12800002
         SR    R12,R12        RESET ABEND CODE REG                      12900002
SPNPICA  EQU   *              CHECK OUT THE NEW PICA.                   13000002
         SR    R12,R12        RESET THE ABEND CODE REGISTER.            13100002
         ICM   R13,M0010,RBOPSWMK-RBSECT(R5)  GET CALLERS CURRENT MASK  13200002
         LTR   R10,R10        Q. IS THERE AN OLD PICA                   13300002
         BZ    SPNOOLD        A. NO. TH RB MASK WILL GO TO TCBPMASK     13400002
         ICM   R13,M0010,TCBPMASK   TCBPMASK WILL REMAIN THE SAME.      13500002
SPNOOLD  EQU   *              UPDATE THE PIE                            13600002
         L     R12,SP20E      PREPARE FOR BAD PIE.                      13700002
         XC    PIE(PIELEN),PIE   ZERO THE PIE                           13800002
         ST    R9,PIEPICA     NEW PICA ADDRESS TO PIE(MAY BE 0)         13900002
         SR    R12,R12        RESET ABEND REGISTER.                     14000002
         MODESET  EXTKEY=SUPR   SWITCH BACK TO KEY 0.                   14100002
TEST6    EQU   *                                                        14200002
         ST    R8,SCAPIE      CHAIN THE PIE                             14400002
         LA    R1,SPIERMTR    GET ADDRESS OF RMTR              @YM03222 14420002
         LA    R2,SCASRB      GET ADDRESS OF SRB               @YM03222 14440002
         USING SRBSECT,R2     SRB ADDRESSABILITY                        14460002
         ST    R1,SRBRMTR     SET RMTR ADDRESS IN SRB          @YM03222 14480002
         ST    R11,TCBPIE     CHAIN THE SCA TO THE TCB                  14500002
         BAL   R14,PROCRPP       GO PROCESS RPIEPICA           @ZA06785 14550003
         LTR   R13,R13        Q. CODE 17 REQUESTED.                     14600002
         BNM   SPFINISH       A. NO CONTINUE.                           14700002
         OI    TCBFLGS6,TCBPIE17  TELL PROG CHECK FLIH ABOUT 17         14800002
SPFINISH EQU   *              CLEAN UP AND RETURN                       14900002
         N     R13,FF0F0FFF   CLEANSE MASKS IN REG 13                   15000002
         STCM  R13,M0010,TCBPMASK  TCBPMASK=TCBPMASK OR RBOPSWMK OR 0   15100002
         ICM   R1,M0100,RBOPSWMK-RBSECT(R5)  GET THE MASK BYTE          15200002
         N     R1,FFF0FFFF    ZERO THE MASK, SAVE THE REST              15300002
         OR    R1,R13         MERGE REST WITH NEW MASK                  15400002
         STCM  R1,M0100,RBOPSWMK-RBSECT(R5)  UPDATE WITH NEW MASK       15500002
         SETFRR  D,WRKREGS=(R1,R2)  DELETE FRR ENVIRONMENT              15600002
TEST7    EQU   *                                                        15700002
         LR    R1,R10         SETUP REGISTER ONE                        15800002
         L     R14,CVTPTR     GET CVT ADDRESS                           15900002
TEST8    EQU   *                                                        16000002
         L     R14,CVTEXPRO-CVT(R14)  GET EXIT ADDRESS                  16100002
         BR    R14            RETURN                                    16200002
         SPACE 3                                                        16230002
*        ABEND WITH '30E' CODE                                          16260002
SPABEND  EQU   *              DITTO                                     16300002
         MODESET  EXTKEY=SUPR   SWITCH BACK TO KEY 0.          @YM03566 16320002
         SETFRR D,WRKREGS=(R1,R2)  DELETE FRR                  @YM03566 16350002
         L     R1,SP30E       CANNOT USE SPIE OR SPIE W/CODE 17         16400002
         ABEND (1),DUMP,,SYSTEM  ABEND THE CALLER.                      16500002
TEST9    EQU   *                                                        16600002
         EJECT                                                          16630002
*        SPIE FRR                                                       16660002
         SPACE 3                                                        16700002
SPFRR    EQU   *              DITTO                                     16800002
         USING SDWA,R1        R1 INPUT FROM RTM                         16900002
         BALR  R6,ZERO        TEMPORARY BASE                            17000002
         USING *,R6           DITTO                                     17100002
         L     R6,BASE        GET THE BASE FOR THIS MODULE              17200002
         USING IGC0001D,R6    DITTO                                     17300002
         L     R0,SDWAABCC    GET CURRENT ABEND CODE.                   17400002
         TM    SDWAFLGS,SDWAPCHK  WAS IT A PROGRAM CHECK                17500002
         BZ    SPSETRP        NO. CONTINUE WITH TERMINATION             17600002
         LA    R2,SPTABLE-FOUR   SEARCH THROUGH TABLE FOR ABEND CODE.   17700002
         LA    R3,SPSTOP      GET THE STOPPER ADDRESS.                  17800002
SPLOOP   EQU   *              LOOP THRU ABEND CODE LIST.                17900002
         LA    R2,FOUR(R2)    POINT TO CURRENT WORD IN LIST             18000002
         CR    R2,R3          Q. IS THIS THE END.                       18100002
         BE    SPSETRP        A. YES. CONTINUE WITH THE SAME ABEND CODE 18200002
         CLC   SDWAGR12(FOUR),ZERO(R2)  Q. DID MAINLINE PASS A CODE.    18300002
         BNE   SPLOOP         LOOP UNTIL MATCH OR END OF LIST.          18400002
         L     R0,ZERO(R2)    MATCH. ABEND WITH THIS CODE.              18500002
         ST    R0,SDWAABCC    SET CODE                                  18700002
         SETRP RC=0,RECORD=NO                                  @YM03566 18720002
         SR    R15,R15        CLEAR                            @YM03566 18740002
         BR    R14            RETURN                           @YM03566 18760002
SPSETRP  EQU   *              SET CODE AND RETURN TO RTM                18780002
         SETRP  RC=0          RETURN TO CONTINUE W/TERMINATION          18800002
         SR     R15,R15       RETURN CODE OF 0                          18900002
         BR     R14           RETURN                                    19000002
TEST10   EQU    *                                                       19100002
         EJECT                                                          19130002
*                  CHECK IF RB ALREADY HAS RPIEPICA           @ZA06785  19130303
*              IF SO CHECH IF IT IS A SPIE RESTORE            @ZA06785  19130603
*                  IF SO DEQUEUE RPP AND PUT ON FREE QUEUE    @ZA06785  19130903
*                  IF NOT COPY CONTROL BLOCK PTRS AND RETURN  @ZA06785  19131203
*              IF NOT CHECK IF FREE RPIEPICA IS AVAILABLE     @ZA06785  19131503
*                  IF SO DEQUEUE FIRST FREE RPIEPICA, QUEUE   @ZA06785  19131803
*                     TO ACTIVE CHAIN, COPY CONTROL BLOCK     @ZA06785  19132103
*                     POINTERS AND RETURN TO CALLER           @ZA06785  19132403
*              IF NOT GETMAIN NEW RPIEPICA, QUEUE TO ACTIVE   @ZA06785  19132703
*                    QUEUE, COPY CONTROL BLOCK POINTERS AND   @ZA06785  19133003
*                     AND RETURN                              @ZA06785  19133303
*                                                                       19133603
*       INPUT: R5= ISSUING RB ADDRESS                         @ZA06785  19133903
*              R9= PICA ADDRESS OR ZERO IF CANCEL REQUEST     @ZA06785  19134203
*              R11= SCA ADDRESS                               @ZA06785  19134503
*                                                                       19134803
PROCRPP EQU  *                    RECOVERY PIC/PICA PROCESSING @ZA06785 19135103
        USING  RPIEPICA,R3                                   @ZA06785   19135403
        LR    R12,R14             SAVE RETURN ADDRESS         @ZA06785  19135703
        SR    R0,R0               ZERO WORK REGISTER          @ZA06785  19136003
        L    R3,SCARPPTR          GET TOP RPIEPICA ADDRESS    @ZA06785  19136303
        LTR  R3,R3                Q. ANY RPIEPICA             @ZA06785  19136603
        BZ   CHKFREE              A. NO                       @ZA06785  19136903
        L    R8,SCAPIE            GET PIE ADDRESS             @ZA06785  19137203
        L    R2,RPPNPTR           GET ADDRESS OF LAST RPP     @ZA06785  19137503
        C    R5,RPPPRB            Q. ISSUING RB HAVE RPP      @ZA06785  19137803
        BE    RSETSPIE            A. YES                      @ZA06785  19140003
CHKFREE C     R0,SCAFRPPQ         Q.IS A FREE RPP AVAILABLE   @ZA06785  19140403
        BNE   GETFREE             A. YES                      @ZA06785  19140803
        LR    R2,R3             SAVE R3 ACROSS GETMAIN      @ZA06785    19141203
        GETMAIN RU,LV=RPPLEN,SP=253,BRANCH=YES    GET RPP     @ZA06785  19141603
        LA    R15,ZERO(R1)        SAVE NEW RPIEPICA ADDRESS   @ZA06785  19142003
        LR    R3,R2              RESTORE REGISTER 3           @ZA06785  19142403
QUENEW  EQU   *                   CHAIN NEW RPP TO SCA        @ZA06785  19142803
        ST    R3,RPPNPTR-RPIEPICA(R15) UPDATE RPP NEXT FIELD   @ZA06785 19143203
        ST    R15,SCARPPTR        UPDATE RPP PTR IN SCA       @ZA06785  19143603
COPYBLK EQU   *                   COPY SPIE CONTROL BLOCKS    @ZA06785  19144003
        L     R3,SCARPPTR            GET RPIEPICA             @ZA06785  19144403
        ST    R5,RPPPRB              SAVE ISSUING RB ADDRESS   @ZA06785 19144803
        MVC   RPPPIE(L4),SCAPIE      SAVE PIE ADDRESS         @ZA06785  19145203
        MVC   RPPPICA(L4),PIEPICA    SAVE PICA ADDRESS        @ZA06785  19145603
XIT     LR    R14,R12               RESET RETURN REGISTER     @ZA06785  19146003
        BR    R14                    RETURN TO CALLER         @ZA06785  19146403
        SPACE 2                                                         19146803
RSETSPIE EQU   *                   CHECK FOR SPIE RESTORE     @ZA06785  19147203
        CR     R2,R0                PREVIOUS RPP EXIST?       @ZA06785  19147603
        BE     COPYBLK              NO PREVIOUS RPP           @ZA06785  19148003
        LR     R1,R12               SAVE RET ADDR             @ZA20162  19148103
        L      R12,SP10E            GET ABEND CODE FOR FRR    @ZA20162  19148203
        LR     R3,R2                SAVE REG2 ACROSS MODESET  @ZA20162  19148303
        LR     R2,R13               GET USER KEY              @ZA20162  19148403
        MODESET KEYADDR=(2)         SWITCH TO USER KEY        @ZA20162  19148703
        LR     R2,R3                RESTORE REG2              @ZA20162  19148803
* A PROGRAM CHECK WHILE REFERENCING THE PICA WILL RESULT IN   @ZA20162  19148903
* A 10E ABEND ISSUED FROM THE FRR                             @ZA20162  19149003
        L      R3,PIEPICA          GET  CURRENT PICA ADDRESS  @ZA06785  19149403
        L      R3,PICAEXIT-PICA(,R3) GET CURRENT EXIT ADDR    @ZA06785  19149503
        LA     R3,ZERO(,R3)        CLEAR HIGH ORDER BYTE      @ZA06785  19149603
        L      R2,RPPPICA-RPIEPICA(,R2)  GET PREVIOUS PICA    @ZA06785  19149803
        L      R2,PICAEXIT-PICA(,R2) GET PREVIOUS EXIT RTN    @ZA06785  19150303
        LA     R2,ZERO(,R2)         CLEAR HIGH ORDER BYTE     @ZA06785  19150403
        LR     R12,R1              RESTORE RETURN ADDRESS     @ZA20162  19150703
        MODESET EXTKEY=SUPR        RETURN TO SUPERVISOR KEY   @ZA20162  19150803
        CR     R3,R2               Q. PICA EXIT SAME AS LAST  @ZA06785  19150903
        BNE    COPYBLK             A. NO                      @ZA06785  19151203
        L      R3,SCARPPTR         GET RPIEPICA POINTER       @ZA06785  19151403
        MVC    SCARPPTR(L4),RPPNPTR     REMOVE RPP FROM QUE   @ZA06785  19152003
        MVC    RPPNPTR(L4),SCAFRPPQ     CHAIN TO FREE QUEUE   @ZA06785  19152403
        ST     R3,SCAFRPPQ         UPDATE FREE QUEUE HEADER   @ZA06785  19152803
        B      XIT               RETURN TO CALLER             @ZA06785  19153203
        SPACE  2                                                        19153603
GETFREE EQU    *                 GET A FREE RPIEPICA          @ZA06785  19154003
        L      R15,SCAFRPPQ      GET RPP FROM FREE QUEUE      @ZA06785  19154403
        L      R2,RPPNPTR-RPIEPICA(R15)  GET NEXT RPP POINTER @ZA06785  19154803
        ST     R2,SCAFRPPQ           UPDATE FREE QUE PTR      @ZA06785  19154903
        B      QUENEW            QUEUE THIS RPP TO ACTIVE QUE @ZA06785  19155603
       EJECT                                                            19156003
*                                                                       19156403
*        SPIE RESOURCE MANAGER                                          19160002
*                                                                       19166002
*        THE SPIE RESOURCE MANAGER IS ENTERED ON TERMINATION.           19172002
*        IF MEMORY TERMINATION, CONTROL IS RETURNED. IF TASK            19178002
*        TERMINATEION, THE SCA IS FREEMAINED IF THERE IS ONE.           19184002
*                                                                       19190002
         SPACE 3                                                        19200002
IEAVSPIE EQU   *              SPIE RESOURCE MANAGER                     19300002
         STM   R14,R12,TWELVE(R13)  SAVE RTM'S REGISTERS.               19400002
         BALR  R6,R0          TEMPORARY BASE REGISTER                   19500002
         USING *,R6           DITTO                                     19600002
         L     R6,BASE        PERMANENT BASE REG                        19700002
         USING IGC0001D,R6    DITTO                                     19800002
         USING RMPL,R9        PARM LIST REGISTER                        19900002
*        R7                   ASCB REGISTER                             20000002
*        R4                   TCB REGISTER                              20100002
*        R11                  SCA REGISTER                              20200002
*        R0 THRU R3           WORK REGISTERS                            20300002
*        R13                  RTM 72 BYTE SAVE AREA (DO NOT DISTURB)    20400002
*        R5,R8,R10,R12        NOT USED                                  20500002
*        R14                  RETURN REG                                20600002
*        R15                  RETURN CODE REG                           20700002
         L     R9,ZERO(R1)    GET THE USELESS WORD                      20800002
         TM    RMPLFLG1,RMPLTERM  Q. MEMORY TERMINATION                 20900002
         BO    SPRETURN       A. YES. DO NOTHING.                       21000002
         TM    RMPLFLG1,RMPLRBPP     Q. RB TERMINATING        @ZA06785  21020003
         BO    RBTERM      A.YES GO UPDATE SPIE ENVIRONMENT   @ZA06785  21040003
TASKTERM L     R7,RMPLASCB    NEED ASCB FOR FREEMAIN                    21060003
         L     R4,RMPLTCBA    NEED TCB FOR SCA ADDRESS                  21200002
         L     R11,TCBPIE-TCB(R4)  GET THE SCA ADDRESS.                 21300002
         LA    R11,ZERO(R11)  CLEAR HIGH BYTE                           21400002
         LTR   R11,R11        Q. IS THERE AN SCA                        21500002
         BZ    SPRETURN       A. NO. NOTHING TO FREE                    21600002
         NI    TCBFLGS6-TCB(R4),XFF-TCBPIE17  RESET THE SPIE 17 BIT     21700002
*        PURGEDQ DEFAULTS TO CURRENT ADDRESS SPACE,                     21720002
*        CURRENT TCB AND THE RMTR IS SPIE'S                             21740002
         LA    R1,PURGLIST    GET ADDRESS OF PURGE PARAMETERS  @ZA29414 21760003
         PURGEDQ MF=(E,(1))   EXECUTE PURGEDQ SVC              @ZA29414 21770003
         SR    R0,R0          CLEANSE THE TCBPIE FIELD.                 21800002
         ST    R0,TCBPIE-TCB(R4)  DITTO                                 21900002
         FREEMAIN  RU,LV=SCALEN1,A=(R11),SP=245  FREE THE SCA           21950003
TEST11   EQU   *                                                        22100002
SPRETURN EQU   *              RETURN                                    22200002
         LM    R14,R12,TWELVE(R13)  LOAD REGS                           22300002
         SR    R15,R15        RETURN CODE OF 0                          22400002
*        THE FOLLOWING BR 14 IS USED AS THE ADDRESS                     22420002
*        OF THE SPIE SRB RMTR.  NO ACTION IS NECESSARY FOR THE          22440002
*        RMTR TO PERFORM.                                               22460002
SPIERMTR BR    R14            EXIT                                      22500002
        SPACE   3                                                       22505003
RBTERM   EQU   *              PROCESS RPP FOR TERMINATING RB  @ZA06785  22510003
         L     R5,RMPLRBPA    GET TERMINATING RB ADDRESS      @ZA06785  22515003
         L     R4,RMPLTCBA    GET ASSOCIATED TCB ADDRESS      @ZA06785  22520003
         L     R11,TCBPIE-TCB(R4)  GET SCA ADDRESS            @ZA06785  22525003
         LA    R11,ZERO(R11)       CLEAR HIGH BYTE            @ZA06785  22526003
         LTR   R11,R11             Q. SCA EXIST               @ZA06785  22527003
         BZ    SPRETURN            A. NO                      @ZA06785  22528003
         L     R3,SCARPPTR    GET RPIEPICA ADDRESS            @ZA06785  22530003
         C     R5,RPPPRB       Q. IS THERE AN RPP FOR RB      @ZA06785  22535003
         BNE   SPRETURN        A. NO - RETURN TO CALLER       @ZA06785  22540003
         MVC   SCARPPTR(L4),RPPNPTR     REMOVE RPP FROM QUE   @ZA06785  22545003
         MVC   RPPNPTR(L4),SCAFRPPQ     PUT RPP ON FREE QUE   @ZA06785  22550003
         ST    R3,SCAFRPPQ           UPDATE FREE RPP HEADER   @ZA06785  22555003
         L     R3,SCARPPTR           GET NEW TOP RPIEPICA     @ZA06785  22560003
         LTR   R3,R3                 IS NEXT RPIEPICA ZERO    @ZA28693  22565003
         BNZ   CURSPENV              NO PROCESS CURRENT SPIE  @ZA28693  22565603
         L     R1,SCAPIE             GET PIE ADDRESS TO FREE  @ZA28693  22566203
         ST    R3,SCAPIE             ZERO THE PIE ADDRESS     @ZA28693  22566803
         FREEMAIN RU,LV=PIELEN,A=(R1),SP=250 SVC FREEMAIN      @ZA31066 22567403
         B     SPRETURN              PROCESSING COMPLETE      @ZA28693  22568003
CURSPENV MVC   SCAPIE(L4),RPPPIE      GET CURRENT SPIE ENVIRN @ZA28693  22568603
         L     R8,SCAPIE              GET PIE ADDRESS         @ZA06785  22570003
         MODESET  EXTKEY=TCB,WORKREG=2      SET TO USER KEY @ZA12729    22572003
         MVC   PIEPICA(L4),RPPPICA    COPY PICA ADDRESS       @ZA06785  22575003
         MODESET  EXTKEY=SUPR         BACK TO KEY ZERO        @ZA12729  22577003
         B     SPRETURN          RETURN TO CALLER             @ZA06785  22580003
           SPACE 3                                                      22585003
           EJECT                                                        22600003
*        CHECKPOINT/RESTART  SUBROUTINE                                 22630003
*        FOR A CHECKPOINT, THE SCA WILL BE SAVED IN THE SSCR   @ZA12729 22703003
*        (SUBSYSTEM CHECKPOINT RECORD) ALONG WITH THE TCBPMASK @ZA12729 22704003
*        AND TCBPIE17. THE ACTIVE QUEUE OF RPIEPICAS WILL BE   @ZA12729 22705003
*        SAVED IN THE SSCR AFTER DETERMINING ITS ASSOCIATED    @ZA12729 22706003
*        RB'S POSITION ON THE RB QUEUE. THE RELATIVE POSITION  @ZA12729 22707003
*        ON THE RB QUEUE WILL BE SAVED IN THE RPPPRB FIELD OF  @ZA12729 22708003
*        THE RPIEPICA FOR LATER USE BY RESTART. IF A RPIEPICA  @ZA12729 22709003
*        EXISTS WITH NO CORRESPONDING RB ON THE RB QUEUE, THE  @ZA12729 22710003
*        RPIEPICA CHAIN THAT IS IN THE SSCR WILL END WITH THAT @ZA12729 22711003
*        RPIEPICA. THE RPPNPTR AND RPPPRB FIELDS OF THAT       @ZA12729 22712003
*        RPIEPICA WILL BE ZEROED IN THE SSCR SO THAT RESTART   @ZA12729 22713003
*        WILL NOT TRY TO RESTORE RPIEPICAS BEYOND THAT POINT.  @ZA12729 22714003
*        THE TOTAL SSCR AREA USED TO SAVE THE RPIEPICA QUEUE   @ZA12729 22715003
*        WILL BE RECORDED IN THE SSCR (DATARPPL) ALONG WITH    @ZA12729 22716003
*        THE TOTAL AREA USED TO SAVE BOTH SCA & THE RPIEPICA   @ZA12729 22717003
*        QUEUE(SSCRDATL).                                      @ZA12729 22718003
*                                                              @ZA12729 22719003
*        ON A RESTART, A NEW SCA WILL BE GETMAINED AN RE-      @ZA12729 22720003
*        ESTABLISHED USING THE DATA IN THE SSCR. THE SCAFRPPQ  @ZA12729 22721003
*        FIELD WILL BE ZEROED. STORAGE WILL BE GETMAINED TO    @ZA12729 22730003
*        RE-ESTABLISH THE RPIEPICA QUEUE. THE RB POINTERS IN   @ZA12729 22740003
*        THE RPIEPICAS WILL BE SET BASED ON THE INDEX VALUES   @ZA12729 22750003
*        SAVED AT CHECKPOINT.                                  @ZA12729 22760003
*********************************************************************** 22763003
         SPACE 2                                                        22766003
IEAVSPI  EQU   *              SPECIAL ENTRY FORM CHECKPT/RESTART        22770003
         STM   R14,R12,TWELVE(R13)  SAVE REGS                           22800003
         BALR  R6,ZERO        TEMPORARY ADDRESSABILITY                  22830003
         USING *,R6           DITTO                                     22900003
         L     R6,BASE        TRUE BASE                                 22930003
*        R0-R2                ARE WORK REGISTERS                        22960003
         USING TCB,R4         TCB ADDRESSABILITY                        23030003
*        R5                   WORK REG                                  23060003
         USING   IGC0001D,R6  BASE FOR THIS MODULE                      23130003
*        R7                   RB ADDRESSABILITY                         23160003
*        R8                   WORK REG                                  23230003
         USING SSCR,R9        CHECKPT/RESTART 4K TABLE/BUFFER           23300003
         USING DATA,R10       SSCRDATA MAP                              23330003
         USING SCA,R11        SPIE CONTROL AREA ADDRESSABILITY          23400003
         USING RPIEPICA,R3    RECOVERY PIE PICA ADDRESSABILITY @ZA12729 23407003
         USING RBSECT,R7      RB ADDRESSABILITY              @ZA12729   23414003
*        R12                  WORK REG                                  23421003
*        R13                  CHECKPOINT/RESTART 72 BYTE SAVE AREA      23500003
*        R14                  RETURN ADDRESS REG                        23530003
*        R15                  RETURN CODE REGISTER                      23600003
         LR    R9,R1          SAVE THE SSCR ADDRESS                     23630003
         LH    R10,SSCRHDRL   GET OFFSET TO THE DATA AREA               23700003
         ALR   R10,R9         OBTAIN ADDRESS OF THE DATA AREA           23730003
         L     R4,PSATOLD     GET THE CURRENT TCB ADDRESS               23800003
TEST12   EQU   *                                                        23830003
         TM    SSCRFLG1,SSCRCKRS   1=CHECKPT 0=RESTART                  23900003
         BZ    SPRSTRT        GO TO RESTART                             23930003
*                             IT'S A CHECKPOINT                         24000003
         SR    R0,R0          CLEAR FOR STORE                           24030003
         STH   R0,SSCRDATL    SET DATA LENGTH TO ZERO                   24100003
         L     R11,TCBPIE     GET THE SCA POINTER                       24130003
         LA    R11,ZERO(R11)  CLEAR THE TCBPMASK                        24200003
         LTR   R11,R11        Q. IS THERE AN SCA                        24230003
         BZ    SPDONE         A. NO. RETURN                             24300003
         MVC   DATAFLG6(ONE),TCBFLGS6   SAVE THE TCBPIE17 BIT           24330003
         NI    DATAFLG6,TCBPIE17   TURN OFF ALL BUT PIE17 BIT           24400003
         MVC   DATAPMSK(ONE),TCBPMASK  SAVE THE PROG MASK               24430003
         MVC   DATASCA(SCALEN1),SCA  PUT SCA INTO DATA AREA             24500003
         LA    R12,RPPLEN     INITIALIZE LENGTH ACCUM.      @ZA12729    24501003
         LA    R2,ONE         INITIALIZE INDEX VALUE        @ZA12729    24502003
         L     R3,SCARPPTR    GET TOP RPIEPICA              @ZA12729    24503003
         L     R5,RPPPRB      GET RB POINTER FROM RPP       @ZA12729    24504003
         L     R7,TCBRBP      GET TOP RB POINTER            @ZA12729    24505003
LOOPRB   CR    R5,R7          Q. RB POINTERS MATCH          @ZA12729    24506003
         BE    EQUAL          A. YES                        @ZA12729    24507003
         TM    RBSTAB2,RBTCBNXT   Q.RB POINT TO TCB         @ZA12729    24507303
         BO    RBQEND             A. YES                    @ZA12729    24507603
         LA    R2,ONE(,R2)    INCREMENT INDEX VALUE         @ZA12729    24508003
         L     R7,RBLINK-RBSECT(,R7)   GET NEXT RB POINTER  @ZA12729    24509003
         LA    R7,ZERO(,R7)   CLEAR HIGH BYTE               @ZA12729    24509303
         B     LOOPRB         GO CHECK FOR MATCH            @ZA12729    24510003
EQUAL    MVC   DATARPP(RPPLEN),RPIEPICA SAVE RPIEPICA       @ZA12729    24512003
         LA    R8,DATARPP-DATA(,R10)    GET DATARPP ADDRESS   @ZA12729  24512203
         ST    R2,RPPPRB-RPIEPICA(,R8)   SAVE INDEX IN RPPPRB  @ZA12729 24512403
         L     R3,RPPNPTR     GET NEXT RPIEPICA             @ZA12729    24513003
         LTR   R3,R3          Q. ANY MORE RPIEPICAS         @ZA12729    24514003
         BZ    SAVELEN        A. NO                         @ZA12729    24515003
         LA    R12,RPPLEN(,R12) INCREMENT LENGTH            @ZA12729    24516003
         LA    R10,RPPLEN(,R10) INDEX TO NEXT DATARRP       @ZA12729    24517003
         L     R5,RPPPRB      GET RB POINTER FROM RPP       @ZA12729    24518003
         L     R7,RBLINK-RBSECT(,R7)   GET NEXT RB POINTER  @ZA12729    24519003
         LA    R7,ZERO(,R7)   CLEAR HIGH BYTE               @ZA12729    24519303
         LA    R2,ONE(,R2)    INCREMENT INDEX VALUE         @ZA12729    24520003
         B     LOOPRB         GO CHECK FOR A MATCH          @ZA12729    24521003
RBQEND   EQU   *                                           @ZA12729     24521103
         MVC   DATARPP(RPPLEN),RPIEPICA  SAVE RPP IN DATA AREA @ZA12729 24521203
         LA    R8,DATARPP-DATA(,R10)   GET LAST DATA RPP ADDR @ZA12729  24521303
         ST    R0,RPPNPTR-RPIEPICA(,R8)    ZERO CHAIN FIELD   @ZA12729  24521403
         ST    R0,RPPPRB-RPIEPICA(,R8)     ZERO RB POINTER    @ZA12729  24521503
SAVELEN  LA    R0,ONE+ONE+SCALEN1 GET SCA LENGTH USED       @ZA12729    24522003
         AR    R0,R12         GET TOTAL LENGTH SCA + RPP    @ZA12729    24523003
         STH   R0,SSCRDATL        DITTO                                 24600003
         LA    R10,SSCRDATA-SSCR(,R9) DATA AREA ADDRESS     @ZA12729    24605003
         ST    R12,DATARPPL       SAVE LENGTH RPP DATA AREA @ZA12729    24610003
         B     SPDONE         CHECKPT ACCOMPLISHED                      24630003
         EJECT                                                          24640003
*                             IT'S A RESTART                            24700003
SPRSTRT  EQU   *              DITTO                                     24730003
         GETMAIN  RU,LV=SCALEN1,SP=245  GET A NEW SCA                   24760003
TEST13   EQU   *                                                        24830003
         LR    R11,R1         SAVE THE SCA                              24900003
         MVC   SCA(SCALEN1),DATASCA  RESTORE THE OLD SCA                24930003
         STCM  R11,M0111,TCBPIE+ONE  RECHAIN                            25000003
         MVC   TCBPMASK(ONE),DATAPMSK  RESTORE THE PROGRAM MASK         25030003
         NI    DATAFLG6,TCBPIE17  ZERO ALL BUT PIE 17                   25100003
         OC    TCBFLGS6(ONE),DATAFLG6  RESTORE TCBPIE17 BIT             25130003
         SLR   R0,R0                ZERO REG FOR STORE      @ZA12729    25130603
         ST    R0,SCAFRPPQ          CLEAR FREE QUEUE PTR    @ZA12729    25131203
         L     R2,DATARPPL    GET RPP DATA AREA LENGTH      @ZA12729    25132003
GETNEW   GETMAIN RU,LV=(R2),SP=253  GET NEW RPIEPICA       @ZA12729     25134003
         LR    R3,R1          SAVE ADDRESS                 @ZA12729     25136003
         ST    R3,SCARPPTR        SAVE NEW RPIEPICA HEADER  @ZA12729    25138003
         LA    R12,ONE            INITIALIZE INDEX VALUE    @ZA12729    25140003
         L     R7,TCBRBP          GET TOP RB ON QUEUE       @ZA12729    25142003
MOVERPP  MVC   RPIEPICA(RPPLEN),DATARPP RESTORE RPP FROM DATA  @ZA12729 25144003
         L     R5,RPPPRB          GET INDEX VALUE FROM RPP  @ZA12729    25146003
         C     R5,ZEROS           Q. INDEX VALUE ZERO       @ZA12729    25146603
         BE    SPDONE             A. YES                    @ZA12729    25147203
LOOPI    CR    R5,R12             Q. INDEX VALUES MATCH     @ZA12729    25148003
         BE    EQUALI             A. YES                    @ZA12729    25150003
         L     R7,RBLINK-RBSECT(,R7)     GET NEXT RB       @ZA12729     25152003
         LA    R7,ZERO(,R7)       CLEAR HIGH BYTE           @ZA12729    25152603
         LA    R12,ONE(,R12)      INCREMENT INDEX VALUE     @ZA12729    25154003
         B     LOOPI              GO CHECK FOR INDEX MATCH  @ZA12729    25156003
EQUALI   ST    R7,RPPPRB          SAVE NEW RBPTR            @ZA12729    25158003
         L     R2,RPPNPTR         GET NEXT RPP              @ZA12729    25160003
         LTR   R2,R2              Q. ANY MORE RPIEPICAS     @ZA12729    25162003
         BZ    SPDONE             A. NO - FINISHED          @ZA12729    25164003
         LA    R10,RPPLEN(,R10)   GET NEXT DATA AREA RPP    @ZA12729    25166003
         LA    R2,RPPLEN(,R3)     GET LENGTH OF RPIEPICA    @ZA12729    25170003
         ST    R2,RPPNPTR         CHAIN RPIEPICA            @ZA12729    25174003
         LR    R3,R2              GET NEXT NEW AREA RPP ADDR @ZA12729   25176003
         L     R7,RBLINK-RBSECT(,R7) GET NEXT RB ON QUEUE   @ZA12729    25178003
         LA    R7,ZERO(,R7)       CLEAR HIGH BYTE           @ZA12729    25178603
         LA    R12,ONE(,R12)      INCREMENT INDEX VALUE     @ZA12729    25180003
         B     MOVERPP            GO RESTORE RPIEPICA       @ZA12729    25182003
*                             RESTART ACCOMPLISHED                      25200003
SPDONE   EQU   *              RETURN                                    25230003
         LM    R14,R12,TWELVE(R13)  RESTORE REGISTERS.                  25300003
         SR    R15,R15        RETURN CODE OF 0.                         25330003
         BR    R14            RETURN                                    25400003
         TITLE 'IEAVTB00...IGC00040...EXTRACT  PROCESSING'              25430003
*                                                                       25500003
*        EXTRACT SERVICE ROUTINE                                        25530003
*        PROVIDES A MEANS TO GET TO ADDRESSES ETC.                      25600003
*        WITHOUT CHASING VARIOUS SYTEM QUEUES.                          28080002
*                                                                       28090002
IGC00040 DS    0D             SVC ENTRY TO EXTRACT                      28100002
         USING *,R6           TEMPORARY BASE REG                        28200002
         L     R6,BASE        SETUP EXTRACT'S PERMANENT BASE REG        28300002
         USING IGC0001D,R6    OBTAIN ADDRESSABILITY                     28400002
         B     EXSVC          GO TO SVC CODE                            28500002
*        R0 THRU R3           ARE WORK REGISTERS                        28600002
         USING TCB,R4         TCB REGISTER                              28700002
         USING RBSECT,R5      RB REGISTER                               28800002
*        R6                   IS THE BASE REGISTER ADDTESS              28900002
         USING ASCB,R7        ASCB REGISTER                             29000002
         USING ANSLIST,R8     ANSWER LIST REGISTER                      29100002
*        R9                   IS THE EXTRACT LIST'S TCB ADDR            29200002
*        R10                  IS THE EXTRACT LIST'S BIT MAP             29300002
*        R11                  IS NOT USED BY EXTRACT                    29400002
*        R12 CONTAINS INPUT TO THE FRR SHOULD AN ABEND OCCUR5           29500002
*        R13                  CONTAINS THE USER PROTECT KEY             29600002
*        R14                  IS THE RETURN ADDRESS (DON'T CLOBBER)     29700002
*        R15                  IS A WORK REGISTER                        29800002
*                                                                       29850002
         ORG   IGC00040+8     BRANCH E.P. IS SVC E.P. PLUS 8            29900002
*                                                                       29920002
*        BRANCH ENTRY POINT FOR EXTRACT                                 29940002
         SPACE 3                                                        29960002
IEAVEXTR EQU   *              EXTRACT BRANCH E.P.                       30000002
         SPACE 3                                                        30050002
         BALR  R6,R0          TEMPORARY BASE REGISTER                   30100002
         USING *,R6           DITTO                                     30200002
         L     R6,BASE        SETUP EXTRACT'S BASE REGISTER             30300002
         USING IGC0001D,R6    PERMANENT BASE FOR EXTRACT.               30400002
         SR    R13,R13        SET CALLER'S KEY TO KEY 0.                30500002
         B     EXCOMMON       GO TO COMMON CODE FOR BRANCH AND SVC      30600002
         DC    CL8'IGC00040'  EXTRACT'S I.D.                            30700002
EXSVC    EQU   *              SVC ENTRY SETUP                           30800002
         L     R13,RBLINK-RBSECT(R5)  GET CALLER'S RB                   30900002
         IC    R13,RBOPSWKY-RBSECT(R13)  GET CALLER'S KEY               31000002
         N     R13,FFFFFFF0   CLEANSE KEY                               31100002
EXCOMMON EQU   *              COMMON CODE FOR BOTH SVC AND BRANCH ENTRY 31200002
         L     R7,PSAAOLD     SET THE ASCB ADDRESS(BRANCH ENTRY NEEDS)  31300002
TEST14   EQU   *                                                        31400002
         SR    R12,R12        RESET FRR INPUT REGISTER.                 31500002
         LR    R10,R1         SAVE EXTRACT INPUT PARM LIST              31600002
         LA    R15,EXFRR      GET FRR ADDRESS                           31700002
         SETFRR A,FRRAD=(R15),WRKREGS=(R1,R2)  SET UP FRR ENVIRONMENT   31800002
TEST15   EQU   *                                                        31900002
         LR    R2,R13         SETUP USER KEY                            32000002
         MODESET KEYADDR=(2)  SWITCH INTO CALLER KEY                    32100002
TEST16   EQU   *                                                        32200002
         L     R12,EX228      PCK WILL CONVERT TO '228' IN FRR          32300002
         LM    R8,R10,EXTLANSP-EXTL(R10) GET THE CONTENTS OF THE LIST   32400002
         SR    R12,R12        RESET MAINLINE TO FRR COMMUNICATION       32500002
         N     R10,FFF00000   ZERO GARBAGE 'MAP' BITS.                  32600002
         LA    R9,ZERO(R9)    CLEAR THE TCB HIGH BYTE                   32700002
         LTR   R9,R9          Q. IS THERE A TCB                         32800002
         LR    R1,R4          PASS CORRECT TCB AD TO 'EXTCB'            32900002
         BZ    EXTCB          A. NO. USE CURRENT                        33000002
         L     R12,EX228      PCK WILL CONVERT TO '228'ABEND   @YM02740 33020002
         L     R9,ZERO(,R9)   GET ADDRESS OF TCB               @YM02740 33040002
         SR    R12,R12        RESET FRR COMMUNICATION          @YM02740 33060002
         LA    R9,ZERO(,R9)   CLEAR                            @YM02740 33080002
         LR    R1,R4          SET FIRST                        @YM02740 33100002
EXLOOP1  EQU   *              TCB  SEARCH                               33130002
         LR    R3,R1          INIT REG                         @YM02740 33160002
         L     R1,TCBLTC-TCB(,R3)      GET DAUGHTER            @YM02740 33190002
EXSCI1   LTR   R1,R1          IS THER ONE                      @YM02740 33220002
         BZ    EXNEXTQ        NO, FIND NEXT                             33250002
         CLR   R1,R9          Q. MATCH                                  33300002
         BE    EXTCB          A. YES. A.O.K.                   @YM02740 33400002
         B     EXLOOP1        GET NEXT                         @YM02740 33450002
EXNEXTQ  L     R1,TCBNTC-TCB(,R3)   NEXT SISTER                @YM02740 33500002
         CLR   R4,R3          CHECK FOR END                    @YM02740 33550002
         BE    EXABEND        A. YES. INVALID TCB ADDRESS PASSED.       33600002
         L     R3,TCBOTC-TCB(R3) GET MOTHER                    @YM02740 33700002
         B     EXSCI1         LOOP                             @YM02740 33800002
EXTCB    EQU   *              R1 CONTAINS THE PROPER TCB.               33900002
         LR    R9,R1          SAVE THE PROPER TCB.                      34000002
*GRS                                                                    34100002
         LA    R2,TCBGRS-TCB(R9)  GET ADDRESS OF GEN PURPOSE REGS       34200002
         BAL   R3,EXSTORE     STORE IF REQUESTED.                       34300002
*FRS                                                                    34400002
         LA    R2,TCB-TCBFRS  NEGATIVE DISPLACEMENT FOR FRS             34500002
         LNR   R2,R2          MAKE IT NEGATIVE                          34600002
         AR    R2,R9          RESULT IS ADDRESS OF FLOATING PT REGS     34700002
         BAL   R3,EXSTORE     STORE IF REQUESTED                        34800002
*RES                                                                    34900002
         SR    R2,R2          RESULT ALWAYS ZERO(FIELD OBSOLETE)        35000002
         BAL   R3,EXSTORE     STORE IF REQUESTED.                       35100002
*AETX                                                                   35200002
         L     R2,TCBIQE-TCB(R9)  OBTAIN INTERRUPT QUEUE ELEMENT        35300002
         LTR   R2,R2          Q. IS THERE ONE                           35400002
         BZ    EXAETX         A. NO. STORE ZERO , IF REQUESTED.         35500002
         L     R2,IQEIRB-IQESECT(R2)  OBTAIN THE I.R.B.                 35600002
         L     R2,RBEP-RBSECT(R2)  GET THE ASYNC EXIT E.P.              35700002
EXAETX   BAL   R3,EXSTORE     STORE THE RESULT ,IF REQUESTED.           35800002
*PRI                                                                    35900002
         SR    R2,R2          CLEAR FOR INSERT                          36000002
         ICM   R2,M0011,TCBLMP-TCB(R9)  LIMIT AND DISPATCHING PRIORITY  36100002
         BAL   R3,EXSTORE     STORE RESULT, IF REQUESTED                36200002
*CMC                                                                    36300002
         L     R2,TCBCMP-TCB(R9)  OBTAIN THE COMPLETION CODE.           36400002
         BAL   R3,EXSTORE     STORE THE RESULT, IF REQUESTED.           36500002
*TIOT                                                                   36600002
         L     R2,TCBTIO-TCB(R9)  LOAD TIOT ADDRESS                     36700002
         BAL   R3,EXSTORE     STORE IF REQUESTED.                       36800002
*COMM                                                                   36900002
         L     R1,TCBJSCB-TCB(R9) OBTAIN THE JOB STEP TCB ADDR.         37000002
         LTR   R2,R1          Q. IS THERE A JSCB                        37100002
         BZ    EXCOMM         A. NO. STORE ZERO, IF COMM REQUESTED.     37200002
         L     R2,JSCBCSCB-IEZJSCB(R1)  GET THE COMMAND SCHED CNTRL BLK 37300002
         LA    R2,CHECBP-CSCB(R2)   LOAD ECB/CIB PTR LIST ADDRESS       37400002
EXCOMM   BAL   R3,EXSTORE     STORE RESULT, IF REQUESTED.               37500002
*TSO                                                                    37600002
         L     R1,ASCBTSB-ASCB(R7)   GET THE TIME SHARING BLOCK.        37700002
         LA    R2,EXNOTTSO    ADDR OF BYTE IN WHICH THE HIGH BIT IS 0   37800002
         LTR   R1,R1          Q. IS THIS A TIME SHARING ADDR SPACE      37900002
         BZ    EXTSO          A. NO. STORE THE ADDR OF DC X'00'         38000002
         LA    R2,EXISTSO     ADDR OF BYTE IN WHICH THE HIGH BIT IS 1   38100002
EXTSO    BAL   R3,EXSTORE     STORE THE RESULT, IF REQUESTED.           38200002
*PSB                                                                    38300002
         L     R1,TCBJSCB-TCB(R9)   OBTAIN THE JSCB                     38400002
         LTR   R2,R1          Q. IS THERE A JSCB                        38500002
         BZ    EXPSCB         A. NO STORE ZERO IF REQUESTED.            38600002
         L     R2,JSCBPSCB-IEZJSCB(R1)   GET THE PROTECTED STEP C.B.    38700002
EXPSCB   BAL   R3,EXSTORE     STORE RESULT, IF REQUESTED.               38800002
*TJID                                                                   38900002
         L     R1,ASCBTSB-ASCB(R7)  GET THE TIME SHARING BLOCK.         39000002
         LTR   R2,R1          Q. IS THIS A TIME SHARING ADDR SPACE      39100002
         BZ    EXTJID         A. NO STORE ZERO, IF REQUESTED.           39200002
         SR    R2,R2          ZERO FOR INSERT                           39300002
         ICM   R2,M0011,ASCBASID  GET THE ASID.                         39400002
EXTJID   BAL   R3,EXSTORE     STORE THE RESULT, IF REQUESTED.           39500002
*ASID                                                                   39600002
         ICM   R2,M0011,ASCBASID  GET THE ASID AGAIN                    39700002
         BAL   R3,EXSTORE     STORE ASID , IF REQUESTED.                39800002
         MODESET  EXTKEY=SUPR   BACK TO KEY 0.                          39900002
TEST17   EQU   *                                                        40000002
         SETFRR  D,WRKREGS=(R1,R2)  DELETE FRR.                         40100002
TEST18   EQU   *                                                        40200002
         L     R3,CVTPTR      MUST RETURN W/CVT ADDRESS IN R3           40300002
TEST19   EQU   *                                                        40400002
*        R4 MUST REMAIN THE SAME                                        40500002
*        R14 MUST REMAIN THE SAME                                       40600002
         BR    R14            RETURN                                    40700002
EXABEND  MODESET  EXTKEY=SUPR   BACK TO KEY 0.                 @YM03566 40710002
         SETFRR D,WRKREGS=(R1,R2)                              @YM03566 40730002
*                             DELETE FRR PRIOR TO ABEND                 40760002
         L     R1,EX328       ABEND CALLER FOR BAD TCB ADDRESS          40800002
         ABEND (1),DUMP,,SYSTEM  ABEND THE CALLER                       40900002
TEST20   EQU   *                                                        41000002
EXSTORE  EQU   *              STORE THE RESULT, IF MASK BIT SAYS SO.    41100002
         ALR   R10,R10        SHIFT LEFT AND TEST CARRY                 41200002
         BCR   NOCARRY,R3     NOT REQUESTED,RETURN.                     41300002
         L     R12,EX128      ABEND CODE FOR BAD ANS LIST               41400002
         ST    R2,ZERO(R8)    STORE ANS. INTO SLOT IN LIST              41500002
         SR    R12,R12        RESET ABEND CODE                          41600002
         LA    R8,FOUR(R8)    BUMP ANS. LOCATION                        41700002
         BR    R3             RETURN                                    41800002
TEST21   EQU   *                                                        41900002
         EJECT                                                          41930002
*        EXTRACT'S FRR                                                  41960002
EXFRR    EQU   *              EXTRACT'S FRR                             42000002
         USING SDWA,R1        R1 INPUT FROM RTM                         42100002
         BALR  R6,ZERO        TEMPORARY BASE                            42200002
         USING *,R6           DITTO                                     42300002
         L     R6,BASE        GET THE BASE FOR THIS MODULE              42400002
         USING IGC0001D,R6    DITTO                                     42500002
         L     R0,SDWAABCC    GET CURRENT ABEND CODE.                   42600002
         TM    SDWAFLGS,SDWAPCHK  WAS IT A PROGRAM CHECK                42700002
         BZ    EXSETRP        NO. CONTINUE WITH TERMINATION.            42800002
         LA    R2,EXTABLE-FOUR  SEARCH THRU TABLE FOR ABEND CODE        42900002
         LA    R3,EXSTOP      GET THE STOPPER ADDRESS                   43000002
EXLOOP   EQU   *              LOOP THRU ABEND CODE LIST                 43100002
         LA    R2,FOUR(R2)    POINT TO CURRENT WORD IN LIST             43200002
         CR    R2,R3          Q. IS THIS THE END.                       43300002
         BE    EXSETRP        A. YES. CONTINUE WITH THE SAME ABEND CODE 43400002
         CLC   SDWAGR12(FOUR),ZERO(R2)  Q. DID MAINLINE PASS A CODE     43500002
         BNE   EXLOOP         LOOP UNTIL MATCH OR END OF LIST.          43600002
         L     R0,ZERO(R2)    MATCH.  ABEND USING THIS CODE.            43700002
         ST    R0,SDWAABCC    SET CODE                                  43900002
         SETRP RC=0,RECORD=NO      SET RTM PARMS               @YM03566 43920002
         SR    R15,R15             CLEAR                       @YM03566 43940002
         BR    R14                 RETRUN                      @YM03566 43960002
EXSETRP  EQU   *              SET CODE AND RETURN TO RTM.               43980002
         SETRP RC=0           RETURN TO RTM. CONTINUE W/TERMINATION     44000002
         SR    R15,R15        RETURN CODE OF 0                          44100002
         TITLE 'IEAVTB00...CONSTANTS AND EQUS'                          44150002
         BR    R14            RETURN                                    44200002
TEST22   EQU   *                                                        44300002
         EJECT                                                          44330002
*        EQUALS                                                         44360002
R0       EQU   0              REGISTER 0                                44400002
R1       EQU   1              REGISTER 1                                44500002
R2       EQU   2              REGISTER 2                                44600002
R3       EQU   3              REGISTER 3                                44700002
R4       EQU   4              REGISTER 4                                44800002
R5       EQU   5              REGISTER 5                                44900002
R6       EQU   6              REGISTER 6                                45000002
R7       EQU   7              REGISTER 7                                45100002
R8       EQU   8              REGISTER 8                                45200002
R9       EQU   9              REGISTER 9                                45300002
R10      EQU   10             REGISTER 10                               45400002
R11      EQU   11             REGISTER 11                               45500002
R12      EQU   12             REGISTER 12                               45600002
R13      EQU   13             REGISTER 13                               45700002
R14      EQU   14             REGISTER 14                               45800002
R15      EQU   15             REGISTER 15                               45900002
         SPACE 3                                                        46000002
M1000    EQU   B'1000'        MASK FOR ICM - HI BYTE                    46100002
M0100    EQU   B'0100'        MASK FOR ICM - 2ND BYTE                   46200002
M0010    EQU   B'0010'        MASK FOR ICM - 3RD BYTE                   46300002
M0001    EQU   B'0001'        MASK FOR ICM - LO BYTE                    46400002
M0011    EQU   B'0011'        MASK FOR ICM - LO 2 BYTES                 46500002
M0111    EQU   B'0111'        MASK FOR ICM - LO 3 BYTES                 46600002
CARRY    EQU   3              BRANCH CODE                               46700002
NOCARRY  EQU   12             BRANCH CODE                               46800002
         SPACE 3                                                        46900002
ZERO     EQU   0              ZERO                                      47000002
ONE      EQU   1              ONE                                       47100002
TWO      EQU   2              TWO                                       47200002
FOUR     EQU   4              4                                         47300002
L4       EQU   4              LENGTH OF FOUR               @ZA06785     47350003
TWELVE   EQU   12             TWELVE                                    47400002
XFF      EQU   X'FF'          ALL BITS ON MASK                          47460002
         EJECT                                                          47530002
*        CONSTANTS                                                      47560002
ZEROS    DC    F'0'           FULL WORD OF ZEROS               @ZA12729 47580003
PURGLIST PURGEDQ RMTR=SPIERMTR,MF=L     PARAMETERS FOR PURGEDQ @ZA29414 47590003
BASE     DC    A(IGC0001D)    BASE FOR THIS MODULE.                     47600002
EXTABLE  EQU   *              ABEND CODE TABLE FOR FRR SEARCH           47700002
EX128    DC    X'80128000'    ABEND CODE 128                            47800002
EX228    DC    X'80228000'    ABEND CODE 228                            47900002
EXSTOP   EQU   *              TABLE END                                 48000002
EX328    DC    X'00000328'    ABEND CODE 328                            48100002
SPTABLE  EQU   *              ABEND CODE TABLE FOR FRR SEARCH           48200002
SP10E    DC    X'8010E000'    ABEND CODE 10E                            48300002
SP20E    DC    X'8020E000'    ABEND CODE 20E                            48400002
SPSTOP   EQU   *              END OF TABLE ADDRESS                      48500002
SP30E    DC    X'0000030E'    ABEND CODE 30E                            48600002
FF0F0FFF DC    X'FF0F0FFF'    MASK FF0F0FFF                             48690002
FFFFFFF0 DC    X'FFFFFFF0'    MASK FFFFFFF0                             48780002
FFF00000 DC    X'FFF00000'    MASK FFF00000                             48870002
FF0FFFFF DC    X'FF0FFFFF'    MASK FF0FFFFF                             48960002
FFF0FFFF DC    X'FFF0FFFF'    MASK FFF0FFFF                             49050002
FFFFFF0F DC    X'FFFFFF0F'    MASK FFFFFF0F                             49140002
HIGHBIT  DC    X'80000000'    MULTI USE WORD.                           49230002
HZERO    EQU   HIGHBIT+TWO    HALFWORD CONTAINING ZERO                  49320002
EXNOTTSO DC    X'00'          BYTE WITH HI BIT OFF TO SAY NOT TSO       49410002
EXISTSO  DC    X'80'          BYTE WITH HI BIT ON TO SAY TSO            49500002
*                            RECOVERY RPIEPICA DSECT          @ZA06785  49510003
RPIEPICA DSECT                                                @ZA06785  49520003
RPPNPTR  DS   A              ADDRESS OF NEXT RPIEPICA         @ZA06785  49530003
RPPPRB   DS    A             ADDRESS OF ISSUING RB            @ZA06785  49540003
RPPPIE   DS    A             ADDRESS OF ASSOCIATED PIE        @ZA06785  49550003
RPPPICA  DS    A             ADDRESS OF ASSOCIATED PICA       @ZA06785  49560003
RPPLEN   EQU *-RPIEPICA      LENGTH OF RPIEPICA               @ZA06785  49570003
      TITLE  'IEAVTB00...IHASCA - SPIE CONTROL AREA'                    49572003
      IHASCA                                                            49574003
      TITLE 'IEAVTB00...IHASRB - SERVICE REQUEST BLOCK'                 49576003
      IHASRB                                                            49578003
SRBLEN   EQU   *-SRB          LENGTH OF SRB                             49580003
SCALEN1  EQU   SCALEN+SRBLEN  LENGTH OF THE SCA INCLUDING SRB           49582003
*                             CHECK POINT DATA DSECT                    49590002
SSCR     DSECT                                                          49700002
SSCRID   DS    X              CHECKPOINT RECORD ID                      49800002
SSCRSSID DS    X              SPIE I.D.                                 49900002
SSCRHDRL DS    H              OFFSET TO DATA FIELD                      50000002
SSCRFCHN DS    A              CHAIN TO NEXT SSCR                        50100002
SSCRFLG1 DS    X              FLAGS                                     50200002
SSCRCKRS EQU   X'80'          1=CHECKPOINT,0=RESTART                    50300002
         DS    X              RESERVED                                  50400002
SSCRDATL DS    H              DATA LENGTH                               50500002
SSCRDCBA DS    A              ADDRESS OF ASSOCIATED DCB                 50600002
SSCRDATA DS    0C             DATA STARTS HERE                          50700002
DATA     DSECT                                                          50800002
DATAFLG6 DS    X              SAVE AREA FOR TCBFLGS6                    50900002
DATAPMSK DS    X              SAVE AREA FOR TCBPMASK                    51000002
DATASCA  DS    XL(SCALEN1)    SAVE AREA FOR SCA      @ZA12729           51050003
DATARPPL DS    F              LENGTH OF RPP DATA AREA     @ZA12729      51100003
DATARPP  DS    0F             SAVE AREA FOR RPIEPICAS @ZA12729          51130003
EXTL     DSECT                                                          51200002
EXTLANSP DS    A              ADDRESS OF ANSWER LIST                    51300002
EXTLTCBP DS    A              ADDRESS OF WORD WITH TCB ADDRESS          51400002
EXTLMAP  DS    4X             MASK BITS FOR EXTRACT INFORMATION         51500002
ANSLIST  DSECT                                                          51600002
         DS    1F             VARIABLE LENGTH ANS LIST.                 51700002
         TITLE 'IEAVTB00...IHAPIE - PROGRAM ITERRUPT ELEMENT'           52150002
         IHAPIE                                                         52200002
PIELEN   EQU   *-PIE                                                    52300002
         TITLE 'IEAVTB00...IHAIQE - INTER. QUEUE ELEMENT'               52350002
         IHAIQE                                                         52400002
CSCB     DSECT                                                          52500002
         TITLE 'IEAVTB00...IEECHAIN - CON. SCHED. CONTROL BLOCK'        52550002
         IEECHAIN                                                       52600002
         TITLE 'IEAVTB00...IEZJSCB - JOB/STEP CONTROL BLOCK'            52650002
         IEZJSCB                                                        52700002
         TITLE 'IEAVTB00...IHAPICA - PROG. INTER. CONTROL AREA'         52750002
         IHAPICA                                                        52800002
         TITLE 'IEAVTB00...IKJTCB - TASK CONTROL BLOCK'                 52850002
         IKJTCB                                                         52900002
         TITLE 'IEAVTB00...IKJRB - REQUEST BLOCK'                       52950002
         IKJRB                                                          53000002
RBOPSWKY EQU   RBOPSW+1       PSW KEY                                   53100002
AMWP     EQU   1              AMWP OFFSET INTO PSW                      53200002
PBIT     EQU   1              PROBLEM BIT IN AMWP                       53300002
RBOPSWMK EQU   RBOPSW+2       RB SWMK                                   53400002
         TITLE 'IEAVTB00...IHAASCB - ADDR. SPACE CONTROL BLOCK'         53450002
         IHAASCB                                                        53500002
         TITLE 'IEAVTB00...IHAPSA - PREFIXED SAVE AREA'                 53550002
         IHAPSA                                                         53600002
         TITLE 'IEAVTB00...CVT - COMMUNICATIONS VECTOR TABLE'           53650002
         CVT   DSECT=YES                                                53700002
         TITLE 'IEAVTB00...IHASDWA - STAE DIAG. WORK AREA'              53750002
         IHASDWA                                                        53800002
         TITLE 'IEAVTB00...IHAFRRS - FUNC. RECOV. TRN. STACK'           53850002
         IHAFRRS                                                        53900002
         TITLE 'IEAVTB00...IHARMPL - RES. MANAG. PARM LIST'             53950002
         IHARMPL                                                        54000002
         CSECT                                                          54030002
IEAVTBP  DC    XL50'00'                PATCH AREA                       54060002
         END   IGC00040                                                 54100002
./  ADD  SSI=32851072,NAME=IEAVTEST
TEST     TITLE 'IEAVTEST - IGC119 - TEST AUTHORIZATION ROUTINE'         00300001
* /* START OF SPECIFICATIONS ****                                       00400002
*                                                                       00500002
*01*  MODULE-NAME = IEAVTEST                                            00600002
*                                                                       00630002
*01*  DESCRIPTIVE-NAME = TESTAUTH                                       00640002
*                                                                       00660002
*01*  COPYRIGHT = NONE                                                  00670002
*                                                                       00680002
*01*  STATUS = OSVS2 REL 2                                              00690002
*                                                                       00700002
*01*  FUNCTION = TESTS AN SVC'S CALLER FOR PROPER AUTHORIZATION. ANY    00710002
*     COMBINATION OF 3 TYPES OF AUTHORIZATIONS MAY BE REQUESTED BY THE  00720002
*     SVC.  THESE ARE: 1. PSW STATE; 2. PSW KEY; 3. APF.                00730002
*     PASSES AN INDICATION TO THE SVC AS TO WHETHER HIS CALLER WAS      00740002
*     AUTHORIZED OR NOT.                                                00750002
*                                                                       00760002
*02*     OPERATION = 1. CHECK OR IGNORE STATE CHECK.                    00770002
*                    2. AUTHORIZED RETURN WITH ZERO                     00830002
*                    3. CHECK OR IGNORE KEY CHECK.                      00900002
*                    4. AUTHORIZED RETURN WITH ZERO                     00903002
*                    5. CHECK OR IGNORE APF CHECK.                      00906002
*                    6. AUTHORIZED                                      00909002
*                    7. OTHER RETURN WITH 4.                            00912002
*                                                                       00918002
*01*   NOTES = TESTAUTH DOES NO STORES. TESTAUTH IS VERY SENSITIVE TO   00924002
*      PERFORMANCE AND MUST BE KEPT TO A BARE MINIMUM. IT CANNOT USE    00930002
*      REGISTERS OTHER THAN R14 THROUGH R3. IT RUNS IN ANY KEY. IT IS   00936002
*      CALLED BY THE SVC FLIH. ITS MOST POPULAR PATH IS A RETURN CODE 0 00942002
*      FROM EITHER THE STATE OR KEY CHECK. 13 AND 15 INSTURCTIONS       00948002
*      RESPECTIVELY.                                                    00954002
*                                                                       00960002
*02*     DEPENDENCIES = NONE                                            00966002
*                                                                       00972002
*03*        CHARACTER-CODE-DEPENDENCIES = NONE                          00978002
*                                                                       00984002
*02*     RESTRICTIONS = NONE                                            00990002
*                                                                       00996002
*02*     REGISTER-CONVENTIONS = SEE INPUT AND REGISTER EQUATES.         01002002
*                                                                       01026002
*02*     PATCH-LABEL = NONE                                             01032002
*                                                                       01038002
*01*  MODULE-TYPE = TYPE 1 SVC ROUTINE                                  01044002
*                                                                       01056002
*02*     PROCESSOR = ASSEMBLER                                          01062002
*                                                                       01068002
*02*     MODULE-SIZE = 300 BYTES                                        01074002
*                                                                       01080002
*02*     ATTRIBUTES = NUCLEUS, ZERO PROTECT KEY(CAN RUN ANY             01086002
*        KEY), REENTERABLE, SUPERVISOR MODE, LOCAL LOCK                 01092002
*                                                                       01098002
*01*  ENTRY-POINT = IGC119 - SVC ENTRY;                                 01104002
*                   IEAVTEST - BRANCH ENTRY                             01107002
*                                                                       01110002
*02*     PURPOSE = SEE FUNCTION                                         01116002
*                                                                       01128002
*02*     LINKAGE = VIA SVC 119 OR BRANCH; SEE INPUT                     01134002
*                                                                       01158002
*02*     INPUT =                                                        01164002
*    IGC119 (SVC ENTRY)                                                 01170002
*                                                                       01176002
*    PSW - KEY0, SUPERVISOR STATE, DISABLED                             01182002
*    R0 - AUTH. CODE, IF SUPPLIED; OTHERWISE R0 IS NEGATIVE             01188002
*    R1 - FUNCTION CODE                                                 01194002
*    R3 - @ CVT                                                         01200002
*    R4 - @ TCB                                                         01206002
*    R5 - @ RB                                                          01212002
*    R6 - ENTRY POINT                                                   01216002
*    R14 - RETURN @                                                     01217002
*    R2,R7-R13,R15 - IRRELEVANT                                         01218002
*                                                                       01219002
*    IEAVTEST (BRANCH ENTRY)                                            01220002
*                                                                       01221002
*    PSW  - KEY0, SUPERVISOR STATE, DISABLED                            01222002
*    R0 - AUTHORIZATION CODE, IF SUPPLIED; OTHERWISE R0 IS NEGATIVE     01223002
*    R1 - FUNCTION CODE                                                 01224002
*    R4 - TCB @ (IF 0, THE CURRENT TCB @ WILL BE USED)                  01228002
*    R14 - RETURN @                                                     01229002
*    R15 - ENTRY POINT                                                  01230002
*    R2,R3,R5-R13 - IRRELEVANT                                          01232002
*                                                                       01233002
*02*     OUTPUT = NONE EXCEPT RETURN CODE - SEE EXIT, NORMAL.           01234002
*                                                                       01235002
*01*  EXIT-NORMAL = RC 0 - AUTHORIZED;                                  01236002
*                   RC 4 - NOT AUTHORIZED                               01246002
*                                                                       01256002
*02*     OUTPUT =                                                       01276002
*                                                                       01280002
*    IGC119 (SVC ENTRY)                                                 01288002
*                                                                       01288502
*    PSW - KEY0, SUPERVISOR STATE, DISABLED                             01289002
*    R0-R13 - UNPREDICTABLE                                             01289502
*    R14 - UNCHANGED                                                    01290002
*    R15 - RETURN CODE                                                  01290502
*    .         0 - TASK AUTHORIZED                                      01291002
*    .         4 - TASK NOT AUTHORIZED                                  01292002
*                                                                       01293002
*    IEAVTEST (BRANCH ENTRY)                                            01294002
*                                                                       01296002
*    PSW - KEY0, SUPERVISOR STATE, DISABLED                             01296502
*    R0-R14 - UNCHANGED                                                 01297002
*    R15 - RETURN CODE                                                  01297502
*    .         0 - TASK AUTHORIZED                                      01298002
*    .         4 - TASK NOT AUTHORIZED                                  01298502
*                                                                       01299002
*                                                                       01300002
*01*  EXIT-ERROR = ABEND CODE 177 - INVALID PARM LIST                   01328002
*                                                                       01332002
*02*     CONDITIONS = ONE OF FOLLOWING ERROR CONDITIONS OCCURED         01336002
*                   - RBLEVEL=2 SPECIFIED BUT TOP RB IS LAST RB         01337002
*                   - FUNCTION CODE GT OR EQ TO 256                     01338002
*                     OR NOT IN TABLE RANGE                             01339002
*                   - AUTHORIZATION CODE GT OR EQ TO 256                01340002
*                     OR NOT IN TABLE RANGE                             01341002
*                                                                       01344002
*02*     OUTPUT =                                                       01348002
*                                                                       01350002
*02*     RETURN-CODES = IF AUTHORIZED, THE RETURN CODE IS ZERO (0) IN   01352002
*        REG 15, IF NOT THE RETURN CODE IS 4                            01380002
*                                                                       01384002
*01*  EXTERNAL-REFERENCES = ROUTINES - ABEND;                           01388002
*                           DATA AREAS - IEAVAUTH - APF BIT MATRIX      01392002
*                                                                       01396002
*02*     ROUTINES = ABEND                                               01400002
*                                                                       01412002
*02*     DATA-AREAS = APF BIT MATRIX - IEAVAUTH                         01416002
*        USED TO TEST FOR SPECIFIC AUTHORIZATION                        01420002
*        POINTER LOCATED AT SYMBOLIC LOCATIONIEAVAUTH                   01424002
*        USED. FOR DATA SETS, INDICATE WHETHER CREATED/DELETED,         01428002
*        OPENED/CLOSED, POSITIONED/READ/UPDATED/ADDED TO.;              01432002
*                                                                       01436002
*02*     CONTROL-BLOCKS = TCB,JSCB,PSA,RB.                              01440002
*                                                                       01444002
*01*  TABLES = NONE                                                     01448002
*                                                                       01452002
*01*  MACROS = ABEND                                                    01456002
*                                                                       01460002
*02*    SERIALIZATION = RES: COMMENTS,                                  01464002
*       COMMENTS: NAMES OF LOCKS AND ENQ RESOURCES OBTAINED BY          01468002
*       THIS MODULE;                                                    01472002
*                                                                       01476002
*01*  CHANGE-ACTIVITY = Y02752 FOR OSVS2 RELEASE 2                      01480002
*                                                                       01484002
*01*  MESSAGES = NONE                                                   01488002
*                                                                       01492002
*01*  ABEND-CODES = 177 FOR INVALID PARM LIST.                          01500002
*                                                                       01540002
**** END OF SPECIFICATIONS ***/                                         01580002
*                                                                       52200001
         EJECT                                                          52500001
IEAVTST1 CSECT                                                          52800002
         DC    CL8'IEAVTEST'  MODULE NAME                               53100002
IGC119   CSECT                                                          53400002
         ENTRY IEAVTEST       BRANCH ENTRY ADDRESS                      53700002
         BALR  R15,ZERO       SETUP BASE ADDRESS.                       54000002
IEAVTEST EQU   *              BRANCH E.P.                               54300002
         USING IEAVTEST,R15   BASE REGISTER FOR TESTAUTH                54600002
         USING FLC,0          LOW CORE ADDRESSABILITY                   54900002
         SLA   R1,ELEVEN      SHIFT OUT THE RESERVED BITS AND TEST      55200002
         BC    OVERFLOW+NEGATIVE,INVALID BRANCH IF ANY RESERVED BIT=1   55500002
         ALR   R1,R1          SHIFT OUT THE POSITIVE SIGN BIT           55800002
         L     R3,PSATOLD     GET THE CURRENT TCB ADDRESS               56100002
         L     R2,TCBRBP-TCB(R3)    GET THE 1ST RB OFF CURRENT TCB      56400002
         ALR   R1,R1          TEST THE FIRST FLAG BIT(RBLEVEL)          56700002
         BC    NOCARRY,SKIP1  BIT=0(RBLEVEL=1 OR APF CHECK ONLY)        57000002
         TM    RBSTAB2-RBSECT(R2),RBTCBNXT  Q. ONE R.B.                 57300002
         BO    INVALID                      A. YES. MUST HAVE TWO.      57600002
         L     R2,RBLINK-RBSECT(R2)  GET THE 2ND RB OFF THE CURRENT TCB 57900002
SKIP1    EQU   *              R2 CONTAINS CORRECT RB LEVEL              58200002
         ALR   R1,R1          TEST THE 'STATE' FLAG                     58500002
         BC    NOCARRY,SKIP2  BIT=0(STATE=NO)                           58800002
         TM    RBOPSW+XMWP-RBSECT(R2),PBIT Q.PSW IN SUPERVISOR STATE    59100002
         BZ    RET0           A. YES. RETURN TO CALLER WITH R.C. OF 0   59400002
SKIP2    EQU   *              'KEY' LOGIC IS NEXT                       59700002
         ALR   R1,R1          TEST THE 'KEY' FLAG                       60000002
         BC    NOCARRY,SKIP3  BIT=0(KEY=NO)                             60300002
         CLI   RBOPSWKY-RBSECT(R2),KEY8  Q.IS KEY LESS THAN 8           60600002
         BL    RET0           A. YES. RETURN TO CALLER WITH R.C. OF 0.  60900002
SKIP3    EQU   *              'APF' LOGIC IS NEXT                       61200002
         ALR   R1,R1          TEST THE 'APF' FLAG                       61500002
         BC    CARRY,RET4     BIT=1(APF NOT REQUESTED)                  61800002
         L     R2,TCBJSTCB-TCB(R3)  GET THE JOB STEP TCB.               62100002
         L     R2,TCBJSCB-TCB(R2) GET THE JOB STEP CONTROL BLOCK        62400002
         SRL   R1,SIXTEEN     RIGHT JUSIFY THE FCTN CODE.               62700002
         CL    R1,F256        Q. FCTN GT 255                            63000002
         BNL   INVALID        A. YES. ABEND CALLER.                     63300002
         LTR   R0,R0          Q. WAS 'AUTH' SPECIFIED.                  63600002
         BNL   AUTHCK         A. YES. CHECK VALUE                       63900002
         LA    R0,AUTHEQ1     SETUP AUTH=1                              64200002
         LTR   R2,R2          Q. IS THERE A JSCB                        64500002
         BZ    RET0           A. NO. HAS TO BE AUTHORIZED.              64800002
         TM    JSCBOPTS-IEZJSCB(R2),JSCBAUTH  Q. IS JOB STEP AUTHORIZED 65100002
         BO    AUTHCK         A. YES.                                   65400002
         LA    R0,AUTHEQ0     SETUP AUTH=0                              65700002
AUTHCK   EQU   *              CHECK FOR VALID CODE.                     66000002
         CL    R0,F256        Q. AUTH GT 255                            66300002
         BNL   INVALID        A. YES. ABEND CALLER                      66600002
         LR    R2,R1          SAVE THE FCTN CODE                        66900002
         LR    R1,R0          SAVE THE AUTH CODE                        67200002
         L     R3,VAUTH       GET THE AUTHORIZATION MATRIX.             67500002
* NOTE: THE IBM SUPPLIED MATRIX IS DC X'0202B0'                         67800002
         EX    R1,CLI0        Q. AUTH CODE WITHIN MATRIX RANGE          68100002
         BNH   INVALID        A. NO. ABEND. INVALID PARMS.              68400002
         EX    R2,CLI1        Q. FCTN CODE WITHIN MATRIX RANGE          68700002
         BNH   INVALID        A. NO. ABEND. INVALID PARMS.              69000002
         SR    R0,R0          ZERO FOR INSERT                           69300002
         IC    R0,MTRXAUTH-MTRX(R3) GET THE AUTH RANGE                  69600002
         MR    R0R1,R0        AUTH VALUE X AUTH RANGE = R1              69900002
         AR    R1,R2          R1 + FCTN CODE = R1 = BIT DISPLACEMENT    70200002
         LR    R2,R1          SAVE THE RESULT                           70500002
         SRL   R1,THREE       BIT DISPLACEMENT / 8 = BYTE DISPLACEMENT  70800002
         ALR   R1,R3          BYTE DISPLACEMENT + MATRIX ADDRESS        71100002
         LA    R1,TWO(R1)     + TWO = TARGET BYTE.                      71400002
         N     R2,HIGH29      RESULT IS BIT DISPLACEMENT IN BYTE        71700002
         IC    R2,TABLE(R2)   GET THE PROPER MASK FOR TM INSTRUCTION    72000002
         EX    R2,TM          TEST  PROPER BIT WITHIN THE PROPER BYTE   72300002
         BO    RET0           BIT=1 THE CALLER IS AUTHORIZED.           72600002
RET4     EQU   *              CALLER IS NOT AUTHORIZED.                 72900002
         LA    R15,RC4        RETURN CODE OF 4                          73200002
         BR    R14            RETURN                                    73500002
RET0     EQU   *              CALLER IS AUTHORIZED.                     73800002
         LA    R15,RC0        RETURN CODE OF 0                          74100002
         BR    R14            RETURN                                    74400002
INVALID  EQU   *              INVALID PARAMETERS FROM CALLER            74700002
         L     R1,CODE177     ABEND CODE OF 177                         75000002
         ABEND (1),DUMP,,SYSTEM  ABEND CALLER                           75300002
         EJECT                                                          75600002
R0       EQU   0              REGISTER 0                                75900002
R1       EQU   1              REGISTER 1                                76200002
R2       EQU   2              REGISTER 2                                76500002
R3       EQU   3              REGISTER 3                                76800002
R14      EQU   14             REGISTER 14                               77100002
R15      EQU   15             REGISTER 15                               77400002
R0R1     EQU   0              REGISTERS 0 AND 1 FOR MULTIPLY INSTR      77700002
         SPACE 3                                                        78000002
NOCARRY  EQU   X'C'           NOCARRY CONDITION CODE                    78300002
CARRY    EQU   X'3'           CARRY CONDITION CODE                      78600002
OVERFLOW EQU   X'1'           OVERFLOW CONDITION CODE                   78900002
NEGATIVE EQU   X'4'           NEGITIVE CONDITION CODE                   79200002
         SPACE 3                                                        79500002
RC0      EQU   0              RETURN CODE OF 0                          79800002
RC4      EQU   4              RETURN CODE OF 4                          80100002
ZERO     EQU   0              0                                         80400002
ONE      EQU   1              1                                         80700002
TWO      EQU   2              2                                         81000002
THREE    EQU   3              3                                         81300002
FOUR     EQU   4              4                                         81600002
ELEVEN   EQU   11             11                                        81900002
SIXTEEN  EQU   16             16                                        82200002
         SPACE 3                                                        82500002
AUTHEQ0  EQU   0              AUTH=0                                    82800002
AUTHEQ1  EQU   1              AUTH=1                                    83100002
         SPACE 3                                                        83400002
TABLE    DC    X'8040201008040201'  BIT MASK TABLE                      83700002
F256     DC    F'256'         MAX MATRIX DIMENSION                      84000002
CODE177  DC    X'00000177'    ABEND CODE 177                            84300002
HIGH29   DC    X'00000007'    MASK TO ZERO HIGH 29 BITS IN A REG        84600002
VAUTH    DC    V(IEAVAUTH)    ADDRESS OF APF MATRIX                     84900002
CLI0     CLI   MTRXAUTH-MTRX(R3),ZERO USED WITH EX INTRUCTION           85200002
CLI1     CLI   MTRXFCTN-MTRX(R3),ZERO USED WITH EX INSTRUCTION          85500002
TM       TM    ZERO(R1),ZERO  USED WITH EX INSTRUCTION                  85800002
         EJECT                                                          86100002
MTRX     DSECT                                                          86400002
MTRXAUTH DS    X              'AUTH' RANGE                              86700002
MTRXFCTN DS    X              'FCTN' RANGE                              87000002
MTRXSTRG DS    B              VARIABLE LENGTH BIT STRING                87300002
         EJECT                                                          87600002
         IHARB                                                          87900002
XMWP     EQU   1              XMWP IS IN BYTE 1 OF RBOPSW               88200002
RBOPSWKY EQU   RBOPSW+1       KEY IS IN BYTE 1 OF RBOPSW                88500002
PBIT     EQU   B'0001'        PBIT IS LAST BIT IN XMWP                  88800002
KEY8     EQU   X'80'          KEY CHECK AGAINST RBOPSW'S KEY            89100002
         EJECT                                                          89400002
         IKJTCB                                                         89700002
         EJECT                                                          90000002
         IEZJSCB                                                        90300002
         EJECT                                                          90600002
         IHAPSA                                                         90900002
         END   IGC119                                                   91800002
./  ADD  SSI=71080098,NAME=IEAVTRCE
IEAVTRCE CSECT                                                          00003002
         TITLE 'IEAVTRCE - SYSTEM TRACE ROUTINE'                        00003502
         USING *,XTRBASE           BASE NEEDED FOR MODID MACRO          00011002
         MODID                                                          00021002
* /* START OF SPECIFICATIONS ****                                       00023002
*                                                                       00025002
*01*  MODULE-NAME = IEAVTRCE                                            00027002
*                                                                       00031002
*02*     CSECT-NAME = IEAVTRCE                                          00041002
*                                                                       00051002
*01*  DESCRIPTIVE-NAME = VS2/2 TRACE ROUTINE                            00061002
*                                                                       00071002
*01*  COPYRIGHT = NONE                                                  00081002
*                                                                       00091002
*01*  STATUS = 0                                                        00101002
*                                                                       00111002
*01*  FUNCTION = RECORD THE FOLLOWING SYSTEM ACTIVITY:                  00121002
*                1. EXTERNAL INTERRUPTS                                 00131002
*                2. I/O INTERRUPTS                                      00141002
*                3. PROGRAM INTERRUPTS                                  00151002
*                4. SVC INTERRUPTS                                      00161002
*                5. START I/O (FROM IOS)                                00173502
*                6. TASK DISPATCH/EXIT PROLOG DISPATCH EVENTS           00183502
*                7. SERVICE REQUEST EVENTS                              00193502
*                                                                       00203502
*                THE FORMAT OF EACH TRACE TABLE ENTRY FOLLOWS           00213502
*                THE PROLOG.                                            00223502
*                                                                       00233502
*02*     OPERATION = A UNIQUE ENTRY POINT EXISTS FOR EACH               00243502
*                    FUNCTION IDENTIFIED ABOVE. AFTER UPDATING          00253502
*                    THE CURRENT TRACE TABLE ENTRY POINTER,             00263502
*                    THE DESIRED INFORMATION IS PLACED INTO             00273502
*                    THE TRACE TABLE.                                   00283502
*                    SOME SPECIAL ENTRY POINTS HAVE BEEN       @ZA16400 00285540
*                    DEFINED SO IEAVESPR CAN DETECT THAT A     @ZA16400 00287540
*                    FAILURE OCCURRED WITHIN TRACE AND THAT    @ZA16400 00289540
*                    THE REGISTERS HAD BEEN SAVED.             @ZA16400 00291540
*                                                                       00293502
*01*   NOTES                                                            00303502
*                                                                       00313502
*02*     DEPENDENCIES = THIS MODULE DOES NOT CONTAIN ANY                00323502
*                       HARDWARE DEPENDENCIES. THE FOLLOWING            00333502
*                       ARE THE SOFTWARE DEPENDENCIES:                  00343502
*                       (1) COMPARE-AND-SWAP MUST BE USED TO            00353502
*                           UPDATE THE CURRENT ENTRY POINTER            00363502
*                       (2) A CPU RELATED SAVE AREA IS USED             00373502
*                           TO ELIMINATE MP PROBLEMS                    00383502
*                       (3) A ONE WORD REGISTER SAVE                    00393502
*                           LOCATION IS REQUIRED IN THE PSA             00403502
*                           (SERIALIZED BY DISABLEMENT)                 00413502
*                                                                       00423502
*03*        CHARACTER-CODE-DEPENDENCIES = THIS MODULE IS NOT            00433502
*                                         CHARACTER CODE                00443502
*                                         DEPENDENT                     00453502
*                                                                       00463502
*02*     RESTRICTIONS = NONE                                            00473502
*                                                                       00483502
*02*     REGISTER-CONVENTIONS = REFER TO THE 'REGISTER EQUATES'         00493502
*                               PORTION OF THIS MODULE                  00503502
*                                                                       00513502
*02*     PATCH-LABEL = NONE WITHIN THIS MODULE. COMMON                  00523502
*                      NUCLEUS MAINTENANCE AREA SHOULD                  00533502
*                      BE USED (IEAPACH)                                00543502
*                                                                       00553502
*01*  MODULE-TYPE = MODULE                                              00563502
*                                                                       00573502
*02*     PROCESSOR = ASSEMBLER                                          00583502
*                                                                       00593502
*02*     MODULE-SIZE = APPROXIMATELY 700 BYTES                          00603502
*                                                                       00613502
*02*     ATTRIBUTES = NUCLEUS CODE, REFRESHABLE, SUPERVISOR             00623502
*                     PROTECT KEY, SUPERVISOR STATE, AND                00633502
*                     DISABLED FOR ALL MASKABLE INTERRUPTS              00643502
*                     ON CALLER'S CPU                                   00653502
*                                                                       00663502
*01*  ENTRY-POINT = TREX                                                00673502
*                                                                       00683502
*02*     PURPOSE = RECORD EXTERNAL INTERRUPTS IN TRACE TABLE            00693502
*                                                                       00703502
*02*     LINKAGE = BRANCH ENTERED                                       00713502
*                                                                       00723502
*02*     INPUT = REGISTERS 0,1 - AS AT TIME OF INTERRUPT                00733502
*                REGISTERS 2-9 - IRRELEVANT                             00743502
*                REGISTER  10  - ENTRY POINT ADDRESS                    00753502
*                REGISTER  11  - RETURN ADDRESS                         00763502
*                REGISTERS 12-14 - IRRELEVANT                           00773502
*                REGISTER  15 - AS AT TIME OF INTERRUPT                 00783502
*                                                                       00793502
*02*     OUTPUT = TRACE TABLE ENTRY (SEE FORMATS AT END OF              00803502
*                 PROLOG) AND UPDATED CURRENT TRACE TABLE               00813502
*                 ENTRY POINTER.                                        00823502
*                                                                       00843502
*02*     REGISTERS-SAVED = REGISTERS 11-15 ARE SAVED IN THE             00853502
*                          CPU RELATED SAVE AREA POINTED TO             00863502
*                          BY WSACCWSA. REGISTER 8 IS SAVED             00873502
*                          IN THE PSA (PSAGPREG)                        00879502
*                                                                       00885502
*02*     REGISTER-USAGE = REFER TO 'REGISTER EQUATES' PORTION           00893502
*                         OF THIS MODULE                                00903502
*                                                                       00913502
*02*     REGISTERS-RESTORED = REGISTERS 8,11-15                         00923502
*                                                                       00933502
*01*  ENTRY-POINT = TRIO                                                00943502
*                                                                       00953502
*02*     PURPOSE = RECORD I/O INTERRUPTS IN TRACE TABLE                 00963502
*                                                                       00973502
*02*     LINKAGE = BRANCH ENTERED                                       00983502
*                                                                       00993502
*02*     INPUT = REGISTERS 0-2   - AS AT TIME OF INTERRUPT              01003502
*                REGISTERS 3-4   - IRRELEVANT                           01013502
*                REGISTERS 5-9   - AS AT TIME OF INTERRUPT              01023502
*                REGISTER  10    - ENTRY POINT ADDRESS                  01033502
*                REGISTER  11    - RETURN ADDRESS                       01043502
*                REGISTERS 12-15 - AS AT TIME OF INTERRUPT              01053502
*                                                                       01063502
*02*     OUTPUT = TRACE TABLE ENTRY (SEE FORMAT AT END OF               01073502
*                 PROLOG) AND UPDATED CURRENT TRACE TABLE               01083502
*                 ENTRY POINTER                                         01093502
*                                                                       01103502
*02*     REGISTERS-SAVED = REGISTERS 11-15 ARE SAVED IN THE             01113502
*                          CPU RELATED SAVE AREA POINTED TO             01123502
*                          BY WSACCWSA. REGISTER 8 IS SAVED             01133502
*                          IN THE PSA (PSAGPREG)                        01143502
*                                                                       01153502
*02*     REGISTER-USAGE = REFER TO 'REGISTER EQUATES' PORTION           01163502
*                         OF THIS MODULE                                01173502
*                                                                       01183502
*02*     REGISTERS-RESTORED = REGISTERS 8,11-15                         01193502
*                                                                       01203502
*01*  ENTRY-POINT = TRPI                                                01213502
*                                                                       01223502
*02*     PURPOSE = RECORD PROGRAM INTERRUPTS IN TRACE TABLE             01233502
*                                                                       01243502
*02*     LINKAGE = BRANCH ENTERED                                       01253502
*                                                                       01263502
*02*     INPUT = REGISTERS 0-9   - AS AT TIME OF INTERRUPT              01273502
*                REGISTER  10    - ENTRY POINT ADDRESS                  01283502
*                REGISTER  11    - RETURN ADDRESS                       01293502
*                REGISTERS 12-15 - AS AT TIME OF INTERRUPT              01303502
*                                                                       01313502
*02*     OUTPUT = TRACE TABLE ENTRY (SEE FORMATS AT END OF              01323502
*                 PROLOG) AND UPDATED CURRENT TRACE TABLE               01333502
*                 ENTRY POINTER                                         01343502
*                                                                       01353502
*02*     REGISTERS-SAVED = REGISTERS 11-15 ARE SAVED IN THE             01363502
*                          CPU RELATED SAVE AREA POINTED TO             01373502
*                          BY WSACCWSA. REGISTER 8 IS SAVED             01383502
*                          IN THE PSA (PSAGPREG)                        01393502
*                                                                       01403502
*02*     REGISTER-USAGE = REFER TO 'REGISTER EQUATES' PORTION           01413502
*                         OF THIS MODULE                                01423502
*                                                                       01433502
*02*     REGISTERS-RESTORED = REGISTERS 8,11-15                         01443502
*                                                                       01453502
*01*  ENTRY-POINT = TRSVC                                               01463502
*                                                                       01473502
*02*     PURPOSE = RECORD SVC INTERRUPTS IN TRACE TABLE                 01483502
*                                                                       01493502
*02*     LINKAGE = BRANCH ENTERED                                       01503502
*                                                                       01513502
*02*     INPUT = REGISTERS 0-9   - AS AT TIME OF INTERRUPT              01523502
*                REGISTER  10    - ENTRY POINT ADDRESS                  01533502
*                REGISTER  11    - RETURN ADDRESS                       01543502
*                REGISTERS 12-15 - AS AT TIME OF INTERRUPT              01553502
*                                                                       01563502
*02*     OUTPUT = TRACE TABLE ENTRY (SEE FORMATS AT END OF              01573502
*                 PROLOG) AND UPDATED CURRENT TRACE TABLE               01583502
*                 ENTRY POINTER                                         01593502
*                                                                       01603502
*02*     REGISTERS-SAVED = REGISTERS 11-15 ARE SAVED IN THE             01613502
*                          CPU RELATED SAVE AREA POINTED TO             01623502
*                          BY WSACCWSA. REGISTER 8 IS SAVED             01633502
*                          IN THE PSA (PSAGPREG)                        01643502
*                                                                       01653502
*02*     REGISTER-USAGE = REFER TO 'REGISTER EQUATES' PORTION           01663502
*                         OF THIS MODULE                                01673502
*                                                                       01683502
*02*     REGISTERS-RESTORED = REGISTERS 8,11-15                         01693502
*                                                                       01703502
*01*  ENTRY-POINT = TRSIO/TRACE                                         01713502
*                                                                       01723502
*02*     PURPOSE = RECORD START I/O EVENTS IN TRACE TABLE               01733502
*                                                                       01743502
*02*     LINKAGE = BRANCH ENTERED                                       01753502
*                                                                       01763502
*02*     INPUT = REGISTER  0     IRRELEVANT                             01773502
*                REGISTER  1     SRB ADDRESS                            01783502
*                REGISTERS 2-5   IRRELEVANT                             01793502
*                REGISTER  6     DEVICE ADDRESS                         01803502
*                REGISTERS 7-9   IRRELEVANT                             01813502
*                REGISTER  10    ENTRY POINT ADDRESS                    01823502
*                REGISTER  11    RETURN ADDRESS                         01833502
*                REGISTER  12    CONDITION CODE                         01843502
*                REGISTERS 13-15 IRRELEVANT                             01853502
*                                                                       01863502
*02*     OUTPUT = TRACE TABLE ENTRY (SEE FORMATS AT END OF              01873502
*                 PROLOG) AND UPDATED CURRENT TRACE TABLE               01883502
*                 ENTRY POINTER                                         01893502
*                                                                       01903502
*02*     REGISTERS-SAVED = REGISTERS 11-15 ARE SAVED IN THE             01913502
*                          CPU RELATED SAVE AREA POINTED TO             01923502
*                          BY WSACCWSA. REGISTER 8 IS SAVED             01933502
*                          IN THE PSA (PSAGPREG)                        01943502
*                                                                       01953502
*02*     REGISTER-USAGE = REFER TO 'REGISTER EQUATES' PORTION           01963502
*                         OF THIS MODULE                                01973502
*                                                                       01983502
*02*     REGISTERS-RESTORED = REGISTERS 8,11-15                         01993502
*                                                                       02003502
*01*  ENTRY-POINT = TRDISP                                              02013502
*                                                                       02023502
*02*     PURPOSE = RECORD TASK/RB DISPATCH IN TRACE TABLE               02033502
*                                                                       02043502
*02*     LINKAGE = BRANCH ENTERED                                       02053502
*                                                                       02063502
*02*     INPUT = REGISTERS 0-1   - AS AT DISPATCH                       02073502
*                REGISTERS 2-9   - IRRELEVANT                           02083502
*                REGISTER  10    - ENTRY POINT ADDRESS                  02093502
*                REGISTER  11    - RETURN ADDRESS                       02103502
*                REGISTERS 12-14 - IRRELEVANT                           02113502
*                REGISTER  15    - AS AT DISPATCH                       02123502
*                                                                       02133502
*02*     OUTPUT = TRACE TABLE ENTRY (SEE FORMATS AT END OF              02143502
*                 PROLOG) AND UPDATED CURRENT TRACE TABLE               02153502
*                 ENTRY POINTER                                         02163502
*                                                                       02173502
*02*     REGISTERS-SAVED = REGISTERS 11-15 ARE SAVED IN THE             02183502
*                          CPU RELATED SAVE AREA POINTED TO             02193502
*                          BY WSACCWSA. REGISTER 8 IS SAVED             02203502
*                          IN THE PSA (PSAGPREG)                        02213502
*                                                                       02223502
*02*     REGISTER-USAGE = REFER TO 'REGISTER EQUATES' PORTION           02233502
*                         OF THIS MODULE                                02243502
*                                                                       02253502
*02*     REGISTERS-RESTORED = REGISTERS 8,11-15                         02263502
*                                                                       02273502
*01*  ENTRY-POINT = TRSRB1                                              02283502
*                                                                       02293502
*02*     PURPOSE = RECORD EVENT DISPATCH IN TRACE TABLE                 02303502
*                                                                       02313502
*02*     LINKAGE = BRANCH ENTERED                                       02323502
*                                                                       02333502
*02*     INPUT = REGISTER  0     - SRB ADDRESS                          02343502
*                REGISTER  1     - PARAMETER AREA ADDRESS               02353502
*                REGISTERS 2-9   - IRRELEVANT                           02363502
*                REGISTER  10    - ENTRY POINT ADDRESS                  02373502
*                REGISTER  11    - RETURN ADDRESS                       02383502
*                REGISTERS 12-15 - IRRELEVANT                           02393502
*                                                                       02403502
*02*     OUTPUT = TRACE TABLE ENTRY (SEE FORMATS AT END OF              02413502
*                 PROLOG) AND UPDATED CURRENT TRACE TABLE               02423502
*                 ENTRY POINTER                                         02433502
*                                                                       02443502
*02*     REGISTERS-SAVED = REGISTERS 11-15 ARE SAVED IN THE             02453502
*                          CPU RELATED SAVE AREA POINTED TO             02463502
*                          BY WSACCWSA. REGISTER 8 IS SAVED             02473502
*                          IN THE PSA (PSAGPREG)                        02483502
*                                                                       02493502
*02*     REGISTER-USAGE = REFER TO 'REGISTER EQUATES' PORTION           02503502
*                         OF THIS MODULE                                02513502
*                                                                       02523502
*02*     REGISTERS-RESTORED = REGISTERS 8,11-15                         02533502
*                                                                       02543502
*01*  ENTRY-POINT = TRSRB2                                              02553502
*                                                                       02563502
*02*     PURPOSE = RECORD EVENT REDISPATCH IN TRACE TABLE               02573502
*                                                                       02583502
*02*     LINKAGE = BRANCH ENTERED                                       02593502
*                                                                       02603502
*02*     INPUT = REGISTERS 0-9   - IRRELEVANT                           02613502
*                REGISTER  10    - ENTRY POINT ADDRESS                  02623502
*                REGISTER  11    - RETURN ADDRESS                       02633502
*                REGISTER  12-15 - IRRELEVANT                           02643502
*                                                                       02653502
*02*     OUTPUT = TRACE TABLE ENTRY (SEE FORMATS AT END OF              02663502
*                 PROLOG) AND UPDATED CURRENT TRACE TABLE               02673502
*                 ENTRY POINTER                                         02683502
*                                                                       02693502
*02*     REGISTERS-SAVED = REGISTERS 11-15 ARE SAVED IN THE             02703502
*                          CPU RELATED SAVE AREA POINTED TO             02713502
*                          BY WSACCWSA. REGISTER 8 IS SAVED             02723502
*                          IN THE PSA (PSAGPREG)                        02733502
*                                                                       02743502
*02*     REGISTER-USAGE = REFER TO 'REGISTER EQUATES' PORTION           02753502
*                         OF THIS MODULE                                02763502
*                                                                       02773502
*02*     REGISTER-RESTORED = REGISTERS 8,11-15                          02783502
*                                                                       02793502
*                                                                       02803502
*01*  EXIT-NORMAL = POSTCOM                                             02813502
*                                                                       02823502
*02*     CONDITIONS = RETURN TO CALLER VIA BRANCH                       02833502
*                                                                       02843502
*02*     OUTPUT = SEE FORMATS OF TRACE TABLE ENTRIES                    02853502
*                 AT END OF PROLOG                                      02863502
*                                                                       02873502
*                 REGISTERS - SAME CONTENTS AS AT ENTRY                 02883502
*                                                                       02893502
*                                                                       02903502
*02*     RETURN-CODES = NONE                                            02913502
*                                                                       02923502
*01*  EXIT-ERROR = NONE                                                 02933502
*                                                                       02943502
*02*     CONDITIONS = N/A                                               02953502
*                                                                       02963502
*02*     OUTPUT = N/A                                                   02973502
*                                                                       02983502
*02*     RETURN-CODES = N/A                                             02993502
*                                                                       03003502
*01*  EXTERNAL-REFERENCES                                               03013502
*                                                                       03023502
*02*     ROUTINES = NONE                                                03033502
*                                                                       03043502
*02*     DATA-AREAS = TRACE TABLE HEADER - CURRENT, FIRST, LAST         03053502
*                     TRACE TABLE ENTRIES - REFLECT TRACE RESULTS       03063502
*                                                                       03073502
*02*     CONTROL-BLOCKS = ASCB R                                        03083502
*                         FLC  R                                        03093502
*                         LCCA R                                        03103502
*                         PCCA R                                        03113502
*                         PSA  R,W                                      03123502
*                         RB   R                                        03133502
*                         SRB  R                                        03143502
*                         TCB  R                                        03153502
*                         TQE  R                                        03163502
*                         WSA  R,W                                      03173502
*                         IOSB R                               @Z40FPYJ 03178540
*                                                                       03183502
*01*  TABLES = NONE                                                     03193502
*                                                                       03203502
*01*  MACROS = NONE                                                     03213502
*                                                                       03223502
*02*     SERIALIZATION = COMPARE-AND-SWAP DONE ON CURRENT               03233502
*                        TRACE TABLE ENTRY POINTER. NO LOCKS            03243502
*                        OR ENQUES ARE NEEDED. THE REGISTER             03253502
*                        SAVE AREA IN THE PSA IS SERIALIZED             03263502
*                        BY DISABLEMENT                                 03273502
*                                                                       03283502
*01*  CHANGE-ACTIVITY = Y02136                                          03293502
*                       Y02139                                          03303502
*                       DCRR 20889                                      03313502
*                       YM01922                                         03323502
*                       YM02115                                         03333502
*                                                                       03343502
*01*  MESSAGES = NONE                                                   03353502
*                                                                       03363502
*01*  ABEND-CODES = NONE                                                03373502
*                                                                       03383502
**** END OF SPECIFICATIONS */                                           03393502
         EJECT                                                          03403502
* NOTE THAT THE IDENTIFIER IS IN THE PSW FOR EXTERNAL, I/O, SVC, AND    04183802
* PROGRAM INTERRUPT AND DISPATCHER TRACES. IT IS LOCATED IN BIT         05183802
* POSITIONS 17-19 OF THE PSW.                                           06183802
         SPACE 3                                                        09100001
* EXTERNAL INTERRUPT                                                    09150001
         SPACE                                                          09200001
* .................................................................     09250001
* .               .       .       .       .       .       .       .     09300001
* .    EXTERNAL   .  REG  .  REG  .  REG  . CPUID .CURRENT. TIMER .     09350002
* .     OLD PSW   .   15  .   0   .   1   . & ASID. OR TQE. VALUE .     09400002
* . IDENTIFIER= 1 .       .       .       .       . TCB   .       .     09450002
* .               .       .       .       .       .       .       .     09500002
* .0.......4.......8.......C.......0.......4.......8.......C.......     09550001
         SPACE 3                                                        09600001
* I/O INTERRUPT                                                         09650001
         SPACE                                                          09700001
* .................................................................     09750001
* .               .               .       .       .       .       .     09800001
* .      I/O      .      CSW      . RE-   . CPUID .CURRENT. TIMER .     09850002
* .    OLD PSW    .               . SERVED. & ASID. TCB   . VALUE .     09900002
* . IDENTIFIER= 5 .               . (ZERO).       .       .       .     09950002
* .               .               .       .       .       .       .     10000001
* .0.......4.......8.......C.......0.......4.......8.......C.......     10050001
         SPACE 3                                                        10100001
* PROGRAM INTERRUPT                                                     10150001
         SPACE                                                          10200001
* .................................................................     10250001
* .               .       .       .       .       .       .       .     10300001
* .      PI       .       . TRANS .       .       .       .       .     10350002
* .    OLD PSW    .  REG  . EXCEPT.  REG  . CPUID .CURRENT. TIMER .     10400002
* . IDENTIFIER= 3 .   15  . ADDR  .   1   . & ASID.  TCB  . VALUE .     10450002
* .               .       .       .       .       .       .       .     10500001
* .0.......4.......8.......C.......0.......4.......8.......C.......     10550001
         EJECT                                                          10600001
* SVC INTERRUPT                                                         10650001
         SPACE                                                          10700001
* .................................................................     10750001
* .               .       .       .       .       .       .       .     10800001
* .      SVC      .  REG  .  REG  .  REG  . CPUID .CURRENT. TIMER .     10850002
* .    OLD PSW    .   15  .   0   .   1   . & ASID.  TCB  . VALUE .     10900002
* . IDENTIFIER= 2 .       .       .       .       .       .       .     10950001
* .               .       .       .       .       .       .       .     11000001
* .0.......4.......8.......C.......0.......4.......8.......C.......     11050001
         SPACE 3                                                        11100001
* START I/O    IDENTIFIER = 0                                           11150002
         SPACE                                                          11200001
* .................................................................     11250001
* .   .   .       .               .       .       .       .       .     11300002
* . C . D .  CAW  .      CSW      . IOSB  . CPUID . TCB   . TIMER .     11460002
* . C . E .       .               . FROM  . & ASID. FROM  . VALUE .     11470002
* .   . V .       .               . IOS   .       . SRB   .       .     11480002
* .   .   .       .               .       .       .       .       .     11500002
* .0.......4.......8.......C.......0.......4.......8.......C.......     11550001
         SPACE 3                                                        11600001
* TASK DISPATCHER                                                       11650002
         SPACE                                                          11700001
* .................................................................     11750001
* .               .       .       .       .       .       .       .     11800001
* . NEW PSW TO BE .  REG  .  REG  .  REG  . CPUID .  NEW  . TIMER .     11850002
* .    LOADED     .   15  .   0   .   1   . & ASID.  TCB  . VALUE .     11900002
* . IDENTIFIER= 7 . (NEW) . (NEW) . (NEW) .       .       .       .     11950001
* .               .       .       .       .       .       .       .     12000001
* .0.......4.......8.......C.......0.......4.......8.......C.......     12050001
         SPACE 3                                                        12092402
* EVENT DISPATCHER                                                      12092802
         SPACE                                                          12093202
* .................................................................     12093602
* .               .       .       .       .       .       .       .     12093702
* . NEW PSW TO BE . ZERO  .  SRB  . PARAM . CPUID . TCB   . TIMER .     12094002
* .    LOADED     . & ASID. ADDR. .  LIST . & ASID. FOR   . VALUE .     12095002
* . IDENTIFIER=   .       .  OR   .  ADDR..       . PURGE .       .     12096002
* .    4 OR 6     .       . REG 0 .   OR  .       .       .       .     12096902
* .               .       .       . REG 1 .       .       .       .     12097802
* .0.......4.......8.......C.......0.......4.......8.......C.......     12098802
         EJECT                                                          12118802
         ENTRY TREX,TRPI,TRSVC,TRIO,TRDISP,TRSIO,TRACE,TRSRB1,TRSRB2    12150002
         ENTRY TRCEEND,TRCOM1,TRCOM2  SEE                      @ZA16400 12160040
*                                  'OPERATION' IN THE PROLOG   @ZA16400 12170040
*                                  FOR AN EXPLANATION OF THESE @ZA16400 12180040
*                                  ENTRIES                     @ZA16400 12190040
         SPACE  3                                                       12200001
*        REGISTER EQUATES                                               12250001
         SPACE 3                                                        12300001
R0       EQU   0                   REG 0                                12350001
R1       EQU   1                   REG 1                                12400001
R6       EQU   6                   REG 6                                12450001
R8       EQU   8                   REG 8                         Y02139 12452002
RA       EQU   10                  REG 10                               12500001
R11      EQU   11                  REG 11                               12550002
RC       EQU   12                  REG 12                               12600001
RD       EQU   13                  REG 13                               12650001
RE       EQU   14                  REG 14                               12700001
RF       EQU   15                  REG 15                               12750001
XTRBASE  EQU   10                  BASE REG FOR MAINLINE CODE           12800001
XRET     EQU   11                  RETURN REGISTER AND BASE FOR         12850001
*                                  INTERNAL SUBROUTINES                 12900001
TRPTRG   EQU   12                  TRACE TABLE ENTRY POINTER            12950001
TRTAPTR  EQU   13                  POINTER TO TRACE HEADER              13000001
         SPACE 3                                                        13100001
*        COUNT FIELD EQUATES                                            13150001
C1       EQU   1                   BYTE                                 13200001
C2       EQU   2                   HALF WORD                            13250001
C3       EQU   3                   THREE BYTES                          13300001
C4       EQU   4                   FULL WORD                            13350001
C8       EQU   8                   DOUBLEWORD                           13400001
         EJECT                                                          13450002
*        GENERAL EQUATES                                                13500001
         SPACE 1                                                        13550001
ENTLEN   EQU   32                  LENGTH OF A TRACE TABLE ENTRY        13600001
PSW      EQU   0                   PSW OFFSET IN TABLE ENTRY            13650001
T        EQU   2                   OFFSET FOR ENTRY TYPE                13700001
ECCCPM   EQU   2                   OFFSET FOR EC MODE COND CODE         13750001
*                                  AND PROGRAM MASK                     13800001
BCCCPM   EQU   4                   OFFSET FOR BC MODE COND CODE         13850001
*                                  AND PROGRAM MASK                     13900001
BCINTCOD EQU   2                   OFFSET FOR BC MODE INT. CODE         13950001
ILC      EQU   4                   OFFSET OF ILC IN BC MODE PSW         14000001
REG      EQU   8                   REG OFFSET IN TABLE ENTRY            14050001
REGF     EQU   8                   REG 15 OFFSET - TABLE ENTRY @YM01922 14060002
REG0     EQU   12                  REG 0 OFFSET IN TABLE ENTRY @YM01922 14068002
LOC90    EQU   12                  TRANSLATION EXCEPTION ADDR  @YM01922 14076002
*                                  OFFSET IN TABLE ENTRY       @YM01922 14084002
REG1     EQU   16                  REG 1 OFFSET IN TABLE ENTRY @YM01922 14092002
DEV      EQU   0                   DEVICE FIELD OFFSET IN ENTRY         14100001
CAW      EQU   4                   CAW OFFSET IN ENTRY                  14150001
CSW      EQU   8                   CSW OFFSET IN TABLE ENTRY            14200001
TRCIOSB  EQU   16                  IOSB ADDR OFFSET IN ENTRY     Y02136 14202002
TRCSTOP  EQU   20                  OFFSET FOR 'TRACE STOPPED' FLAG      14210001
TRCCPUID EQU   20                  OFFSET TO CPUID IN ENTRY    @Z40FPYJ 14240040
TRCASIDF EQU   22                  OFFSET TO ASID IN ENTRY       Y02139 14242002
TCBF     EQU   24                  OFFSET TO TCB ADDR IN ENTRY          14250001
TIMESTMP EQU   28                  OFFSET TO TIME STAMP IN TABLE ENTRY  14300001
ILCRIGHT EQU   17                  VALUE TO SHIFT ILC TO RIGHT JUSTIFY  14350001
ILCLEFT  EQU   6                   VLAUE TO POSITION ILC FOR EXEC OF OI 14400001
ON       EQU   255                 MASK OF ALL ONES                     14450001
M3       EQU   3                   MASK FOR ICM OF BYTES 2,3 OF REG     14500001
M4       EQU   4                   MASK FOR ICM OF BYTE 1 OF REG        14550001
TWO      EQU   2                   VALUE OF TWO                         14750001
X0F      EQU   X'0F'               MASK TO CLEAR TYPE CODE AREA         14770001
X7F      EQU   X'7F'               MASK TO CLEAR HIGH BIT OF BYTE       14780001
TRON     EQU   X'80'               MASK TO FLAG CPU WAITING    @Z40FPYJ 14790040
         EJECT                                                          14800002
*        ENTRY TYPE CODES                                               14850001
         SPACE 1                                                        14900001
SVCCODE  EQU   X'20'               SVC ENTRY                            14950001
EXTCODE  EQU   X'10'               EXTERNAL INTERRUPT ENTRY             15000001
IOCODE   EQU   X'50'               I/O INTERRUPT ENTRY                  15050001
PGMCODE  EQU   X'30'               PROGRAM INTERRUPT ENTRY              15100001
SIOCODE  EQU   X'00'               START I/O ENTRY                      15150001
DSPCODE  EQU   X'70'               TASK DISPATCHER ENTRY                15200002
SRBCODE1 EQU   X'40'               EVENT DISPATCHER ENTRY        Y02139 15210002
*                                   FOR DISPATCH OF NEW SRB             15220002
SRBCODE2 EQU   X'60'               EVENT DISPATCHER ENTRY        Y02139 15260002
*                                   FOR REDISPATCH OF SUSPENDED SRB     15270002
         SPACE 3                                                        15300001
BEGIN    EQU   *                   LABEL USED ONLY FOR TESTING PURPOSES 15302002
         SPACE 3                                                        15310002
         USING FLC,0                                                    15350002
         USING STORAGE,R8                                        Y02139 15360002
         EJECT                                                          15400002
***      TRACE ENTRY FOR SVC INTERRUPTS                                 15450001
         SPACE 1                                                        15500001
         CNOP  0,8                                                      15520040
         USING *,XTRBASE                                                15550001
TRSVC    BAL   XTRBASE,PRECOM      INITIAL PHASE                 Y02136 15650002
         USING *,XTRBASE                                                15700001
*        RETURN FROM COMMON SUBROUTINE                                  15750001
         LD    R0,SVCOPSW          TRACE SVC                   @Z40FPYJ 15800040
         STD   R0,PSW(TRPTRG)      OLD PSW                     @Z40FPYJ 15810040
         L     RF,FLCSVILC-C1      GET ILC AND INTERRUPT CODE           15850001
* PUT CC AND PROGRAM MASK IN THEIR BC MODE POSITIONS           @Z40FPYJ 15900040
         IC    XRET,PSW+ECCCPM(TRPTRG)                         @Z40FPYJ 15905040
         STC   XRET,PSW+BCCCPM(TRPTRG)                         @Z40FPYJ 15910040
         STH   RF,PSW+BCINTCOD(TRPTRG) INT. CODE IN BC MODE    @Z40FPYJ 15915040
         NI    PSW+T(TRPTRG),X0F   CLEAR  TYPE CODE FIELD      @Z40FPYJ 15920040
         SRL   RF,ILCRIGHT         POSITION ILC                @Z40FPYJ 15925040
         SLL   RF,ILCLEFT          IN REG  15 FOR              @Z40FPYJ 15930040
         EX    RF,ILCINPSW         EXECUTE  INTO TRACE PSW     @Z40FPYJ 15935040
         ST    R0,REG0(TRPTRG)     PLACE REG 0 IN TABLE ENTRY  @YM01922 16000002
SV1      OI    PSW+T(TRPTRG),SVCCODE    SET THE ENTRY TYPE              16200002
SV2      LA    XTRBASE,COMBASE     ADJUST BASE REGISTER FOR COMMON      16250001
*                                  CODE                                 16300001
         USING COMBASE,XTRBASE                                          16350001
         B     TRCOMM              GO TO COMMON TRACE ROUTINE           16400001
         USING SV1,XTRBASE                                              16410001
         EJECT                                                          16550002
***      TRACE ENTRY FOR I/O INTERRUPTS                                 16600001
         CNOP  0,8                                             @Z40FPYJ 16620040
         SPACE 1                                                        16650001
         USING *,XTRBASE                                                16700001
TRIO     BAL   XTRBASE,PRECOM      INITIAL PHASE                 Y02136 16800002
         USING *,XTRBASE           ADJUST BASE REG                      16850001
         LD    R0,IOOPSW                TRACE I/O              @Z40FPYJ 16900040
         STD   R0,PSW(TRPTRG)           OLD PSW                @Z40FPYJ 16907040
         IC    XRET,PSW+ECCCPM(TRPTRG)  SHIFT THE CC           @Z40FPYJ 16914040
         STC   XRET,PSW+BCCCPM(TRPTRG)    AND PRG MASK         @Z40FPYJ 16921040
         L     RF,FLCIOA                                       @Z40FPYJ 16928040
         STH   RF,PSW+BCINTCOD(TRPTRG)  DEV ADDRESS            @Z40FPYJ 16935040
         OI    PSW+T(TRPTRG),IOCODE     SET TYPE CODE                   17300001
         LD    R0,FLCCSW                TRACE                  @Z40FPYJ 17440040
         STD   R0,CSW(TRPTRG)           CSW                    @Z40FPYJ 17440140
         L     RF,PSATOLD               TRACE                  @Z40FPYJ 17440440
         ST    RF,TCBF(TRPTRG)          OLD TCB                @Z40FPYJ 17440940
         L     RD,PSAAOLD          ADDRESS OLD ASCB              Y02139 17444002
         USING ASCB,RD                                           Y02139 17446002
         LH    RF,ASCBASID              TRACE                  @Z40FPYJ 17448040
         STH   RF,TRCASIDF(TRPTRG)        ASID                 @Z40FPYJ 17448340
         DROP  RD                                                Y02139 17448402
         SLR   RF,RF               CLEAR                       @Z40FPYJ 17448840
         ST    RF,TRCIOSB(TRPTRG)    RSVD FIELD                @Z40FPYJ 17468840
         LD    R0,TRFP0            RESTORE FP REG              @ZA16400 17478840
         LM    R11,RF,TREGSV       RESTORE CALLERS             @Z40FPYJ 17508840
         L     R8,PSAGPREG            REGISTERS                @Z40FPYJ 17528840
         BR    XRET                RETURN  TO CALLER           @Z40FPYJ 17548840
         EJECT                                                 @Z40FPYJ 17600040
***      TRACE ENTRY FROM SIO                                           17650001
         CNOP  0,8                                             @Z40FPYJ 17670040
         USING *,XTRBASE                                                17700001
TRSIO    BAL   XTRBASE,PRECOM      INITIAL PHASE                 Y02136 17800002
TRACE    EQU   TRSIO               NAME USED BY SVM IOS SIO ROUTINE     17810002
*        RETURN FROM COMMON ROUTINE                                     17850001
         USING *,XTRBASE                                                17900001
         ST    R6,DEV(TRPTRG)      STORE DEVICE                         17950001
         L     RF,TREGSV12         GET CC REG                  @Z40FPYJ 18002040
         N     RF,CC               LEAVE CC                    @Z40FPYJ 18003040
         STC   RF,DEV(TRPTRG)      TRACE CC                    @Z40FPYJ 18004040
         L     RF,FLCCAW           TRACE                       @Z40FPYJ 18050040
         ST    RF,CAW(TRPTRG)        CAW                       @Z40FPYJ 18060040
         LD    R0,FLCCSW           TRACE                       @Z40FPYJ 18100040
         STD   R0,CSW(TRPTRG)        CSW                       @Z40FPYJ 18130040
         USING SRBSECT,R1                                        Y02139 18200402
         L     RF,SRBPTCB          TRACE                       @Z40FPYJ 18200840
         ST    RF,TCBF(TRPTRG)       PURGE TCB                 @Z40FPYJ 18200940
         L     RF,SRBPARM          TRACE                       @Z40FPYJ 18258040
         ST    RF,TRCIOSB(TRPTRG)    IOSB                      @Z40FPYJ 18261040
         USING IOSB,RF                                         @Z40FOYJ 18264040
         L     RF,IOSASID-C2       TRACE                       @Z40FPYJ 18265040
         STH   RF,TRCASIDF(TRPTRG)   ASID                      @Z40FPYJ 18266040
         DROP  R1                                                Y02139 18268002
***      NOTE --- TYPE CODE IS 0 SO IMPLICITLY SET                      18550001
         LD    R0,TRFP0            RESTORE FP REG              @ZA16400 18555040
         LM    R11,RF,TREGSV       RESTORE CALLERS             @Z40FPYJ 18570040
         L     R8,PSAGPREG            REGISTERS                @Z40FPYJ 18580040
         BR    XRET                RETURN  TO CALLER           @Z40FPYJ 18590040
         EJECT                                                          18650002
***      TRACE ENTRY FOR EXTERNAL INTERRUPT                             18700001
         CNOP  0,8                                             @Z40FPYJ 18720040
         SPACE 1                                                        18750001
         USING *,XTRBASE                                                18800001
TREX     BAL   XTRBASE,PRECOM2     INITIAL PHASE               @Z40FPYJ 18900040
         USING *,XTRBASE                                                18950001
BASE3    ST    R0,REG+4(TRPTRG)    TRACE REG 0                 @Z40FPYJ 19000040
         LD    R0,EXOPSW           LOAD EXTOPSW                @Z40FPYJ 19008040
         ST    RF,REG(TRPTRG)      TRACE REG 15                @Z40FPYJ 19016040
         STD   R0,PSW(TRPTRG)      TRACE EXT OPSW              @Z40FPYJ 19024040
         ST    R1,REG+8(TRPTRG)    TRACE REG 1                 @Z40FPYJ 19032040
         L     RF,FLCEICOD-C2      GET INT CODE AND PRECEEDING 0'S      19100001
*                                  FROM LOW CORE                        19150001
         LR    RE,RF               SAVE INTERRUPT CODE         Z40FPYJ  19170040
* PUT CC AND PROGRAM MASK IN THEIR BC MODE POSITIONS           @Z40FPYJ 19200040
         IC    XRET,PSW+ECCCPM(TRPTRG)                         @Z40FPYJ 19205040
         STC   XRET,PSW+BCCCPM(TRPTRG)                         @Z40FPYJ 19210040
         STH   RF,PSW+BCINTCOD(TRPTRG) INT. CODE IN BC MODE    @Z40FPYJ 19215040
         NI    PSW+T(TRPTRG),X0F   CLEAR  TYPE CODE FIELD      @Z40FPYJ 19220040
         SRL   RF,ILCRIGHT         POSITION ILC                @Z40FPYJ 19225040
         SLL   RF,ILCLEFT          IN REG  15 FOR              @Z40FPYJ 19230040
         EX    RF,ILCINPSW         EXECUTE  INTO TRACE PSW     @Z40FPYJ 19235040
         OI    PSW+T(TRPTRG),EXTCODE    INDICATE INTERRUPT TYPE         19500001
         CH    RE,COMPINTC         COMPARATOR INTERRUPT        @Z40FPYJ 19650040
         BNE   EXT5                NO, TRACE CURRENT TCB AND ASID       19700002
         L     XRET,PSAPCCAV       YES, ADDRESS PCCA             Y02139 19750002
         USING PCCA,XRET                                         Y02139 19800002
         L     XRET,PCCATQEP       TRY TO ADDRESS TQE            Y02139 19810002
         LTR   XRET,XRET           HAS TQE BEEN PURGED           Y02139 19812002
         BZ    EXT4                YES, TRACE ZERO TCB ADDRESS AND ASID*19814002
                                                                 Y02139 19824002
         USING TQE,XRET                                                 19860002
         L     RF,TQETCB           TRACE                       @Z40FPYJ 19870040
         ST    RF,TCBF(TRPTRG)       TCB                       @Z40FPYJ 19873040
         LH    RF,TQEAID           TRACE                       @Z40FPYJ 19880040
         STH   RF,TRCASIDF(TRPTRG) ASID                        @Z40FPYJ 19883040
         DROP XRET                                                      19890002
         LD    R0,TRFP0            RESTORE FP REG              @ZA16400 19895040
         LM    R11,RF,TREGSV       RESTORE CALLERS             @Z40FPYJ 19940040
         L     R8,PSAGPREG            REGISTERS                @Z40FPYJ 19980040
         BR    XRET                RETURN  TO CALLER           @Z40FPYJ 20020040
         CNOP  0,8                                                      20060040
EXT4     ST    XRET,TCBF(TRPTRG)   TRACE ZERO TCB ADDRESS        Y02139 20160002
         STH   XRET,TRCASIDF(TRPTRG) TRACE ZERO ASID             Y02139 20162002
         LD    R0,TRFP0            RESTORE FP REG              @ZA16400 20166040
         LM    R11,RF,TREGSV       RESTORE CALLERS             @Z40FPYJ 20171040
         L     R8,PSAGPREG            REGISTERS                @Z40FPYJ 20172040
         BR    XRET                RETURN  TO CALLER           @Z40FPYJ 20173040
         CNOP  0,8                                                      20174040
         SPACE 1                                                        20175040
EXT5     L     RF,PSATOLD          TRACE                       @Z40FPYJ 20180040
         ST    RF,TCBF(TRPTRG)       TCB                       @Z40FPYJ 20180640
         L     RD,PSAAOLD          ADDRESS ASCB                  Y02139 20182002
         USING ASCB,RD                                           Y02139 20184002
         LH    RF,ASCBASID         TRACE                       @Z40FPYJ 20186040
         STH   RF,TRCASIDF(TRPTRG)   ASID                      @Z40FPYJ 20186640
         DROP  RD                                                Y02139 20188002
         LD    R0,TRFP0            RESTORE FP REG              @ZA16400 20188240
         LM    R11,RF,TREGSV       RESTORE CALLERS             @Z40FPYJ 20188840
         L     R8,PSAGPREG            REGISTERS                @Z40FPYJ 20189240
         BR    XRET                RETURN  TO CALLER           @Z40FPYJ 20189640
         EJECT                                                          20400002
***      TRACE ENTRY FOR TASK DISPATCHER                                20450002
         CNOP  0,8                                             @Z40FPYJ 20470040
         SPACE 1                                                        20500001
         USING *,XTRBASE                                                20550001
TRDISP   BAL   XTRBASE,PRECOM3     INITIAL PHASE               @Z40FPYJ 20650040
         USING *,XTRBASE                                                20700001
BASE2    ST    R0,REG+4(TRPTRG)    TRACE 0,                    @Z40FPYJ 20750040
         LD    R0,PSAPSWSV         GET PSW                     @Z40FPYJ 20770040
         ST    RF,REG(TRPTRG)      TRACE REG 15                @Z40FPYJ 20810040
         STD   R0,PSW(TRPTRG)      TRACE PSW                   @Z40FPYJ 20840040
         ST    R1,REG+8(TRPTRG)    TRACE REG 1                 @Z40FPYJ 20870040
         L     RD,PSATOLD          GET TCB ADDRESS           DCRR 20889 20980002
         LTR   RD,RD               IS TCB AVAILABLE?           @YM02115 20980202
         BNZ   FINDRB              BRANCH WHEN AVAILABLE       @YM02115 20980402
         SR    RF,RF               INDICATE NO ILC OR          @YM02115 20980602
*                                  INTERRUPT CODE AVAILABLE    @YM02115 20980802
         B     CONVPSW             GO CONVERT PSW              @YM02115 20981002
         CNOP  0,8                                             @Z40FPYJ 20981140
FINDRB   EQU   *                   USED ONLY WHEN TCB          @YM02115 20981202
*                                  ADDRESS IS AVAILABLE        @YM02115 20981402
         USING TCB,RD                                        DCRR 20889 20982002
         L     RD,TCBRBP           GET RB ADDR FROM TCB      DCRR 20889 20990002
         DROP  RD                                            DCRR 20889 20990402
         S     RD,RBPFXLEN         GET START OF PREFIX       DCRR 20889 20992002
         USING RBPRFXST,RD                                   DCRR 20889 20994002
         L     RF,RBINLNTH-C1      GET ILC AND CODE            @Z40FPYJ 20996040
CONVPSW  EQU   *                   USED ONLY WHEN TCB          @YM02115 20998602
*                                  ADDRESS IS NOT AVAILABLE    @YM02115 20999202
* PUT CC AND PROGRAM MASK IN THEIR BC MODE POSITIONS           @Z40FPYJ 21000040
         IC    XRET,PSW+ECCCPM(TRPTRG)                         @Z40FPYJ 21010040
         STC   XRET,PSW+BCCCPM(TRPTRG)                         @Z40FPYJ 21020040
         STH   RF,PSW+BCINTCOD(TRPTRG) INT. CODE IN BC MODE    @Z40FPYJ 21030040
         NI    PSW+T(TRPTRG),X0F   CLEAR  TYPE CODE FIELD      @Z40FPYJ 21040040
         SRL   RF,ILCRIGHT         POSITION ILC                @Z40FPYJ 21050040
         SLL   RF,ILCLEFT          IN REG  15 FOR              @Z40FPYJ 21060040
         EX    RF,ILCINPSW         EXECUTE  INTO TRACE PSW     @Z40FPYJ 21070040
         OI    PSW+T(TRPTRG),DSPCODE    INSERT ENTRY TYPE               21696002
         L     RF,PSATOLD          TRACE                       @Z40FPYJ 21698040
         ST    RF,TCBF(TRPTRG)       TCB                       @Z40FPYJ 21698140
         L     RD,PSAAOLD          ADDRESS ASCB                  Y02139 21698802
         USING ASCB,RD                                           Y02139 21699202
         LH    RF,ASCBASID         TRACE                       @Z40FPYJ 21699640
         STH   RF,TRCASIDF(TRPTRG)   ASID                      @Z40FPYJ 21705940
         DROP  RD                                                Y02139 21706940
         LD    R0,TRFP0            RESTORE FP REG              @ZA16400 21707440
         LM    R11,RF,TREGSV       RESTORE CALLERS             @Z40FPYJ 21715940
         L     R8,PSAGPREG            REGISTERS                @Z40FPYJ 21723940
         BR    XRET                RETURN  TO CALLER           @Z40FPYJ 21731940
         EJECT                                                          21750002
***      TRACE ENTRY FOR EVENT DISPATCHER                        Y02139 21890402
***      ON INITIAL DISPATCH OF SRB                              Y02139 21890802
         CNOP  0,8                                             @Z40FPYJ 21891040
         SPACE 1                                                        21891202
         USING *,XTRBASE                                                21891602
TRSRB1   BAL   XTRBASE,PRECOM      INITIAL PHASE                        21891702
         USING *,XTRBASE                                                21891802
         ST    R0,REG+4(TRPTRG)    TRACE REG 0                 @Z40FPYJ 21893140
         LD    R0,PSAPSWSV         TRACE                       @Z4OFPYJ 21894140
         STD   R0,PSW(TRPTRG)        PSW                       @Z40FPYJ 21896140
         ST    R1,REG+8(TRPTRG)    TRACE REG 1                 @Z40FPYJ 21896540
         SR    RF,RF               INDICATE ZERO ILC AND INTCOD         21897402
* PUT CC AND PROGRAM MASK IN THEIR BC MODE POSITIONS           @Z40FPYJ 21898440
         IC    XRET,PSW+ECCCPM(TRPTRG)                         @Z40FPYJ 21898540
         STC   XRET,PSW+BCCCPM(TRPTRG)                         @Z40FPYJ 21898640
         STH   RF,PSW+BCINTCOD(TRPTRG) INT. CODE IN BC MODE    @Z40FPYJ 21898740
         NI    PSW+T(TRPTRG),X0F   CLEAR  TYPE CODE FIELD      @Z40FPYJ 21898840
         SRL   RF,ILCRIGHT         POSITION ILC                @Z40FPYJ 21898940
         SLL   RF,ILCLEFT          IN REG  15 FOR              @Z40FPYJ 21899040
         EX    RF,ILCINPSW         EXECUTE  INTO TRACE PSW     @Z40FPYJ 21899140
         OI    PSW+T(TRPTRG),SRBCODE1    INSERT ENTRY TYPE              21906602
         L     RD,PSAAOLD          ADDRESS ASCB                         21908602
         USING ASCB,RD                                                  21909002
         LH    RD,ASCBASID         GET OLD ASID                         21909402
         DROP  RD                                                       21909502
         ST    RD,REG(TRPTRG)      TRACE OLD ASID                       21909702
         LR    RE,R0               ADDRESS SRB                          21909802
         USING SRBSECT,RE                                               21910102
         L     RF,SRBPASID-C2      TRACE                      @Z40FPYJ  21911140
         STH   RF,TRCASIDF(TRPTRG)   PURGE ASID               @Z40FPYJ  21911240
         L     RF,SRBPTCB          TRACE                       @Z40FPYJ 21911540
         ST    RF,TCBF(TRPTRG)       TCB                       @Z40FPYJ 21911840
         DROP  RE                                                       21912840
         LD    R0,TRFP0            RESTORE FP REG              @ZA16400 21913040
         LM    R11,RF,TREGSV       RESTORE CALLERS             @Z40FPYJ 21913440
         L     R8,PSAGPREG            REGISTERS                @Z40FPYJ 21913840
         BR    XRET                RETURN  TO CALLER           @Z40FPYJ 21914040
         SPACE 3                                                        21914202
***      TRACE ENTRY FOR EVENT DISPATCHER                        Y02139 21915402
***      ON REDISPATCH OF SUSPENDED SRB                          Y02139 21918202
         CNOP  0,8                                             @Z40FPYJ 21919240
         SPACE 1                                                        21921002
         USING *,XTRBASE                                                21923802
TRSRB2   BAL   XTRBASE,PRECOM      INITIAL PHASE                        21935202
         USING *,XTRBASE                                                21937202
         ST    R0,REG+4(TRPTRG)    TRACE REG 0                 @Z40FPYJ 21937340
         LD    R0,PSAPSWSV         TRACE                       @Z40FPYJ 21937440
         STD   R0,PSW(TRPTRG)        PSW                       @Z40FPYJ 21937540
         ST    R1,REG+8(TRPTRG)    TRACE REG 1                 @Z40FPYJ 21937640
         SR    RF,RF               INDICATE ZERO ILC AND INTCOD         21938002
* PUT CC AND PROGRAM MASK IN THEIR BC MODE POSITIONS           @Z40FPYJ 21938240
         IC    XRET,PSW+ECCCPM(TRPTRG)                         @Z40FPYJ 21941240
         STC   XRET,PSW+BCCCPM(TRPTRG)                         @Z40FPYJ 21944240
         STH   RF,PSW+BCINTCOD(TRPTRG) INT. CODE IN BC MODE    @Z40FPYJ 21947240
         NI    PSW+T(TRPTRG),X0F   CLEAR  TYPE CODE FIELD      @Z40FPYJ 21950240
         SRL   RF,ILCRIGHT         POSITION ILC                @Z40FPYJ 21953240
         SLL   RF,ILCLEFT          IN REG  15 FOR              @Z40FPYJ 21956240
         EX    RF,ILCINPSW         EXECUTE  INTO TRACE PSW     @Z40FPYJ 21959240
         OI    PSW+T(TRPTRG),SRBCODE2    INSERT ENTRY TYPE              21976102
         L     RD,PSAAOLD          ADDRESS ASCB                         21976602
         USING ASCB,RD                                                  21976702
         LH    RD,ASCBASID         GET OLD ASID                         21976802
         DROP  RD                                                       21978002
         ST    RD,REG(TRPTRG)      TRACE OLD ASID                       21980002
         L     RD,PSALCCAV         ADDRESS LCCA                         21982002
         USING LCCA,RD                                                  21982102
         L     RF,LCCAPGTA-C2       TRACE                      @Z40FPYJ 21982340
         STH   RF,TRCASIDF(TRPTRG)     ASID                    @Z40FPYJ 21982440
         L     RD,LCCAPGTA+C2       TRACE                      @Z40FPYJ 21982540
         ST    RD,TCBF(TRPTRG)         TCB                     @Z40FPYJ 21982940
         DROP  RD                                                       21983040
         LD    R0,TRFP0            RESTORE FP REG              @ZA16400 21983240
         LM    R11,RF,TREGSV       RESTORE CALLERS             @Z40FPYJ 21983740
         L     R8,PSAGPREG            REGISTERS                @Z40FPYJ 21983940
         BR    XRET                RETURN  TO CALLER           @Z40FPYJ 21984140
         EJECT                                                          21984902
***      TRACE ENTRY FOR PROGRAM INTERRUPTS                             21988702
         CNOP  0,8                                             @Z40FPYJ 21993740
         SPACE 1                                                        22000001
         USING *,XTRBASE                                                22050001
TRPI     BAL   XTRBASE,PRECOM      INITIAL PHASE                 Y02139 22150002
         USING *,XTRBASE                                                22200001
         LD    R0,PIOPSW           TRACE                       @Z40FPYJ 22250040
         STD   R0,PSW(TRPTRG)        PSW                       @Z40FPYJ 22260040
         L     RF,FLCPIILC-C1      GET ILC,INT.CODE AND LEADING 0'S     22300001
* PUT CC AND PROGRAM MASK IN THEIR BC MODE POSITIONS           @Z40FPYJ 22350040
         IC    XRET,PSW+ECCCPM(TRPTRG)                         @Z40FPYJ 22355040
         STC   XRET,PSW+BCCCPM(TRPTRG)                         @Z40FPYJ 22360040
         STH   RF,PSW+BCINTCOD(TRPTRG) INT. CODE IN BC MODE    @Z40FPYJ 22365040
         NI    PSW+T(TRPTRG),X0F   CLEAR  TYPE CODE FIELD      @Z40FPYJ 22370040
         SRL   RF,ILCRIGHT         POSITION ILC                @Z40FPYJ 22375040
         SLL   RF,ILCLEFT          IN REG  15 FOR              @Z40FPYJ 22380040
         EX    RF,ILCINPSW         EXECUTE  INTO TRACE PSW     @Z40FPYJ 22385040
COMBASE  L     RF,FLCTEA           GET TRANSLATION EXCEPTION   @YM01922 22430002
*                                  ADDRESS                     @YM01922 22460002
         ST    RF,LOC90(TRPTRG)    PLACE IT IN TABLE ENTRY     @YM01922 22500002
         OI    PSW+T(TRPTRG),PGMCODE    SET ENTRY TYPE         @YM01922 22600002
         SPACE 3                                                        22750001
*        THIS PORTION COMMON TO SVC AND PROGRAM INTERRUPT CODE          22800001
         SPACE 1                                                        22850001
TRCOMM   ST    R1,REG1(TRPTRG)     PLACE REG 1 IN TABLE VALUE           22900040
         L     RF,TREGSV15         RESTORE 15 TO ENTRY VALUE            22930040
         ST    RF,REGF(TRPTRG)     PLACE REG 15 IN TABLE ENTRY          23000002
         L     RF,PSATOLD          TRACE                       @Z40FPYJ 23096040
         ST    RF,TCBF(TRPTRG)       TCB                       @Z40FPYJ 23096640
         L     RD,PSAAOLD          ADDRESS ASCB                  Y02139 23098402
         USING ASCB,RD                                           Y02139 23098802
         LH    RF,ASCBASID         TRACE                      @VS40131  23099240
         STH   RF,TRCASIDF(TRPTRG)   ASID                      @Z40FPYJ 23099540
         DROP  RD                                                Y02139 23099602
         LD    R0,TRFP0            RESTORE FP REG              @ZA16400 23099840
         LM    R11,RF,TREGSV       RESTORE CALLERS             @Z40FPYJ 23140040
         L     R8,PSAGPREG            REGISTERS                @Z40FPYJ 23180040
         BR    XRET                RETURN  TO CALLER           @Z40FPYJ 23220040
         EJECT                                                          23300002
***      PRECOMMON -- PERFORM INIT FOR ALL ENTRIES                      23350001
         CNOP  0,8                                             @Z40FPYJ 23370040
         SPACE 2                                                        23400001
TRCOM1   EQU   *                   BEGINNING OF CODE WHICH     @ZA16400 23410040
*                                  SAVES REGISTERS             @ZA16400 23420040
PRECOM   ST    R8,PSAGPREG         SAVE REG 8                    Y02136 23450002
*                                  THE ABOVE AREA CAN BE USED           23458002
*                                  BECAUSE TRACE MUST ALWAYS            23466002
*                                  BE ENTERED DISABLED                  23474002
PRECOMA  NI    FLCTRACE,X'FF'-TRON  TURN OFF CPU WAITING FLAG  @Z40FPYJ 23478040
PRECOMB  L     R8,PSALCCAV         ADDRESS LOGICAL CCA         @Z40FPYJ 23482040
         USING LCCA,R8                                           Y02136 23484002
         L     R8,LCCACPUS         ADDRESS WORK/SAVE AREA VT     Y02136 23486002
         USING WSAC,R8                                           Y02136 23488002
         L     R8,WSACCWSA         ADDRESS LOWEST LEVEL WSA      Y02136 23488402
         USING STORAGE,R8                                        Y02136 23490002
         STD   R0,TRFP0            SAVE FP REG                 @ZA16400 23491040
         STM   R11,RF,TREGSV       SAVE REGS 11 THRU 15                 23492002
TRCOM2   EQU   *                   END OF CODE WHICH SAVES     @ZA16400 23492640
*                                  REGISTERS                   @ZA16400 23493240
         BALR  XRET,0              SET BASE                             23494002
         USING *,XRET                                                   23500001
         L     TRTAPTR,FLCTRACE    GET ADDRESS OF TRACE HEADER          23600040
         USING TRHDR,TRTAPTR       GPR 13                               23650001
FCH      L     TRPTRG,TRPTR        GET ADDRESS OF CURRENT ENTRY  Y02136 23700002
RET1     LR    RE,TRPTRG           SAVE ADDRESS OF CURRENT ENTRY Y02136 23710040
         LA    TRPTRG,ENTLEN(TRPTRG)    POINT TO NEXT ENTRY             23750001
         CL    TRPTRG,TREND        ARE WE AT END OF TABLE               23800001
         BNL   TREOT               YES, GO WRAP AROUND                  23850001
STR      CS    RE,TRPTRG,TRPTR     NO, UPDATE THE POINTER        Y02136 23870002
         BNZ   FCH                 ANOTHER CPU UPDATED IT, RETRY Y02136 23930002
         STCK  CLOCK               STORE THE TOD CLOCK                  23950001
         BZ    GOODTIME            DID THE CLOCK WORK            Y02139 23960002
         XC    CLOCKV(C4),CLOCKV   NO, RECORD TIME ZERO          Y02139 23970002
GOODTIME MVC   TIMESTMP(C4,TRPTRG),CLOCKV    BYTES 2-5 OF CLOCK         24000002
         L     RE,PSACPUSA-C2      GET PHYSICAL CPU ADDR       @Z40FPYJ 24014040
         A     RE,LOGCPU           MAKE IT LOGICAL ADDR        @Z40FPYJ 24018040
         STH   RE,TRCCPUID(TRPTRG) TRACE IT AND CLEAR STOP FLG @Z40FPYJ 24022040
         BR    XTRBASE             RETURN TO CALLER                     24050001
TREOT    L     TRPTRG,TRBEG        RESET POINTER TO BEGIN OF TABLE      24100001
         B     STR                 BACK TO STORE IT                     24150001
TRCEEND  EQU   *              AS FAR AS IEAVESPR IS CONCERNED, @ZA16400 24156040
*                             THE END OF TRACE, BECAUSE THIS   @ZA16400 24162040
*                             IS THE HIGHEST INSTRUCTION ADDR. @ZA16400 24168040
*                             WHICH WILL BE EXECUTED WITHIN    @ZA16400 24174040
*                             TRACE AFTER REGISTERS HAVE BEEN  @ZA16400 24180040
*                             SAVED. (THE EXECUTED INSTR. IS   @ZA16400 24186040
*                             A TRIVIAL EXCEPTION.)            @ZA16400 24192040
         DROP  TRTAPTR                                                  24200001
         DROP  XRET                                                     24210002
         EJECT                                                 @Z40FPYJ 24250040
***      EXT   PRECOMMON - ELIMINATE ENTRIES WHILE WAITING     @Z40FPYJ 24251040
         CNOP  0,8                                             @Z40FPYJ 24252040
         SPACE 1                                               @Z40FPYJ 24253040
PRECOM2  ST    R8,PSAGPREG    SAVE REG 8                       @Z40FPYJ 24254040
         USING BASE3,XTRBASE                                   @Z40FPYJ 24254140
         TM    FLCTRACE,TRON  IS CPU WAITING?                  @Z40FPYJ 24254240
         BNO   PRECOMB        NO, GO TRACE                     @Z40FPYJ 24254340
         LH    R8,FLCEICOD    GET EXT.INT.CODE                 @Z40FPYJ 24254440
         CH    R8,COMPINTC    CLOCK COMP?                      @Z40FPYJ 24257840
         BNE   PRECOMA        NO, TRACE IT                     @Z40FPYJ 24258840
EXIT1    L     R8,PSAGPREG    RESTORE R8                       @Z40FPYJ 24259840
         BR    XRET           RETURN-NO TRACE                  @Z40FPYJ 24260840
         DROP  XTRBASE                                                  24261840
         SPACE 3                                               @Z40FPYJ 24270040
***      DISP  PRECOMMON  - ELIMINATE ENTRIES WHILE WAITING    @Z40FPYJ 24271040
         CNOP  0,8                                             @Z40FPYJ 24272040
         SPACE 1                                               @Z40FPYJ 24273040
PRECOM3  ST    R8,PSAGPREG      SAVE REG 8                     @Z40FPYJ 24274040
         USING BASE2,XTRBASE                                   @Z40FPYJ 24274140
         L     R8,PSAPSWSV+C4   2ND WORD OF PSW                @Z40FPYJ 24274240
         LTR   R8,R8            IS IT ZERO?                    @Z40FPYJ 24274340
         BNZ   PRECOMA          NO, GO TRACE                   @Z40FPYJ 24274440
         TM    FLCTRACE,TRON    YES, ARE WE WAITING            @Z40FPYJ 24274540
         BO    EXIT1            EXIT                           @Z40FPYJ 24274640
         OI    FLCTRACE,TRON    TURN ON CPU WAITING FLAG       @Z40FPYJ 24274740
         B     PRECOMB          GO TO COMMON                   @Z40FPYJ 24274840
         EJECT                                                 @Z40FPYJ 25250040
*        THIS INSTRUCTION IS THE SUBJECT OF AN EXECUTE INST.            25300001
*        IT INSERTS THE ILC INTO BITS 32 AND 33 OF PSW IN TRACE TABLE   25350001
         SPACE 1                                                        25400001
         CNOP  0,8                                             @Z40FPYJ 25420040
ILCINPSW OI    PSW+ILC(TRPTRG),0   EXECUTED INSTRUCTION                 25450001
         DROP  XTRBASE                                                  25500040
         EJECT                                                          25550002
***      CONSTANTS AND WORK AREAS                                       25600001
         SPACE 2                                                        25650001
RBPFXLEN DC    A(RBPRFLNA)         LENGTH OF RB PREFIX       DCRR 20889 25700002
CC       DC    X'00000030'                                     @Z40FPYJ 25750040
LOGCPU   DC    X'00000040'         LOGICAL CPU VALUE           @Z40FPYJ 25770040
COMPINTC DC    X'1004'             CLOCK COMPARATOR EXT. INT. CODE      26000001
         SPACE 3                                                        26060002
***      DSECT DEFINITIONS OF CONTROL BLOCKS AND WORK AREAS             26100001
         SPACE 2                                                        26150001
STORAGE  DSECT                     CCA COMMON WORK/SAVE AREA     Y02136 26160002
CLOCK    DS    D                   WORK AREA FOR READING TOD CLOCK      26170002
CLOCKV   EQU   CLOCK+2             ONLY BYTES 2-5 TRACED                26180002
         SPACE 2                                                        26190002
TREGSV   DS    5F                  REGISTER SAVE AREA R11-15            26192002
TREGSV12 EQU   TREGSV+4            SLOT FOR GPR 12                      26192402
TREGSV15 EQU   TREGSV+16           SLOT FOR GPR 15                      26194002
TREG8SV  DS    F                   REGISTER 8 SAVE AREA          Y02136 26194402
TRFP0    DS    D                   SLOT FOR FP REG 0           @ZA16400 26195440
         SPACE 2                                                        26198002
         IEAPXNIP TRACE=MAP        TRACE TABLE HEADER                   26410002
         EJECT                                                          26450001
*** FIXED LOW CORE AND PREFIXED STORAGE AREA DESCRIPTION                26500002
         IHAPSA                                                         26650002
PSACPUID EQU   PSACPULA+1          SECOND BYTE OF LOGICAL ADDR. TRACED  26660002
         EJECT                                                          26700001
***      REQUEST BLOCK DESCRIPTION                                      26950001
         IHARB                                                          27000002
         EJECT                                                          27050001
***      TASK CONTROL BLOCK DESCRIPTION                                 27100001
         IKJTCB                                                         27150001
         EJECT                                                          27200001
***      ADDRESS SPACE CONTROL BLOCK DESCRIPTION                        27222002
         IHAASCB                                                        27224002
         EJECT                                                          27230002
***      TIMER QUEUE ELEMENT DESCRIPTION                                27250001
         IHATQE                                                         27300001
         EJECT                                                          27350001
***      DESCRIPTION OF SERVICE REQUEST BLOCK                           27400002
         IHASRB                                                         27450002
         IECDIOSB                                                       27451040
         EJECT                                                          27452002
***      DESCRIPTION OF PHYSICAL CCA ELEMENT                            27486002
         IHAPCCA                                                        27496002
         EJECT                                                          27498002
***      DESCRIPTION OF LOGICAL CCA ELEMENT                             27498402
         IHALCCA                                                        27498802
         EJECT                                                          27499202
***      DESCRIPTION OF WORK/SAVE AREA VECTOR TABLE                     27499602
         IHAWSAVT CLASS=CPU                                             27499702
         END                                                            27500001
