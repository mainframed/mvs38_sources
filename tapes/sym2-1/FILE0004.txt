./  ADD  SSI=21950292,NAME=BMDSECTS
RLDIN    DSECT                          RLD INPUT RECORD FORMAT         02000000
RLDLEN   DS    CL2                      RLD RECORD LENGTH               04000000
RFLAG    DS    CL2                      FLAG                            06000000
ROPCDE   DS    CL2                      OPCODE BYTES                    08000000
POSID    DS    CL2                      POSITION ESD/ID                 10000000
RELID    DS    CL2                      RELOCATION ESD/ID               12000000
RLDVAL   DS    CL3                      RLD SYMBOL ADDRESS              14000000
RLDFLG   DS    C                        RLD FLAG                        16000000
RLDND    EQU   *-RLDIN                  LENGTH OF RECORD                18000000
RLDTYPE  EQU   JR                       RLD RECORD I.D.                 20000000
         SPACE                                                          22000000
XRFIN    DSECT                          XREF INPUT RECORD FORMAT        24000000
XRECLN   DS    CL2                      XREF RECORD LENGTH              26000000
XFLAG    DS    CL2                      FLAG                            28000000
XOPCDE   DS    CL2                      OP CODE                         30000000
XRFSYM   DS    CL8                      XREF SYMBOL                     32000000
XRFFLG   DS    C                        XREF FLAG, BASE, DEF, DUP,UNDEF 34000000
XRFSTM   DS    CL2                      XREF STATEMENT NUMBER           36000000
XRFLEN   DS    CL2                      XREF LENGTH                     38000000
XRFVAL   DS    CL4                      XREF VALUE                      40000000
XRFND    EQU   *-XRFIN                  LENGTH OF XREF RECORD           42000000
XRFTYPE  EQU   JX                       XREF RECORD I.D.                44000000
BASE     EQU   X'01'                    BASE MASK                       46000000
REF      EQU   X'02'                    REFERENCE MASK                  48000000
DUPL     EQU   X'03'                    DUPLICATE MASK                  50000000
         SPACE                                                          52000000
ERRIN    DSECT                          ERROR INPUT RECORD FORMAT       54000000
ERRLEN   DS    CL2                      ERROR RECORD LENGTH             56000000
ERRID    DS    C                        ERROR IDENTIFIER                58000000
NUMERR   DS    C                        NUMBER OF ERRORS                60000000
ERRSTMT  DS    CL2                      ERROR STATMENT NUMBER           62000000
ERRNUM   DS    C                        ERROR NUMBER                    64000000
ERRFLD   DS    CL15                     REST OF ERRORS                  66000000
ERRND    EQU   *-ERRIN                  LENGTH OF RECORD                68000000
ERRTYPE  EQU   JE                       ERROR RECORD I.D.               70000000
./  ADD  SSI=21950294,NAME=CONTAINS
         MACRO                                                          00400000
&PHASEID CONTAINS  &DUMMY                                               00800000
.*                                                                      01200000
.*             CHANGES TO RELEASE 3                                     01250000
.*             CHANGES TO RELEASE 2                                     01300000
.*             CHANGES TO RELEASE 1                                     01350000
.* INNER MACRO TO ICOMMON USED TO CREATE AN EXTERNAL                    01400000
.* ROUTINE NAME ARRAY                                                   01450000
         GBLC  &X0(26)                                                  01600000
         GBLC  &X1(26)                                                  02000000
         GBLC  &X2(26)                                                  02400000
         GBLC  &X3(26)                                                  02800000
         GBLC  &X4(26)                                                  03200000
         GBLC  &X5(26)                                                  03600000
         GBLC  &X6(26)                                                  04000000
         GBLC  &X7(26)                                                  04400000
         GBLC  &X8(26)                                                  04800000
         GBLC  &X9(26)                                                  05200000
         GBLC  &XA(26)                                                  05600000
         GBLC  &XB(26)                                                  06000000
         GBLC  &XC(26)                                                  06400000
         GBLC  &XD(26)                                                  06800000
         GBLC  &XE(26)                                                  07200000
         GBLC  &XF(26)                                                  07600000
.*                                                                      08000000
         LCLA  &I,&J                    INDEX                           08400000
.*                                                                      08800000
         AIF   (K'&PHASEID EQ 0).ERR1                                   09200000
.*                                                                      09600000
         AIF   ('&X0(1)' EQ '').X0                                      10000000
         AIF   ('&X0(1)' EQ '&PHASEID').ERR5                            10400000
         AIF   ('&X1(1)' EQ '').X1                                      10800000
         AIF   ('&X1(1)' EQ '&PHASEID').ERR5                            11200000
         AIF   ('&X2(1)' EQ '').X2                                      11600000
         AIF   ('&X2(1)' EQ '&PHASEID').ERR5                            12000000
         AIF   ('&X3(1)' EQ '').X3                                      12400000
         AIF   ('&X3(1)' EQ '&PHASEID').ERR5                            12800000
         AIF   ('&X4(1)' EQ '').X4                                      13200000
         AIF   ('&X4(1)' EQ '&PHASEID').ERR5                            13600000
         AIF   ('&X5(1)' EQ '').X5                                      14000000
         AIF   ('&X5(1)' EQ '&PHASEID').ERR5                            14400000
         AIF   ('&X6(1)' EQ '').X6                                      14800000
         AIF   ('&X6(1)' EQ '&PHASEID').ERR5                            15200000
         AIF   ('&X7(1)' EQ '').X7                                      15600000
         AIF   ('&X7(1)' EQ '&PHASEID').ERR5                            16000000
         AIF   ('&X8(1)' EQ '').X8                                      16400000
         AIF   ('&X8(1)' EQ '&PHASEID').ERR5                            16800000
         AIF   ('&X9(1)' EQ '').X9                                      17200000
         AIF   ('&X9(1)' EQ '&PHASEID').ERR5                            17600000
         AIF   ('&XA(1)' EQ '').XA                                      18000000
         AIF   ('&XA(1)' EQ '&PHASEID').ERR5                            18400000
         AIF   ('&XB(1)' EQ '').XB                                      18800000
         AIF   ('&XB(1)' EQ '&PHASEID').ERR5                            19200000
         AIF   ('&XC(1)' EQ '').XC                                      19600000
         AIF   ('&XC(1)' EQ '&PHASEID').ERR5                            20000000
         AIF   ('&XD(1)' EQ '').XD                                      20400000
         AIF   ('&XD(1)' EQ '&PHASEID').ERR5                            20800000
         AIF   ('&XE(1)' EQ '').XE                                      21200000
         AIF   ('&XE(1)' EQ '&PHASEID').ERR5                            21600000
         AIF   ('&XF(1)' EQ '').XF                                      22000000
         AIF   ('&XF(1)' EQ '&PHASEID').ERR5                            22400000
.*                                                                      22800000
         AGO   .ERR4                                                    23200000
.*                                                                      23600000
.X0      ANOP                                                           24000000
&X0(1)   SETC  '&PHASEID'                                               24400000
.X01     AIF   (&I+1 GT N'&SYSLIST).END                                 24800000
&I       SETA  &I+1                                                     25200000
         AIF   ('&SYSLIST(&I)' EQ '').X01                               25600000
         AIF   (&J GT 24).ERR6                                          26000000
&X0(&J+2) SETC '&SYSLIST(&I)'                                           26400000
&J       SETA  &J+1                                                     26800000
         AGO   .X01                                                     27200000
.*                                                                      27600000
.X1      ANOP                                                           28000000
&X1(1)   SETC  '&PHASEID'                                               28400000
.X11     AIF   (&I+1 GT N'&SYSLIST).END                                 28800000
&I       SETA  &I+1                                                     29200000
         AIF   ('&SYSLIST(&I)' EQ '').X11                               29600000
         AIF   (&J GT 24).ERR6                                          30000000
&X1(&J+2) SETC '&SYSLIST(&I)'                                           30400000
&J       SETA  &J+1                                                     30800000
         AGO   .X11                                                     31200000
.*                                                                      31600000
.X2      ANOP                                                           32000000
&X2(1)   SETC  '&PHASEID'                                               32400000
.X21     AIF   (&I+1 GT N'&SYSLIST).END                                 32800000
&I       SETA  &I+1                                                     33200000
         AIF   ('&SYSLIST(&I)' EQ '').X21                               33600000
         AIF   (&J GT 24).ERR6                                          34000000
&X2(&J+2) SETC '&SYSLIST(&I)'                                           34400000
&J       SETA  &J+1                                                     34800000
         AGO   .X21                                                     35200000
.*                                                                      35600000
.X3      ANOP                                                           36000000
&X3(1)   SETC  '&PHASEID'                                               36400000
.X31     AIF   (&I+1 GT N'&SYSLIST).END                                 36800000
&I       SETA  &I+1                                                     37200000
         AIF   ('&SYSLIST(&I)' EQ '').X31                               37600000
         AIF   (&J GT 24).ERR6                                          38000000
&X3(&J+2) SETC '&SYSLIST(&I)'                                           38400000
&J       SETA  &J+1                                                     38800000
         AGO   .X31                                                     39200000
.*                                                                      39600000
.X4      ANOP                                                           40000000
&X4(1)   SETC  '&PHASEID'                                               40400000
.X41     AIF   (&I+1 GT N'&SYSLIST).END                                 40800000
&I       SETA  &I+1                                                     41200000
         AIF   ('&SYSLIST(&I)' EQ '').X41                               41600000
         AIF   (&J GT 24).ERR6                                          42000000
&X4(&J+2) SETC '&SYSLIST(&I)'                                           42400000
&J       SETA  &J+1                                                     42800000
         AGO   .X41                                                     43200000
.*                                                                      43600000
.X5      ANOP                                                           44000000
&X5(1)   SETC  '&PHASEID'                                               44400000
.X51     AIF   (&I+1 GT N'&SYSLIST).END                                 44800000
&I       SETA  &I+1                                                     45200000
         AIF   ('&SYSLIST(&I)' EQ '').X51                               45600000
         AIF   (&J GT 24).ERR6                                          46000000
&X5(&J+2) SETC '&SYSLIST(&I)'                                           46400000
&J       SETA  &J+1                                                     46800000
         AGO   .X51                                                     47200000
.*                                                                      47600000
.X6      ANOP                                                           48000000
&X6(1)   SETC  '&PHASEID'                                               48400000
.X61     AIF   (&I+1 GT N'&SYSLIST).END                                 48800000
&I       SETA  &I+1                                                     49200000
         AIF   ('&SYSLIST(&I)' EQ '').X61                               49600000
         AIF   (&J GT 24).ERR6                                          50000000
&X6(&J+2) SETC '&SYSLIST(&I)'                                           50400000
&J       SETA  &J+1                                                     50800000
         AGO   .X61                                                     51200000
.*                                                                      51600000
.X7      ANOP                                                           52000000
&X7(1)   SETC  '&PHASEID'                                               52400000
.X71     AIF   (&I+1 GT N'&SYSLIST).END                                 52800000
&I       SETA  &I+1                                                     53200000
         AIF   ('&SYSLIST(&I)' EQ '').X71                               53600000
         AIF   (&J GT 24).ERR6                                          54000000
&X7(&J+2) SETC '&SYSLIST(&I)'                                           54400000
&J       SETA  &J+1                                                     54800000
         AGO   .X71                                                     55200000
.*                                                                      55600000
.X8      ANOP                                                           56000000
&X8(1)   SETC  '&PHASEID'                                               56400000
.X81     AIF   (&I+1 GT N'&SYSLIST).END                                 56800000
&I       SETA  &I+1                                                     57200000
         AIF   ('&SYSLIST(&I)' EQ '').X81                               57600000
         AIF   (&J GT 24).ERR6                                          58000000
&X8(&J+2) SETC '&SYSLIST(&I)'                                           58400000
&J       SETA  &J+1                                                     58800000
         AGO   .X81                                                     59200000
.*                                                                      59600000
.X9      ANOP                                                           60000000
&X9(1)   SETC  '&PHASEID'                                               60400000
.X91     AIF   (&I+1 GT N'&SYSLIST).END                                 60800000
&I       SETA  &I+1                                                     61200000
         AIF   ('&SYSLIST(&I)' EQ '').X91                               61600000
         AIF   (&J GT 24).ERR6                                          62000000
&X9(&J+2) SETC '&SYSLIST(&I)'                                           62400000
&J       SETA  &J+1                                                     62800000
         AGO   .X91                                                     63200000
.*                                                                      63600000
.XA      ANOP                                                           64000000
&XA(1)   SETC  '&PHASEID'                                               64400000
.XA1     AIF   (&I+1 GT N'&SYSLIST).END                                 64800000
&I       SETA  &I+1                                                     65200000
         AIF   ('&SYSLIST(&I)' EQ '').XA1                               65600000
         AIF   (&J GT 24).ERR6                                          66000000
&XA(&J+2) SETC '&SYSLIST(&I)'                                           66400000
&J       SETA  &J+1                                                     66800000
         AGO   .XA1                                                     67200000
.*                                                                      67600000
.XB      ANOP                                                           68000000
&XB(1)   SETC  '&PHASEID'                                               68400000
.XB1     AIF   (&I+1 GT N'&SYSLIST).END                                 68800000
&I       SETA  &I+1                                                     69200000
         AIF   ('&SYSLIST(&I)' EQ '').XB1                               69600000
         AIF   (&J GT 24).ERR6                                          70000000
&XB(&J+2) SETC '&SYSLIST(&I)'                                           70400000
&J       SETA  &J+1                                                     70800000
         AGO   .XB1                                                     71200000
.*                                                                      71600000
.XC      ANOP                                                           72000000
&XC(1)   SETC  '&PHASEID'                                               72400000
.XC1     AIF   (&I+1 GT N'&SYSLIST).END                                 72800000
&I       SETA  &I+1                                                     73200000
         AIF   ('&SYSLIST(&I)' EQ '').XC1                               73600000
         AIF   (&J GT 24).ERR6                                          74000000
&XC(&J+2) SETC '&SYSLIST(&I)'                                           74400000
&J       SETA  &J+1                                                     74800000
         AGO   .XC1                                                     75200000
.*                                                                      75600000
.XD      ANOP                                                           76000000
&XD(1)   SETC  '&PHASEID'                                               76400000
.XD1     AIF   (&I+1 GT N'&SYSLIST).END                                 76800000
&I       SETA  &I+1                                                     77200000
         AIF   ('&SYSLIST(&I)' EQ '').XD1                               77600000
         AIF   (&J GT 24).ERR6                                          78000000
&XD(&J+2) SETC '&SYSLIST(&I)'                                           78400000
&J       SETA  &J+1                                                     78800000
         AGO   .XD1                                                     79200000
.*                                                                      79600000
.XE      ANOP                                                           80000000
&XE(1)   SETC  '&PHASEID'                                               80400000
.XE1     AIF   (&I+1 GT N'&SYSLIST).END                                 80800000
&I       SETA  &I+1                                                     81200000
         AIF   ('&SYSLIST(&I)' EQ '').XE1                               81600000
         AIF   (&J GT 24).ERR6                                          82000000
&XE(&J+2) SETC '&SYSLIST(&I)'                                           82400000
&J       SETA  &J+1                                                     82800000
         AGO   .XE1                                                     83200000
.*                                                                      83600000
.XF      ANOP                                                           84000000
&XF(1)   SETC  '&PHASEID'                                               84400000
.XF1     AIF   (&I+1 GT N'&SYSLIST).END                                 84800000
&I       SETA  &I+1                                                     85200000
         AIF   ('&SYSLIST(&I)' EQ '').XF1                               85600000
         AIF   (&J GT 24).ERR6                                          86000000
&XF(&J+2) SETC '&SYSLIST(&I)'                                           86400000
&J       SETA  &J+1                                                     86800000
         AGO   .XF1                                                     87200000
.*                                                                      87600000
.ERR1    MNOTE 8,'INVALID OR NO PHASEID FURNISHED.'                     88000000
         MEXIT                                                          88400000
.ERR4    MNOTE 8,'EXTERNAL ROUTINE NAME ARRAYS FULL.'                   88800000
         MEXIT                                                          89200000
.ERR5    MNOTE 8,'DUPLICATE PHASEID.'                                   89600000
         MEXIT                                                          90000000
.ERR6    MNOTE 8,'TOO MANY NAMES.'                                      90400000
         MEXIT                                                          90800000
.END     AIF   (&J GT 0).MEND                                           91200000
         MNOTE 0,'NO ROUTINE NAMES FURNISHED.'                          91600000
.MEND    MEND                                                           92000000
./  ADD  SSI=21950296,NAME=CONTENTS
         MACRO                                                          00600000
&PHASEID CONTENTS  &DUMMY                                               01200000
.*                                                                      01800000
.*             CHANGES TO RELEASE 3                                     01850000
.*             CHANGES TO RELEASE 2                                     01900000
.*             CHANGES TO RELEASE 1                                     01950000
.*                                                                      02000000
.* GENERATES A BRANCH TABLE IN IFNX4E TO THE ROUTINES                   02050000
.* CONTAINED IN IFNX4E                                                  02100000
         GBLC  &X0(26)                                                  02400000
         GBLC  &X1(26)                                                  03000000
         GBLC  &X2(26)                                                  03600000
         GBLC  &X3(26)                                                  04200000
         GBLC  &X4(26)                                                  04800000
         GBLC  &X5(26)                                                  05400000
         GBLC  &X6(26)                                                  06000000
         GBLC  &X7(26)                                                  06600000
         GBLC  &X8(26)                                                  07200000
         GBLC  &X9(26)                                                  07800000
         GBLC  &XA(26)                                                  08400000
         GBLC  &XB(26)                                                  09000000
         GBLC  &XC(26)                                                  09600000
         GBLC  &XD(26)                                                  10200000
         GBLC  &XE(26)                                                  10800000
         GBLC  &XF(26)                                                  11400000
.*                                                                      12000000
         LCLA  &I                                                       12600000
.*                                                                      13200000
         AIF   (K'&PHASEID EQ 0).ERR1                                   13800000
.*                                                                      14400000
&PHASEID DS    0H                       START OF BRANCH TABLE           15000000
         USING &PHASEID,R12                                             15600000
.*                                                                      16200000
         AIF   ('&X0(1)' EQ '&PHASEID').X0                              16800000
         AIF   ('&X1(1)' EQ '&PHASEID').X1                              17400000
         AIF   ('&X2(1)' EQ '&PHASEID').X2                              18000000
         AIF   ('&X3(1)' EQ '&PHASEID').X3                              18600000
         AIF   ('&X4(1)' EQ '&PHASEID').X4                              19200000
         AIF   ('&X5(1)' EQ '&PHASEID').X5                              19800000
         AIF   ('&X6(1)' EQ '&PHASEID').X6                              20400000
         AIF   ('&X7(1)' EQ '&PHASEID').X7                              21000000
         AIF   ('&X8(1)' EQ '&PHASEID').X8                              21600000
         AIF   ('&X9(1)' EQ '&PHASEID').X9                              22200000
         AIF   ('&XA(1)' EQ '&PHASEID').XA                              22800000
         AIF   ('&XB(1)' EQ '&PHASEID').XB                              23400000
         AIF   ('&XC(1)' EQ '&PHASEID').XC                              24000000
         AIF   ('&XD(1)' EQ '&PHASEID').XD                              24600000
         AIF   ('&XE(1)' EQ '&PHASEID').XE                              25200000
         AIF   ('&XF(1)' EQ '&PHASEID').XF                              25800000
.*                                                                      26400000
         AGO   .ERR4                                                    27000000
.*                                                                      27600000
.X0      AIF   (&I GT 24).END                                           28200000
&I       SETA  &I+1                                                     28800000
         AIF   ('&X0(&I+1)' EQ '').END                                  29400000
         B     &X0(&I+1)                                                30000000
         AGO   .X0                                                      30600000
.*                                                                      31200000
.X1      AIF   (&I GT 24).END                                           31800000
&I       SETA  &I+1                                                     32400000
         AIF   ('&X1(&I+1)' EQ '').END                                  33000000
         B     &X1(&I+1)                                                33600000
         AGO   .X1                                                      34200000
.*                                                                      34800000
.X2      AIF   (&I GT 24).END                                           35400000
&I       SETA  &I+1                                                     36000000
         AIF   ('&X2(&I+1)' EQ '').END                                  36600000
         B     &X2(&I+1)                                                37200000
         AGO   .X2                                                      37800000
.*                                                                      38400000
.X3      AIF   (&I GT 24).END                                           39000000
&I       SETA  &I+1                                                     39600000
         AIF   ('&X3(&I+1)' EQ '').END                                  40200000
         B     &X3(&I+1)                                                40800000
         AGO   .X3                                                      41400000
.*                                                                      42000000
.X4      AIF   (&I GT 24).END                                           42600000
&I       SETA  &I+1                                                     43200000
         AIF   ('&X4(&I+1)' EQ '').END                                  43800000
         B     &X4(&I+1)                                                44400000
         AGO   .X4                                                      45000000
.*                                                                      45600000
.X5      AIF   (&I GT 24).END                                           46200000
&I       SETA  &I+1                                                     46800000
         AIF   ('&X5(&I+1)' EQ '').END                                  47400000
         B     &X5(&I+1)                                                48000000
         AGO   .X5                                                      48600000
.*                                                                      49200000
.X6      AIF   (&I GT 24).END                                           49800000
&I       SETA  &I+1                                                     50400000
         AIF   ('&X6(&I+1)' EQ '').END                                  51000000
         B     &X6(&I+1)                                                51600000
         AGO   .X6                                                      52200000
.*                                                                      52800000
.X7      AIF   (&I GT 24).END                                           53400000
&I       SETA  &I+1                                                     54000000
         AIF   ('&X7(&I+1)' EQ '').END                                  54600000
         B     &X7(&I+1)                                                55200000
         AGO   .X7                                                      55800000
.*                                                                      56400000
.X8      AIF   (&I GT 24).END                                           57000000
&I       SETA  &I+1                                                     57600000
         AIF   ('&X8(&I+1)' EQ '').END                                  58200000
         B     &X8(&I+1)                                                58800000
         AGO   .X8                                                      59400000
.*                                                                      60000000
.X9      AIF   (&I GT 24).END                                           60600000
&I       SETA  &I+1                                                     61200000
         AIF   ('&X9(&I+1)' EQ '').END                                  61800000
         B     &X9(&I+1)                                                62400000
         AGO   .X9                                                      63000000
.*                                                                      63600000
.XA      AIF   (&I GT 24).END                                           64200000
&I       SETA  &I+1                                                     64800000
         AIF   ('&XA(&I+1)' EQ '').END                                  65400000
         B     &XA(&I+1)                                                66000000
         AGO   .XA                                                      66600000
.*                                                                      67200000
.XB      AIF   (&I GT 24).END                                           67800000
&I       SETA  &I+1                                                     68400000
         AIF   ('&XB(&I+1)' EQ '').END                                  69000000
         B     &XB(&I+1)                                                69600000
         AGO   .XB                                                      70200000
.*                                                                      70800000
.XC      AIF   (&I GT 24).END                                           71400000
&I       SETA  &I+1                                                     72000000
         AIF   ('&XC(&I+1)' EQ '').END                                  72600000
         B     &XC(&I+1)                                                73200000
         AGO   .XC                                                      73800000
.*                                                                      74400000
.XD      AIF   (&I GT 24).END                                           75000000
&I       SETA  &I+1                                                     75600000
         AIF   ('&XD(&I+1)' EQ '').END                                  76200000
         B     &XD(&I+1)                                                76800000
         AGO   .XD                                                      77400000
.*                                                                      78000000
.XE      AIF   (&I GT 24).END                                           78600000
&I       SETA  &I+1                                                     79200000
         AIF   ('&XE(&I+1)' EQ '').END                                  79800000
         B     &XE(&I+1)                                                80400000
         AGO   .XE                                                      81000000
.*                                                                      81600000
.XF      AIF   (&I GT 24).END                                           82200000
&I       SETA  &I+1                                                     82800000
         AIF   ('&XF(&I+1)' EQ '').END                                  83400000
         B     &XF(&I+1)                                                84000000
         AGO   .XF                                                      84600000
.*                                                                      85200000
.ERR1    MNOTE 8,'INVALID OR NO PHASEID FURNISHED.'                     85800000
         MEXIT                                                          86400000
.ERR4    MNOTE 8,'UNDEFINED PHASEID.'                                   87000000
.END     DROP  R12                                                      87600000
         AIF   (&I NE 0).MEND                                           88200000
.ERR5    MNOTE 4,'NO ROUTINE NAME DEFINED FOR PHASE.'                   88800000
.MEND    MEND                                                           89400000
./  ADD  SSI=21950298,NAME=DBV
         MACRO                                                          02000000
&NAME    DBV   &Z                                                       04000000
         LCLA  &I,&J,&K,&M                                              06000000
         LCLC  &B(7)                                                    08000000
.*                                                                      08050000
.*             CHANGES TO RELEASE 3                                     08100000
.*             CHANGES TO RELEASE 2                                     08150000
.*             CHANGES TO RELEASE 1                                     08200000
.*                                                                      08250000
.* DEFINES BYTE VALUES THROUGH THE USE OF                               08300000
.* EQUATES AND DS 0X                                                    08350000
.*                                                                      08400000
         AIF   ('&NAME' EQ '').I1                                       10000000
&NAME    DS    0X                                                       12000000
.I1      AIF   (&M EQ 0).M1                                             14000000
&B(&M+1) SETC  ''                                                       16000000
&M       SETA  &M-1                                                     18000000
         AGO   .I1                                                      20000000
.M1      ANOP                                                           22000000
&B(&M+1) SETC  '0'                                                      24000000
&K       SETA  0                                                        26000000
&I       SETA  &I+1                                                     28000000
         AIF   (K'&SYSLIST(&I) EQ 0).D1                                 30000000
&J       SETA  K'&SYSLIST(&I)+1                                         32000000
.L1      ANOP                                                           34000000
&J       SETA  &J-1                                                     36000000
         AIF   ('&SYSLIST(&I)'(&J,1) NE ')').S1                         38000000
&K       SETA  &K+1                                                     40000000
.S1      AIF   ('&SYSLIST(&I)'(&J,1) NE '(').S2                         42000000
&K       SETA  &K-1                                                     44000000
.S2      AIF   (&K EQ 0).S3                                             46000000
         AIF   (&K GT 0 AND &J GT 1).L1                                 48000000
.ERR     MNOTE 8,'INVALID PARAMETER SYNTAX IN OPERAND &I.'              50000000
         AGO   .D1                                                      52000000
.S4      ANOP                                                           54000000
&B(&M+1) SETC  '&SYSLIST(&I)'(&J+1+&M*8,8)                              56000000
&M       SETA  &M+1                                                     58000000
.S3      AIF   (K'&SYSLIST(&I)-&M*8-&J GT 9).S4                         60000000
         AIF   (&J EQ K'&SYSLIST(&I)).S5                                62000000
&B(&M+1) SETC  '&SYSLIST(&I)'(&J+1+&M*8,K'&SYSLIST(&I)-&M*8-&J-1)       64000000
.S5      AIF   (&J EQ 1 OR &J GT 8).ERR                                 66000000
&B(7)    SETC  '&SYSLIST(&I)'(1,&J-1)                                   68000000
&B(7)    EQU   &B(1)&B(2)&B(3)&B(4)&B(5)&B(6)                           70000000
V&B(7)   DS    0X                                                       72000000
.D1      AIF   (&I LT N'&SYSLIST).I1                                    74000000
         DS    1X                                                       76000000
.MEND    MEND                                                           78000000
./  ADD  SSI=21950300,NAME=DCDSWORK
         MACRO                                                          02000000
&NAME    DCDSWORK  &DUMMY                                               04000000
.*                                                                      04050000
.*             CHANGES TO RELEASE 3                                     04100000
.*             CHANGES TO RELEASE 2                                     04150000
.*             CHANGES TO RELEASE 1                                     04200000
.*                                                                      04250000
.* GENERATES A WORK AREA FOR DC/DS EVALUATION ROUTINE                   04300000
.* (IFNX4D AND IFNX4N). THE WORK AREA IS GENERATED IN                   04400000
.* IFNX4D AND IFNX4N BY A CALL FROM MACRO ICOMMON                       04450000
&NAME    DS    0F                       NAME                            06000000
DCSWORK  DS    0XL11                             DC SWITCH CODES        08000000
DCSWTCH  DSW   BITLN,ESMOD,TYPEL,TYPEV,TYPEZ     DC/DS SWITCH CODE      10000000
LFDEL    DS    C                                 LEFT FIELD DELIMITER   12000000
RTDEL    DS    C                        RIGHT FIELD DELIMITER           14000000
SCADDR   DS    X                        SCAN ROUTINE ADDRESS            16000000
DCALIGN  DS    X                        IMPLIED LENGTH AND ALIGNMENT    18000000
MINLN    DS    X                        MINIMUM LENGTH LODIFIER RANGE   20000000
MAXLN    DS    H                        MAXIMUM LENGTH MODIFIER RANGE   22000000
BITINCR  DS    H                        NUMBER OF BITS PER DIGIT        24000000
HILIMIT  DS    X                        HIGHEST VALUE OF VALID DIGIT    26000000
PERIOD   EQU   D0+BITINCR               DECIMAL POINT ENCOUNTERED       28000000
EXPONENT EQU   D1+BITINCR               EXPONENT ENCOUNTERED            30000000
SUBFIELD EQU   D1+BITINCR               SUBFIELD ENCOUNTERED            32000000
TYPECALL DSW   ,DXDALIGN,DEFNAME,DLOCTREF,DCCALL,DSCALL,LTCALL,LTORGSCN 34000000
LEVELPTR DS    A                        LEVEL POINTER                   36000000
DUPFAC   DS    F                        DUPLICATION FACTOR              38000000
CONLNG   DS    F                        CONSTANT LENGTH                 40000000
DCDSWORK DS    0XL38                    INITIALIZE                      42000000
REFCOUNT DS    H                        SYMBOL COUNT                    44000000
SYMCOUNT DS    H                        SYMBOL COUNT                    46000000
VEETABLE DS    16X                      V-TYPE CONSTANTS TABLE          48000000
ADSYM    DS    A                        ADDRESS OF SYMBOL TABLE ENTRY   50000000
BITADD   DS    H                        RESIDUAL BIT COUNT              52000000
OPCNT    DS    H                        OPERAND COUNT                   54000000
LATTRSAV DS    H                        SAVE                            56000000
DCWORK   DS    0XL8                     INITIALIZE                      58000000
LATTR    DS    H                        LENGTH ATTRIBUTE                60000000
ADUPFAC  DS    A                        ADDRESS OF DUPLICATION FACTOR   62000000
CONCT    DS    H                        CONSTANT COUNT                  64000000
         MEND                                                           66000000
./  ADD  SSI=21950301,NAME=DSW
         MACRO                                                          03000000
&NAME    DSW                                                            06000000
         GBLA  &INDEX                                                   09000000
         GBLC  &DEFNAME(255),&SWNAME(255)                               12000000
         LCLA  &I,&J                                                    15000000
         LCLC  &X,&Y                                                    18000000
.*                                                                      18050000
.*             CHANGES TO RELEASE 3                                     18100000
.*             CHANGES TO RELEASE 2                                     18150000
.*             CHANGES TO RELEASE 1                                     18200000
.*                                                                      18250000
.* DEFINES SWITCH BYTE AND NAMES THE BITS IN THE BYTE                   18300000
.*                                                                      18350000
         AIF   (N'&SYSLIST GT 8).ERR1                                   21000000
&X       SETC  'JSW&SYSNDX'                                             24000000
         AIF   (K'&NAME EQ 0).NEXT                                      27000000
&X       SETC  '&NAME'                                                  30000000
.NEXT    ANOP                                                           33000000
&X       DS    X                                                        36000000
         AIF   (N'&SYSLIST EQ 0).EXIT                                   39000000
.LOOP    ANOP                                                           42000000
&J       SETA  &I+1                                                     45000000
         AIF   (K'&SYSLIST(&J) EQ 0).BYPASS                             48000000
         AIF   (K'&SYSLIST(&J) GT 8).ERR1                               51000000
&INDEX   SETA  &INDEX+1                                                 54000000
         AIF   (&INDEX GT 255).ERR2                                     57000000
&Y       SETC  '&SYSLIST(&J)'                                           60000000
&DEFNAME(&INDEX) SETC '&X'                                              63000000
&SWNAME(&INDEX)  SETC '&Y'                                              66000000
&Y       EQU   BIT&I                                                    69000000
.BYPASS  ANOP                                                           72000000
&I       SETA  &I+1                                                     75000000
         AIF   (N'&SYSLIST GT &I).LOOP                                  78000000
.EXIT    MEXIT                                                          81000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     84000000
         MEXIT                                                          87000000
.ERR2    MNOTE 8,'TOO MANY SWITCHES DEFINED FOR ASSEMBLY.'              90000000
         MEND                                                           93000000
./  ADD  SSI=71710231,NAME=EDSECT
************************************************************            00200000
* VS1 RELEASE 3 CHANGES                                                 00250001
*A418600                                                        OX00224 00300001
* VS1 RELEASE 3.1 CHANGES                                               00350003
*A150960                                                        OX04106 00360003
*A405500,407520                                                @OX07230 00370005
*A046200-046420                                                @OZ06551 00380006
*D046100                                                       @OZ06551 00390006
*C042000                                                       @OZ06551 00392006
*A389720                                                       @AY11215 00392106
ERRMESS  DSECT                          DSECT DEFINED FOR ERRSTK        00400000
*********************************************************************** 00600000
EMSGSVTY DS    C                        ERROR MSG SEVERITY CODE         00800000
EMSGCODE DS    C                        ERROR MSG CODE                  01000000
EMSGHL   EQU   *-EMSGSVTY               ERROR MSG ENTRY ADD-ON LENGTH   01200000
ENTRYLNG DS    C                        ERROR MSG ENTRY LENGTH          01400000
EMSGNTRY DS    CL8                      ERROR MSG ENTRY                 01600000
ERMEND   EQU   *-ERRMESS                                                01800000
         EJECT                                                          02000000
************************************************************            02200000
EDSECT   DSECT ,                        EDIT PHASE COMMON AREA          02400000
************************************************************            02600000
         USING EDSECT,MODCOMM           EDSECT BASE REGISTER            02800000
EDSCTGO  EQU   *                        BEGIN OF MODULE COMMON AREA     03000000
SWITCH1  DSW   SMDEF,                   WITHIN MAC DEF (SET BY MACRO)  X03400000
               SXPRTO,                  PROTO EXPECTED (SET BY MACRO)  X03600000
               SMISCN,                  RETURN TO MISCAN               X03800000
               SNOPSYN,                 OPSYN NO LONGER ALLOW  @OZ06551X04200006
               SUBLERR,                 SUBLIST IN ERROR       @OZ06551X04620006
               ENDSUBL,                 END OF SUBL IN MI-SCAN @OZ06551X04630006
               ALTERN                   IN ALTERNATE FORM      @OZ06551 04640006
*                                                              @OZ06551 04642006
SWITCH2  DSW   SONECD,                  READ ONE CARD (REPRO)          X04650000
               SBYCNT,                  BYPASS ALL CONTINUATIONS       X04700000
               SONECT,                  READ ONE CONTINUATION          X04750000
               SALLCT,                  READ ALL CONTINUATIONS         X04760000
               SBYONE,                  BYPASS ONE CARD IN EDITED FORM X04770000
               ,                                                       X04780000
               SCTLRTN,                 RETURN TO CALLER               X04780400
               SNOPND                   RETURN TO CALLER                04790000
*                                                                       06200000
SWITCH3  DSW   SCMTCT,                  COMMENTS CONTINUED             X06400000
               SNXTCT,                  NEXT CD CNT'N OF THIS CD       X06600000
               SPRVCT,                  THIS CD CNT'N OF PREVIOUS CD   X06800000
               SLSTCD,                  LAST CARD                      X07000000
               SINEOF,                  EOF ON SYSTEM INPUT            X07200000
               SGBLCL,                  PROC'G GBLX, LCLX STMT         X07400000
               SMI,                     EDITING MACRO INSTRUCTION      X07450000
               SUBSOP                   SUBSTITUTED OP CODE FOUND       07600000
*                                                                       07800000
SWITCH4  DSW   SPGRMD,                  PROCESSING PROGRAMMER MACRO    X08000000
               SOPNCD,                  IN OPEN CODE                   X08200000
               SSYSMD,                  IN SYSTEM MACRO DEFINITION     X08400000
               SICTL,                   ICTL PROCESSED IN THIS RUN     X08450000
               SNOACTR,                                                X08500000
               SABORT,                                                 X08600000
               SKPMND,                  SKIP TO MEND                   X09200000
               SKPEND                   SKIP TO END                     09400000
*                                                                       09410000
SWITCH5  DSW   SCOPY,                   COPY STATEMENT                 X09450000
               SXMCRO,                  EXPECT MACRO (EDITING SYS MD'S)X09500000
               SFSTCD,                  READ FIRST CARD                X09510000
               SDINIT,                  PREPARE TO INIT./CLOSE D'S     X09520000
               SDENT,                   PREPARE TO MAKE D ENTRY        X09522000
               SUPDNT,                  SUPPRESS DIRECTORY ENTRY       X09530000
               SMDDENTR,                MDD ENTRY MADE FOR THIS MACRO  X09596502
               AMPER                    AMPERSAND IN SUBLIST            09598502
*                                                                       09600000
SWITCH6  DSW   SUBLST,                  PROCESSING SUBLIST             X09800000
               POSSUBL,                 FIRST SCAN OF SUBLIST CANDIDATEX09802000
               SCNCAT,                  CONCATENATION IN OPERAND       X09850000
               SKWPRM,                  PROCESSING KEYWORD PARAMETER   X10400000
               PROTOCAL,                EDITING PROTO/MACRO CALL       X10600000
               SKPNAME,                 SKIP TO OP CODE FIELD          X10650000
               SPRMER,                  PARAMETER ERROR                X10800000
               SENDST                   END STATEMENT ENCOUNTERED       11000000
*                                                                       11200000
SWITCH7  DSW   SNMFND,                  NAME FOUND                     X13000000
               SNOFND,                  FIELD NOT FOUND                X13200000
               SNOSMCRO,                NO MACRO STMT IN SYS MAC DEF   X13250000
               SBDPROTO,                BAD PROTOTYPE STATEMENT        X13300000
               SNOSYSMD,                SYSTEM MAC DEF NOT FOUND       X13350000
               SDTCMT,                  .* TYPE COMMENTS               X13400000
               SASTCMT,                 * TYPE COMMENT                 X13450000
               STRCMT                   * TYPE COMMENT                  13500000
*                                                                       14000000
SWITCH8  DSW   ,,,,,                    DO NOT USE                     X14200000
               SENAME,                  EDITING NAME FIELD             X14400000
               SEOPCD,                  EDITING OPERATION FIELD        X14600000
               SEOPND                   EDITING OPERAND FIELD           14800000
*                                                                       15000000
SWITCH9  DSW   SINCPY,                  IN COPY CODE                   X15050000
               SISEQ,                   SEQ CHECK (SET BY ISEQ)        X15080000
               SNOCNT,                  CNT'N NOT ALLOWED (SET BY ICTL)X15092000
               SMAC,                    MACRO STMT COPIED AT THIS LEVELX15094003
               AMPER1                   VARIABLE SYM IN POSSUBL OX04106 15096003
*                                                                       15100000
AOTSW    DSW   AOEND,                   END STATEMENT                  X15200000
               AOMEND,                  MEND STATEMENT                 X15250000
               AICOPY,                  ICTL/COPY STATEMENT            X15300000
               AOPSYN,                  OPSYN STATEMENT                X15350000
               AOCOPYX,                 ILLEGAL WITHIN COPY CODE       X16000000
               AOMACROX,                ILLEGAL WITHIN MACRO DEF       X16200000
               AOPENCDX,                ILLEGAL WITHIN OPEN CODE       X16400000
               AOKBTNPM                 ALLOWED BETWEEN PROG'R MACROS   16600000
* X0 = ALLOWED ANYWHERE                                                 16800000
*                                                                       17000000
GSCNSW   DSW   GQST,                    ODD QUOTE CHECKER              X17050000
               GSUBS,                   FIELD NEEDS SUBSTITUTION       X17060000
               GAIF,                    AIF STATEMENT BEING SCANNED    X17070000
               METSW                    META TEXT INDICATION            17080000
*                                                                       17100000
PARMSTAT DSW   DMIENT,                  ENTERED FROM MIPRTOIN ROUTINE  X17200000
               DUMOPND,                 OPERAND TREATED AS DUMMY       X17250000
               DSDTX,                   DISALLOW SDT                   X17600000
               DLPRN,                   LEFT PARENTHESIS WAS READ      X17650000
               DECMA,                   END OPERAND - COMMA PASSED     X17700000
               DEEQL,                   END OPERAND - EQUAL SIGN PASSEDX17750000
               DQUOT,                   ODD QUOTE STATUS               X17800000
               DNOCRD                   NEW CARD WAS READ               18000000
*                                                                       18200000
NAMBYT   DSW   NQTSTG,                  QUOTED STRING                  X18400000
               NNALFA,                  FIRST CARD NOT ALPHA           X18450000
               NCNCAT,                  CONCATENATION                  X18500000
               NMPURE,                  IMPURITY (PASSED END COLUMN)   X19200000
               NNTGER,                  INTEGER (DECIMAL)              X19210000
               NOSYM,                   O SYM                          X19250000
               NSSYM,                   SEQUENCE SYMBOL                X19300000
               NVSYM                    V SYM                           19350000
*                                                                       19600000
GSUMRY   DSW   RQTSTG,                  QUOTED STRING                  X19800000
               RNALFA,                  FIRST CHARACTER NOT ALPHA      X20000000
               RCNCAT,                  CONCATENATION                  X20200000
               RMPURE,                  IMPURITY  (PASSED END COLUMN)  X20600000
               RNTGER,                  INTEGER (DECIMAL)              X20650000
               ROSYM,                   ORDINARY SYMBOL                X21250000
               RSSYM,                   SEQUENCE SYMBOL                X21300000
               RVSYM                    VARIABLE SYMBOL                 21350000
*  BLANK = ALL ZEROS                                                    21360000
*                                                                       21370000
         SPACE 3                                                        21400000
MSERR    DSW   MXVS,                    INVALID VARIABLE SYMBOL        X21450000
               MXRPRN                   EXCESSIVE RIGHT PARENTHESES     21500000
SDENTR   DS    C                        DIRECTORY ENTRY INDEX           21550000
SDENTR1  DS    C                        DIR INDEX FOR EXTRN/WXTRN OPND  23550000
DDNDX    DS    H                        D ENTRY INDEX                   26200000
DDNDX1   EQU   DDNDX+1                  D ENTRY INDEX                   26400000
DSTGEND  DC    A(0)                     DESTINATION AREA END PLUS 1     26450000
ENDATA   DC    A(0)                     END OF DATA IN WORK BUFFER      26500000
FPTRSV   DC    A(0)                     FIELD POINTER SAVE AREA         28400000
INPUT    DC    A(0)                     INPUT WORK BUFFER ADDRESS       28450000
IPTRSV   DC    A(0)                     INPUT BUFFER ADDRESS SAVE AREA  28500000
IRTNSV   DC    A(0)                     RETURNED ADDRESS SAVE AREA      28550000
OUTADR   DC    A(0)                     OUTPUT BUFFER LOCATION          28560000
VECPTR   DS    F                        PARAM VECTOR POINTER SAVE AREA  29600000
FSTGL    DS    F                        BEGIN OF STRING (PARAM)         29650000
AERRSTK  DC    A(ERRSTK)                ERROR MSG STACK ADDRESS         29700000
ESTKNDX  DC    A(0)                     ERROR MSG STACK INDEX           29750000
DSTGBGN  DS    F                        DESTINATION AREA POINTER        29760000
DSTGADJ  DS    F                        DEST. AREA POINTER AFTER ADJ.   29770000
DSTGNDX  DS    F                        DESTINATION AREA INDEX          29780000
STGNDX   DS    F                        DISPATCH AREA INDEX             29790000
EDTSVX   DS    F                        RETURN/TLINK REG SAVE           29792000
EDTSVY   DS    F                        RETURN POINTER SAVE AREA        29794000
EDTSVZ   DS    5F                       R15,R3 SAVE AREA                29796000
OCPTRSV  DS    F                        OP CODE POINTER SAVE AREA       29798000
INTERMET DS    F                        INTERMEDIATE LOCATION IN MT     29798100
MEZZOPTR DS    F                        INTERMEDIATE LOC IN WORK AREA   29798200
OPNDPTR  DS    F                        OPERAND FIELD POINTER SAVED     29798400
RTNSV    DS    F                        POINTER SAVE AREA               29798500
MIOPNDSV DS    F                                                        29798800
********************DO NOT CHANGE ORDER OF NAMP AND NAML***********     29807900
NAMP     DS    F                        SYMBOL LOCATION POINTER         29825000
NAML     DS    F                        MOVE LENGTH OF THE SYMBOL       29833300
*******************************************************************     29835300
NAMP1    DS    F                        SYMBOL PTR TO EXTRN/WXTRN OPND  29836300
NAML1    DS    F                        ADDT'L SYMBOL LENGTH SAVE AREA  29837300
NOTESV1  DS    F                        NOTED VALUE SAVE AREA 1         29849900
NOTESV2  DS    F                        NOTED VALUE SAVE AREA           29859900
SEQSV    DC    XL40'00'                 SEQ FIELD SAVE AREA             34000000
COPYSV1  EQU   SEQSV                                                    34200000
COPYSV2  DS    F                        SWITCH SAVE AREA                34400000
COPYSV2A EQU   COPYSV2+1                .                               34600000
COPYSV2B EQU   COPYSV2A+1               .                               34800000
COPYSV2C EQU   COPYSV2B+1               .                               35000000
COPYSV3  DS    7F                       ICTL FORMAT SAVE AREA           35200000
COPYSV4  DS    6F                                                       35400000
HICVAL   DS    F                        SDT HIGH CHAR VAL               35600000
HICVAL1  EQU   HICVAL+1                 SAVE AREA                       35800000
HICCNT   EQU   HICVAL+2                 MAX CHAR COUNT SAVE AREA        36000000
TBGLN    DS    F                        PREBEGIN STRING LENGTH          36200000
TSRCLN   DS    F                        DATA PORTION TRUE LENGTH        36400000
TCNTLN   DS    F                        CONTINUATION FLD TRUE LENGTH    36600000
PBGLEN   DS    F                        PREBEGIN STRING LENGTH MINUS 1  36800000
PNDLEN   DS    F                        POSTEND STRING LENGTH MINUS 1   37000000
ENDCOL   DS    F                        END COLUMN MINUS 1              37200000
ENDCOL3  EQU   ENDCOL+3                                                 37400000
SMACNAM  DS    CL8                      MACRO NAME SAVE AREA            38000000
COPYCODE DS    CL8                      COPY CODE                       38200000
COPYLN   DS    H                        COPY CODE LENGTH                38400000
DSTGLN   DS    H                        STRING LENGTH                   38600000
OCSAVE   DS    H                        INTERNAL OP CODE SAVE AREA      38850000
PRNLVL   DS    H                        PAREN LEVEL COUNTER             38900000
PRNLVL1  EQU   PRNLVL+1                                                 38950000
FLAGBT   DS    C                        FLAG BYTE SAVE AREA             38952000
DTLENG   DS    H                        DATA LENGTH                     38966000
OPNDCTR  DS    H                        OPERAND COUNTER                 38968000
OPNDC1   EQU   OPNDCTR+1                OPERAND COUNTER                 38970000
PARML    DS    H                        TOTAL PARM TEXT LENGTH @AY11215 38972006
MINDIF   DS    H                        DIF BETWEEN MINPUT AND INPUT    38980000
MTXTP    DS    F                        MI/PROTO META TEXT POINTER      38990000
MINPUT   DS    F                        CURRENT MI DATA AREA POINTER    38992000
MINPSTD  DS    F                        STANDARD MINPUT SAVED           38994000
STNPSTD  DS    F                        STANDARD INPUT SAVED            38996000
MINPADJ  DS    F                        ADJUSTED MINPUT SAVED           40200000
STNPADJ  DS    F                        ADJUSTED INPUT SAVED            40400000
OPCDPTR  DS    F                        OP CODE FIELD POINTER           40450000
ENDWKA   DS    F                        END OF DATA AREA PLUS 1         40500000
ENDWKADJ DS    F                        ADJUSTED 'ENDWKA'      @OX07230 40550005
MREGSV   DS    F                        EDSECT BASE REG SAVED           40600000
SVENDWKA DS    F                        SAVE END OF DATA AREA+1         40604000
COLCTR   DS    F                        COLUMN COUNTER                  40610000
CRDCTR   EQU   COLCTR+2                 CARD COUNTER                    40650000
OFPTRSV  DS    F                        INDEXP SAVE AREA                40700000
SVMINDIF DS    H                        SAVE STANDARD MINDIF            40750000
MINDFADJ DS    H                        ADJUSTED 'MINDIF'      @OX07230 40752005
LASTFIND DS    CL8                      LAST FOUND COPY MEMBER          40760001
         SPACE                                                          40800000
*        THE FOLLOWING 7 CONSTANTS MUST BE IN THE PREARRANGED SEQUENCE  41000000
RAVSP    DC    A(RSTACK)              1 RSTACK NEXT AVAILABLE LOCATION  41200000
NRSTK    DC    A(RSTACK+L'RSTACK)     2 END OF RSTACK + 1               41400000
RSTACK   DS    CL200                  3 MAXIMUM OF 25 ENTRIES           41600000
CSTK     DS    CL(6*(L'JNOTEVAL+9))   4 COPY CODE RECURSION STACK       41800001
CSTKX    EQU   *                                                        41810000
         DS    0F                                                       41812000
NCSTK    DC    A(CSTK+L'CSTK)           5 ENDING ADDRESS OF CSTK+1      41820000
BCSTK    DC    A(CSTK)                  6 CSTK BEGIN ADDRESS            41830000
CSTKADR  DC    A(CSTK)                  7 CSTK NEXT AVAILABLE LOCATION  41840000
SAVMALL  DS    16F                      REGISTER SAVE AREA              41842000
TPSAVE   EQU   SAVMALL                                                  41850000
TPSAVE1  EQU   SAVMALL+4                                        OX00224 41860001
ERRCNT   DS    H                        ERROR MSG COUNT - MAX 5 MSGS.   41900000
ERRCNT1  EQU   ERRCNT+1                                                 41950000
ERRSTK   DS    CL(ERMEND*6)             ERROR MSG STACK                 41960000
*        WORKSPACE FOR POSTFIX ROUTINE                                  43400000
SVLAST   DS    F                        LAST STACK ELEMENT POINTER      43600000
ALAST    DS    F                        START OF STACK--CONSTANT        43800000
TEMP     EQU   *                        PRE-STACK ENTRY                 44000000
TEMPOP   DS    C                        OPERATOR                        44200000
TEMPBIND DS    C                        BINDING FACTOR                  44400000
         SPACE                                                          44600000
STACK    DS    36H                      MAXIMUM OF 35 OPERATORS IN     X44800000
                                        STACK ( 5+ PAREN LEVELS)        45000000
         SPACE 3                                                        45200000
         DS    0H                                                       45250000
VSFLG    DC    H'0'                     SET VAR TYPE SAVED FOR NAME     45300000
VSTAT    EQU   VSFLG+1                                                  45350000
STGCNT   DC    X'00'                    STRING COUNTER                  45360000
CNTCTR   DC    X'00'                    CONTINUATION CARD COUNTER       45370000
SEQSVT   DC    40X'00'                  SEQ FIELD - COMPARE V. SEQSV    45380000
         SPACE 3                                                        45390000
         DS    0F                                                       45392000
ADJSV    DS    F                        RETURN POINTER SAVED HERE       45394000
VSRSV    DS    F                        VSRTN RETURN LINKAGE            45396000
VSRSV1   DS    F                        HEADER DATA POINTER             45398000
MPOPSV   DS    F                        MPOPND ROUTINE RETURN LINKAGE   45398400
NEXPSV   DS    F                        RETURN LINKAGE SAVED            45398800
SUBSAVE  DS    2F                       MPOPSV/NEXPSV SAVE AREA         45398900
REGSAVE3 DS    F                        REGISTER SAVE AREA              45399000
         SPACE 3                                                        45399200
         DS    0H                                                       45400000
DNTERR   DS    CL10                                                     45600000
*        BAL   TLINK,SNAPERR            LOG ERROR                       45800000
         ORG   DNTERR+4                 REDEFINE                        46000000
         DC    AL2(2)                   WRNERR ENTRY CODE               46200000
DSEVCD   DC    AL1(0)                   SEVERITY CODE                   46400000
DERRCD   DC    AL1(0)                   ERROR CODE                      46600000
*        BR    RETURN                   RETURN TO CALLER                46800000
         ORG                                                            47000000
ENDDNTL  EQU   *-DNTERR                                                 47200000
         SPACE 3                                                        47600000
*********************************************************************** 47800000
*                                                                       48000000
*         START OF EDIT PHASE COMMON INITIALIZED BY THE EDIT PHASE      48200000
*               DICTIONARY ROUTINES                                     48400000
*  THE PORTION OF COMMON BOUNDED BY DICTCOMS-DICTCOME IS INITIALIZED    48600000
*         AT THE START OF THE EDIT PHASE BY PHASENT                     48800000
DICTCOMS EQU   *                                                        49000000
FREESTRT DS    F                        PTR TO START OF DICT WORK AREA  49200000
VSDSTRT  DS    F                        PTR TO START OF VARB SYMB DIR   49400000
MDDSTRT  DS    F                        PTR TO START OF MACR DEFN DIR   49600000
SSPARMS  EQU   *                        BASE FOR SEQ SYMB REFER CONSTNT 49800000
SSRDSTRT DS    F                        PTR TO START OF SEQ SYMB REF DT 50000000
VSDSLOT  DS    F                        PTR TO NEXT AVAIL VSD ENTRY     50200000
OSPARMS  EQU   *                        BASE FOR ORD SYMB REFER CONSTNT 50400000
OSRDSTRT DS    F                        PTR TO START OF ORD SYMB REF DT 50600000
MDDSLOT  DS    F                        PTR TO NEXT AVAIL MDD ENTRY     50800000
CURMDDPT DS    F                        PTR TO CURRENT MDD ENTRY        51000000
REGSAVE1 DS    F                        REGISTER SAVE AREA              51200000
GTMVALOC DS    F                        MACRO DEFINITION VECTOR LENGTH  51400000
HIBYTE0  DS    F                        FULL WORD WORK AREA             51600000
MDDCHN   DS    F                        MASTER LINK, CHAINED MOD ENTRYS 51800000
MDDCNT   DS    F                        NUMBER OF MDD ENTRYS            52000000
OPSCHN   DS    F                        MASTER LINK, CHAINED OPSYN ENTR 52200000
*  THE PORTION OF COMMON BOUNDED BY MDINITS-TSINITE IS REINITIALIZED    52600000
*         FOR EACH MACRO DEFINITION TEXT SEGMENT BY MACRENT.            52800000
MDINITS  EQU   *                                                        53000000
GTPVALOC DS    F                        POSITIONAL PARAM VECTOR LENGTH  53200000
GTKVALOC DS    F                        KEYWORD PARAM VECTOR LENGTH     53400000
*  THE PORTION OF COMMON BOUNDED BY OCINITS-TSININTE IS REINITIALIZED   53600000
*        FOR THE OPEN CODE TEXT SEGMENT BY OPENENT.                     53800000
OCINITS  EQU   *                                                        54000000
GTLDALOC DS    F                        LOCAL DICTIONARY LENGTH         54200000
GTGVALOC DS    F                        GLOBAL VECTOR LENGTH            54400000
GTSDALOC DS    F                        SEQ SYMB REFER DICT LENGTH      54600000
SSRAPDIS DS    H                        DISPL IN SSRD FOR NEXT ENTRY    54800000
TSINITE  EQU   *                                                        55000000
SWITCHA  DSW   FNDFLG,                  MATCHING DIRECT ENTRY FOUND    X55100000
               NOTEFIL2,                NOTE OF NEXT RECORD REQ'D      X55200000
               LSTSYSMS,                SYSTEM MACRO EDIT COMPLETED    X55300000
               ITERSW,                  SYSTEM VARIABLE DEFINITIONS    X55400000
               ,,,                                                      55500000
FSWITCH  DS    X                        FIRST RECORD WRITTEN NOTED      55600000
GTODALOC DS    F                        ORD SYMB REF DICT LENGTH        55700000
OSRAPDIS DS    H                        DISPL IN OSRD FOR NEXT ENTRY    55800000
SSDLNGTH DS    H                        LENGTH OF SSRD ENTRY            55900000
SSFLGVAL DS    C                        TEXT FLAG FOR SEQ SYMB REFER    56000000
SREFTYPE DS    C                        RECORD TYPE, SEQ SYMB REFER     56100000
         DS    2H                       FILLER FOR ALIGNMENT (REQ'D)    56200000
OSDLNGTH DS    H                        LENGTH OF OSRD ENTRY            56300000
OSFLGVAL DS    C                        TEXT FLAG FOR ORD SYMB REFER    56400000
OREFTYPE DS    C                        RECORD TYPE, ORD SYMB REFER     56500000
REGSAVE2 DS    F                        REGISTER SAVE AREA              56550000
PIOPARMB DS    F                        FULL I/O AREA LENGTH            56600000
PIOPARMA DS    F                        CURRENT I/O AREA ADDRESS        56700000
PIOPARMC DS    H                        CURRENT I/O AREA LENGTH         56800000
IOCID    DSW   IZRO,IONE,               OP CODE LENGTH                 X57800000
               ITWO,ITRE                OP CODE TYPE                    58000000
IOCLNG   EQU   IZRO+IONE                OP CODE LENGTH REDEFINED        58200000
*              00 = MACRO INSTRUCTION OR UNDEFINED OP CODE              58400000
*              01 = ONE BYTE LONG OP CODE                               58600000
*              11 = TWO BYTE LONG OP CODE                               58800000
IOCTYP   EQU   ITWO+ITRE                OP CODE TYPE REDEFINED          59000000
*              00 = MACHINE OP                                          59200000
*              01 = EXTENDED MNEMONICS                                  59400000
*              11 = ASSEMBLER OP                                        59600000
*        BITS 4-7 = CURRENTLY NOT USED, ALL ZERO                        59800000
*                                                                       60000000
CONCODE  DSW   B0,B1,B2,B3,B4,B5,B6,B7                                  60200000
*                                                                       60400000
ATTRSV   DSW   AT0,AT1,AT2,AT3,AT4,AT5,AT6,AT7                          60600000
ATT      EQU   AT6                      00000010                        60800000
ATL      EQU   AT6+AT7                  00000011                        61000000
ATS      EQU   AT5                      00000100                        61200000
ATI      EQU   AT5+AT7                  00000101                        61400000
ATK      EQU   AT5+AT6                  00000110                        61600000
ATN      EQU   AT5+AT6+AT7              00000111                        61800000
SLST     EQU   AT2                      SYSLIST                         62000000
*              0 = VARIABLE SYMBOL OTHER THAN SYSLIST                   62200000
*              1 = SYSLIST                                              62400000
ATSUBS   EQU   AT0+AT1                                                  62600000
*              00 = NON-SUBSCRIPT                                       62800000
*              01 = SINGLE SUBSCRIPT                                    63000000
*              11 = DOUBLE SUBSCRIPT                                    63200000
MCALL    DSW   MCLA,                    SETA TYPE                      X63400000
               MCLC,                    SETC TYPE                      X63600000
               MCMPLX,,                 COMPLEX STATE                  X63800000
               MSLST                    SYSLIST                         64000000
FLGBYT   DSW   VTYP1,VTYP2,VPTYP,VSNS,VSLS,VDIM,VSTP1,VSTP2             64200000
*  VTYP1+VTYP2 - TYPE-- 00 = GLOBAL                                     64400000
*                       01 = LOCAL                                      64600000
*                       10 = NOT DEFINED                                64800000
*                       11 = PARAMETER                                  65000000
*  VPTYP - POSITIONAL/KEYWORD-- 0 = POSITIONAL                          65200000
*                               1 = KEYWORD                             65400000
*  VSNS - SYSTEM/NON-SYSTEM-- 0 = NON-SYSTEM                            65600000
*                             1 = SYSTEM                                65800000
*  VSLS - SYSLIST/NON-SYSLIST-- 0 = NON-SYSLIST                         66000000
*                               1 = SYSLIST                             66200000
*  VDIM - DIMENSIONED/NON-DIMENSIONED-- 0 = NON-DIMENSIONED             66400000
*                                        1 = DIMENSIONED                66600000
*  VSTP1+VSTP2 - SUBTYPE-- 00 = A-TYPE                                  66800000
*                          01 = B-TYPE                                  67000000
*                          10 = PARAMETER                               67200000
*                          11 = C-TYPE                                  67400000
*                                                                       67600000
GAFLG    EQU   D0                       GBLA FLAG                       67800000
GBFLG    EQU   VSTP2                    GBLB FLAG                       68000000
GCFLG    EQU   VSTP1+VSTP2              GBLC FALG                       68200000
LAFLG    EQU   VTYP2                    LCLA FLAG                       68400000
LBFLG    EQU   VTYP2+VSTP2              LCLB FLAG                       68600000
LCFLG    EQU   VTYP2+VSTP1+VSTP2        LCLC FLAG                       68800000
PARMFLG  EQU   VTYP1+VTYP2+VSTP1        PARAMETER FLAG                  69000000
KPARMFLG EQU   PARMFLG+VPTYP            KEYWORD PARAMETER FLAG          69200000
*                                                                       69400000
NOTESAVE DS    XL8                      NOTE OF START OF MACRO DEFINTN  69800000
SAVENOTE DS    XL8                      NOTE OF START OF DICT DATA FILE 70200000
DICTCOME EQU   *                                                        70600000
REGSTACK DS    8F                       REGISTER SAVE AREA              70800000
         SPACE 3                                                        71000000
         DS    4F                       PATCH AREA                      71100000
ENDEDSCT DS    0D                       END OF MODULE COMMON AREA       71200000
*********************************************************************** 71400000
./  ADD  SSI=21950305,NAME=ERMS
* /* START OF SPECIFICATIONS ****                                       00050000
*02* PROCESSOR = ASSEMBLER                                              00100000
**** END OF SPECIFICATIONS ***/                                         00150000
         GENERR ERR1,'SYSTEM VARIABLE SYMBOL $        USED AS SYMBOLIC X00400000
               PARAMETER IN MACRO PROTOTYPE'                            00800000
         GENERR ERR2,'SYMBOLIC PARAMETER $        IS DUPLICATED IN SAME*01200000
                MACRO PROTOTYPE'                                        01600000
         GENERR ERR3,'SYSTEM VARIABLE SYMBOL $        USED IN OPERAND OX02000000
               F GLOBAL OR LOCAL DECLARATION'                           02400000
         GENERR ERR4,'GLOBAL OR LOCAL VARIABLE $        DUPLICATES A SYX02800000
               MBOLIC PARAMETER IN SAME MACRO DEFINITION'               03200000
         GENERR ERR5,'GLOBAL OR LOCAL VARIABLE SYMBOL $        DUPLICATX03600000
               ES PREVIOUS DEFINITION'                                  04000000
         GENERR ERR6,'UNDEFINED VARIABLE SYMBOL $        '              04400000
         GENERR  ERR7,'USAGE OF $        IS INCONSISTENT WITH ITS DECLAX04800000
               RATION'                                                  05200000
         GENERR ERR8,'CIRCULAR OPSYN STATEMENTS'                        05600000
         GENERR ERR9,'EDIT DICTIONARY SPACE EXHAUSTED'                  06000000
   GENERR ERR10,'SOURCE MACRO $        HAS BEEN PREVIOUSLY DEFINED'     06600000
         GENERR ERR12,'ICTL OR OPSYN STATEMENT APPEARS TOO LATE IN THE X07200000
               PROGRAM'                                                 07250000
         GENERR ERR13,'OPSYN NAME FIELD NOT ORDINARY SYMBOL, OR OPSYN OX07600000
               PERAND FIELD NOT ORDINARY SYMBOL OR BLANK'               08000000
         GENERR ERR14,'INVALID OPCODE IN OPSYN OPERAND OR NAME FIELD'   08050000
         GENERR ERR16,'ILLEGAL OR INVALID NAME FIELD'                   08400000
         GENERR ERR17,'.* COMMENTS STATEMENT IS ILLEGAL OUTSIDE MACRO DX08800000
               EFINITION'                                               09200000
         GENERR ERR18,'MORE THAN 5 ERRORS ON THIS STATEMENT, ERROR ANAL*09600000
               YSIS OF THIS STATEMENT IS TERMINATED'                    09650000
         GENERR ERR19,'INVALID OPERAND ON ICTL OR ISEQ STATEMENT'       10400000
         GENERR ERR21,'INVALID TERM IN OPERAND'                         11000000
         GENERR ERR22,'ICTL STATEMENT IS ILLEGAL IN COPY CODE'          11500000
         GENERR ERR23,'ILLEGAL MACRO, MEND, OR MEXIT STATEMENT-  MAY APX12000000
               PEAR ONLY WITHIN MACRO DEFINITIONS'                      12400000
    GENERR ERR24,'UNPAIRED PARENS, OR BLANK FOUND INSIDE PAIRED PARENS' 12800000
         GENERR ERR25,'STATEMENT OUT OF SEQUENCE'                       13200000
         GENERR ERR26,'CHARACTERS APPEAR BETWEEN THE BEGIN AND CONTINUEX13600000
                COLUMNS ON CONTINUATION CARD'                           14000000
         GENERR ERR27,'ICTL, ISEQ, MACRO, OR OPSYN STATEMENT APPEARS INX14400000
                A MACRO DEFINITION'                                     14800000
       GENERR ERR28,'ILLEGAL PROTOTYPE KEYWORD PARAMETER DEFAULT VALUE' 15200000
         GENERR ERR29,'$        IS AN ILLEGAL OPERAND IN A GLOBAL OR LOX15600000
               CAL DECLARATION'                                         16000000
         GENERR ERR30,'DECLARED DIMENSION OF $        IS ILLEGAL'       16400000
         GENERR ERR31,'SET STATEMENT NAME NOT A VARIABLE SYMBOL, OR SETX16800000
                STATEMENT NAME INCONSISTENT WITH DECLARED TYPE'         17200000
         GENERR ERR32,'$         APPEARS IMPROPERLY IN THE OPERAND OF TX17600000
               HIS STATEMENT'                                           18000000
         GENERR ERR33,'$         IS AN INVALID LOGICAL OPERATOR'        18400000
         GENERR ERR35,'QUOTES NOT PAIRED, OR ILLEGAL TERMINATION OF QUOX18800000
               TED STRING'                                              18850000
         GENERR ERR36,'ATTRIBUTE REFERENCE FOR $        IS INVALID'     19200000
         GENERR ERR37,'$        IS AN ILLEGAL SUBSCRIPT'                20000000
         GENERR ERR38,'$        IS AN INVALID SELF-DEFINING TERM'       20800000
         GENERR ERR39,'$        IS AN INVALID VARIABLE SYMBOL'          21200000
         GENERR ERR42,'PARAMETER IN MACRO PROTOTYPE OR MACRO INSTRUCTIO*22000000
               N EXCEEDS 255 CHARACTERS'                                22400000
         GENERR ERR43,'MACRO PROTOTYPE STATEMENT HAS INVALID OP CODE'   23000000
         GENERR ERR46,'STATEMENT COMPLEXITY EXCEEDED'                   23600000
         GENERR ERR47,'UNEXPECTED END OF FILE ON SYSTEM INPUT (SYSIN)'  24000000
         GENERR ERR48,'ICTL STATEMENT HAS NO OPERAND'                   24400000
      GENERR ERR49,'COPY STATEMENT OPERAND NOT A VALID ORDINARY SYMBOL' 24800000
         GENERR ERR50,'COPY STATEMENT DOES NOT HAVE AN OPERAND'         25200000
       GENERR ERR51,'UNEXPECTED END OF DATA ON SYSTEM LIBRARY (SYSLIB)' 25600000
         GENERR ERR52,'UNARY OPERATOR NOT A PLUS OR MINUS SIGN'         26000000
         GENERR ERR53,'OP CODE NOT FOUND ON FIRST OR ONLY CARD'         26600000
         GENERR ERR54,'INVALID OPERATION CODE'                          27200000
         GENERR ERR55,'MEND STATEMENT GENERATED'                        27250000
         GENERR ERR57,'DUPLICATE FACTOR $        IN SETC EXPRESSION NOTX27600000
                TERMINATED BY A RIGHT PARENTHESIS'                      28000000
         GENERR ERR58,'NO ENDING QUOTE ON SETC EXPRESSION'              28400000
         GENERR ERR59,'INVALID TERM IN LOGICAL EXPRESSION'              28800000
         GENERR ERR60,'END STATEMENT GENERATED'                         28850000
         GENERR ERR61,'COPY NEST GREATER THAN FIVE'                     29200000
         GENERR ERR62,'REQUIRED OPERAND FIELD MISSING'                  29600000
         GENERR ERR64,'INTERLUDE DICTIONARY SPACE EXHAUSTED'            30000000
         GENERR ERR65,'EXPRESSION 2 OF EQU SYMBOL $        NOT IN RANGEX30050000
                0-65535'                                                30100000
         GENERR ERR66,'EXPRESSION 3 OF EQU SYMBOL $        NOT IN RANGEX30150000
                0-255'                                                  30250000
         GENERR ERR67,'DECLARED DIMENSION FOR GLOBAL VARIABLE $        X30400000
               IN $        $        IS INCONSISTENT'                    30800000
         GENERR ERR68,'COPY MEMBER $         NOT FOUND IN LIBRARY'      31200000
         GENERR ERR69,'TOO MANY CONTINUATION CARDS, TWO ALLOWED'        31600000
         GENERR ERR70,'SUBSTRING NOTATION IS NOT DELIMITED BY COMMA OR X32000000
               RIGHT PARENTHESIS'                                       32400000
         GENERR ERR73,'AGO OR AIF OPERAND NOT A SEQUENCE SYMBOL'        32800000
         GENERR   ERR74,'SEQUENCE SYMBOL $        IS MULTIPLY DEFINED IX33200000
               N $        $        '                                    33600000
         GENERR   ERR76,'SEQUENCE SYMBOL $        IS UNDEFINED IN $    X34400000
                    $        '                                          34800000
         GENERR   ERR78,'UNDEFINED OP CODE'                             35200000
         GENERR ERR80,'ATTRIBUTE REFERENCE TO UNDEFINED SYMBOL'         35600000
         GENERR ERR81,'DECLARED TYPE FOR GLOBAL VARIABLE $       IN $  X36000000
                     $        IS INCONSISTENT'                          36400000
         GENERR ERR85,'MACRO HEADER MISSING, MACRO NOT EXPANDABLE'      36800000
         GENERR ERR87,'INVALID MACRO DEFINITION PROTOTYPE, MACRO NOT EXX37200000
               PANDABLE'                                                37600000
         GENERR ERR88,'LIBRARY MACRO PROTOTYPE DOES NOT MATCH MEMBER NAX38000000
               ME - MACRO NOT EXPANDABLE'                               38400000
         GENERR ERR89,'GENERATION-TIME DICTIONARY SPACE EXHAUSTED'      38800000
         GENERR   ERR90,'UNDEFINED SEQUENCE SYMBOL ENCOUNTERED DURING CX39200000
               ONDITIONAL ASSEMBLY'                                     39600000
         GENERR   ERR91,'KEYWORD PARAMETER $        IS DUPLICATED ON SAX40000000
               ME MACRO CALL'                                           40400000
         GENERR   ERR92,'KEYWORD PARAMETER $        UNDEFINED IN MACRO X40800000
               DEFINITION'                                              41200000
         GENERR ERR100,'DICTIONARY SPACE EXHAUSTED, NO SKELETION DICTIOX41600000
               NARY BUILT'                                              42000000
         GENERR ERR101,'GENERATED OP CODE INVALID OR IS UNDEFINED'      42400000
         GENERR ERR102,'GENERATED OP CODE IS BLANK'                     42800000
         GENERR ERR104,'MORE THAN ONE TITLE STATEMENT NAMED'            43200000
         GENERR ERR105,'GENERATED FIELD EXCEEDS 255 CHARACTERS'         43600000
         GENERR ERR107,'CHARACTER STRING USED AS AN ARITHMETIC TERM EXCX44000000
               EEDS 10 CHARACTERS'                                      44400000
         GENERR ERR108,'CHARACTER STRING USED AS AN ARITHMETIC TERM CONX44800000
               TAINS NON-DECIMAL CHARACTERS'                            45200000
         GENERR ERR109,'CHARACTER STRING USED AS AN ARITHMETIC TERM IS X45600000
               A NULL STRING'                                           46000000
         GENERR ERR110,'ARITHMETIC OVERFLOW IN INTERMEDIATE RESULT OF SX46400000
               ETA EXPRESSION'                                          46800000
      GENERR ERR111,'SUBSCRIPT EXPRESSION HAS A ZERO OR NEGATIVE VALUE' 47200000
         GENERR ERR112,'SUBSCRIPT EXPRESSION EXCEEDS DECLARED DIMENSIONX47600000
               '                                                        47800000
         GENERR ERR113,'ILLEGAL REFERENCE MADE TO A PARAMETER THAT IS AX48000000
                SUBLIST'                                                48400000
        GENERR ERR114,'NEGATIVE DUPLICATION FACTOR IN CHARACTER STRING' 48800000
         GENERR ERR115,'FIRST EXPRESSION IN SUBSTRING NOTATION HAS ZEROX49200000
                OR NEGATIVE VALUE'                                      49600000
         GENERR ERR116,'SECOND EXPRESSION IN SUBSTRING NOTATION HAS NEGX50000000
               ATIVE VALUE'                                             50400000
         GENERR ERR117,'FIRST EXPRESSION IN SUBSTRING NOTATION EXCEEDS X50800000
               THE LENGTH OF THE STRING'                                51200000
         GENERR ERR118,'THE ACTR LIMIT HAS BEEN EXCEEDED'               51600000
         GENERR ERR119,'ILLEGAL TYPE ATTRIBUTE REFERENCE'               51800000
         GENERR ERR120,'ILLEGAL LENGTH ATTRIBUTE REFERENCE'             52000000
         GENERR ERR121,'ILLEGAL COUNT (K'') ATTRIBUTE REFERENCE'        52400000
         GENERR ERR122,'ILLEGAL NUMBER (N'') ATTRIBUTE REFERENCE'       52800000
         GENERR ERR123,'ILLEGAL SCALE ATTRIBUTE REFERENCE'              53200000
         GENERR ERR124,'ILLEGAL INTEGER ATTRIBUTE REFERENCE'            53600000
         GENERR ERR125,'INVALID NAME- ILLEGAL EMBEDDED CHARACTER OR NONX54000000
               -ALPHABETIC FIRST CHARACTER'                             54400000
         GENERR ERR126,'MORE THAN 5 ERRORS IN THIS STATEMENT, PROCESSINX54800000
               G OF THE STATEMENT IS TERMINATED'                        55200000
         GENERR ERR127,'VALUE OF CHARACTER STRING USED IN ARITHMETIC COX55600000
               NTEXT EXCEEDS 2,147,483,647'                             56000000
         GENERR ERR128,'GENERATED OP CODE EXCEEDS 8 CHARACTERS'         56400000
    GENERR ERR129,'GENERATED SYMBOL IN NAME FIELD EXCEEDS 8 CHARACTERS' 56800000
     GENERR ERR130,'FIRST SUBSCRIPT OF &&SYSLIST REFERENCE IS NEGATIVE' 57200000
         GENERR ERR131,'INCONSISTENT GLOBAL VARIABLE DECLARATION, SETX X57600000
               INSTRUCTION IGNORED'                                     58000000
         GENERR ERR132,'REFERENCE TO INCONSISTENTLY DECLARED GLOBAL VARX58400000
               IABLE RESULTS IN ZERO VALUE'                             58800000
         GENERR ERR133,'NO WORK SPACE FOR OPEN CODE SKELETON DICTIONARY*59200000
               '                                                        59202000
         GENERR ERR157,'DC OPERAND VALUE TOO LONG'                      59610000
         GENERR ERR158,'NAME OF STATEMENT IN DSECT USED IN RELOCATABLE *59650000
               ADDRESS CONSTANT'                                        59700000
         GENERR ERR159,'RELOCATABLE EXPRESSION AS EXPLICIT DISPLACEMENT*59750000
                IN S-TYPE CONSTANT'                                     59800000
         GENERR ERR161,'INVALID LITERAL #  '                            60000000
         GENERR ERR162,'VALUE ERROR- SHOULD BE BETWEEN 0 AND 9 - #  '   60400000
         GENERR ERR163,'MISSING OR INVALID SYMBOL IN NAME FIELD'        60800000
         GENERR ERR164,'INVALID OR ILLEGAL START STATEMENT'             61200000
         GENERR ERR165,'NULL PUNCH OPERAND OR PUNCH OPERAND EXCEEDS 80 X61600000
               CHARACTERS'                                              62000000
         GENERR ERR167,'SYMBOL FILE OUT OF STEP'                        62400000
         GENERR ERR168,'AN ARITHMETIC EXPRESSION NOT USED IN CONDITIONAX62800000
               L ASSEMBLY CONTAINS MORE THAN 20 TERMS'                  63200000
         GENERR ERR169,'INVALID SELF-DEFINING TERM #  '                 63600000
         GENERR ERR170,'TWO ADJACENT BINARY OPERATORS, OR BINARY OPERATX64000000
               OR EXPECTED BUT NOT FOUND #  '                           64400000
         GENERR ERR171,'TITLE STATEMENT OPERAND EXCEEDS 100 CHARACTERS' 64800000
         GENERR ERR172,'VALUE OF ORG OPERAND IS LESS THAN THE CONTROL SX65000000
               ECTION STARTING ADDRESS'                                 65200000
         GENERR ERR173,'ONE OR MORE SYMBOLS IN AN ORG OPERAND DO NOT BEX65600000
               LONG TO THE CURRENT CSECT, DSECT, OR COM'                66000000
         GENERR ERR174,'ORG OPERAND IS ABSOLUTE, MUST BE RELOCATABLE'   66400000
         GENERR  ERR175,'OPERAND SHOULD BEGIN WITH A QUOTE'             66800000
         GENERR  ERR176,'UNPAIRED AMPERSAND #  '                        67200000
         GENERR ERR177,'MISSING OPERAND'                                67600000
         GENERR  ERR178,'SYNTAX ERROR #  '                              68000000
         GENERR  ERR179,'OPERAND SUBFIELD #   MUST BE ABSOLUTE'         68400000
         GENERR  ERR180,'OPERAND 2 OF CNOP MUST BE EITHER 4 OR 8'       68800000
         GENERR  ERR181,'OPERAND 1 OF CNOP MUST BE 0, 2, 4 OR 6'        69200000
         GENERR ERR182,'OPERAND 1 OF CNOP IS NOT LESS THAN OPERAND 2'   69600000
         GENERR  ERR183,'MNOTE/CCW OPERAND EXCEEDS 255'                 70000000
      GENERR  ERR184,'INVALID RANGE ON CCW #  , 65535 IS MAXIMUM VALUE' 70400000
         GENERR  ERR185,'BLANK EXPECTED AS A DELIMITER #  '             70800000
         GENERR  ERR186,'INVALID SYMBOL #   OF ENTRY, EXTRN, OR WXTRN'  71200000
         GENERR  ERR187,'SYMBOL LONGER THAN 8 CHARACTERS #  '           71600000
         GENERR  ERR188,'$        IS AN UNDEFINED SYMBOL'               72000000
    GENERR  ERR189,'INVALID ENTRY OPERAND, LINKAGE CANNOT BE PERFORMED' 72400000
   GENERR  ERR190,'OPERAND OF PUSH STATEMENT IS NOT USING OR PRINT #  ' 72800000
         GENERR  ERR191,'PUSH LEVELS EXCEED 4 #  '                      73200000
    GENERR  ERR192,'OPERAND OF POP STATEMENT IS NOT USING OR PRINT #  ' 73600000
         GENERR  ERR193,'POP REQUEST NOT BALANCED BY PREVIOUS PUSH'     74000000
         GENERR  ERR194,'INVALID OPTION IN PRINT STATEMENT #  '         74400000
         GENERR  ERR195,'INVALID USING OR DROP STATEMENT #  '           74800000
         GENERR ERR196,'$        HAS BEEN PREVIOUSLY DEFINED'           75200000
         GENERR  ERR197,'*** MNOTE ***'                                 76000000
       GENERR  ERR198,'INVALID TYPE DECLARED ON DC/DS/DXD CONSTANT #  ' 76400000
         GENERR  ERR199,'INVALID LENGTH MODIFIER #  '                   76800000
         GENERR  ERR200,'INVALID SCALE MODIFIER #  '                    77200000
         GENERR  ERR201,'ILLEGAL OR INVALID EXPONENT MODIFIER IN DC/DS/X77600000
               DXD CONSTANT #  '                                        78000000
         GENERR  ERR202,'ARITHMETIC PRECISION OF FLOATING-POINT CONSTANX78400000
               T LOST #  '                                              78800000
         GENERR  ERR203,'L, D, E, F, H, OR Y-TYPE CONSTANT TRUNCATED, HX79200000
               IGH ORDER DIGITS LOST #  '                               79600000
         GENERR ERR204,'RELOCATABLE EXPRESSION IN A- OR Y-TYPE ADDRESS X80000000
               CONSTANT WITH BIT LENGTH SPECIFICATION NOT ALLOWED'      80400000
         GENERR  ERR205,'RELOCATABLE Y-TYPE CONSTANT, VALUE TRUNCATED TX80800000
               O RIGHTMOST 2 BYTES'                                     81200000
         GENERR  ERR206,'DUPLICATION FACTOR ERROR'                      81600000
         GENERR  ERR207,'OPERAND OF Q-TYPE CONSTANT DOES NOT NAME A DSEX82000000
               CT OR DXD'                                               82400000
         GENERR  ERR208,'DISPLACEMENT GREATER THAN X''FFF'''            82800000
         GENERR  ERR209,'ADDRESSABILITY ERROR- BASE AND DISPLACEMENT CAX83200000
               NNOT BE RESOLVED AND ARE SET TO 0'                       83600000
         GENERR  ERR210,'TOO FEW OPERANDS'                              84000000
         GENERR  ERR211,'TOO MANY OPERANDS'                             84400000
         GENERR  ERR212,'PREMATURE END OF OPERAND #  '                  84800000
         GENERR  ERR213,'COMPLEXLY RELOCATABLE EXPRESSION #  '          85200000
         GENERR  ERR214,'ILLEGAL USAGE OF LITERAL #  '                  85600000
     GENERR  ERR215,'ILLEGAL DELIMITER, RIGHT PARENTHESIS EXPECTED #  ' 86000000
         GENERR  ERR216,'ILLEGAL OPERAND FORMAT #  '                    86400000
         GENERR  ERR217,'RELOCATABILITY ERROR #  '                      86800000
         GENERR ERR218,'INVALID REGISTER SPECIFICATION - EVEN-NUMBERED X87200000
               REGISTER REQUIRED'                                       87600000
         GENERR  ERR219,'REGISTER OR IMMEDIATE FIELD OVERFLOW #  '      88200000
         GENERR  ERR220,'ALIGNMENT ERROR #  '                           88800000
         GENERR  ERR221,'ILLEGAL INDEX REGISTER OR LENGTH MODIFIER #  ' 89200000
         GENERR  ERR222,'INVALID INDEX REGISTER SPECIFIED #  '          89600000
         GENERR  ERR223,'RELOCATABLE INDEX REGISTER SPECIFIED #  '      90000000
         GENERR  ERR224,'LENGTH ERROR #  '                              90400000
   GENERR  ERR225,'RELOCATABLE LENGTH FIELD IN MACHINE INSTRUCTION #  ' 90800000
 GENERR  ERR226,'BASE REGISTER OF MACHINE INSTRUCTION NOT ABSOLUTE #  ' 91200000
   GENERR  ERR228,'RELOCATABLE DISPLACEMENT IN MACHINE INSTRUCTION #  ' 91600000
         GENERR  ERR229,'POSSIBLE REENTERABILITY ERROR #  '             92000000
         GENERR  ERR230,'BASE REGISTER NUMBER GREATER THAN 15 #  '      92400000
         GENERR  ERR231,'SYMBOL NOT PREVIOUSLY DEFINED - $        '     92800000
         GENERR  ERR233,'MORE THAN 6 LEVELS OF PARENTHESES #  '         93200000
         GENERR  ERR234,'PREMATURE END OF EXPRESSION #  '               93600000
         GENERR  ERR235,'ARITHMETIC OVERFLOW #  '                       94000000
         GENERR  ERR236,'ILLEGAL CHARACTER IN EXPRESSION #  '           94400000
         GENERR  ERR237,'CIRCULAR DEFINITION'                           94800000
         GENERR  ERR238,'ILLEGAL AMPERSAND IN SELF-DEFINING TERM #  '   95200000
         GENERR  ERR239,'INVALID FLOATING POINT CHARACTERISTIC'         95600000
         GENERR ERR240,'CHARACTER STRING OR SELFDEFINING TERM TERMINATEX96000000
               D BEFORE ENDING QUOTE FOUND'                             96400000
         GENERR ERR241,'SECOND OPERAND OF CCW NOT BETWEEN 0 AND X''FFFFX96800000
               FF'''                                                    97200000
         GENERR ERR242,'SPACE OPERAND NOT A SINGLE POSITIVE DECIMAL SEL*97600000
               FDEFINING TERM'                                          97650000
         GENERR ERR243,'FIRST CCW OPERAND IS NEGATIVE'                  98000000
         GENERR ERR244,'BITS 38 AND 39 OF CCW OPERAND NOT ZERO'         98050000
         GENERR ERR246,'LOCATION COUNTER OVERFLOW'                      98400000
         GENERR ERR254,'ILLEGAL FORMAT OF SECOND OPERAND OF END STATEME*98410000
               NT'                                                      98460000
         GENERR ERR255,'FIXED OR FLOATING POINT EXPRESSION ERROR #  '   98800000
./  ADD  SSI=21950307,NAME=EVALWORK
         MACRO                                                          01000000
&NAME    EVALWORK &DUMMY,&MAXTERM=20,&MAXPARN=6                         02000000
         LCLA  &I                                                       03000000
.*                                                                      03050000
.*             CHANGES TO RELEASE 3                                     03100000
.*             CHANGES TO RELEASE 2                                     03150000
.*             CHANGES TO RELEASE 1                                     03200000
.*                                                                      03250000
.*  GENERATES THE EVALUATION ROUTINE WORK AREA                          03300000
.* IN PHASE COMMON. THIS WORK AREA IS USED BY                           03350000
.* IFNX4V AND IFNX5V RESPECTIVLY                                        03450000
.*                                                                      03500000
SELFDEFN DBV   SELFDEF(0)                                               04000000
EVALMODE DSW   SUBLIST,PRDEFREQ,DCOP                                    05000000
CLCLNG   DS    H                                                        06000000
IMPLNG   DS    H                                                        07000000
EVALREGS DS    0A                                                       08000000
ATPTR    DS    A(TERMS)                                                 09000000
ALPTR    DS    A(RLIST)                                                 10000000
AOPTR    DS    A(OPRNS-1)                                               11000000
ERRPTR   DS    F                        ERROR COLUMN POINTER            12000000
OPNEND   DS    F                                                        13000000
&I       SETA  (&MAXTERM+1)/2*2                                         14000000
         DS    0D                       CAUSE DOUBLE WORD ALIGNMENT     15000000
RLIST    DS    &I.H                                                     16000000
&I       SETA  &MAXPARN*16+25                                           17000000
EVALWORK DS    0XL&I                                                    18000000
FIRST    DBV   ,                                                        19000000
STATUS   DBV   STATUS1(1),STATUS2(2)                                    20000000
         DS    3H                                                       21000000
RELOCTR  DBV   NORELOC(0)                                               22000000
         DS    X                                                        23000000
         DS    3H                                                       24000000
EVALSW   DSW   ,ENDOFEXP,LOCTREF,LNGQUOTE                               25000000
EVALSW1  DSW   ,EVALERR,SDVSIZE,RELOCER,OVERFLO,NOTDEFN,,FATALER        26000000
         ORG   EVALSW1                                                  27000000
         DBV   COMPLEX(0)                                               28000000
         DS    3H                                                       29000000
PARENCNT DS    0H                                                       30000000
         DS    X                                                        31000000
         DBV   NOPAREN(0),MAXPARN(&MAXPARN)                             32000000
         DS    3H                                                       33000000
SHIFTN   DBV   SHIFTB(1),SHIFTD(3),SHIFTH(4),SHIFTC(8)                  34000000
         DBV   MAXCHAR(4),MAXHEX(8),MAXDEC(10),MAXBIT(32)               35000000
         ORG   FIRST                    ORIGIN                          36000000
&I       SETA  &MAXPARN*4+6                                             37000000
TERMS    DS    &I.F                                                     38000000
         DBV   ENDPARN(0)                                               39000000
&I       SETA  &MAXPARN*4+4                                             40000000
OPRNS    DS    &I.X                                                     41000000
         DS    X                        NOT USED                        41300000
XSSAV    DS    H                        TEST ESDID                      41600000
DSECT2   DSECT ,                        TERM STACK POINTER              42000000
         ORG   DSECT2                   ORIGIN                          43000000
TERM1CNT DS    F                                                        44000000
TERM1    DS    F                                                        45000000
TERM2CNT DS    F                                                        46000000
TERM2    DS    F                                                        47000000
DSECT3   DSECT ,                        RELOCATION LIST POINTER         48000000
         ORG   DSECT3                   ORIGIN                          49000000
ESDID    DS    H                                                        50000000
NEXTESD  DS    H                                                        51000000
JTEXT    DSECT ,                        OPERATOR STACK POINTER          52000000
         ORG   JTEXT                    ORIGIN                          53000000
OLDOP    DBV   DEL0(JLPARN),ADD0(JPLUS),SUB0(JMINUS),MUL0(JASTER),     ,54000000
               DIV0(JSLASH),UNY0(JSLASH+1)                              55000000
NEWOP    DBV   DEL1(JLPARN),ADD1(JPLUS),SUB1(JMINUS),MUL1(JASTER),     ,56000000
               DIV1(JSLASH),UNY1(JSLASH+1)                              57000000
DSECT5   DSECT ,                        INPUT POINTER                   58000000
         ORG   DSECT5                   ORIGIN                          59000000
CHAR1    DS    X                        CURRENT CHARACTER               59050000
CHAR2    DS    X                        NEXT CHARACTER                  59100000
CHAR3    DS    X                        NEXT CHARACTER                  59150000
DSECT14  DSECT ,                        INPUT POINTER                   80000000
         ORG   DSECT14                  ORIGIN                          81000000
         DBV   BQUOTE(JB),CQUOTE(JC),XQUOTE(JX),LQUOTE(JL)              82000000
&SYSECT  DSECT ,                        RESUME DSECT                    83000000
         MEND                                                           84000000
./  ADD  SSI=71710232,NAME=GENCOM
*D776500                                                       @OX10944 00050006
*A160000                                                       @OX10944 00100006
GENCOM   DSECT                                                          00400000
         USING GENCOM,R7                BASE FOR MODULE COMMON          00800000
         SPACE                                                          01200000
*        DYNAMIC POINTERS AND WORK VALUES                               01600000
         SPACE                                                          02000000
TXTIN    DS    F                        SAVE INPUT FIXED TEXT POINTER   03600000
TXTOUT   DS    F                        SAVE OUTPUT FIXED TEXT POINTER  04000000
LCR      DS    F                        LOCATION COUNTER WORK AREA      05200000
GENRTRN  DS    F                        SAVE AREA FOR GENFLD RETURN REG 06000000
GENPTR   DS    F                        OUTPUT LENGTH FIELD POINTER     06400000
STRRTRN  DS    F                        GENSTRNG RETURN REGISTER        06800000
OUTPTR   DS    F                        OUTPUT TEXT POINTER SAVE        07200000
RESRTRN  DS    F                        RESOLVE RETURN REGISTER SAVE    07600000
GENREGS  DS    4F                       SAVE R2 THROUGH R5              08800000
INFIXRTN DS    F                        INFIX ROUTINE RETURN REGISTER   10000000
ESTKNDX  DS    F                        DISPL TO NEXT ERROR STK ENTRY   10400000
NEWSTRNG DS    F                        NEW CHARACTER STRING START      10800000
ERRCNT   DS    H                        COUNT OF ERRORS LOGGED          11200000
STRNGLN  DS    H                        LENGTH OF THAT STRING           11600000
         SPACE                                                          12400000
*        SWITCHES FOR GENERATION                                        12800000
         SPACE                                                          13200000
INHI     DSW   INHIBIT                  ESDS STARTED SWITCH             13600000
EVALSW01 DSW   GLOBAL,                  CURRENT TERM IS GLOBAL REFERENCE14000000
               CHARMODE,                CHARACTER STRING OUTPUT WANTED X14400000
               CTYPE,                   TERM IS CHARACTER STRING       X14800000
               INMACDEF,                ON AT MACRO, OFF AT MEND       X15200000
               CALLING,                 PROCESSING MCALL STATEMENT     X15600000
               FRCMI,                   FIRST MACHINE INSTR    @OX10944X16000006
               INMACRO,                 EXPANDING A MACRO              X16400000
               NOCALL                   ABORT THE CALL IN PROCESS       16800000
EVALSW02 DSW   FRSTTITL,                TITLE WITH NAME ENCOUNTERED    X17200000
               ERR105SW,                ERR105 LOGGED ONCE ALREADY     X17600000
               PREVDEF,                 PARAM DEFINITION ALREADY FOUND X18000000
               SUBSCR2,                 SUBSCRIPT 2 ON SYSLIST TERM    X18400000
               FLUSH1,                  FLUSH TO EARLY END OF FILE     X18800000
               GENEND,                  END STMT HIT INSIDE MACRO      X19200000
               FLUSH2,                  EARLY END OF FILE REACHED      X19400000
               FLUSH3                   END STMT TO BE GENERATED        19600000
EVALSW03 DSW   CCOMP,                   DO CHARACTER COMPARE           X20000000
               SUBLIST                  PROCESSING MACRO SUBLIST        21200000
         SPACE                                                          21600000
*        STACK MANAGEMENT                                               22000000
         SPACE                                                          22400000
STACKLVL DS    F                        NEXT AVAILABLE POSITION         22800000
STACKEND DS    A(0)                     END OF STACK                    23600000
STRPTR1  DS    A(0)                     STRING 1 CURRENT                24000000
STRPTR2  DS    A(0)                     STRING 2 CURRENT                24400000
         SPACE                                                          24800000
*        MACRO LEVEL CONTROL                                            25200000
         SPACE                                                          25600000
MACROLVL DS    F                        MACRO NEST COUNT                25700000
         SPACE                                                          25800000
ENTRYNDX DS    0H                       DICTIONARY ROUTINES INDEX       25900000
         DS    XL1                      HALF-WORD PAD                   26000000
NDXVAL   DS    XL1                      ENTRY INDEX TO BRANCH TABLE     26100000
SYSNDX   DS    F                        &SYSNDX VALUE                   26200000
SYSECT   DS    0CL9                     &SYSECT VALUE                   26300000
SYSECTL  DS    C                             LENGTH                     26400000
GENSPEND EQU   *                                                        26500000
SYSECTS  DS    CL8                           STRING                     26600000
         SPACE                                                          27200000
*        EVALUATION LIMITS                                              27600000
         SPACE                                                          28000000
MAXCMPLX EQU   25                       MAXIMUM OF 25 TERMS IN STACK    28400000
TERMLNTH EQU   6                        LENGTH OF EACH STACK ENTRY      28800000
         SPACE                                                          29200000
*        EVALUATION WORK AREA                                           29600000
         SPACE                                                          30000000
         ORG   *+3-((*-GENCOM)-((*-GENCOM)/4)*4)  STACK STARTS ON NEXT X30400000
                                                  FULLWORD-1            30800000
         SPACE                                                          31200000
STKENTRY EQU   ((TERMLNTH+3)/4)*4       LENGTH OF EACH STACK ENTRY--   X31600000
                                          (ROUNDED UP TO FULL WORDS)    32000000
         SPACE                                                          32400000
STACK    EQU   *                        STACK NAME                      32800000
         SPACE                                                          33200000
STACKFLG DS    C                        FLAG BYTE                       33600000
STACKVAL DS    F                        VALUE, ON FULL WORD BOUNDARY    34000000
         SPACE                                                          34400000
         ORG   STACK+STKENTRY           START OF NEXT STACK ENTRY       34800000
         SPACE                                                          35200000
STACKNXT EQU   *                        NEXT STACK ENTRY                35600000
         SPACE                                                          36000000
NEXTFLG  DS    C                        NEXT ENTRY FLAG BYTE            36400000
NEXTVAL  DS    F                        NEXT ENTRY VALUE--FULL WORD     36800000
         SPACE                                                          37200000
         ORG   STACK                    REPOSITION TO STACK START       37600000
         SPACE                                                          38000000
EVALSTCK DS    (MAXCMPLX)CL(STKENTRY)   AND PUT IN THE WHOLE STACK      38400000
ENDSTACK EQU   *-STKENTRY               END OF STACK--STOPPER           38800000
ERRSTK   DS    CL(11*6)                 STACK FOR GENERATION ERRORS     39200000
         SPACE                                                          39600000
UNPKBUF  DS    CL16                     UNPACK WORKSPACE                40000000
UNPKLAST EQU   UNPKBUF+15               LAST BYTE                       40400000
UNPKEND  EQU   UNPKBUF+16               END OF STRING                   40800000
         SPACE                                                          41200000
STRING1  DS    CL256                    PRIMARY CHARACTER BUFFER.  FIRST41600000
                                          BYTE IS CURRENT STRING LENGTH 42000000
STRING2  DS    CL256                    SECONDARY CHARACTER BUFFER.     42400000
         SPACE                                                          42800000
*                                                                       44800000
*        START OF GENERATE PHASE COMMON INITIALIZED AND USED BY THE     45200000
*              GENERATE PHASE DICTIONARY ROUTINES.                      45600000
*                                                                       46000000
DICTCOMS DS    0F                                                       46400000
FREESTRT DS    F                        PTR TO START OF WORK SPACE      46800000
FREEEND  DS    F                        PTR TO END OF WORK SPACE        47200000
OVLYSTRT DS    F                        PTR TO SPACE FOR LOCAL DICTS    47600000
SPACEAL  DS    F                        PTR TO CURRENT SPACE, LOW END   48000000
SPACEAH  DS    F                        PTR TO CURRENT SPACE, HI END    48400000
SPACEAE  DS    F                        LENGTH OF CURRENT SPACE         48800000
REGSAVEA DS    F                        REGISTER SAVE AREA              49200000
REGSAVEB DS    F                        REGISTER SAVE AREA              49600000
OPSNSTRT DS    F                        PTR TO START OF OPSYN TABLE     50000000
MDVPTRSV DS    F                        PTR TO CURRENT MDV ENTRY        50400000
HIBYTE0  DS    F                        FULL-WORD WORK AREA             50800000
OSRDSTRT DS    F                        PTR TO START OF ORD SYMB REF DT 51200000
GDSTRT   DS    F                        PTR TO START OF GBL DICTIONARY  51600000
MDVSTRT  DS    F                        PTR TO START OF MDV             52000000
CURRDICT DS    F                        PTR TO HEADER OF CURRENT DICT   52400000
CURRPARM DS    F                        PTR TO CURRENT PARAM TABLE      52800000
CURRGLBL DS    F                        PTR TO CURRENT GLOBAL VECTOR    53200000
CURRSEQS DS    F                        PTR TO CURRENT SEQ SYMB REF DCT 53600000
CURRLOCL DS    F                        PTR TO CURRENT LOCAL DICTIONARY 54000000
CURRPOST DS    F                        PTR TO CURRENT POSIT PARAM VCTR 54400000
CURRKEYD DS    F                        PTR TO CURRENT KEYWD PARAM VCTR 54800000
PRMTBLAD EQU   SPACEAL                  PTR TO START OF PARAM TABLE     55200000
PRMTBLDS DS    F                        CURRENT LENGTH OF PARAM TABLE   55600000
PVECTPTR EQU   SPACEAH                  PTR TO CURRENT PARAM VECTOR     56000000
PVECTDIS DS    F                        CURRENT LENGTH OF POSIT VECTOR  56400000
KVECTDIS DS    F                        CURRENT LENGTH OF KEYWD VECTOR  56800000
KCHANPTR DS    F                        LINK TO KEYWORD PARAM CHAIN     57200000
PRMPTRSV DS    F                        PTR TO BASE OF PARAM TBL ENTRY  57600000
SUBCNT   DS    H                        CURRENT SUBOPERAND COUNT        58000000
SUBLEN   DS    H                        CURRENT SUBLIST CHARAC COUNT    58400000
SUBVCTDS DS    F                        CURRENT LENGTH OF SUBLIST VECTR 58800000
ACTRCNT  DS    F                        CURRENT ACTR VALUE              59200000
PIOPARMB DS    F                        LENGTH OF I/O AREA              59600000
PIOPARMA DS    F                        PTR TO CURRENT I/O AREA         60000000
PIOPARMC DS    H                        LENGTH OF CURRENT I/O AREA      60400000
NOFSYSLS DS    H                        N ATTR OF &SYSLIST              60800000
PPARMCNT DS    F                        CURRENT POSIT PARAM COUNT       61200000
ALTPTRSV DS    F                        ALTERNATE REGISTER SAVE AREA    61600000
PRMSWTCH DSW   PASSPARM,                PARAM PASSED AS PARAM TO INNER X62000000
               GBLCALL,                 GLOBAL DICTIONARY REFERENCE    X62400000
               REFFLAG,                 DICTIONARY REFERENCE IN PROCESSX62800000
               KEYFLG,                  KEYWORD PARAMETER IN PROCESS   X63200000
               DEFLG,                   DEFAULT VALUE FOR KEYWORD      X63600000
               BYFLG,                   BYPASS DEFAULT SUBLIST         X64000000
               ENFLG                    ENTER DEFAULT SUBLIST           64400000
NOTESAVE DS    XL8                      SAVE AREA, NOTE END OF CALL     64800000
SAVENOTE DS    XL8                      SAVE AREA, NOTE END OF PROTOTYP 65200000
KEYLENSV DS    XL1                      SAVE AREA, KEYWORD SYMB LENGTH  65600000
DICTCOME EQU   *                                                        70000000
*                                                                       70800000
*        END OF GENERATE PHASE COMMON INITIALIZED AND USED BY THE       71200000
*              GENERATE PHASE DICTIONARY ROUTINES.                      71600000
*                                                                       72000000
         SPACE                                                          72200000
REGSTACK DS    8F                       REGISTER SAVE AREA, DICT RTNS   72500000
RECURSTK DS    8F                       RECURRSIVE SAVE, DICT RTNS      72800000
RESOLVST DS    8F                       REGISTER SAVE AREA, RESOLVE RTN 73100000
EVALST   DS    8F                       REGISTER SAVE AREA, EVAL RTN    73400000
GENSTRST DS    8F                       REGISTER SAVE AREA, GENSTRNG RT 73700000
         SPACE                                                          74400000
         ORG   UNPKBUF                  LOCTR WORK SPACE OVERLAY        74800000
SAVVY    DS    2F                       LOCTR SAVE AREA                 75200000
LFLGA    DS    F                        LOCTR WORK AREA                 75600000
SYMBLCNT DS    H                        SYMBOL COUNT                    76000000
PARENCNT DS    H                        PAREN LEVEL                     76400000
NAMELNG  DS    H                        LABEL INDICATOR                 76800000
SUPPRESW DSW   WPSOP,VCONW,MODW,,,,,SUPPRESS SCAN INDICATORS            77200000
SUPPRESV DSW   VPSOP,VCONV,MODV,,,,,SUPPREST SCAN INDICATORS            77600000
         ORG   ,                        RESUME                          78000000
         SPACE                                                          78400000
*        GENERATOR PATCH AREA                                           78800000
         SPACE                                                          79200000
         DS    4F                       PATCH AREA                      79600000
GENCOM99 EQU   *                        END OF GENERATOR COMMON         80000000
./  ADD  SSI=21950293,NAME=GENERR
         MACRO                                                          00600000
         GENERR &CODE,&LIST             PROTOTYPE FOR GENERR            01200000
         GBLC  &ERCD(255)                                               01800000
         GBLB  &GENSW                                                   02400000
         LCLC  &CN                                                      03000000
         LCLC  &LET,&GEN(8)                                             03600000
         LCLA  &A,&K,&I                                                 04200000
         LCLA  &C,&CT,&CA                COUNTERS                       04800000
.* GENERATES ERROR MESSAGES AND A BRANCH TABLE TO THEM                  05400000
.* IN CSECT X6C00.  THE CODE MUST BE A SYMBOLIC NUMBER AND THE MSG      06000000
.* MUST BE A QUOTED STRING.  ACCEPTS SAME DATA AS JGENIN MACRO.  MSG    06600000
.* MUST CONTAIN  BLANK-DOLLAR-BLANK WHEREVER APPENDED DATA IS TO BE     07200000
.* INSERTED AND BLANK- POUND -BLANK WHEREVER A COLUMN POINTER IS TO BE  07800000
.* INSERTED INTO THE MESSAGE.  USE THESE TWO CHARACTERS ONLY FOR THIS   08400000
.* PURPOSE.   ALSO GENERATES EQUATES AND COMMENTS IN THE DSECT JERMSGCD 09000000
.* DEPENDING UPON THE SETTING OF THE GLOBAL VARIABLE &GENSW.            09600000
&K       SETA  K'&LIST                                                  10200000
&I       SETA  1                                                        10800000
&CN      SETC  '&CODE'(4,K'&CODE-3)     FIND ERROR CODE NUMBER          11400000
&A       SETA  &CN                      CONVERT TO DECIMAL              12000000
&CA      SETA  0                                                        12600000
.* GENERATES INTERNALLY CODED TEXT.                                     13200000
.* ACCEPTS ALPHA, NUMBERIC, AND ALL SPECIAL CHARACTERS.                 13800000
         AIF   ('&LIST'(1,1) EQ '''').M1                                14400000
         AIF   ('&LIST'(&K,1) EQ '''').M1  MISSING QUOTE                15000000
         MNOTE 1,'MESSAGE QUOTE MISSING'                                15600000
         MEXIT                          EXIT                            16200000
.M1      ANOP                           BRANCH LABEL                    16800000
&C       SETA  2                                                        17400000
&K       SETA  &K-1                                                     18000000
         AIF   (&GENSW).CONT           ARE WE GENERATING JERMSGCD DSECT 18600000
         SPACE                                                          19200000
&CODE    EQU   &CN                      SEE FOLLOWING MNOTE             19800000
         MNOTE *,&LIST                                                  20400000
         MEXIT                                                          21000000
.CONT    ANOP                           BRANCH LABEL                    21600000
S&CODE   DC    0CL(&K-&C+1)' '                                          22200000
.L2      ANOP                                                           22800000
&CT      SETA  1                                                        23400000
.L3      AIF   ('&LIST'(&C,1) GE 'A').L5  IS IT ALPHANUMERIC?           24000000
         AIF   ('&LIST'(&C,1) EQ '$').L3DOLR      DOLLAR                24600000
         AIF   ('&LIST'(&C,1) EQ '#').L3POUND     POUND                 25200000
         AIF   ('&LIST'(&C,1) EQ ' ').L3B         BLANK                 25800000
         AIF   ('&LIST'(&C,1) EQ ',').L3C         COMMA                 26400000
         AIF   ('&LIST'(&C,1) EQ '.').L3P         PERIOD                27000000
         AIF   ('&LIST'(&C,1) EQ '=').L3EQ        EQUAL                 27600000
         AIF   ('&LIST'(&C,1) EQ '+').L3PLUS      PLUS                  28200000
         AIF   ('&LIST'(&C,1) EQ '-').L3MIN       MINUS                 28800000
         AIF   ('&LIST'(&C,1) EQ '/').L3SLASH     SLASH                 29400000
         AIF   ('&LIST'(&C,1) EQ '(').L3LP        LEFT PARN.            30000000
         AIF   ('&LIST'(&C,1) EQ ')').L3RP        RIGHT PARN.           30600000
         AIF   ('&LIST'(&C,1) EQ '*').L3AST       ASTERISK              31200000
         AIF   ('&LIST'(&C,1) EQ '&&'(1,1)).L3AMP      AMPERSAND        31800000
         AIF   ('&LIST'(&C,1) EQ ''''(1,1)).L3QUO      QUOTE            32400000
.L5      ANOP                                                           33000000
&LET     SETC  'J'.'&LIST'(&C,1)                                        33600000
.L6      AIF   (&CT EQ 1).L7                                            34200000
&LET     SETC  ','.'&LET'                                               34800000
.L7      ANOP                                                           35400000
&GEN(&CT) SETC '&LET'                                                   36000000
&C       SETA  &C+1                                                     36600000
         AIF   (&C GT &K).L9                                            37200000
&CT      SETA  &CT+1                                                    37800000
         AIF   (&CT LT 9).L3                                            38400000
         DC    AL1(&GEN(1)&GEN(2)&GEN(3)&GEN(4)&GEN(5)&GEN(6)&GEN(7)&GEX39000000
               N(8))                                                    39600000
&CT      SETA  1                                                        40200000
.L8      ANOP                                                           40800000
&GEN(&CT) SETC ''                                                       41400000
&CT      SETA  &CT+1                                                    42000000
         AIF   (&CT LT 9).L8                                            42600000
         AGO   .L2                                                      43200000
.L3DOLR  ANOP                                                           43800000
&LET     SETC  'JDOLLAR'                                                44400000
         AGO   .L6                                                      45000000
.L3POUND ANOP                                                           45600000
&LET     SETC  'JPOUND'                                                 46200000
         AGO   .L6                                                      46800000
.L3EQ    ANOP                                                           47400000
&LET     SETC  'JEQUAL'                                                 48000000
         AGO   .L6                                                      48600000
.L3PLUS  ANOP                                                           49200000
&LET     SETC  'JPLUS'                                                  49800000
         AGO   .L6                                                      50400000
.L3MIN   ANOP                                                           51000000
&LET     SETC  'JMINUS'                                                 51600000
         AGO   .L6                                                      52200000
.L3SLASH ANOP                                                           52800000
&LET     SETC  'JSLASH'                                                 53400000
         AGO   .L6                                                      54000000
.L3C     ANOP                                                           54600000
&LET     SETC  'JCOMMA'                                                 55200000
         AGO   .L6                                                      55800000
.L3B     ANOP                                                           56400000
&LET     SETC  'JBLANK'                                                 57000000
         AGO   .L6                                                      57600000
.L3P     ANOP                                                           58200000
&LET     SETC  'JPERIOD'                                                58800000
         AGO   .L6                                                      59400000
.L3LP    ANOP                                                           60000000
&LET     SETC  'JLPARN'                                                 60600000
         AGO   .L6                                                      61200000
.L3RP    ANOP                                                           61800000
&LET     SETC  'JRPARN'                                                 62400000
         AGO   .L6                                                      63000000
.L3AST   ANOP                                                           63600000
&LET     SETC  'JASTER'                                                 64200000
         AGO   .L6                                                      64800000
.L3AMP   AIF   ('&LIST'(&C+1,1) EQ '&&'(1,1)).L3AMP2  2ND AMPERSAND     65400000
         MNOTE 1,'ILLEGAL AMPERSAND - AMPERSAND IS NOT DOUBLED'         66000000
.L3AMP2  ANOP                                                           66600000
&LET     SETC  'JAMPER'                                                 67200000
&C       SETA  &C+1                                                     67800000
&CA      SETA  &CA+1                                                    68400000
         AGO   .L6                                                      69000000
.L3QUO   AIF   ('&LIST'(&C+1,1) EQ ''''(1,1)).L3QUO2  2ND QUOTE         69600000
         MNOTE 1,'ILLEGAL QUOTE - QUOTE IS NOT DOUBLED'                 70200000
.L3QUO2  ANOP                                                           70800000
&LET     SETC  'JQUOTE'                                                 71400000
&C       SETA  &C+1                                                     72000000
&CA      SETA  &CA+1                                                    72600000
         AGO   .L6                                                      73200000
.L9      AIF   (&CA EQ 0).L9D                                           73800000
&LET     SETC  ','.'JBLANK'                                             74400000
&CT      SETA  &CT+1                                                    75000000
         AIF   (&CT LT 9).L9B                                           75600000
         DC    AL1(&GEN(1)&GEN(2)&GEN(3)&GEN(4)&GEN(5)&GEN(6)&GEN(7)&GEX76200000
               N(8))                                                    76800000
&CT      SETA  1                                                        77400000
.L9A     ANOP                                                           78000000
&GEN(&CT) SETC ''                                                       78600000
&CT      SETA  &CT+1                                                    79200000
         AIF   (&CT LT 9).L9A                                           79800000
&CT      SETA  1                                                        80400000
&LET     SETC  'JBLANK'                                                 81000000
.L9B     ANOP                                                           81600000
&GEN(&CT)      SETC                     '&LET'                          82200000
&CA      SETA  &CA-1                                                    82800000
         AGO   .L9                                                      83400000
.L9D     DC    AL1(&GEN(1)&GEN(2)&GEN(3)&GEN(4)&GEN(5)&GEN(6)&GEN(7)&GEX84000000
               N(8))                                                    84600000
.L10     ANOP                                                           85200000
&ERCD(&A) SETC 'S&CODE'                 SORT & SAVE MESSAGE NAME        85800000
         MEND                                                           86400000
./  ADD  SSI=40930415,NAME=GENOP
         MACRO                                                          00050000
         GENOP &PHASE=,                 1=EDIT PHASE, 3=GENERATE PHASE *00100000
               &SET=UNIV,               CHAR SET-UNIV,STD,COMM,SCNTF   X00150000
               &LEVEL=1                 LEVEL OF TABLE                  00200000
.*********************************************************************. 00250000
.*                                                                   *. 00300000
.* THIS MACRO GENERATES THE OP CODE TABLE FOR THE EDIT AND GENERATE  *. 00350000
.* PHASES.IT PERFORMS ITS WORK IN THE FOLLOWING STEPS:               *. 00400000
.*       1 - INITIALIZE  GLOBALS, COPY THE COMMON JUNK ETC.          *. 00450000
.*       2 - GENERATE THE OPCODE TABLE THROUGH A SERIES OF CALLS TO  *. 00500000
.*           THE MACRO 'OP', ONE CALL FOR EACH SYMBOLIC OPCODE.      *. 00550000
.*           NOTES - IF TAILORING OF THE TABLE ACCORDING TO INSTRUCT *. 00600000
.*                   SET BECOMES DESIRABLE,THIS CAN BE ACCOMPLISHED  *. 00650000
.*                   BY ADDING SOME PARAMETERS TO 'GENOP' AND DOING  *. 00700000
.*                   SOME SUITABLE BRANCHING ON THESE IN THIS STEP.  *. 00750000
.*                 - THE TABLE IS CHAINED BACKWARDS. IN ORDER TO GET *. 00800000
.*                   A FAST TABLE LOOKUP  FREQUENTLY USED OPCODES    *. 00850000
.*                   SUCH AS DC AND MVC SHOULD BE PUT TOWARDS THE END*. 00900000
.*                   AND UNFREQUENT ONES SUCH AS ICTL AND PRIVILEGED *. 00950000
.*                   OPS SHOULD BE IN THE BEGINNING.                 *. 01000000
.*       3 - GENERATE THE HASH TABLE, ONE POINTER FOR EACH CHAIN     *. 01050000
.*                                                                   *. 01100000
.*********************************************************************. 01150000
         GBLA  &SHIFT(8)                USED FOR FOLDING MNEMONIC       01200000
         GBLA  &CHAIN(71)               NO OF ENTRIES IN EACH CHAIN     01250000
         GBLC  &TABLE(71)               NAME OF PREVIOUS ENTRY IN CHAIN 01300000
         GBLC  &SEARCH(71)              CHAINS - FOR DOCUMENTATION ONLY 01350000
         GBLC  &CHARVAL                 VALID CHARACTERS FOR MNEMONIC   01400000
.*                                                                      01450000
         LCLA  &INDEX                   SCRATCH PAD                     01500000
         LCLA  &COUNT                   SCRATCH PAD                     01550000
         LCLC  &STRING                  SCRATCH PAD                     01600000
         LCLC  &ID                      SCRATCH PAD                     01650000
         LCLC  &COMMENT                 VARIABLE COMMENT FIELD          01700000
.*                                                                      01750000
.* CHECK PARAMETERS                                                     01800000
.*                                                                      01850000
         AIF   (&PHASE EQ 1 OR &PHASE EQ 3).POK   GO IF PHASE OK        01900000
         MNOTE '***  ERROR  *** - PHASE=&PHASE'                         01950000
.POK     AIF   (T'&LEVEL EQ 'N').LOK    GO IF LEVEL OK                  02000000
         MNOTE '***  ERROR  *** - LEVEL=&LEVEL'                         02050000
.LOK     ANOP                                                           02100000
.*                                                                      02150000
&SHIFT(1) SETA X'1000000'                                               02200000
&SHIFT(2) SETA X'10000'                                                 02250000
&SHIFT(3) SETA X'100'                                                   02300000
&SHIFT(4) SETA X'1'                                                     02350000
&SHIFT(5) SETA X'1000000'                                               02400000
&SHIFT(6) SETA X'10000'                                                 02450000
&SHIFT(7) SETA X'100'                                                   02500000
&SHIFT(8) SETA X'1'                                                     02550000
.*                                                                      02600000
&CHARVAL SETC  'ABCDEFGHIJKLMNOPQRSTUVWXYZ'                             02650000
.*                                                                      02700000
&ID      SETC  '&SET'(1,2)                                              02750000
.* INITIALIZE &TABLE                                                    02800000
.*                                                                      02850000
.INIT    ANOP                                                           02900000
&COUNT   SETA  &COUNT+1                 NEXT ENTRY                      02950000
&TABLE(&COUNT) SETC 'JOPTABLE'          INITIALIZE TO START OF JOPTABLE 03000000
         AIF   (&COUNT LT 71).INIT      GO IF NOT EXHAUSTED             03050000
         JHEAD 'OP CODE TABLE',                                        *03100000
               PHASEID=X&PHASE.K,                                      *03150000
               LEVEL=&LEVEL                                             03200000
*FUNCTION/OPERATION-                                                  * 08400000
*   THIS MODULE IS THE OP CODE TABLE. IT IS GENERATED ACCORDING TO    * 08450000
*   THE USER-SPECIFIED OPTIONS. IT IS GENERATED IN HASHED FORM. IT    * 08500000
*   IS INCLUDED AS PART OF BOTH THE EDIT PHASE AND THE GENERATE       * 08550000
*   PHASE.                                                            * 08600000
*                                                                     * 08650000
*ENTRY POINT-                                                         * 08700000
*        NONE                                                         * 08750000
*                                                                     * 08800000
*INPUT-                                                               * 08850000
*   NONE                                                              * 08900000
*                                                                     * 08950000
*OUTPUT-                                                              * 09000000
*   NONE                                                              * 09050000
*                                                                     * 09100000
*EXTERNAL ROUTINES-                                                   * 09150000
*   NONE                                                              * 09200000
*                                                                     * 09250000
*EXITS,NORMAL-                                                        * 09300000
*   NONE                                                              * 09350000
*                                                                     * 09400000
*EXITS,ERROR-                                                         * 09450000
*   NONE                                                              * 09500000
*                                                                     * 09550000
*TABLES/WORK AREAS-                                                   * 09600000
*   NONE                                                              * 09650000
*                                                                     * 09700000
*ATTRIBUTES-                                                          * 09750000
*   REFRESHABLE                                                       * 09800000
*                                                                     * 09850000
*NOTES-                                                               * 09900000
*                                                                     * 09950000
*   THE FOLLOWING IS A DESCRIPTION OF THE OP CODE TABLE ENTRY(S)      * 10000000
*                                                                     * 10050000
*   ITEM            LENGTH         DESCRIPTION                        * 10100000
*   ----            ------         -----------                        * 10150000
*                                                                     * 10200000
*   CHAIN POINTER   2 BYTES        NON-ZERO = DISPLACEMENT FROM THE   * 10250000
*                                             BASE OF THE HASH TABLE  * 10300000
*                                             TO THE NEXT ENTRY IN    * 10350000
*                                             THE CHAIN               * 10400000
*                                                                     * 10450000
*                                  ZERO = LAST ENTRY IN THE CHAIN     * 10500000
*                                                                     * 10550000
*   FLAGS           1 BYTE         FLAGS REQUIRED BY THE EDITOR AND   * 10600000
*                                  OP CODE LOOK-UP ROUTINE            * 10650000
*                                                                     * 10700000
*                                  BITS 0-1                           * 10750000
*                                 01 = ONE BYTE OP CODE OR ASMOP      * 10800000
*                                 11 = TWO BYTE OP CODE OR EXT MNEMON.* 10850000
*                                                                     * 10900000
*                                  BITS 2-3                           * 10950000
*                                 00 = ONE BYTE MACHINE OP              11000000
*                                    01 = EXTENDED MNEMONIC           * 11050000
*                                 10 = TWO BYTE MACHINE OP              11060000
*                                    11 = ASSEMBLER OP                * 11100000
*                                                                     * 11150000
*                                  BIT 4                              * 11200000
*                                    0                                * 11250000
*                                                                     * 11300000
*                                  BITS 5-7                           * 11350000
*                                    LENGTH OF MNEMONIC-1             * 11400000
*                                                                     * 11450000
*   MNEMONIC        1-8 BYTES      MNEMONIC IN INTERNAL CHARACTERS    * 11500000
*                                                                     * 11550000
*   FLAGA           1 BYTE         FLAGS FOR MACHINE OPS AND          * 11600000
*                                  EXTENDED MNEMONICS, INSERTED       * 11650000
*                                  INTO JTFLGA IN THE EDITED TEXT     * 11700000
*                                  FOR USE BY ALL SUBSEQUENT PHASES   * 11750000
*                                                                     * 11800000
*                                  BIT 0                              * 11850000
*                                    0 = MACHINE OP                   * 11900000
*                                                                     * 11950000
*                                  BIT 1                              * 12000000
*                                    0 = ONE BYTE OP CODE             * 12050000
*                                    1 = EXTENDED MNEMONIC OR         * 12100000
*                                        TWO BYTE OP CODE             * 12150000
*                                                                     * 12200000
*                                  BIT 2                              * 12250000
*                                    1 = PRIVATE CODE INITIATED       * 12300000
*                                                                     * 12350000
*                                  BIT 3                              * 12400000
*                                    0                                * 12450000
*                                                                     * 12500000
*                                  BIT 4                              * 12550000
*                                    1 = STATEMENT MAY AFFECT         * 12600000
*                                        STORAGE ASSIGNMENT OR THE    * 12650000
*                                        ESD                          * 12700000
*                                                                     * 12750000
*                                  BIT 5                              * 12800000
*                                    1 = STATEMENT MAY CONTAIN        * 12850000
*                                        SYMBOL REFERENCES IN THE     * 12900000
*                                        OPERAND                      * 12950000
*                                                                     * 13000000
*                                  BITS 6-7                           * 13050000
*                                    00 = INSTRUCTION LENGTH 2 BYTES  * 13100000
*                                    01 = INSTRUCTION LENGTH 4 BYTES  * 13150000
*                                    10 = INSTRUCTION LENGTH 6 BYTES  * 13200000
*                                                                     * 13250000
*   FLAGA           1 BYTE         FLAGS FOR ASSEMBLER OPS, INSERTED  * 13300000
*                                  INTO JTFLGA IN THE EDITED TEXT     * 13350000
*                                  FOR USE BY ALL SUBSEQUENT PHASES   * 13400000
*                                                                     * 13450000
*                                  BIT 0                              * 13500000
*                                    1 = ASSEMBLER OP                 * 13550000
*                                                                     * 13600000
*                                  BIT 1                              * 13650000
*                                    1 = EXTRN, WXTRN, ENTRY          * 13700000
*                                        STATEMENT                    * 13750000
*                                                                     * 13800000
*                                  BIT 2                              * 13850000
*                                    1 = PRIVATE CODE INITIATED       * 13900000
*                                                                     * 13950000
*                                  BIT 3                              * 14000000
*                                    1 = PRIVATE CODE INITIATION      * 14050000
*                                        INHIBITED                    * 14100000
*                                                                     * 14150000
*                                  BIT 4                              * 14200000
*                                    1 = STATEMENT MAY AFFECT         * 14250000
*                                        STORAGE ASSIGNMENT OR THE    * 14300000
*                                        ESD                          * 14350000
*                                                                     * 14400000
*                                  BIT 5                              * 14450000
*                                    1 = STATEMENT MAY CONTAIN        * 14500000
*                                        SYMBOL REFERENCES IN THE     * 14550000
*                                        OPERAND                      * 14600000
*                                                                     * 14650000
*                                  BIT 6                              * 14700000
*                                    1 = OPERAND SCAN IS REQUIRED     * 14750000
*                                                                     * 14800000
*                                  BIT 7                              * 14850000
*                                    1 = DC, DS, DXD STATEMENT        * 14900000
*                                                                     * 14950000
*   INTERNAL OP     1-2 BYTES      VALUE INSERTED INTO JTIOP1 (AND,   * 15000000
*      CODE                        FOR TWO BYTE OP CODES, INTO        * 15050000
*                                  JTIOP2) IN EDITED TEXT RECORD FOR  * 15100000
*                                  USE BY ALL SUBSEQUENT PHASES       * 15150000
*                                                                     * 15200000
*                                  MACHINE OP - HEX VALUE OF MACHINE  * 15250000
*                                               INSTRUCTION           * 15300000
*                                                                     * 15350000
*                                  ASSEMBLER OP - HEX VALUE BASED ON  * 15400000
*                                                 JTEXT               * 15450000
*                                                                     * 15500000
*   MASK            1 BYTE         MASK FOR EXTENDED MNEMONICS        * 15550000
*                                  INSERTED INTO JTIOP2 IN THE        * 15600000
*                                  EDITED TEXT                        * 15650000
*                                                                     * 15700000
*                                  BITS 0-3                           * 15750000
*                                    MASK (0-F)                       * 15800000
*                                                                     * 15850000
*                                  BITS 4-7                           * 15900000
*                                    0                                * 15950000
*                                                                     * 16000000
         EJECT                                                          16050000
         PRINT NOGEN    SUPPRESS PRINTING OF JCOMMON AND JTEXT          16100000
         COPY  JCOMMON                  GET INTERNAL CODES FOR LETTERS  16150000
         EJECT                                                          16200000
         COPY  JTEXT                    GET INTERNAL OPCODES FOR ASMOPS 16250000
         EJECT                                                          16300000
         PRINT GEN                                                      16350000
         JCSECT (X&PHASE.K&ID)                                          16400000
*RELEASE 3.1 CHANGES                                                    16410003
*A274100                                                        OX02977 16420003
         JMODID                                                         16450000
         DC    CL2'&ID'                                                 16500000
JOPTABLE EQU   *                                                        16550000
         JENTRY (X&PHASE.K01=JOPTABLE)                                  16600000
         ORG   JOPTABLE+2*71                                            16650000
.********************************************************************.  16700000
.*                                                                   *. 16750000
.** END OF PRELIMINARIES - GENERATE THE OP CODE TABLE               **. 16800000
.*                                                                   *. 16850000
.*********************************************************************. 16900000
         AIF   ('&SET' NE 'UNIV').STEP0                                 16950000
RRB      OP    X'B213'                                                  17000000
LRA      OP    X'B1'                                                    17050000
PTLB     OP    X'B20D'                                                  17100000
SCKC     OP    X'B206'                                                  17150000
STCKC    OP    X'B207'                                                  17200000
RDD      OP    X'85'                                                    17250000
WRD      OP    X'84'                                                    17300000
SIGP     OP    X'AE'                                                    17310000
STAP     OP    X'B212'                                                  17320000
SPX      OP    X'B210'                                                  17330000
STPX     OP    X'B211'                                                  17340000
.STEP0   ANOP                                                           17350000
CLRIO    OP    X'9D01'                                                  17360000
CS       OP    X'BA'                                                    17370000
CDS      OP    X'BB'                                                    17380000
SPKA     OP    X'B20A'                                                  17390000
IPK      OP    X'B20B'                                                  17392000
STIDP    OP    X'B202'                                                  17400000
STIDC    OP    X'B203'                                                  17450000
SCK      OP    X'B204'                                                  17500000
STCK     OP    X'B205'                                                  17550000
SPT      OP    X'B208'                                                  17600000
STPT     OP    X'B209'                                                  17650000
LCTL     OP    X'B7'                                                    17700000
STCTL    OP    X'B6'                                                    17750000
SSK      OP    X'08'                                                    17800000
ISK      OP    X'09'                                                    17850000
TCH      OP    X'9F'                                                    17900000
HDV      OP    X'9E01'                                                  17950000
HIO      OP    X'9E'                                                    18000000
TIO      OP    X'9D'                                                    18050000
SIOF     OP    X'9C01'                                                  18100000
SIO      OP    X'9C'                                                    18150000
STOSM    OP    X'AD'                                                    18200000
STNSM    OP    X'AC'                                                    18250000
SSM      OP    X'80'                                                    18300000
LPSW     OP    X'82'                                                    18350000
         AIF   (&PHASE EQ 3).STEP1                                      18360000
AGOB     OP    DEF=NO,REF=NO,INPC=NO                                    18370000
AIFB     OP    DEF=NO,REF=NO,INPC=NO                                    18380000
ICTL     OP    DEF=NO,REF=NO,INPC=NO                                    18390000
ISEQ     OP    DEF=NO,REF=NO,INPC=NO                                    18400000
REPRO    OP    REF=NO,INPC=NO                                           18450000
OPSYN    OP    DEF=NO,REF=NO,INPC=NO                                    18500000
ACTR     OP    DEF=NO,REF=NO,INPC=NO                                    18550000
.STEP1   ANOP                                                           18600000
DXD      OP    REQOP=YES,INPC=NO                                        18650000
CXD      OP    REF=NO                                                   18700000
COM      OP    REF=NO,INHB=YES,INPC=NO                                  18750000
WXTRN    OP    DEF=NO,INPC=NO                                           18800000
PUSH     OP    DEF=NO,REF=NO,INPC=NO                                    18850000
POP      OP    DEF=NO,REF=NO,INPC=NO                                    18900000
         AIF   ('&SET' EQ 'STD' OR '&SET' EQ 'COMM').STEP2              18950000
MXD      OP    X'67'                                                    18960000
MXDR     OP    X'27'                                                    18970000
MXR      OP    X'26'                                                    18972000
SXR      OP    X'37'                                                    18974000
AXR      OP    X'36'                                                    18976000
LRDR     OP    X'25'                                                    18978000
LRER     OP    X'35'                                                    18980000
SWR      OP    X'2F'                                                    18990000
SW       OP    X'6F'                                                    19000000
SUR      OP    X'3F'                                                    19050000
SU       OP    X'7F'                                                    19060000
AWR      OP    X'2E'                                                    19070000
AW       OP    X'6E'                                                    19080000
AUR      OP    X'3E'                                                    19090000
AU       OP    X'7E'                                                    19100000
DDR      OP    X'2D'                                                    19150000
DD       OP    X'6D'                                                    19160000
DER      OP    X'3D'                                                    19170000
DE       OP    X'7D'                                                    19180000
HDR      OP    X'24'                                                    19190000
HER      OP    X'34'                                                    19200000
MDR      OP    X'2C'                                                    19250000
MD       OP    X'6C'                                                    19300000
MER      OP    X'3C'                                                    19310000
ME       OP    X'7C'                                                    19320000
CDR      OP    X'29'                                                    19330000
CD       OP    X'69'                                                    19340000
CER      OP    X'39'                                                    19350000
CE       OP    X'79'                                                    19400000
STD      OP    X'60'                                                    19450000
STE      OP    X'70'                                                    19460000
SDR      OP    X'2B'                                                    19470000
SD       OP    X'6B'                                                    19480000
SER      OP    X'3B'                                                    19490000
SE       OP    X'7B'                                                    19500000
ADR      OP    X'2A'                                                    19550000
AD       OP    X'6A'                                                    19600000
AER      OP    X'3A'                                                    19610000
AE       OP    X'7A'                                                    19620000
LTDR     OP    X'22'                                                    19630000
LTER     OP    X'32'                                                    19640000
LCDR     OP    X'23'                                                    19650000
LCER     OP    X'33'                                                    19700000
LDR      OP    X'28'                                                    19750000
LD       OP    X'68'                                                    19800000
LNDR     OP    X'21'                                                    19850000
LNER     OP    X'31'                                                    19860000
LPDR     OP    X'20'                                                    19870000
LPER     OP    X'30'                                                    19880000
LER      OP    X'38'                                                    19890000
LE       OP    X'78'                                                    19900000
.STEP2   AIF   ('&SET' EQ 'STD' OR '&SET' EQ 'SCNTF').STEP3             19910000
DP       OP    X'FD'                                                    19920000
MP       OP    X'FC'                                                    19930000
EDMK     OP    X'DF'                                                    19940000
ED       OP    X'DE'                                                    19950000
SRP      OP    X'F0'                                                    20000000
CP       OP    X'F9'                                                    20050000
SP       OP    X'FB'                                                    20100000
AP       OP    X'FA'                                                    20110000
ZAP      OP    X'F8'                                                    20120000
.STEP3   ANOP                                                           20130000
MC       OP    X'AF'                                                    20140000
CLCL     OP    X'0F'                                                    20250000
MVCL     OP    X'0E'                                                    20300000
LCR      OP    X'13'                                                    20310000
CLM      OP    X'BD'                                                    20320000
STCM     OP    X'BE'                                                    20330000
ICM      OP    X'BF'                                                    20340000
         AIF   (&PHASE EQ 3).STEP4                                      20350000
GBLC     OP    DEF=NO,REF=NO,INPC=NO                                    20400000
GBLA     OP    DEF=NO,REF=NO,INPC=NO                                    20450000
LCLC     OP    DEF=NO,REF=NO,INPC=NO                                    20500000
MNOTE    OP    DEF=NO,REF=NO,INPC=NO                                    20510000
SETC     OP    DEF=NO,REF=NO,INPC=NO                                    20520000
AGO      OP    DEF=NO,REF=NO,INPC=NO                                    20530000
.STEP4   ANOP                                                           20540000
SPM      OP    X'04'                                                    20550000
ALR      OP    X'1E'                                                    20600000
AL       OP    X'5E'                                                    20650000
NR       OP    X'14'                                                    20660000
N        OP    X'54'                                                    20670000
NC       OP    X'D4'                                                    20680000
BCR      OP    X'07'                                                    20690000
BXH      OP    X'86'                                                    20700000
BXLE     OP    X'87'                                                    20750000
CLR      OP    X'15'                                                    20800000
CL       OP    X'55'                                                    20850000
DR       OP    X'1D'                                                    20860000
D        OP    X'5D'                                                    20870000
XR       OP    X'17'                                                    20880000
X        OP    X'57'                                                    20890000
XI       OP    X'97'                                                    20900000
BNER     OP    X'077'                                                   20950000
LNR      OP    X'11'                                                    21000000
LPR      OP    X'10'                                                    21050000
MVN      OP    X'D1'                                                    21100000
MVO      OP    X'F1'                                                    21150000
MVZ      OP    X'D3'                                                    21200000
MR       OP    X'1C'                                                    21250000
M        OP    X'5C'                                                    21300000
MH       OP    X'4C'                                                    21350000
OR       OP    X'16'                                                    21400000
O        OP    X'56'                                                    21450000
SLDA     OP    X'8F'                                                    21500000
SLA      OP    X'8B'                                                    21550000
SLDL     OP    X'8D'                                                    21600000
SLL      OP    X'89'                                                    21650000
SRDA     OP    X'8E'                                                    21700000
SRA      OP    X'8A'                                                    21750000
SRDL     OP    X'8C'                                                    21800000
SRL      OP    X'88'                                                    21850000
SLR      OP    X'1F'                                                    21900000
SL       OP    X'5F'                                                    21950000
TS       OP    X'93'                                                    22000000
TRT      OP    X'DD'                                                    22050000
CCW      OP                                                             22100000
PUNCH    OP    REF=NO,INPC=NO                                           22150000
LTORG    OP    REF=NO                                                   22200000
         AIF   (&PHASE EQ 3).STEP5                                      22250000
ANOP     OP    DEF=NO,REF=NO,INPC=NO                                    22300000
GBLB     OP    DEF=NO,REF=NO,INPC=NO                                    22350000
COPY     OP    DEF=NO,REF=NO,INPC=NO                                    22400000
.STEP5   ANOP                                                           22450000
ORG      OP    REQOP=YES                                                22500000
PRINT    OP    DEF=NO,REF=NO,INPC=NO                                    22550000
SPACE    OP    DEF=NO,REF=NO,INPC=NO                                    22600000
EJECT    OP    DEF=NO,REF=NO,INPC=NO                                    22650000
BHR      OP    X'072'                                                   22700000
BLR      OP    X'074'                                                   22750000
BER      OP    X'078'                                                   22800000
BNHR     OP    X'07D'                                                   22850000
BNLR     OP    X'07B'                                                   22900000
BNOR     OP    X'07E'                                                   22950000
BOR      OP    X'071'                                                   23000000
BPR      OP    X'072'                                                   23050000
BMR      OP    X'074'                                                   23100000
BZR      OP    X'078'                                                   23150000
BNPR     OP    X'07D'                                                   23200000
BNMR     OP    X'07B'                                                   23250000
BNZR     OP    X'077'                                                   23300000
TR       OP    X'DC'                                                    23350000
OC       OP    X'D6'                                                    23400000
CH       OP    X'49'                                                    23450000
EX       OP    X'44'                                                    23500000
LTR      OP    X'12'                                                    23550000
XC       OP    X'D7'                                                    23600000
CVB      OP    X'4F'                                                    23650000
CVD      OP    X'4E'                                                    23700000
C        OP    X'59'                                                    23750000
CR       OP    X'19'                                                    23800000
BCT      OP    X'46'                                                    23850000
SH       OP    X'4B'                                                    23900000
STH      OP    X'40'                                                    23950000
AH       OP    X'4A'                                                    24000000
DROP     OP    DEF=NO,INPC=NO                                           24050000
ENTRY    OP    DEF=NO,INPC=NO                                           24100000
EXTRN    OP    DEF=NO,INPC=NO                                           24150000
EQU      OP    REQOP=YES                                                24200000
DSECT    OP    REF=NO,INHB=YES,INPC=NO                                  24250000
CNOP     OP    REQOP=YES                                                24300000
TITLE    OP    DEF=NO,REF=NO,INPC=NO                                    24350000
START    OP    INHB=YES,REQOP=YES,INPC=NO                               24400000
END      OP    INPC=NO                                                  24450000
STC      OP    X'42'                                                    24500000
IC       OP    X'43'                                                    24550000
NI       OP    X'94'                                                    24600000
OI       OP    X'96'                                                    24650000
USING    OP                                                             24700000
NOP      OP    X'470'                                                   24750000
NOPR     OP    X'070'                                                   24800000
BNP      OP    X'47D'                                                   24850000
BP       OP    X'472'                                                   24900000
BNM      OP    X'47B'                                                   24950000
BM       OP    X'474'                                                   25000000
BNO      OP    X'47E'                                                   25050000
BO       OP    X'471'                                                   25100000
BNL      OP    X'47B'                                                   25150000
BNH      OP    X'47D'                                                   25200000
BL       OP    X'474'                                                   25250000
BH       OP    X'472'                                                   25300000
BNZ      OP    X'477'                                                   25350000
BZ       OP    X'478'                                                   25400000
AR       OP    X'1A'                                                    25450000
TM       OP    X'91'                                                    25500000
SVC      OP    X'0A'                                                    25550000
SR       OP    X'1B'                                                    25600000
STM      OP    X'90'                                                    25650000
ST       OP    X'50'                                                    25700000
UNPK     OP    X'F3'                                                    25750000
PACK     OP    X'F2'                                                    25800000
LM       OP    X'98'                                                    25850000
LH       OP    X'48'                                                    25900000
MVI      OP    X'92'                                                    25950000
BAL      OP    X'45'                                                    26000000
BALR     OP    X'05'                                                    26050000
BCTR     OP    X'06'                                                    26100000
A        OP    X'5A'                                                    26150000
S        OP    X'5B'                                                    26200000
LR       OP    X'18'                                                    26250000
BR       OP    X'07F'                                                   26300000
BC       OP    X'47'                                                    26350000
CSECT    OP    REF=NO,INHB=YES,INPC=NO                                  26400000
         AIF   (&PHASE EQ 3).STEP6                                      26450000
SETB     OP    DEF=NO,REF=NO,INPC=NO                                    26500000
SETA     OP    DEF=NO,REF=NO,INPC=NO                                    26550000
LCLB     OP    DEF=NO,REF=NO,INPC=NO                                    26600000
LCLA     OP    DEF=NO,REF=NO,INPC=NO                                    26650000
MEND     OP    DEF=NO,REF=NO,INPC=NO                                    26700000
MEXIT    OP    DEF=NO,REF=NO,INPC=NO                                    26750000
MACRO    OP    DEF=NO,REF=NO,INPC=NO                                    26800000
AIF      OP    DEF=NO,REF=NO,INPC=NO                                    26850000
.STEP6   ANOP                                                           26900000
CLI      OP    X'95'                                                    26950000
CLC      OP    X'D5'                                                    27000000
L        OP    X'58'                                                    27050000
BNE      OP    X'477'                                                   27100000
BE       OP    X'478'                                                   27150000
B        OP    X'47F'                                                   27200000
LA       OP    X'41'                                                    27250000
MVC      OP    X'D2'                                                    27300000
DS       OP    REQOP=YES                                                27350000
DC       OP    REQOP=YES                                                27400000
         DC    CL1'0'                   DUMMY                   OX02977 27410003
.*********************************************************************. 27450000
.*                                                                   *. 27500000
.** END OF OP CODE TABLE GENERATION - GENERATE HASH TABLE           **. 27550000
.*                                                                   *. 27600000
.*********************************************************************. 27650000
         EJECT                                                          27700000
         ORG   JOPTABLE                 PUT HASH TABLE BEFORE ENTRIES   27750000
         SPACE 2                                                        27800000
&COUNT   SETA  0                        INITIALIZE LOOP COUNTER         27850000
&INDEX   SETA  0                                                        27900000
.LOOP    ANOP                                                           27950000
&COUNT   SETA  &COUNT+1                                                 28000000
         MNOTE '* CHAIN &COUNT : &SEARCH(&COUNT)'    WRITE CHAIN        28050000
&STRING  SETC  '&TABLE(&COUNT)'         EXTRACT NAME OF LAST ENTRY      28100000
&COMMENT SETC  (12-K'&STRING)' '.'POINTER TO FIRST ENTRY OF &CHAIN(&COU*28150000
               NT)'                     SET VARIABLE COMMENT            28200000
         DC    AL2(&STRING-JOPTABLE)&COMMENT                            28250000
&INDEX   SETA  &INDEX+&CHAIN(&COUNT)    ACCUMULATE NO OF ENTRIES        28300000
         AIF   (&COUNT LT 71).LOOP      GO IF NOT EXHAUSTED             28350000
         SPACE 2                                                        28400000
         MNOTE '** THE OPCODE TABLE CONTAINS A TOTAL OF &INDEX ENTRIES' 28450000
         SPACE 2                                                        28500000
         MEND                                                           28550000
./  ADD  SSI=21950297,NAME=GENTAB
          MACRO                                                         00050000
          GENTAB                                                        00100000
          GBLC  &ERCD(255)          GLOBAL ARRAY OF MSG NAMES           00150000
          LCLA  &I                                                      00200000
          LCLC  &LQ                                                     00250000
.* THIS MACRO GENERATES A SEQUENCED INDEX TO THE ERROR MESSAGES WHICH   00300000
.* CONTAINS THE HALF-WORD ADDRESS AND THE LENGTH OF EACH MESSAGE.  THIS 00350000
.* ALLOWS THE ERROR CODE TO BE USED TO INDEX THE MESSAGE INDEX.  THIS   00450000
.* MACRO MUST BE CALLED EXACTLY ONCE AFTER ALL CALLS TO GENERR.         00500000
&LQ       SETC  'L'''                                                   00550000
MTABLE    DS    0F                       INDEX OF ERROR MSGS & LENGTHS  00600000
MADDR     DS    H                            MESSAGE ADDRESS            00650000
MLN       DS    H                            MESSAGE LENGTH             00700000
          ORG   MTABLE                   TO START AT THE TOP OF TABLE   00750000
          DC    Y(S0-ERRMSGS)            INDEX TO ERR0 MESSAGE          00850000
          DC    Y(L'S0-1)                MOVE LENGTH OF ERR0 MESSAGE    00900000
          ORG   MTABLE+4                 TO LEAVE SPACE FOR ERR0 ENTRY  00950000
.LOOP     ANOP                                                          01000000
&I        SETA  &I+1                                                    01050000
          AIF   (&I GT 255).END          CHECK FOR MAXIMUM SIZE         01100000
          AIF   ('&ERCD(&I)' NE '').C1   FOR UNDEFINED ERROR MESSAGES   01150000
          DC    F'0'                     UNDEFINED ERROR MESSAGE        01500000
          AGO   .LOOP                                                   01550000
.C1       ANOP                                                          01600000
          DC    Y(&ERCD(&I)-ERRMSGS)     ADDRESS OF MSG FOR THIS CODE   01650000
          DC    Y(&LQ&ERCD(&I).-1)       LENGTH OF MSG FOR THIS CODE    01700000
          AGO   .LOOP                                                   01800000
.END      MEND                                                          01850000
./  ADD  SSI=21950299,NAME=GOIF
         MACRO                                                          01000000
&NAME    GOIF  &SW, .                   SWITCH TO BE TESTED            X02000000
               &SW2, .                  COMPARAND FOR CLC OR CLI       X03000000
               &GT=, .                  BRANCH GREATER                 X04000000
               &GE=, .                  BRANCH GREATER OR EQUAL        X05000000
               &EQ=, .                  BRANCH EQUAL                   X06000000
               &LE=, .                  BRANCH LESS OR EQUAL           X07000000
               &LT=, .                  BRANCH LESS                    X08000000
               &NE=, .                  BRANCH NOT EQUAL               X09000000
               &ZERO=, .                STATUS CONDITION               X10000000
               &NOTZERO=, .             STATUS CONDITION               X11000000
               &POS=, .                 STATUS CONDITION               X12000000
               &NOTPOS=, .              STATUS CONDITION               X13000000
               &NEG=, .                 STATUS CONDITION               X14000000
               &NOTNEG=, .              STATUS CONDITION               X15000000
               &MODE=L, .               STATUS CONDITION               X16000000
               &NO=, .                  SWITCH OFF                     X17000000
               &YES=, .                 SWITCH ON                      X18000000
               &EQUAL=, .               ALTERNATE FOR EQ               X19000000
               &NOTEQ=, .               ALTERNATE FOR NE               X20000000
               &ALL=, .                 BRANCH IF ALL ON               X21000000
               &NONE=, .                BRANCH IF NONE ON              X22000000
               &MIX=, .                 BRANCH IF SOME ON (BUT NOT ALL)X23000000
               &NOTALL=, .              BRANCH IF NONE OR SOME         X24000000
               &ANY=, .                 H NOT ALL OFF (ANY OR ALL ON)  X25000000
               &NOTMIX=, .              BRANCH IF ALL ON OR ALL OFF    X26000000
               &ELSE=, .                UNCONDITIONAL FINAL BRANCH     X27000000
               &ON=, .                  BRANCH IF SINGLE SWITCH ON     X28000000
               &OFF=, .                 BRANCH IF SINGLE SWITCH OFF    X29000000
               &HIGH=,&HI=,&NOTLO=,&NOTLOW=,&LOW=,&LO=,&NOTHI=,        X30000000
               &NOTHIGH=                                                31000000
         GBLA  &INDEX                                                   32000000
         GBLC  &BYTE,&CRNT                                              33000000
         GBLC  &DEFNAME(255),&SWNAME(255)                               34000000
         LCLA  &COUNT1,&COUNT2                                          35000000
         LCLB  &FIRST,&COND(3),&USED(6),&TM,&MASK(3)                    36000000
         LCLB  &NULL                                                    37000000
         LCLC  &PLUS(7)                                                 38000000
.*                                                                      38050000
.*             CHANGES TO RELEASE 3                                     38100000
.*             CHANGES TO RELEASE 2                                     38150000
.*             CHANGES TO RELEASE 1                                     38200000
.*                                                                      38250000
.* GENERATES INSTRUCTIONS TO TEST A GIVEN CONDITION                     38300000
.* AND BRANCH IF THE BRANCH CONDITION IS SATISFIED                      38350000
.*                                                                      38400000
         AIF   (N'&SW GT 8).ERR1 .      TOO MANY SWITCHES               39000000
&COUNT1  SETA  0 .                      INITIALIZE FOR VALIDITY CHECK   40000000
.LOOP1   ANOP                                                           41000000
&COUNT1  SETA  &COUNT1+1 .              NEXT OPERAND                    42000000
         AIF   (&COUNT1 GT N'&SW).NXT1 . DONE                           43000000
&COUNT2  SETA  0 .                      INITIALIZE SWNAME LOOKUP        44000000
.LOOP2   ANOP                                                           45000000
&COUNT2  SETA  &COUNT2+1 .              NEXT IN SWNAME LIST             46000000
         AIF   (&COUNT2 GT &INDEX).ERR2 . DIDN'T FIND NAME              47000000
         AIF   ('&SW(&COUNT1)' EQ '&SWNAME(&COUNT2)').LOOP3 FOUND NAME  48000000
         AGO   .LOOP2                                                   49000000
.ERR2    ANOP  , .                      LOG NO NAME FOUND               50000000
         AIF   (N'&SW GT 1).ERR2A                                       51000000
&NAME    GOIF1 &SW,&SW2,GT=&GT&HI&HIGH,GE=&GE&NOTLOW&NOTLO,            X52000000
               EQ=&EQ&EQUAL,LE=&LE&NOTHIGH&NOTHI,LT=&LT&LOW&LO,        X53000000
               ZERO=&ZERO,              STATUS CONDITION               X54000000
               NOTZERO=&NOTZERO,        STATUS CONDITION               X55000000
               POS=&POS,                STATUS CONDITION               X56000000
               NOTPOS=&NOTPOS,          STATUS CONDITION               X57000000
               NEG=&NEG,                STATUS CONDITION               X58000000
               NOTNEG=&NOTNEG,          STATUS CONDITION               X59000000
               MODE=&MODE,              STATUS CONDITION               X60000000
               NE=&NE&NOTEQ,ELSE=&ELSE                                  61000000
         MEXIT                                                          62000000
.ERR2A   MNOTE 8,'UNDECLARED BIT SWITCH OR MORE THAN ONE CLI SWITCH'    63000000
         MEXIT                                                          64000000
.ERR1    ANOP                                                           65000000
         MNOTE 8,'TOO MANY SWITCHES, ONLY 8 ALLOWED PER CALL'           66000000
         MEXIT                                                          67000000
.LOOP3   ANOP                                                           68000000
         AIF   (&FIRST).SECOND .        FIRST TIME THROUGH              69000000
&FIRST   SETB  1 .                      YES                             70000000
&BYTE    SETC  '&DEFNAME(&COUNT2)' .    SAVE THE NAME                   71000000
         AGO   .LOOP1 .                 BACK FOR MORE                   72000000
.SECOND  ANOP                                                           73000000
         AIF   ('&DEFNAME(&COUNT2)' EQ '&BYTE').LOOP1                   74000000
         MNOTE 8,'SWITCHES NOT ALL IN THE SAME BYTE'                    75000000
         MEXIT                                                          76000000
.NXT1    ANOP                                                           77000000
&NAME    GOIF3 &SW,                                                    X78000000
               ALL=&ALL&YES&ON,                                        X79000000
               NONE=&NONE&NO&OFF,                                      X80000000
               MIX=&MIX,                                               X81000000
               NOTALL=&NOTALL,                                         X82000000
               ANY=&ANY,                                               X83000000
               NOTMIX=&NOTMIX,                                         X84000000
               ELSE=&ELSE,                                             X85000000
               ON=&ALL&YES&ON,                                         X86000000
               OFF=&NONE&NO&OFF                                         87000000
         MEND                                                           88000000
./  ADD  SSI=21950302,NAME=GOIF1
         MACRO                                                          00400000
&NAME    GOIF1 &LOC,&CMP,&EQ=,&NE=,&GT=,&LT=,&GE=,&LE=,&MODE=,         ,00800000
               &ZERO=,&NOTZERO=,&POS=,&NOTPOS=,&NEG=,&NOTNEG=,&ELSE=    01200000
         LCLA  &W(4)                                                    01600000
         LCLB  &B(3)                                                    02000000
         LCLC  &R                                                       02400000
.*                                                                      02450000
.*             CHANGES TO RELEASE 3                                     02500000
.*             CHANGES TO RELEASE 2                                     02550000
.*             CHANGES TO RELEASE 1                                     02600000
.*                                                                      02650000
.* INNER MACRO TO GOIF. GENERATES THE INSTRUCTIONS IF A                 02700000
.* SWITCH IS TO BE TESTED                                               02750000
.*                                                                      02760000
         AIF   (K'&LOC EQ 0).ERR1                                       02800000
&W(1)    SETA  4                                                        03200000
&W(2)    SETA  2                                                        03600000
&W(3)    SETA  13                                                       04000000
&W(4)    SETA  11                                                       04400000
&B(1)    SETB  ('&EQ' NE '')                                            04800000
&B(2)    SETB  ('&NE' NE '')                                            05200000
&B(3)    SETB  ('&NE' NE '')                                            05600000
         AIF   ('&GT' EQ '').C1                                         06000000
         AIF   (&B(3)).ERR3                                             06400000
&B(3)    SETB  1                                                        06800000
.C1      AIF   ('&LT' EQ '').C2                                         07200000
         AIF   (&B(2)).ERR3                                             07600000
&B(2)    SETB  1                                                        08000000
.C2      AIF   ('&GE' EQ '').C3                                         08400000
         AIF   (&B(1) OR &B(3)).ERR3                                    08800000
&B(1)    SETB  1                                                        09200000
&B(3)    SETB  1                                                        09600000
.C3      AIF   ('&LE' EQ '').C4                                         10000000
         AIF   (&B(1) OR &B(2)).ERR3                                    10400000
&B(1)    SETB  1                                                        10800000
&B(2)    SETB  1                                                        11200000
.C4      AIF   (NOT(&B(1) AND &B(2) AND &B(3))OR '&ELSE' EQ '').C5      11600000
.ERR3    MNOTE 8,'REDUNDANT LOGIC, MACRO EXPANSION ATTEMPTED.'          12000000
.C5      AIF   (K'&CMP EQ 0).C6                                         12400000
.*                                                                      12800000
.*                       TWO OPERANDS SUPPLIED                          13200000
.*                                                                      13600000
         AIF   ('&LOC'(1,1) EQ '(' AND '&LOC'(K'&LOC,1) EQ ')').RG1     14000000
         AIF   ('&CMP'(1,1) EQ '(' AND '&CMP'(K'&CMP,1) EQ ')').RG2     14400000
         AIF   (T'&CMP NE 'U').SS                                       14800000
.*                                                                      15200000
.*                       OPERAND 2 IS ASSUMED TO BE IMMEDIATE           15600000
.*                                                                      16000000
&NAME    CLI   &LOC,&CMP                                                16400000
         AGO   .C7                                                      16800000
.*                                                                      17200000
.*                       ONE OPERAND ONLY                               17600000
.*                                                                      18000000
.C6      AIF   ('&LOC'(1,1) EQ '(' AND '&LOC'(K'&LOC,1) EQ ')').LTR     18400000
&NAME    CLI   V&LOC,&LOC                                               18800000
.C7      AIF   (K'&ZERO+K'&NOTZERO+K'&POS+K'&NOTPOS+K'&NEG+K'&NOTNEG EQ,19200000
                0).C7A                                                  19600000
         MNOTE 8,'CALL CONTAINS OTHER THAN RELATIONAL CONDITIONS.'      20000000
.C7A     AIF   ('&EQ' EQ '').LE                                         20400000
         AIF   ('&EQ'EQ'&NE'OR'&EQ'EQ'&GT'AND'&EQ'EQ'&LT').ALL          20800000
         AIF   ('&EQ' EQ '&LT').LE1                                     21200000
         AIF   ('&EQ' EQ '&GT').GE1                                     21600000
         AIF   ('&EQ'(1,1) NE '(').EQ2                                  22000000
&R       SETC  'R'                                                      22400000
.EQ2     BC&R  8,&EQ(1)                 BRANCH PER MACRO CALL           22800000
&R       SETC  ''                                                       23200000
.LE      AIF   ('&LE' EQ '').GE                                         23600000
         AIF   ('&LE' EQ '&GT').ALL1                                    24000000
         AIF   ('&LE'(1,1) NE '(').LE2                                  24400000
&R       SETC  'R'                                                      24800000
.LE2     BC&R  &W(3),&LE(1)             BRANCH PER MACRO CALL           25200000
&R       SETC  ''                                                       25600000
         AGO   .GE                                                      26000000
.LE1     AIF   ('&EQ'(1,1) NE '(').LE3                                  26400000
&R       SETC  'R'                                                      26800000
.LE3     BC&R  &W(3),&EQ(1)             BRANCH PER MACRO CALL           27200000
&R       SETC  ''                                                       27600000
.GE      AIF   ('&GE' EQ '').LT                                         28000000
         AIF   ('&GE' EQ '&LT').ALL2                                    28400000
         AIF   ('&GE'(1,1) NE '(').GE2                                  28800000
&R       SETC  'R'                                                      29200000
.GE2     BC&R  &W(4),&GE(1)             BRANCH PER MACRO CALL           29600000
&R       SETC  ''                                                       30000000
         AGO   .LT                                                      30400000
.GE1     AIF   ('&EQ'(1,1) NE '(').GE3                                  30800000
&R       SETC  'R'                                                      31200000
.GE3     BC&R  &W(4),&EQ(1)             BRANCH PER MACRO CALL           31600000
&R       SETC  ''                                                       32000000
.LT      AIF   ('&LT' EQ '').NE                                         32400000
         AIF   ('&LT' EQ '&GT').NE1                                     32800000
         AIF   ('&LT'(1,1) NE '(').LT2                                  33200000
&R       SETC  'R'                                                      33600000
.LT2     BC&R  &W(1),&LT(1)             BRANCH PER MACRO CALL           34000000
&R       SETC  ''                                                       34400000
.NE      AIF   ('&NE' EQ '').GT                                         34800000
         AIF   ('&NE'(1,1) NE '(').NE2                                  35200000
&R       SETC  'R'                                                      35600000
.NE2     BC&R  7,&NE(1)                 BRANCH PER MACRO CALL           36000000
&R       SETC  ''                                                       36400000
         AGO   .END                                                     36800000
.NE1     AIF   ('&LT'(1,1) NE '(').NE3                                  37200000
&R       SETC  'R'                                                      37600000
.NE3     BC&R  7,&LT(1)                 BRANCH PER MACRO CALL           38000000
&R       SETC  ''                                                       38400000
.GT      AIF   ('&GT' EQ '').END                                        38800000
         AIF   ('&GT'(1,1) NE '(').GT2                                  39200000
&R       SETC  'R'                                                      39600000
.GT2     BC&R  &W(2),&GT(1)             BRANCH PER MACRO CALL           40000000
&R       SETC  ''                                                       40400000
.END     AIF   ('&ELSE' EQ '').MEND                                     40800000
         AIF   ('&ELSE'(1,1) NE '(').ELSE2                              41200000
&R       SETC  'R'                                                      41600000
.ELSE2   BC&R  15,&ELSE(1)              BRANCH PER MACRO CALL           42000000
         MEXIT                                                          42400000
.ALL     AIF   ('&EQ'(1,1) NE '(').ALL01                                42800000
&R       SETC  'R'                                                      43200000
.ALL01   BC&R  15,&EQ(1)                BRANCH PER MACRO CALL           43600000
         MEXIT                                                          44000000
.ALL1    AIF   ('&LE'(1,1) NE '(').ALL11                                44400000
&R       SETC  'R'                                                      44800000
.ALL11   BC&R  15,&LE(1)                BRANCH PER MACRO CALL           45200000
         MEXIT                                                          45600000
.ALL2    AIF   ('&GE'(1,1) NE '(').ALL21                                46000000
&R       SETC  'R'                                                      46400000
.ALL21   BC&R  15,&GE(1)                BRANCH PER MACRO CALL           46800000
         MEXIT                                                          47200000
.LTRC    AIF   ('&ZERO'(1,1) NE '(').LTRV                               47600000
&R       SETC  'R'                                                      48000000
.LTRV    BC&R  15,&ZERO(1)              BRANCH PER MACRO CALL           48400000
         MEXIT                                                          48800000
.LTRX    AIF   ('&NOTPOS'(1,1) NE '(').LTRZ                             49200000
&R       SETC  'R'                                                      49600000
.LTRZ    BC&R  15,&NOTPOS(1)            BRANCH PER MACRO CALL           50000000
         MEXIT                                                          50400000
.LTRY    AIF   ('&NOTNEG'(1,1) NE '(').LTRW                             50800000
&R       SETC  'R'                                                      51200000
.LTRW    BC&R  15,&NOTNEG(1)            BRANCH PER MACRO CALL           51600000
         MEXIT                                                          52000000
.RG1     AIF   ('&CMP'(1,1) EQ '(' AND '&CMP'(K'&CMP,1) EQ ')').RG12    52400000
         AIF   (L'&CMP NE 2).LNOT2                                      52800000
&NAME    CH    &LOC(1),&CMP                                             53200000
         AGO   .C7                                                      53600000
.LNOT2   AIF   (L'&CMP EQ 4).LEQ4                                       54000000
         MNOTE *,'LENGTH ATTRIBUTE OF &CMP NOT 2 OR 4.'                 54400000
.LEQ4    AIF   ('&MODE'(1,1) EQ 'A').NOTLOG                             54800000
&NAME    CL    &LOC(1),&CMP                                             55200000
         AGO   .C7                                                      55600000
.NOTLOG  ANOP                                                           56000000
&NAME    C     &LOC(1),&CMP                                             56400000
         AGO   .C7                                                      56800000
.RG2     AIF   (L'&LOC NE 2).LNOT22                                     57200000
&NAME    CH    &CMP(1),&LOC                                             57600000
         AGO   .C7R                                                     58000000
.LNOT22  AIF   (L'&LOC EQ 4).LEQ42                                      58400000
         MNOTE *,'LENGTH ATTRIBUTE OF &LOC NOT 2 OR 4.'                 58800000
.LEQ42   AIF   ('&MODE'(1,1) EQ 'A').NOTLOG2                            59200000
&NAME    CL    &CMP(1),&LOC                                             59600000
         AGO   .C7R                                                     60000000
.NOTLOG2 ANOP                                                           60400000
&NAME    C     &CMP(1),&LOC                                             60800000
.C7R     ANOP                                                           61200000
&W(1)    SETA  2                                                        61600000
&W(2)    SETA  4                                                        62000000
&W(3)    SETA  11                                                       62400000
&W(4)    SETA  13                                                       62800000
         AGO   .C7                                                      63200000
.RG12    AIF   ('&MODE'(1,1) EQ 'A').RG12A                              63600000
&NAME    CLR   &LOC(1),&CMP(1)                                          64000000
         AGO   .C7                                                      64400000
.RG12A   ANOP                                                           64800000
&NAME    CR    &LOC(1),&CMP(1)                                          65200000
         AGO   .C7                                                      65600000
.SS      ANOP                                                           66000000
&NAME    CLC   &LOC,&CMP                                                66400000
         AGO   .C7                                                      66800000
.LTR     ANOP                                                           67200000
&NAME    LTR   &LOC(1),&LOC(1)                                          67600000
         AIF   (&B(1)+&B(2)+&B(3) EQ 0).LTRA                            68000000
         MNOTE 8,'CALL CONTAINS RELATIONAL CONDITIONS.'                 68400000
.LTRA    AIF   (('&ZERO'EQ''OR'&NOTZERO'EQ''OR'&ELSE'EQ'')AND('&ZERO'EQ,68800000
               ''OR'&POS'EQ''OR'&NEG'EQ''OR'&ELSE'EQ'')AND('&NOTPOS'EQ''69200000
               'OR'&NEG'EQ''OR'&ELSE'EQ'')).LTRM                        69600000
         MNOTE 8,'REDUNDANT LOGIC, MACRO EXPANSION ATTEMPTED.'          70000000
.LTRM    AIF   ('&NOTNEG'EQ''OR'&POS'EQ''OR'&ELSE'EQ'').LTRN            70400000
         MNOTE 8,'REDUNDANT LOGIC, MACRO EXPANSION ATTEMPTED.'          70800000
.LTRN    AIF   ('&NOTPOS' EQ '').LTRO                                   71200000
         AIF   ('&NOTPOS' EQ 'NEG').LTRX                                71600000
         AIF   ('&NOTPOS'(1,1) NE '(').LTRP                             72000000
&R       SETC  'R'                                                      72400000
.LTRP    BC&R  13,&NOTPOS(1)            BRANCH PER MACRO CALL           72800000
&R       SETC  ''                                                       73200000
.LTRO    AIF   ('&NOTNEG' EQ '').LTRQ                                   73600000
         AIF   ('&NOTNEG' EQ '&POS').LTRY                               74000000
         AIF   ('&NOTNEG'(1,1) NE '(').LTRR                             74400000
&R       SETC  'R'                                                      74800000
.LTRR    BC&R  11,&NOTNEG(1)            BRANCH PER MACRO CALL           75200000
&R       SETC  ''                                                       75600000
.LTRQ    AIF   ('&ZERO' EQ '').LTRB                                     76000000
         AIF   ('&ZERO' EQ '&NOTZERO' AND '&ZERO' EQ '&POS' AND '&ZERO',76400000
                EQ '&NEG').LTRC                                         76800000
         AIF   ('&ZERO'(1,1) NE '(').LTRD                               77200000
&R       SETC  'R'                                                      77600000
.LTRD    BC&R  8,&ZERO(1)               BRANCH PER MACRO CALL           78000000
&R       SETC  ''                                                       78400000
.LTRB    AIF   ('&NEG' EQ '').LTRE                                      78800000
         AIF   ('&NEG' EQ '&POS').LTRF                                  79200000
         AIF   ('&NEG'(1,1) NE '(').LTRG                                79600000
&R       SETC  'R'                                                      80000000
.LTRG    BC&R  4,&NEG(1)                 BRANCH PER MACRO CALL          80400000
&R       SETC  ''                                                       80800000
.LTRE    AIF   ('&NOTZERO' EQ '').LTRH                                  81200000
         AIF   ('&NOTZERO'(1,1) NE '(').LTRI                            81600000
&R       SETC  'R'                                                      82000000
.LTRI    BC&R  7,&NOTZERO(1)            BRANCH PER MACRO CALL           82400000
&R       SETC  ''                                                       82800000
         AGO   .LTRH                                                    83200000
.LTRF    AIF   ('&POS'(1,1) NE '(').LTRK                                83600000
&R       SETC  'R'                                                      84000000
.LTRK    BC&R  7,&POS(1)                BRANCH PER MACRO CALL           84400000
&R       SETC  ''                                                       84800000
.LTRH    AIF   ('&POS' EQ '').END                                       85200000
         AIF   ('&POS'(1,1) NE '(').LTRJ                                85600000
&R       SETC  'R'                                                      86000000
.LTRJ    BC&R  2,&POS(1)                BRANCH PER MACRO CALL           86400000
&R       SETC  ''                                                       86800000
         AGO   .END                                                     87200000
.ERR1    MNOTE 8,'REQUIRED OPERANDS NOT SUPPLIED.'                      87600000
.MEND    MEND                                                           88000000
./  ADD  SSI=21950304,NAME=GOIF3
         MACRO                                                          00400000
&NAME    GOIF3 &SW,&ALL=,&NONE=,&MIX=,&NOTALL=,&ANY=,&NOTMIX=,         X00800000
               &ELSE=,&ON=,&OFF=                                        01200000
         GBLA  &INDEX                                                   01600000
         GBLC  &BYTE,&CRNT                                              02000000
         GBLC  &DEFNAME(255),&SWNAME(255)                               02400000
         LCLA  &COUNT1,&COUNT2                                          02800000
         LCLB  &FIRST,&COND(3),&USED(6),&TM,&MASK(3)                    03200000
.*                                                                      03250000
.*             CHANGES TO RELEASE 3                                     03300000
.*             CHANGES TO RELEASE 2                                     03350000
.*             CHANGES TO RELEASE 1                                     03400000
.*                                                                      03450000
.* INNER MACRO TO GOIF. GENERATES THE INSTRUCTIONS                      03500000
.* IF THE FIELD TO TEST IS NOT A SWITCH                                 03550000
.*                                                                      03560000
 LCLC    &PLUS(7)                                                       03600000
.NXT1    ANOP                                                           04000000
         AIF   (N'&SW EQ 1).SNGL .      ONLY ONE SWITCH                 04400000
.NXT1A   ANOP                                                           04800000
&COND(1) SETB  0                                                        05200000
&COND(2) SETB  0                                                        05600000
&COND(3) SETB  0                                                        06000000
         AIF   (&USED(1) AND &USED(2) AND &USED(3) AND &USED(4) AND &USX06400000
               ED(5) AND &USED(6)).GEN1                                 06800000
&FIRST   SETB  0                                                        07200000
.ALL     AIF   (&USED(1)).NONE                                          07600000
         AIF   (K'&ALL EQ 0).ALL3                                       08000000
&COND(1) SETB  1 .                      BRANCH CONDITION ONES           08400000
&FIRST   SETB  1                                                        08800000
&CRNT    SETC  '&ALL(1)'                                                09200000
&USED(1) SETB  1                                                        09600000
.NONE    AIF   (&USED(2)).MIX                                           10000000
         AIF   (K'&NONE EQ 0).NONE3                                     10400000
         AIF   (&FIRST).NONE2                                           10800000
&COND(2) SETB  1 .                      BRANCH CONDITION ZEROS          11200000
&FIRST   SETB  1                                                        11600000
&CRNT    SETC  '&NONE(1)'                                               12000000
&USED(2) SETB  1                                                        12400000
         AGO   .MIX                                                     12800000
.NONE2   AIF   ('&CRNT' NE '&NONE').MIX                                 13200000
&USED(2) SETB  1                                                        13600000
&COND(2) SETB  1                                                        14000000
.MIX     AIF   (&USED(3)).NOTALL                                        14400000
         AIF   (K'&MIX EQ 0).MIX3                                       14800000
         AIF   (&FIRST).MIX2                                            15200000
&FIRST   SETB  1                                                        15600000
&CRNT    SETC  '&MIX(1)'                                                16000000
&USED(3) SETB  1                                                        16400000
&COND(3) SETB  1 .                      BRANCH CONDITION MIXED          16800000
         AGO   .NOTALL                                                  17200000
.MIX2    AIF   ('&CRNT' NE '&MIX').NOTALL                               17600000
&COND(3) SETB  1                                                        18000000
&USED(3) SETB  1                                                        18400000
.NOTALL  AIF   (&USED(4)).ANY                                           18800000
         AIF   (K'&NOTALL EQ 0).NOTALL3                                 19200000
         AIF   (&FIRST).NOTALL2                                         19600000
&FIRST   SETB  1                                                        20000000
&CRNT    SETC  '&NOTALL(1)'                                             20400000
&USED(4) SETB  1                                                        20800000
&COND(2) SETB  1 .                      BRANCH CONDITION ZEROS          21200000
&COND(3) SETB  1 .                      BRANCH CONDITION MIXED          21600000
         AGO   .ANY                                                     22000000
.NOTALL2 AIF   ('&CRNT' NE '&NOTALL').ANY                               22400000
&USED(4) SETB  1                                                        22800000
&COND(2) SETB  1                                                        23200000
&COND(3) SETB  1                                                        23600000
.ANY     AIF   (&USED(5)).NOTMIX                                        24000000
         AIF   (K'&ANY EQ 0).ANY3                                       24400000
         AIF (&FIRST).ANY2                                              24800000
&FIRST   SETB  1                                                        25200000
&CRNT    SETC  '&ANY(1)'                                                25600000
&USED(5) SETB  1 .                      THIS OPTION USED                26000000
&COND(1) SETB  1 .                      BRANCH CONDITION ONES           26400000
&COND(3) SETB  1 .                      BRANCH CONDITION MIXED          26800000
         AGO   .NOTMIX                                                  27200000
.ANY2    AIF   ('&CRNT' NE '&ANY').NOTMIX                               27600000
&USED(5) SETB  1                                                        28000000
&COND(1) SETB  1                                                        28400000
&COND(3) SETB  1                                                        28800000
.NOTMIX  AIF   (&USED(6)).GEN                                           29200000
         AIF   (K'&NOTMIX EQ 0).NOTMIX3                                 29600000
         AIF   (&FIRST).NOTMIX2                                         30000000
&FIRST   SETB  1                                                        30400000
&CRNT    SETC  '&NOTMIX(1)'                                             30800000
&USED(6) SETB  1 .                      OPTION USED                     31200000
&COND(1) SETB  1 .                      BRANCH CONDITION ONES           31600000
&COND(2) SETB  1 .                      BRANCH CONDITION ZEROS          32000000
         AGO   .GEN                                                     32400000
.NOTMIX2 AIF   ('&CRNT' NE '&NOTMIX').GEN                               32800000
&USED(6) SETB  1                                                        33200000
&COND(1) SETB  1                                                        33600000
&COND(2) SETB  1                                                        34000000
.NOTMIX3 ANOP                                                           34400000
&USED(6) SETB  1                                                        34800000
         AGO   .GEN                                                     35200000
.ANY3    ANOP                                                           35600000
&USED(5) SETB  1                                                        36000000
         AGO   .NOTMIX                                                  36400000
.NOTALL3 ANOP                                                           36800000
&USED(4) SETB  1                                                        37200000
         AGO   .ANY                                                     37600000
.MIX3    ANOP                                                           38000000
&USED(3) SETB  1                                                        38400000
         AGO   .NOTALL                                                  38800000
.NONE3   ANOP                                                           39200000
&USED(2) SETB  1                                                        39600000
         AGO   .MIX                                                     40000000
.ALL3    ANOP                                                           40400000
&USED(1) SETB  1                                                        40800000
         AGO   .NONE                                                    41200000
.GEN     ANOP                                                           41600000
         AIF   ('&CRNT' EQ '&ELSE').NXT1                                42000000
.GEN1    AIF   (&TM).GEN2 .             IF ALREADY GEN'D TM             42400000
         AIF   ('&SW' EQ '').GEN2       NO SWITCHES, DON'T DO TM        42800000
         AIF   (K'&SW(2) EQ 0).ZIP1                                     43200000
&PLUS(1) SETC  '+'                                                      43600000
.ZIP1    AIF   (K'&SW(3) EQ 0).ZIP2                                     44000000
&PLUS(2) SETC  '+'                                                      44400000
.ZIP2    AIF   (K'&SW(4) EQ 0).ZIP3                                     44800000
&PLUS(3) SETC  '+'                                                      45200000
.ZIP3    AIF   (K'&SW(5) EQ 0).ZIP4                                     45600000
&PLUS(4) SETC  '+'                                                      46000000
.ZIP4    AIF   (K'&SW(6) EQ 0).ZIP5                                     46400000
&PLUS(5) SETC  '+'                                                      46800000
.ZIP5    AIF   (K'&SW(7) EQ 0).ZIP6                                     47200000
&PLUS(6) SETC  '+'                                                      47600000
.ZIP6    AIF   (K'&SW(8) EQ 0).ZIP7                                     48000000
&PLUS(7) SETC  '+'                                                      48400000
.ZIP7    ANOP                                                           48800000
&NAME    TM    &BYTE,&SW(1)&PLUS(1)&SW(2)&PLUS(2)&SW(3)&PLUS(3)&SW(4)&PX49200000
               LUS(4)&SW(5)&PLUS(5)&SW(6)&PLUS(6)&SW(7)&PLUS(7)&SW(8)   49600000
&TM      SETB  1 .                      FLAG AS GENERATED               50000000
.GEN2    ANOP                                                           50400000
         AIF   (NOT &COND(1) AND NOT &COND(2) AND NOT &COND(3)).NOP    X50800000
                                        NO CONDITIONS, MAY BE A NOP     51200000
         AIF   (&COND(2) AND &COND(3)).BNO                              51600000
         AIF   (&COND(1) AND &COND(3)).BNZ                              52000000
         AIF   (&COND(1) AND &COND(2)).BNM                              52400000
         AIF   (&COND(1)).BO                                            52800000
         AIF   (&COND(2)).BZ                                            53200000
         AIF   (&COND(3)).BM                                            53600000
&MASK(1) SETB  1                                                        54000000
&MASK(2) SETB  1                                                        54400000
&MASK(3) SETB  1                                                        54800000
         AIF   ('&CRNT'(1,1) EQ '(').BA1                                55200000
         B     &CRNT                    BRANCH PER MACRO CALL           55600000
         AGO   .NXT1 .                  GO BACK FOR MORE                56000000
.BA1     BR    &CRNT                    BRANCH PER MACRO CALL           56400000
         AGO   .NXT1                                                    56800000
.BO      AIF   (&MASK(1)).ERR4                                          57200000
&MASK(1) SETB  1                                                        57600000
         AIF   ('&CRNT'(1,1) EQ '(').BO1                                58000000
         BO    &CRNT                    BRANCH PER MACRO CALL           58400000
 AGO     .NXT1                                                          58800000
.BO1     BCR   1,&CRNT                  BRANCH PER MACRO CALL           59200000
         AGO   .NXT1                                                    59600000
.BZ      AIF   (&MASK(2)).ERR4                                          60000000
&MASK(2) SETB  1                                                        60400000
         AIF   ('&CRNT'(1,1) EQ '(').BZ1                                60800000
         BZ    &CRNT                    BRANCH PER MACRO CALL           61200000
         AGO   .NXT1                                                    61600000
.BZ1     BCR   8,&CRNT                  BRANCH PER MACRO CALL           62000000
         AGO   .NXT1                                                    62400000
.BM      AIF   (&MASK(3)).ERR4                                          62800000
&MASK(3) SETB  1                                                        63200000
         AIF   ('&CRNT'(1,1) EQ '(').BM1                                63600000
         BM    &CRNT                    BRANCH PER MACRO CALL           64000000
         AGO   .NXT1                                                    64400000
.BM1     BCR   4,&CRNT                  BRANCH PER MACRO CALL           64800000
         AGO   .NXT1                                                    65200000
.BNO     AIF   (&MASK(2) OR &MASK(3)).ERR4                              65600000
&MASK(2) SETB  1                                                        66000000
&MASK(3) SETB  1                                                        66400000
         AIF   ('&CRNT'(1,1) EQ '(').BNO1                               66800000
         BNO   &CRNT                    BRANCH PER MACRO CALL           67200000
         AGO   .NXT1                                                    67600000
.BNO1    BCR   14,&CRNT                 BRANCH PER MACRO CALL           68000000
         AGO   .NXT1                                                    68400000
.BNZ     AIF   (&MASK(1) OR &MASK(3)).ERR4                              68800000
&MASK(1) SETB  1                                                        69200000
&MASK(3) SETB  1                                                        69600000
         AIF   ('&CRNT'(1,1) EQ '(').BNZ1                               70000000
         BNZ   &CRNT                    BRANCH PER MACRO CALL           70400000
         AGO   .NXT1                                                    70800000
.BNZ1    BCR   7,&CRNT                  BRANCH PER MACRO CALL           71200000
         AGO   .NXT1                                                    71600000
.BNM     AIF   (&MASK(1) OR &MASK(2)).ERR4                              72000000
&MASK(1) SETB  1                                                        72400000
&MASK(2) SETB  1                                                        72800000
         AIF   ('&CRNT'(1,1) EQ '(').BNM1                               73200000
         BNM   &CRNT                    BRANCH PER MACRO CALL           73600000
         AGO   .NXT1                                                    74000000
.BNM1    BCR   11,&CRNT                 BRANCH PER MACRO CALL           74400000
         AGO   .NXT1                                                    74800000
.ERR4    ANOP                                                           75200000
         MNOTE 8,'REDUNDANT LOGIC--CONDITION USED MORE THAN ONCE'       75600000
         AGO   .DONE                                                    76000000
.ERR10   ANOP                                                           76400000
         MNOTE 8,'OPTIONS ARE ONLY LEGAL FOR MULTIPLE SWITCH'           76800000
         AGO   .SNGL3                                                   77200000
.ERR3    ANOP                                                           77600000
.OUT     ANOP                                                           78000000
.NOP     ANOP                                                           78400000
.DONE    AIF   (K'&ELSE EQ 0).DONE2                                     78800000
         AIF   (&MASK(1) AND &MASK(2) AND &MASK(3)).ERR4                79200000
         AIF   ('&ELSE'(1,1) EQ '(').DONE3                              79600000
         B     &ELSE                    BRANCH PER MACRO CALL           80000000
.DONE2   MEXIT                                                          80400000
.DONE3   BR    &ELSE                    BRANCH PER MACRO CALL           80800000
         MEXIT                                                          81200000
.SNGL    ANOP                                                           81600000
         AIF   ('&MIX' NE '' OR '&NOTMIX' NE '').ERR10                  82000000
.SNGL3   ANOP                                                           82400000
&NAME    TM    &BYTE,&SW                                                82800000
         AIF   ((K'&ON NE 0) AND (K'&OFF NE 0)).B2                      83200000
         AIF   ((K'&ON EQ 0) AND (K'&OFF EQ 0)).NOP                     83600000
         AIF   (K'&ON EQ 0).SNGL2                                       84000000
         AIF   ('&ON'(1,1) EQ '(').BO91                                 84400000
         BO    &ON                      BRANCH PER MACRO CALL           84800000
         AGO   .DONE                                                    85200000
.BO91    BCR   1,&ON(1)                 BRANCH PER MACRO CALL           85600000
         AGO   .DONE                                                    86000000
.SNGL2   ANOP                                                           86400000
         AIF   ('&OFF'(1,1) EQ '(').BZ91                                86800000
         BZ    &OFF                     BRANCH PER MACRO CALL           87200000
         AGO   .DONE                                                    87600000
.BZ91    BCR   8,&OFF(1)                BRANCH PER MACRO CALL           88000000
         AGO   .DONE                                                    88400000
.B2      AIF   ('&ON' EQ '&OFF').B3                                     88800000
         AIF   ('&ON'(1,1) EQ '(').B20                                  89200000
         BO    &ON                      BRANCH PER MACRO CALL           89600000
         AGO   .B21                                                     90000000
.B20     BCR   1,&ON(1)                 BRANCH PER MACRO CALL           90400000
.B21     AIF   ('&OFF'(1,1) EQ '(').B23                                 90800000
         BZ    &OFF                     BRANCH PER MACRO CALL           91200000
         AGO   .DONE                                                    91600000
.B23     BCR   8,&OFF(1)                BRANCH PER MACRO CALL           92000000
         AGO   .DONE                                                    92400000
.B3      ANOP                                                           92800000
         AIF   ('&ON'(1,1) EQ '(').B30                                  93200000
         B     &ON                      BRANCH PER MACRO CALL           93600000
         AGO   .DONE                                                    94000000
.B30     BR    &ON(1)                   BRANCH PER MACRO CALL           94400000
         AGO   .DONE                                                    94800000
         MEND                                                           95200000
./  ADD  SSI=21950306,NAME=GOTO
         MACRO                                                          00500000
&LABEL   GOTO  &ROUTINE                                                 01000000
.*                                                                      01500000
         GBLC  &X0(26)                                                  02000000
         GBLC  &X1(26)                                                  02500000
         GBLC  &X2(26)                                                  03000000
         GBLC  &X3(26)                                                  03500000
         GBLC  &X4(26)                                                  04000000
         GBLC  &X5(26)                                                  04500000
         GBLC  &X6(26)                                                  05000000
         GBLC  &X7(26)                                                  05500000
         GBLC  &X8(26)                                                  06000000
         GBLC  &X9(26)                                                  06500000
         GBLC  &XA(26)                                                  07000000
         GBLC  &XB(26)                                                  07500000
         GBLC  &XC(26)                                                  08000000
         GBLC  &XD(26)                                                  08500000
         GBLC  &XE(26)                                                  09000000
         GBLC  &XF(26)                                                  09500000
.*                                                                      10000000
         LCLC  &PHASEID                                                 10500000
         LCLA  &I                                                       11000000
.*                                                                      11500000
.*             CHANGES TO RELEASE 3                                     11550000
.*             CHANGES TO RELEASE 2                                     11600000
.*             CHANGES TO RELEASE 1                                     11650000
.*                                                                      11700000
.* GENERATES A BRANCH AND LINK TO A SUBROUTINE                          11750000
.* WHICH NAME IS DEFINED IN THE EXTERNAL NAME                           11800000
.* ARRAY BUILT BY CONTAINS                                              11850000
.*                                                                      11900000
         AIF   (K'&ROUTINE EQ 0 OR N'&SYSLIST GT 1).ERR1                12000000
.*                                                                      12500000
.X0      AIF   ('&X0(1)' EQ '').INT                                     13000000
&PHASEID SETC  '&X0(1)'(4,5)                                            13500000
&I       SETA  2                                                        14000000
.X01     AIF   ('&X0(&I)' EQ '&ROUTINE').EXT                            14500000
         AIF   (&I EQ 26).X1                                            15000000
&I       SETA  &I+1                                                     15500000
         AIF   ('&X0(&I)' NE '').X01                                    16000000
.*                                                                      16500000
.X1      AIF   ('&X1(1)' EQ '').INT                                     17000000
&PHASEID SETC  '&X1(1)'(4,5)                                            17500000
&I       SETA  2                                                        18000000
.X11     AIF   ('&X1(&I)' EQ '&ROUTINE').EXT                            18500000
         AIF   (&I EQ 26).X2                                            19000000
&I       SETA  &I+1                                                     19500000
         AIF   ('&X1(&I)' NE '').X11                                    20000000
.*                                                                      20500000
.X2      AIF   ('&X2(1)' EQ '').INT                                     21000000
&PHASEID SETC  '&X2(1)'(4,5)                                            21500000
&I       SETA  2                                                        22000000
.X21     AIF   ('&X2(&I)' EQ '&ROUTINE').EXT                            22500000
         AIF   (&I EQ 26).X3                                            23000000
&I       SETA  &I+1                                                     23500000
         AIF   ('&X2(&I)' NE '').X21                                    24000000
.*                                                                      24500000
.X3      AIF   ('&X3(1)' EQ '').INT                                     25000000
&PHASEID SETC  '&X3(1)'(4,5)                                            25500000
&I       SETA  2                                                        26000000
.X31     AIF   ('&X3(&I)' EQ '&ROUTINE').EXT                            26500000
         AIF   (&I EQ 26).X4                                            27000000
&I       SETA  &I+1                                                     27500000
         AIF   ('&X3(&I)' NE '').X31                                    28000000
.*                                                                      28500000
.X4      AIF   ('&X4(1)' EQ '').INT                                     29000000
&PHASEID SETC  '&X4(1)'(4,5)                                            29500000
&I       SETA  2                                                        30000000
.X41     AIF   ('&X4(&I)' EQ '&ROUTINE').EXT                            30500000
         AIF   (&I EQ 26).X5                                            31000000
&I       SETA  &I+1                                                     31500000
         AIF   ('&X4(&I)' NE '').X41                                    32000000
.*                                                                      32500000
.X5      AIF   ('&X5(1)' EQ '').INT                                     33000000
&PHASEID SETC  '&X5(1)'(4,5)                                            33500000
&I       SETA  2                                                        34000000
.X51     AIF   ('&X5(&I)' EQ '&ROUTINE').EXT                            34500000
         AIF   (&I EQ 26).X6                                            35000000
&I       SETA  &I+1                                                     35500000
         AIF   ('&X5(&I)' NE '').X51                                    36000000
.*                                                                      36500000
.X6      AIF   ('&X6(1)' EQ '').INT                                     37000000
&PHASEID SETC  '&X6(1)'(4,5)                                            37500000
&I       SETA  2                                                        38000000
.X61     AIF   ('&X6(&I)' EQ '&ROUTINE').EXT                            38500000
         AIF   (&I EQ 26).X7                                            39000000
&I       SETA  &I+1                                                     39500000
         AIF   ('&X6(&I)' NE '').X61                                    40000000
.*                                                                      40500000
.X7      AIF   ('&X7(1)' EQ '').INT                                     41000000
&PHASEID SETC  '&X7(1)'(4,5)                                            41500000
&I       SETA  2                                                        42000000
.X71     AIF   ('&X7(&I)' EQ '&ROUTINE').EXT                            42500000
         AIF   (&I EQ 26).X8                                            43000000
&I       SETA  &I+1                                                     43500000
         AIF   ('&X7(&I)' NE '').X71                                    44000000
.*                                                                      44500000
.X8      AIF   ('&X8(1)' EQ '').INT                                     45000000
&PHASEID SETC  '&X8(1)'(4,5)                                            45500000
&I       SETA  2                                                        46000000
.X81     AIF   ('&X8(&I)' EQ '&ROUTINE').EXT                            46500000
         AIF   (&I EQ 26).X9                                            47000000
&I       SETA  &I+1                                                     47500000
         AIF   ('&X8(&I)' NE '').X81                                    48000000
.*                                                                      48500000
.X9      AIF   ('&X9(1)' EQ '').INT                                     49000000
&PHASEID SETC  '&X9(1)'(4,5)                                            49500000
&I       SETA  2                                                        50000000
.X91     AIF   ('&X9(&I)' EQ '&ROUTINE').EXT                            50500000
         AIF   (&I EQ 26).XA                                            51000000
&I       SETA  &I+1                                                     51500000
         AIF   ('&X9(&I)' NE '').X91                                    52000000
.*                                                                      52500000
.XA      AIF   ('&XA(1)' EQ '').INT                                     53000000
&PHASEID SETC  '&XA(1)'(4,5)                                            53500000
&I       SETA  2                                                        54000000
.XA1     AIF   ('&XA(&I)' EQ '&ROUTINE').EXT                            54500000
         AIF   (&I EQ 26).XB                                            55000000
&I       SETA  &I+1                                                     55500000
         AIF   ('&XA(&I)' NE '').XA1                                    56000000
.*                                                                      56500000
.XB      AIF   ('&XB(1)' EQ '').INT                                     57000000
&PHASEID SETC  '&XB(1)'(4,5)                                            57500000
&I       SETA  2                                                        58000000
.XB1     AIF   ('&XB(&I)' EQ '&ROUTINE').EXT                            58500000
         AIF   (&I EQ 26).XC                                            59000000
&I       SETA  &I+1                                                     59500000
         AIF   ('&XB(&I)' NE '').XB1                                    60000000
.*                                                                      60500000
.XC      AIF   ('&XC(1)' EQ '').INT                                     61000000
&PHASEID SETC  '&XC(1)'(4,5)                                            61500000
&I       SETA  2                                                        62000000
.XC1     AIF   ('&XC(&I)' EQ '&ROUTINE').EXT                            62500000
         AIF   (&I EQ 26).XD                                            63000000
&I       SETA  &I+1                                                     63500000
         AIF   ('&XC(&I)' NE '').XC1                                    64000000
.*                                                                      64500000
.XD      AIF   ('&XD(1)' EQ '').INT                                     65000000
&PHASEID SETC  '&XD(1)'(4,5)                                            65500000
&I       SETA  2                                                        66000000
.XD1     AIF   ('&XD(&I)' EQ '&ROUTINE').EXT                            66500000
         AIF   (&I EQ 26).XE                                            67000000
&I       SETA  &I+1                                                     67500000
         AIF   ('&XD(&I)' NE '').XD1                                    68000000
.*                                                                      68500000
.XE      AIF   ('&XE(1)' EQ '').INT                                     69000000
&PHASEID SETC  '&XE(1)'(4,5)                                            69500000
&I       SETA  2                                                        70000000
.XE1     AIF   ('&XE(&I)' EQ '&ROUTINE').EXT                            70500000
         AIF   (&I EQ 26).XF                                            71000000
&I       SETA  &I+1                                                     71500000
         AIF   ('&XE(&I)' NE '').XE1                                    72000000
.*                                                                      72500000
.XF      AIF   ('&XF(1)' EQ '').INT                                     73000000
&PHASEID SETC  '&XF(1)'(4,5)                                            73500000
&I       SETA  2                                                        74000000
.XF1     AIF   ('&XF(&I)' EQ '&ROUTINE').EXT                            74500000
         AIF   (&I EQ 26).XG                                            75000000
&I       SETA  &I+1                                                     75500000
         AIF   ('&XF(&I)' NE '').XF1                                    76000000
.*                                                                      76500000
.XG      ANOP                                                           77000000
.*                                                                      77500000
.INT     ANOP                                                           78000000
&LABEL   BAL   R9,&ROUTINE              GO TO ROUTINE                   78500000
         MEXIT                                                          79000000
.*                                                                      79500000
.*                                                                      80000000
.EXT     ANOP                                                           80500000
&LABEL   L     R12,&PHASEID             GET ADDRESS OF PIVOT            81000000
         AIF   (&I EQ 2).EXT1                                           81500000
&I       SETA  &I*4-8                                                   82000000
         BAL   R9,&I.(,R12)             GO TO ROUTINE                   82500000
         MEXIT                                                          83000000
.EXT1    BALR  R9,R12                   GO TO ROUTINE                   83500000
         MEXIT                                                          84000000
.ERR1    MNOTE 4,'ROUTINE NAME EXCESSIVE OR MISSING.'                   84500000
.MEND    MEND                                                           85000000
./  ADD  SSI=71710233,NAME=ICOMMON
*                        DEFINE EXTERNAL ROUTINES                     * 00600000
         SPACE                                                          00900000
         AIF   ('&TESTRAN' NE 'YES').X4D                                01200000
&COMPNM.X4N01  CONTAINS  DCSCAN,XDSCAN,SYMPUNCH                         01500000
         AGO   .X4N                                                     01800000
.X4D     ANOP                                                           02100000
&COMPNM.X4D01  CONTAINS  DCSCAN,XDSCAN                                  02400000
.X4N     ANOP                                                           02700000
&COMPNM.X4E01  CONTAINS  BLDESD,MAKESD,GETESD,ENTRY,EXTRN,VCON,QCON,   ,03000000
               REFER                                                    03300000
&COMPNM.X4S01  CONTAINS  FIND,ENTER,SUBSET                              03600000
&COMPNM.X4V01  CONTAINS  EVAL                                           03900000
         SPACE                                                          04200000
         SPACE                                                          04500000
*                        ADDRESSING VIA WORK REGISTERS                * 04800000
         SPACE                                                          05100000
DSECT2   DSECT ,                        ADDRESS                         05400000
         USING DSECT2,R2                BASE                            05700000
         SPACE                                                          06000000
DSECT3   DSECT ,                        ADDRESS                         06300000
         USING DSECT3,R3                BASE                            06600000
         SPACE                                                          06900000
         USING JTEXT,R4                 BASE                            07200000
         SPACE                                                          07500000
DSECT5   DSECT ,                        ADDRESS                         07800000
         USING DSECT5,R5                BASE                            08100000
         SPACE                                                          08400000
DSECT6   DSECT ,                        ADDRESS                         08700000
         USING DSECT6,R6                BASE                            09000000
         SPACE                                                          09300000
DSECT7   DSECT ,                        ADDRESS                         09600000
         USING DSECT7,R7                BASE                            09900000
         SPACE                                                          10200000
DSECT10  DSECT ,                        ADDRESS                         10500000
         USING DSECT10,R10              BASE                            10800000
         SPACE                                                          11100000
DSECT11  DSECT                          ADDRESS                         11400000
         USING DSECT11,R11              BASE                            11700000
         SPACE                                                          12000000
DSECT12  DSECT ,                        ADDRESS                         12300000
         USING DSECT12,R12              BASE                            12600000
         SPACE                                                          12900000
DSECT14  DSECT ,                        ADDRESS                         13200000
         USING DSECT14,R14              BASE                            13500000
         SPACE                                                          13800000
DSECT15  DSECT ,                        ADDRESS                         14100000
         USING DSECT15,R15              BASE                            14400000
         EJECT                                                          15000000
DSECT7   DSECT ,                        ADDRESS                         15300000
         ORG   DSECT7                   ORIGIN                          15600000
         SPACE                                                          15900000
SAVE     JSAVE BASE=NO                  SAVE REGISTER                   16200000
         BR    R14                      RETURN                          16500000
EXIT     JRETURN                        RESTORE REGISTERS AND RETURN    16800000
         AIF   ('&TESTRAN' NE 'YES').X4D1                               17100000
X4N01    DS    A                        DC EVALUATION (TESTRAN VERSION) 17400000
         AGO   .X4N1                                                    17700000
.X4D1    ANOP                                                           18000000
X4D01    DS    A                        DC EVALUATION                   18300000
.X4N1    ANOP                                                           18600000
X4E01    DS    A                        ESD PROCESSING                  18900000
X4S01    DS    A                        SYMBOL TABLE ROUTINES           19200000
X4V01    DS    A                        EXPRESSION EVALUATION           19500000
         EJECT                                                          19800000
HASHNR   EQU   64                       NUMBER OF HASH CHAINS           20100000
MINDBL   EQU   1024                     MINIMUM STORAGE REQUIREMENT     20400000
MAXDBL   EQU   4095                     MAXIMUM STORAGE REQUIREMENT     20700000
ALIGNB   EQU   B'00000001'              BYTE ALIGNMENT MASK             21000000
ALIGNH   EQU   B'00000010'              HALFWORD ALIGNMENT MASK         21300000
ALIGNF   EQU   B'00000100'              FULLWORD ALIGNMENT MASK         21600000
ALIGND   EQU   B'00001000'              DOUBLEWORD ALIGNMENT MASK       21900000
         EJECT                                                          22200000
*                        EXTERNAL SYMBOL DICTIONARY                   * 22500000
         SPACE                                                          22800000
ESDBLK1  DS    A(*+4),H'324,0',16XL20   ESD BLOCK 1                     23100000
ESDBLK2  DS    A(*+4),H'324,0',16XL20   ESD BLOCK 2                     23400000
FILELAST DS    01XL9                    END OF SPILL FILE               23700000
NOTELIST DS    25XL9                    ADDRESS OF ESD BLOCKS           24000000
OOPS     DS    X                        ESD OVERFLOW VALVE              24300000
         EJECT                                                          24600000
SYMDIMEN DS    4F                       SYMBOL TABLE POINTERS           24900000
HASHTBL  DS    (HASHNR)F                HASH TABLE                      25200000
         EJECT                                                          25500000
SWTCH1   DSW   ,                        SWITCH 1                       ,25800000
               ,                                                       ,26100000
               ,                                                       ,26400000
               ,                                                       ,26700000
               STBLOFLO,                SYMBOL TABLE OVERFLOW          ,27000000
               LITEND,                  LITERAL AND END        @OX09723,27300006
               IOFLO,                                                  ,27600006
               INOTE                                                    27900000
         SPACE                                                          28200000
SWTCH2   DSW   ,                        SWITCH 2                       ,28500000
               ,                                                       ,28800000
               INCSECT,                                                ,29100000
               ,                                                       ,29400000
               DCMODEXP,                     DC MODIFIER EXPRESSION    ,29700000
               ,                                                       ,30000000
               ,                             NOT USED                  ,30050000
                                             NOT USED                   30300000
MODE     DS    0H                       RESERVED FOR MODE SWITCHES ONLY 30600000
         DS    X                        RESERVED FOR MODE SWITCHES ONLY 30900000
         DSW   ,,,,MODE1,MODE2,,        RESERVED FOR MODE SWITCHES ONLY 31200000
STARTLOC DS    A                        START LOCATION                  31500000
HIESDNR  DS    H                        HIGH ESD ID                     31800000
DCDSSW   DSW   SDZDUPF                  SELF DEF ZERO AS DUPF           32100000
DCDSMODE DSW   NOESD,NOESDS,LMOD,BMOD,SMOD     MODE                     32400000
LINECNT  DS    H                               LINE COUNT               32700000
LOCTRSAV DS    XL6                      LOCATION COUNTER SAVE AREA      33000000
SYMCARD  DS    3F                       TESTRAN CARD BUFFER ADDRESS     33300000
         ORG   LOCTRSAV                 AFTER ASSIGNMENT MODE           33600000
         DS    H                        NOT USED                        33900000
CARDADDR DS    2F                       ADDRESS OF ESD CARD BUFFER      34200000
ADJINDEX DS    2F                       ESD ADJUSTMENT TABLE INDEX      34500000
LATADD   DS    F                        FIRST LITERAL ENTRY ADDRESS     34800000
LATEND   DS    F                        NEXT LITERAL ENTRY ADDRESS      35100000
LATA8    DS    F                        8 CHAIN ADDRESS                 35400000
LATA4    DS    F                        4 CHAIN ADDRESS                 35700000
LATA2    DS    F                        2 CHAIN ADDRESS                 36000000
LATA1    DS    F                        1 CHAIN ADDRESS                 36300000
XPARM    DS    F                        PARAMETER                       36600000
         SPACE                                                          36900000
*                        TESTRAN OUTPUT BUFFER                        * 37200000
         SPACE                                                          37500000
         DS    0F                       ALIGNMENT                       37800000
ORGBYTE  DBV   TSPACE(X'08'),           BYTES SKIPPED                  ,38100000
               TCSECT(X'18'),           CSECT                          ,38400000
               TDSECT(X'28'),           DSECT                          ,38700000
               TCOM(X'38'),             COM                            ,39000000
               TMOP(X'48'),             MACHINE OP                     ,39300000
               TCCW(X'58'),             CCW                            ,39600000
               TMIS(X'68'),             CATCH ALL                      ,39900000
               TDATA(X'88')             DATA TYPE                       40200000
         ORG   ORGBYTE                             ORIGIN               40500000
         DSW   ,MULTIPLE,CLUSTER,SCALING,LABEL     INDICATORS           40800000
ADDRESS  DS    AL3                                 ADDRESS              41100000
NAME     DS    CL8                      NAME                            41400000
LENGTH   DS    F                        LENGTH                          41700000
MULTIP   DS    F                        MULTIPLICITY                    42000000
SCALE    DS    H                        SCALE                           42300000
DATATYPE DBV   ,                        DATA TYPE                      ,42600000
               DTYPEC(X'00'),           DATA TYPE C                    ,42900000
               DTYPEX(X'04'),           DATA TYPE X                    ,43200000
               DTYPEB(X'08'),           DATA TYPE B                    ,43500000
               DTYPEF(X'10'),           DATA TYPE F                    ,43800000
               DTYPEH(X'14'),           DATA TYPE H                    ,44100000
               DTYPEE(X'18'),           DATA TYPE E                    ,44400000
               DTYPED(X'1C'),           DATA TYPE D                    ,44700000
               DTYPEA(X'20'),           DATA TYPE A                    ,45000000
               DTYPEQ(X'20'),           DATA TYPE Q                    ,45300000
               DTYPEY(X'24'),           DATA TYPE Y                    ,45600000
               DTYPES(X'28'),           DATA TYPE S                    ,45900000
               DTYPEV(X'2C'),           DATA TYPE V                    ,46200000
               DTYPEP(X'30'),           DATA TYPE P                    ,46500000
               DTYPEZ(X'34'),           DATA TYPE Z                    ,46800000
               DTYPEL(X'38')            DATA TYPE L                     47100000
         DS    X                        NOT USED                        47400000
         SPACE                                                          47700000
*                        SYMBOL TABLE STAGING AREA                    * 48000000
         SPACE                                                          48300000
XWORK    DS    0F                       WORK                            48600000
         DS    H                        X                               48900000
XFLGA    DS    X                        WORK                            49200000
XFLGB    DS    X                        WORK                            49500000
XTYPE    DS    X                        WORK                            49800000
XFLDI    DS    X                        WORK                            50100000
XESDI    DS    H                        WORK                            50400000
XLCTR    DS    F                        WORK                            50700000
XNAME    DS    CL8                      WORK                            51000000
XLNGQ    DS    H                        WORK                            51300000
FSTCSECT DS    H                        FIRST CSECT NUMBER NUMBER       51600000
HICESDID DS    H                        HIGH EVERYTHING ELSE NUMBER     51900000
HIDESDID DS    H                        HIGH DSECT NUMBER               52200000
INOTEVAL DS    XL8                      INPUT NOT ADDRESS               52500000
         EJECT                                                          52800000
*                        DC/DS ROUTINE WORK AREA                      * 53100000
         SPACE                                                          53400000
         DCDSWORK                                                       53700000
         SPACE                                                          53750000
         DS    0F                                                       53800000
INPUTBUF DS    XL300                    INPUT BUFFER                    53850000
         EJECT                                                          54000000
*                        EVALUATION ROUTINE WORK AREA                 * 54300000
         SPACE                                                          54600000
         EVALWORK                                                       54900000
ENDOFCOM DS    0F                       ENOVID                          55200000
         EJECT                                                          55500000
DSECT6   DSECT ,                        ADDRESS                         73500000
         ORG   DSECT6                   ORIGIN                          73800000
         SPACE                                                          74100000
EITEM    DS    0XL20                    ESD ENTRY                       74400000
ETYPE    DBV   ,                        ESD TYPE                       ,74700000
               ETYPESD(X'00'),               CONTROL SECTION--CSECT    ,75000000
               ETYPELD(X'01'),               LABEL DEFINITION--ENTRY   ,75300000
               ETYPEER(X'02'),               EXTERNAL REFERENCE--EXTRN ,75600000
               ETYPEPC(X'04'),               PRIVATE CODE--            ,75900000
               ETYPECM(X'05'),               COMMON SECTION--COM       ,76200000
               ETYPEXD(X'06'),               EXTERNAL DUMMY--DXD       ,76500000
               ETYPEDX(X'07'),               EXTERNAL DUMMY--DSECT     ,76800000
               ETYPEDS(X'08'),               DUMMY SECTION--DSECT      ,77100000
               ETYPELX(X'09'),               LABEL DEFINITION - ENTRY  ,77400000
               ETYPEWX(X'0A')                EXTERNAL REFERENCE - WXTRN 77700000
         SPACE                                                          78000000
EFLGS    DSW   ,                             NOT USED                  ,78300000
               ,                             NOT USED                  ,78600000
               ,                             NOT USED                  ,78900000
               ,                             NOT USED                  ,79200000
               ESDNRSW2,                     X                         ,79500000
               CSECTSW2,                     X                         ,79800000
               DSECTSW2,                X                              ,80100000
               DSCOMSW2                 X                               80400000
         SPACE                                                          80700000
ERCDC    DS    0XL6                     FIELD                           81000000
ESWTS    DSW   ,DSW2,CSW2,QDSW2                                         81300000
         ORG   ESWTS                    ORIGIN                          81600000
EESDI    DS    H                        ESD IDENTIFICATION              81900000
EFLDA    EQU   *                        FIELD                           82200000
ELCTR    DS    F                        CURRENT LOCATION COUNTER VALUE  82500000
EHILC    DS    F                        HIGH LOCATION COUNTER VALUE     82800000
         ORG   EFLDA                    ORIGIN                          83100000
         DS    H                        NOT USED                        83400000
ELDID    DS    H                        CONTROL SECTION DEFINED         83700000
ELDAD    DS    F                        OFFSET IN CONTROL SECTION       84000000
         ORG   EFLDA                    ORIGIN                          84300000
EXDAL    DBV   ,                        ALIGNMENT                      ,84600000
               EXDALX(B'00000000'),          BYTE BOUNDARY             ,84900000
               EXDALH(B'00000001'),          HALFWORD BOUNDARY         ,85200000
               EXDALF(B'00000011'),          FULLWORD BOUNDARY         ,85500000
               EXDALD(B'00000111'),          DOUBLEWORD BOUNDARY        85800000
         DS    X                        NOT USED                        86100000
EXDID    DS    H                        ESDID OF DSECT REFERENCED       86400000
EXDLN    DS    F                        DUMMY SECTION LENGTH            86700000
ENAME    DS    CL8                      SYMBOL                          87000000
         EJECT                                                          87300000
DSECT14  DSECT ,                        ADDRESS                         87600000
         ORG   DSECT14                  ORIGIN                          87900000
         SPACE                                                          88200000
*                        FORMAT OF SYMBOL TABLE ENTRY                 * 88500000
         SPACE                                                          88800000
SFLGS    DSW   LNGDEF,                  X                              ,89100000
               XDUMMY,                  X                              ,89400000
               XENTRY,                  X                              ,89700000
               ENTRYSW,                 X                              ,90000000
               ESDNRSW,                 X                              ,90300000
               CSECTSW,                 X                              ,90600000
               DSECTSW,                 X                              ,90900000
               DSCOMSW                  X                               90950000
         SPACE                                                          91500000
         ORG   SFLGS                    ORIGIN                          91800000
SCHPT    DS    A                        CHAIN POINTER                   92100000
SNAME    DS    CL8                      SYMBOL                          92400000
SLNGQ    DS    H                        SYMBOL LENGTH ATTRIBUTE         92700000
SSWTS    DSW   ,DSW,CSW,,ESW,EQUF       X              @OY08064,OX00106 93000005
         ORG   SSWTS                    ORIGIN                          93300000
SESDI    DS    H                        ESDID ASSOCIATED WITH VALUE     93600000
SLCTR    DS    F                        VALUE                           93900000
         SPACE                                                          94200000
SLAST    EQU   *                        X                               94500000
         ORG   SCHPT                    ORIGIN                          94800000
SITEM    DS    0XL(SLAST-SCHPT)         FIELD                           95100000
         ORG   SNAME                    ORIGIN                          95400000
SSEG1    DS    0XL(L'SNAME+L'SLNGQ)     FIELD                           95700000
         ORG   SESDI                    ORIGIN                          96000000
SSEG2    DS    0XL(L'SESDI+L'SLCTR)     FIELD                           96300000
./  ADD  SSI=21950310,NAME=JCALL
         MACRO                                                          07000000
&NAME    JCALL &ROUTINE,&BASE=YES                                       14000000
.*                                                                      14050000
.*        GENERATES A BRANCH AND LINK TO A SUBROUTINE.                  14100000
.*                                                                      14150000
         AIF   ('&BASE' EQ 'YES').BASEYES                               21000000
         AIF   ('&BASE' EQ 'NO').BASENO                                 28000000
         MNOTE 8,'INVALID PARAMETER'                                    35000000
         MEXIT                                                          42000000
.BASEYES ANOP                                                           49000000
&NAME    L     R12,=A(&ROUTINE)                                         56000000
         BALR  R9,R12                                                   63000000
         MEXIT                                                          70000000
.BASENO  ANOP                                                           77000000
&NAME    BAL   R9,&ROUTINE                                              84000000
         MEND                                                           91000000
./  ADD  SSI=21950311,NAME=JCHECK
         MACRO                                                          09000000
&NAME    JCHECK &FILE=                                                  18000000
.*                                                                      18050000
.*       GENERATES A CALL TO WORKFILE I/O MODULE CHECK ROUTINE          18100000
.*       TO ISSUE A CHECK FOR A STARTED I/O OPERATION.                  18150000
.*                                                                      18200000
         AIF   (K'&FILE EQ 0).ERR1                                      27000000
&NAME    JINST LA,R10,&FILE,FILE                                        36000000
         L     R12,JMLC                 LOAD BASE                       45000000
         BAL   R9,JCHECK(,R12)          GO TO JCHECK                    54000000
         MEXIT                                                          63000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     72000000
         MEND                                                           81000000
./  ADD  SSI=71710273,NAME=JCOMMON
J        DSECT                                                          00300005
*A678000                                                       @AX14816 00350000
*C678500                                                       @AX14816 00400000
*A564600,831500-833800,924500-930500,831100                    @AZ13738 00402000
*C565000                                                       @AZ13738 00404000
*                                                                       00600000
*        ASSEMBLER COMMON TABLE AS OF 12/08/70.                         00900000
*                                                                       01200000
*        REGISTER EQUATES                                               01500000
*                                                                       01800000
R0       EQU   0                        SCRATCH REGISTER                02100000
R1       EQU   1                        SCRATCH REGISTER                02400000
R2       EQU   2                        WORK REGISTER                   02700000
R3       EQU   3                        WORK REGISTER                   03000000
R4       EQU   4                        WORK REGISTER                   03300000
R5       EQU   5                        WORK REGISTER                   03600000
R6       EQU   6                        WORK REGISTER                   03900000
R7       EQU   7                        MODULE COMMON REGISTER          04200000
R8       EQU   8                        BASE REGISTER                   04500000
R9       EQU   9                        RETURN ADDRESS REGISTER         04800000
R10      EQU   10                       PARAMETER REGISTER (2-WAY)      05100000
R11      EQU   11                       PARAMETER REGISTER (2-WAY)      05400000
R12      EQU   12                       SUBROUTINE CALL REGISTER        05700000
R13      EQU   13                       COMMON REGISTER                 06000000
R14      EQU   14                       SCRATCH                         06300000
R15      EQU   15                       SCRATCH                         06600000
*                                                                       06900000
*        DISPLACEMENT EQUATES                                           07200000
*                                                                       07500000
D0       EQU   0                                                        07800000
D1       EQU   1                                                        08100000
D2       EQU   2                                                        08400000
D3       EQU   3                                                        08700000
D4       EQU   4                                                        09000000
D5       EQU   5                                                        09300000
D6       EQU   6                                                        09600000
D7       EQU   7                                                        09900000
D8       EQU   8                                                        10200000
D9       EQU   9                                                        10500000
D10      EQU   10                                                       10800000
D11      EQU   11                                                       11100000
D12      EQU   12                                                       11400000
D13      EQU   13                                                       11700000
D14      EQU   14                                                       12000000
D15      EQU   15                                                       12300000
D16      EQU   16                                                       12600000
D17      EQU   17                                                       12900000
D18      EQU   18                                                       13200000
D19      EQU   19                                                       13500000
D20      EQU   20                                                       13800000
D21      EQU   21                                                       14100000
D22      EQU   22                                                       14400000
D23      EQU   23                                                       14700000
D24      EQU   24                                                       15000000
D25      EQU   25                                                       15300000
D26      EQU   26                                                       15600000
D27      EQU   27                                                       15900000
D28      EQU   28                                                       16200000
D29      EQU   29                                                       16500000
D30      EQU   30                                                       16800000
D31      EQU   31                                                       17100000
D32      EQU   32                                                       17400000
*                                                                       17700000
*        BIT EQUATES                                                    18000000
*        BIT MASKS FOR BITS 0 - 7 DEFINED BY MACRO IEZBITS              18300000
*                                                                       18600000
         IEZBITS                                                        18650000
BITFF    EQU   B'11111111'                                   ALL        21000000
*                                                                       21300000
*        INTERNAL CODES---PRECEDED BY J                                 21600000
*                                                                       21900000
J0       EQU   X'00'                    NUMBER 0                        22200000
J1       EQU   X'01'                           1                        22500000
J2       EQU   X'02'                           2                        22800000
J3       EQU   X'03'                           3                        23100000
J4       EQU   X'04'                           4                        23400000
J5       EQU   X'05'                           5                        23700000
J6       EQU   X'06'                           6                        24000000
J7       EQU   X'07'                           7                        24300000
J8       EQU   X'08'                           8                        24600000
J9       EQU   X'09'                           9                        24900000
JA       EQU   X'0A'                    LETTER A                        25200000
JB       EQU   X'0B'                           B                        25500000
JC       EQU   X'0C'                           C                        25800000
JD       EQU   X'0D'                           D                        26100000
JE       EQU   X'0E'                           E                        26400000
JF       EQU   X'0F'                           F                        26700000
JG       EQU   X'10'                           G                        27000000
JH       EQU   X'11'                           H                        27300000
JI       EQU   X'12'                           I                        27600000
JJ       EQU   X'13'                           J                        27900000
JK       EQU   X'14'                           K                        28200000
JL       EQU   X'15'                           L                        28500000
JM       EQU   X'16'                           M                        28800000
JN       EQU   X'17'                           N                        29100000
JO       EQU   X'18'                           O                        29400000
JP       EQU   X'19'                           P                        29700000
JQ       EQU   X'1A'                           Q                        30000000
JR       EQU   X'1B'                           R                        30300000
JS       EQU   X'1C'                           S                        30600000
JT       EQU   X'1D'                           T                        30900000
JU       EQU   X'1E'                           U                        31200000
JV       EQU   X'1F'                           V                        31500000
JW       EQU   X'20'                           W                        31800000
JX       EQU   X'21'                           X                        32100000
JY       EQU   X'22'                           Y                        32400000
JZ       EQU   X'23'                           Z                        32700000
JDOLLAR  EQU   X'24'                           $                        33000000
JPOUND   EQU   X'25'                           POUND SIGN               33300000
JAT      EQU   X'26'                           AT SIGN                  33600000
JEQUAL   EQU   X'27'                    SPEC.  =                        33900000
JLPARN   EQU   X'28'                           (                        34200000
JPLUS    EQU   X'29'                           +                        34500000
JMINUS   EQU   X'2A'                           -                        34800000
JASTER   EQU   X'2B'                           *                        35100000
JSLASH   EQU   X'2C'                           /                        35400000
JRPARN   EQU   X'2D'                           )                        35700000
JCOMMA   EQU   X'2E'                           ,                        36000000
JBLANK   EQU   X'2F'                           BLANK                    36300000
JQUOTE   EQU   X'30'                           '                        36600000
JAMPER   EQU   X'31'                           &                        36900000
JPERIOD  EQU   X'32'                           .                        37200000
JNUMMIN  EQU   J0                       MINIMUM NUMBER CODE             37500000
JNUMMAX  EQU   J9                       MAXIMUM NUMBER CODE             37800000
JALFAMIN EQU   JA                       MINIMUM ALPHA CODE              38100000
JALFAMAX EQU   JAT                      MAXIMUM ALPHA CODE              38400000
JOPERMIN EQU   JPLUS                    MINIMUM OPERATOR CODE           38700000
JOPERMAX EQU   JSLASH                   MAXIMUM OPERATOR CODE           39000000
*                                                                       39300000
*        COMMON STORAGE                                                 39600000
*                                                                       39900000
         USING JCOMMON,R13              SET UP COMMON BASE              40200000
JCOMMON  DS    0D                       BEGINNING OF COMMON             40500000
JSAVE    DS    18F                      SYSTEM SAVE AREA                40800000
JFLEBLK1 DS    14A                      FILE BLOCK 1                    41100000
FILE1    EQU   JFLEBLK1-JCOMMON         FILE 1 CODE                     41400000
JFLEBLK2 DS    14A                      FILE BLOCK 2                    41700000
FILE2    EQU   JFLEBLK2-JCOMMON         FILE 2 CODE                     42000000
JFLEBLK3 DS    14A                      FILE BLOCK 3                    42300000
FILE3    EQU   JFLEBLK3-JCOMMON         FILE 3 CODE                     42600000
JMAXRL1  DS    H                        MAX RL FOR FILE 1               42900000
JMAXRL2  DS    H                        MAX RL FOR FILE 2               43200000
JMAXRL3  DS    H                        MAX RL FOR FILE 3               43500000
JMAXRL   DS    H                        MIN OF MAX RL FOR ALL FILES     43800000
JADINCM  DS    A                        ADDRESS OF INPUT COMMON         44400000
JADOUTCM DS    A                        ADDRESS OF OUTPUT COMMON        44700000
JPHNAME  DS    0CL8                     PHASE NAME OF LAST PHASE LOADED 45000000
JPHPREF  DS    CL3                      PHASE NAME PREFIX               45300000
JPHSUFF  DS    CL3                      PHASE NAME SUFFIX               45600000
JPHBLANK DS    CL2                      TWO BLANKS                      45900000
JLVTMDT  DS    0CL24                    ASM LEVEL, TIME, DATE           46500000
         DS    CL10                     SAME                            46800000
JSYSTIME DS    CL5                             HH.MM                    47100000
         DS    C                        BLANK                           47400000
JSYSDATE DS    CL8                             MM/DD/YY OR DD/MM/YY     47700000
JDECKIDL DS    X                        LENGTH OF DECK ID (0 THRU 8)    48000000
JDECKID  DS    CL8                      INTERNAL DECK ID                48300000
JPARMS   DS    0XL3                     MSGLEVEL AND LINECOUNT          48300500
JMSGL    DS    X                        MSGLEVEL=                       48301000
JLNCT    DS    H                        LINECNT=                        48302000
JSYSPARM DS    A                        SYSPARM POINTER                 49200000
JPARMPTR DS    A                        ADDR OF TRANS PARM (IF PRESENT) 49500000
JPARM    DS    0A                       OPTION PARMS (PARM 1,2,3,4)     50100000
*                                       PARAMETER (OPTION BYTE 1)       50400000
JPARM1   DSW   JLIST,                          PRINT LISTING           X50700000
               JXREF,                          PRINT XREF              X51000000
               JESD,                           PRINT ESD'S             X51300000
               JRLD,                           PRINT RLD'S             X51600000
               JDECK,                          PUNCH DECK              X51900000
               JLINK,                          WRITE OBJECT MODULE     X52200000
               JTEST                           PUNCH SYMBOL TABLE       52600000
*                                       PARAMETER (OPTION BYTE 2)       53100000
JPARM2   DSW   JRENT,                          RE-ENTRANT CHECKING     X53400000
               JALGN,                          ALIGNMENT CHECKING      X53700000
               JSYSMAC,                        PRINT SYSTEM MACROS     X54000000
               JALOGIC,                        PRINT ASSEMBLER LOGIC   X54300000
               JMLOGIC,                        PRINT MACRO LOGIC       X54600000
               JCALLS                          PRINT INNER MACRO CALLS  54900000
*                                       PARAMETER (OPTION BYTE 3)       55200000
JPARM3   DSW   JTERM,                          PRINT TO TERMINAL       X55500000
               JSTMT,                          PRINT STMT NO. ON TERM  X55800000
               JNUM,                           PRINT SEQ NO. ON TERM   X56100000
               JMINXREF,                       SHORT XREF              X56102000
               JMINBUF,,                       MINIMUM BUFFERS OR      X56110000
               JLNCTKEY,                       FIXED LINECNT           X56120000
               JMSGLKEY                        FIXED MSGLEVEL           56130000
*                                       PARAMETER (OPTION BYTE 4)       56400000
JPARM4    DSW   JYFLAG,                 ERR MSG IFO205 IF ON   @OX09734X56450005
               JMBUF,                   MULTIBUFFERS REQ IF ON @AZ13738X56460000
               ,,,,JMCHECK              FLAG FOR MLC           @AZ13738 56500000
JPREFIX  DS    CL3                      COMPONENT NAME                  58800000
*                                       WARNING FLAGS                   59100000
JWARNFLG DSW   JYCON,                          RELOCATABLE YCON        X59400000
               JREENTR                         REENTRANT CHK FAILED     59700000
*                                       POST PROCESSOR FLAGS            60000000
JRECCHK  DSW   JRLDCHK,                        RLD RECORDS PRESENT     X60300000
               JXREFCHK,                       XREF RECORDS PRESENT    X60600000
               JERRCHK,                        ERROR RECORDS PRESENT   X60900000
               JESDCHK,                        ESDID PRESENT ON END    X61200000
               JENDCHK                         PUNCH END CARD           61500000
*                                       ERROR FLAGS TO POST PROCESSOR   61800000
JINDERRF DSW   JMISLIN,                        MISSING SYSLIN DD CARD  X62100000
               JMISPCH,                        MISSING SYSPUNCH DD CARDX62400000
               JINVOPT,                        INVALID OPTION          X62600000
               JESDOFLO,                       ESD OVERFLOW            X62700000
               JMISPRT,                        MISSING SYSPRINT DD CARDX62800000
               JMISTERM,                       MISSING SYSTERM DD CARD X63000000
               JMISLIB                         SYSLIB DD CARD MISSING   63200000
*                                       PDUMP FLAGS                     63600000
JPDFLAG  DSW   JDUMPX0,                        DUMP PHASE X0           X63900000
               JDUMPX1,                        DUMP PHASE X1           X64200000
               JDUMPX2,                        DUMP PHASE X2           X64500000
               JDUMPX3,                        DUMP PHASE X3           X64800000
               JDUMPX4,                        DUMP PHASE X4           X65100000
               JDUMPX5,                        DUMP PHASE X5           X65400000
               JDUMPX6                         DUMP PHASE X6            65700000
*                                       COMMUNICATION FLAGS FOR JINMLC  66300000
JINFLAG  DSW   JIN2ND,                         ENTERED JININIT ONCE    X66600000
               JINLIB                          INPUT FROM LIBRARY       66900000
*                                       COMMUN. FLAGS FOR PRT/PCH       67200000
JOUTFLAG DSW   JOUT2ND,                        ENTERED JOUTINIT ONCE   X67500000
               JNOSEQPH,                       DON'T SEQ PUNCH @AX14816X67800000
               JSUPPRT                         SUPR PRNT 1 LINE@AX14816 67850000
*                                       COMMUNICATION FLAGS FOR MLC     68100000
JMLCFLAG DSW   JPT4STAR,                       POINT TO START OF FILE  X68500000
               JPT4READ,                       READ TO FOLLOW POINT    X69000000
               JPT4WRIT,                       WRITE TO FOLLOW POINT   X69300000
               JPT4GET,                        GET TO FOLLOW POINT     X69600000
               JDBLALL                  FILES CAN BE DBLBUF             69900000
JMLC     DS    A                        ADDRESS OF MAIN LINE CONTROL    70200000
JPUTL    EQU   0                        DISPLACEMENT FOR JPUTL          70500000
JPUTM    EQU   4                                         JPUTM          70800000
JGETL    EQU   8                                         JGETL          71100000
JTRUNC   EQU   12                                        JTRUNC         71400000
JRELSE   EQU   16                                        JRELSE         71700000
JREAD    EQU   20                                        JREAD          72000000
JWRITE   EQU   24                                        JWRITE         72300000
JCHECK   EQU   28                                        JCHECK         72600000
JGETCORE EQU   32                                        JGETCORE       72900000
JFRECORE EQU   36                                        JFRECORE       73200000
JNOTE    EQU   40                                        JNOTE          73500000
JPOINT   EQU   44                                        JPOINT         73800000
JINMLC   DS    A                        ADDR OF INPUT MAIN LINE CONTROL 74100000
JINPUT   EQU   0                        DISPLACEMENT FOR JINPUT         74400000
JFIND    EQU   4                                         JFIND          74700000
JNOTELB  EQU   8                                         JNOTELB        75000000
JPOINTLB EQU   12                                        JPOINTLB       75300000
JININIT  EQU   16                                        JININIT        75600000
JOUTMLC  DS    A                        ADDR OF OUTPUT MAIN LINE CONTRL 75900000
JPRINT   EQU   0                        DISPLACEMENT FOR JPRINT         76200000
JPUNCH   EQU   4                                         JPUNCH         76500000
JOUTINIT EQU   8                                         JOUTINIT       76800000
JPDUMP   DS    A                        ADDRESS OF PDUMP ROUTINE        77100000
JNOTEVAL DS    CL8                      VALUE FROM JNOTE                77700000
JRECIN   DS    F                        NUMBER OF RECORDS FROM SYSIN    78300000
JRECLIB  DS    F                        NUMBER OF RECORDS FROM LIBRARY  78600000
JRECPCH  DS    F                        NUMBER OF CARDS PUNCHED         78900000
JRECPRT  DS    F                        NUMBER OF LINES PRINTED         79200000
JSLEN    DS    A                        LENGTH OF AREA (JEOS-JBOS)      79800000
JBOS     DS    A                        BEGINNING OF AVAILABLE CORE     80100000
JEOS     DS    A                        NEXT AVAILABLE GETCORE AREA     80400000
JSAVELVL EQU   10                       NUMBER OF SAVE LEVELS           80700000
JSAVESZ  EQU   4*(R9-R2+1)              SIZE OF ONE SAVE AREA IN BYTES  81000000
JCLVLPTR DS    A                        CURRENT SAVE LEVEL PTR          81300000
         DS    A                        SIZE OF ONE SAVE AREA           81600000
JSAVETBL DS    (JSAVESZ*JSAVELVL/4)A    PUSH/POP SAVE AREA              81900000
JABORT   DS    A                        ABORT ROUTINE LINKAGE           82200000
JAABORT  DS    A                        ADDR OF ABORT ROUTINE           82500000
JSYSOPEN DS    A                        WORKFILE OPEN                   82800000
JSYSCLOS DS    A                        WORKFILE CLOSE                  83100000
CORESIZE DS    F                        REQUESTED WORKAREA     @AZ13738 83110000
OLDBUF   DS    F                        PTR TO MBUF LAST USED  @AZ13738 83150000
CURRBUF  DS    F                        PTR TO MBUF IN USE     @AZ13738 83200000
BUFSTART DS    F                        PTR TO START OF BUFTABL@AZ13738 83250000
LOWPRIOR DS    F                        PTR TO LAST ENTRY      @AZ13738 83300000
HIMASK   DS    H                        HIGEST PRIORITY VALUE  @AZ13738 83350000
LOMASK   DS    H                        LOWEST PRIORITY VALUE  @AZ13738 83360000
CURRMASK DS    H                        SAVEAREA FOR PRIORITY  @AZ13738 83370000
NRMBUF   DS    H                        NUMBER OF MBUFFERS     @AZ13738 83380000
JCONTCL  DS    H                        CONTINUE COLUMN                 83400000
JENDCOL  DS    H                        END COLUMN                      83700000
ENTRPUTL DS    A                        ENTRY POINT OF PUTLINE          84000000
JDWORD   DS    D                        DOUBLE WORD OF TEMP STORAGE     84600000
JFWORD1  DS    F                        TWO FULL WORDS                  84900000
JFWORD2  DS    F                               OF TEMP STORAGE          85200000
JHWORD1  DS    H                        TWO HALF WORDS                  85500000
JHWORD2  DS    H                               OF TEMP STORAGE          85800000
JSRCLN   DS    F                        DATA PORTION MOVE LENGTH  (1-7) 86100000
JBEGCL   DS    F                        BEGIN COLUMN MINUS 1      (2-7) 86400000
JCTCHR   DS    F                        CONT CHR COLUMN MINUS 1   (3-7) 86700000
JSEQCL   DS    F                        SEQ FLD BEGIN COL MINUS 1 (4-7) 87000000
JSEQLN   DS    F                        SEQ FLD MOVE LENGTH       (5-7) 87300000
JCTBGN   DS    F                        CONT COLUMN MINUS 1       (6-7) 87600000
JCTLN    DS    F                        CONT FLD MOVE LENGTH      (7-7) 87900000
JINFILE  DS    H                        INPUT FILE NO. FOR X4,X5,X6     88200000
JOUTFILE DS    H                        OUTPUT FILE NO. FOR X4,X5,X6    88500000
JENTRYPT DS    A                        ENTRY POINT ADDR FOR END CARD   88800000
JESDID   DS    H                        ESDID FOR OBJECT END CARD       89100000
JPAGENO  DS    H                        PAGE NUMBER FOR LISTING         89400000
JDPASS   DS    CL56                     COMMUN. BETWEEN X2A AND X3N     89700000
JSEVER   DS    X                        HIGHEST SEVERITY FOR X5, X6     90000000
JPRTONLY DS    X                        CATASTROPHIC ERROR IN X4        90300000
         DSW   JSYSGEN                  OFF INDICATES SYSGEN MODE       90600000
         DS    X                        (NOT USED)                      90900000
JLITLNG  DS    H                        MAXIMUM LITERAL LENGTH          91200000
JTBLTRT  DS    CL51                     TRANSLATE AND TEST TABLE        91800000
JTRTABLE DS    CL256                    SELF MAPPING TRANSLATE TABLE    92100000
JSAFE    DS    18F                      SAVE AREA FOR PDUMPS            92200000
JIDR     DS    CL39                     IDR                             92210000
JCOMEND  DS    0D                       END OF COMMON                   92400000
* THIS DSECT DESCRIBE BUFFERENTRYS IN MULTIBUFFER MODE         @AZ13738 92450000
BUFENTRY DSECT                                                 @AZ13738 92500000
FWBUFPTR EQU   *-BUFENTRY               PTS TO NEXT ENTRY      @AZ13738 92510000
         DS    F                        PTS TO NEXT ENTRY      @AZ13738 92550000
FWCHAIN  EQU   *-BUFENTRY               PTS TO NEXT SEQ BUFF   @AZ13738 92560000
         DS    F                        PTS TO NEXT SEQ BUFF   @AZ13738 92600000
BWCHAIN  EQU   *-BUFENTRY               PTS TO PREV. SEQ BUFF  @AZ13738 92650000
         DS    F                        PTS TO PREV. SEQ BUFF  @AZ13738 92660000
BUFTTR   EQU   *-BUFENTRY               BUFFER TTR VALUE       @AZ13738 92700000
BUFNOTE  EQU   *-BUFENTRY               TTR VALUE WITH BUF DISP@AZ13738 92702000
         DS    F                        BUFFER TTR VALUE       @AZ13738 92710000
BUFDISPL EQU   *-BUFENTRY               DISPL OF REC INTO BUFF @AZ13738 92750000
         DS    H                        DISPL OF REC INTO BUFF @AZ13738 92800000
PRIOR    EQU   *-BUFENTRY               PRIORITY VALUE         @AZ13738 92900000
         DS    H                        PRIORITY VALUE         @AZ13738 92910000
BUFADR   EQU   *-BUFENTRY               PTR TO BUFFER          @AZ13738 92950000
         DS    F                        PTR TO BUFFER          @AZ13738 92960000
BUFFEND  EQU   *                        END OF ENTRY           @AZ13738 93000000
BUFENLN  EQU   BUFFEND-BUFENTRY         LENGH OF ENTRY         @AZ13738 93050000
./  ADD  SSI=21950320,NAME=JCSECT
         MACRO                                                          04000000
         JCSECT &PARM                                                   08000000
         GBLC  &COMPNM,&ASMID                                           12000000
         LCLC  &X,&Y                                                    16000000
.*                                                                      20000000
.*       THIS MACRO GENERATES A CSECT STATEMENT WITH A CSECT NAME       20050000
.*       COMPOSED FROM THE MACRO INSTRUCTION OPERANDS                   20150000
.*       AND AN EQU TO THIS NAME IF WANTED.                             20200000
         AIF   (K'&PARM LT 7).ERR1                                      24000000
         AIF   ('&PARM'(1,1) NE '(').ERR1                               28000000
         AIF   ('&PARM'(K'&PARM,1) NE ')').ERR1                         32000000
         AIF   (K'&PARM EQ 7).NXA                                       36000000
         AIF   ('&PARM'(7,1) NE '=').ERR1                               40000000
.NXA     AIF   ('&PARM'(2,3) NE '&ASMID').ERR1                          44000000
.*                                                                      48000000
&X       SETC  '&PARM'(2,5)                                             52000000
&COMPNM&X CSECT                                                         56000000
.*                                                                      60000000
         AIF   (K'&PARM EQ 7).NXB                                       64000000
&Y       SETC  '&PARM'(8,K'&PARM-8)                                     68000000
&Y       EQU   &COMPNM&X                                                72000000
.NXB     MEXIT                                                          76000000
.*                                                                      80000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     84000000
         MEND                                                           88000000
./  ADD  SSI=21950321,NAME=JENTRY
         MACRO                                                          04000000
         JENTRY &PARM                                                   08000000
         GBLC  &COMPNM,&ASMID                                           12000000
         LCLC  &X,&Y                                                    16000000
.*                                                                      20000000
.*       DEFINES AN ENTRY POINT BY GENERATING AN ENTRY STATEMENT        20050000
.*       AND IF WANTED, AN EQU TO IT WITH THE SPECIFIED SYMBOL.         20100000
.*       THE ENTRY POINT NAME MUST FOLLOW XF NAMING CONVENTIONS.        20150000
.*                                                                      20200000
         AIF   (K'&PARM LT 9).ERR1                                      24000000
         AIF   ('&PARM'(1,1) NE '(').ERR1                               28000000
         AIF   ('&PARM'(K'&PARM,1) NE ')').ERR1                         32000000
         AIF   ('&PARM'(7,1) NE '=').ERR1                               36000000
         AIF   ('&PARM'(2,3) NE '&ASMID').ERR1                          40000000
.*                                                                      44000000
&X       SETC  '&PARM'(2,5)                                             48000000
&Y       SETC  '&PARM'(8,K'&PARM-8)                                     52000000
.*                                                                      56000000
         ENTRY &COMPNM&X                                                60000000
&COMPNM&X EQU  &Y                                                       64000000
         MEXIT                                                          68000000
.*                                                                      72000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     76000000
         MEND                                                           80000000
./  ADD  SSI=21950322,NAME=JERMSGCD
* /* START OF SPECIFICATIONS ****                                       00050000
*02* PROCESSOR = ASSEMBLER                                              00060000
**** END OF SPECIFICATIONS ***/                                         00070000
JERMSGCD DSECT                                                          00100000
*                                                                       00200000
*  THIS DSECT PROVIDES EQUATES TO ALLOW THE USE OF SYMBOLIC ERROR AND   00300000
*  SEVERITY CODES IN THE CREATION OF ERROR MESSAGES AND ERROR RECORDS.  00400000
*                                                                       00500000
ERR0     EQU   0    UNDEFINED ERROR CODE - RECORD = XXXXXXXXXXXXXXXX    00600000
ERR11    EQU   11      THIS ERROR RESERVED.  USED FOR INTERMODULE      X00650000
                          COMMUNICATION BETWEEN X1A AND X1J.            00700000
         JGENERR NOGEN                                                  10600000
ERR256   EQU   256  SYSLIN DD CARD MISSING - NOLOAD OPTION USED         32300000
ERR257   EQU   257  SYSPUNCH DD CARD MISSING - NODECK OPTION USED       32400000
ERR258   EQU   258  INVALID ASSEMBLER OPTIONS ON EXECUTE CARD - IGNORED 32500000
ERR259   EQU   259  AT LEAST ONE RELOCATABLE Y TYPE CONSTANT IN THIS AS-32600000
                    SEMBLY                                              32700000
ERR260   EQU   260  ASSEMBLY TERMINATED.  DD CARD MISSING FOT XXXXXXXX  32800000
ERR261   EQU   261  ASSEMBLY TERMINATED.  (I/O ERROR INFORMATION)       32900000
ERR262   EQU   262  ASSEMBLY TERMINATED.  INSUFFICIENT MEMORY.          33000000
ERR263   EQU   263  ASSEMBLY TERMINATED.  PROGRAM LOGIC ERROR.          33100000
ERR264   EQU   264  ESDID NUMBER HAS EXCEEDED THE LIMIT OF 399          33150000
ERR265   EQU   265  SYMBOL TABLE OVERFLOWED.                            33160000
ERR266   EQU   266  LAST ASSEMBLER PHASE LOADED WAS XXXXXXXX.           33180000
ERR267   EQU   267  SYSPRINT DD CARD MISSING - NOLIST OPTION USED       33190000
SEV0     EQU   16                                                       33200000
SEV1     EQU   8                                                        33300000
SEV2     EQU   8                                                        33400000
SEV3     EQU   8                                                        33500000
SEV4     EQU   8                                                        33600000
SEV5     EQU   8                                                        33700000
SEV6     EQU   8                                                        33800000
SEV7     EQU   8                                                        33900000
SEV8     EQU   8                                                        34000000
SEV9     EQU   12                                                       34100000
SEV10    EQU   8                                                        34200000
SEV11    EQU   8                                                        34300000
SEV12    EQU   8                                                        34400000
SEV13    EQU   8                                                        34500000
SEV14    EQU   8                                                        34600000
SEV15    EQU   0                  TEMPORARY                             34700000
SEV16    EQU   8                                                        34800000
SEV17    EQU   4                                                        34900000
SEV18    EQU   4                                                        35000000
SEV19    EQU   8                                                        35100000
SEV20    EQU   0                   TEMPORARY                            35200000
SEV21    EQU   8                                                        35300000
SEV22    EQU   8                                                        35400000
SEV23    EQU   8                                                        35500000
SEV24    EQU   8                                                        35600000
SEV25    EQU   4                                                        35700000
SEV26    EQU   4                                                        35800000
SEV27    EQU   8                                                        35900000
SEV28    EQU   8                                                        36000000
SEV29    EQU   8                                                        36100000
SEV30    EQU   8                                                        36200000
SEV31    EQU   8                                                        36300000
SEV32    EQU   8                                                        36400000
SEV33    EQU   8                                                        36500000
SEV34    EQU   8                                                        36600000
SEV35    EQU   8                                                        36700000
SEV36    EQU   8                                                        36800000
SEV37    EQU   8                                                        36900000
SEV38    EQU   8                                                        37000000
SEV39    EQU   8                                                        37100000
SEV40    EQU   8                                                        37200000
SEV41    EQU   0                     TEMPORARY                          37300000
SEV42    EQU   8                                                        37400000
SEV43    EQU   8                                                        37500000
SEV44    EQU   0                  TEMPORARY                             37600000
SEV45    EQU   8                                                        37700000
SEV46    EQU   8                                                        37800000
SEV47    EQU   4                                                        37900000
SEV48    EQU   8                                                        38000000
SEV49    EQU   8                                                        38100000
SEV50    EQU   8                                                        38200000
SEV51    EQU   4                                                        38300000
SEV52    EQU   8                                                        38400000
SEV53    EQU   8                                                        38500000
SEV54    EQU   8                                                        38600000
SEV55    EQU   8                                                        38700000
SEV56    EQU   8                                                        38800000
SEV57    EQU   8                                                        38900000
SEV58    EQU   8                                                        39000000
SEV59    EQU   8                                                        39100000
SEV60    EQU   4                                                        39200000
SEV61    EQU   8                                                        39300000
SEV62    EQU   8                                                        39400000
SEV63    EQU   0                   TEMPORARY                            39500000
SEV64    EQU   12                                                       39600000
SEV65    EQU   8                                                        39700000
SEV66    EQU   8                                                        39800000
SEV67    EQU   4                                                        39900000
SEV68    EQU   8                                                        40000000
SEV69    EQU   4                                                        40100000
SEV70    EQU   8                                                        40200000
SEV71    EQU   8                                                        40300000
SEV72    EQU   8                                                        40400000
SEV73    EQU   8                                                        40500000
SEV74    EQU   4                                                        40600000
SEV75    EQU   8                                                        40700000
SEV76    EQU   4                                                        40800000
SEV77    EQU   0                    TEMPORARY                           40900000
SEV78    EQU   8                                                        41000000
SEV79    EQU   8                                                        41100000
SEV80    EQU   4                                                        41200000
SEV81    EQU   4                                                        41300000
SEV82    EQU   0                    TEMPORARY                           41400000
SEV83    EQU   0                    TEMPORARY                           41500000
SEV84    EQU   0                    TEMPORARY                           41600000
SEV85    EQU   8                                                        41700000
SEV86    EQU   86                                                       41800000
SEV87    EQU   8                                                        41900000
SEV88    EQU   8                                                        42000000
SEV89    EQU   12                                                       42100000
SEV90    EQU   8                                                        42200000
SEV91    EQU   8                                                        42300000
SEV92    EQU   8                                                        42400000
SEV93    EQU   93                                                       42500000
SEV94    EQU   94                                                       42600000
SEV95    EQU   95                                                       42700000
SEV96    EQU   96                                                       42800000
SEV97    EQU   97                                                       42900000
SEV98    EQU   98                                                       43000000
SEV99    EQU   99                                                       43100000
SEV100   EQU   8                                                        43200000
SEV101   EQU   8                                                        43300000
SEV102   EQU   8                                                        43400000
SEV103   EQU   8                                                        43500000
SEV104   EQU   4                                                        43600000
SEV105   EQU   8                                                        43700000
SEV106   EQU   8                                                        43800000
SEV107   EQU   8                                                        43900000
SEV108   EQU   8                                                        44000000
SEV109   EQU   8                                                        44100000
SEV110   EQU   8                                                        44200000
SEV111   EQU   8                                                        44300000
SEV112   EQU   8                                                        44400000
SEV113   EQU   8                                                        44500000
SEV114   EQU   8                                                        44600000
SEV115   EQU   8                                                        44700000
SEV116   EQU   4                                                        44800000
SEV117   EQU   8                                                        44900000
SEV118   EQU   8                                                        45000000
SEV119   EQU   4                                                        45100000
SEV120   EQU   4                                                        45200000
SEV121   EQU   4                                                        45300000
SEV122   EQU   4                                                        45400000
SEV123   EQU   4                                                        45500000
SEV124   EQU   4                                                        45600000
SEV125   EQU   8                                                        45700000
SEV126   EQU   8                                                        45800000
SEV127   EQU   8                                                        45900000
SEV128   EQU   8                                                        46000000
SEV129   EQU   8                                                        46100000
SEV130   EQU   8                                                        46200000
SEV131   EQU   8                                                        46300000
SEV132   EQU   8                                                        46400000
SEV133   EQU   12                                                       46500000
SEV134   EQU   134                                                      46600000
SEV135   EQU   135                                                      46700000
SEV136   EQU   136                                                      46800000
SEV137   EQU   137                                                      46900000
SEV138   EQU   138                                                      47000000
SEV139   EQU   139                                                      47100000
SEV140   EQU   140                                                      47200000
SEV141   EQU   141                                                      47300000
SEV142   EQU   142                                                      47400000
SEV143   EQU   143                                                      47500000
SEV144   EQU   144                                                      47600000
SEV145   EQU   145                                                      47700000
SEV146   EQU   146                                                      47800000
SEV147   EQU   147                                                      47900000
SEV148   EQU   148                                                      48000000
SEV149   EQU   149                                                      48100000
SEV150   EQU   150                                                      48200000
SEV151   EQU   151                                                      48300000
SEV152   EQU   152                                                      48400000
SEV153   EQU   153                                                      48500000
SEV154   EQU   154                                                      48600000
SEV155   EQU   155                                                      48700000
SEV156   EQU   156                                                      48800000
SEV157   EQU   8                                                        48900000
SEV158   EQU   8                                                        49000000
SEV159   EQU   8                                                        49050000
SEV160   EQU   160                                                      49200000
SEV161   EQU   8                                                        49300000
SEV162   EQU   8                                                        49400000
SEV163   EQU   4                                                        49500000
SEV164   EQU   4                                                        49600000
SEV165   EQU   4                                                        49700000
SEV166   EQU   8                                                        49800000
SEV167   EQU   16                                                       49900000
SEV168   EQU   8                                                        50000000
SEV169   EQU   8                                                        50100000
SEV170   EQU   8                                                        50200000
SEV171   EQU   4                                                        50300000
SEV172   EQU   8                                                        50400000
SEV173   EQU   8                                                        50500000
SEV174   EQU   8                                                        50600000
SEV175   EQU   8                                                        50700000
SEV176   EQU   8                                                        50800000
SEV177   EQU   12                                                       50900000
SEV178   EQU   8                                                        51000000
SEV179   EQU   8                                                        51100000
SEV180   EQU   12                                                       51200000
SEV181   EQU   12                                                       51300000
SEV182   EQU   12                                                       51400000
SEV183   EQU   12                                                       51500000
SEV184   EQU   12                                                       51600000
SEV185   EQU   8                                                        51700000
SEV186   EQU   8                                                        51800000
SEV187   EQU   8                                                        51900000
SEV188   EQU   8                                                        52000000
SEV189   EQU   8                                                        52100000
SEV190   EQU   4                                                        52200000
SEV191   EQU   8                                                        52300000
SEV192   EQU   4                                                        52400000
SEV193   EQU   8                                                        52500000
SEV194   EQU   4                                                        52600000
SEV195   EQU   12                                                       52700000
SEV196   EQU   8                                                        52800000
SEV197   EQU   0                                                        52900000
SEV198   EQU   8                                                        53000000
SEV199   EQU   8                                                        53100000
SEV200   EQU   8                                                        53200000
SEV201   EQU   8                                                        53300000
SEV202   EQU   8                                                        53400000
SEV203   EQU   4                                                        53500000
SEV204   EQU   8                                                        53600000
SEV205   EQU   4                                                        53700000
SEV206   EQU   8                                                        53800000
SEV207   EQU   8                                                        53900000
SEV208   EQU   8                                                        54000000
SEV209   EQU   8                                                        54100000
SEV210   EQU   12                                                       54200000
SEV211   EQU   12                                                       54300000
SEV212   EQU   8                                                        54400000
SEV213   EQU   8                                                        54500000
SEV214   EQU   12                                                       54600000
SEV215   EQU   8                                                        54700000
SEV216   EQU   12                                                       54800000
SEV217   EQU   12                                                       54900000
SEV218   EQU   12                                                       55000000
SEV219   EQU   8                                                        55100000
SEV220   EQU   4                                                        55200000
SEV221   EQU   12                                                       55300000
SEV222   EQU   12                                                       55400000
SEV223   EQU   12                                                       55500000
SEV224   EQU   8                                                        55600000
SEV225   EQU   4                                                        55700000
SEV226   EQU   12                                                       55800000
SEV227   EQU   8                                                        55900000
SEV228   EQU   8                                                        56000000
SEV229   EQU   4                                                        56100000
SEV230   EQU   12                                                       56200000
SEV231   EQU   8                                                        56300000
SEV232   EQU   8                                                        56400000
SEV233   EQU   8                                                        56500000
SEV234   EQU   8                                                        56600000
SEV235   EQU   8                                                        56700000
SEV236   EQU   8                                                        56800000
SEV237   EQU   8                                                        56900000
SEV238   EQU   8                                                        57000000
SEV239   EQU   8                                                        57100000
SEV240   EQU   8                                                        57200000
SEV241   EQU   8                                                        57300000
SEV242   EQU   4                                                        57400000
SEV243   EQU   8                                                        57500000
SEV244   EQU   8                                                        57600000
SEV245   EQU   8                                                        57700000
SEV246   EQU   8                                                        57800000
SEV247   EQU   247                                                      57900000
SEV248   EQU   248                                                      58000000
SEV249   EQU   249                                                      58100000
SEV250   EQU   250                                                      58200000
SEV251   EQU   251                                                      58300000
SEV252   EQU   252                                                      58400000
SEV253   EQU   253                                                      58500000
SEV254   EQU   4                                                        58600000
SEV255   EQU   8                                                        58700000
SEV256   EQU   16                                                       58800000
SEV257   EQU   16                                                       58900000
SEV258   EQU   16                                                       59000000
SEV259   EQU   4                                                        59100000
SEV260   EQU   20                                                       59200000
SEV261   EQU   20                                                       59300000
SEV262   EQU   20                                                       59400000
SEV263   EQU   20                                                       59500000
SEV264   EQU   16                                                       69500000
SEV265   EQU   16                                                       79500000
SEV266   EQU   4                                                        89500000
SEV267   EQU   16                                                       89550000
./  ADD  SSI=21950323,NAME=JERRCD
JERRCD   DSECT                                                          04000000
*                                                                       08000000
*              ERROR RECORD FORMAT                                      12000000
*                                                                       16000000
JERECL   DS    H                  RECORD LENGTH                         20000000
JEFLGA   DSW   JEPSOP             FLAG A                                24000000
JEFLGB   DSW   ,,,,               FLAG B                               *28000000
               JEPRPOS            ERROR MSG PRINT POSITION SWITCH       32000000
*                                  IF JEPRPOS = 1 PRINT ERROR BEFORE    36000000
*                                  STATEMENT. IF = 0 PRINT ERROR AFTER  40000000
*                                  STATEMENT.                           44000000
         DBV   JEOPCOD(JTERROR),  INTERNAL OP CODE                     C48000000
               JEEOF(JTEOF)       INTERNAL END-OF-FILE                  52000000
JECOLPTR DS    X                  COLUMN POINTER                        56000000
JESTMTNO DS    CL3                      STATEMENT NUMBER                60000000
JEERCOD  DS    0CL2                     ERROR AND SEVERITY CODE         64000000
JESEV    DS    C                  SEVERITY CODE                         68000000
JERCDE   DS    C                  ERROR CODE                            72000000
JENODATA DS    X                  NUMBER OF 8 BYTE DATA ITEMS           76000000
JEDATA   EQU   *                  DATA ITEMS MAX OF 10 ITEMS OF EXACTLY 80000000
*                                  8 BYTES EACH.                        84000000
./  ADD  SSI=21950325,NAME=JEXTRN
         MACRO                                                          04000000
         JEXTRN &PARM                                                   08000000
         GBLC  &COMPNM                                                  12000000
         LCLC  &X,&Y                                                    16000000
.*                                                                      20000000
.*       DEFINES AN EXTERNAL REFERENCE BY GENERATING AN EXTRN STATEMENT 20050000
.*       NAME MUST FOLLOW XF NAMING CONVENTIONS. AN EQU TO THE          20100000
.*       EXTERNAL SYMBOL IS GENERATED IF OPERAND IS GIVEN.              20150000
.*                                                                      20200000
         AIF   (K'&PARM LT 9).ERR1                                      24000000
         AIF   ('&PARM'(1,1) NE '(').ERR1                               28000000
         AIF   ('&PARM'(K'&PARM,1) NE ')').ERR1                         32000000
         AIF   ('&PARM'(7,1) NE '=').ERR1                               36000000
.*                                                                      40000000
&X       SETC  '&PARM'(2,5)                                             44000000
&Y       SETC  '&PARM'(8,K'&PARM-8)                                     48000000
.*                                                                      52000000
         EXTRN &COMPNM&X                                                56000000
&Y       EQU   &COMPNM&X                                                60000000
         MEXIT                                                          64000000
.*                                                                      68000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     72000000
         MEND                                                           76000000
./  ADD  SSI=21950327,NAME=JFIND
         MACRO                                                          09000000
&NAME    JFIND &ADDR=                                                   18000000
.*       GENERATES A CALL TO THE FIND ROUTINE IN THE I/O MODULE         18050000
.*       TO ISSUE A FIND FOR A MACRO OR COPY CODE MEMBER.               18100000
         AIF   (K'&ADDR EQ 0).ERR1                                      27000000
&NAME    JINST LA,R10,&ADDR                                             36000000
         L     R12,JINMLC               LOAD BASE                       45000000
         BAL   R9,JFIND(,R12)           GO TO JFIND                     54000000
         MEXIT                                                          63000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     72000000
         MEND                                                           81000000
./  ADD  SSI=71710275,NAME=JFLEBLK
JFLEBLK  DSECT                          FILE BLOCK DSECT                05000000
*A751000                                                       @AZ13738 05050000
         WRITE JDECB,SF,MF=L            DECB FOR READ AND WRITE         10000000
JTCLOSE  CLOSE (,),TYPE=T,MF=L          TCLOSE PARM LIST                15000000
JFLE     DS    A                        ADDR OF FILE DEFINITION         20000000
JBUFFER  DS    A                        ADDR OF ALTERNATE BUFFER        25000000
JBUF     DS    A                        ADDR OF BUFFER                  30000000
JRL      DS    H                        RECORD LENGTH                   35000000
JBUFNDX  DS    H                        BUFFER DISPLACEMENT (INDEX)     40000000
JIOFLAG  DSW   JPUTLPND,                PUTL PENDING                   X45000000
               JGETLPND,                GETL PENDING                   X50000000
               JGETLPNT,                GETL TO FOLLOW POINT           X55000000
               JGETLSBF,                POINT (GETL) WITHIN SAME BUFFERX60000000
               JNOTED,                  NOTE VALUE OF LAST RECORD NOTEDX65000000
               JDBLBUF,                 OUTPUT IS DOUBLE BUFFERED      X70000000
               JCHKFILE,                FILE NEEDS TO BE CHECKED       X75000000
               JPUTLWRT                 PUTL FORCED WRITE               75050000
JMLTFLAG DSW   JMLTBUF                  MBUFFERS IN USE        @AZ13738 75100000
JLSTNOTE DS    CL6                      NOTE VALUE OF LAST RECORD NOTED 80000000
./  ADD  SSI=21950330,NAME=JFRECORE
         MACRO                                                          09000000
&NAME    JFRECORE &ADDR=                                                18000000
.*       GENERATES A CALL TO THE I/O INTERFACE MODULES TO FREE          18050000
.*       A BLOCK OF DOUBLE WORD STORRAGE.                               18100000
         AIF   (K'&ADDR EQ 0).ERR1                                      27000000
&NAME    JINST L,R10,&ADDR                                              36000000
         L     R12,JMLC                 LOAD BASE                       45000000
         BAL   R9,JFRECORE(,R12)        GO TO JFRECORE                  54000000
         MEXIT                                                          63000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     72000000
         MEND                                                           81000000
./  ADD  SSI=21950332,NAME=JGEN
         MACRO                                                          04000000
&NAME    JGEN  &NM,&TYPE,&DATA,&LEN                                     08000000
         LCLA  &END,&I                                                  12000000
         LCLC  &C(2),&L                                                 16000000
.*       GENERATES AN ORG TO SPECIFIED ADDRESS                          16050000
.*       AND A DC OF SPECIFIED TYPE AND VALUE.                          16100000
         ORG   START+&NM-JCOMMON                                        20000000
&C(1)    SETC  '('                                                      24000000
&C(2)    SETC  ')'                                                      28000000
         AIF   ('&TYPE' EQ 'A' OR '&TYPE' EQ 'Q' OR '&TYPE' EQ 'V' OR  X32000000
               '&TYPE' EQ 'S' OR '&TYPE' EQ 'Y').NXA                    36000000
&C(1)    SETC  ''''                                                     40000000
&C(2)    SETC  ''''                                                     44000000
.NXA     AIF   (K'&LEN EQ 0).NXB                                        48000000
&L       SETC  'L'.'&LEN'                                               52000000
.NXB     AIF   (K'&NAME EQ 0).NXC                                       56000000
&NAME    DS    0&TYPE&L                                                 60000000
.NXC     ANOP                                                           64000000
&I       SETA  1                                                        68000000
&END     SETA  N'&DATA                                                  72000000
.NXD     DC    &TYPE&L&C(1)&DATA(&I)&C(2)                               76000000
&I       SETA  &I+1                                                     80000000
         AIF   (&I LE &END).NXD                                         84000000
.NXE     MEND                                                           88000000
./  ADD  SSI=21950324,NAME=JGENERR
         MACRO                                                          06000000
         JGENERR &OPTION                                                12000000
         GBLB  &GENSW                                                   18000000
.*  THIS MACRO IS CALLED BY ALL PHASES WITH THE OPTION NOGEN TO GENERAT 24000000
.*  THE DSECT JERMSGCD.  IT IS ALSO CALLED BY CSECT X6C WITH THE OPTION 30000000
.*  GEN TO GENERATE ALL OF THE ERROR MESSAGES.                          36000000
&GENSW   SETB  0                        TURN OFF GEN SWITCH             36050000
         AIF   ('&OPTION' EQ 'NOGEN').C1 DO WE GENERATE ERROR MESSAGES  42000000
&GENSW   SETB  1                        YES, TURN ON GEN SWITCH         48000000
.C1      ANOP                           PROCEED TO CALL GENERR MACRO    54000000
.*                                      TO GENERATE EITHER ERROR MSGS   60000000
.*                                      OR DSECT JERMSGCD, DEPENDING    66000000
.*                                      UPON THE SETTING OF &GENSW.     72000000
         COPY  ERMS                                                     78000000
         MEND                                                           84000000
./  ADD  SSI=21950326,NAME=JGENIN
         MACRO                                                          00800000
&LABEL   JGENIN &LIST,&LENGTH                                           01600000
         LCLA  &K,&C,&CT,&LEN                                           02400000
         LCLB  &SW,&SW1                                                 03200000
         LCLC  &LET,&GEN(8)                                             04000000
.* GENERATES INTERNALLY CODED TEXT.                                     04800000
.* ACCEPTS ALPHA, NUMBERIC, AND ALL SPECIAL CHARACTERS EXCEPT           05600000
.* AMPERSAND AND QUOTE.                                                 06400000
&K       SETA  K'&LIST                                                  07200000
&C       SETA  1                                                        08000000
         AIF   ('&LIST'(1,1) NE '''').M1                                08800000
&C       SETA  2                                                        09600000
&SW      SETB  1                                                        10400000
.M1      AIF   ('&LENGTH' NE '').M2                                     11200000
&SW1     SETB  1                                                        12000000
&LEN     SETA  0                                                        12800000
.*  SW =0 - NO QUOTE                                                    13600000
.*  SW =1 - QUOTE                                                       14400000
.*  SW1=0 - LENGTH                                                      15200000
.*  SW1=1 - NO LENGTH                                                   16000000
.M2      AIF   (&SW).M3                 BRANCH QUOTE                    16800000
         AIF   (&SW1).M5                BRANCH NO QUOTE, NO LENGTH      17600000
.*   NO QUOTE  LENGTH                                                   18400000
         AIF   (&LENGTH GT &K).M2A                                      19200000
&K       SETA  &LENGTH                                                  20000000
&LEN     SETA  0                                                        20800000
         AGO   .M5                                                      21600000
.M2A     ANOP                                                           22400000
&LEN     SETA  &LENGTH-&K                                               23200000
         AGO   .M5                                                      24000000
.*   QUOTE                                                              24800000
.M3      AIF   (&SW1).M4                BRANCH QUOTE NO LENGTH          25600000
.*   QUOTE LENGTH                                                       26400000
&K       SETA  &K-2                                                     27200000
         AIF   (&LENGTH GT &K).M3A                                      28000000
&K       SETA  &LENGTH+1                                                28800000
&LEN     SETA  0                                                        29600000
         AGO   .M5                                                      30400000
.M3A     ANOP                                                           31200000
&LEN     SETA  &LENGTH-&K                                               32000000
&K       SETA  &K+1                                                     32800000
         AGO   .M5                                                      33600000
.*   QUOTE  NO LENGTH                                                   34400000
.M4      ANOP                                                           35200000
&K       SETA  &K-1                                                     36000000
.M5      AIF   ('&LABEL' EQ '').L2                                      36800000
&LABEL   DC    0CL(&K-&C+1+&LEN)' '                                     37600000
.L2      ANOP                                                           38400000
&CT      SETA  1                                                        39200000
.L3      AIF   ('&LIST'(&C,1) EQ '$').L3DOLR      DOLLAR                40000000
         AIF   ('&LIST'(&C,1) EQ '#').L3POUND     POUND                 40800000
         AIF   ('&LIST'(&C,1) EQ '@').L3AT        AT                    41600000
         AIF   ('&LIST'(&C,1) EQ '=').L3EQ        EQUAL                 42400000
         AIF   ('&LIST'(&C,1) EQ '(').L3LP        LEFT PARN.            43200000
         AIF   ('&LIST'(&C,1) EQ '+').L3PLUS      PLUS                  44000000
         AIF   ('&LIST'(&C,1) EQ '-').L3MIN       MINUS                 44800000
         AIF   ('&LIST'(&C,1) EQ '*').L3AST       ASTER                 45600000
         AIF   ('&LIST'(&C,1) EQ '/').L3SLASH     SLASH                 46400000
         AIF   ('&LIST'(&C,1) EQ ')').L3RP        RIGHT PARN.           47200000
         AIF   ('&LIST'(&C,1) EQ ',').L3C         COMMA                 48000000
         AIF   ('&LIST'(&C,1) EQ ' ').L3B         BLANK                 48800000
         AIF   ('&LIST'(&C,1) EQ '.').L3P         PERIOD                49600000
&LET     SETC  'J'.'&LIST'(&C,1)                                        50400000
.L6      AIF   (&CT EQ 1).L7                                            51200000
&LET     SETC  ','.'&LET'                                               52000000
.L7      ANOP                                                           52800000
&GEN(&CT) SETC '&LET'                                                   53600000
&C       SETA  &C+1                                                     54400000
         AIF   (&C GT &K).L9                                            55200000
&CT      SETA  &CT+1                                                    56000000
         AIF   (&CT LT 9).L3                                            56800000
         DC    AL1(&GEN(1)&GEN(2)&GEN(3)&GEN(4)&GEN(5)&GEN(6)&GEN(7)&GEX57600000
               N(8))                                                    58400000
&CT      SETA  1                                                        59200000
.L8      ANOP                                                           60000000
&GEN(&CT) SETC ''                                                       60800000
&CT      SETA  &CT+1                                                    61600000
         AIF   (&CT LT 9).L8                                            62400000
         AGO   .L2                                                      63200000
.L3DOLR  ANOP                                                           64000000
&LET     SETC  'JDOLLAR'                                                64800000
         AGO   .L6                                                      65600000
.L3POUND ANOP                                                           66400000
&LET     SETC  'JPOUND'                                                 67200000
         AGO   .L6                                                      68000000
.L3AT    ANOP                                                           68800000
&LET     SETC  'JAT'                                                    69600000
         AGO   .L6                                                      70400000
.L3EQ    ANOP                                                           71200000
&LET     SETC  'JEQUAL'                                                 72000000
         AGO   .L6                                                      72800000
.L3LP    ANOP                                                           73600000
&LET     SETC  'JLPARN'                                                 74400000
         AGO   .L6                                                      75200000
.L3PLUS  ANOP                                                           76000000
&LET     SETC  'JPLUS'                                                  76800000
         AGO   .L6                                                      77600000
.L3MIN   ANOP                                                           78400000
&LET     SETC  'JMINUS'                                                 79200000
         AGO   .L6                                                      80000000
.L3AST   ANOP                                                           80800000
&LET     SETC  'JASTER'                                                 81600000
         AGO   .L6                                                      82400000
.L3SLASH ANOP                                                           83200000
&LET     SETC  'JSLASH'                                                 84000000
         AGO   .L6                                                      84800000
.L3RP    ANOP                                                           85600000
&LET     SETC  'JRPARN'                                                 86400000
         AGO   .L6                                                      87200000
.L3C     ANOP                                                           88000000
&LET     SETC  'JCOMMA'                                                 88800000
         AGO   .L6                                                      89600000
.L3B     ANOP                                                           90400000
&LET     SETC  'JBLANK'                                                 91200000
         AGO   .L6                                                      92000000
.L3P     ANOP                                                           92800000
&LET     SETC  'JPERIOD'                                                93600000
         AGO   .L6                                                      94400000
.L9      DC    AL1(&GEN(1)&GEN(2)&GEN(3)&GEN(4)&GEN(5)&GEN(6)&GEN(7)&GEX95200000
               N(8))                                                    96000000
         AIF   (&LEN EQ 0).L10                                          96800000
         DC    &LEN.AL1(JBLANK)                                         97600000
.L10     MEND                                                           98400000
./  ADD  SSI=21950328,NAME=JGETCORE
         MACRO                                                          04000000
&NAME    JGETCORE &MINDBL=,&MAXDBL=,&DBL=                               08000000
         LCLA  &AA,&BB                                                  12000000
         LCLB  &A,&B                                                    16000000
.*       GENERATES A CALL TO THE I/O INTERFACE MODULES TO GET           16010000
.*       A VARIABLE NUMBER OF DOUBLE WORD STORAGE.                      16050000
&A       SETB  (K'&MINDBL EQ 0 AND K'&MAXDBL EQ 0)                      20000000
&B       SETB  (K'&DBL EQ 0)                                            24000000
&AA      SETA  &A                                                       28000000
&BB      SETA  &B                                                       32000000
         AIF   (&AA EQ &BB).ERR1                                        36000000
         AIF   (K'&DBL EQ 0).NXA                                        40000000
&NAME    JINST LA,R10,&DBL                                              44000000
         LR    R11,R10                                                  48000000
         AGO   .NXB                                                     52000000
.NXA     ANOP                                                           56000000
&NAME    JINST LA,R10,&MINDBL                                           60000000
         JINST LA,R11,&MAXDBL                                           64000000
.NXB     L     R12,JMLC                 LOAD BASE                       68000000
         BAL   R9,JGETCORE(,R12)        GO TO JGETCORE                  72000000
         MEXIT                                                          76000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     80000000
         MEND                                                           84000000
./  ADD  SSI=21950331,NAME=JGETL
         MACRO                                                          09000000
&NAME    JGETL &FILE=                                                   18000000
.*       GENERATES A CALL TO TEH WORKFILE I/O MODULE TO GET THE ADDRESS 18050000
.*       OF THE NEXT LOGICAL RECORD.                                    18100000
         AIF   (K'&FILE EQ 0).ERR1                                      27000000
&NAME    JINST LA,R10,&FILE,FILE                                        36000000
         L     R12,JMLC                 LOAD BASE                       45000000
         BAL   R9,JGETL(,R12)           GO TO JGETL                     54000000
         MEXIT                                                          63000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     72000000
         MEND                                                           81000000
./  ADD  SSI=21950333,NAME=JHEAD
         MACRO                                                          02000000
         JHEAD &TITLE,&PHASEID=,&LEVEL=                                 04000000
         GBLA  &ASMLEV                                                  06000000
         GBLC  &COMPNM,&ASMID                                           08000000
         LCLA  &I,&J                                                    10000000
         LCLC  &X(10)                                                   12000000
.*                                                                      14000000
.*       GENERATES A TITLE STATEMENT AND A STATUS MNOTE                 14050000
.*       IN THE PROLOUGE TO AN MODULE.                                  14100000
         AIF   (K'&TITLE GT 47).ERR1    TOO BIG FOR ONE TITLE CARD      16000000
         AIF   (K'&PHASEID NE 3).ERR1   IT MUST BE THREE IN LENGTH      18000000
         AIF   (K'&LEVEL EQ 0).ERR1     IT MUST BE PRESENT              20000000
.*                                                                      22000000
&ASMID   SETC  '&PHASEID'               PUT PHASEID IN GBLC             24000000
&ASMLEV  SETA  &LEVEL                   PUT LEVEL IN GBLA               26000000
.*                                                                      28000000
&COMPNM  SETC  'IFN'                    SYSTEM INDEPENDENT NAME         30000000
         AIF   ('&ASMID'(2,1) NE '0').SKIP                              32000000
&COMPNM  SETC  'IFO'                    SYSTEM DEPENDENT NAME           34000000
.SKIP    ANOP                                                           36000000
.*                                                                      38000000
&I       SETA  1                        NOW TRANSFER TITLE TO VARIABLE  40000000
&J       SETA  2                                                        42000000
.LPA     ANOP                                                           44000000
         AIF   (K'&TITLE EQ &J).NXA                                     44600000
         AIF   (K'&TITLE LT &J+8).LPA1                                  45200000
&X(&I)   SETC  '&TITLE'(&J,8)                                           46000000
&I       SETA  &I+1                                                     48000000
&J       SETA  &J+8                                                     50000000
         AGO   .LPA                                                     52000000
.LPA1    ANOP                                                           54000000
&X(&I)   SETC  '&TITLE'(&J,K'&TITLE-&J)                                 56000000
.NXA     ANOP                                                           58000000
.*                                                                      60000000
&ASMID   TITLE '&COMPNM&ASMID - &X(1)&X(2)&X(3)&X(4)&X(5)&X(6)'         62000000
.*                                                                      64000000
         MNOTE *,'STATUS--CHANGE LEVEL &LEVEL'                          66000000
         MEXIT                                                          68000000
.*                                                                      70000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     72000000
         MEND                                                           74000000
./  ADD  SSI=21950334,NAME=JINCOM
JINCOM   DSECT                                                          07000000
         USING JINCOM,R7                SET UP MODULE COMMON BASE       14000000
JSYSIN   DS    A                        ADDR OF FILE DEF FOR INPUT      21000000
JSYSLIB  DS    A                        ADDR OF FILE DEF FOR LIBRARY    28000000
JINOPEN  DS    A                        ADDR OF OPEN PARM LIST          35000000
JINCLOS  DS    A                        ADDR OF CLOSE PARM LIST         42000000
         READ  JLIBDECB,SF,MF=L         DECB FOR LIBRARY                49000000
JLIBBUF  DS    A                        ADDR OF LIBRARY BUFFER          56000000
JBLKSIZE DS    H                        BLOCK SIZE OF CURRENT LIB REC   63000000
JLIBNDX  DS    H                        BUFFER INDEX INTO LIB BUFFER    70000000
JINSW    DSW   JREADPT                  SPECIAL READ FOR POINT          77000000
JINCMEND DS    0D                       END OF INPUT COMMON             84000000
./  ADD  SSI=21950335,NAME=JINPUT
         MACRO                                                          10000000
&NAME    JINPUT                                                         20000000
.*       GENERATES A CALL TO THE INPUT I/O MODULE TO GET THE NEXT       20050000
.*       RECORD FROM THE INPUT FILE.                                    20100000
&NAME    L     R12,JINMLC               LOAD BASE                       30000000
         BAL   R9,JINPUT(,R12)          GO TO JINPUT                    40000000
         MEND                                                           50000000
./  ADD  SSI=21950336,NAME=JINST
         MACRO                                                          05000000
&NAME    JINST &OP,&REG,&ADDR,&COMP                                     10000000
         LCLC  &X                                                       15000000
         LCLA  &I                                                       17000000
.*       INNER MACRO.   GENERATES MACHINE INSTRUCTIONS ACCORDING        17050000
.*       TO MACRO CALL OPERANDS VALUES.                                 17100000
         AIF   ('&ADDR'(1,1) NE '(').NXC                                20000000
         AIF   ('&ADDR'(K'&ADDR,1) NE ')').NXC                          25000000
&X       SETC  '&ADDR'(2,K'&ADDR-2)                                     30000000
         AIF   ('&X' NE '&REG').NXB                                     35000000
         AIF   (K'&NAME EQ 0).NXA                                       40000000
&NAME    DC    0H'0'                                                    45000000
.NXA     MEXIT                                                          50000000
.NXB     ANOP                                                           55000000
&NAME    LR    &REG,&X                                                  60000000
         MEXIT                                                          65000000
.NXC     ANOP                                                           70000000
&I       SETA  4                                                        71000000
         AIF   (K'&ADDR GE 4).NXC1                                      72000000
&I       SETA  K'&ADDR                                                  73000000
.NXC1    AIF   (K'&COMP NE 0 AND '&ADDR'(1,&I) NE 'FILE').ERR1          74000000
&NAME    &OP   &REG,&ADDR                                               75000000
         MEXIT                                                          80000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     85000000
         MEND                                                           90000000
./  ADD  SSI=21950338,NAME=JMODID
         MACRO                                                          10000000
&NAME    JMODID                                                         20000000
         GBLA  &SNUMBER,&ASMLEV                                         30000000
         GBLC  &ASMID,&COMPNM                                           40000000
.*       GENERATES EMBEDDED IDENTIFIER CONSISTING OF SIX CARACTER       40050000
.*       MODULE NAME AND A HALF WORD BINARY ASSEMBLER LEVEL.            40100000
&NAME    DC    CL6'&COMPNM&ASMID',HL2'&ASMLEV'                          50000000
         MEND                                                           60000000
./  ADD  SSI=21950341,NAME=JNOTE
         MACRO                                                          09000000
&NAME    JNOTE &FILE=                                                   18000000
.*       GENERATES A CALL TO THE WORKFILE I/O MODULE TO GET             18050000
.*       THE RELETIVE POSITION OF THE LAST READ OR WRITE                18100000
         AIF   (K'&FILE EQ 0).ERR1                                      27000000
&NAME    JINST LA,R10,&FILE,FILE                                        36000000
         L     R12,JMLC                 LOAD BASE                       45000000
         BAL   R9,JNOTE(,R12)           GO TO JNOTE                     54000000
         MEXIT                                                          63000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     72000000
         MEND                                                           81000000
./  ADD  SSI=21950344,NAME=JNOTELB
         MACRO                                                          10000000
&NAME    JNOTELB                                                        20000000
.*       GENERATES A CALL TO THE INPUT I/O MODULE TO NOTE               20050000
.*       THE POSITION IN LIBRARY.                                       20100000
&NAME    L     R12,JINMLC               LOAD BASE                       30000000
         BAL   R9,JNOTELB(,R12)         GO TO JNOTELB                   40000000
         MEND                                                           50000000
./  ADD  SSI=21950337,NAME=JOUTCOM
JOUTCOM  DSECT                          OUTPUT COMMON DSECT             04000000
         USING JOUTCOM,R7               SETUP USING FOR OUTPUT COMMON   08000000
JSYSLST  DS    A                        ADDR OF FILE DEF FOR PRINT FILE 12000000
JSYSPCH  DS    A                        ADDR OF FILE DEF FOR PUNCH FILE 16000000
JSYSLNK  DS    A                        ADDR OF FILE DEF FOR LINK FILE  20000000
JSYSTRM  DS    A                        ADDR OF FILE DEF FOR TERM FILE  22000000
JOUTOPEN DS    A                        ADDR OF OPEN PARM LIST          24000000
JOUTCLOS DS    A                        ADDR OF CLOSE PARM LIST         28000000
JCURPRT  DS    A                        ADDR OF CURRENT PRINT BUFFER    32000000
JCURTRM  DS    A                        ADDR OF CURRENT TERM PRINT BUF  34000000
JCURPCH  DS    A                        ADDR OF CURRENT PUNCH BUFFER    36000000
JDECKSEQ DS    H                        DECK SEQUENCE NUMBER            40000000
JOUTSW   DSW   BYPASPRT,                1ST PRINT SWITCH               X44000000
               BYPASPCH,                1ST PUNCH SWITCH               X48000000
               CLOSPRT,                 FINAL PRINT SWITCH             X52000000
               CLOSPCH,                 FINAL PUNCH SWITCH             X56000000
               NOSEQ,                   DON'T SEQ PUNCHED OUTPUT       X60000000
               BYPASTRM,                FIRST TERM PRINT SWITCH        X63000000
               CLOSTRM                  FINAL TERM PRINT SWITCH         66000000
JOUTCMND DS    0D                                                       88000000
./  ADD  SSI=71710276,NAME=JPARM
         MACRO                                                          00500000
         JPARM &FIXED=,                 FIXED PARAMETER OPTIONS        X01000000
               &DEFAULT=,               DEFAULT PARAMETER OPTIONS      X01500000
               &VERSION=0               VERSION IDENTIFICATION          02000000
         LCLA  &I,&J,&L,&X,&Y,&Z                               @AZ13738 02500000
         LCLB  &A(25),&B(25),&C(25),&D(25),&F,&N               @AZ13738 03000000
         LCLC  &K,&S                                           @AZ13738 03500000
.* GENERATES THE CODE IN IFOX0J WHICH CONTAINS THE BIT STRINGS          03550000
.* REPRESENTING OPTIONS IN EFFECT                                       03600000
&X       SETA  55                                 LINECNT=60            04000000
&Z       SETA  X'200000'                DEFAULT ASMSIZE=2M     @AZ13738 04050000
&B(1)    SETB  1                                                        04500000
&B(2)    SETB  1                                                        05000000
&B(3)    SETB  1                                                        05500000
&B(4)    SETB  1                                                        06000000
&B(5)    SETB  1                                                        06500000
&B(6)    SETB  1                                                        07000000
&B(7)    SETB  1                                                        07500000
&B(8)    SETB  1                                                        08000000
&B(9)    SETB  1                                                        08500000
&B(10)   SETB  1                                                        09000000
&B(11)   SETB  1                                                        09500000
&B(12)   SETB  1                                                        10000000
&B(13)   SETB  1                                                        10500000
&B(14)   SETB  1                                                        11000000
&B(15)   SETB  1                                                        11500000
&B(16)   SETB  1                                                        12000000
&B(17)   SETB  1                                                        12500000
&B(18)   SETB  1                                                        13000000
&B(19)   SETB  1                                                        13500000
&B(20)   SETB  1                                                        14000000
&B(21)   SETB  1                                                        14500000
&B(22)   SETB  1                                                        15000000
&B(23)   SETB  1                                                        15500000
&B(24)   SETB  1                                                        16000000
&B(25)   SETB  1                                                        16050000
&D(1)    SETB  1                                  LIST                  16500000
&D(2)    SETB  1                                  XREF                  17000000
&D(3)    SETB  1                                  ESD                   17500000
&D(4)    SETB  1                                  RLD                   18000000
&D(5)    SETB  1                                  DECK                  18500000
&D(8)    SETB  1                                  STAT                  19000000
&D(10)   SETB  1                                  ALGN                  19500000
&D(12)   SETB  1                                  ALOGIC                20000000
&D(18)   SETB  1                        STMT                            20100000
&D(19)   SETB  1                                                        20200000
&D(20)   SETB  1                   XREF(SHORT)                          20250005
&D(25)   SETB  1                        YFLAG                           20300000
.P1      ANOP                                                           20500000
&I       SETA  &I+1                               INCREMENT INDEX       21000000
         AIF   (&I GT N'&FIXED).D1                FINIS                 21500000
         AIF   (K'&FIXED(&I) EQ 0).P1             NULL SUB PARAMETER    22000000
         AIF   (K'&FIXED(&I) GT 2).E4             INVALID SUB PARAMETER 22500000
.E5      MNOTE 4,'* * * INVALID OPERAND -- &FIXED(&I)'                  23000000
         AGO   .P1                                                      23500000
.E4      AIF   ('&FIXED(&I)'(1,2) NE 'NO').P2     PREFIX 'NO'           24000000
&N       SETB  1                                  PREFIX 'NO'           24500000
&K       SETC  '&FIXED(&I)'(3,K'&FIXED(&I)-2)     KEYWORD               25000000
         AGO   .P3                                SKIP                  25500000
.P2      AIF   (K'&FIXED(&I) GT 8).X1             KEYWORD               26000000
&N       SETB  0                                  NO PREFIX 'NO'        26500000
&K       SETC  '&FIXED(&I)'                       KEYWORD               27000000
.P3      ANOP                                                           27500000
&J       SETA  1                                  'LIST'                28000000
         AIF   ('&K' EQ 'LIST').S1                LIST/NOLIST           28500000
&J       SETA  2                                  'XREF'                29000000
         AIF   ('&K' EQ 'XREF').S1                XREF/NOXREF           29500000
&J       SETA  3                                  'ESD'                 30000000
         AIF   ('&K' EQ 'ESD').S1                 ESD/NOESD             30500000
&J       SETA  4                                  'RLD'                 31000000
         AIF   ('&K' EQ 'RLD').S1                 RLD/NORLD             31500000
&J       SETA  5                                  'DECK'                32000000
         AIF   ('&K' EQ 'DECK').S1                DECK/NODECK           32500000
&J       SETA  6                                  'LOAD'                33000000
         AIF   ('&K' EQ 'LOAD').S1                LOAD/NOLOAD           33500000
&J       SETA  7                                  'TEST'                34000000
         AIF   ('&K' EQ 'TEST').S1                TEST/NOTEST           34500000
&J       SETA  8                                  'STAT'                35000000
         AIF   ('&K' EQ 'STAT').S1                STAT/NOSTAT           35500000
&J       SETA  9                                  'RENT'                36000000
         AIF   ('&K' EQ 'RENT').S1                RENT/NORENT           36500000
&J       SETA  10                                 'ALGN'                37000000
         AIF   ('&K' EQ 'ALGN').S1                ALGN/NOALGN           37500000
&J       SETA  11                                 'SYSMAC'              38000000
         AIF   ('&K' EQ 'SYSMAC').S1              SYSMAC/NOSYSMAC       38500000
&J       SETA  12                                 'ALOGIC'              39000000
         AIF   ('&K' EQ 'ALOGIC').S1              ALOGIC/NOALOGIC       39500000
&J       SETA  13                                 'MLOGIC'              40000000
         AIF   ('&K' EQ 'MLOGIC').S1              MLOGIC/NOMLOGIC       40500000
&J       SETA  14                                 'CALLS'               41000000
         AIF   ('&K' EQ 'CALLS').S1               CALLS/NOCALLS         41500000
&J       SETA  18                                 'TERM'                42000000
         AIF   ('&K' EQ 'TERM').S1                TERM/NOTERM           42500000
&J       SETA  19                                 'STMT'                43000000
         AIF   ('&K' EQ 'STMT').S1                STMT/NOSTMT           43500000
&J       SETA  20                                 'NUM'                 44000000
         AIF   ('&K' EQ 'NUM').S1                 NUM/NONUM             44500000
&J       SETA  25                       'YFLAG'                @AZ13738 44550000
         AIF   ('&K' EQ 'YFLAG').S1     YFLAG/NOYFLAG          @AZ13738 44600000
         AIF   (NOT &F).E5                        INVALID KEYWORD       45000000
         AGO   .E7                                                      45500000
.S1      AIF   (&F).S2                                                  46000000
         AIF   (NOT &A(&J)).S4                                          46500000
.ED      MNOTE 4,'* * * INCOMPATIBLE OPTION -- &FIXED(&I)'              47000000
         AGO   .P1                                                      47500000
.S4      ANOP                                                           48000000
&A(&J)   SETB  1                                                        48500000
&B(&J)   SETB  (NOT &N)                                                 49000000
&C(&J)   SETB  (NOT &N)                                                 49500000
&D(&J)   SETB  (NOT &N)                                                 50000000
         AGO   .P1                                                      50500000
.S2      AIF   (NOT &A(&J)).S3                                          51000000
.EC      MNOTE 4,'* * * INCOMPATIBLE OPTION -- &DEFAULT(&L)'            51500000
         AGO   .D1                                                      52000000
.S3      ANOP                                                           52500000
&A(&J)   SETB  1                                                        53000000
&D(&J)   SETB  (NOT &N)                           DEFAULT OPTION        53500000
.D1      ANOP                                                           54000000
&F       SETB  1                                  DEFAULT SCAN          54500000
&L       SETA  &L+1                               INCREMENT INDEX       55000000
         AIF   (&L GT N'&DEFAULT).G1              END OF SCAN           55500000
         AIF   (K'&DEFAULT(&L) EQ 0).D1           NULL SUB OPERAND      56000000
         AIF   (K'&DEFAULT(&L) GT 2).E6           INVALID SUB PARAMETER 56500000
.E7      MNOTE 4,'* * * INVALID OPERAND -- &DEFAULT(&L)'                57000000
         AGO   .D1                                                      57500000
.E6      AIF   ('&DEFAULT(&L)'(1,2) NE 'NO').D2   PREFIX 'NO'           58000000
&N       SETB  1                                  PREFIX 'NO'           58500000
&K       SETC  '&DEFAULT(&L)'(3,K'&DEFAULT(&L)-2) KEYWORD               59000000
         AGO   .P3                                                      59500000
.D2      AIF   (K'&DEFAULT(&L) GT 8).K1           KEYWORD               60000000
&N       SETB  0                                  NO PREFIX             60500000
&K       SETC  '&DEFAULT(&L)'                     KEYWORD               61000000
         AGO   .P3                                                      61500000
.K1      AIF   ('&DEFAULT(&L)'(1,8) NE 'LINECNT=').K11                  62000000
&K       SETC  '&DEFAULT(&L)'(9,K'&DEFAULT(&L)-8) VALUE                 62500000
         AGO   .Y1                                                      63000000
.K11     AIF  ('&DEFAULT(&L)'(1,9) NE 'WORKSIZE=').K2          @AZ13738 63050000
&S       SETC  '&DEFAULT(&L)'(10,K'&DEFAULT(&L)-9) VALUE       @AZ13738 63100000
         AGO   .SIZE                                           @AZ13738 63150000
.K2      AIF   ('&DEFAULT(&L)'(1,9) NE 'MSGLEVEL=').E7                  63500000
&K       SETC  '&DEFAULT(&L)'(10,K'&DEFAULT(&L)-9)                      64000000
         AGO   .Z1                                                      64500000
.X1      AIF   ('&FIXED(&I)'(1,8) NE 'LINECNT=').X11           @AZ13738 65000000
&K       SETC  '&FIXED(&I)'(9,K'&FIXED(&I)-8)     VALUE                 65500000
         AGO   .Y1                                                      66000000
.X11     AIF   ('&FIXED(&I)'(1,9) NE 'WORKSIZE=').X2           @AZ13738 66050000
&S       SETC  '&FIXED(&I)'(10,K'&FIXED(&I)-9) VALUE           @AZ13738 66100000
         AGO   .SIZE                                           @AZ13738 66150000
.X2      AIF   ('&FIXED(&I)'(1,9) NE 'MSGLEVEL=').E5                    66500000
&K       SETC  '&FIXED(&I)'(10,K'&FIXED(&I)-9)    VALUE                 67000000
.Z1      ANOP                                                           67500000
&Y       SETA  &K                                 VALUE                 68000000
         AIF   (&Y LT 256).EF                                           68500000
         MNOTE 4,'* * * INVALID VALUE -- &Y'                            69000000
&Y       SETA  0                                                        69500000
         AIF   (&F).D1                                                  70000000
         AGO   .P1                                                      70500000
.EF      AIF   (&A(24) AND &F).EC                                       71000000
         AIF   (&A(24)).ED                                              71500000
&A(24)   SETB  1                                                        72000000
         AIF   (&F).D1                                                  72500000
&D(24)   SETB  1                                                        73000000
         AGO   .P1                                                      73500000
.Y1      ANOP                                                           74000000
&X       SETA  &K-5                               VALUE                 74500000
         AIF   (&X GT 0 AND &X LT 32768).EA       INVALID VALUE         75000000
.EB      MNOTE 4,'* * * INVALID VALUE -- &X'                            75500000
&X       SETA  60                                                       76000000
         AIF   (&F).D1                                                  76500000
         AGO   .P1                                                      77000000
.EA      AIF   (&A(23) AND &F).EC                 REDUNDANT             77500000
         AIF   (&A(23)).ED                                              78000000
&A(23)   SETB  1                                  INDICATE USED         78500000
         AIF   (&F).D1                                                  79000000
&D(23)   SETB  1                                  FIXED                 79500000
         AGO   .P1                                                      80000000
.SIZE    ANOP                                                  @AZ13738 80050000
&Z       SETA  &S                                              @AZ13738 80100000
         AIF   (&Z GT X'8000' AND &Z LT X'A00000').SIZE1       @AZ13738 80150000
         MNOTE 4,'* * * INVALID VALUE -- &Z'                   @AZ13738 80200000
&Z       SETA  X'200000'                                       @AZ13738 80250000
.SIZE1   AIF   (&F).D1                                         @AZ13738 80300000
         AGO   .P1                                             @AZ13738 80350000
.G1      ANOP                                                           80500000
IFOX0J00 CSECT                                                          81000000
         DC    AL1(&VERSION,&Y),H'&X'               , MSGLEVEL, LINECNT 81500000
         DC    B'&D(1)&D(2)&D(3)&D(4)&D(5)&D(6)&D(7)&D(8)&D(9)&D(10)&D(X82000000
               11)&D(12)&D(13)&D(14)&D(15)&D(16)&D(17)&D(18)&D(19)&D(20X82500000
               )&D(21)&D(22)&D(23)&D(24)&D(25)0000000' DEFAULT @OX09734 83000000
         DC    B'&C(1)&C(2)&C(3)&C(4)&C(5)&C(6)&C(7)&C(8)&C(9)&C(10)&C(X83500000
               11)&C(12)&C(13)&C(14)&C(15)&C(16)&C(17)&C(18)&C(19)&C(20X84000000
               )&C(21)&C(22)&C(23)&C(24)&C(25)0000000'   FIXED TO ON    84500000
         DC    B'&B(1)&B(2)&B(3)&B(4)&B(5)&B(6)&B(7)&B(8)&B(9)&B(10)&B(X85000000
               11)&B(12)&B(13)&B(14)&B(15)&B(16)&B(17)&B(18)&B(19)&B(20X85500000
               )&B(21)&B(22)&B(23)&B(24)&B(25)1111111'   FIXED TO OFF   86000000
         DC    F'&Z'                                           @AZ13738 86050000
         MEND                                                           86500000
./  ADD  SSI=21950343,NAME=JPATCH
         MACRO                                                          90050000
&N       JPATCH &MOD,&MODLEN,&AREA,&K1=21,&K2=20                        90100000
         GBLA  &PI                                                      90150000
         GBLC  &COMPNM,&ASMID                                           90200000
         LCLA  &A                                                       90400000
         LCLC  &NAME,&L1,&L3,&L4,&L5                                    90600000
.P2      PUSH  PRINT                                                    91050000
&NAME    SETC  '&COMPNM&MOD'                                            91060000
         PRINT GEN,DATA                                                 91100000
.*THE PATCH AREA IS INITIALIZED TO 5% OF THE ORIGINAL CSECT.  BY        91150000
.*EVOKING THE "PATCH" MACRO, SUBSEQUENT ADDITIONS TO THE MODULE WILL    91200000
.*"SHRINK" THE ORIGINAL 5%-PATCH AREA VIA THE DYNAMIC ASSIGNMENT OF A   91250000
.*NEW LESS-THAN-5%-PATCH AREA.  AT LEAST A 5%-PATCH AREA WILL BE        91300000
.*DYNAMICALLY MAINTAINED FOR DELETIONS TO THE MODULE.                   91350000
&NAME    CSECT                                                          91400000
         LTORG                                                          91450000
         PRINT GEN,NODATA                                               91500000
         AIF   (T'&AREA EQ 'O').NOAREA                                  91520000
&A       SETA  &AREA                                                    91550000
.NOAREA  AIF   (&PI NE 0).DS2                                           91600000
PATCHDC  DC    C'&NAME &SYSTIME &SYSDATE'                               91650000
ABSOLEN  EQU   X'&MODLEN'-&A+L'PATCHDC  CALCULATE ACTUAL MODULE LENGTH  91700000
PTCHLEN  EQU   &NAME+ABSOLEN*&K1/&K2-*        LENGTH OF PATCH AREA      91750000
PATCH    DC    ((PTCHLEN+1)/PTCHLEN*PTCHLEN)C' '    DYNAMIC PATCH AREA  91800000
         AGO   .EXIT                                                    91850000
.DS2     ANOP                                                           91900000
&L4      SETC  'PATCHDC&PI'                                             91950000
&L5      SETC  'L'''.'PATCHDC&PI'                                       92000000
&L4      DC    C'&NAME &SYSTIME &SYSDATE'                               92050000
&L1      SETC  'ABSOLEN&PI'                                             92100000
&L3      SETC  'PTCHLEN&PI'                                             92150000
&L1      EQU  X'&MODLEN'-&A+&L5         CALCULATE ACTUAL MODULE LENGTH  92200000
&L3      EQU   &NAME+&L1*&K1/&K2-*            LENGTH OF PATCH AREA      92250000
PATCH&PI DC    ((&L3+1)/&L3*&L3)C' '                DYNAMIC PATCH AREA  92300000
.EXIT    POP   PRINT                                                    92350000
&PI      SETA  &PI+1                    FOR UNIQUE LABELS               92400000
         MEND                                                           92450000
./  ADD  SSI=21950346,NAME=JPOINT
         MACRO                                                          05000000
&NAME    JPOINT &FILE=,&ADDR=,&NEXT=                                    10000000
         LCLC  &XXX                                                     15000000
         LCLA  &I                                                       15600000
.*       GENERATES A CALL TO THE WORKFILE I/O MODULE TO POSITION        15650000
.*       THE FILE TO A SPECIFIED POSITION                               15700000
         AIF   (K'&NEXT LT 4).IN1                                       16200000
&I       SETA  4                                                        16800000
         AGO   .IN2                                                     17400000
.IN1     ANOP                                                           18000000
&I       SETA  K'&NEXT                                                  18600000
.IN2     ANOP                                                           19200000
         AIF   (K'&FILE EQ 0 OR K'&ADDR EQ 0 AND                       X20000000
               '&NEXT' NE 'START').ERR1                                 25000000
         AIF   ('&NEXT' NE 'READ' AND '&NEXT' NE 'WRITE' AND           X30000000
               '&NEXT' NE 'GET' AND '&NEXT' NE 'PUT' AND               X35000000
               '&NEXT' NE 'START').ERR1                                 40000000
&XXX     SETC  '&NEXT'(1,&I)                                            45000000
&NAME    SET   JPT4&XXX,ON                                              50000000
         JINST LA,R10,&FILE,FILE                                        55000000
         AIF   ('&NEXT' EQ 'START').NXA                                 60000000
         JINST LA,R11,&ADDR                                             65000000
.NXA     L     R12,JMLC                 LOAD BASE                       70000000
         BAL   R9,JPOINT(,R12)          GO TO JPOINT                    75000000
         MEXIT                                                          80000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     85000000
         MEND                                                           90000000
./  ADD  SSI=21950348,NAME=JPOINTLB
         MACRO                                                          09000000
&NAME    JPOINTLB &ADDR=                                                18000000
.*       GENERATES A CALL TO THE INPUT I/O MODULE TO POSITION           18050000
.*       THE LIBRARY FILE TO GET THE RECORD AFTER THE ONE NOTED.        18100000
         AIF   (K'&ADDR EQ 0).ERR1                                      27000000
&NAME    JINST LA,R10,&ADDR                                             36000000
         L     R12,JINMLC               LOAD BASE                       45000000
         BAL   R9,JPOINTLB(,R12)        GO TO JPOINTLB                  54000000
         MEXIT                                                          63000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     72000000
         MEND                                                           81000000
./  ADD  SSI=21950351,NAME=JPRINT
         MACRO                                                          10000000
&NAME    JPRINT                                                         20000000
.*       GENERATES A CALL TO THE OUTPUT I/O MODULE TO PRINT A LINE      20050000
.*       ON SYSPRINT AND GET THE ADDRESS OF THE NEXT BUFFER BACK.       20100000
&NAME    L     R12,JOUTMLC              LOAD BASE                       30000000
         BAL   R9,JPRINT(,R12)          GO TO JPRINT                    40000000
         MEND                                                           50000000
./  ADD  SSI=21950354,NAME=JPUNCH
         MACRO                                                          09000000
&NAME    JPUNCH &SEQ=YES                                                18000000
.*       GENERATES A CALL TO THE OUTPUT I/O MODULE TO OUTPUT            18050000
.*       A 80-BYTE RECORD ON SYSPUNCH AND SYSGO AND GET THE ADDRESS     18100000
.*       OF THE NEXT BUFFER BACK.                                       18150000
         AIF   ('&SEQ' EQ 'YES').NXA                                    27000000
&NAME    SET   JNOSEQPH,ON                                              36000000
         L     R12,JOUTMLC              LOAD BASE                       45000000
         AGO   .NXB                                                     54000000
.NXA     ANOP                                                           63000000
&NAME    L     R12,JOUTMLC              LOAD BASE                       72000000
.NXB     BAL   R9,JPUNCH(,R12)          GO TO JPUNCH                    81000000
         MEND                                                           90000000
./  ADD  SSI=21950357,NAME=JPUTL
         MACRO                                                          09000000
&NAME    JPUTL &FILE=,&BUFREQ=                                          18000000
.*       GENERATES A CALL TO THE WORKFILE I/O MODULE TO GET THE ADDRESS 18050000
.*       OF THE NEXT RECORD IN THE BUFFER. WHEN END OF BUFFER           18100000
.*       IS REACHED THE WHOLE BUFFER IS PUT ON FILE.                    18150000
         AIF   (K'&FILE EQ 0 OR K'&BUFREQ EQ 0).ERR1                    27000000
&NAME    JINST LA,R10,&FILE,FILE                                        36000000
         JINST LA,R11,&BUFREQ                                           45000000
         L     R12,JMLC                 LOAD BASE                       54000000
         BAL   R9,JPUTL(,R12)           GO TO JPUTL                     63000000
         MEXIT                                                          72000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     81000000
         MEND                                                           90000000
./  ADD  SSI=21950359,NAME=JPUTM
         MACRO                                                          09000000
&NAME    JPUTM &FILE=,&ADDR=                                            18000000
.*       GENERATES A CALL TO THE WORKFILE I/O MODULE TO COPY A RECORD   18050000
.*       INTO THE OUTPUT BUFFER.                                        18100000
         AIF   (K'&FILE EQ 0 OR K'&ADDR EQ 0).ERR1                      27000000
&NAME    JINST LA,R10,&FILE,FILE                                        36000000
         JINST LA,R11,&ADDR                                             45000000
         L     R12,JMLC                 LOAD BASE                       54000000
         BAL   R9,JPUTM(,R12)           GO TO JPUTL                     63000000
         MEXIT                                                          72000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     81000000
         MEND                                                           90000000
./  ADD  SSI=21950362,NAME=JREAD
         MACRO                                                          09000000
&NAME    JREAD &FILE=,&PARM=                                            18000000
.*       GENERATES A CALL TO THE WORKFILE I/O MODULE TO READ            18050000
.*       A PHYSICAL RECORD. A JCHECK MACRO CALL MUST BE ISSUED          18100000
.*       BEFORE ANY ADDITIONAL OPERATIONS TO THE WORKFILE ARE DONE.     18150000
         AIF   (K'&FILE EQ 0 OR K'&PARM EQ 0).ERR1                      27000000
&NAME    JINST LA,R10,&FILE,FILE                                        36000000
         JINST LA,R11,&PARM                                             45000000
         L     R12,JMLC                 LOAD BASE                       54000000
         BAL   R9,JREAD(,R12)           GO TO JREAD                     63000000
         MEXIT                                                          72000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     81000000
         MEND                                                           90000000
./  ADD  SSI=21950365,NAME=JRELSE
         MACRO                                                          09000000
&NAME    JRELSE &FILE=                                                  18000000
.*       GENERATES A CALL TO THE WORKFILE I/O MODULE TO RELEASE         18050000
.*       AN INPUT BUFFER. THE NEXT JGETL MACRO INTRUCTION RETRIEVES     18100000
.*       THE FIRST RECORD IN THE NEXT INPUT BUFFER.                     18150000
         AIF   (K'&FILE EQ 0).ERR1                                      27000000
&NAME    JINST LA,R10,&FILE,FILE                                        36000000
         L     R12,JMLC                 LOAD BASE                       45000000
         BAL   R9,JRELSE(,R12)          GO TO JRELSE                    54000000
         MEXIT                                                          63000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     72000000
         MEND                                                           81000000
./  ADD  SSI=21950339,NAME=JRETURN
         MACRO                                                          08000000
&NAME    JRETURN                                                        16000000
.*       RESTORES THE REGISTERS OF THE CALLING PROGRAM FROM A PUSH      16050000
.*       DOWN SAVE AREA (R2 THRU R9) AND THEN RETUTNS TO THE CALLER     16100000
.*       VIA R9. REQUIRES A NAME FIELD.                                 16150000
         AIF   (K'&NAME EQ 0).ERR1                                      24000000
&NAME    LM    R8,R9,JCLVLPTR           GET CURRENT LVL & DECR          32000000
         BXLE  R8,R9,0                  DECREMENT LEVEL POINTER         40000000
         ST    R8,JCLVLPTR              SAVE NEW LEVEL POINTER          48000000
         LM    R2,R9,JSAVESZ(R8)        RESTORE REGISTERS R2 THRU R9    56000000
         BR    R9                       RETURN TO CALLING PROGRAM       64000000
         MEXIT                                                          72000000
.ERR1    MNOTE 8,'OMITTED NAME.'                                        80000000
         MEND                                                           88000000
./  ADD  SSI=21950342,NAME=JSAVE
         MACRO                                                          06000000
&NAME    JSAVE &BASE=YES                                                12000000
.*       SAVES THE REGISTERS OF THE CALLING PROGRAM INTO A PUSH DOWN    12050000
.*       SAVE AREA (R2 THRU R9). UNLESS OVERRIDDEN THE MACRO WILL LOAD  12100000
.*       THE BASE REGISTER R8, FROM R12 AND GIVE A USING STATEMENT.     12150000
         AIF   (K'&NAME EQ 0).ERR1                                      18000000
         AIF   ('&BASE' EQ 'NO').NXA                                    24000000
         USING &NAME,R8                 SET USING FOR SUBR BASE         30000000
.NXA     ANOP                                                           36000000
&NAME    L     R15,JCLVLPTR             POINT TO CURRENT LEVEL          42000000
         LA    R15,JSAVESZ(,R15)        INCREMENT LEVEL POINTER         48000000
         ST    R15,JCLVLPTR             STORE NEW LEVEL POINTER         54000000
         STM   R2,R9,0(R15)             SAVE R2 THRU R9                 60000000
         AIF   ('&BASE' EQ 'NO').NXB                                    66000000
         LR    R8,R12                   ESTABLISH SUBR BASE             72000000
.NXB     MEXIT                                                          78000000
.ERR1    MNOTE 8,'OMITTED NAME.'                                        84000000
         MEND                                                           90000000
./  ADD  SSI=21950345,NAME=JTEXT
JTEXT    DSECT  ,                       TEXT RECORD DSECT               00500000
JTRLI    DS    1H                       RECORD LENGTH INDICATOR         01000000
         SPACE                                                          01500000
*        FLAGA                OP CODE DEPENDENT FLAGS                   02000000
         SPACE                                                          02500000
JTFLGA   DSW   JPSOP,                   PSEUDO-OP FLAG                 X03000000
               JEXTB,                   EXTENDED OPCODE FLAG           X03500000
               JINPC,                   INITIALIZE PRIVATE CODE        X04000000
               JINHB,                   INHIBIT BIT                    X04500000
               JDEF,                    DEFINITION RECORD              X05000000
               JREF,                    SCAN FOR SYMBOL REFERENCES     X05500000
               JREQOP,                  OPERAND REQUIRED FOR INTERLUDE X06000000
               JDCSX                    ON FOR DC, DS, AND DXD ONLY     06500000
         ORG   JTFLGA                   OVERLAY                         07000000
JTFLGA1  DSW   ,,,,,                    DECLARED ABOVE                 X07500000
               JPRESD,                  ON FOR PRE-ESD PUNCH & REPRO   X08000000
               JLN4,                    INSTRUCTION LENGTH BIT 1       X08500000
               JLN2                     INSTRUCTION LENGTH BIT 2        09000000
         SPACE                                                          09500000
*        FLAGB                DYNAMIC FLAGS                             10000000
         SPACE                                                          10500000
JTFLGB   DSW   JPRONLY,                 PRINT ONLY                     X11000000
               JERR,                    DEAD STATEMENT                 X11500000
               JNOCNT,                  DO NOT ASSIGN STATEMENT NUMBER X12000000
               JGEN,                    STATEMENT IS GENERATED         X12500000
               JNMERR,                  INVALID NAME FIELD             X13000000
               JSUBNAME,                SUBSTITUTION REQUIRED-NAME     X13500000
               JSUBOPCD,                SUBSTITUTION REQUIRED-OP CODE  X14000000
               JSUBOPND                 SUBSTITUTION REQUIRED-OPERAND   14500000
JTIOP    DS    0H                                                       15000000
JTIOP1   DBV   ,                        INTERNAL OP CODES 1ST BYTE     X15500000
               JTICTL(0),                    ICTL                      X16000000
               JTISEQ(JTICTL+1),             ISEQ                      X16500000
               JTOPSYN(JTISEQ+1),            OPSYN                     X17000000
               JTCOPY(JTOPSYN+1),            COPY                      X17500000
               JTANOP(JTCOPY+1),             ANOP                      X18000000
               JTGBLA(JTANOP+1),             GBLA                      X18500000
               JTGBLB(JTGBLA+1),             GBLB                      X19000000
               JTGBLC(JTGBLB+1),             GBLC                      X19500000
               JTLCLA(JTGBLC+1),             LCLA                      X20000000
               JTLCLB(JTLCLA+1),             LCLB                      X20500000
               JTLCLC(JTLCLB+1),             LCLC                      X21000000
               JTMACRO(JTLCLC+1),            MACRO                     X21500000
               LOGENOP(JTMACRO),   LOWEST GENERATOR OP                 X22000000
               JTACTR(JTMACRO+1),            ACTR                      X22500000
               JTAGO(JTACTR+1),              AGO                       X23000000
               JTAGOB(JTAGO),                AGOB  SAME AS AGO         X23500000
               JTAIF(JTAGO+1),               AIF                       X24000000
               JTAIFB(JTAIF),                AIFB  SAME AS AIF         X24500000
               JTSETA(JTAIF+1),              SETA                      X25000000
               JTSETB(JTSETA+1),             SETB                      X25500000
               JTSETC(JTSETB+1),             SETC                      X26000000
               JTMEXIT(JTSETC+1),       MEXIT                          X26500000
               JTMEND(JTMEXIT+1),            MEND                      X27000000
               JTCALL(JTMEND+1),        MACRO CALL                     X27500000
               JTCPKEY(JTCALL+1),            CALL PARAMETER--KEYWORD   X28000000
               JTCPPOS(JTCPKEY+1),           CALL PARAMETER--POSITIONALX28500000
               JTPROTO(JTCPPOS+1),      PROTOTYPE                      X29000000
               JTPREP(JTPROTO),              MODIFIED REPRO RECORD     X29500000
               JTPPKEY(JTPROTO+1),           PROTOTYPE PARM--KEYWORD   X30000000
               JTPPCH(JTPPKEY),              MODIFIED PUNCH RECORD     X30500000
               JTPPPOS(JTPPKEY+1),           PROTOTYPE PARM--POSITIONALX31000000
               JTINPC(JTPPPOS),              UNINITIATED PRIVATE CODE  X31500000
               JTPEND(JTPPPOS+1),       END OF PARMS--PROTO OR MACRO   X32000000
               JTPMOP(JTPEND),               PETE'S MACHINE OP         X32500000
               JTEND(JTPEND+1),              END                       X33000000
               HIGENOP(JTEND),          HI GENERATOR OP                X33500000
               LOREFOP(JTEND),          LO SYMBOL REFERENCE OP         X34000000
               LODEFOP(JTEND),          LO SYMBOL DEFINITION OP        X34500000
               JTDXD(JTEND+1),               DXD                       X35000000
               JTEQU(JTDXD+1),               EQU                       X35500000
               JTORG(JTEQU+1),               ORG                       X36000000
               JTCNOP(JTORG+1),              CNOP                      X36500000
               JTCCW(JTCNOP+1),              CCW                       X37000000
               JTDC(JTCCW+1),                DC                        X37500000
               JTDS(JTDC+1),                 DS                        X38000000
               JTSTART(JTDS+1),              START                     X38500000
               HIREFOP(JTSTART),        HI SYMBOL REFERENCE OP         X39000000
               JTCSECT(JTSTART+1),           CSECT                     X39500000
               JTDSECT(JTCSECT+1),           DSECT                     X40000000
               JTCOM(JTDSECT+1),             COM                       X40500000
               JTENTRY(JTCOM+1),             ENTRY                     X41000000
               JTLTLC(JTENTRY),         CSECT FOR LITERAL POOL         X41500000
               JTEXTRN(JTENTRY+1),           EXTRN                     X42000000
               JTLTDC(JTEXTRN),         LITERAL DC                     X42500000
               JTWXTRN(JTEXTRN+1),           WXTRN                     X43000000
               JTLTND(JTWXTRN),         LITERAL POOL END               X43500000
               JTCXD(JTWXTRN+1),             CXD                       X44000000
               JTLTORG(JTCXD+1),             LTORG                     X44500000
               HIDEFOP(JTLTORG),        HI SYMBOL DEFINITION OP        X45000000
               JTLITR(JTLTORG+1),            LITERAL DEFINITIONS       X45500000
               JTSYMBL(JTLITR+1),            SYMBOL REFERENCE          X46000000
               JTPUNCH(JTSYMBL+1),           PUNCH                     X46500000
               JTEOFII(JTPUNCH),             ESD ADJUSTMENT RECORD     X47000000
               JTREPRO(JTPUNCH+1),           REPRO                     X47500000
               JTLITII(JTREPRO),             LITERAL ADJUSTMENT RECORD X48000000
               JTPUSH(JTREPRO+1),            PUSH                      X48500000
               JTLTEND(JTPUSH),              END-OF-LITERAL-POOL       X49000000
               JTPOP(JTPUSH+1),              POP                       X49500000
               JTADJII(JTPOP),               PETE'S END-OF-FILE        X50000000
               JTPRINT(JTPOP+1),             PRINT                     X50500000
               JTPASS(JTPRINT),              NO PROCESS RECORD         X51000000
               JTUSING(JTPRINT+1),           USING                     X51500000
               JTSYMII(JTUSING),             SYMBOL TABLE ENTRY        X52000000
               JTDROP(JTUSING+1),            DROP                      X52500000
               JTCMNT(JTDROP+1),             COMMENT CARD              X53000000
               JTHCMNT(JTCMNT+1),       HIDDEN COMMENT                 X53500000
               JTERROR(JTHCMNT+1),      ERROR                          X54000000
               JTSPACE(JTERROR+1),           SPACE                     X54500000
               LONOPRN(JTSPACE),        LO NO-PRINT OP                 X55000000
               JTEJECT(JTSPACE+1),           EJECT                     X55500000
               JTTITLE(JTEJECT+1),           TITLE                     X56000000
               JTMNOTE(JTTITLE+1),           MNOTE                     X56500000
               JTSICTL(JTMNOTE+1),           INTERNAL ICTL ONLY        X56550000
               JTEEOF(X'FE'),                EARLY END OF TEXT FILE    X57000000
               JTEOF(X'FF')                  END OF TEXT FILE           57500000
JTIOP2   DBV   ,                        SECOND BYTE OF OP-CODE          58000000
JTNMP    DS    1H                       NAME FIELD POINTER              58500000
JTOCP    DS    1H                       OPCODE POINTER IN TEXT RECORD   59000000
JTOPP    DS    1H                       OPERAND POINTER IN TEXT RECORD  59500000
JTCPR    DS    1H                       COMMENTS POINTER IN TEXT        60000000
JTSPR    DS    1H                       STRING POINTER IN TEXT          60500000
JTSYMCNT DS    1C                       NUMBER OF SYMBOLS IN OPERAND    61000000
JTFLGC   DSW   JPRGMAC,                 PROGRAMMER MACRO               X61050000
               JPRGICTL                 STANDARD ICTL                   61100000
         SPACE                                                          61500000
JTHDREND EQU   *                        END OF TEXT HEADER              62000000
JTHDRLN  EQU   JTHDREND-JTEXT           TEXT HEADER LENGTH              62500000
         SPACE 3                                                        63000000
JTEXTA   DSECT  ,                       DSECT FOR VARIABLE TEXT PORTION 63500000
         SPACE                                                          64000000
*        NAME FIELD IN VARIABLE TEXT                                    64500000
         SPACE                                                          65000000
JTNMO    DSW   JTNMOCD,            NAME CARD POINTER--REAL PTR FOLLOWS X65500000
               ,                        NOT USED                       X66000000
               ,                        NOT USED                       X66500000
               ,                        NOT USED                       X67000000
               ,                        NOT USED                       X67500000
               ,                        NOT USED                       X68000000
               ,                        NOT USED                       X68500000
                                        NOT USED                        69000000
JTNML    DS    1C                       NAME LENGTH                     69500000
JTNAME   EQU   *                        NAME                            70000000
         SPACE                                                          70500000
         ORG   JTNMO                    RESET LOCATION COUNTER          71000000
*                                  OPCODE POINTER IN TEXT RECORD        71500000
         SPACE                                                          72000000
JTOCO    DSW   JTOCOCD,       OP-CODE CARD POINTER--REAL JTOCO FOLLOWS X72500000
               ,                        NOT USED                       X73000000
               ,                        NOT USED                       X73500000
               ,                        NOT USED                       X74000000
               ,                        NOT USED                       X74500000
               ,                        NOT USED                       X75000000
               ,                        NOT USED                       X75500000
                                        NOT USED                        76000000
         SPACE                                                          76500000
JTOCL    DS    1C                       OP CODE LENGTH                  77000000
JTOPCD   EQU   *                        OP CODE                         77500000
         ORG   JTOCO                    RE-ORG AFTER VARIABLE TEXT      78000000
JTOPO    DSW   JTOPOCD,       OPND CARD POINTER--REAL JTOPO FOLLOWS    X78500000
               ,                        NOT USED                       X79000000
               ,                        NOT USED                       X79500000
               ,                        NOT USED                       X80000000
               ,                        NOT USED                       X80500000
               ,                        NOT USED                       X81000000
               ,                        NOT USED                       X81500000
                                        NOT USED                        82000000
JTOPL    DS    1C                       OPERAND LENGTH                  82500000
JTOPND   EQU   *                        OPERAND                         83000000
         ORG   JTOCO                    RE-ORG AFTER VARIABLE TEXT      83500000
JTCOP    DS    1C                       COMMENT OUTPUT POINTER          84000000
JTCML    DS    1C                       COMMENT LENGTH                  84500000
JTCMM    EQU   *                        COMMENT                         85000000
         ORG   JTOCO                    RE-ORG AFTER VARIABLE TEXT      85500000
JTSTC    DS    1C                       STRING COUNT                    86000000
JTSTO    DS    1C                       STRING 1 OUTPUT COLUMN POINTER  86500000
JTSTL    DS    1C                       STRING 1 LENGTH                 87000000
JTSTR    EQU   *                        STRING 1                        87500000
         ORG   JTOCO                    RE-ORG AFTER VARIABLE TEXT      88000000
JTSTO2   DS    1C                       STRING 2 OUTPUT COLUMN POINTER  88500000
JTSTL2   DS    1C                       STRING 2 LENGTH                 89000000
JTSTR2   EQU   *                        STRING 2                        89500000
./  ADD  SSI=21950349,NAME=JTMTXT
JTMTXT   DSECT                                                          01000000
         SPACE                                                          02000000
*        CONDITIONAL ASSEMBLY OPERATORS                                 03000000
         SPACE                                                          04000000
JTMOP    DBV   JTMSCM(0),               START CHARACTER MODE           X05000000
               JTMECM(JTMSCM+1),        END CHARACTER MODE             X06000000
               JTMCOM(JTMECM+1),        COMMA                          X07000000
               JTMPER(JTMCOM+1),        PERIOD                         X08000000
               JTMLPAR(JTMPER+1),       LEFT PAREN                     X09000000
               JTMRPAR(JTMLPAR+1),      RIGHT PAREN                    X10000000
               JTMPLUS(JTMRPAR+1),      PREFIX PLUS                    X11000000
               JTMMIN(JTMPLUS+1),       PREFIX MINUS                   X12000000
               JTMMULT(JTMMIN+1),       MULTIPLY                       X13000000
               JTMDIV(JTMMULT+1),       DIVIDE                         X14000000
               JTMADD(JTMDIV+1),        ADD                            X15000000
               JTMSUB(JTMADD+1),        SUBTRACT                       X16000000
               JTMGT(JTMSUB+1),         GREATER THAN                   X17000000
               JTMGE(JTMGT+1),          GREATER OR EQUAL               X18000000
               JTMEQ(JTMGE+1),          EQUAL                          X19000000
               JTMLE(JTMEQ+1),          LESS OR EQUAL                  X20000000
               JTMLT(JTMLE+1),          LESS THAN                      X21000000
               JTMNE(JTMLT+1),          NOT EQUAL                      X22000000
               JTMNOT(JTMNE+1),         LOGICAL NOT                    X23000000
               JTMAND(JTMNOT+1),        LOGICAL AND                    X24000000
               JTMOR(JTMAND+1),         LOGICAL OR                     X25000000
               JTMSTR(JTMOR+1),         STRING OPERATOR                X26000000
               JTMDUP(JTMSTR+1),        DUPLICATION OPERATOR           X27000000
               JTMDIM(JTMDUP+1),        DIMENSION OPERATOR             X28000000
               JTMDIM2(JTMDIM+1),       SYSLIST(N,M) FIRST DIMENSION   X29000000
               JTMDIM3(JTMDIM2+1),      SYSLIST (N,M) SECOND DIMEN     X30000000
               JTMSTRM(JTMDIM3+1),      STATEMENT TERMINATOR           X31000000
               JTMTAT(JTMSTRM+1),       TYPE ATTRIBUTE                 X32000000
               JTMLAT(JTMTAT+1),        LENGTH ATTRIBUTE               X33000000
               JTMSAT(JTMLAT+1),        SCALE ATTRIBUTE                X34000000
               JTMIAT(JTMSAT+1),        INTEGER ATTRIBUTE              X35000000
               JTMKAT(JTMIAT+1),        COUNT ATTRIBUTE                X36000000
               JTMNAT(JTMKAT+1),        NUMBER ATTRIBUTE               X37000000
               JTMHIOP(JTMNAT)          HIGHEST OPERATOR.               38000000
         SPACE                                                          39000000
*        CONDITIONAL ASSEMBLY TERM FLAGS                                40000000
         SPACE                                                          41000000
         ORG   JTMOP                    ORIGIN ZERO                     42000000
JTMFLG   DBV   JTMSVA(((JTMHIOP+2)/2)*2),    SETA                      X43000000
               JTMSVB(JTMSVA+2),        SETB                           X44000000
               JTMSVC(JTMSVB+2),        SETC                           X45000000
               JTMOSA(JTMSVC+2),        ORDINARY SYMBOL ATTRIBUTE      X46000000
               JTMSEQ(JTMOSA+2),        SEQUENCE SYMBOL                X47000000
               JTMSDT(JTMSEQ+2),        SELF DEFINING TERM             X48000000
               JTMCS(JTMSDT+2),         CHARACTER STRING               X49000000
               JTMLSTO(JTMCS+2),        SYSLIST                        X50000000
               JTMKPAR(JTMLSTO+2),      KEYWORD PARAMETER              X51000000
               JTMPPAR(JTMKPAR+2)       POSITIONAL PARAMETER            52000000
         SPACE                                                          53000000
         ORG   JTMFLG                   DEFINE GLOBAL INDICATOR         54000000
         DSW   JTMCSW,                  EVALUATE AS CHARACTER          X55000000
               ,,,,,,                   NOT USED AS SWITCHES           X56000000
               JTMGBL                   GLOBAL REFERENCE                57000000
         SPACE                                                          58000000
JTMPTR   DS    CL3                      POINTER FIELD                   59000000
JTMD     DS    CL2                      DIMENSION FIELD                 60000000
JTMNEXT  EQU   *                        MARKER                          61000000
         SPACE                                                          62000000
         ORG   JTMPTR                   ORIGIN ONE                      63000000
JTMLSTN  DS    CL3                      N FOR SYSLIST(N) OR (N,M)       64000000
JTMLSTM  DS    CL2                      M FOR SYSLIST(N,M)              65000000
         ORG   JTMPTR                   ORIGIN ONE                      66000000
JTMLNG   DS    C                        LENGTH OF STRING                67000000
JTMSTRNG EQU   *                        START OF CHARACTER STRING       68000000
         ORG   JTMPTR                   ORIGIN ONE                      69000000
JTMVALUE DS    CL4                      SDT VALUE                       70000000
./  ADD  SSI=21950352,NAME=JTPRINT
         MACRO                                                          10000000
&NAME    JTPRINT                                                        20000000
.*       GENERATES A CALL TO THE OUTPUT I/O MODULE TO OUTPUT A RECORD   20050000
.*       ON SYSTERM DATA SET.                                           20100000
&NAME    L    R12,JOUTMLC               GET OUTPUT PACKAGE ENTRY        30000000
         BAL   R9,TSPRINT(,R12)         GO TO TSO PRINT                 40000000
         MEND                                                           50000000
./  ADD  SSI=21950355,NAME=JTRUNC
         MACRO                                                          09000000
&NAME    JTRUNC &FILE=                                                  18000000
.*       GENERATES A CALL TO THE WORKFILE I/O PACKAGE TO TRUNCATE       18050000
.*       AN OUTPUT BUFFER. THIS CAUSES THE CURRENT OUTPUT BUFFER        18100000
.*       TO BE REGARDED AS FULL AND PUT TO FILE. THE NEXT LOGICAL       18150000
.*       RECORD WILL BE PUT IN THE NEXT PHYSICAL BUFFER.                18200000
         AIF   (K'&FILE EQ 0).ERR1                                      27000000
&NAME    JINST LA,R10,&FILE,FILE                                        36000000
         L     R12,JMLC                 LOAD BASE                       45000000
         BAL   R9,JTRUNC(,R12)          GO TO JTRUNC                    54000000
         MEXIT                                                          63000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     72000000
         MEND                                                           81000000
./  ADD  SSI=21950358,NAME=JWRITE
         MACRO                                                          09000000
&NAME    JWRITE &FILE=,&PARM=                                           18000000
.*       GENERATES A CALL TO THE WORKFILE I/O PACKAGE TO WRITE          18050000
.*       A PHYSICAL RECORD. THE OPERATIN MUST BE CHECKED FOR COMPLETION 18100000
.*       BEFORE ANY ADDITIONAL OPERATIONS TO THE FILE IS DONE (JCHECK). 18150000
         AIF   (K'&FILE EQ 0 OR K'&PARM EQ 0).ERR1                      27000000
&NAME    JINST LA,R10,&FILE,FILE                                        36000000
         JINST LA,R11,&PARM                                             45000000
         L     R12,JMLC                 LOAD BASE                       54000000
         BAL   R9,JWRITE(,R12)          GO TO JWRITE                    63000000
         MEXIT                                                          72000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     81000000
         MEND                                                           90000000
./  ADD  SSI=21950361,NAME=OP
         MACRO                                                          00050000
&MNEM    OP    &IOP,                    INT OPCODE - OMITTED FOR ASMOPS*00100000
               &INPC=YES,               INITIATE PRIVATE CODE          *00150000
               &INHB=NO,                START,DSECT,CSECT,COM HAVE'YES'*00200000
               &DEF=YES,                STMT MAY AFFECT STOR ASS OR ESD*00250000
               &REF=YES,                OPND MAY CONTAIN SYMBOL REF    *00300000
               &REQOP=NO                OPERAND SCAN REQUIRED           00350000
.*                                                                      00400000
         GBLA  &SHIFT(8)                USED IN FOLDING MNEMONIC        00450000
         GBLA  &CHAIN(71)               STATISTICS FOR EACH CHAIN       00500000
         GBLC  &SEARCH(71)              CHAINS - FOR DOCUMENTATION ONLY 00550000
         GBLC  &TABLE(71)               NAME OF PREVIOUS ENTRY IN CHAIN 00600000
         GBLC  &CHARVAL                 VALID CHARACTERS FOR MNEMONICS  00650000
.*                                                                      00700000
         LCLA  &HASHVAL                 HASH VALUE                      00750000
         LCLA  &COUNT,&INDEX            SCRATCHPADS                     00800000
         LCLA  &TYP                     TYPE OF OP                      00850000
         LCLB  &FLAGA(8)                FLAGA                           00900000
         LCLC  &STRING                  SCRATCHPAD                      00950000
         LCLC  &COMMENT                 USED FOR GENERATING VAR CMTS    01000000
         LCLC  &MI                      MNEMONIC IN INTERNAL CODE       01050000
.*                                                                      01100000
.* CHECK PARAMETERS                                                     01150000
.*                                                                      01200000
         AIF   ('&IOP' EQ '').IOPOK     GO IF IOP OMITTED               01250000
         AIF   (T'&IOP EQ 'N' AND '&IOP'(1,1) EQ 'X' AND K'&IOP LT     *01300000
               8 ).IOPOK                GO IF MACHINE OP                01350000
         MNOTE '***  ERROR  *** - &IOP'                                 01400000
         MEXIT                                                          01450000
.IOPOK   AIF   ('&INPC' EQ 'YES' OR '&INPC' EQ 'NO').INPCOK             01500000
         MNOTE '***  ERROR  *** - INPC=&INPC'                           01550000
         MEXIT                                                          01600000
.INPCOK  AIF   ('&INHB' EQ 'YES' OR '&INHB' EQ 'NO').INHBOK             01650000
         MNOTE '***  ERROR  *** - INHB=&INHB'                           01700000
         MEXIT                                                          01750000
.INHBOK  AIF   ('&DEF' EQ 'YES' OR '&DEF' EQ 'NO').DEFOK                01800000
         MNOTE '***  ERROR  *** - DEF=&DEF'                             01850000
         MEXIT                                                          01900000
.DEFOK   AIF   ('&REF' EQ 'YES' OR '&REF' EQ 'NO').REFOK                01950000
         MNOTE '***  ERROR  *** - REF=&REF'                             02000000
         MEXIT                                                          02050000
.REFOK   AIF   ('&REQOP' EQ 'YES' OR '&REQOP' EQ 'NO').REQOPOK          02100000
         MNOTE '***  ERROR  *** - REQOP=&REQOP'                         02150000
         MEXIT                                                          02200000
.REQOPOK ANOP                                                           02250000
.*********************************************************************. 02300000
.*                                                                   *. 02350000
.* CALCULATE HASH NUMBER,GENERATE CHAIN POINTER AND UPDATE HASH TABLE*. 02400000
.*                                                                   *. 02450000
.*********************************************************************. 02500000
.*                                                                      02550000
.*   CALCULATE HASH NUMBER (AND BUILD MNEM IN INT CODE CONCURRENTLY)    02600000
.*                                                                      02650000
.HOUT    ANOP                           OUTER LOOP FOR HASHING          02700000
&COUNT   SETA  &COUNT+1                 POINT TO NEXT CHAR IN MNEMONIC  02750000
&MI      SETC  '&MI,J'.'&MNEM'(&COUNT,1) APPEND ',J' AND NEXT CHAR      02800000
&INDEX   SETA  1                        POINT TO FIRST CHAR IN CHARVAL  02850000
.HIN     AIF   ('&MNEM'(&COUNT,1) EQ '&CHARVAL'(&INDEX,1)).HFOUND       02900000
&INDEX   SETA  &INDEX+1                 NO MATCH - TRY NEXT CHAR        02950000
         AIF   (&INDEX LE K'&CHARVAL).HIN  ... IF THERE IS ONE          03000000
&STRING  SETC  '&MNEM'(&COUNT,1)        EXTRACT CHARACTER IN ERROR      03050000
         MNOTE '***  ERROR  *** - INVALID CHARACTER &STRING IN &MNEM'   03100000
         MEXIT                                                          03150000
.HFOUND  ANOP                                                           03200000
&HASHVAL SETA  &HASHVAL+(&INDEX+9)*&SHIFT(&COUNT) ADD WEIGHTED VALUE    03250000
         AIF   (&COUNT LT K'&MNEM).HOUT GO IF SCAN OF MNEM NOT COMPLETE 03300000
&HASHVAL SETA  &HASHVAL-&HASHVAL/71*71+1     HERE IS THE HASH NUMBER    03350000
&CHAIN(&HASHVAL) SETA &CHAIN(&HASHVAL)+1 COLLECT STATISTICS             03400000
.*                                                                      03450000
.*   GENERATE CHAIN POINTER                                             03500000
.*                                                                      03550000
&STRING  SETC  '&TABLE(&HASHVAL)-JOPTABLE'                              03600000
&COMMENT SETC  (20-K'&STRING)' '.'PTR TO PREV ENTRY IN CHAIN &HASHVAL'  03650000
&MNEM    DC    AL2(&STRING)&COMMENT                                     03700000
.*                                                                      03750000
.*   UPDATE HASH TABLE                                                  03800000
.*                                                                      03850000
&TABLE(&HASHVAL) SETC '&MNEM'           REMEMBER THIS ENTRY             03900000
&SEARCH(&HASHVAL) SETC '->&MNEM'.'&SEARCH(&HASHVAL)'   BUILD CHAIN      03950000
.*********************************************************************. 04000000
.*                                                                   *. 04050000
.* FIND TYPE OF OP BY LOOKING AT IOP,WHICH MUST BE SPECIFIED AS      *. 04100000
.* X'HH' OR X'HHHH' FOR MACHINE OPS, X'HHM' FOR EXTENDED MNEMONICS,  *. 04150000
.* AND OMITTED FOR ASSEMBLER OPS.THE TYPE IS SET TO                  *. 04200000
.*       0 - MACHINE OP, 1-BYTE OPCODE                               *. 04250000
.*       1 - EXTENDED MNEMONIC                                       *. 04300000
.*       2 - MACHINE OP, 2-BYTE OPCODE                               *. 04350000
.*       3 - ASSEMBLER OP                                            *. 04400000
.*                                                                   *. 04450000
.*********************************************************************. 04500000
&TYP     SETA  K'&IOP/K'&IOP            0 IF OMITTED,1 IF NOT           04550000
&TYP     SETA  &TYP*(K'&IOP-5)+(1-&TYP)*3 SET TYPE AS IN BOX ABOVE      04600000
.*********************************************************************. 04650000
.*                                                                   *. 04700000
.* GENERATE 'FLAGS' BYTE                                             *. 04750000
.*                                                                   *. 04800000
.*********************************************************************. 04850000
&INDEX   SETA  &TYP*(3-&TYP)+1          SHOWS THAT INDEX IS REDUNDANT   04900000
&COUNT   SETA  K'&MNEM-1                LENGTH OF MNEM -1               04950000
&STRING  SETC  'XL.2''&INDEX'',XL.2''&TYP'',XL.1''0'',XL.3''&COUNT'''   05000000
         DC    &STRING                            FLAGS                 05050000
.*********************************************************************. 05100000
.*                                                                   *. 05150000
.* GENERATE MNEMONIC IN INTERNAL CODE                                *. 05200000
.*                                                                   *. 05250000
.*********************************************************************. 05300000
&STRING  SETC  '&MI'(2,K'&MI-1)         REMOVE FIRST COMMA              05350000
         DC    AL1(&STRING)                       MNEMONIC IN INT CODE  05400000
.*********************************************************************. 05450000
.*                                                                   *. 05500000
.* GENERATE FLAGA                                                    *. 05550000
.*                                                                   *. 05600000
.*********************************************************************. 05650000
&FLAGA(1) SETB (&TYP EQ 3)              1 FOR ASM OPS                   05700000
&FLAGA(3) SETB ('&INPC' EQ 'YES')       INITIATE PRIVATE CODE           05750000
&FLAGA(4) SETB ('&INHB' EQ 'YES')       INHIBIT PRIVATE CODE            05800000
&FLAGA(5) SETB ('&DEF' EQ 'YES')        STMT MAY AFFECT STOR ASS OR ESD 05850000
&FLAGA(6) SETB ('&REF' EQ 'YES')        OPND MAY CONTAIN SYMBOL REF     05900000
         AIF   (NOT &FLAGA(1)).MOP      GO IF NOT ASM OP                05950000
&FLAGA(2) SETB ('&MNEM' EQ 'EXTRN' OR '&MNEM' EQ 'WXTRN' OR            *06000000
               '&MNEM' EQ 'ENTRY')                                      06050000
&FLAGA(7) SETB ('&REQOP' EQ 'YES')      OPND SCAN REQUIRED              06100000
&FLAGA(8) SETB ('&MNEM' EQ 'DC' OR '&MNEM' EQ 'DS' OR '&MNEM' EQ 'DXD') 06150000
         AGO   .FLAGA                                                   06200000
.MOP     ANOP                                                           06250000
&FLAGA(2) SETB (&TYP NE 0)              1 FOR EXT MNEM OR 2-BYTE OPCODE 06300000
.*   CALCULATE INSTRUCTION LENGTH FROM FIRST TWO BITS OF OPCODE         06350000
&COUNT   SETA  &IOP/B'1000000'          SHIFT RIGHT 6 BITS              06400000
         AIF   (&TYP EQ 0).MOPL         GO IF 1-BYTE OPCODE             06450000
&COUNT   SETA  &COUNT/B'10000'          SHIFT ANOTHER 4 BITS            06500000
         AIF   (&TYP EQ 1).MOPL         GO IF EXT MNEMONIC              06550000
&COUNT   SETA  &COUNT/B'10000'          2-BYTE OPCODE - SHIFT 4 MORE    06600000
.MOPL    ANOP                                                           06650000
&FLAGA(7) SETB (&COUNT EQ 3)            INSTR LENGTH IS 6 BYTES         06700000
&FLAGA(8) SETB (&COUNT EQ 1 OR &COUNT EQ 2)  INSTR LENGTH IS 4 BYTES    06750000
.FLAGA   ANOP                                                           06800000
&STRING  SETC  '&FLAGA(1)&FLAGA(2)&FLAGA(3)&FLAGA(4)&FLAGA(5)&FLAGA(6)&*06850000
               FLAGA(7)&FLAGA(8)'       SET FLAGA                       06900000
         DC    B'&STRING'                         FLAGA                 06950000
.*********************************************************************. 07000000
.*                                                                   *. 07050000
.* GENERATE INTERNAL OPCODE (INCLUDING MASK FOR EXT MNEMONICS)       *. 07100000
.*                                                                   *. 07150000
.*********************************************************************. 07200000
         AIF   (&TYP NE 3).T012                                         07250000
&STRING  SETC  'AL1(JT&MNEM)'           ASM OP - SET INTERNAL OPCODE    07300000
         AGO   .IOP                                                     07350000
.T012    ANOP                           MACHINE OP                      07400000
&COUNT   SETA  4*(&TYP+2)               SET BIT LENGTH                  07450000
&STRING  SETC  'XL.&COUNT'.'&IOP'(2,K'&IOP-1)                           07500000
.IOP     ANOP                                                           07550000
         DC    &STRING                            INTERNAL OPCODE       07600000
         SPACE                                                          07650000
         MEND                                                           07700000
./  ADD  SSI=71710277,NAME=RSYMRCD
RRCDL    DS    H                        RECORD LENGTH                   54900000
         SPACE                                                          55800000
RFLGA    DSW   RPSOP,                        PSEUDO OP                 ,56700000
               ,                             NOT USED                  ,57600000
               ,                             NOT USED                  ,58500000
               ,                             NOT USED                  ,59400000
               ,                             NOT USED                  ,60300000
               ,                             NOT USED                  ,61200000
               ,                             NOT USED                  ,62100000
                                             NOT USED                   63000000
         SPACE                                                          63900000
RFLGB    DSW   ,,                                                      ,64800000
               ,                             NOT USED                  ,65700000
               ENTRYSW1,                     ENTRY ITEM PENDING        ,66600000
               ESDNRSW1,                                               ,67500000
               CSECTSW1,                                               ,68400000
               DSECTSW1,                                               ,69300000
               DSCOMSW1                                                 70200000
         SPACE                                                          71100000
RTYPE    DBV   ,                        RECORD TYPE.  (SEE 'JTEXT')     72000000
         SPACE                                                          72900000
RFLDI    DSW   ESDOFLO,                                                ,73800000
               DEFINED,                      SYMBOL DEFINED, NO ERROR  ,74700000
               PRIORDEF,                     PREVIOUSLY DEFINED SYMBOL ,75600000
               RFIELDN,                      NAME FIELD APPENDED       ,76500000
               RFIELDX,                      FIELD 'A' OR 'B' APPENDED ,77400000
               ,                             LENGTH OF NAME MINUS ONE   78300005
         SPACE                                                          79200000
RSWTS    DSW   ,DSW1,CSW1,,ESW1,                                OX00106,80100005
               EQUF1                         ERRONEOUS LENGTH  @OY08064 80150005
         ORG   RSWTS                                                    81000000
RESDI    DS    H                        ESDID ASSOCIATED WITH VALUE     81900000
RLCTR    DS    F                        VALUE                           82800000
RLNGA    DS    0X                                                       83700000
RFLDA    EQU   RLNGA+1                                                  84600000
RNAME    DS    CL8                      SYMBOL                          85500000
RLNGQ    DS    H                        SYMBOL LENGTH ATTRIBUTE         86400000
RLNGB    DS    0X                                                       87300000
RFLDB    EQU   RLNGB+1                                                  88200000
         ORG   ,                                                        89100000
RLAST    EQU   *                                                        90000000
         ORG   RRCDL                                                    90900000
RITEM    DS    XL(RLAST-RRCDL)                                          91800000
         ORG   RNAME                                                    92700000
RSYMC1   DS    0XL(L'RNAME+L'RLNGQ)     COMMON SEGMENT                  93600000
         ORG   RESDI                                                    94500000
RSYMC2   DS    0XL(L'RESDI+L'RLCTR)     COMMON SEGMENT                  95400000
RESDC    DS    0XL(L'RESDI+L'RLCTR)     COMMON SEGMENT                  96300000
./  ADD  SSI=21950366,NAME=RXLFMTS
PPIN     DSECT                                                          02000000
PPRLI    DS    CL2                      RECORD LENGTH                   04000000
PPFLG    DS    CL2                      FLAGS                           06000000
PPIOC    DS    CL2                      INTERNAL OP CODE                08000000
         SPACE                                                          10000000
         ORG   PPRLI                                                    12000000
RLDIN    EQU   *                        RLD INPUT RECORD FORMAT         14000000
RLDLEN   DS    CL2                      RLD RECORD LENGTH               16000000
RFLAG    DS    CL2                      FLAG                            18000000
ROPCDE   DS    CL2                      OPCODE BYTES                    20000000
POSID    DS    CL2                      POSITION ESD/ID                 22000000
RELID    DS    CL2                      RELOCATION ESD/ID               24000000
RLDVAL   DS    CL3                      RLD SYMBOL ADDRESS              26000000
RLDFLG   DS    C                        RLD FLAG                        28000000
         DS    0F                       FULL-WORD ALIGNMENT             30000000
RLDND    EQU   *-RLDIN                  LENGTH OF RECORD                32000000
RLDTYPE  EQU   JR                       RLD RECORD I.D.                 34000000
         SPACE                                                          36000000
         ORG   PPRLI                                                    38000000
XRFIN    EQU   *                        XREF INPUT RECORD FORMAT        40000000
XRECLN   DS    CL2                      XREF RECORD LENGTH              42000000
XFLAG    DS    CL2                      FLAG                            44000000
XOPCDE   DS    CL2                      OP CODE                         46000000
XRFSYM   DS    CL8                      XREF SYMBOL                     48000000
XRFFLG   DS    C                        XREF FLAG, BASE, DEF, DUP,UNDEF 50000000
XRFSTM   DS    CL2                      XREF STATEMENT NUMBER           52000000
XRFLN    EQU   *-XOPCDE                 SORT CONTROL FIELD LENGTH       54000000
XRFLEN   DS    CL2                      XREF LENGTH                     56000000
XRFVAL   DS    CL4                      XREF VALUE                      58000000
         DS    0F                       FULL-WORD ALIGNMENT             60000000
XRFND    EQU   *-XRFIN                  LENGTH OF XREF RECORD           62000000
XRFTYPE  EQU   JX                       XREF RECORD I.D.                64000000
         ORG   XRFSYM                   .                               66000000
LITLOCTR DS    CL4                      LITERAL LOCATION COUNTER        68000000
LITESDID DS    CL2                      LITERAL ESD ID                  70000000
LITPOLID DS    C                        LITERAL POOL ID                 72000000
         ORG   XRFVAL                   LITERAL ORIGIN                  74000000
LITDTL   DS    C                        LITERAL DATA LENGTH             76000000
LITDTA   EQU   *                        LITERAL DATA                    78000000
LXEND    EQU   *-XRFIN                                                  80000000
LITTYPE  EQU   JY                       LITERAL XREF TYPE               82000000
BASE     EQU   X'01'                    BASE MASK                       84000000
REF      EQU   X'02'                    REFERENCE MASK                  86000000
DUPL     EQU   X'03'                    DUPLICATE MASK                  88000000
./  ADD  SSI=21950347,NAME=SET
         MACRO                                                          01000000
&NAME    SET   &SW,&OP                                                  02000000
         GBLA  &INDEX                                                   03000000
         GBLC  &DEFNAME(255),&SWNAME(255)                               04000000
         LCLA  &I,&J,&K,&II                                             05000000
         LCLC  &DEF,&P(8)                                               06000000
.*       SET A SPECIFIED BIT ON OR OFF.                                 06050000
         AIF   (K'&SW EQ 0).ERR1                                        07000000
         AIF   (N'&SW LT 1 OR N'&SW GT 8).ERR1                          08000000
.LOOP1   ANOP                                                           09000000
&I       SETA  &I+1                                                     10000000
         AIF   (&I GT &INDEX).DBV1                                      11000000
         AIF   ('&SW(1)' NE '&SWNAME(&I)').LOOP1                        12000000
         AIF   (K'&OP EQ 0).ERR1                                        13000000
&DEF     SETC  '&DEFNAME(&I)'                                           14000000
&I       SETA  &I-7                                                     15000000
&J       SETA  &I+14                                                    16000000
         AIF   (&I GE 1).OKI                                            17000000
&I       SETA  1                                                        18000000
.OKI     AIF   (&J LE &INDEX).OKJ                                       19000000
&J       SETA  &INDEX                                                   20000000
.OKJ     ANOP                                                           21000000
&II      SETA  &I                                                       22000000
&K       SETA  1                                                        23000000
.LOOP2   ANOP                                                           24000000
&K       SETA  &K+1                                                     25000000
         AIF   (&K GT N'&SW).DONE1                                      26000000
.LOOP3   AIF   ('&SW(&K)' EQ '&SWNAME(&I)').MATCH1                      27000000
&I       SETA  &I+1                                                     28000000
         AIF   (&I LE &J).LOOP3                                         29000000
         AGO   .ERR2                                                    30000000
.MATCH1  AIF   ('&DEF' NE '&DEFNAME(&I)').ERR2                          31000000
&P(&K)   SETC  '+'                                                      32000000
&I       SETA  &II                                                      33000000
         AGO   .LOOP2                                                   34000000
.DONE1   AIF   ('&OP' NE 'ON').TRYOFF                                   35000000
&NAME    OI    &DEF,&SW(1)&P(2)&SW(2)&P(3)&SW(3)&P(4)&SW(4)&P(5)&SW(5)&X36000000
               P(6)&SW(6)&P(7)&SW(7)&P(8)&SW(8)                         37000000
         AGO   .EXIT                                                    38000000
.TRYOFF  AIF   ('&OP' NE 'OFF').TRYFLIP                                 39000000
&NAME    NI    &DEF,BITFF-(&SW(1)&P(2)&SW(2)&P(3)&SW(3)&P(4)&SW(4)&P(5)X40000000
               &SW(5)&P(6)&SW(6)&P(7)&SW(7)&P(8)&SW(8))                 41000000
         AGO   .EXIT                                                    42000000
.TRYFLIP AIF   ('&OP' NE 'FLIP').ERR1                                   43000000
&NAME    XI    &DEF,&SW(1)&P(2)&SW(2)&P(3)&SW(3)&P(4)&SW(4)&P(5)&SW(5)&X44000000
               P(6)&SW(6)&P(7)&SW(7)&P(8)&SW(8)                         45000000
         AGO   .EXIT                                                    46000000
.DBV1    AIF   (N'&SW NE 1).ERR1                                        47000000
         AIF   (K'&SW GT 7).ERR1                                        48000000
         AIF   (K'&OP EQ 0).DVB2                                        49000000
&NAME    MVI   V&SW,&OP                                                 50000000
         AGO   .EXIT                                                    51000000
.DVB2    ANOP                                                           52000000
&NAME    MVI   V&SW,&SW                                                 53000000
.EXIT    MEXIT                                                          54000000
.ERR1    MNOTE 8,'PARAMETER ERROR.'                                     55000000
         MEXIT                                                          56000000
.ERR2    MNOTE 8,'SWITCH NOT PREVIOUSLY DEFINED OR NOT IN SAME BYTE.'   57000000
         MEND                                                           58000000
./  ADD  SSI=21950353,NAME=TBLGEN
         MACRO                                                          00050000
         TBLGEN &OPTBL,&SQVAL,&TNAME,&TID,&LENG,&BREG                   00100000
         GBLA  &LN,&ENDC,&NDX                                           00150000
         GBLC  &TNM,&REP,&REPA,&BLK                                     00200000
.*       GENERATES TABLES IN X1A. ONE WITH OFFSET AND ONE WITH          00210000
.*       VALUES AT THE CORRESPONDING OFFSETS.  SEE MODULE X1A.          00220000
&TNM     SETC  '&TNAME'                 NAME TO BE GEN'ED FOR TABLE     00250000
&LN      SETA  K'&TNAME                                                 00300000
         AIF   (&LN LE 8).TGBGN                                         00350000
         MNOTE '&TNM EXCEEDS 8 CHARACTERS - IT HAS K'&TNAME CHARACTERS' 00400000
         MEXIT                                                          00450000
.TGBGN   ANOP                                                           00500000
&LN      SETA  &LENG                    LENGTH ATTR FOR EACH TBL ENTRY  00550000
&TNM     EQU   *                                                        00600000
&BLK     SETC  '  '                                                     00650000
&NDX     SETA  0                                                        00700000
&ENDC    SETA  N'&OPTBL                                                 00750000
         AIF   ('&TID' EQ 'SEQT').SEQTBL                                00800000
.* THE DEFAULT ID IS OP CODE TABLE ID                                   00850000
.OCTBL   ANOP                                                           00900000
&NDX     SETA  &NDX+1                                                   00950000
&REP     SETC  '&SYSLIST(1,&NDX)'                                       01000000
         AIF   (&NDX GE &ENDC).OUT1                                     01050000
         ORG   &TNM.+JT&REP.*&LN                                        01100000
         DC    AL&LN.(&REP.-&BREG.)                                     01150000
         AGO   .OCTBL                                                   01200000
.* STATEMENT SEQUENCING TABLE                                           01250000
.SEQTBL  ANOP                                                           01300000
&NDX     SETA  &NDX+1                                                   01350000
&REP     SETC  '&SYSLIST(1,&NDX)'                                       01400000
&REPA    SETC  '&SYSLIST(2,&NDX)'                                       01450000
         AIF   (&NDX GE &ENDC).OUT2                                     01500000
         ORG   &TNM.+JT&REP.*&LN                                        01550000
         DC    AL&LN.(&REPA.)                                           01600000
         AGO   .SEQTBL                                                  01650000
.OUT1    ANOP                                                           01700000
         DC    AL&LN.(&REP.-&BREG.)                                     01750000
         AGO   .EXIT                                                    01800000
.OUT2    ANOP                                                           01850000
DMMY     EQU   *                                                        01900000
         DC    AL&LN.(&REPA.)                                           01950000
.EXIT    ANOP                                                           02000000
         DS    0H                                                       02050000
         MEND                                                           02100000
./  ADD  SSI=71710278,NAME=XDCDS
         MACRO                                                          00100000
&ID      XDCDS &DUMMY,&TESTRAN=NO,&DIAG=NO,&LEVEL=1                     00200000
         GBLC  &COMPNM                  COMPONENT NAME                  00300000
         LCLC  &NM                      MODULE NAME                     00400000
         JHEAD 'SYMBOL RESOLUTION PHASE DC/DS EVALUATION',             ,00500000
               PHASEID=&ID,                                            ,00600000
               LEVEL=&LEVEL                                             00700000
&NM      SETC  '&COMPNM&ID'                                             00800000
*TITLE-  ASSEMBLER SYMBOL RESOLUTION PHASE DC/DS EVALUATION ROUTINE   * 00900000
*                                                                     * 01000000
*FUNCTION/OPERATION-                                                  * 01100000
*        EVALUATE OPERANDS OF ASSEMBLER OPERATION STATEMENTS DC, DS,  * 01150000
*   AND DXD, AND LITERALS IN MACHINE OPERATION STATEMENTS AND THE     * 01160000
*   LITERAL POOL.  WHEN EVALUATING A DC, DS, OR DXD STATEMENT, THE    * 01170000
*   LOCATION COUNTER IS INCREMENTED AND ALIGNED AS NECESSARY.  WHEN   * 01180000
*   EVALUATING A LITERAL IN THE MACHINE OPERATION STATEMENT, THE      * 01190000
*   OBJECT LENGTH IS RETURNED.  WHEN SCANNING A LITERAL IN THE        * 01192000
*   LITERAL POOL, A SYMBOL REFERENCE RECORD IS GENERATED FOR EACH     * 01194000
*   SYMBOL APPEARING IN THE LITERAL.                                  * 01196000
         AIF   ('&TESTRAN' NE 'YES').TEST16                             01198000
*        PUNCH 'SYM' ITEMS.                                           * 01198400
.TEST16  ANOP                                                           01198800
*                                                                     * 01200000
*ENTRY POINT-                                                         * 01300000
         ENTRY &NM.01                                                 * 01400000
*                                                                     * 01500000
*INPUT-                                                               * 01600000
*        REGISTER R5 IS THE POINTER TO THE FIRST CHARACTER TO BE      * 01650000
*   EVALUATED.                                                        * 01660000
*                                                                     * 01700000
*OUTPUT-                                                              * 01800000
*        REGISTER R14 IS THE POINTER TO THE CHARACTER WHICH LOGICALLY * 01850000
*   TERMINATED THE EVALUATION.                                        * 01860000
*        REGISTER R15 CONTAINS THE OBJECT LENGTH OF THE LITERAL IN    * 01870000
*   THE MACHINE OPERATION STATEMENT.                                  * 01880000
*        SYMBOL REFERENCE RECORDS ON 'JOUTFILE'.                      * 01890000
         AIF   ('&TESTRAN' NE 'YES').TEST17                             01892000
*        'SYM' ITEMS ON THE PUNCH FILES.                              * 01894000
.TEST17  ANOP                                                           01896000
*                                                                     * 01900000
*EXTERNAL ROUTINES-                                                   * 01950000
*        QCON-     ROUTINE IN X4E TO PROCESS SYMBOLS ENCOUNTERED IN   * 01960000
*                  Q-TYPE ADDRESS CONSTANTS.                          * 01970000
*        VCON-     ROUTINE IN X4E TO PROCESS SYMBOLS ENCOUNTERED IN   * 01980000
*                  V-TYPE ADDRESS CONSTANTS.                          * 01990000
*        EVAL-     ROUTINE IN X4V TO EVALUATE EXPRESSIONS.            * 01992000
*        REFER-    ROUTINE IN X4E TO OUTPUT SYMBOL REFERENCE RECORDS  * 01994000
*                  FOR LITERALS IN THE LITERAL POOL.                  * 01996000
*        ENTER-    ROUTINE IN X4S TO ENTER THE NAME OF A DC OR DS     * 01998000
*                  STATEMENT IN THE SYMBOL TABLE.                     * 01998400
*                                                                     * 01998800
*EXITS, NORMAL-                                                       * 02000000
*        RETURN TO THE CALLING ROUTINE.                               * 02050000
*                                                                     * 02100000
*EXITS, ERROR-                                                        * 02200000
*        RETURN TO THE CALLING ROUTINE.                               * 02250000
*                                                                     * 02300000
*TABLES/WORK AREAS-                                                   * 02400000
*        DCDSWORK- AN AREA DEFINED IN DSECT 'ICOMMON' AND USED AS     * 02450000
*                  WORK STORAGE EXCLUSIVELY BY THIS ROUTINE.          * 02460000
*                                                                     * 02500000
*ATTRIBUTES-                                                          * 02600000
*        REFRESHABLE.                                                 * 02700000
*                                                                     * 02800000
*NOTES-                                                               * 02900000
*                                                                     * 03600000
         EJECT                                                          03700000
         COPY  JCOMMON                                                  03800000
         EJECT                                                          03900000
         COPY  JTEXT                                                    04000000
         EJECT                                                          04100000
         COPY  ICOMMON                                                  04200000
         EJECT                                                          04300000
JTEXT    DSECT ,                                                        04400000
         ORG   JTEXT                    OVERLAY                         04500000
         COPY  RSYMRCD                                                  04600000
         EJECT                                                          04700000
* VS1 RELEASE 3.1 CHANGES                                               04750003
*A060500,060600                                                 OX04107 04760003
*A445500,445600                                                 OX04090 04770003
*A058500,058600                                                 OX05810 04780003
*D060500,060600                                                 OX05810 04790003
*A058100,058200                                                 OY06131 04792003
*D445500-445600                                                @OX07274 04794005
&NM.00   CSECT                                                          04800000
         JMODID                                                         04900000
&NM.01   CONTENTS                                                       05000000
         USING &NM.01,R8                                                05100000
         EJECT                                                          05200000
DCSCAN   BALR  R14,R7                   SAVE REGISTERS IN STACK         05300000
         LR    R8,R12                   BASE REGISTER                   05400000
         ST    R15,LEVELPTR             STACK LEVEL POINTER             05500000
         XC    DCDSWORK,DCDSWORK        INITIALIZATION                  05600000
         SET   SDZDUPF,OFF              CLEAR ZERO DUPF SW              05650000
         LA    R2,D1                    BUMPER                          05700000
         STH   R2,LATTRSAV              LENGTH ATTRIBUTE                05710000
         MVC   DCDSMODE,TYPECALL        ESD INHIBIT FLAG                05800000
         TM    TYPECALL,LTCALL          TEST FOR LITERAL        OY06131 05810003
         BO    NEWOPRN                  BR OVER OPERAND TST     OY06131 05820003
         TM    RFLDI,RFIELDX            ANY OPERAND             OX05810 05850003
         BZ    DCABORT                  INVALID - NOOPERAND     OX05810 05860003
NEWOPRN  SET   (NOESDS,LMOD,BMOD,SMOD),OFF   INITIAL SETTING            05900000
         ST    R2,DUPFAC                DEFAULT DUPLICATION FACTOR      06000000
         CLI   CHAR1,J9                 TEST FOR DUPLICATION FACTOR     06100000
         BH    DUPF                     NOT DECIMAL SELF-DEFINING       06200000
         BAL   R3,EXPR                  EVALUATE VALUE                  06300000
         BAL   R3,SETUP                 GO SET UP DUPLICATION FACTOR    06400000
         LTR   R11,R11                       CHECK FOR SELFDEF ZERO     06450000
         BNZ   TYPE                          IF NOT BRANCH              06460000
         SET   SDZDUPF,ON                    IND DUPF SELF DEF ZERO     06470000
         B     TYPE                     READY TO ANALYZE TYPE           06500000
DUPF     CLI   CHAR1,JLPARN             SEE IF EXPRESSION               06600000
         BNE   TYPE                     OMITTED FIELD                   06700000
         ST    R5,ADUPFAC               SAVE ADDRESS OF EXPRESSION      06800000
         BAL   R3,EXPR1                 EVALUATE EXPRESSION             06900000
TYPE     CLI   CHAR1,JZ                 TEST FOR VALID TYPE             07000000
         BH    DCABORT                  INVALID TYPE                    07100000
         TRT   CHAR1,DCTABLE            EXAMINE CLOSELY                 07200000
         BZ    DCABORT                  ILLEGAL TYPE                    07300000
         LA    R2,DCTYPES(R2)           POINT TO SWITCH CODE            07400000
         MVC   DCSWORK,D0(R2)           MOVE SWITCH CODE TO WORK AREA   07500000
         AIF   ('&TESTRAN' NE 'YES').TEST07                             07600000
         MVC   DATATYPE,CHAR1           SAVE TYPE                       07700000
.TEST07  LA    R2,D1                    INCREMENT                       07800000
         AR    R5,R2                    ADVANCE COLUMN POINTER          07900000
         CLI   CHAR1,JL                 SEE IF LENGTH MODIFIER          08000000
         BNE   NOLN                     NO LENGTH MODIFIER              08100000
         SET   DXDALIGN,OFF             SET DXD ALIGNMENT FACTOR        08200000
         SET   LMOD,ON                  INDICATE LENGTH MODIFIED        08300000
         AR    R5,R2                    BUMP COLUMN POINTER             08400000
         CLI   CHAR1,JPERIOD            SEE IF BIT LENGTH               08500000
         BNE   LNGM                     NO BIT LENGTH MODIFIER          08600000
         SET   BMOD,ON                  INDICATE BIT LENGTH MODIFIER    08700000
         AR    R5,R2                    BUMP COLUMN POINTER             08800000
         GOIF  BITLN,OFF=DCABORT        BIT LENGTH NOT ALLOWED          08900000
         L     R15,ELCTR                GET CURRENT LOCATION COUNTER    09000000
         B     LNGM1                    PUSH                            09100000
LNGM     GOIF  LTCALL,ON=LNGM3          SEE IF LITERAL                  09200000
         BAL   R1,ADDBIT                ADD RESIDUAL BITS               09300000
         ST    R15,ELCTR                UPDATE LOCATION COUNTER         09400000
LNGM1    BAL   R3,NOLN2                 GO MAKE SYMBOL TABLE ENTRY      09500000
LNGM3    CLI   CHAR1,J9                 SEE IF DECIMAL SELF DEFINING    09600000
         BH    LNGM4                    SKIP IF NOT                     09700000
         BAL   R3,EXPR                  EVALUATE                        09800000
         B     LNGM5                    CONTINUE                        09900000
LNGM4    CLI   CHAR1,JLPARN             MUST BEGIN WITH THIS            10000000
         BNE   DCABORT                  INTOLERABLE                     10100000
         BAL   R3,EXPR1                 EVALUATE                        10200000
LNGM5    BNE   DCABORT                  MUST BE ABSOLUTE                10300000
         GOIF  BMOD,ON=LNGM6            SKIP IF BIT LENGTH              10400000
         SLA   R11,D3                   CONVERT TO BITS                 10500000
         BO    DCABORT                  TOO MANY BITS                   10600000
LNGM6    CL    R11,=FS3'65535'          TEST FOR ABSOLUTE MAXIMUM       10700000
         BH    DCABORT                  TOO LONG                        10800000
         CLI   SCADDR,XBCON-SCAD        SEE IF B-, C-, OR X-TYPE        10900000
         BNE   LNGM7                    SKIP IF NOT                     11000000
         GOIF  DSCALL,ON=LNGM8          SKIP IF MAXIMUM LENGTH ALLOWED  11100000
LNGM7    CH    R11,MAXLN                TEST FOR MAXIMUM ALLOWED        11200000
         BH    DCABORT                  TOO LONG                        11300000
LNGM8    LR    R14,R2                   CLEAR                           11400000
         IC    R14,MINLN                GET MINIMUM LENGTH              11500000
         CR    R11,R14                  SEE IF ENOUGH                   11600000
         BL    DCABORT                  NOPE                            11700000
         BAL   R9,AGAIN1                SET UP LENGTH ATTRIBUTE         11800000
         SPACE                                                          11900000
EMOD     CLI   CHAR1,JS                 SEE IF SCALE MODIFIER           12000000
         BAL   R3,MODS                  SCAN EXPRESSION                 12100000
         AIF   ('&TESTRAN' NE 'YES').TEST14                             12200000
         BNE   EMOD1                    NO VALID SCALE MODIFIER         12300000
         LTR   R11,R11                  SEE IF SCALE ACTUALLY MODIFIED  12400000
         BZ    EMOD1                    NOPE                            12500000
         SET   SCALING,ON               INDICATE SCAL MODIFIER          12600000
         STH   R11,SCALE                SCALE MODIFIER                  12700000
.TEST14  ANOP                                                           12800000
EMOD1    CLI   CHAR1,JE                 SEE IF EXPONENT MODIFIER        12900000
         BAL   R3,MODS                  EVALUATE EXPRESSION             13000000
         CLC   CHAR1,LFDEL              SEE IF CONSTANTS SUBFIELD       13100000
         BNE   NOCON                    IS OMITTED                      13200000
         AR    R5,R2                    BUMP COLUMN POINTER             13300000
         AIF   ('&TESTRAN' NE 'YES').TEST13                             13400000
         ST    R5,XPARM                 SAVE COLUMN POINTER             13500000
.TEST13  SR    R4,R4                    CLEAR REGISTER                  13600000
         LR    R15,R4                   CLEAR                           13700000
         IC    R15,SCADDR               GET ADDRESS OF SCAN ROUTINE     13800000
         B     SCAD(R15)                GO SCAN CONSTANTS               13900000
         SPACE                                                          14000000
DMOD     C     R2,ADSYM                 SEE IF WE HAVE EVERYTHING       14010000
         BL    EMOD                     NO, JUST A LITTLE BIT LONGER    14020000
         BAL   R9,AGAIN2                EVALUATE THE DUPLICATION FACTOR 14030000
         B     EMOD                     GO ON                           14040000
         SPACE                                                          14050000
NOLN     LR    R11,R2                   CLEAR REGISTER                  14100000
         IC    R11,DCALIGN              GET IMPLIED ALIGNMENT           14200000
         LR    R10,R11                  SAVE                            14300000
         GOIF  TYPEL,OFF=NOLN1          SKIP IF NOT TYPE L              14400000
         AR    R11,R11                  LENGTH OF TYPE L                14500000
NOLN1    STH   R11,LATTR                LENGTH ATTRIBUTE                14600000
         SLL   R11,D3                   MULTIPLY BY EIGHT               14650000
         ST    R11,CONLNG               LENGTH OF ONE CONSTANT IN BITS  14670000
         LA    R3,DMOD                  EXIT TIME ROUTINE ADDRESS       14730000
         GOIF  LTCALL,ON=(R3)           SKIP IF LITERAL                 14800000
         BAL   R1,ADDBIT                ROUND FOR BIT                   14900000
         GOIF  SDZDUPF,ON=NOLN15        ALWAYS ALIGN IF DUPF SELF DEF 0 14910000
         GOIF  JALGN,OFF=NOLNX          DONT ALIGN IF OPTION IS OFF     14950000
NOLN15   LCR   R1,R10                   GET ALIDNMENT MASK              15000000
         BCTR  R10,0                    ROUND                           15100000
         AIF   ('&TESTRAN' NE 'YES').TEST15                             15110000
         LR    R0,R15                   SAVE                            15120000
.TEST15  AR    R15,R10                  ADD CURRENT LOCATION COUNTER    15200000
         NR    R15,R1                   ROUND                           15300000
         AIF   ('&TESTRAN' NE 'YES').TEST02                             15400000
         TM    ETYPE,ETYPEXD            SEE IF DXD                      15500000
         BO    NOLNX                    DXD, NO TESTRAN OUTPUT          15600000
         STM   R9,R1,TERMS              SAVE REGISTERS                  15700000
         SR    R15,R0                   SEE IF BYTES SKIPPED            15800000
         BE    NOLNY                    NO BYTES SKIPPED                15900000
         SET   TSPACE                   ITEM TYPE                       16000000
         MVC   ADDRESS,ELCTR+D1         ADDRESS OF BYTES SKIPPED        16100000
         STC   R15,NAME                 NUMBER OF BYTES SKIPPED         16200000
         LA    R10,D5                   LENGTH OF OUTPUT ITEM           16300000
         GOTO  SYMPUNCH                 GO TO OUTPUT ROUTINE            16400000
NOLNY    LM    R9,R1,TERMS              RESTORE REGISTERS               16500000
.TEST02  ANOP                                                           16600000
NOLNX    ST    R15,ELCTR                NEW ADDRESS                     16700000
         GOIF  DXDALIGN,OFF=NOLN2       SEE IF DXD ALIGNMENT SET        16800000
         SET   DXDALIGN,OFF             INDICATE SET                    16900000
         ST    R10,EHILC                SET DXD ALIGNMENT               17000000
         AIF   ('&TESTRAN' NE 'YES').TEST04                             17100000
NOLN2    SET   TDATA                    ORGANIZATION                    17200000
         MVC   ADDRESS,ELCTR+D1         ADDRESS                         17300000
         GOIF  DEFNAME,OFF=(R3)         RETURN IF NO NAME               17400000
         MVC   NAME,RNAME               NAME                            17500000
         TR    NAME,JTRTABLE            TRANSLATE NAME                  17600000
         IC    R1,RFLDI                 LENGTH OF SYMBOL                17700000
         N     R1,=F'7'                 LENGTH OF SYMBOL                17800000
         LA    R1,BIT0(,R1)             ORGANIZATION                    17900000
         STC   R1,ORGBYTE               ORGANIZATION                    18000000
         AGO   .TEST05                                                  18100000
.TEST04  ANOP                                                           18200000
NOLN2    GOIF  DEFNAME,OFF=(R3)         RETURN IF NO NAME               18300000
.TEST05  ANOP                                                           18400000
         SET   DEFNAME,OFF              INDICATE NO SYMBOL TABLE ENTRY  18500000
         ST    R15,RLCTR                VALUE                           18600000
         MVC   RLNGQ,LATTR              LENGTH ATTRIBUTE                18700000
         LR    R10,R4                   PARAMETER                       18800000
         GOTO  ENTER                    ENTER IN SYMBOL TABLE           18900000
         BNE   NOLN4                    ALREADY IN SYMBOL TABLE         19000000
         GOIF  LMOD,ON=NOLN3            SKIP IF LENGTH MODIFIER PRESENT 19100000
         CLI   SCADDR,XBCON-SCAD        SKIP B-, C-, P-, X-, AND Z-TYPE 19200000
         BHR   R3                       BRANCH IF HIGH                  19300000
NOLN3    ST    R14,ADSYM                SAVE SYMBOL TABLE ENTRY ADDRESS 19400000
         SET   LNGDEF,ON                INDICATE LENGTH NOT DEFINED     19500000
         BR    R3                       RETURN                          19600000
NOLN4    SET   PRIORDEF,ON              INDICATE PREVIOUSLY DEFINED     19700000
         BR    R3                       RETURN                          19800000
         SPACE                                                          19900000
NOCON    GOIF  DSCALL,OFF=DCABORT       CONSTANT SUBFIELD IS REQUIRED   20000000
         L     R4,CONLNG                INFERS ONE CONSTANT             20100000
         STH   R2,CONCT                 ONE CONSTANT ASSUMED            20150000
         LR    R11,R2                   ONE                             20160000
         BAL   R9,AGAIN3                CATCHUP                         20170000
         SPACE                                                          20200000
ENDOPRN  CLI   CHAR1,JBLANK             SEE IF VALID DELIMITER          20300000
         BE    ENDOPRN1                 SKIP IF YES                     20400000
         CLI   CHAR1,JCOMMA             SEE IF VALID DELIMITER          20500000
         BNE   DCABORT                  OH, OH                          20600000
ENDOPRN1 LR    R15,R4                   LENGTH OF CONSTANT OR CONSTANTS 20700000
         L     R1,DUPFAC                DUPLICATION FACTOR              20800000
         MR    R14,R1                   TIMES LENGTH OF CONSTANT        20900000
         LTR   R14,R14                  TEST FOR OVERFLOW               21000000
         BNZ   DCABORT                  OVERFLOWED                      21100000
         CL    R15,=FS3'16777215'       SEE IF TOO LONG                 21200000
         BH    DCABORT                  TOO LONG                        21300000
         AH    R15,BITADD               ADD RESIDUAL BITS               21400000
         D     R14,=F'8'                GET LENGTH IN BYTES             21500000
         GOIF  LTCALL,OFF=ENDOPRN2      SEE IF LITERAL                  21600000
ENDOPRN9 LTR   R14,R14                  RESIDUAL                        21700000
         LR    R14,R5                   RETURN COLUMN POINTER           21800000
         BE    EXIT                     FINIS IF NONE                   21900000
         AR    R15,R2                   ANY OVER COUNTS AS ONE          22000000
         B     EXIT                     FINIS                           22100000
ENDOPRN2 DS    0H                       PIVOT                           22200000
         AIF   ('&TESTRAN' NE 'YES').TEST00                             22300000
         TM    ETYPE,ETYPEXD            SEE IF DXD                      22400000
         BO    TESTRAN                  SKIP IF SO                      22500000
ENDOPRN8 STM   R9,R1,TERMS              SAVE REGISTERS                  22600000
         CLI   DCALIGN,D1               SEE IF B, C, P, X, OR Z-TYPE    22630000
         BH    ENDOPRN3                 BRANCH IF NOT                   22660000
         GOIF  LMOD,OFF=ENDOPRN5        SKIP IF EXPLICIT LENGTH         22700000
ENDOPRN3 MH    R1,CONCT                 TIMES NUMBER OF CONSTANTS       22800000
         L     R0,CONLNG                GET LENGTH                      22840000
         AH    R0,BITADD                PLUS ANY RESIDUAL               22880000
         LR    R4,R0                    FAKE IT                         22888000
ENDOPRN5 LR    R0,R4                    GET IT                          23600000
         SR    R0,R2                    MINUS ONE                       23700000
         SRL   R0,D3                    OVER EIGHT                      23800000
         STM   R0,R1,LENGTH             LENGTH AND MULTIPLICITY         23900000
         CR    R1,R2                    SEE IF ONE                      23940000
         BE    ENDOPRN4                 SKIP IF YES                     23980000
         SET   MULTIPLE,ON              TURN MULTIPLE ON                23988000
ENDOPRN4 LA    R10,NAME                 OUTPUT POINTER                  23996000
         LA    R11,NAME-D6              REFERENCE                       24100000
         GOIF  LABEL,ON=TESTRAN1        SKIP IF NO NAME                 24200000
         IC    R10,ORGBYTE              GET NAME LENGTH                 24300000
         N     R10,=F'7'                ISOLATE LENGTH CODE             24400000
         LA    R10,NAME+D1(R10)         POINT PAST NAME                 24500000
TESTRAN1 TR    DATATYPE,DATABLE         TRANSLATE DATA TYPE             24600000
         MVC   D0(D1,R10),DATATYPE      MOVE DATA TYPE                  24700000
         MVC   D1(D1,R10),LENGTH+D3     LENGTH                          24800000
         CLI   SCADDR,XBCON-SCAD        SEE IF X-, B-, OR C-TYPE        24900000
         BNE   TESTRAN2                 SKIP IF NOT                     25000000
         MVC   D1(D2,R10),LENGTH+D2     LENGTH                          25100000
         AR    R10,R2                   BUMP POINTER                    25200000
TESTRAN2 GOIF  MULTIPLE,OFF=TESTRAN3    SEE IF MULTIPLICITY PRESENT     25300000
         MVC   D2(D3,R10),MULTIP+D1     MULTIPLICITY                    25400000
         LA    R10,D3(,R10)             BUMP POINTER                    25500000
TESTRAN3 GOIF  SCALING,OFF=TESTRAN4     SEE IF SCALED                   25600000
         MVC   D2(D2,R10),SCALE         SCALE                           25700000
         LA    R10,D2(,R10)             BUMP POINTER                    25800000
TESTRAN4 SR    R10,R11                  GET LENGTH OF OUTPUT ITEM       25900000
         GOTO  SYMPUNCH                 GO TO OUTPUT ROUTINE            26000000
         LA    R9,TESTRAN7              ADDRESS OF NEXT ROUTINE         26100000
         GOIF  CLUSTER,OFF=(R9)         SEE IF SUB-CLUSTER              26200000
         BALR  R14,R7                   PUSH DOWN ONE LEVEL             26300000
         TS    SCADDR                   TOUGH SKIDDING                  26400000
         L     R5,XPARM                 PICK UP COLUMN POINTER          26500000
         MVC   NAME(D1),DATATYPE        DATA TYPE                       26600000
TESTRAN5 MVI   ORGBYTE,TDATA+CLUSTER    ORGANIZATION                    26700000
         BAL   R3,PZCON                 SCAN SUB-CLUSTER                26800000
         LR    R3,R11                   LENGTH                          26900000
         BCTR  R11,D0                   MINUS ONE                       27000000
         STC   R11,NAME+D1              LENGTH                          27100000
         LA    R10,D6                   LENGTH OF TESTRAN ITEM          27200000
         LCR   R0,R0                    SEE IF SCALE                    27300000
         BNP   TESTRAN6                 NO                              27400000
         LA    R10,D8                   LENGTH OF ITEM WITH SCALE       27500000
         STH   R0,NAME+D2               SCALE MODIFIER                  27600000
         SET   SCALING,ON               INDICATE SCALE                  27700000
TESTRAN6 GOTO  SYMPUNCH                 OUTPUT TESTRAN ITEM             27800000
         CLI   CHAR1,JQUOTE             SEE IF ALL DONE                 27900000
         BE    EXIT                     FINIS                           28000000
         AR    R5,R2                    BUMP COLUMN POINTER             28100000
         AL    R3,ORGBYTE               NEXT ADDRESS                    28200000
         ST    R3,ORGBYTE               NEXT ADDRESS                    28300000
         B     TESTRAN5                 GO AGAIN                        28400000
TESTRAN7 LM    R9,R1,TERMS              RESTORE REGISTERS               28500000
.TEST00  ANOP                                                           28600000
TESTRAN  STH   R14,BITADD               RESIDUAL TO NEXT BYTE           28700000
         LH    R0,OPCNT                 GET COUNT OF OPERANDS           28800000
         LTR   R0,R0                    SEE IF FIRST OPERAND            28900000
         BNE   ENDOPRN7                 NOPE                            29000000
         MVC   LATTRSAV,LATTR           LENGTH ATTRIBUTE                29100000
ENDOPRN7 AR    R0,R2                    COUNT OPERANDS                  29200000
         STH   R0,OPCNT                 AND SAVE                        29300000
         AL    R15,ELCTR                UPDATE LOCATION COUNTER         29400000
         ST    R15,ELCTR                SAVE                            29500000
         CLI   CHAR1,JBLANK             SEE IF END                      29600000
         BNE   ENDOPRN6                 SKIP IF NOT                     29700000
         BAL   R1,ADDBIT1               TACK ON ANY RESIDUAL            29800000
         ST    R15,ELCTR                SAVE                            29900000
         B     EXIT                     FINIS                           30000000
ENDOPRN6 AR    R5,R2                    BUMP COLUMN POINTER             30100000
         XC    DCWORK,DCWORK            REINITIALIZE WORK AREA          30200000
         B     NEWOPRN                  FULL SPEED AHEAD                30300000
         SPACE                                                          30400000
AGAIN    SLL   R11,D3                   MULTIPLY BY EIGHT               30500000
AGAIN1   ST    R11,CONLNG               LENGTH OF ONE CONSTANT          30600000
         LA    R11,D7(,R11)             ROUND                           30700000
         SRL   R11,D3                   LENGTH ATTRIBUTE IN BYTES       30800000
         CH    R2,LATTR                 SEE IF LENGTH ATTRIBUTE SET     30900000
         BNHR  R9                       RETURN IF ALREADY SET           31000000
         STH   R11,LATTR                SET LENGTH ATTRIBUTE            31100000
AGAIN3   L     R14,ADSYM                POINTS TO SYMBOL TABLE ENTRY    31200000
         LTR   R14,R14                  SEE IF LENGTH ATTRIBUTE DEFINED 31300000
         BZ    AGAIN2                   NO                              31400000
         STH   R11,SLNGQ                LENGTH ATTRIBUTE                31500000
         SET   LNGDEF,OFF               LENGTH ATTRIBUTE DEFINED        31600000
         SR    R14,R14                  ZERO REGISTER                   31700000
         ST    R14,ADSYM                INDICATE COMPLETE               31800000
AGAIN2   BALR  R14,R7                   PUSH DOWN A LEVEL               31900000
         L     R5,ADUPFAC               GET ADDRESS OF EXPRESSION       32000000
         LTR   R5,R5                    SEE IF AVAILABLE                32100000
         BZ    EXIT                     NONE                            32200000
         LR    R4,R11                   SAVE                            32300000
         SET   SUBLIST,ON               EVALUATE WHAT'S INSIDE PARENS   32350000
         BAL   R3,EXPR3                 EVALUATE EXPRESSION             32400000
         BAL   R3,SETUP                 APPRAISE VALUE                  32500000
         LR    R11,R4                   RESTORE                         32600000
         B     EXIT                     RETURN                          32700000
         SPACE                                                          32800000
EXPR     MVI   SELFDEFN,D0              SELF DEFINING TERM              32900000
EXPR1    SET   SUBLIST,ON               INDICATE MODE OF SCAN           33000000
EXPR2    SET   DCOP,ON                  INDICATE IN DC                  33100000
EXPR3    GOTO  EVAL                     GO EVALUATE                     33200000
         BO    DCABORT                  SYNTACTIC ERRORS                33300000
         LR    R5,R14                   UPDATE COLUMN POINTER           33400000
         BR    R3                       RETURN                          33500000
         SPACE                                                          33600000
SETUP    BNE   DCABORT                  INVALID DUPLICATION FACTOR      33700000
         ST    R11,DUPFAC               MODIFY DUPLICATION FACTOR       33800000
         LTR   R11,R11                  TEST CHARACTERISTIC             33900000
         BCR   D2,R3                    RETURN IF POSITIVE              34000000
         BM    DCABORT                  INTOLERABLE                     34100000
         SET   NOESDS,ON                INDICATE NO ESD                 34200000
         BR    R3                       RETURN                          34300000
         SPACE                                                          34400000
ADDBIT   L     R15,ELCTR                GET CURRENT LOCATION COUNTER    34500000
ADDBIT1  CLI   BITADD+D1,D0             SEE IF RESIDUAL LEFT OVER       34600000
         BCR   D8,R1                    LEAVE IF NONE                   34700000
         AR    R15,R2                   BUMP BY ONE                     34800000
         MVI   BITADD+D1,D0             ZERO COUNT                      34900000
         BR    R1                       RETURN                          35000000
         SPACE                                                          35100000
MODS     BCR   D7,R3                    RETURN IF OMITTED               35200000
         GOIF  ESMOD,OFF=DCABORT        ERROR IF NOT ALLOWED            35300000
         AR    R5,R2                    BUMP COLUMN POINTER             35400000
         CLI   CHAR1,JMINUS             SEE IF MINUS SIGN               35500000
         BE    MODS1                    BYPASS                          35600000
         CLI   CHAR1,JPLUS              SEE IF PLUS SIGN                35700000
         BNE   MODS2                    SKIP IF NOT                     35800000
MODS1    AR    R5,R2                    BUMP COLUMN POINTER             35900000
MODS2    CLI   CHAR1,J9                 SEE IF SELF-DEFINING VALUE      36000000
         BNH   EXPR                     EVALUATE                        36100000
         CLI   CHAR1,JLPARN             SEE IF LEFT PARENTHESIS         36200000
         BE    EXPR1                    EVALUATE                        36300000
         B     DCABORT                  ERROR                           36400000
         SPACE                                                          36500000
DCABORT  SR    R15,R15                  INDICATE ERROR                  36600000
         MVC   JCLVLPTR,LEVELPTR        RESTORE STACK LEVEL POINTER     36700000
         BZ    EXIT                     RETURN                          36800000
         EJECT                                                          36900000
PZEND    LCR   R11,R11                  SEE IF NULL CONSTANT            37000000
         BNP   DCABORT                  ERROR IF NULL CONSTANT          37100000
         GOIF  TYPEZ,ON=PZEND1          SKIP IF ZONED TYPE              37200000
         LA    R11,D2(,R11)             COMPUTE LENGTH FOR PACKED TYPE  37300000
         SRL   R11,D1                   COMPUTE LENGTH FOR PACKED TYPE  37400000
PZEND1   CH    R11,=H'16'               CHECK LENGTH OF CONSTANT        37500000
         BH    DCABORT                  ERROR IF MORE THAN 16 BYTES     37600000
         AIF   ('&TESTRAN' NE 'YES').TEST09                             37700000
         CLI   SCADDR,PZCON-SCAD        SEE IF CLUSTER SCAN             37800000
         BNER  R3                       SUB CLUSTER                     37900000
         GOIF  SMOD,ON=PZEND2           SEE IF SCALE SET                38000000
         SET   SMOD,ON                  INDICATE SCALE SET              38100000
         LCR   R0,R0                    TEST FOR SCALE                  38200000
         BNP   PZEND2                   NO SCALE                        38300000
         STH   R0,SCALE                 SAVE SCALE                      38400000
         SET   SCALING,ON               SCALE INDICATOR IN ORG BYTE     38500000
.TEST09  ANOP                                                           38600000
PZEND2   BAL   R3,SCANDEL               END OF ONE CONSTANT             38700000
         AIF   ('&TESTRAN' NE 'YES').TEST08                             38800000
         GOIF  LMOD,ON=PZCON            SEE IF EXPLICIT LENGTH          38900000
         SET   (MULTIPLE,CLUSTER),ON    INDICATE CLUSTER ITEM           39000000
         SET   SCALING,OFF              DEFER SCALE                     39050000
.TEST08  ANOP                                                           39100000
PZCON    MVI   PERIOD,D0                ALLOW ONE PERIOD                39200000
         AIF   ('&TESTRAN' NE 'YES').TEST10                             39300000
         SR    R1,R1                    ZERO                            39400000
         LR    R0,R2                    ONE                             39500000
.TEST10  LR    R11,R2                   INITIALIZE DIGIT COUNT          39600000
         CLI   CHAR1,JMINUS             CHECK FOR OPTIONAL MINUS SIGN   39700000
         BE    PZCON1                   STEP PAST IF PRESENT            39800000
         CLI   CHAR1,JPLUS              CHECK FOR OPTIONAL PLUS SIGN    39900000
         BNE   PZCON2                   SKIP IF NOT PRESENT             40000000
PZCON1   AR    R5,R2                    ADVANCE COLUMN POINTER          40100000
PZCON2   SR    R11,R2                   KEEP COUNT OF DIGITS            40200000
         AIF   ('&TESTRAN' NE 'YES').TEST11                             40300000
         SR    R0,R1                    COUNT SCALE                     40400000
.TEST11  CLI   CHAR1,J9                 SEE IF VALID DECIMAL DIGIT      40500000
         BNH   PZCON1                   LOOP IF YES                     40600000
         CLI   CHAR1,JPERIOD            CHECK FOR DECIMAL POINT         40700000
         BNE   PZEND                    END-OF-CONSTANT ENCOUNTERED     40800000
         AR    R11,R2                   PERIODS DO NOT COUNT            40900000
         TS    PERIOD                   SEE IF PERIOD ALLOWED           41000000
         AIF   ('&TESTRAN' NE 'YES').TEST12                             41100000
         LR    R1,R2                    BUMPER                          41200000
.TEST12  BZ    PZCON1                   ALLOW                           41300000
         B     DCABORT                  MORE THAN ONE SPELLS ERROR      41400000
         SPACE                                                          41500000
XBEND    SRA   R11,D3                   GET COUNT IN BYTES              41600000
         LCR   R11,R11                  GET ABSOLUTE COUNT              41700000
         BNP   DCABORT                  NULL CONSTANT                   41800000
         BAL   R3,SCANDEL               TEST FOR END-OF-OPERAND         41900000
XBCON    L     R3,OPNEND                POINT TO END OF OPERAND         42000000
         SR    R11,R11                  INITIALIZE ACCUMULATOR          42100000
XBCON1   CLC   CHAR1,HILIMIT            TEST FOR VALID DIGIT            42200000
         BH    XBEND                    MAY BE END OF CONSTANT          42300000
         CLI   CHAR1,JQUOTE             SEE IF A QUOTE                  42400000
         BNE   TSTAM                    SKIP IF NOT                     42500000
         CLI   CHAR2,JQUOTE             SEE IF PAIRED QUOTES            42600000
         BNE   XBEND                    END-OF-CONSTANT ENCOUNTERED     42700000
         B     TSTAM1                   PAIRED QUOTES                   42800000
         SPACE                                                          42900000
ADEND    BAL   R3,SCANDEL1              TEST FOR END-OF-OPERAND         43000000
ADCON    MVC   SUBFIELD,DCSWTCH         SUBFIELD ALLOWED/DISALLOWED     43100000
ADCON1   BAL   R3,EXPR2                 SCAN EXPRESSION                 43200000
         CLI   CHAR1,JLPARN             SUBFIELD ENCOUNTERED            43300000
         BNE   ADEND                    SKIP IF NO SUBFIELD             43400000
         TS    SUBFIELD                 SUBFIELD ALLOWED HERE           43500000
         BZ    EXPR1                    SCAN EXPRESSION                 43600000
         B     DCABORT                  ERROR IF SUBFIELD NOT ALLOWED   43700000
         EJECT                                                          43800000
QQEND    GOIF  (NOESD,NOESDS),ANY=QQEND1     SKIP IF ESD NOT OPTIONED   43900000
         GOTO  QCON                     GO CREATE ESD ENTRY             44000000
QQEND1   BAL   R3,SCANDEL1              END OF CONSTANT PROCESSING      44100000
QQCON    BAL   R3,SYMSCAN               SCAN SYMBOL                     44200000
         B     QQEND                    LOOP                            44300000
         SPACE                                                          44400000
VVEND    GOIF  (NOESD,NOESDS),ANY=VVEND1     SKIP IF NO ESD             44500000
         GOTO  VCON                     GO MAKE ESD ENTRY               44600000
VVEND1   BAL   R3,SCANDEL1              END OF CONSTANT PROCESSING      44700000
VVCON    BAL   R3,SYMSCAN               SCAN FOR SYMBOL                 44800000
         LH    R14,SYMCOUNT             COUNT OF SYMBOLS                44900000
         BCTR  R14,R0                   MINUS ONE                       45000000
         SRDL  R14,D3                   GET BYTE                        45100000
         SRL   R15,D29                  AND BIT                         45200000
         LA    R1,BIT0                  GET BIT MASK                    45300000
         SRL   R1,D0(R15)               SET UP BIT MASK                 45400000
         LA    R15,VEETABLE(R14)        POINT TO ARRAY                  45500000
         EX    R1,VVCON1                INDICATE V-CON                  45600000
         B     VVEND                    SKIP                            45700000
VVCON1   OI    D0(R15),D0               EXECUTED INSTRUCTION            45800000
         SPACE                                                          45900000
FDEND    BAL   R3,SCANDEL1              TEST FOR END-OF-OPERAND         46000000
FDCON    STH   R2,PERIOD                ALLOW PERIOD AND EXPONENT       46100000
FDCON1   LR    R11,R2                   INITIALIZE DIGIT COUNT          46200000
         CLI   CHAR1,JMINUS             SEE IF MINUS SIGN               46300000
         BE    FDCON2                   BUMP COLUMN POINTER IF YES      46400000
         CLI   CHAR1,JPLUS              SEE IF PLUS SIGN                46500000
         BNE   FDCON3                   SKIP IF NOT                     46600000
FDCON2   AR    R5,R2                    ADVANCE COLUMN POINTER          46700000
FDCON3   SR    R11,R2                   COUNT DECIMAL DIGITS            46800000
         CLI   CHAR1,JA                 SEE IF DECIMAL DIGIT            46900000
         BL    FDCON2                   LOOP FOR DECIMAL DIGITS         47000000
         CLI   CHAR1,JPERIOD            SEE IF PERIOD                   47100000
         BNE   FDCON4                   SKIP IF NOT                     47200000
         AR    R11,R2                   RESET COUNT                     47300000
         TS    PERIOD                   PERIOD ALLOWED                  47400000
         BZ    FDCON2                   GO IF PERIOD ALLOWED            47500000
         B     DCABORT                  ERROR IF PERIOD NOT ALLOWED     47600000
FDCON4   LTR   R11,R11                  SEE IF ANY VALID DECIMAL DIGITS 47700000
         BNM   DCABORT                  ERROR IF NO DIGITS              47800000
         CLI   CHAR1,JE                 SEE IF EXPONENT SPECIFIED       47900000
         BNE   FDEND                    SKIP IF NO EXPONENT SPECIFIED   48000000
         AR    R5,R2                    POINT PAST DELIMITER            48100000
         TS    PERIOD                   INDICATE PERIOD NOT ALLOWED     48200000
         TS    EXPONENT                 SEE IF EXPONENT ALLOWED         48300000
         BZ    FDCON1                   SCAN EXPONENT FIELD             48400000
         B     DCABORT                  ERROR IF MORE THAN ONE EXPONENT 48500000
         SPACE                                                          48600000
TSTAM    CLI   CHAR1,JAMPER             SEE IF AN AMPERSAND             48700000
         BNE   TSTAM2                   SKIP IF NOT                     48800000
         CLI   CHAR2,JAMPER             SEE IF PAIRED AMPERSANDS        48900000
         BNE   DCABORT                  ERROR IF AMPERSANDS NOT PAIRED  49000000
TSTAM1   AR    R5,R2                    ADVANCE COLUMN POINTER          49100000
TSTAM2   SH    R11,BITINCR              COUNT BITS IN ACCUMULATOR       49200000
         BXLE  R5,R2,XBCON1             REPEAT PROCEDURE                49300000
         B     DCABORT                  SYNTAX ERROR IF NO DELIMITER    49400000
         SPACE                                                          49500000
SCANDEL  GOIF  LMOD,ON=SCANDEL1         SKIP IF EXPLICIT LENGTH         49600000
         TM    DCALIGN,BIT7             SEE IF B-, C-, P-, X-, Z-TYPE   49700000
         BZ    SCANDEL0                 SKIP IF NOT                     49800000
         XI    DCALIGN,BIT7             ALLOW ONCE ONLY                 49900000
         MVI   LATTR+D1,D0              ALLOW                           50000000
SCANDEL0 BAL   R9,AGAIN                 SET LENGTH ATTRIBUTE            50100000
SCANDEL1 AL    R4,CONLNG                ACCUMULATE LENGTH OF CONSTANT   50200000
         LR    R14,R5                   SAVE COLUMN POINTER             50300000
         AR    R5,R2                    ADVANCE COLUMN POINTER          50400000
         AIF   ('&TESTRAN' NE 'YES').TEST06                             50500000
         LH    R0,CONCT                 COUNT NUMBER OF CONSTANTS       50600000
         AR    R0,R2                    COUNT                           50700000
         STH   R0,CONCT                 SAVE                            50800000
.TEST06  ANOP                                                           50900000
         CLC   CHAR1-CHAR1(,R14),RTDEL  SEE IF VALID DELIMITER          51000000
         BE    ENDOPRN                  END-OF-OPERAND ENCOUNTERED      51100000
         CLI   CHAR1-CHAR1(R14),JCOMMA  CHECK FOR MULTIPLE CONSTANTS    51200000
         BCR   D8,R3                    REPEAT FOR MULTIPLE CONSTANTS   51300000
         B     DCABORT                  INVALID DELIMITER               51400000
         SPACE                                                          51500000
SYMSCAN  CLI   CHAR1,JAT                SEE IF VALID CHARACTER          51600000
         BH    DCABORT                  INVALID CHARACTER               51700000
         CLI   CHAR1,JA                 SEE IF VALID CHARACTER          51800000
         BL    DCABORT                  INVALID CHARACTER               51900000
         LR    R14,R5                   SAVE SYMBOL POINTER             52000000
SYMSCAN1 AR    R5,R2                    LOOK AT NEXT CHARACTER          52100000
         CLI   CHAR1,JEQUAL             SEE IF DELIMITER                52200000
         BL    SYMSCAN1                 LOOP FOR DELIMITER              52300000
         CLI   CHAR1,JRPARN             TEST FOR VALID DELIMITER        52400000
         BE    SYMSCAN2                 VALID DELIMITER                 52500000
         CLI   CHAR1,JCOMMA             TEST FOR ALTERNATE DELIMITER    52600000
         BNE   DCABORT                  INVALID DELIMITER               52700000
SYMSCAN2 LR    R15,R5                   SAVE POINTER                    52800000
         SR    R15,R14                  GET LENGTH OF SYMBOL            52900000
         CH    R15,=H'8'                SEE IF NOT TOO LONG             53000000
         BH    DCABORT                  SYMBOL TOO LONG                 53100000
         SR    R15,R2                   GET MACHINE LENGTH              53200000
         MVC   XNAME,=8AL1(JBLANK)      PAD WITH BLANKS                 53300000
         EX    R15,MOVENAME             ISOLATE NAME                    53400000
         LH    R14,SYMCOUNT             GET SYMBOL COUNT                53500000
         AR    R14,R2                   INCREMENT BY ONE                53600000
         STH   R14,SYMCOUNT             PASS                            53700000
         GOIF  LTORGSCN,OFF=(R3)        RETURN IF THROUGH               53800000
         GOIF  MODE2,ON=(R3)            CHECK MODE                      53900000
         CLI   SCADDR,VVCON-SCAD        SEE IF V-TYPE ADDRESS CONSTANT  54000000
         BNE   SYMSCAN3                 NEAH                            54100000
         OI    XNAME,BIT0               PERMUTE NAME TO INTERNAL FORM   54200000
SYMSCAN3 GOTO  REFER                    PUT OUT RECORD                  54300000
         BR    R3                       RETURN                          54400000
         SPACE                                                          54500000
MOVENAME MVC   XNAME(0),CHAR1-CHAR1(R14)     EXECUTED INSTRUCTION       54600000
         SPACE                                                          54700000
DCTYPES  EQU   *-1                      SWITCH CODE FOR DATA TYPES    X 54800000
ACON     DC    AL1(B'10000000',JLPARN,JRPARN,ADCON-SCAD,4,1),HL2'32'  X 54900000
BCON     DC    AL1(B'10000000',JQUOTE,JQUOTE,XBCON-SCAD,1,1),HL2'2048,1'55000000
               ',AL1(J1)                                              X 55100000
CCON     DC    AL1(B'10000000',JQUOTE,JQUOTE,XBCON-SCAD,1,1),HL2'2048,8'55200000
               ',AL1(X'FF')                                           X 55300000
DCON     DC    AL1(B'11000000',JQUOTE,JQUOTE,FDCON-SCAD,8,1),HL2'64'  X 55400000
ECON     DC    AL1(B'11000000',JQUOTE,JQUOTE,FDCON-SCAD,4,1),HL2'64'  X 55500000
HCON     DC    AL1(B'11000000',JQUOTE,JQUOTE,FDCON-SCAD,2,1),HL2'64'  X 55600000
LCON     DC    AL1(B'11100000',JQUOTE,JQUOTE,FDCON-SCAD,8,1),HL2'128' X 55700000
PCON     DC    AL1(B'10000000',JQUOTE,JQUOTE,PZCON-SCAD,1,1),HL2'128' X 55800000
QCON     DC    AL1(B'00000000',JLPARN,JRPARN,QQCON-SCAD,4,8),HL2'32'  X 55900000
SCON     DC    AL1(B'00000000',JLPARN,JRPARN,ADCON-SCAD,2,16),HL2'16' X 56000000
VCON     DC    AL1(B'00010000',JLPARN,JRPARN,VVCON-SCAD,4,24),HL2'32' X 56100000
XCON     DC    AL1(B'10000000',JQUOTE,JQUOTE,XBCON-SCAD,1,1),HL2'2048,4'56200000
               ',AL1(JF)                                              X 56300000
YCON     DC    AL1(B'10000000',JLPARN,JRPARN,ADCON-SCAD,2,1),HL2'16'  X 56400000
ZCON     DC    AL1(B'10001000',JQUOTE,JQUOTE,PZCON-SCAD,1,1),HL2'128' X 56500000
         SPACE                                                          56600000
DCTABLE  EQU   *                        DATA TYPE TABLE                 56700000
         DC    10YL1(ILLEGAL-DCTYPES)   0-9 INVALID DC/DS TYPES         56800000
         DC    YL1(ACON-DCTYPES)        A-TYPE ADDRESS                  56900000
         DC    YL1(BCON-DCTYPES)        BINARY                          57000000
         DC    YL1(CCON-DCTYPES)        CHARACTER                       57100000
         DC    YL1(DCON-DCTYPES)        DOUBLE PRECISION FLOATING POINT 57200000
         DC    YL1(ECON-DCTYPES)        SINGLE PRECISION FLOATING POINT 57300000
         DC    YL1(FCON-DCTYPES)        FULLWORD FIXED POINT            57400000
         DC    YL1(GCON-DCTYPES)        G-ILLEGAL DC/DS TYPE            57500000
         DC    YL1(HCON-DCTYPES)        HALFWORD FIXED POINT            57600000
         DC    YL1(ICON-DCTYPES)        I-ILLEGAL DC/DS TYPE            57700000
         DC    YL1(JCON-DCTYPES)        J-ILLEGAL DC/DS TYPE            57800000
         DC    YL1(KCON-DCTYPES)        K-ILLEGAL DC/DS TYPE            57900000
         DC    YL1(LCON-DCTYPES)        EXTRA LONG PRECISION FLT POINT  58000000
         DC    YL1(MCON-DCTYPES)        M-ILLEGAL DC/DS TYPE            58100000
         DC    YL1(NCON-DCTYPES)        N-ILLEGAL DC/DS TYPE            58200000
         DC    YL1(OCON-DCTYPES)        O-ILLEGAL DC/DS TYPE            58300000
         DC    YL1(PCON-DCTYPES)        PACKED DECIMAL                  58400000
         DC    YL1(QCON-DCTYPES)        Q-TYPE ADDRESS                  58500000
         DC    YL1(RCON-DCTYPES)        R-ILLEGAL DC/DS TYPE            58600000
         DC    YL1(SCON-DCTYPES)        S-TYPE ADDRESS                  58700000
         DC    YL1(TCON-DCTYPES)        T-ILLEGAL DC/DS TYPE            58800000
         DC    YL1(UCON-DCTYPES)        U-ILLEGAL DC/DS TYPE            58900000
         DC    YL1(VCON-DCTYPES)        V-TYPE ADDRESS                  59000000
         DC    YL1(WCON-DCTYPES)        W-INVALID DC/DS TYPE            59100000
         DC    YL1(XCON-DCTYPES)        HEXADECIMAL                     59200000
         DC    YL1(YCON-DCTYPES)        Y-TYPE ADDRESS                  59300000
         DC    YL1(ZCON-DCTYPES)        ZONED DECIMAL                   59400000
         SPACE                                                          59500000
SCAD     EQU   PZCON                    PIVOT                           59600000
FCON     EQU   ECON                     SAME AS E-TYPE                  59700000
ILLEGAL  EQU   DCTYPES                  ILLEGAL DC/DS TYPE              59800000
GCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              59900000
ICON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60000000
JCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60100000
KCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60200000
MCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60300000
NCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60400000
OCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60500000
RCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60600000
TCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60700000
UCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60800000
WCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60900000
         SPACE                                                          61000000
XDSCAN   BALR  R14,R7                   SAVE REGISTERS IN STACK         61100000
         LR    R6,R10                   FAKE CURRENT CONTROL SECTION    61200000
         MVC   RESDI(D6),EESDI          PASS ESDID                      61300000
         MVI   TYPECALL,DSCALL+DXDALIGN+NOESD     PARAMETERS            61400000
         BALR  R9,R12                   SCAN OPERAND                    61500000
         B     EXIT                     RETURN                          61600000
         AIF   ('&TESTRAN' NE 'YES').MEND                               61700000
         SPACE                                                          61800000
SYMPUNCH BALR  R14,R7                   SAVE REGISTERS                  61900000
         LR    R8,R12                   SET UP BASE REGISTER            62000000
         LR    R2,R10                   LENGTH PARAMETER                62100000
         LA    R3,ORGBYTE               LOAD ADDRESS OF ORGBYTE INTO R3 62200000
         LM    R10,R12,SYMCARD          GET ADDRESS OF CARD BUFFER      62300000
         LTR   R12,R12                  SEE IF ROOM LEFT ON CARD        62400000
         BZ    GETCARD                  NO MORE ROOM                    62500000
         CR    R12,R2                   SEE IF ENOUGH ROOM              62600000
         BNL   SYMOVE                   ENOUGH, MOVE IT                 62700000
         SR    R2,R12                   DO WHAT WE CAN                  62800000
         BCTR  R12,D0                   MOVE LENGTH                     62900000
         EX    R12,SYMOVA               MOVE IT IN                      63000000
         LA    R3,D1(R3,R12)            POINT TO THE STUFF NOT MOVED    63100000
         MVI   D11(R11),D2*D28          LENGTH OF TESTRAN DATA          63200000
GETCARD  JPUNCH  SEQ=YES                GET A BUFFER                    63300000
         MVC   D0(D4,R11),=AL1(X'02',JS,JY,JM)    'SYM' CARD IDENTIFIER 63400000
         TR    D1(71,R11),JTRTABLE      TRANSLATE TO EXTERNAL FORMAT    63500000
         MVI   D10(R11),D0              INITIALIZE DATA LENGTH          63600000
         LA    R12,D28*D2               LENGTH OF TESTRAN DATA ALLOWED  63700000
         LR    R10,R11                  ADDRESS OF FIRST BYTE OF DATA   63800000
SYMOVE   SR    R12,R2                   USING UP THIS MUCH              63900000
         BCTR  R2,D0                    MACHINE LENGTH                  64000000
         EX    R2,SYMOVA                MOVE IT                         64100000
         LA    R10,D1(R10,R2)           POINT TO NEXT AVAILABLE COLUMN  64200000
         STM   R10,R12,SYMCARD          SAVE THE GARBAGE                64300000
         SLR   R10,R11                  GET DATA LENGTH                 64400000
         STC   R10,D11(,R11)            INDICATE DATA LENGTH ON CARD    64500000
         B     EXIT                     BUG OUT                         64600000
SYMOVA   MVC   D16(D0,R10),D0(R3)       EXECUTED INSTRUCTION            64700000
         SPACE                                                          64800000
DATABLE  EQU   *-D10                    TESTRAN DATA TYPE TABLE         64900000
         DC    AL1(DTYPEA)              A-TYPE                          65000000
         DC    AL1(DTYPEB)              B-TYPE                          65100000
         DC    AL1(DTYPEC)              C-TYPE                          65200000
         DC    AL1(DTYPED)              D-TYPE                          65300000
         DC    AL1(DTYPEE)              E-TYPE                          65400000
         DC    AL1(DTYPEF)              F-TYPE                          65500000
         DC    AL1(0)                   INVALID                         65600000
         DC    AL1(DTYPEH)              H-TYPE                          65700000
         DC    AL3(0)                   INVALID                         65800000
         DC    AL1(DTYPEL)              L-TYPE                          65900000
         DC    AL3(0)                   INVALID                         66000000
         DC    AL1(DTYPEP)              P-TYPE                          66100000
         DC    AL1(DTYPEQ)              Q-TYPE                          66200000
         DC    AL1(0)                   INVALID                         66300000
         DC    AL1(DTYPES)              S-TYPE                          66400000
         DC    AL2(0)                   INVALID                         66500000
         DC    AL1(DTYPEV)              V-TYPE                          66600000
         DC    AL1(0)                   INVALID                         66700000
         DC    AL1(DTYPEX)              X-TYPE                          66800000
         DC    AL1(DTYPEY)              Y-TYPE                          66900000
         DC    AL1(DTYPEZ)              Z-TYPE                          67000000
.MEND    MEND                                                           67100000
./  ADD  SSI=71710279,NAME=XDICT
         MACRO                                                          00100000
&ID      XDICT &DUMMY,&TESTRAN=NO,&DIAG=NO,&LEVEL=1                     00200000
         GBLC  &COMPNM                  COMPONENT NAME                  00300000
         LCLC  &NM                      MODULE NAME                     00400000
         JHEAD 'EXTERNAL SYMBOL DICTIONARY SUBROUTINES',               ,00500000
               PHASEID=&ID,LEVEL=&LEVEL                                 00600000
&NM      SETC  '&COMPNM&ID'                                             00700000
*                                                                     * 00800000
*TITLE-  EXTERNAL SYMBOL DICTIONARY ROUTINES                          * 00900000
*                                                                     * 01000000
*FUNCTION/OPERATION-                                                  * 01100000
*        BUILD AND MAINTAIN THE EXTERNAL SYMBOL DICTIONARY            * 01200000
*        PRINT AND PUNCH THE EXTERNAL SYMBOL DICTIONARY               * 01300000
*        BUILD THE EXTERNAL SYMBOL DICTIONARY ADJUSTMENT TABLE        * 01400000
*                                                                     * 01500000
*ENTRY POINT-                                                         * 01600000
         ENTRY &NM.01                                                   01700000
*                                                                     * 01800000
*INPUT-                                                               * 01900000
*        REGISTERS-                                                   * 02000000
*             R4-       REGISTER CONTAINING THE ADDRESS OF THE        * 02100000
*                       RECORD BEING PROCESSED                        * 02200000
*             R5-       REGISTER CONTAINING THE ADDRESS OF THE        * 02300000
*                       OPERAND BEING PROCESSED                       * 02400000
*             R6-       REGISTER CONTAINING THE ADDRESS OF THE        * 02500000
*                       CURRENT CONTROL SECTION ESD ENTRY             * 02600000
*                                                                     * 02700000
*OUTPUT-                                                              * 02800000
*        REGISTERS-                                                   * 02900000
*             R10       REGISTER CONTAINING THE ADDRESS OF THE        * 03000000
*                       NEW CURRENT CONTROL SECTION ESD ENTRY, IF     * 03100000
*                       CHANGED                                       * 03200000
*                                                                     * 03300000
*EXITS, NORMAL-                                                       * 03400000
*        EXITS TO THE CALLING ROUTINE                                 * 03500000
*                                                                     * 03600000
*EXITS, ERROR-                                                        * 03700000
*        EXITS TO THE CALLING ROUTINE                                 * 03800000
*                                                                     * 03900000
*TABLES/WORK AREAS-                                                   * 04000000
*        ESDBLK1-  A BLOCK IN STORAGE TO CONTAIN A MAXMI              * 04100000
*        ESDBLK1-  A BLOCK OF STORAGE TO CONTAIN A MAXIMUM OF 16 ESD  * 04200000
*                  ENTRIES, ALSO SERVES AS AN INPUT/OUTPUT BUFFER     * 04300000
*                  FOR THE OVERFLOW FILE (FILE2) WHEN NECESSARY       * 04400000
*        ESDBLK2-  SAME FUNCTION AS ESDBLK1 ABOVE                     * 04500000
*        NOTELIST- A LIST OF NOTE PARAMETERS OF OVERFLOWED ESD BLOCKS * 04600000
*                  WHEN NOT IN CORE                                   * 04700000
*                                                                     * 04800000
*ATTRIBUTES-                                                          * 04900000
*        REFRESHABLE                                                  * 05000000
*                                                                     * 05100000
*NOTES                                                                * 05200000
*                                                                     * 05300000
         EJECT                                                          05400000
         COPY  JCOMMON                                                  05500000
         EJECT                                                          05600000
         COPY  JTEXT                                                    05700000
         EJECT                                                          05800000
         COPY  ICOMMON                                                  05900000
         EJECT                                                          06000000
JTEXT    DSECT ,                                                        06100000
         ORG   JTEXT                                                    06200000
         COPY  RSYMRCD                                                  06300000
         EJECT                                                          06400000
&NM.00   CSECT                                                          06500000
* VS1 REL 2.6 CHANGES                                                   06510002
*C221000                                                        OX00106 06550002
*A246500,430500,481500                                          OX00106 06560002
*C430500,481500                                                @OY08064 06560105
         JMODID                                                         06600000
&NM.01   CONTENTS                                                       06700000
         USING &NM.01,R8                BASE REGISTER                   06800000
         EJECT                                                          06900000
*TITLE-  BLDESD                                                       * 07000000
*                                                                     * 07100000
*FUNCTION/OPERATION-                                                  * 07200000
*        BUILD OR RESUME AN ESD ENTRY                                 * 07300000
*                                                                     * 07400000
*INPUT-  R4 CONTAINS A POINTER TO THE RECORD BEING PROCESSED          * 07500000
*        R10 CONTAINS A POINTER TO A PARAMETER LIST                   * 07600000
*                                                                     * 07700000
*OUTPUT- R10 CONTAINS A POINTER TO THE ESD ENTRY                      * 07800000
*                                                                     * 07900000
         SPACE                                                          08000000
BLDESD   BALR  R14,R7                   SAVE REGISTERS IN STACK         08100000
         LR    R8,R12                   SET UP BASE REGISTER            08200000
         LA    R2,D1                    INCREMENT IN                    08300000
         LR    R3,R2                    TWO REGISTER                    08400000
         LR    R5,R10                   SAVE POINTER                    08500000
         AH    R2,D0(,R5)               ESDID                           08600000
         AH    R3,HIESDNR               ESD NUMBER                      08700000
         STH   R2,XESDI                 ESDID                           08800000
         STH   R3,XLNGQ                 ESD NUMBER                      08900000
         MVC   XFLGB,XPARM              FLAGS                           09000000
         SR    R0,R0                    ZERO                            09100000
         ST    R0,XLCTR                 INITIAL VALUE                   09200000
         OC    XESDI(D1),XPARM+D3       FLAG FOR DSECT OR COM           09300000
BLDESD1  MVC   XTYPE,XPARM+D1           TYPE                            09400000
         MVC   XNAME,=8AL1(JBLANK)      PAD                             09500000
         MVC   XNAME(D1),XTYPE          NAME                            09600000
         GOIF  RFIELDN,OFF=BLDESD2      SKIP IF NO NAME                 09700000
         MVC   RLNGQ,=H'1'              LENGTH ATTRIBUTE                09800000
         GOIF  PRIORDEF,ON=BLDESD2      SKIP IF PREVIOUSLY DEFINED      09900000
         MVC   XNAME,RNAME              GET NAME                        10000000
         MVC   XTYPE,XPARM+D2           TYPE                            10100000
BLDESD2  LA    R10,XWORK                PASS RECORD POINTER             10200000
         GOTO  ENTER                    TRY TO ENTER IN SYMBOL TABLE    10300000
         BNE   BLDESD5                  ALREADY IN SYMBOL TABLE         10400000
         STH   R2,D0(,R5)               SAVE ESDID                      10500000
         STH   R3,HIESDNR               SAVE ESD NUMBER                 10600000
         TM    XESDI,CSW2+DSW2          COM OR DSECT                    10700000
         BNE   BLDESD4                  SKIP IF SO                      10800000
         NC    FSTCSECT,FSTCSECT        SEE IF FIRST CSECT              10900000
         BNE   BLDESD3                  SKIP IF NOT                     11000000
         STH   R3,FSTCSECT              FIRST CSECT ESD NUMBER          11100000
BLDESD3  CLI   XTYPE,ETYPEPC            PRIVATE CODE                    11200000
         BNE   BLDESD4                  SKIP IF NOT                     11300000
         STH   R2,JESDID                ESDID OF PRIVATE CODE           11400000
BLDESD4  LR    R10,R3                   ESD NUMBER                      11500000
         GOTO  GETESD                   GET ESD ENTRY                   11600000
         LM    R2,R3,XTYPE              TYPE, ESDID, ADDRESS            11700000
         SR    R4,R4                    INITIALIZE                      11800000
         LM    R5,R6,XNAME              NAME                            11900000
         STM   R2,R6,ETYPE-ETYPE(R10)   CREATE ESD ENTRY                12000000
         B     EXIT                     EXIT                            12100000
BLDESD5  CLC   SFLGS,XFLGB              SEE IF SAME TYPE SECTION        12150000
         BE    BLDESD6                  RESUME SECTION IF SAME          12200000
         NI    XPARM,BITFF-(XDUMMY)     DISCOUNT EXTERNAL DUMMYS        12250000
         CLC   SFLGS,XPARM              GIVE IT ANOTHER CHANCE          12300000
         BE    BLDESD6                  LET THIS ONE GO                 12370000
         SET   PRIORDEF,ON              INDICATE PREVIOUSLY DEFINED     12400000
         B     BLDESD1                  IGNORE NAME                     12500000
BLDESD6  LH    R10,SLNGQ                ESD ASCENDSION NUMBER           12600000
         GOTO  GETESD                   RESUME ESD ENTRY                12700000
         SET   DEFINED,ON               INDICATE RESUMED SECTION        12800000
         B     EXIT                     EXIT                            12900000
         EJECT                                                          13000000
*TITLE-  GETESD                                                       * 13100000
*                                                                     * 13200000
*FUNCTION/OPERATION-                                                  * 13300000
*        GET AN ESD ENTRY                                             * 13400000
*                                                                     * 13500000
*INPUT-  R10 CONTAINS THE ESD NUMBER                                  * 13600000
*                                                                     * 13700000
*OUTPUT- R10 CONTAINS A POINTER TO THE ENTRY                          * 13800000
*                                                                     * 13900000
         SPACE                                                          14000000
GETESD   BALR  R14,R7                   SAVE REGISTER IN STACK          14100000
         LR    R8,R12                   SET UP BASE REGISTER            14200000
         LR    R2,R10                   INTO WORK REGISTER              14300000
         LA    R10,D16*D25              MAXIMUM ESD ENTRIES             14400000
         CR    R10,R2                   SEE IF EXCEEDED                 14500000
         BNL   GETESD0                  NOPE                            14600000
         BAL   R9,GETESD                RECURSIVE CALL                  14700000
         SET   JESDOFLO,ON              INDICATE ESD OVERFLOW           14800000
         MVI   D0(R10),D3               OVERFLOW ENTRY                  14860000
         XC    D1(D19,R10),D1(R10)      INITIALIZE                      14920000
         B     EXIT                     RETURN                          15000000
GETESD0  BCTR  R2,D0                    ESD NUMBER                      15100000
         SRDL  R2,D4                    BLOCK NUMBER                    15200000
         LR    R4,R2                    NOTE/POINT ADDRESS FOR BLOCK    15300000
         MH    R4,=H'9'                 X                               15400000
         LA    R4,NOTELIST(R4)          X                               15500000
         SRL   R3,D28                   DISPLACEMENT                    15600000
         MH    R3,=H'20'                DISPLACEMENT                    15700000
         TM    D8(R4),BIT7              SEE IF THIS A NEW BLOCK         15800000
         BO    GETESD4                  NO                              15900000
         TM    FILELAST+D8,BIT7         SEE IF FLIE POSITIONED TO WRITE 16000000
         BZ    GETESD1                  YES                             16100000
         JPOINT  FILE=FILE2,ADDR=FILELAST,NEXT=WRITE   POSITION FILE    16200000
GETESD1  LA    R5,ESDBLK2               POINT TO SECOND BLOCK           16300000
         CR    R5,R6                    SEE IF BLOCK CURRENTLY IN USE   16400000
         BH    GETESD2                  NO                              16500000
         LA    R5,ESDBLK1               POINT TO FIRST BLOCK            16600000
GETESD2  JWRITE  FILE=FILE2,PARM=(R5)   WRITE DESIGNATED BLOCK          16700000
         MVI   FILELAST+D8,D0           INDICATE FILE POSITIONED TO END 16800000
         JCHECK  FILE=FILE2             CHECK WRITE OPERATION           16900000
         JNOTE   FILE=FILE2             NOTE ADDRESS OF BLOCK ON FILE   17000000
         LH    R1,D6(,R5)               BLOCK NUMBER OF BLOCK WRITTEN   17100000
         MH    R1,=H'9'                 NOTE/POINT ADDRESS FOR BLOCK    17200000
         LA    R1,NOTELIST(R1)          X                               17300000
         MVI   D8(R1),BIT6              INDICATE BLOCK ON FILE          17400000
         MVC   D0(D8,R1),JNOTEVAL       SAVE BLOCK NOTE/POINT ADDRESS   17500000
         MVC   FILELAST(D8),JNOTEVAL    NOTE/POINT ADDRESS OF FILE END  17600000
         TM    D8(R4),BIT6              SEE IF BLOCK ON FILE            17700000
         BZ    GETESD3                  NOPE                            17800000
         JPOINT  FILE=FILE2,ADDR=(R4),NEXT=READ   POINT TO BLOCK        17900000
         JREAD   FILE=FILE2,PARM=(R5)   BRING IN BLOCK                  18000000
         MVI   FILELAST+D8,BIT7         INDICATE FILE NOT POSITIONED    18100000
         JCHECK  FILE=FILE2             CHECK READ OPERATION            18200000
GETESD3  ST    R5,JFWORD1               ADDRESS OF BLOCK                18300000
         MVI   D8(R4),BIT7              INDICATE BLOCK IS IN CORE       18400000
         MVC   D0(D4,R4),JFWORD1        SAVE ADDRESS OF BLOCK IN CORE   18500000
GETESD4  MVC   JFWORD1,D0(R4)           ADDRESS TO FULLWORD BOUNDARY    18600000
         L     R5,JFWORD1               ADDRESS OF BLOCK IN CORE        18700000
         STH   R2,D6(,R5)               BLOCK NUMBER                    18800000
         LA    R10,D8(R3,R5)            POINT TO ENTRY REQUESTED        18900000
         B     EXIT                     RETURN                          19000000
         EJECT                                                          19100000
*TITLE-  MAKESD                                                       * 19200000
*                                                                     * 19300000
*FUNCTION/OPERATION-                                                  * 19400000
*        CREATE THE ESD ADJUSTMENT TABLE                              * 19500000
*        ESD FINISHING AND OUTPUT                                     * 19600000
*                                                                     * 19700000
*INPUT-  THE EXTERNAL SYMBOL DICTIONARY (ESD).                        * 19800000
*                                                                     * 19900000
*OUTPUT- THE ESD ADJUSTMENT TABLE.                                    * 20000000
*        THE EXTERNAL SYMBOL DICTIONARY ON THE SYSTEM OUTPUT FILES.   * 20100000
*                                                                     * 20200000
         SPACE                                                          20300000
ENTRY    BALR  R14,R7                  SAVE REGISTERS IN STACK          20400000
         LR    R8,R12                  SET UP BASE REGISTER             20500000
         LR    R10,R4                  PASS RECORD POINTER              20600000
         MVI   RFLGB,ESDNRSW+ENTRYSW    SET FLAGS                       20700000
         GOTO  FIND                     LOOKUP IN SYMBOL TABLE          20800000
         BZ    ENTRY2                   ERROR                           20900000
         GOIF  (MODE1,MODE2),ANY=EXIT   SUSPEND ACTION IF NOT MODE IA   21000000
         GOTO  ENTER                    ENTER IN SYMBOL TABLE           21100000
         LH    R10,HIESDNR              GET HIGHEST ESD NUMBER          21200000
         LA    R10,D1(,R10)             GET NEXT ESD NUMBER             21300000
         STH   R10,HIESDNR              SAVE                            21400000
         STH   R10,SLNGQ                ESD ASCENDSION NUMBER           21500000
         GOTO  GETESD                   FIND ROOM IN ESD                21600000
         MVI   ETYPE-EITEM(R10),ETYPELX PRIME ESD ENTRY                 21700000
ENTRY1   MVI   RTYPE,JTSYMBL            CHECK BACK IN PASS 2            21800000
         B     EXIT                     FINIS                           21900000
ENTRY2   GOIF  (ESDNRSW,XENTRY,CSECTSW,DSECTSW),ALL=ENTRY1,MIX=ENTRY3   22000000
         GOIF  (CSW,DSW,ESW),ANY=ENTRY3 INVALID                 OX00106 22100002
         SR    R0,R0                    SEE IF                          22200000
         CH    R0,SESDI                 ABSOLUTE                        22300000
         BZ    ENTRY3                   BAD                             22400000
         SET   XENTRY,ON                INDICATE VALID ENTRY            22500000
         OI    RFLGB,XENTRY             INDICATE VALID ENTRY            22600000
         MVC   RESDI(D6),SESDI          ESDID AND ADDRESS               22700000
         LH    R10,HIESDNR              GET HIGHERS ESD NUMBER          22800000
         LA    R10,D1(,R10)             GET NEXT ESD NUMBER             22900000
         STH   R10,HIESDNR              SAVE                            23000000
         GOTO  GETESD                   GET ESD ENTRY                   23100000
         MVI   ETYPE-EITEM(R10),ETYPELD ESD ENTRY TYPE                  23200000
         MVC   EESDI-EITEM(D6,R10),RESDI     ESDID AND VALUE            23300000
         MVC   ENAME-EITEM(D8,R10),RNAME     NAME                       23400000
         MVI   RTYPE,JTADJII            ADJUST VALUE IN IIA             23500000
         B     EXIT                     FINIS                           23600000
ENTRY3   MVI   RTYPE,JTPASS             INVALID ENTRY                   23700000
         B     EXIT                     FINIS                           23800000
EXTRN    BALR  R14,R7                   SAVE REGISTERS IN STACK         23900000
         LR    R8,R12                   SET UP BASE REGISTER            24000000
         LA    R2,D1                    INCREMENT                       24100000
         LR    R3,R2                    IN TWO REGISTERS                24200000
         STH   R2,RLNGQ                 LENGTH ATTRIBUTE OF SYMBOL      24300000
         AH    R2,HICESDID              NEXT ESDID                      24400000
         AH    R3,HIESDNR               NEXT ESD NUMBER                 24500000
EXTRN1   STH   R2,RESDI                 ESDID                           24600000
         SET   ESW1,ON                  SET EXTRN/EQU FLAG      OX00106 24650002
EXTRN2   XI    RNAME,BIT0               UNIQUE NAME                     24700000
         LR    R10,R4                   PASS RECORD POINTER             24800000
         GOTO  ENTER                    ENTER INTO SYMBOL TABLE         24900000
         BNE   EXTRN5                   ALREADY IN SYMBOL TABLE         25000000
         TM    RNAME,BIT0               SEE IF FIRST TIME AROUND        25100000
         BNE   EXTRN2                   ENTER SECOND TIME IF FIRST      25200000
         CH    R3,HIESDNR               SEE IF NEW ENTRY                25300000
         BNH   EXTRN3                   SKIP IF NOT NEW                 25400000
         STH   R2,HICESDID              SAVE NEW ESDID                  25500000
         STH   R3,HIESDNR               SAVE NEW0ESD NUMBER             25600000
EXTRN3   LR    R10,R3                   PASS ESD NUMBER                 25700000
         GOTO  GETESD                   GET ESD ENTRY                   25800000
         MVC   ETYPE-EITEM(D8,R10),RTYPE                                25900000
         MVC   ENAME-EITEM(D8,R10),RNAME                                26000000
EXTRN4   MVI   RTYPE,JTPASS             NO PROCESS RECORD IN PASS 2     26100000
         B     EXIT                                                     26200000
EXTRN5   LH    R2,SESDI                 GET ESDID OF PREVIOUS ENTRY     26300000
         LH    R3,SLNGQ                 GET ESD ASCENDSION NUMBER       26400000
         TM    RNAME,BIT0               SEE IF FIRST TIME AROUND        26500000
         BNE   EXTRN1                   GO AGAIN IF FIRST               26600000
         SET   PRIORDEF,ON              INDICATE PREVIOUSLY DEFINED     26700000
         B     EXTRN4                   EXIT                            26800000
VCON     BALR  R14,R7                   SAVE REGISTERS IN STACK         26900000
         LR    R8,R12                   SET UP BASE REGISTER            27000000
         LR    R3,R2                    IN TWO REGISTERS                27100000
         AH    R2,HICESDID              GET NEXT ESDID                  27200000
         AH    R3,HIESDNR               GET NEXT ESD NUMBER             27300000
         STH   R2,XESDI                 ESDID                           27400000
         STH   R3,XLNGQ                 ESD NUMBER                      27500000
         MVI   XTYPE,ETYPEER            TYPE                            27600000
         MVI   XFLGB,ESDNRSW            FLAGS                           27700000
         OI    XNAME,BIT0               EXTERNAL NAME                   27800000
         SR    R0,R0                    ZERO                            27900000
         STH   R0,XLCTR                 VALUE                           28000000
         LA    R10,XWORK                POINTER TO ENTRY                28100000
         GOTO  ENTER                    ENTER IN SYMBOL TABLE           28200000
         BNZ   EXIT                     ALREADY IN SYMBOL TABLE         28300000
         STH   R2,HICESDID              SAVE ESDID                      28400000
         STH   R3,HIESDNR               SAVE ESD NUMBER                 28500000
         XI    XNAME,BIT0               RESET                           28600000
         LR    R10,R3                   GET ESD NUMBER                  28700000
         GOTO  GETESD                   GET ESD ENTRY                   28800000
         MVC   ETYPE-EITEM(D8,R10),XTYPE     TYPE, FLAGS, ESDID, VALUE  28900000
         MVC   ENAME-EITEM(D8,R10),XNAME     NAME                       29000000
         B     EXIT                     RETURN                          29100000
QCON     BALR  R14,R7                   SAVE REGISTERS IN STACK         29200000
         LR    R8,R12                   SET UP BASE REGISTER            29300000
         LA    R10,XWORK                PASS POINTER TO WORK AREA       29400000
         GOTO  FIND                     LOOKUP IN SYMBOL TABLE          29500000
         BNE   EXIT                     NOT IN SYMBOL TABLE             29600000
         GOIF  (ESDNRSW,DSECTSW,DSCOMSW,XDUMMY),NOTALL=EXIT VALID NAME  29700000
         SET   XDUMMY,OFF               ONE TIME ONLY PER DSECT NAME    29800000
         LR    R10,R2                   INCREMENT IN TWO REGISTERS      29900000
         AH    R2,HICESDID              NEXT ESDID                      30000000
         STH   R2,HICESDID              SAVE ESDID                      30100000
         LH    R3,SLNGQ                 ESD ASCENDSION NUMBER           30200000
         AH    R10,HIESDNR              NEXT ESD NUMBER                 30300000
         STH   R10,HIESDNR              SAVE ESD NUMBER                 30400000
         GOTO  GETESD                   GET ESD ENTRY                   30500000
         MVC   ENAME-EITEM(D8,R10),XNAME     NAME                       30600000
         STH   R2,EESDI-EITEM(,R10)     ESDID                           30700000
         OI    ESWTS-EITEM(R10),QDSW2   INDICATE XD ENTRY               30750000
         STH   R3,EHILC-EITEM(,R10)     ESD ASCENDSION NUMBER           30800000
         MVI   ETYPE-EITEM(R10),ETYPEDX TYPE                            30900000
         B     EXIT                     EXIT                            31000000
SUMESD   BALR  R14,R7                   PUSH DOWN ONE MORE LEVEL        31100000
SUMGET   LR    R10,R4                   PASS                            31200000
         BAL   R2,GOTESD                GET ESD ITEM                    31300000
         SR    R2,R2                    ZERO FUNCTION BYTE REGISTER     31400000
         TRT   ETYPE,SUMTBL             GET ROUTINE ADDRESS             31500000
         B     SUMGET(R2)               GO TO ROUTINE                   31600000
SUMCST   LM    R14,R15,ELCTR            GET CURRENT AND HIGH ADDRESS    31700000
         CR    R14,R15                  SEE IF CURRENT IS ALSO HIGH     31800000
         BNH   SUMCST1                  SKIP IF NOT                     31900000
         LR    R15,R14                  SAVE HIGH                       32000000
SUMCST1  SR    R14,R14                  ASSUME NO OFFSET                32100000
         GOIF  (CSW2,DSW2),ANY=SUMCST3  NO OFFSET FOR DSECTS OR COMS    32200000
         L     R14,STARTLOC             GET START ADDRESS               32300000
         NR    R14,R5                   ROUND TO SECTION ALIGNMENT      32400000
         LA    R0,D7                    INCREMENT                       32500000
         AR    R0,R14                   COMPUTE NEXT START ADDRESS      32600000
         AR    R0,R15                   COMPUTE NEXT START ADDRESS      32700000
         ST    R0,STARTLOC              SAVE                            32800000
         LTR   R14,R14                  SEE IF ADJUSTMENT REQUIRED      32900000
         BZ    SUMCST3                  NOPE                            33000000
         ST    R14,D4(,R4)              ADJUSTMENT FACTOR               33100000
         MVC   D0(D2,R4),EESDI          ARGUMENT ESDID                  33200000
SUMCST2  MVC   D2(D2,R4),EESDI          TARGET ESDID                    33300000
         SR    R4,R5                    POINT TO NEXT ADJUSTMENT ENTRY  33400000
SUMCST3  STM   R14,R15,ELCTR            ADDRESS AND LENGTH              33500000
         B     SUMGET                   CONTINUE WITH NEXT ENTRY        33600000
SUMDXD   LM    R15,R0,ELCTR             GET LENGTH AND ALIGNMENT FACTOR 33700000
         LR    R14,R0                   REORDER                         33800000
         B     SUMCST3                  SKIP                            33900000
SUMDSD   MVI   ETYPE,ETYPEXD            CHANGE TYPE                     34000000
         LH    R10,EHILC                GET ESD ASCENDSION NUMBER       34100000
         GOTO  GETESD                   GET ESD ENTRY                   34200000
         LA    R14,D7                   ALIGNMENT FACTOR                34300000
         L     R15,EHILC-EITEM(,R10)    LENGTH                          34400000
         XC    D4(D4,R4),D4(R4)                                         34500000
         MVC   D0(D2,R4),EESDI-EITEM(R10)                               34600000
         B     SUMCST2                                                  34700000
GOTESD   LA    R3,D1(,R3)               GET NEXT ESD NUMBER             34800000
         CH    R3,HIESDNR               SEE IF ALL THROUGH              34900000
         BH    EXIT                     FINIS                           35000000
         LR    R10,R3                   PASS ESD NUMBER                 35100000
         GOTO  GETESD                   GET ESD ENTRY                   35200000
         LR    R6,R10                   RETURN POINTER                  35300000
         BR    R2                       RETURN                          35400000
MAKESD   BALR  R14,R7                   SAVE REGISTERS IN STACK         35500000
         LR    R8,R12                   SET UP BASE REGISTER            35600000
         L     R4,LATEND                ESD ADJUSTMENT TABLE POINTER    35700000
         LH    R5,=H'-8'                INCREMENT                       35800000
         MVI   CARDADDR+D3,48           FLUSH CARD PUNCH BUFFER         35900000
         SR    R3,R3                    ESD NUMBER INITIALIZED          36000000
         BAL   R9,SUMESD                SUM CONTROL SECTIONS            36100000
         S     R10,LATEND               LENGTH OF ESD ADJUSTMENT TABLE  36200000
         LR    R11,R5                   INCREMENT                       36300000
         STM   R10,R11,ADJINDEX         SAVE FOR PASS TWO               36400000
MAKGET   BAL   R2,GOTESD                GET NEXT SEQUENTIAL ESD ENTRY   36500000
         SR    R2,R2                    ZERO FUNCTION BYTE REGISTER     36600000
         LR    R10,R2                   CLEAR REGISTER                  36650000
         TRT   ETYPE,MAKTBL             GET ROUTINE ADDRESS             36700000
         B     MAKGET(R2)               GO TO ROUTINE                   36800000
MAKCST   SET   (QDSW2,DSW2,CSW2),OFF    RESET XD DSECT OR COM BITS      36900000
         CLI   ENAME,J9                 SEE IF NAMED                    37000000
         BH    PRTESD                   SKIP IF NAMED                   37100000
MAKPVT   MVI   ENAME,JBLANK             FAKE THE BLANK                  37200000
         B     PRTESD                   PRINT ESD ITEM                  37300000
MAKTRY   LM    R14,R1,ADJINDEX          ESD ADJUSTMENT INDEX            37400000
         LH    R10,EESDI                GET ESDID                       37500000
MAKTRY1  BXLE  R14,R15,PRTESD           SEE IF ADJUSTMENT REQUIRED      37600000
         CH    R10,D0(R1,R14)           SEE IF THIS IS THE ENTRY        37700000
         BNE   MAKTRY1                  NO, KEEP LOOKING                37800000
         L     R10,D4(R1,R14)           GET ADJUSTMENT FACTOR           37900000
         A     R10,ELCTR                ADD OFFSET                      38000000
MAKEXT   ST    R10,ELCTR                SAVE                            38100000
         EJECT                                                          38200000
*TITLE-  PRTESD                                                       * 38300000
*                                                                     * 38400000
*FUNCTION/OPERATION-                                                  * 38500000
*        PRINT AN ITEM IN THE EXTERNAL SYMBOL DICTIONARY              * 38600000
*                                                                     * 38700000
*INPUT-  REGISTER R10 IS A POINTER TO AN ESD ENTRY                    * 38800000
*                                                                     * 38900000
*OUTPUT- THE EXTERNAL SYMBOL DICTIONARY                               * 39000000
*                                                                     * 39100000
         SPACE                                                          39200000
PRTESD   EQU   *                                                        39300000
         GOIF  (JESD,JLIST),NOTALL=PCHESD    SKIP IF NOT OPTIONED       39400000
         LH    R5,LINECNT               GET LINE COUNT                  39500000
         GOIF  (R5),POS=PRTESD2         SKIP IF NOT END OF PAGE         39600000
         JPRINT                         GET PRINT BUFFER                39700000
         SET   EJECT                    CARRIAGE CONTROL FOR TITLE LINE 39800000
         MVC   DECKID,JDECKID           DECK IDENTIFIER                 39900000
         MVC   TITLE,ZTITLE             SET TITLE                       40000000
         MVC   PAGE,ZPAGEZ              SET PAGE NUMBER DESIGNATOR      40100000
         LH    R14,JPAGENO              GET OLD PAGE NUMBER             40200000
         LA    R14,1(,R14)              INCREMENT BY 1                  40300000
         STH   R14,JPAGENO              SAVE PAGE NUMBER                40400000
         CVD   R14,JDWORD               CONVERT PAGE NUMBER TO DECIMAL  40500000
         UNPK  PAGENO,JDWORD+6(2)       UNPACK TO EBCDIC CODE           40600000
         NC    PAGENO,DIGMASK           CONVERT TO INTERNAL CHARACTERS  40700000
         GOIF  PAGENO,J0,NOTEQ=PRTESD1  SKIP IF NOT A LEADING ZERO      40800000
         MVI   PAGENO,JBLANK            FORCE TO A BLANK                40900000
         GOIF  PAGENO+1,J0,NOTEQ=PRTESD1     SKIP IF NOT A LEADING ZERO 41000000
         MVI   PAGENO+1,JBLANK          FORCE TO A BLANK                41100000
PRTESD1  JPRINT                         GET PRINT BUFFER                41200000
         MVC   HEADING,ZHEADING         SET SUBTITLE                    41300000
         MVC   LVTMDT,JLVTMDT           SET ASSEMBLER LEVEL, TIME, DATE 41400000
         LH    R5,JLNCT                 GET MAXIMUM LINE COUNT          41500000
PRTESD2  JPRINT                         GET PRINT BUFFER                41600000
         SET   SPACE1                   CARRIAGE CONTROL FOR LINE       41700000
         CH    R5,JLNCT                 COMPARE TO MAXIMUM LINE COUNT   41800000
         BL    PRTESD3                  SKIP IF NOT REACHED             41900000
         SET   SPACE2                   CARRIAGE CONTROL FOR FIRST LINE 42000000
PRTESD3  BCTR  R5,0                     DECREMENT LINE COUNT            42100000
         STH   R5,LINECNT               SAVE LINE COUNT                 42200000
         MVC   ZSYMBOL,ENAME            SET NAME                        42300000
         TRT   ETYPE,ZTYPESZ            TRANSLATE FIRST CHARACTER       42400000
         STC   R2,ZTYPE                 TO OUTPUT ITEM                  42500000
         TRT   ETYPE,ZTYPESZ+D7         TRANSLATE SECOND CHARACTER      42600000
         STC   R2,ZTYPE+D1              TO OUTPUT ITEM                  42700000
         UNPK  ZID(L'ZID+1),EESDI(L'EESDI+1) UNPACK WITH ROOM TO SPARE  42800000
         NC    ZID,DIGMASK              CONVERT TO INTERNAL CHARACTERS  42900000
         MVI   ZID+L'ZID,JBLANK         REPAIR DAMAGE                   43000000
         NI    ZID+1,BITFF-ESW-EQUF                            @OY08064 43050005
         GOIF  ETYPEER,EQUAL=PCHESD     FINIS FOR EXTERNAL REFERENCE    43100000
         GOIF  ETYPEWX,EQUAL=PCHESD     FINIS FOR EXTERNAL REFERENCE    43200000
         UNPK  ZADDR(L'ZADDR+1),ELCTR(L'ELCTR+1)  UNPACK WITH EXCESS    43300000
         NC    ZADDR,DIGMASK            CONVERT TO INTERNAL CHARACTERS  43400000
         MVI   ZADDR+L'ZADDR,JBLANK     REPAIR DAMAGE                   43500000
         GOIF  ETYPELD,NOTEQ=PRTESD4    SKIP IF NOT LD TYPE             43600000
         MVC   ZLDID,ZID                PUT IN PROPER PERSPECTIVE       43700000
         MVC   ZID,ZID-1                REPAIR                          43800000
         B     PCHESD                   FINISHED IF LD TYPE             43900000
PRTESD4  UNPK  ZLENGTH(L'ZLENGTH+1),EHILC(L'EHILC+1)   UNPACK           44000000
         NC    ZLENGTH,DIGMASK          CONVERT TO INTERNAL CHARACTERS  44100000
         MVI   ZLENGTH+L'ZLENGTH,JBLANK REPAIR                          44200000
         EJECT                                                          44300000
*TITLE-  PCHESD                                                       * 44400000
*                                                                     * 44500000
*FUNCTION/OPERATION-                                                  * 44600000
*        PUNCH ONE ITEM IN THE EXTERNAL SYMBOL DICTIONARY.            * 44700000
*                                                                     * 44800000
*INPUT-  REGISTER R6 IS A POINTER TO ONE ITEM IN THE EXTERNAL SYMBOL  * 44900000
*   DICTIONARY.                                                       * 45000000
*                                                                     * 45100000
*OUTPUT- THE EXTERNAL SYMBOL DICTIONARY ON THE PUNCH AND LINK FILES.  * 45200000
*                                                                     * 45300000
         SPACE                                                          45400000
PCHESD   GOIF  (JDECK,JLINK),NONE=MAKGET     RETURN IF NOT OPTIONED     45500000
         LM    R10,R11,CARDADDR         GET ADDRESS OF CARD             45600000
         CLI   CARDADDR+D3,48           SEE IF ANOTHER CARD NEEDED      45700000
         BL    PCHESD1                  NOT NECESSARILY                 45800000
         JPUNCH  SEQ=YES                GET ANOTHER CARD BUFFER         45900000
         SET   JENDCHK,ON               PUNCH END CARD WHEN TIME COMES  46000000
         MVC   CARDID,ZESDZ             CARD IDENTIFIER                 46100000
         TR    CARDID+D1(71),JTRTABLE   TRANSLATE TO EXTERNAL CODE      46200000
         MVI   DATALN,D0                HIGH ORDER BYTE OF FIELD ZEROED 46300000
         SR    R10,R10                  NEW CARD BUFFER INDICATION      46400000
PCHESD1  LA    R10,NEXTITEM             POINT TO NEXT ENTRY SPACE       46500000
         STM   R10,R11,CARDADDR         SAVE ADDRESS OF CARD            46600000
         STC   R10,DATALN+1             LENGTH OF DATA                  46700000
         ALR   R10,R11                  POINTER TO ESD DATA ITEM IN R3  46800000
         MVC   ZZSYMBOL,ENAME           SET NAME                        46900000
         TR    ZZSYMBOL,JTRTABLE        CONVERT TO EXTERNAL CHARACTERS  47000000
         MVC   ZZTYPE,ETYPE             SET TYPE                        47100000
         MVC   ZZADDR,ELCTR+L'ELCTR-L'ZZADDR SET ADDRESS                47200000
         GOIF  ETYPEXD,NOTEQ=PCHESD3    SKIP IF NOT XD TYPE             47300000
         MVC   ZZADDR(L'ZZADDR+L'ZZALGN),ELCTR    SET ALIGNMENT FACTOR  47400000
PCHESD3  GOIF  ETYPELD,NOTEQ=PCHESD4    SKIP IF NOT LD TYPE             47500000
         MVC   ZZLENGTH+L'ZZLENGTH-L'EESDI(L'EESDI),EESDI   LDID        47600000
         MVI   ZZLENGTH,X'00'           PAD WITH LEADING ZEROS          47700000
         B     MAKGET                   FINIS                           47800000
PCHESD4  TM    FIRSTID,X'F0'            SEE IF ESDID SET                47900000
         BZ    PCHESD5                  SKIP IF ALREADY SET             48000000
         MVC   FIRSTID,EESDI            SET ESDID OF FIRST NON LD ITEM  48100000
         NI    FIRSTID,BITFF-BIT4-EQUF                         @OY08064 48150005
PCHESD5  GOIF  ETYPEER,EQUAL=MAKGET     FINIS FOR EXTERNAL REFERENCE    48200000
         GOIF  ETYPEWX,EQUAL=MAKGET     FINIS FOR EXTERNAL REFERENCE    48300000
         MVC   ZZLENGTH,EHILC+L'EHILC-L'ZZLENGTH  SET LENGTH            48400000
         B     MAKGET                   FINIS                           48500000
         EJECT                                                          48600000
REFER    BALR  R14,R7                   SAVE REGISTERS IN STACK         48700000
         LR    R8,R12                   SET UP BASE REGISTER            48800000
         MVC   XWORK(D12),=AL1(0,24,JPSOP,0,JTSYMBL,0,0,0,0,0,0,0)      48900000
         LA    R10,XWORK                SYMBOL POINTER                  49000000
         GOTO  FIND                     LOOK UP IN SYMBOL TABLE         49100000
         BZ    REFER2                   FIND IN SYMBOL TABLE            49200000
REFER1   GOIF  MODE2,ON=EXIT            DUMPING LITERALS ON OVERFLOW    49300000
         B     REFER4                   UNDEFINED AS YET                49400000
REFER2   GOIF  ENTRYSW,ON=REFER1        NOT A DEFINED SYMBOL            49500000
         MVC   XTYPE(D2),=AL1(JTADJII,DEFINED+PRIORDEF)                 49600000
         GOIF  MODE2,OFF=REFER3         SKIP IF NOT OVERFLOW            49700000
         MVI   XTYPE,JTSYMII            REHASH IN PASS TWO              49800000
REFER3   MVC   XFLGB,SFLGS              SYMBOL FLAGS                    49900000
         MVC   XESDI(D6),SESDI          ESDID AND VALUE                 50000000
         LH    R15,SLNGQ                LENGTH ATTRIBUTE                50100000
         GOIF  ESDNRSW,OFF=REFER5       EXTERNAL SYMBOL                 50200000
REFER4   LA    R15,D1                   LENGTH ATTRIBUTE                50300000
REFER5   STH   R15,XLNGQ                SET LENGTH ATTRIBUTE            50400000
         LR    R11,R10                                                  50500000
         LH    R10,JOUTFILE             OUTPUT FILE ADDRESS             50600000
         JPUTM FILE=(R10),ADDR=(R11)                                    50700000
         B     EXIT                     FINIS                           50800000
         EJECT                                                          51100000
*                        CONSTANTS                                    * 51200000
         SPACE                                                          51300000
OIINST   OI    D0(R15),D0               EXECUTED INSTRUCTION            51400000
DIGMASK  JGENIN  'FFFFFF'               DIGIT MASK                      51500000
ZTYPESZ  JGENIN  'SLEXPCXDDRWCMDXXXX'   TYPES                           51600000
SUMTBL   DC    AL1(SUMCST-SUMGET)       00 - (SD) CONTROL SECTION       51700000
         DC    AL1(SUMGET-SUMGET)       01 - (LD) LABEL DEFINITION      51800000
         DC    AL1(SUMGET-SUMGET)       02 - (ER) EXTERNAL REFERENCE    51900000
         DC    AL1(SUMGET-SUMGET)       03        OVERFLOW ENTRY        52000000
         DC    AL1(SUMCST-SUMGET)       04 - (PC) PRIVATE CODE          52100000
         DC    AL1(SUMCST-SUMGET)       05 - (CM) COMMON                52200000
         DC    AL1(SUMDXD-SUMGET)       06 - (XD) EXTERNAL DUMMY        52300000
         DC    AL1(SUMDSD-SUMGET)       07 -      EXTERNAL DUMMY        52400000
         DC    AL1(SUMCST-SUMGET)       08 -      DUMMY CONTROL SECTION 52500000
         DC    AL1(SUMGET-SUMGET)       09        UNDEFINED ENTRY       52600000
         DC    AL1(SUMGET-SUMGET)       0A - (WX) EXTERNAL REFERENCE    52700000
MAKTBL   DC    AL1(PRTESD-MAKGET)       00 - (SD) CONTROL SECTION       52800000
         DC    AL1(MAKTRY-MAKGET)       01 - (LD) LABEL DIFINITION      52900000
         DC    AL1(MAKEXT-MAKGET)       02 - (ER) EXTERNAL REFERENCE    53000000
         DC    AL1(MAKGET-MAKGET)       03        OVERFLOW ENTRY        53100000
         DC    AL1(MAKPVT-MAKGET)       04 - (PC) PRIVATE CODE          53200000
         DC    AL1(MAKCST-MAKGET)       05 - (CM) COMMON                53300000
         DC    AL1(MAKCST-MAKGET)       06 - (XD) EXTERNAL DUMMY        53400000
         DC    AL1(MAKGET-MAKGET)       07 -      NOT USED              53500000
         DC    AL1(MAKGET-MAKGET)       08 -      DSECT                 53600000
         DC    AL1(MAKGET-MAKGET)       09 -      UNDEFINED ENTRY       53700000
         DC    AL1(MAKEXT-MAKGET)       0A - (WX) EXTERNAL REFERENCE    53800000
ZESDZ    DC    B'00000010'              12-9-2 CARD IDENTIFIER          53900000
         JGENIN  'ESD'                  ESD CARD IDENTIFIER             54000000
ZPAGEZ   JGENIN  'PAGE'                 PAGE NUMBER DESIGNATOR          54100000
ZTITLE   JGENIN  'EXTERNAL SYMBOL DICTIONARY'     ESD TITLE             54200000
ZHEADING DC    YL1(SPACE3)              CARRIAGE CONTROL CHARACTER      54300000
         JGENIN  'SYMBOL   TYPE  ID   ADDR  LENGTH LDID'    SUBTITLE    54400000
         EJECT                                                          54500000
DSECT10  DSECT  ,                                                       54600000
         ORG   DSECT10                                                  54700000
         SPACE                                                          54800000
ZZSYMBOL DS    C'XXXXXXXX'              NAME, BLANK FOR PC OR BLANK CM  54900000
ZZTYPE   DS    C'X'                     TYPE                            55000000
ZZADDR   DS    C'XXX'                   ADDRESS                         55100000
ZZALGN   DS    C'X'                     ALIGNMENT FACTOR FOR SC TYPE    55200000
ZZLENGTH DS    C'XXX'                   LENGTH                          55300000
NEXTITEM EQU   *                        NEXT ITEM FOLLOWS IMMEDIATELY   55400000
         SPACE                                                          55500000
         SPACE                                                          55600000
DSECT11  DSECT ,                                                        55700000
         ORG   DSECT11                                                  55800000
         SPACE                                                          55900000
CARD     DS    0CL72                                                    56000000
CARDID   DS    C' ESD'                  CARD IDENTIFIER                 56100000
         DS    C'      '                BLANK                           56200000
DATALN   DS    H                        NUMBER OF BYTES OF ESD DATA     56300000
         DS    C'  '                    BLANK                           56400000
FIRSTID  DS    H                        ESDID OF FIRST NON LD TYPE ITEM 56500000
DATAITEM DS    CL16                                                     56600000
         SPACE                                                          56700000
         SPACE                                                          56800000
         ORG   DSECT11                                                  56900000
         SPACE                                                          57000000
LINE     DS    0CL121                                                   57100000
CTLCHAR  DBV   EJECT(0),SPACE1(1),SPACE2(2),SPACE3(3)  CARRIAGE CONTROL 57200000
DECKID   DS    CL8                      DECK IDENTIFIER                 57300000
         ORG   LINE+48                                                  57400000
TITLE    DS    C'EXTERNAL SYMBOL DICTIONARY' ESD TITLE                  57500000
         ORG   LINE+112                                                 57600000
PAGE     DS    C'PAGE'                  PAGE NUMBER DESIGNATOR          57700000
         ORG   LINE+118                                                 57800000
PAGENO   DS    C'000'                   PAGE NUMBER                     57900000
         ORG   LINE                                                     58000000
HEADING  DS    C'3SYMBOL   TYPE  ID   ADDR  LENGTH LDID'                58100000
         ORG   LINE+L'LINE-L'JLVTMDT                                    58200000
LVTMDT   DS    CL(L'JLVTMDT)            ASSEMBLER LEVEL, TIME, DATE     58300000
         ORG   LINE+1                                                   58400000
ZSYMBOL  DS    C'XXXXXXXX'              NAME, BLANK FOR PC OR BLANK CM  58500000
         DS    C'  '                    SPACES                          58600000
ZTYPE    DS    C'XX'                    ESD ITEM TYPE                   58700000
         DS    C'  '                    SPACES                          58800000
ZID      DS    C'XXXX'                  ESD IDENTIFIER, IF NON LD TYPE  58900000
         DS    C' '                     SPACE                           59000000
ZADDR    DS    C'XXXXXX'                ADDRESS, IF TYPE SD, PC, LD     59100000
         DS    C' '                     SPACE                           59200000
ZLENGTH  DS    C'XXXXXX'                LENGTH, IF TYPE SD, PC, CM, SC  59300000
         DS    C' '                     SPACE                           59400000
ZLDID    DS    C'XXXX'                  ESD IDENTIFIER OF SD ENTRY      59500000
         MEND                                                           59600000
./  ADD  SSI=71710280,NAME=XEVAL
         MACRO                                                          00100000
&ID      XEVAL &DUMMY,&TESTRAN=NO,&DIAG=NO,&LEVEL=1,&LOGERR=NO          00200000
         GBLC  &COMPNM                                                  00300000
         LCLC  &NM                                                      00400000
         JHEAD 'EXPRESSION EVALUATION SUBROUTINE',                     ,00500000
               PHASEID=&ID,                                            ,00600000
               LEVEL=&LEVEL                                             00700000
&NM      SETC  '&COMPNM&ID'                                             00800000
*TITLE-  ASSEMBLER EXPRESSION EVALUATION SUBROUTINE                   * 00900000
*                                                                     * 01000000
*FUNCTION/OPERATION-                                                  * 01100000
*        EVALUATE EXPRESSIONS                                         * 01200000
*        CONVERT SELF-DEFINING TERMS                                  * 01300000
*        DETECT ERRORS IN EXPRESSIONS                                 * 01400000
*             SYNTACTIC ERRORS-                                       * 01500000
*                  ILLEGAL CHARACTER IN EXPRESSION                    * 01600000
*                  ILLEGAL COMBINATION OF OPERATORS                   * 01700000
*                  MORE THAN TWENTY TERMS IN EXPRESSION               * 01800000
*                  MORE THAN SIX LEVELS OF PARENTHESES IN EXPRESSION  * 01900000
*                  PREMATURE END OF EXPRESSION                        * 02000000
*             NON-SYNTACTIC ERRORS-                                   * 02100000
*                  SELF-DEFINING TERM TOO LARGE                       * 02200000
*                  SELF-DEFINING TERM CONTAINS TOO MANY CHARACTERS    * 02300000
*                  RELOCATABLE TERM IN A MULTIPLY OR DIVIDE OPERATION * 02400000
*                  ARITHMETIC OVERFLOW ON AN INTERMEDIATE VALUE       * 02500000
*                  UNDEFINED SYMBOL IN EXPRESSION                     * 02600000
*                  INVALID SYMBOL                                     * 02700000
*                                                                     * 02800000
*ENTRY POINT-                                                         * 02900000
         ENTRY &NM.01                                                 * 03000000
*                                                                     * 03100000
*INPUT-                                                               * 03200000
*        REGISTERS-                                                   * 03300000
*             R5-       REGISTER CONTAINING THE ADDRESS OF THE FIRST  * 03400000
*                       CHARACTER OF THE EXPRESSION TO BE EVALUATED   * 03500000
*        PARAMETERS-                                                  * 03600000
*             SELFDEFN- A BYTE IN STORAGE, WHEN SET TO ZERO, CAUSES   * 03700000
*                       ONE DECIMAL SELF-DEFINING TERM TO BE          * 03800000
*                       CONVERTED ONLY                                * 03900000
*             ELCTR-    A FULLWORD IN STORAGE CONTAINING THE VALUE OF * 04000000
*                       THE CURRENT LOCATION COUNTER                  * 04100000
*             EESDI-    A HALFWORD IN STORAGE CONTAINING THE CURRENT  * 04200000
*                       ESDID                                         * 04300000
*             CLCLNG-   A HALFWORD IN STORAGE CONTAINING THE LENGTH   * 04400000
*                       ATTRIBUTE OF THE CURRENT LOCATION COUNTER     * 04500000
*             SUBLIST-  A BIT IN STORAGE, WHEN SET TO ONE, INDICATES  * 04600000
*                       THAT THE LOGICAL END OF THE EXPRESSION IS     * 04700000
*                       WHEN THE PARENTHESES LEVEL GOES FROM ONE TO   * 04800000
*                       ZERO                                          * 04900000
*                                                                     * 05000000
*OUTPUT-                                                              * 05100000
*        CONDITION CODE SETTING-                                      * 05200000
*             0-        VALUE OF THE EXPRESSION IS ABSOLUTE           * 05300000
*             1-        IF 'EVALSW1' IS 0, VALUE OF THE EXPRESSION IS * 05400000
*                       COMPLEXLY RELOCATABLE.  IF 'EVALSW1' IS NOT   * 05500000
*                       0, ONE OR MORE NON-SYNTACTIC ERROR WAS        * 05600000
*                       ENCOUNTERED IN THE EVALUATION.                * 05700000
*             2-        VALUE OF THE EXPRESSION IS SIMPLY RELOCATABLE * 05800000
*             3-        A SYNTATIC ERROR WAS ENCOUNTERED              * 05900000
*        REGISTERS-                                                   * 06000000
*             R10-      REGISTER CONTAINING THE ESDID OF THE          * 06100000
*                       EXPRESSION, IF THE VALUE OF THE EXPRESSION IS * 06200000
*                       ABSOLUTE OR SIMPLY RELOCATABLE.  THE ESDID IN * 06300000
*                       COMPLEMENT FORM, IF THE VALUE OF THE          * 06400000
*                       EXPRESSION IS COMPLEXLY RELOCATABLE WITH ONLY * 06500000
*                       ONE RELOCATION FACTOR.                        * 06600000
*             R11-      REGISTER CONTAINING THE VALUE OF THE          * 06700000
*                       EXPRESSION                                    * 06800000
*             R14-      REGISTER CONTAINING THE ADDRESS OF THE FIRST  * 06900000
*                       CHARACTER FOLLOWING THE CHARACTER WHICH       * 07000000
*                       LOGICALLY TERMINATED THE EXPRESSION           * 07100000
*        PARAMETERS-                                                  * 07200000
*             IMPLNG-   A HALFWORD IN STORAGE CONTAINING THE LENGTH   * 07300000
*                       ATTRIBUTE OF THE EXPRESSION                   * 07400000
*             LOCCTREF- A BIT IN STORAGE, WHEN SET TO ONE, INDICATES  * 07500000
*                       THAT AT LEAST ONE LOCATION COUNTER REFERENCE  * 07600000
*                       HAD BEEN MADE                                 * 07700000
*             RELOCTR-  A BYTE IN  STORAGE CONTAINING THE NUMBER OF   * 07800000
*                       ESDID(S) ASSOOCIATED WITH THE VALUE OF THE    * 07900000
*                       EXPRESSION                                    * 08000000
*             RLIST-    A LIST OF HALFWORDS IN STORAGE CONTAINING     * 08100000
*                       THE ESDID(S) ASSOCIATED WITH THE VALUE OF THE * 08200000
*                       EXPRESSION, THE ESDID IS STORED IN COMPLEMENT * 08300000
*                       FORM IF THE RELOCATION FACTOR IS APPLIED      * 08400000
*                       NEGATIVLY.                                    * 08500000
*                                                                     * 08600000
*EXITS, NORMAL-                                                       * 08700000
*        EXITS TO THE CALLER.                                         * 08800000
*                                                                     * 08900000
*EXITS, ERROR-                                                        * 09000000
*        EXITS TO THE CALLER.                                         * 09100000
*                                                                     * 09200000
*TABLES/WORK AREAS-                                                   * 09300000
*        EVALWORK-                                                    * 09400000
*        OPRNS-    UP TO 20 ENTRIES OF ONE BYTE EACH, AN ENTRY IS     * 09500000
*                  MADE FOR EACH OPERATOR ENCOUNTERED.                * 09600000
*        RLIST-    UP TO 20 ENTRIES OF ONE HALFWORD EACH, AN ENTRY IS * 09700000
*                  MADE FOR THE ESDID OF EACH TERM ENCOUNTERED.       * 09800000
*        TERMS-    UP TO 15 ENTRIES OF TWO FULLWORDS EACH, AN ENTRY   * 09900000
*                  IS MADE FOR EACH TERM ENCOUNTERED.                 * 10000000
*                                                                     * 10100000
*ATTRIBUTES-                                                          * 10200000
*        REFRESHABLE.                                                 * 10300000
*                                                                     * 10400000
*NOTES-                                                               * 10500000
*                                                                     * 10600000
         EJECT                                                          10700000
         COPY  JCOMMON                                                  10800000
         AIF   ('&ID' NE 'X4V').NOTX4V                                  10900000
         EJECT                                                          11000000
         COPY  ICOMMON                                                  11100000
         EJECT                                                          11200000
&NM.00   CSECT                                                          11300000
* VS1 REL 2.6 CHANGES                                                   11350002
*A585500-585900                                                 OX00106 11370002
* VS1 RELEASE 3.1 CHANGES                                               11380003
*C643000,645000                                                 OX02675 11390003
         JMODID                                                         11400000
         USING &NM.01,R8                BASE REGISTER                   11500000
&NM.01   BALR  R14,R7                   SAVE REGISTERS                  11600000
         LR    R8,R12                   BASE REGISTER                   11700000
         AGO   .X4V                                                     11800000
.NOTX4V  EJECT                                                          11900000
         COPY  X5COM                                                    12000000
         EJECT                                                          12100000
DSECT10  DSECT                                                          12200000
         COPY  RSYMRCD                                                  12300000
         EJECT                                                          12400000
         COPY  BMDSECTS                 GET POST PROCESSOR RECORD DSECT 12500000
         EJECT                                                          12600000
         COPY  JERMSGCD                 DEFINE ERROR CODES AND SEVERITY 12700000
         EJECT                                                          12800000
* VS1 RELEASE 3.1 CHANGES                                               12850003
*C625000,631000                                                 OX02953 12860003
*C648000                                                       @OY08064 12860105
*A648100-648200                                                @OY08064 12860205
*A589100,589200                                                @VM05316 12870200
&NM.00   CSECT                                                          12900000
         JMODID                                                         13000000
&NM.01   JSAVE                                                          13100000
EVAL     EQU   &NM.01                   LABEL                           13200000
         USING DSECT2,R2                                                13300000
         USING DSECT3,R3                                                13400000
         USING JTEXT,R4                                                 13500000
         USING DSECT5,R5                                                13600000
         USING X5COM,R7                                                 13700000
         USING DSECT10,R11              DEFINITION FILE USING           13800000
         USING DSECT14,R14                                              13900000
         LR    R5,R10                   INPUT COLUMN POINTER            14000000
.X4V     XC    EVALWORK,EVALWORK        INITIALIZE WORK AREA            14100000
         LM    R2,R4,EVALREGS           INITIAL SETTING OF REGISTERS    14200000
         SPACE                                                          14300000
*                        SCAN EXPRESSION                              * 14400000
         SPACE                                                          14500000
SCAN     ST    R5,ERRPTR                SAVE FOR ERROR DIAGNOSTICS      14600000
         AIF   ('&ID' EQ 'X5V').X5V1                                    14700000
         CLI   CHAR1,JBLANK             SEE IF A BLANK                  14850000
         BH    SYNTAXER                 ILLEGAL CHARACTER IN EXPRESSION 14860000
         CLI   CHAR1,JEQUAL             SEE IF AN EQUAL SIGN            14950000
         BE    SYNTAXER                 ILLEGAL CHARACTER IN EXPRESSION 14960000
         AGO   .X4V1                                                    15000000
.X5V1    CLI   CHAR1,JBLANK             SEE IF A BLANK                  15250000
         BH    SYNERR1                  ILLEGAL CHARACTER IN EXPRESSION 15260000
         CLI   CHAR1,JEQUAL             SEE IF AN EQUAL SIGN            15270000
         BE    SYNERR1                  ILLEGAL CHARACTER IN EXPRESSION 15280000
.X4V1    ANOP                                                           15300000
         BL    ALPHANUM                 TERM                            15350000
         SPACE                                                          15400000
*                        GO TO SPECIAL CHARACTER HANDLING             * 15500000
         SPACE                                                          15600000
         SR    R14,R14                  ZERO REGISTER FOR INDEX         15700000
         IC    R14,CHAR1                GET NEXT CHARACTER              15800000
         STC   R14,NEWOP                ENTER IN OPERATOR STACK         15900000
         IC    R14,GOTOTBL-JLPARN(R14)  INDEXED ADDRESS FETCH           16000000
         GOIF  STATUS1,ELSE=GOTO(R14)   GO TO ROUTINE, PASS STATUS      16100000
         EJECT                                                          16200000
*                        (1)  PLUS OR MINUS SIGN                      * 16300000
         SPACE                                                          16400000
GOTO     BH    BINARYOP           2/3 - BINARY OPERATOR                 16500000
         SPACE                                                          16600000
*                        (2)  UNARY OPERATOR                          * 16700000
         SPACE                                                          16800000
         AIF   ('&ID' EQ 'X5V').X5V2                                    16900000
         GOIF  LNGQUOTE,ON=SYNTAXER     ILLEGAL L'ATTRIBUTE REFERENCE   17000000
         AGO   .X4V2                                                    17100000
.X5V2    GOIF  LNGQUOTE,ON=SYNERR2      ILLEGAL L'ATTRIBUTE REFERENCE   17200000
.X4V2    ANOP                                                           17300000
         GOIF  ADD1,EQUAL=CALC3   '+' - UNARY PLUS, IGNORE              17400000
         SET   UNY1               '-' - SET UNARY MINUS CODE            17500000
         GOIF  UNY0,EQUAL=CALC5,ELSE=CALC2   CHECK PREVIOUS OPERATOR    17600000
         SPACE                                                          17700000
*                        (3)  SLASH                                   * 17800000
         SPACE                                                          17900000
         AIF   ('&ID' EQ 'X5V').X5V3                                    18000000
SLASH    BNH   SYNTAXER           0/1 - TWO CONSECUTIVE OPERATORS       18100000
         AGO   .X4V3                                                    18200000
.X5V3    ANOP                                                           18300000
SLASH    BNH   SYNERR3            0/1 - TWO CONSECUTIVE OPERATORS       18400000
.X4V3    ANOP                                                           18500000
         SPACE                                                          18600000
*                        (4)  BINARY OPERATOR                         * 18700000
         SPACE                                                          18800000
BINARYOP SET   STATUS1              1 - PLUS OR MINUS SIGN              18900000
         B     CALC1                    GO CALCULATE                    19000000
         SPACE                                                          19100000
*                        (5)  ASTERISK                                * 19200000
         SPACE                                                          19300000
ASTERISK BH    BINARYOP             2 - MULTIPLICATION SIGN             19400000
         SPACE                                                          19500000
*                        (6)  LOCATION COUNTER REFERENCE              * 19600000
         SPACE                                                          19700000
         SET   LOCTREF,ON               LOCATION COUNTER REFERENCED     19800000
         LA    R5,CHAR2                 ADVANCE COLUMN POINTER          19900000
         GOIF  LNGQUOTE,ON=LOCCTR1      SEE IF LENGTH ATTRIBUTE         20000000
         SPACE                                                          20100000
*                        (7)  LOCATION COUNTER                        * 20200000
         SPACE                                                          20300000
         SET   DLOCTREF,ON              LOCATION COUNTER REFERENCED     20400000
         LH    R15,CLCLNG               LENGTH ATTRIBUTE                20700000
         AIF   ('&ID' NE 'X4V').X5V41                                   20750000
         LH    R0,EESDI                 CURRENT ESDID                   20800000
         L     R1,ELCTR                 CURRENT LOCATION COUNTER        20850000
         B     CLEANUP1                 GO TO CLEANUP                   20860000
         AGO   .X4X5V                                                   20870000
.X5V41   GOIF  LITRSW,ON=SKIPLITR       BRANCH AROUND IF NOT PROC. LITR 20880000
         LH    R0,EESDI                 GET CURRENT ESDID               20890000
         L     R1,ELCTR                 GET CURRENT LOCATION CTR        20892000
         B     CLEANUP1                 GO TO CLEANUP                   20894000
SKIPLITR EQU   *                        BRANCH LABEL                    20896000
         LH    R0,LITRSD                GET LITR ESDID                  20898000
         L     R1,LITRLC                GET LITR LOCATION CTR           20898400
         B     CLEANUP1                 GO TO CLEANUP                   20898800
.X4X5V   ANOP                                                           20899200
         SPACE                                                          20900000
*                        (8)  L - QUOTE ASTERISK                      * 21000000
         SPACE                                                          21100000
LOCCTR1  LH    R1,CLCLNG                GET CURRENT LOCATION LENGTH     21200000
         B     ABSOLUTE                 CLEANUP                         21300000
         SPACE                                                          21400000
*                        (9)  LEFT PARENTHESIS                        * 21500000
         SPACE                                                          21600000
LFPAREN  BH    BLANK1             2/3 - MAY BE END OF EXPRESSION        21700000
         AIF   ('&ID' EQ 'X5V').X5V4                                    21800000
         GOIF  MAXPARN,NOTLOW=SYNTAXER  TOO MMNY LEVELS OF PARENS       21900000
         AGO   .X4V4                                                    22000000
.X5V4    GOIF  MAXPARN,NOTLOW=SYNERR4   TOO MANY LEVELS OF PARENS       22100000
.X4V4    ANOP                                                           22200000
         LH    R14,PARENCNT             GET PARENTHESES COUNT           22300000
         LA    R14,D1(,R14)             BUMP IT BY ONE                  22400000
         STH   R14,PARENCNT             AND SAVE                        22500000
         B     CALC2                    EXIT                            22600000
         SPACE                                                          22700000
*                        (10) RIGHT PARENTHESIS                       * 22800000
         SPACE                                                          22900000
         AIF   ('&ID' EQ 'X5V').X5V5                                    23000000
RTPAREN  BNH   SYNTAXER           0/1 - INVALID SYNTAX                  23100000
         AGO   .X4V5                                                    23200000
.X5V5    ANOP                                                           23300000
RTPAREN  BNH   SYNERR6            0/1 - INVALID SYNTAX                  23400000
.X4V5    ANOP                                                           23500000
         GOIF  NOPAREN,EQUAL=BLANK2,ELSE=CALC     MAY BE END OF OPERAND 23600000
         SPACE                                                          23700000
*                        (11) BLANK OR COMMA                          * 23800000
         SPACE                                                          23900000
         AIF   ('&ID' EQ 'X5V').X5V6                                    24000000
BLANK    BNH   SYNTAXER           0/1 - PREMATURE END OF EXPRESSION     24100000
BLANK1   GOIF  NOPAREN,HIGH=SYNTAXER    UNBALENCED PARENTHESES          24200000
         AGO   .X4V6                                                    24300000
.X5V6    ANOP                                                           24400000
BLANK    BNH   SYNERR6                  PREMATURE END OF EXPRESSION     24500000
BLANK1   GOIF  NOPAREN,HIGH=SYNERR6     OR UNBALANCED PARENTHESIS       24600000
.X4V6    ANOP                                                           24700000
BLANK2   SET   ENDOFEXP,ON              SET END-OF-EXPRESSION INDICATOR 24800000
         EJECT                                                          24900000
*                        ARITHMETIC CALCULATION                       * 25000000
         SPACE                                                          25100000
CALC     SET   DEL1                     FORCE COMPUTATION               25200000
CALC1    CL    R4,AOPTR                 READY TO GO TO WORK             25300000
         BH    CALC6                    YEAH                            25400000
         GOIF  ENDOFEXP,ON=FINIS1       LEAVE IF FINISHED               25500000
CALC2    LA    R4,NEWOP                 BUMP OPERATOR STACK POINTER     25600000
CALC3    LA    R5,CHAR2                 POINT TO NEXT CHARACTER         25700000
         B     SCAN                     LOOK FOR NEXT TERM OR OPERATOR  25800000
CALC4    GOIF  DEL0,HIGH=WORK           GO TO WORK                      25900000
         LH    R14,PARENCNT             GET PARENTHESES LEVEL           26000000
         BCT   R14,CALC41               SEE IF WITHOUT                  26100000
         GOIF  SUBLIST,ON=FINIS         PROCESSING MODIFIER EXPRESSIONS 26200000
CALC41   STH   R14,PARENCNT             SAVE PARENTHESES LEVEL COUNTER  26300000
CALC5    BCTR  R4,0                     POP OPERATOR STACK              26400000
         B     CALC3                    GO SCAN SOME MORE               26500000
CALC6    CLC   NEWOP,OLDOP              DO WE HAVE TO GO                26600000
         BNH   CALC4                    MAYBE NOT                       26700000
         SPACE                                                          26800000
*                        REDUCE HIERARCHY TO THREE LEVELS             * 26900000
         SPACE                                                          27000000
         GOIF  SUB1,NOTEQ=CALC7   '-' - SUBTRACTION                     27100000
         GOIF  ADD0,EQUAL=WORK    '+' - ADDITION                        27200000
CALC7    GOIF  DIV1,NOTEQ=CALC2   '/' - DIVISION                        27300000
         GOIF  MUL0,NOTEQ=CALC2   '*' - MULTIPLICATION                  27400000
         SPACE                                                          27500000
*                        PERFORM ARITHMETIC OPERATION ON LAST 2 TERMS * 27600000
         SPACE                                                          27700000
WORK     LA    R14,TERM2+L'TERM2-TERM1CNT    GET LENGTH OF TWO TERMS    27800000
         SR    R2,R14                   POINT TO FIRST OF TWO TERMS     27900000
         L     R1,TERM2                 GET THE SECOND TERM             28000000
         LR    R11,R3                   SAVE POINTER                    28100000
         LR    R10,R3                   SAVE POINTER                    28200000
         SH    R3,TERM2CNT+2            POINT TO BEGINNING FOR RLIST2   28300000
         LR    R15,R3                   SAVE POINTER                    28400000
         GOIF  UNY0,EQUAL=UNARY         UNARY                           28500000
         LR    R0,R3                    SAVE                            28600000
         SH    R3,TERM1CNT+2            POINT TO BEGINNING OF RLIST1    28700000
         SR    R11,R3                   GET LENGTH OF ENTIRE LIST       28800000
         STH   R11,TERM1CNT+2           FOR NEW LENGTH                  28900000
         GOIF  SUB0,HIGH=MULTDIV,EQUAL=SUBTRACT   +,- VS *,/            29000000
         SPACE                                                          29100000
*                        ADJUST RELOCATION INFORMATION                * 29200000
         SPACE                                                          29300000
RELOC    LH    R11,ESDID                GET NEXT ESDID FROM RLIST       29400000
         GOIF  (R11),ZERO=RELOC4        SKIP TEST IF ZERO               29500000
         AH    R11,ESDID-ESDID(,R15)    SEE IF MATCH FOUND              29600000
         BZ    RELOC2                   THIS PAIR CANCELS               29700000
RELOC1   LA    R15,NEXTESD-ESDID(,R15)  POINT TO NEXT ESDID IN RLIST2   29800000
         GOIF  (R15),(R10),NOTEQ=RELOC,ELSE=RELOC3     END OF LIST      29900000
RELOC2   STH   R11,ESDID                INDICATE CANCELLED              30000000
         STH   R11,ESDID-ESDID(,R15)    INDICATE CANCELLED              30100000
         IC    R15,RELOCTR              GET COUNT OF RELOCATABLE TERMS  30200000
         BCTR  R15,0                    DECREMENT COUNT BY 2            30300000
         BCTR  R15,0                    X                               30400000
         STC   R15,RELOCTR              SAVE                            30500000
RELOC3   LR    R15,R0                   POINT TO BEGINNING OF RLIST2    30600000
RELOC4   LA    R3,NEXTESD               POINT TO NEXT ESDID IN RLIST1   30700000
         GOIF  (R3),(R0),NOTEQ=RELOC    END OF LIST                     30800000
         SPACE                                                          30900000
*                        ADDITION                                     * 31000000
         SPACE                                                          31100000
         A     R1,TERM1                 ADD THE TWO TERMS               31200000
         BNO   STORE                    GO IF NO OVERFLOW               31300000
OVERFLOW SET   OVERFLO,ON               SET OVERFLOW BIT                31400000
         AIF   ('&ID' NE 'X5V').X4VO                                    31500000
         X5ERRL 235,CLMPTR              ARITHMETIC OVERFLOW             31600000
.X4VO    ANOP                                                           31700000
STORE    ST    R1,TERM1                 STORE RESULT                    31800000
         LA    R2,TERM2CNT              POINT TO NEXT TERM ENTRY SPACE  31900000
         LR    R3,R10                   POINT TO NEXT RLIST ENTRY SPACE 32000000
         MVC   OLDOP,NEWOP              REDUCE STACK                    32100000
         BCTR  R4,0                     DECREMENT OPERATOR STACK        32200000
         B     CALC1                    ALL DONE FOR NOW                32300000
         SPACE                                                          32400000
*                        MULTIPLICATION OR DIVISION                   * 32500000
         SPACE                                                          32600000
MULTDIV  BCTR  R11,0                    GET MACHINE LENGTH              32700000
         EX    R11,ABSCHECK             ABSCHECK NC    ESDID(0),ESDID   32800000
         BZ    MULTDIV1                 NO RELOCATABLE TERMS            32900000
         SET   RELOCER,ON               RELOCATABLE TERM IN OPERATION   33000000
         AIF   ('&ID' NE 'X5V').X4VR                                    33010000
         X5ERRL 217,CLMPTR              RELOCATION ERROR                33020000
.X4VR    ANOP                                                           33030000
MULTDIV1 GOIF  (R1),ZERO=STORE          RESULT IS ZERO IF TERM2 IS ZERO 33100000
         L     R14,TERM1                GET FIRST TERM                  33200000
         SRDA  R14,32                   PROPAGATE SIGN                  33300000
         GOIF  MUL0,EQUAL=MULTIPLY      MULTIPLICATION OR DIVISION      33400000
         SPACE                                                          33500000
*                        DIVISION                                     * 33600000
         SPACE                                                          33700000
         DR    R14,R1                   DIVISION                        33800000
         LR    R1,R15                   PASS RESULT                     33900000
         B     STORE                    STORE RESULT                    34000000
         SPACE                                                          34100000
*                        MULTIPLICATION                               * 34200000
         SPACE                                                          34300000
MULTIPLY MR    R14,R1                   PERFORM MULTIPLICATION          34400000
         LTR   R1,R15                   TEST AND PASS RESULT            34500000
         BNL   SIGNCHK                  SKIP COMPLEMENT IF POSITIVE     34600000
         LCR   R14,R14                  COMPLEMENT                      34700000
         BCTR  R14,0                    MAKE ZERO                       34800000
SIGNCHK  GOIF  (R14),ZERO=STORE,NOTZERO=OVERFLOW  TEST FOR OVERFLOW     34900000
         EJECT                                                          35000000
*                        SUBTRACTION                                  * 35100000
         SPACE                                                          35200000
UNARY    LA    R2,TERM2CNT              GOT NOTHING TO DO WITH TERM 1   35300000
SUBTRACT LCR   R1,R1                    COMPLEMENT TERM2                35400000
         BO    OVERFLOW                 CHECK FOR OVERFLOW              35500000
LESS     LH    R11,ESDID-ESDID(,R15)    GET NEXT ESDID FROM RLIST2      35600000
         LCR   R11,R11                  COMPLEMENT IT                   35700000
         STH   R11,ESDID-ESDID(,R15)    AND PUT IT BACK                 35800000
         LA    R15,NEXTESD-ESDID(,R15)  CONTINUE WITH REST OF RLIST2    35900000
         GOIF  (R15),(R10),LOW=LESS     NOT DONE YET                    36000000
         LR    R15,R0                   RESTORE TO BEGINNING OF RLIST2  36100000
         GOIF  UNY0,NOTEQ=RELOC,ELSE=STORE   ALL DONE IF UNARY          36200000
         SPACE                                                          36300000
*                        CHECK FOR SELF DEFINING VALUES               * 36400000
         SPACE                                                          36500000
ALPHANUM GOIF  STATUS1,HIGH=BLANK1      MAY BE END OF EXPRESSION        36600000
         CLI   CHAR1,JA                 SEE IF CHARACTER 'A'            36750000
         BL    DECIMAL            0-9 - DECIMAL SELF DEFINING VALUE     36760000
         LR    R14,R5                   SAVE COLUMN POINTER             36800000
         CLI   CHAR2,JQUOTE             IS NEXT CHARACTER A '           36900000
         BNE   SYM                      MAYBE WE'VE HIT UPON A SYMBOL   36950000
         AIF   ('&ID' EQ 'X5V').X5V7                                    37000000
         GOIF  LNGQUOTE,ON=SYNTAXER     L' FOLLOWED BY ANYTHING IS BAD  37100000
         AGO   .X4V7                                                    37200000
.X5V7    GOIF  LNGQUOTE,ON=SYNERR2      INVALID LENGTH ATTR REFERENCE   37300000
.X4V7    ANOP                                                           37400000
         LA    R5,CHAR3                 ADVANCE COLUMN POINTER          37500000
         GOIF  BQUOTE,EQUAL=BINARY      PROCESS IF BINARY TYPE          37600000
         GOIF  CQUOTE,EQUAL=CHARACTR    PROCESS IF CHARACTER TYPE       37700000
         GOIF  XQUOTE,EQUAL=HEXADEC     PROCESS IF HEXADECIMAL TYPE     37800000
         AIF   ('&ID' EQ 'X5V').X5V8                                    37900000
         GOIF  LQUOTE,NOTEQ=SYNTAXER    ILLEGAL CHARACTER IN EXPRESSION 38000000
         AGO   .X4V8                                                    38100000
.X5V8    GOIF  LQUOTE,NOTEQ=SYNERR1     ILLEGAL CHARACTER IN EXPRESSION 38200000
.X4V8    ANOP                                                           38300000
         SET   LNGQUOTE,ON              INDICATE ATTRIBUTE REFERENCE    38400000
         B     SCAN                     LOOK FOR SYMBOL                 38500000
         EJECT                                                          38600000
*                        DECIMAL SELF-DEFINING VALUE                  * 38700000
         SPACE                                                          38800000
DECOFLO  SET   SDVSIZE,ON               SELF DEFINING VALUE TOO LARGE   38900000
         AIF   ('&ID' EQ 'X5V').X5V9                                    39000000
DECIMAL  GOIF  LNGQUOTE,ON=SYNTAXER     DECIMAL AFTER L' ISN'T KOSHER   39100000
         AGO   .X4V9                                                    39200000
.X5V9    ANOP                                                           39300000
         X5ERRL 235,CLMPTR              OVERFLOW ERROR                  39350000
DECIMAL  GOIF  LNGQUOTE,ON=SYNERR2      INVALID LENGTH ATTR REFERENCE   39400000
.X4V9    ANOP                                                           39500000
         SR    R1,R1                    SR    R1,R1                     39600000
         LR    R0,R1                    ZERO DIGIT VALUE                39700000
         LR    R10,R1                   ZERO DIGIT COUNT                39800000
         LA    R15,MAXDEC               GET MAXIMUM DIGIT COUNT         39900000
DECIMAL1 CLI   CHAR1,J9                 SEE IF CHARACTER '9'            40050000
         BH    DIGITCHK                 NOT NUMERIC                     40060000
         LA    R10,D1(,R10)             COUNT DIGIT                     40100000
         LR    R14,R1                   SAVE CURRENT TOTAL              40200000
         SLA   R1,3                     MULTIPLY BY EIGHT               40300000
         BO    DECOFLO                  OVERFLOW ONE FULLWORD           40400000
         IC    R0,CHAR1                 GET DIGIT                       40500000
         AR    R14,R14                  DOUBLE                          40600000
         AR    R14,R0                   PLUS NEXT DIGIT                 40700000
         AR    R1,R14                   GRAND TOTAL                     40800000
         BO    DECOFLO                  SELF DEFINING VALUE TOO LARGE   40900000
         LA    R5,CHAR2                 POINT TO NEXT DIGIT             41000000
         B     DECIMAL1                 GO SOME MORE                    41100000
         SPACE                                                          41200000
*                        BINARY SELF-DEFINING VALUE                   * 41300000
         SPACE                                                          41400000
BINARY   LA    R14,SHIFTB               GET BINARY SHIFT VALUE          41500000
         GOTO  SDVEVAL                  GO EVALUATE SELF DEFINING TERM  41600000
         LA    R15,MAXBIT               GET MAXIMUM NUMBER OF BITS      41700000
         B     DELIMCHK                 PERFORM VALIDITY TESTS          41800000
         SPACE                                                          41900000
*                        CHARACTER SELF-DEFINING VALUE                * 42000000
         SPACE                                                          42100000
CHARACTR LA    R14,SHIFTC               GET CHARACTER SHIFT VALUE       42200000
         GOTO  SDVEVAL                  GO EVALUATE SELF DEFINING TERM  42300000
         LA    R15,MAXCHAR              GET MAXIMUM NUMBER OF CHARACTER 42400000
         ST    R1,JFWORD1               PUT VALUE IN STORAGE            42500000
         TR    JFWORD1,JTRTABLE         TRANSLATE TO EBCDIC             42600000
         L     R1,JFWORD1               PASS RESULT IN REGISTER         42700000
         B     DELIMCHK                 PERFORM VALIDITY TESTS          42800000
         SPACE                                                          42900000
*                        HEXADECIMAL SELF-DEFINING VALUE              * 43000000
         SPACE                                                          43100000
HEXADEC  LA    R14,SHIFTH               GET HEXADECIMAL SHIFT VALUE     43200000
         GOTO  SDVEVAL                  GO EVALUATE SELF DEFINING TERM  43300000
         LA    R15,MAXHEX               GET MAXIMUM NUMBER OF HEX DIGIT 43400000
         EJECT                                                          43500000
*                        VALIDITY TESTS                               * 43600000
         SPACE                                                          43700000
         AIF   ('&ID' EQ 'X5V').X5V10                                   43800000
DELIMCHK CLI   CHAR1,JQUOTE             SEE IF CHARACTER '''            43950000
         BNE   SYNTAXER                 INVALID DELIMITER               43960000
         AGO   .X4V10                                                   44000000
.X5V10   ANOP                                                           44100000
DELIMCHK CLI   CHAR1,JQUOTE             SEE IF CHARACTER '''            44150000
         BNE   SYNERR8                  INVALID DELIMITER               44200000
.X4V10   ANOP                                                           44300000
         LA    R5,CHAR2                 ADVANCE COLUMN POINTER          44400000
         GOIF  (R10),ZERO=EMPTYSDV      NULL BETWEEN QUOTES             44500000
DIGITCHK GOIF  (R10),(R15),NOTHIGH=ABSOLUTE  CHECK FOR MAXIMUM DIGITS   44600000
EMPTYSDV SET   SDVSIZE,ON               ERROR                           44700000
         AIF   ('&ID' NE 'X5V').X4V16                                   44750000
         X5ERRL 169,CLMPTR              INVALID SELF-DEFINING TERM      44760000
.X4V16   ANOP                                                           44770000
ABSOLUTE SR    R0,R0                    ESDID                           44800000
         SET   LNGQUOTE,OFF             NOT APPLICABLE FROM NOW ON      44900000
         SPACE                                                          45000000
*                        CLEANUP                                      * 45100000
         SPACE                                                          45200000
CLEANUP  LA    R15,D1                   LENGTH ATTRIBUTE OF TERM        45300000
CLEANUP1 CL    R3,EVALREGS              SEE IF MAXIMUM TERMS            45400000
         AIF   ('&ID' EQ 'X5V').X5V11                                   45500000
         BNL   SYNTAXER                 OF 20 EXCEEDED                  45600000
         AGO   .X4V11                                                   45700000
.X5V11   BNL   SYNERR9                  TOO MANY TERMS                  45800000
.X4V11   ANOP                                                           45900000
         STH   R0,ESDID                 SAVE ESDID                      46000000
         ST    R1,TERM1                 VALUE TO TERM1                  46100000
         MVI   TERM1CNT+D3,L'RLIST      COUNT IS LENGTH OF ONE ENTRY    46200000
         LA    R2,TERM2CNT              ADVANCE POINTER TO NEXT ENTRY   46300000
         LA    R3,NEXTESD               ADVANCE POINTER TO NEXT ENTRY   46400000
         SET   STATUS2              2 - TERM                            46500000
         GOIF  (R0),ZERO=CLEANUP2       SEE IF ABSOLUTE TERM            46600000
         IC    R14,RELOCTR              GET COUNT OF RELOCATABLE TERMS  46700000
         LA    R14,1(,R14)              BUMP THE COUNT BY 1             46800000
         STC   R14,RELOCTR              SAVE THE COUNT                  46900000
CLEANUP2 TS    FIRST                    SEE IF THIS IS THE FIRST TERM   47000000
         BNZ   SCAN                     GO ON IF NOT                    47100000
         STH   R15,IMPLNG               LENGTH ATTRIBUTE OF EXPRESSION  47200000
         TS    SELFDEFN                 SDV EXPECTED                    47300000
         BNZ   SCAN                     NOT PARTICULAR, GO ON           47400000
         B     FINIS1                   YES, MY JOB IS DONE             47500000
         EJECT                                                          47600000
*                        SELF-DEFINING VALUE EVALUATION               * 47700000
         SPACE                                                          47800000
SDVEVAL  STC   R14,SHIFTN               SAVE SHIFT VALUE                47900000
         IC    R11,SDVLIMIT-D1(R14)     GET VALID HIGH LIMIT            48000000
         SR    R15,R15                  ZERO REGISTERS                  48100000
         LR    R10,R15                  ZERO DIGIT COUNTER              48200000
         LR    R1,R15                   ZERO ACCUMULATOR                48300000
         GOIF  SHIFTC,NOTEQ=SDVEVAL1    SHIFT                           48400000
         L     R1,BCDZEROS              GET EXTERNAL ZEROS              48500000
SDVEVAL1 EX    R11,CHAR1CLI             CLI   CHAR1,0                   48600000
         BHR   R9                       EXIT ON HIGH                    48700000
         IC    R15,CHAR1                GET NEXT CHARACTER              48800000
         GOIF  SHIFTC,NOTEQ=SDVEVAL4    CHARACTER SELF DEFINING TERM    48900000
         CLI   CHAR1,JQUOTE             SEE IF CHARACTER '''            49050000
         BNE   SDVEVAL2                 NO, SEE IF CHARACTER '&'        49060000
         CLI   CHAR2,JQUOTE             SEE IF CHARACTER ''''           49070000
         BE    SDVEVAL3                 YES, TREAT AS ONE               49080000
         BR    R9                       OR ELSE IT COULD BE END OF TERM 49090000
SDVEVAL2 CLI   CHAR1,JAMPER             SEE IF CHARACTER '&'            49250000
         BNE   SDVEVAL4                 NO, JUST ANY OTHER CHARACTER    49260000
         AIF   ('&ID' EQ 'X5V').X5V12                                   49300000
         CLI   CHAR2,JAMPER             SEE IF CHARACTER '&&'           49450000
         BNE   SYNTAXER                 NO, ILLEGAL USE OF AMPERSAND    49460000
         AGO   .X4V12                                                   49500000
.X5V12   CLI   CHAR2,JAMPER             SEE IF CHARACTER '&&'           49650000
         BNE   SYNERR10                 NO, ILLEGAL USE OF AMPERSAND    49660000
.X4V12   ANOP                                                           49700000
SDVEVAL3 LA    R5,CHAR2                 ADVANCE COLUMN POINTER          49800000
SDVEVAL4 SLL   R1,D0(R14)               SHIFT BY SPECIFIED VALUE        49900000
         ALR   R1,R15                   ADD TO ACCUMULATOR              50000000
         LA    R10,D1(,R10)             KEEP COUNT OF DIGITS            50100000
         LA    R5,CHAR2                 POINT TO NEXT CHARACTER         50200000
         B     SDVEVAL1                 LOOP                            50300000
         SPACE                                                          50400000
*                        SYNTAX ERROR IN EXPRESSION                   * 50500000
         SPACE                                                          50600000
SYNTAXER SET   FATALER,ON               SYNTAX ERRORS ARE FATAL         50700000
         EJECT                                                          50800000
*                        SET RETURN CONDITION CODE                    * 50900000
         SPACE                                                          51000000
FINIS    LA    R5,CHAR2                 POINT PAST CHARACTER            51100000
FINIS1   L     R11,TERMS+TERM1-TERM1CNT PASS RESULT IN PARAMETER REG    51200000
         SET   (SUBLIST,DCOP),OFF       RESET                           51300000
         TS    SELFDEFN                 RESET                           51400000
         SR    R10,R10                  ABSOLUTE TERM IF EVALUATION ERR 51500000
         GOIF  FATALER,ON=FINIS3    3 - SYNTAX ERROR                    51600000
         TM    EVALSW1,BITFF            ANY ERROR IN EXPRESSION         51700000
         BM    FINIS3               1 - ERROR IN EXPRESSION             51800000
         GOIF  NORELOC,EQUAL=FINIS3 0 - ABSOLUTE EXPRESSION             51900000
         TM    RELOCTR,BITFF-1          MORE THAN ONE RELOCATABLE TERM  52000000
         BM    FINIS3                   NO, COMPLEXLY RELOCATABLE       52100000
         LA    R3,RLIST-L'RLIST         START AT HEAD OF LIST           52200000
FINIS2   LA    R3,NEXTESD               POINT TO NEXT ITEM              52300000
         LH    R10,ESDID                PICK IT UP                      52400000
         GOIF  (R10),ZERO=FINIS2    0 - NOT RELOCATABLE TERM            52500000
         SPACE                                                          52600000
*NOTES-  WHEN THE ONE AND ONLY RELOCATABLE TERM IS FOUND, WHETHER IT  * 52700000
*   IS SIMPLY OR COMPLEXLY RELOCATABLE, IT WILL FALL THROUGH THIS     * 52800000
*   POINT AND RETURN TO THE CALLER WITH THE PROPER CONDITION CODE     * 52900000
*   SETTING.                                                          * 53000000
         SPACE                                                          53100000
FINIS3   LR    R14,R5                   RETURN COLUMN POINTER           53200000
         B     EXIT                     EXIT                            53300000
         EJECT                                                          53400000
*                        SPECIAL CHARACTER GO TO TABLE                * 53500000
         SPACE                                                          53600000
GOTOTBL  EQU   *                        ORIGIN OF GO-TO TABLE           53700000
         DC    YL1(LFPAREN-GOTO)              ( - LEFT PARENTHESIS      53800000
         DC    YL1(PLUS-GOTO)                 + - PLUS SIGN             53900000
         DC    YL1(MINUS-GOTO)                - - MINUS SIGN            54000000
         DC    YL1(ASTERISK-GOTO)             * - ASTERISK              54100000
         DC    YL1(SLASH-GOTO)                / - SLASH                 54200000
         DC    YL1(RTPAREN-GOTO)              ) - RIGHT PARENTHESIS     54300000
         DC    YL1(COMMA-GOTO)                , - COMMA                 54400000
         DC    YL1(BLANK-GOTO)                  - BLANK                 54500000
         SPACE                                                          54600000
PLUS     EQU   GOTO                     X                               54700000
MINUS    EQU   GOTO                     X                               54800000
COMMA    EQU   BLANK                    X                               54900000
         SPACE                                                          55000000
*                        CONSTANTS                                    * 55100000
         SPACE                                                          55200000
         LTORG                                                          55300000
BCDZEROS DC    C'0000'                  PAD                             55400000
ABSCHECK NC    ESDID(0),ESDID           EXECUTED INSTRUCTION            55500000
CHAR1CLI CLI   CHAR1,D0                 EXECUTED INSTRUCTION            55600000
SDVLIMIT DC    X'0100000F000000FF'      LIMITS OF VALID CHARACTERS FOR- 55700000
*                /     /       /............ CHARACTER                  55800000
*               /     /..................... HEXADECIMAL                55900000
*              /............................ BINARY                     56000000
         EJECT                                                          56100000
*                        LOOKUP SYMBOL                                * 56200000
         SPACE                                                          56300000
DEFNERR  SET   NOTDEFN,ON               UNDEFINED SYMBOL                56400000
         SR    R1,R1                    DEFAULT VALUE TO ZERO           56500000
         B     ABSOLUTE                 GO ON                           56600000
SYM      LA    R5,CHAR2                 POINT TO NEXT CHARACTER         56700000
         CLI   CHAR1,JEQUAL             SEE IF ALPHAMERIC               56850000
         BL    SYM                      LOOK FOR DELIMITER              56860000
         LR    R15,R5                   GET ADDRESS OF DELIMITER        56900000
         SR    R15,R14                  MINUS FIRST CHARACTER ADDRESS   57000000
         BCTR  R15,D0                   YIELD LENGTH OF SYMBOL          57100000
         CH    R15,=H'7'                SYMBOL TOO LONG                 57200000
         AIF   ('&ID' NE 'X4V').NOTX4V1                                 57300000
         BH    SYNTAXER                 SYMBOL LENGTH GREATER THAN 8    57400000
         MVC   XNAME,=8AL1(JBLANK)      PAD                             57500000
         EX    R15,NAMEMOVE             PASS SYMBOL                     57700000
         GOIF  DCOP,OFF=SYM0            SKIP IF NOT DC                  57800000
         LH    R14,SYMCOUNT             GET SYMBOL COUNT                57900000
         LA    R14,D1(,R14)             INCREMENT IT BY 1               58000000
         STH   R14,SYMCOUNT             SAVE                            58100000
         GOIF  LTORGSCN,OFF=SYM0        SKIP IF NOT PROCESSING LTORG    58200000
         GOTO  REFER                    GO GENERATE A REFERENCE RECORD  58300000
SYM0     LA    R10,XWORK                ADDRESS OF SYMBOL               58360000
         GOTO  FIND                     LOOKUP IN SYMBOL TABLE          58420000
         BNZ   SYM2                     NOT FOUND                       58500000
         GOIF  ESW,OFF=SYM05            CHECK EXTRN/EQU FLAG    OX00106 58550002
         LA    R10,XWORK                MAKE SURE R10 POINTS OK OX00106 58570002
         OI    XESDI-XWORK(R10),ESW     TRANSFER EXTRN/EQU FLAG OX00106 58580002
SYM05    EQU   *                                                OX00106 58590002
         GOIF  ENTRYSW,ON=DEFNERR       NOT DEFINED                     58600002
         LA    R1,D1                    LENGTH ATTRIBUTE                58700000
         GOIF  ESDNRSW,ON=SYM1          FOR EXTERNAL SYMBOLS            58800000
         LH    R1,SLNGQ                 LENGTH ATTRIBUTE FOR OTHERS     58900000
         SLL   R1,16                    MAY BE A 16 BIT        @VM05316 58930000
         SRL   R1,16                    POSITIVE NUMBER        @VM05316 58950000
SYM1     GOIF  LNGQUOTE,ON=SYM4         LENGTH ATTRIBUTE REFERENCE      59000000
         LR    R15,R1                   PASS LENGTH ATTRIBUTE           59100000
         LH    R0,SESDI                 ESDID                           59200000
         L     R1,SLCTR                 VALUE                           59300000
         B     CLEANUP1                 CLEANUP                         59400000
SYM4     GOIF  LNGDEF,OFF=ABSOLUTE      ILLEGAL LENGTH ATTRIBUTE        59450000
SYM2     GOIF  LTORGSCN,ON=DEFNERR      UNDEFINED                       59500000
         GOIF  IOFLO,OFF=DEFNERR        UNDEFINED                       59600000
         GOIF  INOTE,OFF=SYM5           SEE IF REWIND NECESSARY         59660000
         LH    R10,JINFILE              INPUT FILE ADDRESS              59720000
         JPOINT  FILE=(R10),ADDR=INOTEVAL,NEXT=GET     REPOSITION FILE  59780000
SYM5     LH    R10,JINFILE              GET INPUT FILE ADDRESS          59840000
         JGETL FILE=(R10)               READ NEXT RECORD                59900000
         GOIF  INOTE,ON=SYM6            SEE IF ALREADY NOTED            59960000
         SET   INOTE,ON                 INDICATE FILE NOTED             60020000
         ST    R11,INOTEVAL             SAVE RECORD POINTER             60080000
         LH    R10,JINFILE              GET INPUT FILE ADDRESS          60140000
         JNOTE FILE=(R10)               NOTE FILE POSITION              60200000
         L     R11,INOTEVAL             GET RECORD POINTER              60260000
         MVC   INOTEVAL,JNOTEVAL        SAVE NOTED ADDRESS              60320000
SYM6     CLC   XNAME,XNAME-XWORK(R11)   SEE IF CORRESPONDING RECORD     60380000
         BNE   SYM5                     IF NOT, TRY AGAIN               60440000
SYM3     TM    XFLDI-XWORK(R11),DEFINED                                 60490000
DEFINED  EQU   BIT1                                                     60540000
         BZ    DEFNERR                  UNDEFINED                       60600000
         GOIF  LTCALL,OFF=SYM7          SEE IF PROCESSING LITERAL       60620000
         LR    R10,R11                  PASS TO ENTER                   60640000
         ST    R10,JFWORD1              SAVE                            60660000
         GOTO  ENTER                    ENTER IN SYMBOL TABLE           60680000
         L    R11,JFWORD1               RESTORE POINTER                 60700000
SYM7     LH    R1,XLNGQ-XWORK(,R11)     LENGTH                          60720000
         GOIF  LNGQUOTE,ON=ABSOLUTE     THAT'S ALL WE'RE INTERESTED IN  60800000
         LR    R15,R1                   LENGTH ATTRIBUTE                60900000
         LH    R0,XESDI-XWORK(,R11)     ESDID                           61000000
         L     R1,XLCTR-XWORK(,R11)     VALUE                           61100000
         B     CLEANUP1                 FINIS                           61200000
NAMEMOVE MVC   XNAME(0),CHAR1-CHAR1(R14)     EXECUTED INSTRUCTION       61300000
         MEXIT                                                          61400000
.NOTX4V1 BH    SYNERR1                  SYMBOL LENGTH > 8               61500000
         GOIF  (JXREF,JLIST),NOTALL=SYM01  CHECK IF CROSS-REFERENCE     61600000
         GOIF  XRFNO,OFF=SYM01          IS XREF TO BE MADE              61700000
         LH    R10,JOUTFILE             GET OUTPUT FILE NUMBER          61800000
         JPUTL FILE=(R10),BUFREQ=XRFND  GET BUFFER                      61900000
         LR    R6,R11                   SAVE BUFFER POINTER             62000000
SYM01    EQU   *                        BRANCH LABEL                    62100000
         LH    R10,JINFILE              GET FILE NUMBER                 62200000
         JGETL FILE=(R10)               GET FROM FILE                   62300000
         GOIF  NOTEWL,OFF=SYM02         SHOULD WE NOTE SYMBOL LOCATION  62400000
         ST    R11,JFWORD1              SAVE SYMBOL FILE PTR    OX02953 62500003
         SET   NOTEHS,ON                YES, FIRST SET POINT INDICATOR  62600000
         SET   NOTEWL,OFF               SET NOTE SWITCH OFF             62700000
         LH    R10,JINFILE              POINT INPUT FILE                62800000
         JNOTE FILE=(R10)               NOTE SYMBOL LOCATION FOR RESCAN 62900000
         MVC   NOTEVAL,JNOTEVAL         SAVE NOTE VALUE                 63000000
         L     R11,JFWORD1              RESTORE SYMBOL FILE PTR OX02953 63100003
SYM02    EQU   *                        BRANCH LABEL                    63200000
         USING XRFIN,R6                 CREATE                          63300000
         GOIF  XRFNO,OFF=SYM03          XREF NECESSARY                  63500000
         GOIF  (JXREF,JLIST),NOTALL=SYM03 !OTH OPTIONS MUST BE ON       63600000
         SET   JXREFCHK,ON              THEY ARE SET XREF SWITCH ON     63700000
         MVC   XRECLN(D6),=AL2(XRFND,0,XRFTYPE*256) CROSS REFERENCE     63800000
         MVC   XRFSYM,RNAME               RECORD                        63900000
         MVI   XRFFLG,REF                   NAME, TYPE                  64000000
         MVC   XRFSTM,STMTN+D2                AND STATEMENT NUMBER      64100000
SYM03    EQU   *                        BRANCH LABEL                    64200000
         L     R6,SYMXRF                GET NUMBER  THUS FAR    OX02675 64300003
         LA    R6,D1(,R6)               ADD 1                           64400000
         ST    R6,SYMXRF                SAVE NEW CNT THIS CARD  OX02675 64500003
         GOIF  (PRIORDEF,DEFINED),ALL=SYM1,NONE=SYMR1  IS IT DEFINED    64600000
         GOIF  PRDEFREQ,ON=SYMR2        PRIOR DEFINITION REQUIRED       64700000
SYM1     EQU   *                                               @OY08064 64800005
         GOIF  EQUF1,ON=SYNERR2         LENGTH ATTR ERROR      @OY08064 64810005
         XC    JFWORD1,JFWORD1          ALIGN LENGTH ATTR      @OY08064 64820005
         MVC   JFWORD1+D2(D2),RLNGQ     A FULLWORD AREA                 64830000
         L     R1,JFWORD1               GET LENGTH ATTRIBUTE            64860000
         GOIF  LNGQUOTE,ON=ABSOLUTE     LENGTH ATTRIBUTE REFERENCE      64900000
         LR    R15,R1                   LENGTH ATTRIBUTE OF SYMBOL      65000000
         LH    R0,RESDI                 ESDID OF SYMBOL                 65100000
         L     R1,RLCTR                 VALUE OF SYMBOL                 65200000
         B     CLEANUP1                 GO BACK                         65300000
SYNERR1  X5ERRL 236,CLMPTR,SYNTAXER     ILLEGAL CHARACTER               65400000
SYNERR2  X5ERRL 120,CLMPTR,SYNTAXER     INVALID LENGTH ATTR REFERENCE   65500000
SYNERR3  X5ERRL 170,CLMPTR,SYNTAXER     CONSECUTIVE OPERATOR            65600000
SYNERR4  X5ERRL 233,CLMPTR,SYNTAXER     TOO MANY LEVELS OF PARENS       65700000
SYNERR6  X5ERRL 234,CLMPTR,SYNTAXER     PREMATURE END OF EXPRESSION     65800000
SYNERR8  X5ERRL 240,0,SYNTAXER          MISSING QUOTE                   65900000
SYNERR9  X5ERRL 168,0,SYNTAXER          TOO MANY TERMS                  66000000
SYNERR10 X5ERRL 238,CLMPTR,SYNTAXER     ILLEGAL USE OF &                66100000
SYNERR11 X5ERRL 187,CLMPTR,SYNTAXER     SYMBOL LENGTH > 8               66200000
SYMR1    ST    R11,ERRPTR                                               66300000
         X5ERRL 188,DTAPTR,DEFNERR      UNDEFINED SYMBOL                66400000
         JEXTRN (X5L01=LOGERR)          DEFINE EXTERNAL SYMBOL          66500000
SYMR2    ST    R11,ERRPTR                                               66600000
         X5ERRL 231,DTAPTR,DEFNERR      SYMBOL NOT PREVIOUSLY DEFINED   66700000
EXIT     JRETURN                                                        66900000
         MEND                                                           67100000
./  ADD  SSI=71710281,NAME=XFOUR
         MACRO                                                          00080000
&ID      XFOUR &DUMMY,&TESTRAN=NO,&DIAG=NO,&LEVEL=1                     00160000
         GBLC  &COMPNM                  COMPONENT NAME                  00240000
         LCLC  &NM                      MODULE NAME                     00320000
         JHEAD 'SYMBOL RESOLUTION PHASE MAIN LINE CONTROL',            ,00400000
               PHASEID=&ID,                                            ,00480000
               LEVEL=&LEVEL                                             00560000
&NM      SETC  '&COMPNM'.'&ID'                                          00640000
*TITLE-  ASSEMBLER SYMBOL RESOLUTION PHASE                            * 00720000
*                                                                     * 00800000
*FUNCTION/OPERATION-                                                  * 00880000
*        RESOLVE SYMBOLS FOR THE ASSEMBLY PHASE                       * 00960000
*        GENERATE THE EXTERNAL SYMBOL DICTIONARY (ESD)                * 01040000
*        PUNCH RECORDS GENERATED BY 'PUNCH' AND 'REPRO' STATEMENTS    * 01120000
*   BEFORE THE ESD                                                    * 01200000
         AIF   ('&TESTRAN' NE 'YES').PCH                                01280000
*        PUNCH TESTRAN RECORDS                                        * 01360000
.PCH     ANOP                                                           01440000
*                                                                     * 01520000
*ENTRY POINT-                                                         * 01600000
         ENTRY &NM.01                                                 * 01680000
*                                                                     * 01760000
*INPUT-                                                               * 01840000
*        A FILE CREATED BY THE MACRO GENERATOR PHASE CONSISTING OF    * 01920000
*   THE FOLLOWING TYPES OF RECORDS-                                   * 02000000
*        (1)  RECORDS GENERATED BY 'PUNCH' AND 'REPRO' STATEMENTS     * 02080000
*             BEFORE THE ESD                                          * 02160000
*        (2)  SYMBOL DEFINITIONS                                      * 02240000
*        (3)  SYMBOL REFERENCES                                       * 02320000
*        (4)  LITERALS                                                * 02400000
*        (5)  ASSEMBLER OPERATIONS AFFECTING THE ESD OR STORAGE       * 02480000
*             ASSIGNMENT (START, CSECT, DSECT, COM, DXD, ENTRY,       * 02560000
*             EXTRN, WXTRN, EQU, ORG, LTORG, CNOP, DC, DS, END)       * 02640000
*                                                                     * 02720000
*OUTPUT-                                                              * 02800000
*        'PUNCH' AND 'REPRO'  RECORDS ON THE PUNCH FILES              * 02880000
*        THE ESD ON THE PRINT AND PUNCH FILES                         * 02960000
*        THE SYMBOL FILE TO THE ASSEMBLY PHASE                        * 03040000
         AIF   ('&TESTRAN' NE 'YES').PCH2                               03120000
*        TESTRAN RECORDS TO THE PUNCH FILES                           * 03200000
.PCH2    ANOP                                                           03280000
*                                                                     * 03360000
*EXTERNAL ROUTINES-                                                   * 03440000
         AIF   ('&TESTRAN' NE 'YES').EXTRN                              03520000
         EXTRN &COMPNM.X4N01,&COMPNM.X4E01,&COMPNM.X4S01,&COMPNM.X4V01  03600000
         AGO   .EXTRN1                                                  03680000
.EXTRN   EXTRN &COMPNM.X4D01,&COMPNM.X4E01,&COMPNM.X4S01,&COMPNM.X4V01  03760000
.EXTRN1  ANOP                                                           03840000
*             BLDESD-    BUILD CONTROL SECTION ENTRY IN ESD           * 03920000
*             DCSCAN-    EVALUATE DC/DS OPERANDS AND LITERALS         * 04000000
*             XDSCAN-    EVALUATE DXD OPERANDS                        * 04050000
*             ENTRY-     PROCESS ENTRY POINT SYMBOL                   * 04080000
*             EVAL-      EVALUATE EXPRESSION                          * 04160000
*             EXTRN-     PROCESS EXTERNAL REFERENCE SYMBOL            * 04240000
*             FIND-      FIND AN ENTRY IN THE SYMBOL TABLE            * 04320000
*             GETESD-    GET AN ESD ENTRY                             * 04400000
*             MAKESD-    OUTPUT THE ESD                               * 04480000
*             SUBSET-    SUBSET THE SYMBOL TABLE                      * 04560000
*                                                                     * 04640000
*        ROUTINES IN THE CONTROLLER TO PERFORM INPUT/OUTPUT AND OTHER * 04720000
*   SYSTEM DEPENDENT FUNCTIONS-                                       * 04800000
*             JCHECK-    WAIT FOR COMPLETION OF A JREAD OR JWRITE     * 04880000
*             JFRECORE-  RELEASE MAIN STORAGE ALLOCATED BY JGETCORE   * 04960000
*             JGETCORE-  ALLOCATE MAIN STORAGE FOR WORK AREA          * 05040000
*             JGETL-     READ LOGICAL RECORD (LOCATE MODE)            * 05120000
*             JNOTE-     PROVIDE RECORD POSITION                      * 05200000
*             JPOINT-    POSITION TO A RECORD                         * 05280000
*             JPUTL-     WRITE LOGICAL RECORD (LOCATE MODE)           * 05360000
*             JPUTM-     WRITE LOGICAL RECORD (MOVE MODE)             * 05440000
*             JREAD-     READ PHYSICAL RECORD                         * 05520000
*             JWRITE-    WRITE PHYSICAL RECORD                        * 05600000
*                                                                     * 05680000
*EXITS, NORMAL-                                                       * 05760000
*        EXITS TO THE CONTROLLER                                      * 05840000
*                                                                     * 05920000
*EXITS, ERROR-                                                        * 06000000
*        NONE                                                         * 06080000
*                                                                     * 06160000
*TABLES/WORK AREAS-                                                   * 06240000
*        WORK AREA ALLOCATED BY JGETCORE ROUTINE IN THE CONTROLLER    * 06320000
*                                                                     * 06400000
*ATTRIBUTES-                                                          * 06480000
*        REFRESHABLE                                                  * 06560000
*                                                                     * 06640000
*NOTES-                                                               * 06720000
*                                                                     * 06800000
         EJECT                                                          06880000
         COPY  JCOMMON                                                  06960000
         EJECT                                                          07040000
         COPY  JTEXT                                                    07120000
         EJECT                                                          07200000
         COPY  ICOMMON                                                  07280000
         EJECT                                                          07360000
JTEXT    DSECT ,                                                        07440000
         ORG   JTEXT                    OVERLAY                         07520000
         COPY  RSYMRCD                                                  07600000
         EJECT                                                          07680000
* VS1 RELEASE 3.1 CHANGES                                               07730003
*A413300-413520                                                 OX00873 07730405
*C413600                                                        OX00873 07732005
*D257600                                                        OX04097 07734005
*C258400                                                        OX04097 07736005
*A478100-478400                                                 OY02611 07738005
*D479200                                                        OY02611 07738405
*A494700-495920                                                 OY02611 07738805
*A487700-487900,602100-602300                                  @OX07274 07739205
*C488000,602400                                                @OX07274 07739605
*C487900,586400,602100                                         @OX10361 07739705
*A586900-587100                                                @OX10361 07740105
*A338100-338320                                                @OY08064 07741705
*C337600                                                       @OY08064 07742105
*C341600                                                       @PI01040 07743705
*A342100-342200                                                @PI01040 07745705
*A257300                                                       @OY09620 07747705
*C255400,260000                                                @OY09620 07748105
*D478100-478200,495700-495920                                  @OX09723 07758106
*C478400,495200,608800                                         @OX09723 07758506
*A554900,558100,494900-495160,495700,608500-608700             @OX09723 07758906
*A309300-309800                                                @OY10603 07759006
*C256800                                                       @OZ07355 07759406
*C496000                                                       @AX14216 07759506
*C495120                                                       @AZ16488 07759900
*A448100,448200                                                @AZ18392 07760000
&NM.00   CSECT                                                          07780000
         JMODID                                                         07840000
         USING &NM.01,R12                                               07920000
&NM.01   DS    0H                       PHASE ENTRY                     08000000
I        LA    R14,IIII                 DEFINE ENTRY                    08080000
II       JSAVE BASE=NO                  PUSH REGISTERS                  08160000
         BR    R14                      PROCEED                         08240000
III      JRETURN                        PHASE EXIT                      08320000
         AIF   ('&TESTRAN' NE 'YES').X4DA                               08400000
         DC    A(&COMPNM.X4N01,&COMPNM.X4E01,&COMPNM.X4S01,&COMPNM.X4V0X08480000
               1)                       EXTERNAL ROUTINE BASE           08560000
         AGO   .X4NA                                                    08640000
.X4DA    DC    A(&COMPNM.X4D01,&COMPNM.X4E01,&COMPNM.X4S01,&COMPNM.X4V0X08720000
               1)                       EXTERNAL ROUTINE BASE           08800000
.X4NA    ANOP                                                           08880000
IIII     LR    R8,R12                   BASE REGISTER                   08960000
         DROP  R12                                                      09040000
         USING &NM.01,R8                                                09120000
         SPACE                                                          09200000
*                        INITIALIZATION                               * 09280000
         SPACE                                                          09360000
         LH    R11,=Y(MAXDBL)                                           09440000
         JGETCORE  MINDBL=MINDBL,MAXDBL=(R11)  GET STORAGE              09520000
         LR    R7,R10                   INITIALIZE COMMON AREA BASE     09600000
         XC    D0*256(256,R7),D0*256(R7)                                09760000
         XC    D1*256(256,R7),D1*256(R7)                                09840000
         XC    D2*256(256,R7),D2*256(R7)                                09920000
         XC    D3*256(256,R7),D3*256(R7)                                10000000
         XC    D4*256(256,R7),D4*256(R7)                                10080000
         XC    D5*256(256,R7),D5*256(R7)                                10160000
         XC    D6*256(256,R7),D6*256(R7)                                10260000
         XC    D7*256(256,R7),D7*256(R7)                                10310000
         MVC   SAVE(IIII-II),II         INITIALIZE COMMON               10480000
*                                                                       10530000
*        INITIALIZE WORK AREA FOR SYMBOL TABLE ROUTINES                 10540000
*                                                                       10550000
         AR    R11,R10                  POINT TO END OF COMMON          10560000
         LR    R14,R11                  FIRST SYMBOL TABLE ENTRY        10610000
         LR    R15,R11                  X                               10620000
         LH    R0,=H'-20'               INCREMENT                       10630000
         LA    R1,ENDOFCOM+D20*D2       LAST SYMBOL TABLE ENTRY         10700000
         STM   R14,R1,SYMDIMEN          X                               10720000
*                                                                       11090000
*        INITIALIZE WORK AREA FOR LITERAL PROCESSING                    11100000
*                                                                       11110000
         LA    R10,ENDOFCOM             END-OF-COMMON                   11112000
         LA    R11,ENDOFCOM+D20         FIRST LITERAL ENTRY             11114000
         STM   R10,R11,LATADD           ADDRESS OF ADJUSTMENT TABLE     11120000
*                                                                       11330000
*        INITIALIZE WORK AREA FOR ESD PROCESSING                        11340000
*                                                                       11350000
         L     R15,=Y(D20*D16+D4,0)     BLOCK LENGTH                    11352000
         LA    R14,ESDBLK1+D4           GET ADDRESS OF FIRST BLOCK      11360000
         STM   R14,R15,ESDBLK1          PUT IN PARAMETER FOR READ/WRITE 11440000
         LA    R14,ESDBLK2+D4           GET ADDRESS OF SECOND BLOCK     11520000
         STM   R14,R15,ESDBLK2          PUT IN PARAMETER FOR READ/WRITE 11600000
         MVI   HIDESDID,DSW             ORGIN OF DSECT ESDID            11920000
*                                                                       11930000
*        INITIALIZE WORK AREA FOR EXPRESSION EVALUATION ROUTINE         11970000
*                                                                       11980000
         LA    R14,TERMS                START OF TERMS STACK            11990000
         LA    R15,RLIST                START OF RELOCATABILITY STACK   12000000
         LA    R0,OPRNS-D1              START OF OPERATOR STACK         12050000
         STM   R14,R0,ATPTR             X                               12400000
         TS    SELFDEFN                 ASSUMED INITIAL SETTING         12480000
         MVI   CLCLNG+D1,D1             LENGTH ATTRIBUTE OF ASTERISK    12560000
         SPACE                                                          12610000
         LA    R14,ESDBLK1              ADDRESS OF ONE BLOCK            12690000
         LA    R15,ESDBLK2              ADDRESS OF OTHER BLOCK          12770000
         STM   R14,R15,JFWORD1          STORE BOTH                      12850000
         MVC   NOTELIST(D8),JFWORD1     INITIALIZE FIRST ESD BLOCK      12930000
         MVC   NOTELIST+D9(D8),JFWORD2  INITIALIZE OTHER ESD BLOCK      13010000
         MVI   NOTELIST+L'JNOTEVAL,X'01'     X                          13120000
         MVI   NOTELIST+L'JNOTEVAL*2+1,X'01' X                          13440000
         LA    R6,ESDBLK1+D8            DUMMY POINTER                   13520000
         SPACE                                                          13600000
*TITLE-  GETNEXT                                                      * 13680000
*                                                                     * 13760000
*FUNCTION/OPERATION-                                                  * 13840000
*        THIS ROUTINE IS THE MAIN LINE CONTROL AND DRIVER FOR THE     * 13920000
*   SYMBOL RESOLUTION PHASE.  THIS ROUTINE GETS THE NEXT LOGICAL      * 14000000
*   RECORD FROM THE CURRENT INPUT FILE AND PASSES CONTROL TO ONE OF   * 14080000
*   THE FUNCTIONAL ROUTINES FOR PROCESSING.  THE FUNCTIONAL ROUTINE   * 14160000
*   SELECTED IS DEPENDENT UPON THE RECORD TYPE AND THE CURRENT MODE.  * 14240000
*   IF IN PASS ONE ASSIGNMENT MODE, THIS ROUTINE ALSO ADJUSTS THE     * 14320000
*   CURRENT LOCATION COUNTER AND SETS UP THE OPERAND COLUMN POINTER.  * 14400000
*                                                                     * 14480000
*INPUT-  NONE                                                         * 14560000
*                                                                     * 14640000
*OUTPUT- REGISTER R3 CONTAINS THE CURRENT LOCATION COUNTER VALUE.     * 14720000
*        REGISTER R4 IS A POINTER TO THE INPUT RECORD.                * 14800000
*        REGISTER R5 IS A POINTER TO THE OPERAND FILED.               * 14880000
*                                                                     * 14960000
         SPACE                                                          15040000
GETNEXT  LH    R10,JINFILE              GET ADDRESS OF INPUT FILE       15120000
         JGETL FILE=(R10)               GET NEXT RECORD                 15200000
         LR    R4,R11                   RECORD POINTER                  15280000
         SR    R1,R1                    CLEAR REGISTER                  15360000
         IC    R1,JTIOP1                GET RECORD TYPE                 15440000
         AR    R1,R1                    GET INDEX                       15520000
         LH    R2,MODE                  GET MODE                        15600000
         L     R2,RADIX(R2)             GET RADIX                       15680000
         SH    R2,D0(R1,R2)             GET ROUTINE VECTOR              15760000
         GOIF  (MODE1,MODE2)            SEE IF PASS 1 ASSIGNMENT MODE   15840000
         BNER  R2                       GO TO RESPECTIVE ROUTINES IF NO 15920000
* DO NOT MOVE INPUT RECORD IF SYMBOL OVERFLOW HAS NOT OCCURED           16000000
         GOIF IOFLO,OFF=DONTMOVE                                        16050000
* DO NOT MOVE REFERENCE RECORD                                          16060000
         GOIF JTIOP,JTSYMBL,EQ=DONTMOVE                                 16070000
         LH    R1,JTRLI                 RECORD LENGTH                   16072000
         LA    R3,INPUTBUF              BUFFER ADDRESS                  16074000
         CH    R1,ADMAXMVC              EXECUTE MOVE IF                 16076000
         BNH   MOVEX                    LESS THAN MAX MOVE LENGTH       16078000
         SH    R1,ADMAXMVC              SUBTRACT MOVED BYTES            16078400
         MVC   D0(MAXMVC,R3),D0(R4)     MOVE MAX LENGTH                 16078800
         LA    R4,MAXMVC(,R4)           BUMP FROM ADDRESS               16079200
         LA    R3,MAXMVC(,R3)           BUMP TO ADDRESS                 16079600
MOVEX    BCTR  R1,R0                    MINUS ONE FOR EXECUTE           16079700
         EX    R1,MVCIM                 EXECUTE MOVE INSTRUCTION        16079800
         LA    R4,INPUTBUF              POINT TO LOGICAL RECORD         16079900
DONTMOVE GOIF  RFIELDX,OFF=LOCTR1       SKIP IF NO OPERAND              16106600
         LA    R5,RLNGA                 POINT TO OPERAND                16133300
         GOIF  RFIELDN,OFF=LOCTR        SKIP IF NO NAME                 16160000
         LA    R5,RLNGB                 POINT TO OPERAND                16240000
LOCTR    SR    R1,R1                    CLEAR REGISTER                  16320000
         IC    R1,CHAR1                 GET OPERAND LENGTH              16400000
         LA    R5,CHAR2(R1)             POINT TO END-OF-OPERAND         16480000
         ST    R5,OPNEND                NOTE IT                         16560000
         SR    R5,R1                    POINT TO BEGINNING-OF-OPERAND   16640000
LOCTR1   GOIF  JDEF,OFF=(R2)            SKIP UPDATE LOCATION COUNTER    16720000
         SET   JDEF,OFF                 RESET INDICATOR                 16800000
         L     R3,ELCTR                 GET CURRENT LOCATION COUNTER    16880000
         NC    RLCTR,RLCTR              SEE IF BYTES SKIPPED            16960000
         BZ    LOCTR2                   NO, PROCEED                     17040000
         BAL   R9,ALIGN1                ALIGN TO HALFWORD BOUNDARY      17120000
         DC    H'-2,1'                  ALIGNMENT PARAMETERS            17200000
         AL    R3,RLCTR                 ADD NUMBER OF BYTES SKIPPED     17280000
         ST    R3,ELCTR                 UPDATE CURRENT LOCATION COUNTER 17360000
LOCTR2   MVC   RESDI(D6),EESDI          PASS CURRENT LOCATION COUNTER   17440000
         BR    R2                       GO TO RESPECTIVE ROUTINE        17520000
         SPACE                                                          17600000
MAXMVC   EQU   256                      MAX MOVE LENGTH                 17650000
ADMAXMVC DC    H'256'                   MAX MOVE LENGTH                 17660000
MVCIM    MVC   D0(*-*,R3),D0(R4)        MOVE LOGICAL RECORD             17670000
         SPACE                                                          17672000
INPC     LA    R10,HICESDID             GET PARAMETER                   17680000
         MVC   XPARM,CSTPARM            PASS PARAMETERS                 17760000
         GOTO  BLDESD                   BUILD ESD ENTRY                 17840000
         LR    R6,R10                   MAKE CONTROL SECTION CURRENT    17920000
         AIF   ('&TESTRAN' NE 'YES').INPC                               18000000
         BAL   R9,ESDPUNCH              OUTPUT TESTRAN ITEM             18080000
.INPC    B     EPILOGUE                 FINIS                           18160000
         SPACE                                                          18240000
SEARCH   GOIF  (RFIELDN,PRIORDEF),NOTMIX=TRANSFER                       18320000
         LR    R10,R4                   PASS RECORD POINTER             18400000
         GOTO  FIND                     LOOKUP IN SYMBOL TABLE          18480000
         BNE   TRANSFER                 NOT FOUND                       18560000
         GOIF  ESDNRSW,ON=TRANSFER      DEFER FLAGGING                  18640000
         SET   PRIORDEF,ON              INDICATE PREVIOUSLY DEFINED     18720000
         B     TRANSFER                 OUTPUT RECORD                   18800000
         SPACE                                                          18880000
EOFIIS   SET   MODE1,OFF                INDICATE END OF SUBSTITUTION    18960000
         SET   IOFLO,ON                 INDICATE TABLE OVERFLOWED       19040000
         GOIF  STBLOFLO                 SEE IF SUBSETTED                19140000
         GOTO  SUBSET                   SUBSET                          19240000
         L     R0,SYMDIMEN+D4           GET ADDRESS                     19340000
         SH    R0,=H'1024'              MARGIN                          19440000
         C     R0,LATEND                SEE IF OVERLAPPING LITERAL POOL 19760000
         BNL   GETNEXT                  ENOUGH ROOM                     19840000
         MVI   JPRTONLY,JPRONLY         SET FLUSH CONDITION             19920000
         SET   (MODE1,MODE2),ON         SET EXIT CONDITION              20000000
         B     BUGOUT                   JUST LIKE IT SAYS               20080000
         SPACE                                                          20120000
REHASH   GOIF  STBLOFLO                 SEE IF SUBSETTED                20160000
         GOTO  SUBSET                   SUBSET                          20200000
         LR    R10,R4                   POINTER                         20210000
         GOTO  ENTER                    ENTER IN SYMBOL TABLE           20240000
         B     GETNEXT                  FINIS                           20280000
         SPACE                                                          20320000
START    SR    R0,R0                    ZERO                            20400000
         CH    R0,FSTCSECT              SEE IF FIRST CSECT              20480000
         BNE   CSECT                    ILLEGAL START IF NOT FIRST      20560000
         GOIF  RFIELDX,OFF=START1       NO OPERAND                      20640000
         CLC   CHAR1(D2),=AL1(JCOMMA,JBLANK) LOOK FOR NULL OPERAND      20660000
         BE    START1                   A CLEAN START, VRRRRRRRROM      20680000
         GOTO  EVAL                     EVALUATE OPERAND                20720000
         BNZ   CSECT                    ERROR                           20800000
         GOIF  LOCTREF,ON=CSECT         LOCATION COUNTER REFERENCE      20880000
         LA    R11,D7(,R11)             ROUND TO DOUBLE WORD BOUNDARY   20960000
         ST    R11,STARTLOC             SAVE                            21040000
START1   OI    RFLGB,BIT0               INDICATE VALID START CARD       21120000
         SPACE                                                          21200000
CSECT    L     R11,CSTPARM              GET PARAMETER                   21280000
CSECT1   LA    R10,HICESDID             X                               21360000
CSECT2   ST    R11,XPARM                PASS                            21440000
         GOTO  BLDESD                   GO MAKE ESD ENTRY               21520000
         LR    R6,R10                                                   21600000
         MVC   RESDI(L'RESDI+L'RLCTR),EESDI                             21680000
         BAL   R9,WRITE2                WRITE CROSS-REFERENCE RECORD    21760000
         AIF   ('&TESTRAN' NE 'YES').CSECT                              21840000
         BAL   R9,ESDPUNCH              OUTPUT TESTRAN ITEM             21920000
.CSECT   B     EPILOGUE                 FINIS                           22000000
         SPACE                                                          22080000
DSECT    L     R11,DSTPARM              GET PARAMETER                   22160000
         LA    R10,HIDESDID                                             22240000
         B     CSECT2                                                   22320000
         SPACE                                                          22400000
COM      L     R11,COMPARM              GET PARAMETER                   22480000
         B     CSECT1                   COMMON ROUTINE                  22560000
         SPACE                                                          22640000
REPRO    JPUNCH  SEQ=NO                 GET PUNCH BUFFER                22720000
         SR    R15,R15                  CLEAR REGISTER                  22800000
         IC    R15,RESDI                GET OPERAND LENGTH              22880000
         LTR   R15,R15                  SEE IF LENGTH OF OPERAND ZERO   22960000
         BE    GETNEXT                  FINIS IF SO                     23040000
         LR    R14,R15                  CLEAR REGISTER                  23120000
         IC    R14,RFLDI                GET OUTPUT COLUMN POINTER       23200000
         BCTR  R14,0                    DECREMENT BY ONE                23280000
         BCTR  R15,0                    DECREMENT BY ONE                23360000
         AR    R11,R14                  POINT TO OUTPUT COLUMN          23440000
         EX    R15,REPRO1               MOVE IN OPERAND                 23520000
         B     GETNEXT                  FINIS                           23600000
REPRO1   MVC   D0(D0,R11),RESDI+D1      EXECUTED INSTRUCTION            23680000
         SPACE                                                          23760000
PUNCH    LA    R2,D1                    INCREMENT                       23840000
         SR    R3,R3                    ZERO REGISTER                   23920000
         IC    R3,RESDI                 OPERAND LENGTH                  24000000
         CLI   RESDI,D3                 CHECK IF NULLSTRING             24020000
         BL    GETNEXT                  ERROR IF SO                     24040000
         AR    R3,R4                    POINT TO END OF OPERAND         24080000
         BCTR  R3,D0                    MINUS ONE                       24160000
         LR    R5,R4                    POINT TO BEGINNING OF OPERAND   24240000
         CLI   D7(R5),JQUOTE            MUST BEGIN WITH A QUOTE         24320000
         BNE   GETNEXT                  ERROR IF NOT                    24400000
PUNCH1   BXH   R5,R2,GETNEXT            POINT TO NEXT CHARACTER         24480000
PUNCH2   CLI   D7(R5),JQUOTE            SEE IF CHARACTER A QUOTE        24560000
         BNE   PUNCH6                   NOT A QUOTE                     24640000
         BXLE  R5,R2,PUNCH4             A QUOTE, SEE IF PAIRED QUOTES   24720000
PUNCH3   JPUNCH  SEQ=NO                 DEL BY A TRAIL QUOTE            24800006
         LA    R4,D3(,R4)               GET OPERAND LENGTH              24880000
         SR    R5,R4                    GET LENGTH OF OPERAND           24960000
         BM    GETNEXT                  NULL QUOTES                     25040000
         LA    R1,D9*D9-D2              79                              25120000
         CR    R1,R5                    SEE IF MORE THAN 80 CHARACTERS  25200000
         BNL   PONCHO                   LESS THAN 80                    25280000
         LR    R5,R1                    OPERNAD TOO LONG                25360000
PONCHO   EX    R5,PUNCH8                MOVE IN PUNCH OPERAND           25440000
         B     GETNEXT                  FINIS                           25520000
PUNCH4   CLI   D7(R5),JQUOTE            SEE IF PAIRED QUOTES            25600000
         BNE   GETNEXT                   NOT PAIRED ', FINIS   @OZ07355 25680006
PUNCH5   BCTR  R3,D0                    OP IS 1 LESS           @OY09620 25730005
         LR    R1,R3                    POINT TO 2:ND OF PAIR   OX04097 25840005
         SR    R1,R5                    GET LENGTH OF OPERAND REMAINDER 25920000
         BM    GETNEXT                  NO ENDING QUOTE        @OY09620 26000005
         EX    R1,PUNCH9                MAKE PAIR TO APPEAR AS ONE      26080000
         B     PUNCH2                   LOOP                            26160000
PUNCH6   CLI   D7(R5),JAMPER            SEE I& AN AMPERSAND             26240000
         BNE   PUNCH1                   JUST AN ORDINARY CHARACTER      26320000
         BXH   R5,R2,GETNEXT            POINT TO NEXT CHARACTER         26400000
         CLI   D7(R5),JAMPER            SEE IF PAINER AMPERSANDS        26480000
         BE    PUNCH5                   IT HAD BETTER BE                26560000
         B     GETNEXT                  OR OTHERWISE IT IS IN ERROR     26640000
PUNCH8   MVC   D0(D0,R11),D5(R4)        MOVE OPERAND ONTO CARD          26960000
PUNCH9   MVC   D7(D0,R5),D8(R5)         OVERLAP THE REDUNDANT ONE       27040000
         SPACE                                                          27120000
DC       MVI   TYPECALL,DCCALL+DEFNAME  PARAMETER                       27200000
         GOIF  (DSW2,CSW2),NONE=DC1     ESD SUPPRESSION                 27280000
         OI    TYPECALL,NOESD           SUPPRESS ESD PROCESSING         27360000
DC1      GOIF  (RFIELDN,PRIORDEF),MIX=DC2    NAME PREVIOUSLY DEFINED    27440000
         SET   DEFNAME,OFF              NO NAME DEFINITION              27520000
DC2      GOTO  DCSCAN                                                   27600000
         LH    R0,LATTRSAV                                              27680000
         GOIF  RFIELDN,OFF=DC3          SKIP IF NO NAME                 27760000
         STH   R0,RLNGQ                 PASS                            27840000
DC3      MVC   RFLGA,OPCNT+D1           NUMBER OF GOOD OPERANDS         27920000
B52      BAL   R9,WRITE2                WRITE RECORD                    28000000
         B     EPILOGUE                 FINIS                           28080000
         SPACE                                                          28160000
DS       MVI   TYPECALL,DSCALL+DEFNAME+NOESD PARAMETER                  28240000
         B     DC1                      VINTAGE                         28320000
         SPACE                                                          28400000
ENTRY    GOTO  ENTRY                    GO TO ROUTINE                   28480000
         B     TRANSFER                 WRITE ON OUTPUT FILE            28560000
         SPACE                                                          28640000
EXTRN    MVI   RTYPE,ETYPEER            TYPE                            28720000
EXTRN1   MVI   RFLGB,ESDNRSW            SWITCH                          28800000
         GOTO  EXTRN                    GO TO ROUTINE                   28880000
         B     TRANSFER                 WRITE ON OUTPUT FILE            28960000
         SPACE                                                          29040000
WXTRN    MVI   RTYPE,ETYPEWX            TYPE                            29120000
         B     EXTRN1                   TREAT AS EXTRN                  29200000
         SPACE                                                          29280000
DXD      GOIF  RFIELDN,OFF=GETNEXT      LIKELY                          29360000
         MVI   RFLGA,D0                                                 29440000
         LR    R10,R4                                                   29520000
         GOTO  FIND                                                     29600000
         BNZ   DXD1                                                     29680000
         GOIF  ENTRYSW,ON=DXD1                                          29760000
         SET   PRIORDEF,ON                                              29840000
DXD1     LA    R0,D1                                                    29920000
         STH   R0,RLNGQ                                                 30000000
         SR    R0,R0                                                    30080000
         ST    R0,RLCTR                                                 30160000
         GOIF  PRIORDEF,ON=B52                                          30240000
         GOIF  RFIELDX,OFF=B52                                          30320000
         MVC   XPARM,DXDPARM            PASS PARAMETERS                 30400000
         LA    R10,HICESDID             PASS ESDID                      30480000
         GOTO  BLDESD                   MAKE ESD ENTRY                  30560000
         GOTO  XDSCAN                   SCAN OPERAND                    30640000
         B     DC3                      BON VOYAGE                      30720000
         SPACE                                                          30800000
EQU      LA    R3,WRITE                 EXIT TIME ADDRESS               30880000
         XC    REFCOUNT,REFCOUNT        RESET COUNT            @OY10603 30930006
         XC    SYMCOUNT,SYMCOUNT        RESET COUNT            @OY10603 30980006
         XC    RESDI(D6),RESDI                                          31080000
         GOIF  RFIELDN,OFF=(R3)                                         31300000
         MVC   RLNGQ,=H'1'              LENGTH ATTRIBUTE OF *           31360000
         BAL   R2,EQU1                  EVALUATE EXPRESSION(S)          31440000
         GOIF  PRIORDEF,ON=(R3)         EXIT IF PREVIOUSLY DEFINED      31520000
         LR    R10,R4                   PASS POINTER                    31600000
         GOTO  ENTER                    ENTER IN SYMBOL TABLE           31680000
         BER   R3                       OK                              31760000
         SET   PRIORDEF,ON              INDICATE PREVIOUSLY DEFINED     31840000
         BR    R3                       GO ANYWAY                       31920000
EQU1     GOIF  RFIELDX,OFF=(R2)         NO OPERAND, DEFAULT TO *        32000000
         CLI   CHAR1,JCOMMA             FIRST OPERAND PRESENT           32080000
         BE    EQU4                     YEAH                            32160000
         GOTO  EVAL                     EVALUATE FIRST OPERAND          32240000
         BOR   R2                       SYNTACTIC ERROR                 32320000
         BALR  R1,D0                    SAVE CONDITION CODE             32400000
         CLI   D0(R14),JBLANK           SEE IF VALID END OF OPERAND     32480000
         BE    EQU2                     YEAH                            32560000
         CLI   D0(R14),JCOMMA           THIS IS OK ALSO                 32640000
         BNER  R2                       OTHERWISE, A NO-NO              32720000
EQU2     LR    R5,R14                   COLUMN POINTER                  32800000
         SPM   R1                       SET CONDITION CODE              32880000
         BL    EQU3                     BADDIE                          32960000
         AIF   ('&TESTRAN' NE 'YES').EQUX                               33040000
         BZ    EQUABS                   BRANCH IF ABSOLUTE OPND         33060000
         LA    R3,XREF3                 EXIT IF SIMPLY RELOCATABLE      33080000
EQUABS   STH   R10,RESDI                ESDID                           33100000
         AGO   .EQUY                                                    33120000
.EQUX    STH   R10,RESDI                ESDID                           33140000
.EQUY    ST    R11,RLCTR                VALUE                           33160000
EQU3     MVC   RLNGQ,IMPLNG             LENGTH ATTRIBUTE                33200000
         MVC   RFLGB,EVALSW1            TATTLE TALE                     33240000
         CLI   CHAR1,JBLANK             END OF EVALUATION               33280000
         BER   R2                       YUP                             33360000
EQU4     LA    R5,CHAR2                 POINT TO NEXT CHARACTER         33440000
         CLI   CHAR1,JCOMMA             NULL OPERAND                    33520000
         BER   R2                       YES                             33600000
         GOTO  EVAL                     EVALUATE SECOND OPERAND         33680000
         BE    EQU6                     OK                     @OY08064 33760005
         GOIF  NOTDEFN,OFF=(R2)         ERROR - UNDEF SYMB ?   @OY08064 33810005
         SET   EQUF1,ON                 MARK IT IN RECORD      @OY08064 33820005
         BR    R2                       AND RETURN             @OY08064 33830005
EQU6     EQU   *                                               @OY08064 33832005
         CLI   D0(R14),JBLANK           SEE IF PROPERLY DELIMITED       33840000
         BE    EQU5                     YES                             33920000
         CLI   D0(R14),JCOMMA           THIS IS OK ALSO                 34000000
         BNER  R2                       THIS ISN'T                      34080000
EQU5     EQU   *                                               @OY01040 34160005
         SET   EQUF1,ON                 MARK IN CASE OF ERROR  @PI01040 34210005
         CL    R11,=F'65535'            SEE IF WITHIN ALLOWANCE@PI01040 34220005
         BHR   R2                       NOPE                            34240000
         SET   EQUF1,OFF                ALL RIGHT              @PI01040 34290005
         STH   R11,RLNGQ                LANGTH ATTRIBUTE OVERRIDDEN     34320000
         BR    R2                       RETURN                          34400000
         SPACE                                                          34480000
CNOP     BAL   R9,ALIGN                 ALIGN TO HALFWORD BOUNDARY      34560000
         DC    H'-2,1'                  ALIGNMENT PARAMETERS            34640000
         ST    R3,RLCTR                 UPDATE CURRENT LOCATION COUNTER 34720000
         BAL   R9,XREF                  CROSS REFERENCE NAME FIELD      34800000
         AIF   ('&TESTRAN' NE 'YES').CNOPY                              34880000
         BAL   R9,MISPUNCH              OUTPUT TESTRAN ITEM             34960000
.CNOPY   GOIF  RFIELDX,OFF=EPILOGUE     NO OPERAND, NO GOOD             35040000
         GOTO  EVAL                     EVALUATE FIRST OPERAND          35120000
         BNE   EPILOGUE                 MUST BE ABSOLUTE                35200000
         CLI   D0(R14),JCOMMA           SEE IF THERE'S A SECOND OPERAND 35280000
         BNE   EPILOGUE                 TUBE IT IF NONE                 35360000
         LR    R2,R11                   SAVE VALUE OF FIRST OPERAND     35440000
         N     R11,=F'1'                SEE IF FIRST OPERAND IS ODD     35520000
         BNZ   EPILOGUE                 THAT'S ODD, TOO BAD             35600000
         LA    R5,D1(,R14)              POINT TO SECOND OF TWO OPERANDS 35680000
         GOTO  EVAL                     EVALUATE SECOND OPERAND         35760000
         BNE   EPILOGUE                 INVALID UNLESS IT'S ABSOLUTE    35840000
         CLI   D0(R14),JBLANK           LOOK FOR VALID DELIMITER        35920000
         BNE   EPILOGUE                 MUST BE A BLANK                 36000000
         LCR   R10,R11                  ALIGNMENT MASK                  36080000
         CL    R10,=F'-4'               FULLWORD                        36160000
         BE    CNOP1                    SKIP IF SO                      36240000
         CL    R10,=F'-8,4'             DOUBLEWORD                      36320000
         BNE   EPILOGUE                 8                               36400000
CNOP1    CLR   R2,R11                   FIRST OPERAND MUST BE SMALLER   36480000
         BNL   EPILOGUE                 OF THE TWO TO BE VALID          36560000
         NR    R3,R10                   TO SPECIFIED BOUNDARY           36640000
         AR    R3,R2                    ADD VALUE OF FIRST OPERAND      36720000
         C     R3,ELCTR                 THE RESULT SHOULD BE GREATER    36800000
         BNL   CNOP2                    THAN THE ORIGINAL VALUE         36880000
         AR    R3,R11                   OTHERWISE ADD ON SECOND OPERAND 36960000
CNOP2    ST    R3,ELCTR                 THIS IS THE NEW LOCATION        37040000
         B     EPILOGUE                 FINIS                           37120000
         SPACE                                                          37200000
ORG      BAL   R9,XREF                  CROSS REFERENCE NAME FIELD      37280000
         AIF   ('&TESTRAN' NE 'YES').ORGY                               37360000
         BAL   R9,MISPUNCH              OUTPUT TESTRAN ITEM             37440000
.ORGY    LH    R10,JOUTFILE             OUTPUT FILE ADDRESS             37520000
         LA    R11,D12                  LENGTH OF RECORD                37600000
         JPUTL FILE=(R10),BUFREQ=(R11)  GET OUTPUT BUFFER               37680000
         GOIF  RFIELDX                  SEE IF THERE'S AN OPERAND       37760000
         LR    R4,R11                   RECORD POINTER                  37840000
         MVC   JTRLI(D6),LOCRCD         ADJUSTMENT RECORD               37920000
         MVC   RESDI(D6),EESDI          CURRENT ESDID AND VALUE         38000000
         BZ    ORG1                     GO TO ORG BLANK                 38080000
         CLI   CHAR1,JCOMMA             SEE IF NULL OPERAND             38160000
         BE    ORG1                     X                               38240000
         GOTO  EVAL                     EVALUATE OPERAND                38320000
         BNH   EPILOGUE                 NOT SIMPLY RELOCATABLE          38400000
         CLI   D0(R14),JBLANK           CHECK FOR PROPER DELIMITER      38480000
         BNE   EPILOGUE                 BAD DELIMITER                   38560000
         CH    R10,EESDI                SEE IF IN THIS CONTROL SECTION  38640000
         BNE   EPILOGUE                 OUT OF CONTROL, SECTIONWISE     38720000
         LTR   R11,R11                  SEE IF NEGATIVE                 38800000
         BM    EPILOGUE                 NEGATIVE, OUT OF CONTROL        38880000
         CL    R3,EHILC                 SEE IF NECESSARY TO SAVE VALUE  38960000
         BNH   ORG2                     NOPE                            39040000
         ST    R3,EHILC                 SAVE CURRENT LOCATION COUNTER   39120000
         B     ORG2                     CONTINUE                        39200000
ORG1     L     R11,EHILC                GET SAVED HIGHEST ADDRESS       39280000
         CLR   R3,R11                   SEE IF HIGHER THAN CURRENT      39360000
         BNL   ORG3                     INEFFECTIVE                     39440000
ORG2     ST    R11,ELCTR                MODIFY ADDRESS TO NEW VALUE     39520000
         ST    R11,RLCTR                PASS IN RECORD                  39600000
ORG3     MVI   RFLGB,GOODORG            INDICATE ERROR FREE ORG         39680000
GOODORG  EQU   BIT0                     X                               39760000
         B     EPILOGUE                 FINIS                           39840000
         SPACE                                                          39920000
SYMBL    LH    R14,REFCOUNT             GET COUNT                       40000000
         CH    R14,SYMCOUNT             COMPARE TO TOTAL                40080000
         BNL   SYMBOL                   SKIP IF NOT APPLICABLE          40160000
         LA    R15,D1(,R14)             BUMP COUNT                      40240000
         STH   R15,REFCOUNT             UPDATE COUNT                    40320000
         SRDL  R14,D3                   FIRST SUBSCRIPT IN R14          40400000
         SRL   R15,D29                  SECOND SUBSCRIPT IN R15         40480000
         LA    R1,BIT0                  INITIAL MASK                    40560000
         SRL   R1,D0(R15)               ADDRESS BIT                     40640000
         LA    R15,VEETABLE(R14)        ADDRESS BYTE                    40720000
         EX    R1,TMINST                SEE IF V-CON SYMBOL             40800000
         BZ    SYMBOL                   SKIP IF NOT                     40880000
         OI    RNAME,BIT0               FUDGE                           40960000
         SPACE                                                          41040000
SYMBOL   LR    R10,R4                   PARAMETER                       41120000
         GOTO  FIND                     LOOKUP IN SYMBOL TABLE          41200000
         BNE   TRANSFER                 NO FURTHER                      41280000
         CLI   JSW0033,MODE2            MODE 1S                 OX00873 41330002
         BNE   SYMBOL05                 NO,BRANCH               OX00873 41340002
         TM    RNAME,BIT0               TEST IF VCON BIT ON     OX00873 41350002
         BO    TRANSFER                 YES                     OX00873 41352002
SYMBOL05 GOIF  ENTRYSW,ON=TRANSFER      UNDEFINED ENTRY SYMBOL  OX00873 41360002
         SET   DEFINED,ON               INDICATE DEFINED                41440000
         MVC   RFLGB,SFLGS              PASS FLAGS                      41520000
         MVC   RESDI(L'RESDI+L'RLCTR),SESDI  PASS ESDID AND VALUE       41600000
         LA    R15,1                    PASS LENGTH ATTRIBUTE           41680000
         GOIF  ESDNRSW,ON=SYMBOL1       SEE IF EXTERNAL NAME            41760000
         LH    R15,SLNGQ                GET LENGTH ATTRIBUTE            41840000
SYMBOL1  STH   R15,RLNGQ                PASS LENGTH ATTRIBUTE           41920000
         GOIF  MODE1,OFF=SYMBOL2                                        42000000
         GOIF  MODE2,ON=ADJUST,ELSE=SYMBOL3                             42080000
SYMBOL2  SET   PRIORDEF,ON                                              42160000
         NI    RNAME,BITFF-BIT0                                         42240000
SYMBOL3  MVI   JTIOP1,JTADJII                                           42320000
         B     TRANSFER                 OUTPUT RECORD                   42400000
         SPACE                                                          42480000
CXD      BAL   R9,ALIGN1                ALIGN TO FULLWORD BOUNDARY      42560000
         DC    H'-4,3'                  ALIGNMENT PARAMETERS            42640000
         LA    R1,D4                    LENGTH ATTRIBUTE                42720000
         AIF   ('&TESTRAN' NE 'YES').CXD                                42800000
         ST    R3,RLCTR                 VALUE OF SYMBOL                 42880000
         BAL   R9,XREF1                 CROSS-REFERENCE NAME, IF ANY    42960000
         SET   TDATA                    INDICATE TESTRAN ITEM TYPE      43040000
         BAL   R9,ANYPUNCH              OUTPUT TESTRAN ITEM             43120000
         LA    R10,D2                   LENGTH                          43200000
         MVC   ORGBYTE(D2),=AL1(DTYPEA,D3)   DATA TYPE AND LENGTH       43280000
         BAL   R9,SYMPUNCH              OUTPUT TESTRAN ITEM             43360000
         B     EPILOGUE                 FINIS                           43440000
         AGO   .CXD1                                                    43520000
.CXD     B     MACHOP1                  SKIP                            43600000
.CXD1    SPACE                                                          43680000
CCW      BAL   R9,ALIGN                 ALIGN TO DOUBLEWORD BOUNDARY    43760000
         DC    H'-8,7'                  ALIGNMENT PARAMETERS            43840000
         LA    R1,D8                    LENGTH ATTRIBUTE                43920000
         AIF   ('&TESTRAN' NE 'YES').CCW                                44000000
         ST    R3,RLCTR                 VALUE OF SYMBOL                 44080000
         BAL   R9,XREF1                 CROSS-REFERENCE NAME, IF ANY    44160000
         SET   TCCW                     INDICATE TESTRAN ITEM TYPE      44240000
         BAL   R9,ANYPUNCH              OUTPUT TESTRAN ITEM             44320000
         B     EPILOGUE                 FINIS                           44400000
         AGO   .CCW1                                                    44480000
.CCW     B     MACHOP1                  SKIP                            44560000
.CCW1    SPACE                                                          44640000
MACHOP   BAL   R9,ALIGN                 ALIGN TO HALFWORD BOUNDARY      44720000
         DC    H'-2,1'                  ALIGNMENT PARAMETERS            44800000
         XC    REFCOUNT,REFCOUNT        ZERO REFCOUNT          @AZ18392 44810000
         XC    SYMCOUNT,SYMCOUNT        ZERO SYMCOUNT          @AZ18392 44820000
         GOIF  RFIELDN,OFF=MACHOP1      TEST IF NAME IS PRESENT         44850000
         LH    R1,RLNGQ                 LENGTH ATTRIBUTE                44880000
MACHOP1  ST    R3,RLCTR                 LOCATION COUNTER VALUE          44960000
         BAL   R9,XREF1                 CROSS-REFERENCE NAME, IF ANY    45040000
         AIF   ('&TESTRAN' NE 'YES').MACHOP                             45120000
         SET   TMOP                                                     45200000
         BAL   R9,MOPPUNCH              OUTPUT TESTRAN ITEM             45280000
.MACHOP  B     EPILOGUE                 FINIS                           45360000
         SPACE                                                          45440000
LITERAL  MVI   TYPECALL,LTCALL+NOESD    PASS PARAMETERS                 45520000
         GOTO  DCSCAN                   DETERMINE LITERAL OBJECT LENGTH 45600000
         SR    R3,R3                    DISPLACEMENT                    45680000
         LTR   R2,R15                   LENGTH OF LITERAL               45760000
         BZ    LITRPUT                  BAD IF ZERO OBJECT LENGTH       45840000
         N     R2,=F'7'                 GET MODULO SUM                  45920000
         IC    R2,INDEX(R2)             USE IT TO GET INDEX VALUE       46000000
         SR    R14,R5                   FIND LITERAL SOURCE LENGTH      46080000
         BCTR  R5,0                     POINT TO LENGTH INDICATOR       46160000
         STC   R14,CHAR1                MODIFY LITERAL SOURCE LENGTH    46240000
         CH    R14,JLITLNG              SEE IF LONGER                   46320000
         BNH   LITERAL4                 NOPE                            46400000
         STH   R14,JLITLNG              SAVE LONGER LENGTH              46480000
LITERAL4 SR    R0,R0                    ZERO R2                         46560000
         GOIF  DLOCTREF,OFF=LITERAL1    SKIP IF SO                      46640000
         LA    R0,D6                    LOCATION COUNTER REFERENCED     46720000
LITERAL1 LA    R3,LATA8-D4(R2)          POINT TO RESPECTIVE CHAIN       46800000
LITERAL2 LR    R1,R3                    TUCK ON CHAIN                   46880000
         L     R3,D0(,R1)               LOOK AT THE NEXT ENTRY          46960000
         LTR   R3,R3                    SEE IF AT THE END OF THE ROPE   47040000
         BZ    LITERAL3                 GO PUT IN ENTRY IF SO           47120000
         LTR   R0,R0                    IF LOCATION COUNTER REFERENCED  47200000
         BNZ   LITERAL2                 DON'T LOOK AT IT                47280000
         EX    R14,LITCLC               LOOK AT THIS LITERAL ENTRY      47360000
         BNE   LITERAL2                 SKIP IF NOT THE SAME            47440000
         L     R3,D4(,R3)               GET DISPLACEMENT OF THE ENTRY   47520000
         SLL   R14,D16                  LENGTH                          47600000
         OR    R2,R14                   LENGTH                          47680000
         B     LITRPUT                  PUT OUT THIS RECORD             47760000
LITERAL3 LM    R11,R12,LATADD           GET LITERAL POOL ADDR  @OX09723 47840006
         LA    R9,41(R12,R14)           ESTIMATE LENGTH OF ENTRY        47890006
         CL    R9,SYMDIMEN+4            SEE IF ENOUGH ROOM              48080000
         BH    LITRFULL                 NOT ENOUGH                      48160000
         XC    D0(D4,R12),D0(R12)       ZERO CHAIN POINTER              48240000
         ST    R12,D0(,R1)              CHAIN POINTER                   48320000
         L     R3,D0(R2,R11)            OBJECT LENGTH OF THIS CHAIN     48400000
         AR    R15,R3                   ADD ON LENGTH OF THIS LITERAL   48480000
         ST    R3,D4(,R12)              PUT ONE INTO THE LITERAL POOL   48560000
         ST    R15,D0(R2,R11)           THE OTHER IN ADJUSTMENT TABLE   48640000
         MVC   D10(D6,R12),EESDI        SAVE LOCATION COUNTER           48720005
         TM    XPARM,XDUMMY             TEST IF IN DSECT       @OX07274 48770005
         BZ    LITERAL5                 NO, CSECT              @OX07274 48780005
         OI    D8(R12),INDSECT          RESIDES IN DSECT       @OX10361 48790005
LITERAL5 STH   R0,D8(,R12)              INDICATE LOC COUNTER   @OX07274 48800005
         AR    R12,R0                   BUMP PAST LOCATION COUNTER      48880000
         EX    R14,LITMVC               MOVE IN LITERAL SOURCE          48960000
         AR    R12,R14                  POINT PAST LITERAL SOURCE       49040000
         SLL   R14,D16                  MOVE TO HIGH ORDER BYTE         49120000
         OR    R2,R14                   INSERT IN OUTPUT RECORD         49200000
         MVI   D11(R12),JBLANK          INSERT A BLANK                  49280000
         LA    R12,D15(,R12)            ROUND TO FULLWORD BOUNDARY      49360000
         N     R12,=F'-4'               ROUND TO FULLWORD BOUNDARY      49440000
         LR    R11,R12                  SAVE CHAINPTR          @OX09723 49490006
         L     R10,LATEND               LOAD OLD PTR           @OX09723 49500006
         SR    R11,R10                  SEE IF RECORD          @OX09723 49510006
         C     R11,=F'41'               LONG ENOUGH            @OZ16488 49512000
         BNL   LITERAL6                 IF NOT LEAVE           @OX09723 49514006
         LA    R12,D4(R12)              MARGINE FOR SYMBOL TBL @OX09723 49516006
LITERAL6 ST    R12,LATADD+D4            SAVE ADDRESS OF NEXT   @OX09723,49520006
                                        POOL ENTRY             @OX09723 49570006
         LA    R12,41(,R12)             LEAVE MARGINE          @AX14216 49600006
         ST    R12,SYMDIMEN+D12         LIMIT FOR SYMBOL TABLE          49680000
LITRPUT  LH    R10,JOUTFILE             GET OUTPUT FILE ADDRESS         49760000
         JPUTL FILE=(R10),BUFREQ=12     GET OUTPUT BUFFER               49840000
         STM   R2,R3,D4(R11)            PASS INDEX AND DISPLACEMENT     49920000
         MVC   D0(D5,R11),LITRCD        RECORD HEADER                   50000000
         LH    R0,LATTR                 LENGTH ATTRIBUTE                50080000
         BCTR  R0,D0                    MINUS ONE                       50160000
         STC   R0,D2(,R11)              TO RECORD                       50240000
         MVC   D3(D1,R11),SYMCOUNT+D1   SYMBOL COUNT                    50320000
         AIF   ('&DIAG' EQ 'NO').DUMP00                                 50400000
.DUMP00  B     EPILOGUE                 CLEANUP                         50720000
LITRFULL SET   STBLOFLO,ON              INDICATE SYMBOL TABLE FULL      50800000
         BAL   R9,EPILOG                CLEANUP                         50880000
         LH    R10,JOUTFILE             OUTPUT FILE ADDRESS             50960000
         LR    R11,R4                   OUTPUT RECORD POINTER           51040000
         JPUTM FILE=(R10),ADDR=(R11)    WRITE RECORD                    51120000
         B     GETNEXT                  GET NEXT                        51200000
         SPACE                                                          51280000
ENDING   NC    LATA8(D16),LATA8         LITERAL POOL EMPTY              51360000
         BZ    LTORG2                   X                               51440000
         LH    R10,FSTCSECT             ASCENDSION NUMBER               51520000
         LTR   R10,R10                  SEE IF ONE                      51600000
         BZ    ENDING0                  CAN'T DO MUCH FOR THIS GUY      51680000
         SPACE                                                          51760000
*NOTE-   THE FIRST CONTROL SECTION, IF ANY, IS RESUMED AT ITS HIGHEST * 51840000
*   ADDRESS WHEN END OF FILE IS DETECTED IN PASS 1 ASSIGNMENT MODE    * 51920000
*   AND THE LITERAL POOL IS NOT EMPTY.                                * 52000000
         GOTO  GETESD                   RESUMPTION                      52080000
         LR    R6,R10                   RESUME SECTION                  52180000
         AIF   ('&TESTRAN' NE 'YES').ENDING2                            52400000
         BAL   R9,ESDPUNCH              OUTPUT TESTRAN ITEM             52560000
.ENDING2 ANOP                                                           52640000
ENDING0  LH    R10,JOUTFILE             GET OUTPUT FILE ADDRESS         52720000
         JPUTM FILE=(R10),ADDR=LOCRCD   RESUMPTION RECORD               52800000
         LM    R2,R3,ELCTR              CURRENT AND HIGHEST SAVED       52880000
         CLR   R2,R3                    SEE WHICH IS GREATER            52960000
         BNH   GRRRRRRR                 R3 IS                           53040000
         LR    R3,R2                    YOU'RE THE GREATEST             53120000
GRRRRRRR ST    R3,ELCTR                 SAVE                            53200000
         MVC   D6(D6,R11),EESDI         PASS LOCATION COUNTER TO LINO   53280000
         SPACE                                                          53360000
LTORG    BAL   R9,ALIGN1                ALIGN TO DOUBLEWORD BOUNDARY    53440000
         DC    H'-8,7'                  ALIGNMENT PARAMETERS            53520000
         GOIF  JTEOFII,EQUAL=LTORG2     SKIP IF FORCED LTORG            53600000
         ST    R3,RLCTR                 ADDRESS                         53680000
         BAL   R9,XREF                  RECORD                          53760000
         AIF   ('&TESTRAN' NE 'YES').LTORG                              53840000
         BAL   R9,MISPUNCH              OUTPUT TESTRAN ITEM             53920000
.LTORG   ANOP                                                           54000000
LTORG2   SR    R2,R2                    CLEAR REGISTER                  54080000
         NC    LATA8(D16),LATA8         SEE IF CLEAN POOL               54160000
         BE    ENDING1                  SKIP IF NOT DIRTY POOL          54240000
         L     R10,LATADD               GET POINTER TO LITERAL TABLE    54320000
         LH    R14,EESDI                GET ESDID                       54400000
         LR    R15,R3                   GET LOCATION COUNTER VALUE      54480000
         LM    R0,R3,D4(R10)            GET LITERAL TABLE               54560000
         AR    R0,R15                   ADDRESS OF 4-CHAIN              54640000
         AR    R1,R0                    ADDRESS OF 2-CHAIN              54720000
         AR    R2,R1                    ADDRESS OF 1-CHAIN              54800000
         AR    R3,R2                    ADDRESS OF END-OF-LITERAL-POOL  54880000
         AIF   ('&DIAG' EQ 'NO').DUMP02                                 54960000
.DUMP02  STM   R14,R2,D0(10)            LITERAL ADJUSTMENT TABLE        55280000
         ST    R3,ELCTR                 SAVE LOCATION COUNTER           55360000
LCSAVE   MVC   LOCTRSAV,EESDI           SAVE LOCATION COUNTER AND ESDID 55440000
         SET   LITEND,ON                TO INFORM LTDUMP       @OX09723 55490006
         LM    R2,R3,=F'-8,4'           INDEX                           55520000
LTORG3   L     R5,LATA2(R2)             PASS ONE END OF A CHAIN         55600000
         BAL   R9,LTDUMP                DUMP OUT CHAIN                  55680000
         BXLE  R2,R3,LTORG3             ONE CHAIN AT A TIME             55760000
         SET   LITEND,OFF                                      @OX09723 55810006
LCRESTOR MVC   EESDI(D6),LOCTRSAV       RESTORE ESDID AND VALUE         55840000
         L     R10,LATADD               RECLAIM ADDRESS                 55920000
         LA    R2,D20                   LENGTH OF ONE LITERAL TABLE     56000000
         AR    R10,R2                   POINT TO NEXT TABLE             56080000
         LA    R11,D20(,R10)            POINT TO FRESH LITERAL POOL     56160000
         STM   R10,R11,LATADD           HERE WE GO AGAIN                56240000
         XC    LATA8(D16),LATA8         CLEAN OUT LITERAL POOL          56320000
         XC    D0(D20,R10),D0(R10)      CLEAR LITERAL TABLE             56400000
ENDING1  LH    R10,JOUTFILE             GET OUTPUT FILE ADDRESS         56480000
         LA    R11,D8                   RECORD LENGTH                   56560000
         JPUTL FILE=(R10),BUFREQ=(R11)  GET BUFFER                      56640000
         MVC   D0(D6,R11),EOFRCD        RECORD HEADER                   56720000
         MVI   D4(R11),JTLTEND          RECORD TYPE                     56800000
         STH   R2,D6(,R11)              PASS INCREMENT TO PASS II       56880000
         GOIF  JTEOFII,NOTEQ=EPILOGUE   SKIP IF NOT FORCED LTORG        56960000
         L     R14,LATADD               POINT TO THE END OF TABLES      57040000
         LA    R2,ENDOFCOM              POINT TO THE BEGINNING          57120000
         SR    R14,R2                   GET THE LENGTH                  57200000
         LA    R3,LATA8                 POINT TO NEW ADDRESS OF TABLE   57280000
         LA    R4,LATA8(R14)            THE END OF NEW TABLE            57360000
         STM   R3,R4,LATADD             BEGINNING OF BOTH TABLES        57440000
         BNP   ENDOFILE                 DON'T MOVE IF NO LITERALS       57520000
ENDING2  BCTR  R14,0                    GET MOVE LENGTH                 57600000
         EX    R14,LITMVC2              MOVE LITERAL ADJUSTMENT TABLE   57680000
         SRDL  R14,D8                   EXECUTED AMOUNT TO REGISTER 15  57760000
         SRL   R15,D24                  AMOUNT MOVED                    57840000
         LA    R3,D1(R3,R15)            POINT TO NEXT SEGMENT           57920000
         LA    R2,D1(R2,R15)            POINT TO NEXT SEGMENT           58000000
         SLA   R14,D8                   AMOUNT REMAINING NOT MOVED      58080000
         BZ    ENDOFILE                 GO IF TASK COMPLETED            58160000
         B     ENDING2                  REPEAT IF NOT                   58240000
         SPACE                                                          58320000
LTDUMP   BALR  R14,R7                   SAVE REGISTERS                  58400000
LTDUMP1  LTR   R4,R5                    SEE IF AT END-OF-CHAIN          58480000
         BZ    EXIT                     FINIS IF SO                     58560000
         SR    R3,R3                    BUMP PAST LOC CNTR     @OX10361 58640005
         IC    R3,D9(,R4)               COMPUTE LENGTH TO-     @OX10361 58690005
         AR    R5,R3                    LITERAL TEXT IN REC    @OX10361 58700005
INDSECT  EQU   BIT0                     LIT DEF IN DSECT       @OX10361 58710005
         SR    R3,R3                    ZERO REGISTER                   58720000
         GOIF  MODE2,ON=LTDUMP2         SKIP IF CHAINING MODE           58800000
         SR    R2,R2                    CLEAR REGISTER                  58880000
         IC    R2,D10(,R5)              GET LITERAL SOURCE LENGTH       58960000
         LA    R2,D1(,R2)               LENGTH                          59040000
         LA    R3,D13(,R2)              LENGTH                          59120000
         LH    R10,JOUTFILE             GET OUTPUT FILE ADDRESS         59200000
         JPUTL FILE=(R10),BUFREQ=(R3)   GET OUTPUT BUFFER               59280000
         STH   R3,D0(,R11)              RECORD LENGTH                   59360000
         MVC   D2(D6,R11),LOCRCD+D2     RECORD HEADER                   59440000
         EX    R2,LITMVC1               MOVE IN LITERAL SOURCE          59520000
         LR    R3,R11                   SAVE POINTER                    59600000
         MVI   TYPECALL,LTCALL+LTORGSCN PASS PARAMETERS                 59680000
         CR    R4,R5                    SEE IF LOCATION COUNTER         59760000
         BE    LTDUMP3                  NO                              59840000
         MVC   D6(D6,R11),D10(R4)       PASS LOCATION COUNTER           59920000
         B     LTDUMP3                  SKIP                            60000000
LTDUMP2  MVI   TYPECALL,LTCALL+LTORGSCN+NOESD     PASS PARAMETERS       60080000
LTDUMP3  MVC   EESDI(D6),D10(R4)        LOCATION COUNTER                60160000
         TM    D8(R4),INDSECT           TEST IF REF IN DSECT   @OX10361 60210005
         BZ    LTDUMP4                  NO                     @OX07274 60220005
         MVI   TYPECALL,LTCALL+LTORGSCN+NOESD PASS PARAM       @OX07274 60230005
LTDUMP4  LA    R5,D11(,R5)              TEXT POINTER           @OX07274 60240005
         AIF   ('&DIAG' EQ 'NO').DUMP04                                 60320000
.DUMP04  GOTO  DCSCAN                   SCAN LITERAL SOURCE ONCE MORE   60640000
         MVI   TYPECALL,D0              CLEAR PARAMETER                 60680000
         SR    R0,R0                    ZERO ZERO                       60720000
         STH   R0,SYMCOUNT              RESET SYMBOL COUNT              60800000
         GOIF  (STBLOFLO,LITEND),NOTALL=LTDUMP5 USE LIT POOL   @OX09723 60850006
         LA    R5,D20(R4)               ADD 20 FOR X4S         @OX09723 60860006
         ST    R5,SYMDIMEN+D4           NEW POINTER            @OX09723 60870006
LTDUMP5  L     R5,D0(,R4)               GET CHAIN POINTER               60880006
         LTR   R3,R3                    SEE IF LENGTH ATTRIBUTE DEFINED 60960000
         BE    LTDUMP1                  SKIP IF NOT NEEDED              61040000
         IC    R0,LATTR+D1              GET LENGTH ATTRIBUTE            61120000
         BCTR  R0,D0                    MINUS ONE                       61200000
         STC   R0,D2(,R3)               TO OUTPUT RECORD                61280000
         B     LTDUMP1                  TAKE IT FROM THE TOP            61520000
         SPACE                                                          61600000
LTORGII  L     R14,LATADD               ADJUSTMENT TABLE ADDRESS        61680000
         AH    R14,RESDI                INCREMENT                       61760000
         ST    R14,LATADD               UPDATE                          61840000
         B     TRANSFER                 FINIS                           61920000
         SPACE                                                          62000000
LITRII   LH    R10,RESDI                ADJUSTMENT INDEX                62080000
         LTR   R10,R10                  SEE IF VALID DEFINITION         62160000
         BZ    TRANSFER                 BAD LITERAL                     62240000
         L     R14,LATADD               LITERAL ADJUSTMENT TABLE        62320000
         L     R11,D0(R10,R14)          ADJUSTMENT FACTOR, POOL ADDRESS 62400000
         A     R11,RLCTR                LITERAL'S DISPLACEMENT IN CHAIN 62480000
         ST    R11,RLCTR                ADJUSTED LITERAL ADDRESS        62560000
         LH    R10,D2(,R14)             ESDID OF LITERAL POOL           62640000
         STH   R10,RESDI                ADJUSTED LITERAL ESDID          62720000
         AIF   ('&DIAG' EQ 'NO').DUMP06                                 62800000
.DUMP06  SPACE                                                          63120000
ADJUST   LH    R10,RESDI                ESDID                           63200000
         L     R11,RLCTR                OFFSET                          63280000
         LM    R14,R1,ADJINDEX          ADJUSTMENT PARAMETERS           63360000
ADJUST2  BXLE  R14,R15,TRANSFER         STEP INDEX                      63440000
         CH    R10,D0(R1,R14)           SEE IF ADJUSTMENT ENTRY         63520000
         BNE   ADJUST2                  GO AGAIN IF NOT                 63600000
         LH    R10,D2(R1,R14)           GET ADJUSTED ESDID              63680000
         STH   R10,RESDI                PASS IN RECORD                  63760000
         A     R11,D4(R1,R14)           ADD ADJUSTMENT FACTOR           63840000
         ST    R11,RLCTR                PASS IN RECORD                  63920000
         SPACE                                                          64000000
TRANSFER LH    R10,JOUTFILE             ADDRESS OF OUTPUT FILE          64080000
         LR    R11,R4                   OUTPUT RECORD ADDRESS           64320000
         JPUTM FILE=(R10),ADDR=(R11)    OUTPUT RECORD                   64400000
         B     EPILOGUE                 CHECK SYMBOL TABLE OVERFLOW     64480000
         SPACE                                                          64880000
ALIGN1   TM    JPARM2,JALGN             TEST ALIGN OPTION               64900000
         BZ    D4(,R9)                  RETURN TO MAINLINE IF OFF       64920000
ALIGN    LH    R0,D0(,R9)               GET ALIGN MASK                  64960000
         AH    R3,D2(,R9)               EXCESS FOR ALIGNMENT            65040000
         NR    R3,R0                    ROUND TO SPECIFIC BOUNDARY      65120000
         AIF   ('&TESTRAN' NE 'YES').ALIGN                              65200000
         LR    R0,R3                    GET NEW LOCATION COUNTER        65280000
         S     R0,ELCTR                 GET NUMBER OF BYTES SKIPPED     65360000
         MVC   ADDRESS,ELCTR+D1         ADDRESS                         65440000
         ST    R3,ELCTR                 UPDATE CURRENT LOCATION COUNTER 65520000
         LA    R9,D4(,R9)               PASS RETURN ADDRESS             65600000
         BER   R9                       NO BYTES SKIPPED                65680000
         SET   TSPACE                   ORGINIZATION BYTE               65760000
         STC   R0,NAME                  LENGTH, NUMBER OF BYTES SKIPPED 65840000
         LA    R10,D5                   LENGTH OF SPACE RECORD          65920000
         B     SYMPUNCH                 PUT OUTPUT ONTO 'SYM' CARD      66000000
         AGO   .ALIGN1                                                  66080000
.ALIGN   ST    R3,ELCTR                 UPDATE CURRENT LOCATION COUNTER 66160000
         B     D4(,R9)                  RETURN TO MAINLINE              66240000
.ALIGN1  SPACE                                                          66320000
XREF     LA    R1,D1                    ASSUME LENGTH ATTRIBUTE IS ONE  66400000
XREF1    GOIF  RFIELDN,OFF=(R9)         BUG OUT IF NOT NAMED            66480000
         STH   R1,RLNGQ                 PASS LENGTH ATTRIBUTE           66560000
         BALR  R14,R7                   PUSH REGISTERS                  66640000
         GOIF  PRIORDEF,ON=WRITE3       CHECK IF PREVIOUSLY DEFINED     66720000
         LR    R10,R4                   PASS RECORD POINTER             66800000
         GOTO  ENTER                    ENTER IN SYMBOL TABLE           66880000
         BE    WRITE3                   ENTERED SUCCESSFULLY            66960000
         SET   PRIORDEF,ON              INDICATE SYMBOL ALREADY DEFINED 67040000
         B     WRITE3                   SNEAK IN THE BACK DOOR          67120000
         AIF   ('&TESTRAN' NE 'YES').WRITE                              67200000
XREF3    BAL   R9,MISPUNCH              OUTPUT TESTRAN ITEM             67280000
.WRITE   SPACE                                                          67360000
WRITE    LA    R9,EPILOGUE              DEFINE EXIT                     67520000
WRITE1   GOIF  RFIELDN,OFF=(R9)         GIVE UP IF NOT NAMED            67600000
WRITE2   BALR  R14,R7                   PUSH REGISTERS                  67680000
WRITE3   LA    R2,D24                   CROSS-REFERENCE RECORD LENGTH   67760000
         GOIF  RFIELDN,ON=RECL22        TEST IF NAME IS PRESENT         67810000
         LA    R2,D12                   RECORD LENGTH WITHOUT NAME      67820000
RECL22   LH    R10,JOUTFILE                                             67840000
         LR    R11,R2                                                   67920000
         JPUTL FILE=(R10),BUFREQ=(R11)                                  68000000
         SH    R2,=AL2(D3)              GET MOVE LENGTH                 68050000
         EX    R2,MOVEREC               MOVE RECORD TO OUTPUT FILE      68060000
         STH   R2,D0(,R11)                                              68160000
         MVI   JTIOP1-JTRLI(R11),JTADJII                                68240000
         B     EXIT                     RETURN                          68480000
MOVEREC  MVC   D2(,R11),D2(R4)          MOVE RECORD TO OUTPUT FILE      68530000
         SPACE                                                          68560000
EPILOGUE BAL   R9,EPILOG                CLEANUP ROUTINE                 68640000
         B     GETNEXT                  CONTINUE                        68720000
EPILOG   BALR  R14,R7                   SAVE REGISTERS                  68800000
         GOIF  STBLOFLO,OFF=GET         IS SYMBOL TABLE FULL            68880000
         GOIF  MODE1,ON=GET                                             68920000
         GOIF  MODE2,ON=GET             CHECK IF 1S MODE                68940000
         SET   MODE2,ON                 CHANGE MODE                     68960000
         LM    R2,R3,=F'-8,4'           LOAD UP WITH INDEX              69040000
         EX    R0,LCSAVE                SAVE LOCATION COUNTER           69120000
EPILOOP  L     R5,LATA2(R2)             GET ONE END OF CHAIN            69200000
         BAL   R9,LTDUMP                DUMP OUT THE SYMBOLS            69280000
         BXLE  R2,R3,EPILOOP            DO IT TO ALL FOUR CHAINS        69360000
         EX    R0,LCRESTOR              RESTORE LOCATION COUNTER        69440000
         LH    R10,JOUTFILE             GET OUTPUT FILE ADDRESS         69520000
         JPUTM FILE=(R10),ADDR=EOFRCD   PUT OUT AN END-OF-FILE RECORD   69600000
GET      GOIF  INOTE,OFF=EXIT                                           69680000
         SET   INOTE,OFF                RESET CONDITION                 69760000
         LH    R10,JINFILE              GET INPUT FILE ADDRESS          69840000
         JPOINT  FILE=(R10),ADDR=INOTEVAL,NEXT=GET                      69920000
         B     EXIT                     FINIS                           70000000
         SPACE                                                          70080000
MAKESD   GOTO  MAKESD                   GO TO MAKE ESD                  70160000
         B     GETNEXT                                                  70240000
         SPACE                                                          70320000
ENDOFILE LH    R10,JOUTFILE             GET OUTPUT FILE ADDRESS         70400000
         LA    R11,EOFRCD               POINT TO END-OF-FILE            70480000
         JPUTM FILE=(R10),ADDR=(R11)    WRITE ONE LAST RECORD           70560000
BUGOUT   LH    R10,JOUTFILE             GET FILE ADDRESS                70640000
         JPOINT  FILE=(R10),NEXT=START  POINT TO BEGINNING OF FILE      70720000
         LH    R10,JINFILE              GET ADDRESS OF CURRENT INPUT    70800000
         MVC   JINFILE,JOUTFILE         OLD OUTPUT FILE BECOMES INPUT   70880000
         STH   R10,JOUTFILE             OLD INPUT FILE BECOMES OUTPUT   70960000
         JPOINT  FILE=(R10),NEXT=START  POINT TO BEGINNING OF OUTPUT    71040000
         AIF   ('&DIAG' EQ 'NO').DUMP08                                 71120000
.DUMP08  SET   (MODE1,MODE2),FLIP       CHANGY, CHANGY                  71920000
         GOIF  (MODE1,MODE2),MIX=GETNEXT,ALL=MAKESD                     72000000
         LR    R10,R7                   POINT TO COMMON                 72080000
         JFRECORE  ADDR=(R10)           FREE IT UP                      72160000
         B     III                      PHASE EXIT                      72240000
         AIF   ('&TESTRAN' EQ 'NO').TEST80                              72320000
         EJECT                                                          72400000
*TITLE-  ESDPUNCH                                                     * 72480000
*                                                                     * 72560000
*FUNCTION/OPERATION-                                                  * 72640000
*        FORMAT TESTRAN ITEMS FOR ROUTINE 'SYMPUNCH'.                 * 72720000
*                                                                     * 72800000
*INPUT-  REGISTER R6 POINTS TO AN ESD CONTROL SECTION ENTRY.          * 72880000
*                                                                     * 72960000
*OUTPUT- TESTRAN ITEMS IN STORAGE FOR ROUTINE 'SYMPUNCH'.             * 73040000
*                                                                     * 73120000
         SPACE                                                          73200000
MISPUNCH SET   TMIS                     ORGANIZATION BYTE               73280000
MOPPUNCH GOIF  (RFIELDN,PRIORDEF)       TEST                            73360000
         BNMR  R9                       RETURN                          73440000
ANYPUNCH LA    R10,D4                   LENGTH OF ITEM ASSUMED          73520000
         MVC   ADDRESS,RLCTR+D1         ADDRESS                         73600000
         GOIF  RFIELDN,OFF=SYMPUNCH     FINISHED IF NO NAME             73680000
         MVC   NAME,RNAME               MOVE NAME                       73760000
         IC    R10,RFLDI                GET NAME LENGTH BITS            73840000
         N     R10,=F'7'                KEEP LENGTH BITS ONLY           73920000
         LA    R10,D5(,R10)             LENGTH OF ITEM CONFIRMED        74000000
         B     STORELNG                 CONTINUE                        74080000
ESDPUNCH CLC   XSSAV,EESDI              SEE IF ACTUAL                   74110000
         BER   R9                       YEAH                            74140000
         MVC   XSSAV,EESDI              SAVE                            74170000
         LA    R10,D4                   LENGTH                          74200000
         MVC   ORGBYTE,ETYPE            ORGINIZATION BYTE               74240000
         TR    ORGBYTE,=AL1(TCSECT,0,0,0,TCSECT,TCOM,0,0,TDSECT)        74320000
         XC    ADDRESS,ADDRESS          ADDRESS                         74400000
         CLI   ENAME,JA                 SEE IF NAMED                    74480000
         BL    SYMPUNCH                 NAMELESS                        74560000
         MVC   NAME,ENAME               MOVE IN NAME                    74640000
         LA    R10,EITEM+D13            POINT TO LAST CHARACTER         74720000
LOOPLOOP BCTR  R10,0                    LOOK AT NEXT CHARACTER          74800000
         CLI   ENAME-EITEM-D5(R10),JBLANK    SEE IF PADDED              74880000
         BE    LOOPLOOP                 LOOP ON FALSIES                 74960000
         SR    R10,R6                   FIND THE LENGTH OF THE NAME     75040000
STORELNG LA    R1,BIT4-D5(,R10)         RIG MASK                        75120000
         EX    R1,SOKITUMI              INDICATE NAME PRESENT           75200000
         TR    NAME,JTRTABLE            TRANSLATE NAME                  75280000
         SPACE                                                          75360000
SYMPUNCH STM   R9,R1,TERMS              SAVE REGISTERS                  75440000
         GOTO  SYMPUNCH                 GO TO OUTPUT ROUTINE            75520000
         LM    R9,R1,TERMS              RESTORE REGOSTERS               75600000
         BR    R9                       RETURN                          75680000
         SPACE                                                          75760000
SOKITUMI XI    ORGBYTE,D0               EXECUTED INSTRUCTION            75840000
.TEST80  SPACE                                                          75920000
         DS    0F                                                       76000000
CSTPARM  DC    AL1(ESDNRSW+CSECTSW+DSECTSW+XENTRY,ETYPEPC,ETYPESD,0)    76080000
DSTPARM  DC    AL1(ESDNRSW+DSCOMSW+DSECTSW+XDUMMY,ETYPEDS,ETYPEDS,CSW)  76160000
COMPARM  DC    AL1(ESDNRSW+DSCOMSW+CSECTSW,ETYPECM,ETYPECM,CSW)         76240000
DXDPARM  DC    AL1(ESDNRSW+DSCOMSW+DSECTSW,ETYPEXD,ETYPEXD,DSW)         76320000
EOFRCD   DC    H'8',AL1(JPSOP,0,JTEOFII,0)   END-OF-FILE RECORD         76400000
LOCRCD   DC    HL2'12',AL1(JPSOP,0,JTADJII,0),HL2'0'   LITERAL DC       76480000
LITRCD   DC    HL2'12',AL1(JPSOP,0,JTLITII,0)     LITERAL RECORD HEADER 76560000
INDEX    DC    AL1(4,16,12,16,8,16,12,16)    LITERAL HASH INDEX         76640000
TMINST   TM    D0(R15),D0               EXECUTED INSTRUCTION            76720000
LITCLC   CLC   D10(D0,R3),CHAR1         EXECUTED INSTRUCTION            76800000
LITMVC   MVC   D10(D0,R12),CHAR1        EXECUTED INSTRUCTION            76880000
LITMVC1  MVC   D12(D0,R11),D10(R5)      EXECUTED INSTRUCTION            76960000
LITMVC2  MVC   D0(D0,R3),D0(R2)         EXECUTED INSTRUCTION            77040000
         SPACE                                                          77120000
RADIX    DC    A(IA,IS,IIS,IIA)         MODES                           77200000
IA       EQU   *-2*JTPREP               PASS 1 ASSIGNMENT MODE          77520000
         ORG   IA+2*JTPREP              TABLE INDEX                     77600000
         DC    Y(IA-REPRO)              ROUTINE VECTOR                  77680000
         ORG   IA+2*JTPPCH              TABLE INDEX                     77760000
         DC    Y(IA-PUNCH)              ROUTINE VECTOR                  77840000
         ORG   IA+2*JTINPC              TABLE INDEX                     77920000
         DC    Y(IA-INPC)               ROUTINE VECTOR                  78000000
         ORG   IA+2*JTPMOP              TABLE INDEX                     78080000
         DC    Y(IA-MACHOP)             ROUTINE VECTOR                  78160000
         ORG   IA+2*JTEND               TABLE INDEX                     78240000
         DC    Y(IA-GETNEXT)            ROUTINE VECTOR                  78320000
         ORG   IA+2*JTDXD               TABLE INDEX                     78400000
         DC    Y(IA-DXD)                ROUTINE VECTOR                  78480000
         ORG   IA+2*JTEQU               TABLE INDEX                     78560000
         DC    Y(IA-EQU)                ROUTINE VECTOR                  78640000
         ORG   IA+2*JTORG               TABLE INDEX                     78720000
         DC    Y(IA-ORG)                ROUTINE VECTOR                  78800000
         ORG   IA+2*JTCNOP              TABLE INDEX                     78880000
         DC    Y(IA-CNOP)               ROUTINE VECTOR                  78960000
         ORG   IA+2*JTCCW               TABLE INDEX                     79040000
         DC    Y(IA-CCW)                ROUTINE VECTOR                  79120000
         ORG   IA+2*JTDC                TABLE INDEX                     79200000
         DC    Y(IA-DC)                 ROUTINE VECTOR                  79280000
         ORG   IA+2*JTDS                TABLE INDEX                     79360000
         DC    Y(IA-DS)                 ROUTINE VECTOR                  79440000
         ORG   IA+2*JTSTART             TABLE INDEX                     79520000
         DC    Y(IA-START)              ROUTINE VECTOR                  79600000
         ORG   IA+2*JTCSECT             TABLE INDEX                     79680000
         DC    Y(IA-CSECT)              ROUTINE VECTOR                  79760000
         ORG   IA+2*JTDSECT             TABLE INDEX                     79840000
         DC    Y(IA-DSECT)              ROUTINE VECTOR                  79920000
         ORG   IA+2*JTCOM               TABLE INDEX                     80000000
         DC    Y(IA-COM)                ROUTINE VECTOR                  80080000
         ORG   IA+2*JTENTRY             TABLE INDEX                     80160000
         DC    Y(IA-ENTRY)              ROUTINE VECTOR                  80240000
         ORG   IA+2*JTEXTRN             TABLE INDEX                     80320000
         DC    Y(IA-EXTRN)              ROUTINE VECTOR                  80400000
         ORG   IA+2*JTWXTRN             TABLE INDEX                     80480000
         DC    Y(IA-WXTRN)              ROUTINE VECTOR                  80560000
         ORG   IA+2*JTCXD               TABLE INDEX                     80640000
         DC    Y(IA-CXD)                ROUTINE VECTOR                  80720000
         ORG   IA+2*JTLTORG             TABLE INDEX                     80800000
         DC    Y(IA-LTORG)              ROUTINE VECTOR                  80880000
         ORG   IA+2*JTLITR              TABLE INDEX                     80960000
         DC    Y(IA-LITERAL)            ROUTINE VECTOR                  81040000
         ORG   IA+2*JTSYMBL             TABLE INDEX                     81120000
         DC    Y(IA-SYMBL)              ROUTINE VECTOR                  81200000
         ORG   IA+2*JTEOFII             TABLE INDEX                     81760000
         DC    Y(IA-ENDING)             ROUTINE VECTOR                  81840000
         ORG   IA+2*JTADJII             TABLE INDEX                     81890000
         DC    Y(IA-TRANSFER)           ROUTINE VECTOR                  81940000
         ORG   IA+2*JTPASS              TABLE INDEX                     81990000
         DC    Y(IA-TRANSFER)           ROUTINE VECTOR                  82040000
         ORG   ,                        END-OF-TABLE                    82080000
IS       EQU   *-2*JTPMOP               PASS 1 SUBSTITUTION MODE        82160000
         ORG   IS+2*JTPMOP              TABLE INDEX                     82720000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  82800000
         ORG   IS+2*JTEND               TABLE INDEX                     82880000
         DC    Y(IS-TRANSFER)           ROUTINE VECTOR                  82960000
         ORG   IS+2*JTDXD               TABLE INDEX                     83040000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  83120000
         ORG   IS+2*JTEQU               TABLE INDEX                     83200000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  83280000
         ORG   IS+2*JTORG               TABLE INDEX                     83360000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  83440000
         ORG   IS+2*JTCNOP              TABLE INDEX                     83520000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  83600000
         ORG   IS+2*JTCCW               TABLE INDEX                     83680000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  83760000
         ORG   IS+2*JTDC                TABLE INDEX                     83840000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  83920000
         ORG   IS+2*JTDS                TABLE INDEX                     84000000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  84080000
         ORG   IS+2*JTSTART             TABLE INDEX                     84160000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  84240000
         ORG   IS+2*JTCSECT             TABLE INDEX                     84320000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  84400000
         ORG   IS+2*JTDSECT             TABLE INDEX                     84480000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  84560000
         ORG   IS+2*JTCOM               TABLE INDEX                     84640000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  84720000
         ORG   IS+2*JTENTRY             TABLE INDEX                     84800000
         DC    Y(IS-ENTRY)              ROUTINE VECTOR                  84880000
         ORG   IS+2*JTEXTRN             TABLE INDEX                     84960000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  85040000
         ORG   IS+2*JTWXTRN             TABLE INDEX                     85120000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  85200000
         ORG   IS+2*JTCXD               TABLE INDEX                     85280000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  85360000
         ORG   IS+2*JTLTORG             TABLE INDEX                     85440000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  85520000
         ORG   IS+2*JTLITR              TABLE INDEX                     85600000
         DC    Y(IS-TRANSFER)           ROUTINE VECTOR                  85680000
         ORG   IS+2*JTSYMBL             TABLE INDEX                     85760000
         DC    Y(IS-SYMBL)              ROUTINE VECTOR                  85840000
         ORG   IS+2*JTEOFII             TABLE INDEX                     86400000
         DC    Y(IS-ENDOFILE)           ROUTINE VECTOR                  86480000
         ORG   IS+2*JTADJII             TABLE INDEX                     86530000
         DC    Y(IS-TRANSFER)           ROUTINE VECTOR                  86580000
         ORG   IS+2*JTPASS              TABLE INDEX                     86630000
         DC    Y(IS-TRANSFER)           ROUTINE VECTOR                  86680000
         ORG   ,                        END-OF-TABLE                    86720000
IIS      EQU   *-2*JTSYMBL              PASS 2 SUBSTITUTION MODE        86800000
         ORG   IIS+2*JTSYMBL            TABLE INDEX                     86880000
         DC    Y(IIS-SYMBOL)            ROUTINE VECTOR                  86960000
         ORG   IIS+2*JTEOFII            TABLE INDEX                     87010000
         DC    Y(IIS-EOFIIS)            ROUTINE VECTOR                  87020000
         ORG   IIS+2*JTLITII            TABLE INDEX                     87200000
         DC    Y(IIS-TRANSFER)          ROUTINE VECTOR                  87280000
         ORG   IIS+2*JTLTEND            TABLE INDEX                     87360000
         DC    Y(IIS-TRANSFER)          ROUTINE VECTOR                  87440000
         ORG   IIS+2*JTADJII            TABLE INDEX                     87490000
         DC    Y(IIS-TRANSFER)          ROUTINE VECTOR                  87500000
         ORG   IIS+2*JTPASS             TABLE INDEX                     87680000
         DC    Y(IIS-TRANSFER)          ROUTINE VECTOR                  87760000
         ORG   IIS+2*JTSYMII            TABLE INDEX                     87840000
         DC    Y(IIS-REHASH)            ROUTINE VECTOR                  87920000
         ORG   ,                        END-OF-TABLE                    88000000
IIA      EQU   *-2*JTSYMBL              PASS 2 ADJUSTMENT MODE          88080000
         ORG   IIA+2*JTSYMBL            TABLE INDEX                     88160000
         DC    Y(IIA-SYMBOL)            ROUTINE VECTOR                  88240000
         ORG   IIA+2*JTEOFII            TABLE INDEX                     88290000
         DC    Y(IIA-BUGOUT)            ROUTINE VECTOR                  88300000
         ORG   IIA+2*JTLITII            TABLE INDEX                     88480000
         DC    Y(IIA-LITRII)            ROUTINE VECTOR                  88560000
         ORG   IIA+2*JTLTEND            TABLE INDEX                     88640000
         DC    Y(IIA-LTORGII)           ROUTINE VECTOR                  88720000
         ORG   IIA+2*JTADJII            TABLE INDEX                     88770000
         DC    Y(IIA-ADJUST)            ROUTINE VECTOR                  88780000
         ORG   IIA+2*JTPASS             TABLE INDEX                     88960000
         DC    Y(IIA-TRANSFER)          ROUTINE VECTOR                  89040000
         ORG   ,                        END-OF-TABLE                    89120000
         SPACE                                                          89200000
         MEND                                                           89280000
./  ADD  SSI=32360329,NAME=XSTBL
         MACRO                                                          00400000
&ID      XSTBL &DUMMY,&TESTRAN=NO,&DIAG=NO,&LEVEL=1                     00800000
         GBLC  &COMPNM                  COMPONENT NAME                  01200000
         LCLC  &NM                      MODULE NAME                     01600000
         JHEAD 'SYMBOL TABLE SUBROUTINES',                             ,02000000
               PHASEID=&ID,LEVEL=&LEVEL                                 02400000
&NM      SETC  '&COMPNM&ID'                                             02800000
*TITLE-  SYMBOL TABLE ROUTINES                                        * 03200000
*                                                                     * 03600000
*FUNCTION/OPERATIONS-                                                 * 04000000
*        THESE ROUTINES MAINTAIN THE SYMBOL TABLE IN THE ASSEMBLER    * 04400000
*   SYMBOL RESOLUTION PHASE.  THE FORMAT OF THE SYMBOL TABLE AND      * 04800000
*   SYMBOL TABLE ENTRIES ARE DESCRIBED IN THE PROLOGUE OF THIS        * 05200000
*   ASSEMBLY.  THE 'STBLOFLO' BIT OF 'SWTCH1' IS SET TO '1' WHEN NO   * 05600000
*   MORE SPACE IS AVAILABLE FOR NEW ENTRIES.   ENTRIES TO THE SYMBOL  * 06000000
*   TABLE ARE HANDELED BY ROUTINE 'ENTER'.  ROUTINE 'FIND' LOOKS UP   * 06010000
*   AN EXISTING ENTRY IN THE SYMBOL TABLE.  ROUTINE 'SUBSET' IS       * 06010100
*   CALLED AT THE END OF SUBSTITUTION MODE TO SUBSET THE SYMBOL       * 06011000
*   TABLE.                                                            * 06020000
*                                                                     * 06400000
*ENTRY POINT-                                                         * 06800000
         ENTRY &NM.01                                                 * 07200000
*                                                                     * 07600000
*INPUT-                                                               * 08000000
*        REGISTERS-      R10 IS AN ADDRESS OF THE ARGUEMENT RECORD.   * 08400000
*                                                                     * 11200000
*OUTPUT-                                                              * 11600000
*        REGISTERS-      R14 IS THE POINTER TO THE SYMBOL TABLE ENTRY.* 12000000
*                                                                     * 12010000
*        PARAMETERS-                                                  * 13200000
*             STBLOFLO-  A SWITCH IN STORAGE, WHEN SET TO ONE,        * 13600000
*                        INDICATES THAT THE SYMBOL TABLE IS FULL      * 14000000
*                                                                     * 14400000
*EXTERNAL ROUTINES-                                                   * 14800000
*        NONE                                                         * 15200000
*                                                                     * 15600000
*EXITS, NORMAL-                                                       * 16000000
*        RETURN TO THE CALLER                                         * 16400000
*                                                                     * 17200000
*EXITS, ERROR-                                                        * 17600000
*        RETURN TO THE CALLER                                         * 18000000
*                                                                     * 18800000
*TABLES/WORK AREAS-                                                   * 19200000
*        HASHTBL-  CONTAINS THE ADDRESS OF A HASH TABLE OF CONTIGUOUS * 19600000
*   FULLWORDS INITIALIZED TO ZEROS.                                   * 20000000
*        SYMDIMEN- 4 CONTIGUOUS FULLWORDS CONTAINING THE ADDRESS OF   * 21200000
*   THE LATEST ENTRY, THE LENGTH OF AN ENTRY IN COMPLEMENT FORM, AND  * 21600000
*   THE ADDRESS AVAILABLE FOR THE LAST ENTRY, RESPECTIVELY.           * 22000000
*                                                                     * 22400000
*ATTRIBUTES-                                                          * 22800000
*        REFRESHABLE                                                  * 23200000
*                                                                     * 23600000
*NOTES-                                                               * 24000000
*                                                                     * 24050000
         EJECT                                                          24100000
         COPY  JCOMMON                                                  24150000
         EJECT                                                          44400000
         COPY  ICOMMON                                                  44800000
         EJECT                                                          45200000
&NM.00   CSECT                                                          45600000
* VS1 REL 2.6 CHANGES                                                   45610002
*C644000                                                        OX00106 45650002
         JMODID                                                         46000000
&NM.01   CONTENTS                                                       46400000
         USING &NM.01,R8                BASE REGISTER                   46800000
         EJECT                                                          47200000
ENTER    BALR  R14,R7                   SAVE REGISTERS IN STACK         47600000
         LR    R8,R12                   SET UP BASE REGISTER            48000000
         MVC   XFLGA(D20),XFLGA-XWORK(R10)   SAVE PARAMETERS            48400000
         BALR  R9,R12                   LOOKUP IN SYMBOL TABLE          48800000
         BE    ENTER9                   ALREADY IN SYMBOL TABLE         49200000
         LM    R2,R5,SYMDIMEN           GET SYMBOL TABLE POINTERS       49600000
         BXH   R3,R4,ENTER1             POINT TO NEXT AVAILABLE SPACE   50000000
         SET   STBLOFLO,ON              SYMBOL TABLE FULL SIGN          50400000
ENTER1   TM    XFLGB,ESDNRSW            SEE IF ESD ITEM                 50800000
         BZ    ENTER5                   NO, JUST A COMMON ENTRY         51200000
         LR    R5,R3                    COMPARAND REGISTER              51600000
         BXLE  R2,R4,ENTER5             SPACE ABOVE THE CROWD           52000000
         STM   R2,R3,SYMDIMEN           SAVE NEW POINTERS               52400000
         MVC   D0(D20,R3),D0(R2)        ROLL OUT                        52800000
         CR    R14,R2                   SEE IF SAME ONE AS LAST         53200000
         BNE   ENTER2                   NOPE                            53600000
         LR    R11,R2                   PASS POINTER                    54000000
         B     ENTER4                   SKIP                            54400000
ENTER2   CR    R11,R2                   SEE IF THIS ONE POINTS TO IT    54800000
         BE    ENTER3                   IT SURE DOES                    55200000
         LR    R3,R11                   PASS POINTER                    55600000
ENTER3   LR    R4,R14                   SAVE THIS POINTER               56000000
         LR    R10,R2                   AND THIS                        56400000
         AH    R10,=H'-8'               FAKE THIS ONE                   56800000
         BALR  R9,R12                   LOOKUP THIS ONE IN SYMBOL TABLE 57200000
         ST    R4,D0(,R2)               CHAIN POINTER                   57600000
         MVC   D1(D3,R3),SYMDIMEN+D1    CHAIN THEM TOGETHER THE NEW WAY 58000000
ENTER4   MVC   D1(D3,R11),SYMDIMEN+D5   CONNECT THIS TO THE CHAIN       58400000
         LR    R14,R2                   MAKE NEW ALSO CURRENT           58800000
         B     ENTER6                   SKIP                            59200000
ENTER5   STM   R2,R3,SYMDIMEN           SAVE NEW POINTERS               59600000
         MVC   D1(D3,R11),SYMDIMEN+D5   CHAIN POINTER                   60000000
         ST    R14,D0(,R3)              CHAIN POINTER                   60400000
         LR    R14,R3                   CURRENT ENTRY POINTER           60800000
ENTER6   SR    R10,R10                  DEFINE EXIT                     61200000
ENTER7   MVC   SNAME(D10),XNAME         NAME AND LENGTH ATTRIBUTE       61600000
ENTER8   MVC   SESDI(D6),XESDI          ESDID AND VALUE                 62000000
         MVC   SFLGS,XFLGB              FLAGS                           62400000
         LTR   R10,R10                  SEE IF ALL DONE                 62800000
         BZ    EXIT                     FINIS                           63200000
         TM    XFLGB,ESDNRSW            SEE IF VALID ENTRY              63600000
         BO    ENTRY88                  NOT VALID ENTRY                 64000000
         TM    XESDI,CSW+DSW+ESW        SEE IF INVALID ENTRY    OX00106 64400002
         BNZ   ENTRY88                  NO GOOD ENTRY                   64800000
         LH    R0,XESDI                 SEE IF ABSOLUTE                 65200000
         LTR   R0,R0                    SEE IF ABSOLUTE                 65600000
         BE    EXIT                     ILLEGAL ENTRY IF ABSOLUTE       66000000
         SET   XENTRY,ON                INDICATE VALID ENTRY            66400000
         LR    R5,R14                   SAVE POINTER                    66800000
         GOTO  GETESD                   GET ESD ENTRY                   67200000
         MVI   ETYPE-EITEM(R10),ETYPELD      NEW TYPE                   67600000
         MVC   EESDI-EITEM(D6,R10),XESDI     ESDID AND VALUE            68000000
         MVC   ENAME-EITEM(D8,R10),XNAME     NAME                       68400000
         LR    R14,R5                   RESTORE POINTER                 68800000
ENTRY88  SR    R10,R10                  SET CONDITION CODE              69200000
         B     EXIT                     AND RETURN                      69600000
ENTER9   GOIF  ENTRYSW,ON=ENTER10       SEE IF ENTRY ITEM               70000000
         TM    *,BIT0                   INDICATE PREVIOUSLY DEFINED     70400000
         B     EXIT                     RETURN                          70800000
ENTER10  LH    R10,SLNGQ                GET ESD ASCENDSION NUMBER       71200000
         B     ENTER7                   SET LENGTH ATTRIBUTE            71600000
         SPACE                                                          72000000
         DROP  R8                       CHANGE BASE                     72400000
         USING &NM.01,R12               BASE REGISTER                   72800000
FIND     LM    R14,R15,XNAME-XWORK(R10) GET NAME                        73200000
         MR    R14,R14                  HASH                            73600000
         XR    R14,R15                  FOLD                            74000000
         SRL   R14,D3                   X                               74400000
         N     R14,=F'252,-4'           MASK                            74800000
         LA    R14,HASHTBL(R14)         POINT TO BEGINNING OF CHAIN     75200000
FIND2    LR    R11,R14                  CLIMB                           75600000
         L     R14,SCHPT-SCHPT(,R11)    FIND NEXT ENTRY                 76000000
         LA    R14,SCHPT                ZERO FLAG BYTE                  76400000
         LTR   R14,R14                  SEE IF END-OF-CHAIN             76800000
         BZ    FIND3                    END-OF-CHAIN, NOT FOUND         77200000
         CLC   SNAME,XNAME-XWORK(R10)   SEE IF FOUND                    77600000
         BL    FIND2                    ENTRY NOT REACHED               78000000
         BCR   D8,R9                    RETURN FOUND                    78400000
FIND3    TM    *,BIT0                   SET NOT FOUND CONDITION         78800000
         BCR   D1,R9                    RETURN NOT FOUND                79200000
         SPACE                                                          79600000
SUBSET   BZR   R9                       EXIT IF SUBSETTED THIS ROUND    79800000
         SET   STBLOFLO,OFF             INDICATE SUBSETTED              80000000
         L     R0,SYMDIMEN              GET                             80200000
         LM    R10,R11,=F'252,-4'       HASH TABLE INDEX                80400000
SUBSET1  LA    R15,HASHTBL(R10)         PASS ONE END OF THE CHAIN       80800000
         BAL   R1,SUBSET3               SUBSET ONE CHAIN AT A TIME      81200000
         BXH   R10,R11,SUBSET1          JUGGLE INDEX                    81600000
         ST    R0,SYMDIMEN+D4           NEWLY RECLAIMED AREA POINTER    82000000
         BR    R9                       RETURN                          82400000
SUBSET2  MVC   D1(D3,R15),D1(R14)       YOU'RE A LOSER                  82800000
SUBSET3  L     R14,D0(,R15)             GET NEXT ENTRY POINTER          83200000
         LA    R14,D0(,R14)             ISOLATE ADDRESS PORTION         83600000
         LTR   R14,R14                  SEE IF AT END-OF-CHAIN          84000000
         BCR   D8,R1                    RETURN IF AT END                84400000
         CR    R14,R0                   IS THIS WORTHY                  84800000
         BL    SUBSET2                  BAD, ON THE WRONG SIDE OF TRACK 85200000
         LR    R15,R14                  TUCK ON THE CHAIN               85600000
         B     SUBSET3                  CLIMB                           86000000
         MEND                                                           86400000
./  ADD  SSI=71710282,NAME=X5COM
* /* START OF SPECIFICATIONS ****                                       00100000
*02* PROCESSOR = ASSEMBLER                                              00200000
**** END OF SPECIFICATIONS ***/                                         00300000
*                                                                       00400000
* ASSEMBLY PHASE COMMON AREA AS OF 05/11/69                             00800000
*                                                                       01200000
         SPACE                                                          01600000
*C311800                                                       @AZ07356 01650006
*A311900                                                       @AZ07356 01700006
X5COM    DSECT                                                          02000000
         SPACE                                                          02400000
* THE FOLLOWING FIELDS MUST BE INITIALIZED                              02800000
         SPACE                                                          03200000
ELCTR    DS    3F                       CURRENT LOCATION COUNTER        03600000
TXTPTR   DS    F                        TEXT POINTER                    04000000
STMTN    DS    F                        STATEMENT NUMBER-LIKEWISE       04400000
LNCNT    DS    F                        LINE COUNT-INIT TO 1            04800000
         SPACE                                                          05200000
LEFTHF   DS    0CL21              LEFT HALF INPUT TO PRINT ROUTINE      05600000
LOCATN   DS    F                        LOCATION OF ENTRY               06000000
DCDATA   DS    CL8                      FIELD FOR DC INPUT DATA         06400000
         ORG   DCDATA                   ORG BACK FOR MACHINE OP         06800000
LHOPCD   DS    H                        OPCODE FOR MACHINE INSTRUCTION  07200000
         ORG   LHOPCD+1                 ORG BACK FOR IMMEDIATE BYTE     07600000
LHIMD    DS    X                                                        08000000
BASDS1   DS    H                        BASE-DISPLACEMENT 1             08400000
BASDS2   DS    H                        BASE-DISPLACEMENT 2             08800000
         ORG                                                            09200000
ADDRS1   DS    F                        ADDRESS OF FIRST OPERAND        09600000
ADDRS2   DS    F                        ADDRESS OF SECOND OPERAND       10000000
LHFLGS   DSW   ENTDC,                   ENTRY IS A DC                  X10400000
               ENTALN,                  ENTRY IS ALIGNMENT             X10800000
               LHLNG,                   LENGTH OF OUTPUT DATA          X11200000
               EOUBIT                   EQU ORG OR USING BIT            11250000
DNTPLH   EQU   BIT4+BIT5+BIT6+BIT7      DON'T PRINT LEFT HALF           12000000
LHEND    EQU   *                        END OF LEFT HALF                12400000
CRDCNT   DS    H                        BYTE COUNT IN TEXT (TXT) CARD   12800000
         SPACE                                                          13200000
SYMDEF   DS    F                        POINTER TO DEFINITION DATA      13600000
SYMXRF   DS    F                        COUNT OF SYMBOLS XREF-ED THIS  *14000003
                                         STATEMENT              OX02675 14400003
SYMCNT   DS    C                        COUNT OF SYMBOLS THIS STATEMENT 14800000
AOPF     DSW   USSRT,                   USING SORT FLAG                X15200000
               OPNPRS,                  OPERAND PRESENT FLAG           X15600000
               DCCOMP,                  DC COMPLETE SWITCH             X16000000
               DCSTRT,                  OUTPUT OF DC ALREADY STARTED   X16400000
               DCMOP,                   DC FINAL MOP-UP SWITCH         X16800000
               DCSWH,                   DC SWITCH                      X17200000
               NAMPRS                   NAME PRESENT SWITCH             17600000
DCEVSW   DSW   DSSW,                    INDICATOR FOR STATEMENT A DS   X18000000
               DXDSW,                   INDICATOR FOR STATEMENT A DXD  X18400000
               DLOCTREF,                SWITCH FOR L'*                 X18800000
               NOTEWL,                  INDICATE A NOTE BAY BE NECESS. X19200000
               NOTEHS,                  INDICATE A POINT WILL BE NEC.  X19600000
               LITRSW,                  LITERAL PRESENT SWITCH         X20000000
               XRFNO,                   TURN OFF XREF                  X20400000
               DUPEVAL                  DUPLICATE EVAL OF DATA CONST    20450000
X5SW1    DSW   WRPFLG,                  WRAP OF LOCATION COUNTER FLAG  X20800000
               LTDECV,                  LITERAL IN MACHINE OP          X21200000
               COLOVLP,                 COLUMN PTR OVERLAPPED          X21600000
               ERRBIT,                  ERROR LOGGING BIT              X22000000
               TWASLC,                  TITLE WAS LAST ENTRY           X22050000
               PERR,                    ERRORS DETECTED IN LAST STMT   X22100000
               TPTEXT,                  TITLE PUNCH OPERAND VALIDITY   X22150000
               PRPP                     FORCE PRINT OF POP OR PUSH      22250000
USPHL    DS    H                        USING PUSH-DOWN LEVEL           22400000
SWITCHES DS    0F                                                       22800000
PRINTSW  DSW   PSTMT,                   PRINT STATEMENT                X23200000
               PGEN,                    SWITCH TO PRINT GENERATED TEXT X24000000
               PDATA                    SWITCH TO PRINT DC DATA         24400000
CARDP    DSW   CDPTR1                   CARD POINTER FLAG               25600000
FLDSW    DSW   PNAME,                   NAME FIELD IN STMT             X26000000
               POPER,                   OPCODE FIELD IN STMT           X26400000
               POPND,                   OPERAND FIELD IN STMT          X26800000
               PCOMM                    COMMENTS FIELD IN STMT          27200000
X5VSW    DSW   VLIT,                    LITERAL IN EXPR - SET BY X5V   X27600000
               ZAPIT                    SET TO INDICATE ZERO LEFTHF     27650000
X5MSW    DSW   E2PR,                    EXPRESSIO 2 PRESENT            *28000000
               E3PR,                    EXPRESSION 3 PRESENT           *28400000
               E1ERR,                   EXPR1 COMPLEXLY RELOCATABLE    *28800000
               E2ERR,                   EXPR 2 SIMPLY OR COMPL REL     *29200000
               E3ERR,                   EXPR 3 SIMPLY OR COMPL REL     *29600000
               TOOMANY,                 TOO MANY OPERANDS *            *30000000
               LEAVE,                   LEAVE X5M (SYNTAX ERROR)       *30400000
               ABSUS                    A USING WITH ABS VALUE EXISTS   30800000
X5ASW    DSW   MNOPRT,                  MNOTE NOT TO BE PRINTED        X31000000
               REPCARD,                 PRINT ONLY REPRO CARD EXPECTED X31050000
               INVCNOP,                 ERROR IN CNOP OPERAND          X31100000
               SPACECC,                 TO CONTROL SPACE ON TOP OF PAGE*31150000
               TERR,                    ERROR TO TERM REST OF STMT REQ *31170002
               NOOP,                    NO OPERAND ON DC STMT          *31180006
               EQUOPR                   MORE THAN 1OPER IN EQU @AZ07356 31190006
FLDEND   EQU   *                        END OF FIELD TO BE INITIALIZED  31200000
*                                       TO ZERO                         31600000
LISTSW   DS    C                        TO ISOLATE THE JLIST SWITCH     32000000
EESDI    DS    H                   CURRENT ESDID                        32400000
JTITLE   DS    CL100                    TITLE                           32800000
         EJECT                                                          33200000
* THE FOLLOWING FIELDS NEED NOT BE INITIALIZED                          33600000
DWORD1   DS    D                                                        34000000
DWORD2   DS    D                                                        34400000
FNTEND   DS    F                        END OF FAR INSTRUCTION ENTRY    34800000
OPNADR   DS    F                        OPERAND POINTER                 35200000
STRADR   DS    F                         STRING GROUP POINTER           35600000
PRNSAVE  DS    F                        LINK REGISTER SAVE WORD         36000000
FLDSAVE  DS    F                        LINK REGISTER SAVE WORD         36400000
X5LSAV   DS    3F                       LOG ERROR REGISTER SAVE         36800000
         SPACE                                                          37200000
MWORK    EQU   *                                                        37600000
EXP2     DS    0F                      EXPRESSION 2 VALUE               38000000
         DS    3X                       SPACE                           38400000
I        DS    X                        INDEX OR LENGTH FIELD           38800000
EXP3     DS    0F                      EXPRESSION 3 VALUE               39200000
         DS    3X                       SPACE                           39600000
BASEX    DS    X                        BASE REGISTER                   40000000
DISPL    DS    H                        DISPLACEMENT FIELD              40400000
LQ1      DS    H                        LENGTH ATTRIBUTE OF EXPR1       40800000
MWEND    EQU   *                                                        41200000
MWLEN    EQU   MWEND-MWORK              LENGTH OF X5M WORK AREA         41600000
         SPACE                                                          42000000
         CNOP  2,4                      ALIGN IN MIDDLE OF WORD         42400000
USINGT   DS    68H                      CURRENT USING TABLE             42800000
         DS    (4*68)H                  SPACE FOR PUSHED TABLES         43200000
PRPU     DS    5H                       PRINT PUSHDOWN AREA             43600000
HWD      DS    H                        SCRATCH HALFWORD                44000000
JBGNCL   DS    H                       BEGIN COLUMN (FROM ICTL)         44400000
JCNTCL   DS    H                        CONYINUE COLUMN(ICTL)           44800000
JENDCL   DS    H                        END COL-1(ALSO ICTL)            45200000
CDSTMT   DS    H                        CARD-WITHIN-STATEMENT COUNTER   45600000
SALOC    DS    H                        S PART ALLOC(HALFWORD NUMBER)   46000000
LHWORK   DS    0CL43                    WORK AREA TO UNPACK LEFT HALF   46400000
ULOCO    DS    CL8                      LOCATION                        46800000
UOPCOD   DS    CL4                      OPCODE + SECOND BYTE            47200000
UBASD1   DS    CL4                      BASE-DISPLACEMENT 1             47600000
UBASD2   DS    CL4                      BASE-DISPLACEMENT 2             48000000
UGARB    DS    CL4                      GARBAGE                         48400000
UADR1    DS    CL8                      ADDRESS 1                       48800000
UADR2    DS    CL8                      ADDRESS 2                       49200000
         DS    CL3                                                      49600000
PRNSV1   DS    F                        PRINT BUFFER SAVE AREA          50000000
CRDLAC   DS    H                        BYTE COUNT IN LAST CARD         50400000
COLSAV   DS    H                        COLUMN PTR SAVE AREA            50800000
CRDPTR   DS    F                        POINTER TO TEXT (TXT) CARD      51200000
CRDVAL   DS    F                        VALUE OF TEXT (TXT) CARD        51600000
LOCLEN   DS    F                        ENTRY LENGTH FOR LOCATION UPDAT 52000000
NOTEVAL  DS    CL8                      NOTE POINT SAVE                 52400000
LITRLC   DS    F                        LITERAL LOCATION COUNTER        52800000
LITPID   DS    H                        LITERAL POOL ID                 53200000
LITRSD   DS    H                        LITERAL ESD                     53600000
WORKAREA DS    8F                       DEC CONVERT I/O AREA            54000000
BITLSW   EQU   WORKAREA                 BIT-LENGTH FLAG                 54400000
EBYTE    EQU   WORKAREA+1               DEC CONVERT ERROR FLAG-BYTE     54800000
TYPE     EQU   WORKAREA+3               CONSTANT-TYPE BUCKET CODE       55200000
LMOD     EQU   WORKAREA+4               LENGTH-MODIFIER                 55600000
SMOD     EQU   WORKAREA+8               SCALE-MODIFIER                  56000000
EMOD     EQU   WORKAREA+12              EXPONENT-MODIFIER               56400000
DECKON   EQU   WORKAREA+16              16 BYTE CONVERTED CONSTANT      56800000
PRNTSV   DS    3F                       REGISTER SAVE FOR PRINT         57200000
PREGSV   DS    2F                       PRINT SAVE AREA                 57600000
DUPF     DS    F                        DUP-FACTOR STORAGE              58000000
BITMOD   DS    F                        CONSTANT LENGTH IN BITS         58400000
STRTLC   DS    F                        BIT LC SAVE                     58800000
KLENGTH  DS    F                        CONSTANT SCAN-LENGTH IN BITS    59200000
OUTSTART DS    F                        CONVERTED OUTPUT ADDRESS        59600000
FULLWD   DS    F                        SAVE WORD                       60000000
KONSTRT  DS    F                        CONSTANT FIELD START            60400000
KCOUNT   DS    H                        CONSTANT COUNT                  60800000
LMODSW   DS    C                        EXPLICIT-LENGTH FLAG            61200000
SKLOG    DS    C                        ERROR-LOG BYPASS FLAG           61600000
ZDUPSW   DS    C                        ZERO DUP-FACTOR FLAG            62000000
SIGNSW   DS    C                        MINUS-SIGN FLAG                 62400000
MTSW     DS    C                        EMPTY DS FLAG                   62800000
CLEAR2   EQU   *                        LITTLE CLEAR                    63200000
TEMPLC   DS    F                        TEMPORARY LOCATION-COUNTER      63600000
BITLC    DS    F                        LOCATION-COUNTER IN BITS        64000000
XREFYES  DS    F                        $XREF SAVE                      64400000
OPNDCT   DS    H                        OPERAND COUNT                   64800000
OBITS    DS    H                        CURRENT OUTPUT-BIT COUNT        65200000
DCPRSW   DS    C                        PRINTSW SAVE                    65600000
DUMSW    DS    C                        DS OR DXD FLAG                  66000000
FSTPSW   DS    C                        FIRST-TIME PRINT FLAG           66400000
TUBEOP   DS    C                        INTERLUDE BAD OPERAND NUMBER    66800000
CLEAR1   EQU   *                        BIG CLEAR                       67200000
* WORK AREA STORAGE LAY-OUT FOR EVAL                                    67600000
*                                                                       68000000
         EVALWORK                                                       68400000
         DS    64C                      ADDITIONAL WORK AREA DC EVAL    68800000
LCTRSAV  DS    4F                       SAVE AREA                       69200000
LHSAVE   DS    CL21                     LEFT HALF SAVE AREA             69600000
ENDSTMNO DS    F                        STATEMENT NO. OF END STATEMENT  69700000
X5ATEMP  DS    CL256                    TEMP TITLE AND PUNCH BLD AREA   69750000
*                                       ALSO ERR LOG AREA IN X5D        69800000
X5ALIT   DS    CL300                    LITERAL RECORD BUILD AREA       69850000
DCLNG    DS    F                        ACCUM OBJECT LENGTH OF BAD DC   69860000
MODNOTV  DS    CL8                      TERM-NOTE VAL TO MODEL STMT     69862000
MODSTMT  DS    H                        STMTN FOR MODEL STMT            69864000
MODEL    DS    CL600                    MODEL STATEMENT SAVE AREA       69866000
*                                       USED TO CHECK IF IT IS TOO LONG 69870000
X5COMEND EQU   *                        END OF PHASE COMMON             70000000
X5COMLEN EQU   (X5COMEND-X5COM-1)/8+1   COMMON LENGTH IN DOUBLE WORDS   70400000
LSTOUT   EQU   0                        INDEX FOR LISTING               70800000
CAROUT   EQU   4                        INDEX FOR CARRIAGE CONTROL      71200000
PUNOUT   EQU   8                        INDEX FOR PUNCH STATEMENT       71600000
RPOOUT   EQU   12                       INDEX FOR REPRO STATEMENT       72000000
DC0OUT   EQU   16                       INDEX FOR DC STATEMENT          72400000
ERROUT   EQU   20                       INDEX FOR LISTING *** ERROR***  72800000
CMNOUT   EQU   24                       INDEX FOR LISTING COMMENTS      73200000
CLMPTR   EQU   BIT0                     COLUMN POINTER FLAG             73600000
DTAPTR   EQU   BIT1                     ERROR POINTER IS TO DATA        74000000
HIREG    EQU   15                       HIGEST REGISTER POSSIBLE        74400000
* CONDITION CODE SETTINGS FOR X5V                                       74800000
ABSX     EQU   8                   EXPR IS ABSOLUTE                     75200000
CMPX     EQU   4                   EXPR IS COMPL REL,OR NON-SYNTACTIC  *75600000
                                   ERROR(S) DETECTED IN EXPR            76000000
RELX     EQU   2                   EXPR IS SIMPLY RELOCATABLE           76400000
ERRX     EQU   1                   FATAL ERROR - EXPR EVAL ABANDONED    76800000
         SPACE                                                          77200000
         EJECT                                                          77600000
* THIS DSECT DESCRIBES THE FORMAT OF AN ENTRY IN THE USING              78000000
* TABLE (USINGT).THE ENTRIES IN THE TABLE ARE SORTED IN DESCENDING      78400000
* SEQUENCE ON THEIR CONTENTS.                                           78800000
         SPACE                                                          79200000
UDSECT   DSECT ,                        USING TABLE ENTRY DSECT         79600000
         CNOP  2,4                      ALIGN IN MIDDLE OF WORD         80000000
UESD     DS    H                        ESDID FOR USING VALUE           80400000
UVAL     DS    F                        VALUE SPECIFIED IN USING STMT   80800000
UREG     DS    H                        REGISTER                        81200000
USNXT    EQU   *                        NEXT ENTRY                      81600000
USSL     EQU   L'UESD+L'UVAL+L'UREG     TOTAL LENGTH OF USING ENTRY     82000000
./  ADD  SSI=21950370,NAME=X5ERRL
         MACRO                                                          09000000
&NAME    X5ERRL &A,&B,&C                                                18000000
.*       MACRO GENERATES A CALL TO THE PHASE 5 ERROR LOGGING            18050000
.*       ROUTINE X51 WITH THE ERROR NUMBER AS A PARAMETER               18100000
&NAME    JCALL LOGERR                                                   27000000
         DC    AL1(SEV&A,ERR&A,&B,0)        (SEVERITY,ERROR NO.,FLAG,0) 36000000
         AIF   ('&C' EQ '').A100                                        45000000
         B     &C                       RECOVER OR ABORT RECORD         54000000
.A100    ANOP                                                           63000000
         MEND                                                           72000000
