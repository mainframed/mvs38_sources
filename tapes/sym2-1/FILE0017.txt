./  ADD  SSI=73080179,NAME=IAPABNAP
         TITLE 'IAPABNAP - AP-1 ABNORMAL END APPENDAGE                 *00001000
                        '                                               00002000
IAPABNAP CSECT ,                                                01S0001 00003000
@PROLOG  DS    0H                                               01S0002 00004000
*                                                               01S0133 00005000
           USING IAPABNAP,GPR15P                                        00006000
*   /*****************************************************************/ 00007000
*   /*                                                               */ 00008000
*   /* THIS SECTION FOR HARDWARE TEST                                */ 00009000
*   /*                                                               */ 00010000
*   /*****************************************************************/ 00011000
*                                                               01S0134 00012000
*   IF IOBECBCC=NRMC&(ADDR(IOBCSW)-1)->CSWUNCHK=ON&AP1RDTST=OFF THEN    00013000
         CLI   IOBECBCC(GPR02P),X'7F'                           01S0134 00014000
         BNE   @RF00134                                         01S0134 00015000
         LA    @12,IOBCSW(,GPR02P)                              01S0134 00016000
         TM    CSWUNCHK-1(@12),B'00000010'                      01S0134 00017000
         BNO   @RF00134                                         01S0134 00018000
         L     @12,IOBAP1PT(,GPR02P)                            01S0134 00019000
         TM    AP1RDTST(@12),B'00000010'                        01S0134 00020000
         BNZ   @RF00134                                         01S0134 00021000
*                                   /* 1ST ENTRY, UNIT CHECK AND HDWE   00022000
*                                      TEST                          */ 00023000
*     DO;                                                       01S0135 00024000
*       IF EWDEDAT=ON&AP1EDP=OFF THEN/* ENVIRONMENTAL DATA PRESENT      00025000
*                                      (EDP) --FIRST TIME            */ 00026000
         L     @11,RQESRB(,GPR01P)                              01S0136 00027000
         L     @11,SRBPARM(,@11)                                01S0136 00028000
         L     @11,IOSERP(,@11)                                 01S0136 00029000
         TM    EWDEDAT(@11),B'00010000'                         01S0136 00030000
         BNO   @RF00136                                         01S0136 00031000
         TM    AP1EDP(@12),B'00100000'                          01S0136 00032000
         BNZ   @RF00136                                         01S0136 00033000
*         DO;                                                   01S0137 00034000
*           AP1EDP=ON;              /* INDICATE EDP                  */ 00035000
*           AP1IOC=OFF;             /* MUST REDO I/O                 */ 00036000
         OI    AP1EDP(@12),B'00100000'                          01S0139 00037000
         NI    AP1IOC(@12),B'10111111'                          01S0139 00038000
*         END;                                                  01S0140 00039000
*       ELSE                        /* NO EDP OR SECOND TIME         */ 00040000
*         DO;                                                   01S0141 00041000
         B     @RC00136                                         01S0141 00042000
@RF00136 DS    0H                                               01S0142 00043000
*           AP1SNS=EWDASNS;         /* SAVE SNS IN AP1               */ 00044000
         L     @12,IOBAP1PT(,GPR02P)                            01S0142 00045000
         L     @11,RQESRB(,GPR01P)                              01S0142 00046000
         L     @11,SRBPARM(,@11)                                01S0142 00047000
         L     @11,IOSERP(,@11)                                 01S0142 00048000
         MVC   AP1SNS(24,@12),EWDASNS(@11)                      01S0142 00049000
*           AP1NOERP=ON;            /* DONT GO TO ERPS               */ 00050000
         OI    AP1NOERP(@12),B'00001000'                        01S0143 00051000
*         END;                                                  01S0144 00052000
*     END;                                                      01S0145 00053000
*   ELSE                            /* NOT 1ST ENTRY, UNIT CHK OR       00054000
*                                      HDWE TEST                     */ 00055000
*                                                               01S0146 00056000
*     /***************************************************************/ 00057000
*     /*                                                             */ 00058000
*     /* THIS SECTION FOR DATA VERIFY TEST                           */ 00059000
*     /*                                                             */ 00060000
*     /***************************************************************/ 00061000
*                                                               01S0146 00062000
*     IF IOBECBCC=ERRC&(ADDR(IOBCSW)-1)->CSWUNCHK=ON&AP1RDTST=ON THEN   00063000
         B     @RC00134                                         01S0146 00064000
@RF00134 CLI   IOBECBCC(GPR02P),X'41'                           01S0146 00065000
         BNE   @RF00146                                         01S0146 00066000
         LA    @12,IOBCSW(,GPR02P)                              01S0146 00067000
         TM    CSWUNCHK-1(@12),B'00000010'                      01S0146 00068000
         BNO   @RF00146                                         01S0146 00069000
         L     @12,IOBAP1PT(,GPR02P)                            01S0146 00070000
         TM    AP1RDTST(@12),B'00000010'                        01S0146 00071000
         BNO   @RF00146                                         01S0146 00072000
*                                   /* 2ND ENTRY, UNIT CHK AND READ     00073000
*                                      VERIFICATION TEST             */ 00074000
*       DO;                                                     01S0147 00075000
*         IF IOSERPÂ¬=0 THEN         /* EWA PRESENT                   */ 00076000
         L     @11,RQESRB(,GPR01P)                              01S0148 00077000
         L     @11,SRBPARM(,@11)                                01S0148 00078000
         L     @11,IOSERP(,@11)                                 01S0148 00079000
         LTR   @11,@11                                          01S0148 00080000
         BZ    @RF00148                                         01S0148 00081000
*           AP1SNS=EWDASNS;         /* MOVE IN SENSE                 */ 00082000
         MVC   AP1SNS(24,@12),EWDASNS(@11)                      01S0149 00083000
*         ELSE                      /* SENSE ONLY IN IOB             */ 00084000
*           DO;                                                 01S0150 00085000
         B     @RC00148                                         01S0150 00086000
@RF00148 DS    0H                                               01S0151 00087000
*             AP1SNS(1)=IOBSENS0;   /* SENSE FROM IOB                */ 00088000
         L     @12,IOBAP1PT(,GPR02P)                            01S0151 00089000
         MVC   AP1SNS(1,@12),IOBSENS0(GPR02P)                   01S0151 00090000
*             AP1SNS(2)=IOBSENS1;   /* SENSE FROM IOB                */ 00091000
         MVC   AP1SNS+1(1,@12),IOBSENS1(GPR02P)                 01S0152 00092000
*           END;                                                01S0153 00093000
*       END;                                                    01S0154 00094000
*     ELSE                                                      01S0155 00095000
*       ;                           /* NOT 2ND ENTRY, UCK OR DATA       00096000
*                                      VERIFICATION TEST             */ 00097000
*                                                               01S0155 00098000
@RF00146 DS    0H                                               01S0156 00099000
*   /*****************************************************************/ 00100000
*   /*                                                               */ 00101000
*   /* IF NOERP ON, POST 41 AND TAKE NO POST EXIT-- RETURN WILL BE   */ 00102000
*   /* DIRESTLY TO IOS                                               */ 00103000
*   /*                                                               */ 00104000
*   /*****************************************************************/ 00105000
*                                                               01S0156 00106000
*   IF AP1NOERP=ON THEN             /* BYPASS ERP AND POST 41        */ 00107000
@RC00146 DS    0H                                               01S0156 00108000
@RC00134 L     @12,IOBAP1PT(,GPR02P)                            01S0156 00109000
         TM    AP1NOERP(@12),B'00001000'                        01S0156 00110000
         BNO   @RF00156                                         01S0156 00111000
*     DO;                                                       01S0157 00112000
*       GPR14P=GPR14P+NOPOST;       /* NO POST RETURN                */ 00113000
         AL    GPR14P,@CF00035                                  01S0158 00114000
*       IOBIOERR=OFF;               /* RESET                         */ 00115000
         NI    IOBIOERR(GPR02P),B'11111011'                     01S0159 00116000
*       AP1NOERP=OFF;               /* RESET                         */ 00117000
         NI    AP1NOERP(@12),B'11110111'                        01S0160 00118000
*       RFY                                                     01S0161 00119000
*        (GPR10F,                                               01S0161 00120000
*         GPR11P,                                               01S0161 00121000
*         GPR12P) RSTD;             /* REGS FOR POST                 */ 00122000
*       GPR11P=IOBECBPB;            /* ECB POINTER                   */ 00123000
         L     GPR11P,IOBECBPB-1(,GPR02P)                       01S0162 00124000
         LA    GPR11P,0(,GPR11P)                                01S0162 00125000
*       GPR12P=AP1TCBAD;            /* TCB POINTER                   */ 00126000
         L     GPR12P,IOBAP1PT(,GPR02P)                         01S0163 00127000
         L     GPR12P,AP1TCBAD(,GPR12P)                         01S0163 00128000
*       GPR10F=ERRC;                /* ERROR POST CODE               */ 00129000
         LA    GPR10F,65                                        01S0164 00130000
*       GEN(  SLL GPR10F,24  );     /* PUT IN HI BYTE                */ 00131000
           SLL GPR10F,24                                                00132000
*       GPR15P=CVT0PT01;            /* POST ENTRY POINT              */ 00133000
         L     GPR15P,FLCCVT                                    01S0166 00134000
         L     GPR15P,CVT0PT01(,GPR15P)                         01S0166 00135000
*       GEN(  BR GPR15P  );         /* GO POST-RETURN TO IOS         */ 00136000
           BR GPR15P                                                    00137000
*     END;                                                      01S0168 00138000
*   ELSE                                                        01S0169 00139000
*     ;                             /* NORMAL RETURN                 */ 00140000
*                                                               01S0169 00141000
@RF00156 DS    0H                                               01S0170 00142000
*   /*****************************************************************/ 00143000
*   /*                                                               */ 00144000
*   /* EPILOG                                                        */ 00145000
*   /*                                                               */ 00146000
*   /*****************************************************************/ 00147000
*                                                               01S0170 00148000
*   GEN(  BR  GPR14P  );            /* RETURN                        */ 00149000
           BR  GPR14P                                                   00150000
*   GEN DATA DEFS(PATCH);                                       01S0171 00151000
*   END                             /* PROC                          */ 00152000
*                                                               01S0172 00153000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00154000
*/*%INCLUDE SYSLIB  (AP1BLOCK)                                       */ 00155000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 00156000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 00157000
*/*%INCLUDE SYSLIB  (IEZIOB  )                                       */ 00158000
*/*%INCLUDE SYSLIB  (IECDRQE )                                       */ 00159000
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */ 00160000
*/*%INCLUDE SYSLIB  (IECDIOSB)                                       */ 00161000
*/*%INCLUDE SYSLIB  (EWAMAP  )                                       */ 00162000
*/*%INCLUDE SYSLIB  (EWDMAP  )                                       */ 00163000
*                                                               01S0172 00164000
*       ;                                                       01S0172 00165000
@EL00001 DS    0H                                               01S0172 00166000
@EF00001 DS    0H                                               01S0172 00167000
@ER00001 BR    @14                                              01S0172 00168000
@DATA    DS    0H                                                       00169000
@DATD    DSECT                                                          00170000
         DS    0F                                                       00171000
IAPABNAP CSECT                                                          00172000
         DS    0F                                                       00173000
@CF00035 DC    F'4'                                                     00174000
@DATD    DSECT                                                          00175000
         DS    0D                                                       00176000
IAPABNAP CSECT                                                          00177000
         NOPR  ((@ENDDATD-@DATD)*16)                                    00178000
         DS    0F                                                       00179000
@SIZDATD DC    AL1(0)                                                   00180000
         DC    AL3(@ENDDATD-@DATD)                                      00181000
         DS    0D                                                       00182000
IAPABNAP CSECT                                                          00183000
*                                /*  PATCH AREA  */                     00184000
PATCH    DC    13F'0'            THIRTEEN WORD PATCH AREA               00185000
@DATD    DSECT                                                          00186000
@ENDDATD EQU   *                                                        00187000
IAPABNAP CSECT                                                          00188000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00189000
@01      EQU   01                                                       00190000
@02      EQU   02                                                       00191000
@03      EQU   03                                                       00192000
@04      EQU   04                                                       00193000
@05      EQU   05                                                       00194000
@06      EQU   06                                                       00195000
@07      EQU   07                                                       00196000
@08      EQU   08                                                       00197000
@09      EQU   09                                                       00198000
@10      EQU   10                                                       00199000
@11      EQU   11                                                       00200000
@12      EQU   12                                                       00201000
@13      EQU   13                                                       00202000
@14      EQU   14                                                       00203000
@15      EQU   15                                                       00204000
GPR02P   EQU   @02                                                      00205000
GPR01P   EQU   @01                                                      00206000
GPR00P   EQU   @00                                                      00207000
GPR03P   EQU   @03                                                      00208000
GPR04P   EQU   @04                                                      00209000
GPR05P   EQU   @05                                                      00210000
GPR06P   EQU   @06                                                      00211000
GPR07P   EQU   @07                                                      00212000
GPR08P   EQU   @08                                                      00213000
GPR09P   EQU   @09                                                      00214000
GPR10F   EQU   @10                                                      00215000
GPR11P   EQU   @11                                                      00216000
GPR12P   EQU   @12                                                      00217000
GPR14P   EQU   @14                                                      00218000
GPR15P   EQU   @15                                                      00219000
GPR13P   EQU   @13                                                      00220000
PSA      EQU   0                                                        00221000
FLCRNPSW EQU   PSA                                                      00222000
FLCROPSW EQU   PSA+8                                                    00223000
FLCICCW2 EQU   PSA+16                                                   00224000
FLCCVT   EQU   FLCICCW2                                                 00225000
PSAEEPSW EQU   PSA+132                                                  00226000
PSAESPSW EQU   PSA+136                                                  00227000
FLCSVILC EQU   PSAESPSW+1                                               00228000
PSAEPPSW EQU   PSA+140                                                  00229000
FLCPIILC EQU   PSAEPPSW+1                                               00230000
FLCPICOD EQU   PSAEPPSW+2                                               00231000
PSAPICOD EQU   FLCPICOD+1                                               00232000
FLCTEA   EQU   PSAEPPSW+4                                               00233000
FLCPER   EQU   PSA+152                                                  00234000
FLCMCLA  EQU   PSA+168                                                  00235000
FLCIOEL  EQU   FLCMCLA+4                                                00236000
FLCIOA   EQU   FLCMCLA+16                                               00237000
FLCFSA   EQU   FLCMCLA+80                                               00238000
PSASUPER EQU   PSA+552                                                  00239000
PSASUP1  EQU   PSASUPER                                                 00240000
PSASUP2  EQU   PSASUPER+1                                               00241000
PSASUP3  EQU   PSASUPER+2                                               00242000
PSASUP4  EQU   PSASUPER+3                                               00243000
PSACLHT  EQU   PSA+640                                                  00244000
PSALKSA  EQU   PSA+696                                                  00245000
PSAHLHI  EQU   PSA+760                                                  00246000
PSADSSFL EQU   PSA+836                                                  00247000
PSADSSF1 EQU   PSADSSFL                                                 00248000
PSADSSF3 EQU   PSADSSFL+2                                               00249000
PSADSSF4 EQU   PSADSSFL+3                                               00250000
PSARSVT  EQU   PSA+896                                                  00251000
AP1BLOCK EQU   0                                                        00252000
AP1PRINT EQU   AP1BLOCK+8                                               00253000
AP1PFLG1 EQU   AP1BLOCK+144                                             00254000
AP1CCWA  EQU   AP1BLOCK+160                                             00255000
AP1BUFAD EQU   AP1BLOCK+164                                             00256000
AP1TCBAD EQU   AP1BLOCK+172                                             00257000
AP1TIMFL EQU   AP1BLOCK+176                                             00258000
AP1TIMFA EQU   AP1TIMFL                                                 00259000
AP1CSW   EQU   AP1BLOCK+181                                             00260000
AP1SNS   EQU   AP1BLOCK+188                                             00261000
AP1SEEK  EQU   AP1BLOCK+213                                             00262000
CCHHR    EQU   AP1SEEK+3                                                00263000
CCHH     EQU   CCHHR                                                    00264000
HH       EQU   CCHH+2                                                   00265000
AP1CESK  EQU   AP1BLOCK+221                                             00266000
CECCHHR  EQU   AP1CESK+2                                                00267000
CECCHH   EQU   CECCHHR                                                  00268000
AP1FLG2  EQU   AP1BLOCK+244                                             00269000
AP1IOC   EQU   AP1FLG2                                                  00270000
AP1EDP   EQU   AP1FLG2                                                  00271000
AP1NOERP EQU   AP1FLG2                                                  00272000
AP1FLG3  EQU   AP1BLOCK+245                                             00273000
AP1RDTST EQU   AP1FLG3                                                  00274000
AP1FLG4  EQU   AP1BLOCK+246                                             00275000
CVTMAP   EQU   0                                                        00276000
CVTDAR   EQU   CVTMAP+72                                                00277000
CVTFLGS1 EQU   CVTDAR                                                   00278000
CVTDCB   EQU   CVTMAP+116                                               00279000
CVTIOQET EQU   CVTMAP+120                                               00280000
CVTIERLC EQU   CVTMAP+144                                               00281000
CVT0PT01 EQU   CVTMAP+152                                               00282000
CVTHEAD  EQU   CVTMAP+160                                               00283000
CVTSV76C EQU   CVTHEAD                                                  00284000
CVTOPTA  EQU   CVTMAP+182                                               00285000
CVTOPTB  EQU   CVTMAP+183                                               00286000
CVTGTF   EQU   CVTMAP+236                                               00287000
CVTGTFST EQU   CVTGTF                                                   00288000
CVTGTFS  EQU   CVTGTFST                                                 00289000
CVTSTATE EQU   CVTGTFST                                                 00290000
CVTTMODE EQU   CVTGTFST                                                 00291000
CVTFORM  EQU   CVTGTFST                                                 00292000
CVTAQAVT EQU   CVTMAP+240                                               00293000
CVTTCMFG EQU   CVTAQAVT                                                 00294000
CVTVOLM2 EQU   CVTMAP+244                                               00295000
CVTTATA  EQU   CVTVOLM2                                                 00296000
CVTTSKS  EQU   CVTTATA                                                  00297000
CVTVOLF2 EQU   CVTTSKS                                                  00298000
CVTTAT   EQU   CVTTATA+1                                                00299000
CVTATER  EQU   CVTMAP+248                                               00300000
CVTEXT1  EQU   CVTMAP+252                                               00301000
CVTPURG  EQU   CVTMAP+260                                               00302000
CVTQMSG  EQU   CVTMAP+268                                               00303000
CVTDMSR  EQU   CVTMAP+272                                               00304000
CVTRSV37 EQU   CVTDMSR                                                  00305000
CVTDMSRF EQU   CVTRSV37                                                 00306000
CVTERPV  EQU   CVTMAP+316                                               00307000
CVTINTLA EQU   CVTMAP+320                                               00308000
CVTAPF   EQU   CVTMAP+324                                               00309000
CVTEXT2  EQU   CVTMAP+328                                               00310000
CVTHJES  EQU   CVTMAP+332                                               00311000
CVTPGSIA EQU   CVTMAP+348                                               00312000
CVTA1F1  EQU   CVTMAP+356                                               00313000
CVTSYSK  EQU   CVTMAP+357                                               00314000
CVTVOLM1 EQU   CVTMAP+380                                               00315000
CVTVOLF1 EQU   CVTVOLM1                                                 00316000
CVTATMCT EQU   CVTMAP+388                                               00317000
CVTXTNT1 EQU   0                                                        00318000
CVTXTNT2 EQU   0                                                        00319000
CVTDSSV  EQU   CVTXTNT2                                                 00320000
CVTFLGBT EQU   CVTXTNT2+5                                               00321000
CVTQID   EQU   CVTXTNT2+24                                              00322000
CVTRV400 EQU   CVTXTNT2+52                                              00323000
CVTRV409 EQU   CVTXTNT2+53                                              00324000
CVTATCVT EQU   CVTXTNT2+64                                              00325000
CVTRV429 EQU   CVTXTNT2+84                                              00326000
CVTRV438 EQU   CVTXTNT2+85                                              00327000
CVTRV457 EQU   CVTXTNT2+112                                             00328000
CVTRV466 EQU   CVTXTNT2+113                                             00329000
CVTFIX   EQU   0                                                        00330000
CVTRELNO EQU   CVTFIX+252                                               00331000
IOBPREFX EQU   0                                                        00332000
IOBCFLG1 EQU   IOBPREFX                                                 00333000
IOBSTDRD EQU   0                                                        00334000
IOBFLAG1 EQU   IOBSTDRD                                                 00335000
IOBCYCCK EQU   IOBFLAG1                                                 00336000
IOBIOERR EQU   IOBFLAG1                                                 00337000
IOBRSTRT EQU   IOBFLAG1                                                 00338000
IOBFLAG2 EQU   IOBSTDRD+1                                               00339000
IOBPURGE EQU   IOBFLAG2                                                 00340000
IOBRDHA0 EQU   IOBFLAG2                                                 00341000
IOBSENS0 EQU   IOBSTDRD+2                                               00342000
IOBS0B7  EQU   IOBSENS0                                                 00343000
IOBSENS1 EQU   IOBSTDRD+3                                               00344000
IOBECBPT EQU   IOBSTDRD+4                                               00345000
IOBECBCC EQU   IOBECBPT                                                 00346000
IOBECBPB EQU   IOBECBPT+1                                               00347000
IOBFLAG3 EQU   IOBSTDRD+8                                               00348000
IOBFL3   EQU   IOBFLAG3                                                 00349000
IOBCNC   EQU   IOBFL3                                                   00350000
IOBICL   EQU   IOBFL3                                                   00351000
IOBCSW   EQU   IOBSTDRD+9                                               00352000
IOBIOCSW EQU   IOBCSW                                                   00353000
IOBSTBYT EQU   IOBIOCSW+3                                               00354000
IOBUSTAT EQU   IOBSTBYT                                                 00355000
IOBCSTAT EQU   IOBSTBYT+1                                               00356000
IOBSTART EQU   IOBSTDRD+16                                              00357000
IOBDCBPT EQU   IOBSTDRD+20                                              00358000
IOBFLAG4 EQU   IOBDCBPT                                                 00359000
IOBRESTR EQU   IOBSTDRD+24                                              00360000
IOBINCAM EQU   IOBSTDRD+28                                              00361000
IOBBTAMF EQU   IOBINCAM                                                 00362000
RQE      EQU   0                                                        00363000
RQESRB   EQU   RQE+28                                                   00364000
RQEPRT   EQU   RQE+36                                                   00365000
RQETYPE  EQU   RQE+37                                                   00366000
RQETYP3  EQU   RQETYPE                                                  00367000
RQEFLAG  EQU   RQE+38                                                   00368000
RQEFLAG3 EQU   RQE+39                                                   00369000
SRBSECT  EQU   0                                                        00370000
SRB      EQU   SRBSECT                                                  00371000
SRBFLC   EQU   SRB+12                                                   00372000
SRBPARM  EQU   SRB+28                                                   00373000
IOSB     EQU   0                                                        00374000
IOSFLA   EQU   IOSB                                                     00375000
IOSACHN  EQU   IOSFLA                                                   00376000
IOSFLB   EQU   IOSB+1                                                   00377000
IOSFLC   EQU   IOSB+2                                                   00378000
IOSDVALT EQU   IOSFLC                                                   00379000
IOSPKEY  EQU   IOSB+12                                                  00380000
IOSOPT   EQU   IOSB+14                                                  00381000
IOSOPT2  EQU   IOSB+15                                                  00382000
@NM00036 EQU   IOSB+20                                                  00383000
IOSCSW   EQU   @NM00036+1                                               00384000
IOSTATUS EQU   IOSCSW+3                                                 00385000
IOSIPIB  EQU   IOSB+44                                                  00386000
IOSERP   EQU   IOSB+52                                                  00387000
IOSPATH  EQU   IOSB+86                                                  00388000
IOSCHN   EQU   IOSPATH                                                  00389000
IOSCKEY  EQU   IOSB+89                                                  00390000
IOSEEKA  EQU   IOSB+100                                                 00391000
IOSCCHH  EQU   IOSEEKA+3                                                00392000
IOSSKHH  EQU   IOSCCHH+2                                                00393000
EWA      EQU   0                                                        00394000
EWAHDR   EQU   EWA                                                      00395000
EWAFLAGS EQU   EWA+4                                                    00396000
EWAFLG1  EQU   EWAFLAGS                                                 00397000
EWASCCD  EQU   EWAFLG1                                                  00398000
EWASCC3  EQU   EWASCCD                                                  00399000
EWAFLG2  EQU   EWAFLAGS+1                                               00400000
EWAFLG3  EQU   EWAFLAGS+2                                               00401000
EWASNSCT EQU   EWAFLAGS+3                                               00402000
EWACNTRS EQU   EWA+10                                                   00403000
EWAERPIB EQU   EWA+16                                                   00404000
EWARGFG1 EQU   EWAERPIB+4                                               00405000
EWARGFG2 EQU   EWAERPIB+5                                               00406000
EWAXCSW1 EQU   EWAERPIB+6                                               00407000
EWAXCSW2 EQU   EWAERPIB+7                                               00408000
EWAIERP  EQU   EWA+32                                                   00409000
CSW      EQU   0                                                        00410000
CSWADDRA EQU   CSW                                                      00411000
CSWSTATS EQU   CSW+4                                                    00412000
CSWSTAT1 EQU   CSWSTATS                                                 00413000
CSWUNCHK EQU   CSWSTAT1                                                 00414000
ECBCC    EQU   0                                                        00415000
IOBEXTEN EQU   IOBSTDRD+32                                              00416000
IOBSEEK  EQU   IOBEXTEN                                                 00417000
IOBBB    EQU   IOBSEEK+1                                                00418000
IOBCC    EQU   IOBSEEK+3                                                00419000
IOBHH    EQU   IOBSEEK+5                                                00420000
IOBAP1PT EQU   IOBSEEK+8                                                00421000
CVTS01   EQU   CVTPGSIA                                                 00422000
CVTLPDIA EQU   CVTS01+12                                                00423000
CVTDIRST EQU   CVTLPDIA                                                 00424000
CVTSLIDA EQU   CVTS01+24                                                00425000
CVTCTLFG EQU   CVTS01+50                                                00426000
CVTRV210 EQU   CVTS01+424                                               00427000
CVTRV219 EQU   CVTS01+425                                               00428000
CVTRV228 EQU   CVTS01+426                                               00429000
CVTRV237 EQU   CVTS01+427                                               00430000
CVTMFRTR EQU   CVTS01+452                                               00431000
CVTRV262 EQU   CVTS01+468                                               00432000
CVTRV271 EQU   CVTS01+469                                               00433000
CVTRV280 EQU   CVTS01+470                                               00434000
CVTRV289 EQU   CVTS01+471                                               00435000
CVTGSDA  EQU   CVTS01+600                                               00436000
PSARSVTE EQU   PSARSVT                                                  00437000
IOBORG01 EQU   IOBPREFX+8                                               00438000
IOBNIOBA EQU   IOBORG01                                                 00439000
IOBNFLG1 EQU   IOBNIOBA                                                 00440000
IOBPRTOV EQU   IOBNFLG1                                                 00441000
IOBORG02 EQU   IOBPREFX+8                                               00442000
IOBDQADA EQU   IOBORG02                                                 00443000
IOBDEQIN EQU   IOBDQADA                                                 00444000
IOBORG03 EQU   IOBPREFX+12                                              00445000
IOBORG04 EQU   IOBINCAM                                                 00446000
IOBORG12 EQU   IOBINCAM                                                 00447000
IOBFL4   EQU   IOBORG12                                                 00448000
IOBORG05 EQU   IOBEXTEN                                                 00449000
IOBORG06 EQU   IOBEXTEN                                                 00450000
IOBNXTPT EQU   IOBORG06+4                                               00451000
IOBSTATA EQU   IOBNXTPT                                                 00452000
IOBORG07 EQU   IOBEXTEN+8                                               00453000
W1IEXTEN EQU   IOBORG07                                                 00454000
IOBORG08 EQU   IOBEXTEN+8                                               00455000
IOBINDCT EQU   IOBORG08+4                                               00456000
IOBUNSQR EQU   IOBORG08+5                                               00457000
IOBFCHAD EQU   IOBORG08+8                                               00458000
IOBORG09 EQU   IOBEXTEN+8                                               00459000
IOBDPLAD EQU   IOBORG09+4                                               00460000
IOBDTYPE EQU   IOBORG09+8                                               00461000
IOBDTYP2 EQU   IOBORG09+9                                               00462000
IOBDSTAT EQU   IOBORG09+10                                              00463000
IOBSTAT1 EQU   IOBDSTAT                                                 00464000
IOBORG10 EQU   IOBEXTEN+8                                               00465000
IOBSEEK2 EQU   IOBORG10                                                 00466000
IOBORG11 EQU   IOBEXTEN                                                 00467000
IOBERCT  EQU   IOBORG11                                                 00468000
IOBUCBXV EQU   IOBERCT                                                  00469000
IOBNAME  EQU   IOBORG11+4                                               00470000
IOBORG13 EQU   IOBEXTEN                                                 00471000
IOBSKADR EQU   IOBORG13                                                 00472000
IOSATTSC EQU   IOSIPIB                                                  00473000
IOSWTOWA EQU   IOSIPIB                                                  00474000
IOSPCISC EQU   IOSIPIB                                                  00475000
EWADDIOS EQU   EWAIERP                                                  00476000
EWADAREA EQU   EWAIERP                                                  00477000
EWDASNS  EQU   EWADAREA                                                 00478000
EWDSNS0  EQU   EWDASNS                                                  00479000
EWDSNS1  EQU   EWDASNS+1                                                00480000
EWDMAM   EQU   EWDSNS1                                                  00481000
EWDSNS2  EQU   EWDASNS+2                                                00482000
EWDZLOG  EQU   EWDSNS2                                                  00483000
EWDWRPS  EQU   EWDZLOG                                                  00484000
EWD22    EQU   EWDSNS2                                                  00485000
EWDEDAT  EQU   EWDSNS2                                                  00486000
EWDSNS10 EQU   EWDASNS+10                                               00487000
EWDSNS24 EQU   EWDASNS+24                                               00488000
EWDHOMAD EQU   EWADAREA+39                                              00489000
EWDHAFLG EQU   EWDHOMAD                                                 00490000
FLC      EQU   PSA                                                      00491000
HHR      EQU   HH                                                       00492000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00493000
EWDEND   EQU   EWADAREA+128                                             00494000
EWDCCWA  EQU   EWADAREA+120                                             00495000
EWDCCW9  EQU   EWADAREA+112                                             00496000
EWDCCW8  EQU   EWADAREA+104                                             00497000
EWDCCW7  EQU   EWADAREA+96                                              00498000
EWDCCW6  EQU   EWADAREA+88                                              00499000
EWDCCW5  EQU   EWADAREA+80                                              00500000
EWDCCW4  EQU   EWADAREA+72                                              00501000
EWDCCW3  EQU   EWADAREA+64                                              00502000
EWDCCW2  EQU   EWADAREA+56                                              00503000
EWDCCW1  EQU   EWADAREA+48                                              00504000
EWDDISP  EQU   EWADAREA+45                                              00505000
EWDHARNO EQU   EWDHOMAD+5                                               00506000
EWDCCHH  EQU   EWDHOMAD+1                                               00507000
EWDHAALT EQU   EWDHAFLG                                                 00508000
EWDHADEF EQU   EWDHAFLG                                                 00509000
EWDHA5   EQU   EWDHAFLG                                                 00510000
EWDHA4   EQU   EWDHAFLG                                                 00511000
EWDHA3   EQU   EWDHAFLG                                                 00512000
EWDHA2   EQU   EWDHAFLG                                                 00513000
EWDHA1   EQU   EWDHAFLG                                                 00514000
EWDHA0   EQU   EWDHAFLG                                                 00515000
EWDSAVC  EQU   EWADAREA+32                                              00516000
EWDSAVS  EQU   EWADAREA+30                                              00517000
EWDSAVOP EQU   EWADAREA+29                                              00518000
EWDSAVKY EQU   EWADAREA+28                                              00519000
EWDSNS27 EQU   EWDASNS+27                                               00520000
EWDSNS26 EQU   EWDASNS+26                                               00521000
EWDSNS25 EQU   EWDASNS+25                                               00522000
EWDRZRO  EQU   EWDSNS24                                                 00523000
EWDSNS23 EQU   EWDASNS+23                                               00524000
EWDSNS22 EQU   EWDASNS+22                                               00525000
EWDSNS21 EQU   EWDASNS+21                                               00526000
EWDSNS20 EQU   EWDASNS+20                                               00527000
EWDSNS19 EQU   EWDASNS+19                                               00528000
EWDSNS18 EQU   EWDASNS+18                                               00529000
EWDSNS17 EQU   EWDASNS+17                                               00530000
EWDSNS16 EQU   EWDASNS+16                                               00531000
EWDSNS15 EQU   EWDASNS+15                                               00532000
EWDSNS14 EQU   EWDASNS+14                                               00533000
EWDSNS13 EQU   EWDASNS+13                                               00534000
EWDSNS12 EQU   EWDASNS+12                                               00535000
EWDSNS11 EQU   EWDASNS+11                                               00536000
EWD107   EQU   EWDSNS10                                                 00537000
EWD106   EQU   EWDSNS10                                                 00538000
EWD105   EQU   EWDSNS10                                                 00539000
EWD104   EQU   EWDSNS10                                                 00540000
EWDSTAT  EQU   EWDSNS10                                                 00541000
EWD100   EQU   EWDSNS10                                                 00542000
EWDSNS9  EQU   EWDASNS+9                                                00543000
EWDSNS8  EQU   EWDASNS+8                                                00544000
EWDSNS7  EQU   EWDASNS+7                                                00545000
EWDSNS6  EQU   EWDASNS+6                                                00546000
EWDSNS5  EQU   EWDASNS+5                                                00547000
EWDSNS4  EQU   EWDASNS+4                                                00548000
EWDSNS3  EQU   EWDASNS+3                                                00549000
EWD27    EQU   EWDSNS2                                                  00550000
EWD26    EQU   EWDSNS2                                                  00551000
EWD25    EQU   EWDSNS2                                                  00552000
EWD24    EQU   EWDSNS2                                                  00553000
EWDMDA2  EQU   EWD22                                                    00554000
EWDCORR  EQU   EWDSNS2                                                  00555000
EWDMDA1  EQU   EWDWRPS                                                  00556000
EWDOFLO  EQU   EWDSNS1                                                  00557000
EWDINHI  EQU   EWDMAM                                                   00558000
EWDFP    EQU   EWDSNS1                                                  00559000
EWDNRF   EQU   EWDSNS1                                                  00560000
EWD13    EQU   EWDSNS1                                                  00561000
EWDEOC   EQU   EWDSNS1                                                  00562000
EWDTVRN  EQU   EWDSNS1                                                  00563000
EWDPERM  EQU   EWDSNS1                                                  00564000
EWDSKCK  EQU   EWDSNS0                                                  00565000
EWDTCC   EQU   EWDSNS0                                                  00566000
EWDOVRN  EQU   EWDSNS0                                                  00567000
EWDDATA  EQU   EWDSNS0                                                  00568000
EWDEQU   EQU   EWDSNS0                                                  00569000
EWDBUSO  EQU   EWDSNS0                                                  00570000
EWDINT   EQU   EWDSNS0                                                  00571000
EWDCREJ  EQU   EWDSNS0                                                  00572000
EWAEND   EQU   EWADDIOS+71                                              00573000
EWASCSW  EQU   EWADDIOS+64                                              00574000
EWASNS   EQU   EWADDIOS                                                 00575000
IOSPCIWA EQU   IOSPCISC+44                                              00576000
IOSPCIRS EQU   IOSPCISC+8                                               00577000
@NM00041 EQU   IOSPCISC+4                                               00578000
@NM00040 EQU   IOSPCISC                                                 00579000
IOSWRNDR EQU   IOSWTOWA+4                                               00580000
IOSWTOPT EQU   IOSWTOWA+3                                               00581000
IOSWTOCP EQU   IOSWTOWA+2                                               00582000
IOSWTOCH EQU   IOSWTOWA                                                 00583000
IOSATTWA EQU   IOSATTSC+40                                              00584000
@NM00039 EQU   IOSATTSC+24                                              00585000
IOSATTSN EQU   IOSATTSC                                                 00586000
IOBSKSS  EQU   IOBSKADR+3                                               00587000
IOBSK0   EQU   IOBSKADR+2                                               00588000
IOBSKTT  EQU   IOBSKADR+1                                               00589000
IOBSKRV  EQU   IOBSKADR                                                 00590000
IOBCSWSV EQU   IOBORG11+17                                              00591000
IOBSENSV EQU   IOBORG11+16                                              00592000
IOBRCD   EQU   IOBORG11+12                                              00593000
IOBMDREC EQU   IOBORG11+8                                               00594000
IOBNAMEA EQU   IOBNAME+1                                                00595000
IOBNAMSZ EQU   IOBNAME                                                  00596000
IOBERCTA EQU   IOBERCT+1                                                00597000
IOBRTYPE EQU   IOBUCBXV                                                 00598000
IOBRDCHP EQU   IOBORG10+20                                              00599000
IOBNEXTA EQU   IOBORG10+16                                              00600000
IOBREADA EQU   IOBORG10+12                                              00601000
IOBBUFC  EQU   IOBORG10+8                                               00602000
IOBSK2R  EQU   IOBSEEK2+7                                               00603000
IOBSK2HH EQU   IOBSEEK2+5                                               00604000
IOBSK2CC EQU   IOBSEEK2+3                                               00605000
IOBSK2BB EQU   IOBSEEK2+1                                               00606000
IOBSK2M  EQU   IOBSEEK2                                                 00607000
IOBCHNPR EQU   IOBORG09+40                                              00608000
IOBDNCRF EQU   IOBORG09+32                                              00609000
IOBRSV35 EQU   IOBORG09+24                                              00610000
IOBDQPTR EQU   IOBORG09+20                                              00611000
IOBRSV34 EQU   IOBORG09+18                                              00612000
IOBDBYTN EQU   IOBORG09+16                                              00613000
IOBDCPND EQU   IOBORG09+12                                              00614000
IOBSTAT2 EQU   IOBDSTAT+1                                               00615000
IOBSIORT EQU   IOBSTAT1                                                 00616000
IOBADDVU EQU   IOBSTAT1                                                 00617000
IOBBUFF  EQU   IOBSTAT1                                                 00618000
IOBENQUE EQU   IOBSTAT1                                                 00619000
IOBPASS2 EQU   IOBSTAT1                                                 00620000
IOBSYNCH EQU   IOBSTAT1                                                 00621000
IOBNEWVL EQU   IOBSTAT1                                                 00622000
IOBABNRM EQU   IOBSTAT1                                                 00623000
IOBRELEX EQU   IOBDTYP2                                                 00624000
IOBADDTY EQU   IOBDTYP2                                                 00625000
IOBTYPE  EQU   IOBDTYP2                                                 00626000
IOBRQUST EQU   IOBDTYP2                                                 00627000
IOBSUFFX EQU   IOBDTYP2                                                 00628000
IOBSBLKL EQU   IOBDTYP2                                                 00629000
IOBSKEY  EQU   IOBDTYP2                                                 00630000
IOBRELBL EQU   IOBDTYPE                                                 00631000
IOBRDEXC EQU   IOBDTYPE                                                 00632000
IOBDYNBF EQU   IOBDTYPE                                                 00633000
IOBACTAD EQU   IOBDTYPE                                                 00634000
IOBFDBCK EQU   IOBDTYPE                                                 00635000
IOBEXTSC EQU   IOBDTYPE                                                 00636000
IOBOVFLO EQU   IOBDTYPE                                                 00637000
IOBVERFY EQU   IOBDTYPE                                                 00638000
IOBDPLB  EQU   IOBDPLAD+1                                               00639000
IOBDAYLI EQU   IOBDPLAD                                                 00640000
IOBDIOBS EQU   IOBORG09+2                                               00641000
IOBDBYTR EQU   IOBORG09                                                 00642000
IOBBCHAD EQU   IOBORG08+12                                              00643000
IOBFCHNB EQU   IOBFCHAD+1                                               00644000
IOBCOUNT EQU   IOBFCHAD                                                 00645000
IOBASYN  EQU   IOBORG08+7                                               00646000
IOBAPP   EQU   IOBORG08+6                                               00647000
IOBRSV32 EQU   IOBUNSQR                                                 00648000
IOBRSV31 EQU   IOBUNSQR                                                 00649000
IOBRSV30 EQU   IOBUNSQR                                                 00650000
IOBKNRWR EQU   IOBUNSQR                                                 00651000
IOBKNWR  EQU   IOBUNSQR                                                 00652000
IOBNTAV2 EQU   IOBUNSQR                                                 00653000
IOBNTAV1 EQU   IOBUNSQR                                                 00654000
IOBCPBSY EQU   IOBUNSQR                                                 00655000
IOBCHNNL EQU   IOBINDCT                                                 00656000
IOBRSV29 EQU   IOBINDCT                                                 00657000
IOBRSV28 EQU   IOBINDCT                                                 00658000
IOBRSV27 EQU   IOBINDCT                                                 00659000
IOBKEYAD EQU   IOBINDCT                                                 00660000
IOBOVPTR EQU   IOBINDCT                                                 00661000
IOBUNSCH EQU   IOBINDCT                                                 00662000
IOBDEQCP EQU   IOBINDCT                                                 00663000
IOBCCWAD EQU   IOBORG08                                                 00664000
W1OEXTEN EQU   W1IEXTEN                                                 00665000
IOBCCW   EQU   IOBORG06+8                                               00666000
IOBNXTPB EQU   IOBNXTPT+1                                               00667000
IOBRSV26 EQU   IOBSTATA                                                 00668000
IOBRSV25 EQU   IOBSTATA                                                 00669000
IOBRSV24 EQU   IOBSTATA                                                 00670000
IOBRSV23 EQU   IOBSTATA                                                 00671000
IOBRSV22 EQU   IOBSTATA                                                 00672000
IOBRSV21 EQU   IOBSTATA                                                 00673000
IOBRSV20 EQU   IOBSTATA                                                 00674000
IOBAVLFL EQU   IOBSTATA                                                 00675000
IOBRSV37 EQU   IOBORG06+1                                               00676000
IOBUCBXG EQU   IOBORG06                                                 00677000
IOBCPA   EQU   IOBORG05+32                                              00678000
IOBERINF EQU   IOBORG05+16                                              00679000
IOBERCCW EQU   IOBORG05+8                                               00680000
IOBSNDPT EQU   IOBORG05+7                                               00681000
IOBRCVPT EQU   IOBORG05+6                                               00682000
IOBWORK  EQU   IOBORG05+1                                               00683000
IOBUCBX  EQU   IOBORG05                                                 00684000
IOBRSV46 EQU   IOBFL4                                                   00685000
IOBRSV47 EQU   IOBFL4                                                   00686000
IOBENT   EQU   IOBFL4                                                   00687000
IOBEQP   EQU   IOBFL4                                                   00688000
IOBBUS   EQU   IOBFL4                                                   00689000
IOBDCK   EQU   IOBFL4                                                   00690000
IOBREJ   EQU   IOBFL4                                                   00691000
IOBOVR   EQU   IOBFL4                                                   00692000
IOBCRILC EQU   IOBORG04+1                                               00693000
IOBCRDCC EQU   IOBORG04                                                 00694000
IOBGQECB EQU   IOBORG03                                                 00695000
IOBSWAP  EQU   IOBORG02+4                                               00696000
IOBDQADB EQU   IOBDQADA+1                                               00697000
IOBRSV13 EQU   IOBDEQIN                                                 00698000
IOBRSV12 EQU   IOBDEQIN                                                 00699000
IOBRSV11 EQU   IOBDEQIN                                                 00700000
IOBRSV10 EQU   IOBDEQIN                                                 00701000
IOBRSV09 EQU   IOBDEQIN                                                 00702000
IOBRSV08 EQU   IOBDEQIN                                                 00703000
IOBRSV07 EQU   IOBDEQIN                                                 00704000
IOBDEQ   EQU   IOBDEQIN                                                 00705000
IOBNECB  EQU   IOBORG01+4                                               00706000
IOBNIOBB EQU   IOBNIOBA+1                                               00707000
IOBFIRST EQU   IOBNFLG1                                                 00708000
IOBUPERR EQU   IOBNFLG1                                                 00709000
IOBSPAN  EQU   IOBNFLG1                                                 00710000
IOBBKSPC EQU   IOBNFLG1                                                 00711000
IOBUPDAT EQU   IOBNFLG1                                                 00712000
IOBREAD  EQU   IOBNFLG1                                                 00713000
IOBWRITE EQU   IOBNFLG1                                                 00714000
IOBSEGMT EQU   IOBPRTOV                                                 00715000
PSARSAV  EQU   PSARSVTE+60                                              00716000
PSARSTK  EQU   PSARSVTE+56                                              00717000
PSAESAV3 EQU   PSARSVTE+52                                              00718000
PSAESTK3 EQU   PSARSVTE+48                                              00719000
PSAESAV2 EQU   PSARSVTE+44                                              00720000
PSAESTK2 EQU   PSARSVTE+40                                              00721000
PSAESAV1 EQU   PSARSVTE+36                                              00722000
PSAESTK1 EQU   PSARSVTE+32                                              00723000
PSAPSAV  EQU   PSARSVTE+28                                              00724000
PSAPSTK  EQU   PSARSVTE+24                                              00725000
PSAMSAV  EQU   PSARSVTE+20                                              00726000
PSAMSTK  EQU   PSARSVTE+16                                              00727000
PSASSAV  EQU   PSARSVTE+12                                              00728000
PSASSTK  EQU   PSARSVTE+8                                               00729000
PSANSTK  EQU   PSARSVTE+4                                               00730000
PSACSTK  EQU   PSARSVTE                                                 00731000
CVTRV628 EQU   CVTS01+728                                               00732000
CVTRV627 EQU   CVTS01+724                                               00733000
CVTRV626 EQU   CVTS01+720                                               00734000
CVTRV625 EQU   CVTS01+716                                               00735000
CVTRV624 EQU   CVTS01+712                                               00736000
CVTRV623 EQU   CVTS01+708                                               00737000
CVTRV622 EQU   CVTS01+704                                               00738000
CVTRV621 EQU   CVTS01+700                                               00739000
CVTIHASU EQU   CVTS01+696                                               00740000
CVTRV619 EQU   CVTS01+692                                               00741000
CVTRV618 EQU   CVTS01+688                                               00742000
CVTRV617 EQU   CVTS01+684                                               00743000
CVTRV616 EQU   CVTS01+680                                               00744000
CVTRV615 EQU   CVTS01+676                                               00745000
CVTRV614 EQU   CVTS01+672                                               00746000
CVTRV613 EQU   CVTS01+668                                               00747000
CVTTCASP EQU   CVTS01+664                                               00748000
CVT0PT03 EQU   CVTS01+660                                               00749000
CVT0PT0E EQU   CVTS01+656                                               00750000
CVTRV609 EQU   CVTS01+652                                               00751000
CVTCGK   EQU   CVTS01+648                                               00752000
CVTRAC   EQU   CVTS01+644                                               00753000
CVTRV606 EQU   CVTS01+640                                               00754000
CVTRV605 EQU   CVTS01+636                                               00755000
CVTRV604 EQU   CVTS01+632                                               00756000
CVTEFF02 EQU   CVTS01+628                                               00757000
CVTCBBR  EQU   CVTS01+624                                               00758000
CVTSSCR  EQU   CVTS01+620                                               00759000
CVTEVENT EQU   CVTS01+616                                               00760000
CVTCRCA  EQU   CVTS01+612                                               00761000
CVTTPIO  EQU   CVTS01+608                                               00762000
CVTADV   EQU   CVTS01+604                                               00763000
CVTGSDAB EQU   CVTGSDA                                                  00764000
CVTQV3   EQU   CVTS01+596                                               00765000
CVTQV2   EQU   CVTS01+592                                               00766000
CVTQV1   EQU   CVTS01+588                                               00767000
CVTRPT   EQU   CVTS01+584                                               00768000
CVTSSRB  EQU   CVTS01+580                                               00769000
CVTCSDRL EQU   CVTS01+576                                               00770000
CVTEXP1  EQU   CVTS01+572                                               00771000
CVTRMPMT EQU   CVTS01+568                                               00772000
CVTRMPTT EQU   CVTS01+564                                               00773000
CVTVPSA  EQU   CVTS01+560                                               00774000
CVTVSTOP EQU   CVTS01+556                                               00775000
CVTGTFR8 EQU   CVTS01+552                                               00776000
CVTQUIT  EQU   CVTS01+548                                               00777000
CVTVACR  EQU   CVTS01+544                                               00778000
CVTWTCB  EQU   CVTS01+540                                               00779000
CVTSTPRS EQU   CVTS01+536                                               00780000
CVT0PT02 EQU   CVTS01+532                                               00781000
CVTDARCM EQU   CVTS01+528                                               00782000
CVTIRECM EQU   CVTS01+524                                               00783000
CVTJRECM EQU   CVTS01+520                                               00784000
CVTVEMS0 EQU   CVTS01+516                                               00785000
CVTSPFRR EQU   CVTS01+512                                               00786000
CVTRLSTG EQU   CVTS01+508                                               00787000
CVT0TC0A EQU   CVTS01+504                                               00788000
CVTGMBR  EQU   CVTS01+500                                               00789000
CVTLFRM  EQU   CVTS01+496                                               00790000
CVTRMBR  EQU   CVTS01+492                                               00791000
CVTVIOP  EQU   CVTS01+488                                               00792000
CVTRV307 EQU   CVTS01+486                                               00793000
CVTRV306 EQU   CVTS01+484                                               00794000
CVTRV305 EQU   CVTS01+482                                               00795000
CVTRV304 EQU   CVTS01+480                                               00796000
CVTRV303 EQU   CVTS01+478                                               00797000
CVTRV302 EQU   CVTS01+476                                               00798000
CVTTRCA  EQU   CVTS01+472                                               00799000
CVTRV297 EQU   CVTRV289                                                 00800000
CVTRV296 EQU   CVTRV289                                                 00801000
CVTRV295 EQU   CVTRV289                                                 00802000
CVTRV294 EQU   CVTRV289                                                 00803000
CVTRV293 EQU   CVTRV289                                                 00804000
CVTRV292 EQU   CVTRV289                                                 00805000
CVTRV291 EQU   CVTRV289                                                 00806000
CVTRV290 EQU   CVTRV289                                                 00807000
CVTRV288 EQU   CVTRV280                                                 00808000
CVTRV287 EQU   CVTRV280                                                 00809000
CVTRV286 EQU   CVTRV280                                                 00810000
CVTRV285 EQU   CVTRV280                                                 00811000
CVTRV284 EQU   CVTRV280                                                 00812000
CVTRV283 EQU   CVTRV280                                                 00813000
CVTRV282 EQU   CVTRV280                                                 00814000
CVTRV281 EQU   CVTRV280                                                 00815000
CVTRV279 EQU   CVTRV271                                                 00816000
CVTRV278 EQU   CVTRV271                                                 00817000
CVTRV277 EQU   CVTRV271                                                 00818000
CVTRV276 EQU   CVTRV271                                                 00819000
CVTRV275 EQU   CVTRV271                                                 00820000
CVTRV274 EQU   CVTRV271                                                 00821000
CVTRV273 EQU   CVTRV271                                                 00822000
CVTRV272 EQU   CVTRV271                                                 00823000
CVTRV270 EQU   CVTRV262                                                 00824000
CVTRV269 EQU   CVTRV262                                                 00825000
CVTRV268 EQU   CVTRV262                                                 00826000
CVTRV267 EQU   CVTRV262                                                 00827000
CVTRV266 EQU   CVTRV262                                                 00828000
CVTRV265 EQU   CVTRV262                                                 00829000
CVTRV264 EQU   CVTRV262                                                 00830000
CVTRV263 EQU   CVTRV262                                                 00831000
CVTVFP   EQU   CVTS01+464                                               00832000
CVTVSI   EQU   CVTS01+460                                               00833000
CVTVPSIB EQU   CVTS01+456                                               00834000
CVTMFACT EQU   CVTMFRTR                                                 00835000
CVTMFCTL EQU   CVTS01+448                                               00836000
CVTPVBP  EQU   CVTS01+444                                               00837000
CVTPWI   EQU   CVTS01+440                                               00838000
CVTRV254 EQU   CVTS01+438                                               00839000
CVTRV253 EQU   CVTS01+436                                               00840000
CVTRV252 EQU   CVTS01+434                                               00841000
CVTRV251 EQU   CVTS01+433                                               00842000
CVTRV250 EQU   CVTS01+432                                               00843000
CVTRV249 EQU   CVTS01+431                                               00844000
CVTRV248 EQU   CVTS01+430                                               00845000
CVTRV247 EQU   CVTS01+429                                               00846000
CVTRV246 EQU   CVTS01+428                                               00847000
CVTRV245 EQU   CVTRV237                                                 00848000
CVTRV244 EQU   CVTRV237                                                 00849000
CVTRV243 EQU   CVTRV237                                                 00850000
CVTRV242 EQU   CVTRV237                                                 00851000
CVTRV241 EQU   CVTRV237                                                 00852000
CVTRV240 EQU   CVTRV237                                                 00853000
CVTRV239 EQU   CVTRV237                                                 00854000
CVTRV238 EQU   CVTRV237                                                 00855000
CVTRV236 EQU   CVTRV228                                                 00856000
CVTRV235 EQU   CVTRV228                                                 00857000
CVTRV234 EQU   CVTRV228                                                 00858000
CVTRV233 EQU   CVTRV228                                                 00859000
CVTRV232 EQU   CVTRV228                                                 00860000
CVTRV231 EQU   CVTRV228                                                 00861000
CVTRV230 EQU   CVTRV228                                                 00862000
CVTRV229 EQU   CVTRV228                                                 00863000
CVTRV227 EQU   CVTRV219                                                 00864000
CVTRV226 EQU   CVTRV219                                                 00865000
CVTRV225 EQU   CVTRV219                                                 00866000
CVTRV224 EQU   CVTRV219                                                 00867000
CVTRV223 EQU   CVTRV219                                                 00868000
CVTRV222 EQU   CVTRV219                                                 00869000
CVTRV221 EQU   CVTRV219                                                 00870000
CVTRV220 EQU   CVTRV219                                                 00871000
CVTRV218 EQU   CVTRV210                                                 00872000
CVTRV217 EQU   CVTRV210                                                 00873000
CVTRV216 EQU   CVTRV210                                                 00874000
CVTRV215 EQU   CVTRV210                                                 00875000
CVTRV214 EQU   CVTRV210                                                 00876000
CVTRV213 EQU   CVTRV210                                                 00877000
CVTRV212 EQU   CVTRV210                                                 00878000
CVTRV211 EQU   CVTRV210                                                 00879000
CVTLCCAT EQU   CVTS01+420                                               00880000
CVTPCCAT EQU   CVTS01+416                                               00881000
CVTIPCRP EQU   CVTS01+412                                               00882000
CVTIPCRI EQU   CVTS01+408                                               00883000
CVTIPCDS EQU   CVTS01+404                                               00884000
CVTAIDVT EQU   CVTS01+400                                               00885000
CVTSSAP  EQU   CVTS01+396                                               00886000
CVTEHCIR EQU   CVTS01+392                                               00887000
CVTEHDEF EQU   CVTS01+388                                               00888000
CVTDAIR  EQU   CVTS01+384                                               00889000
CVTPERFM EQU   CVTS01+380                                               00890000
CVT044R2 EQU   CVTS01+376                                               00891000
CVTFETCH EQU   CVTS01+372                                               00892000
CVTRSTWD EQU   CVTS01+368                                               00893000
CVTSPOST EQU   CVTS01+364                                               00894000
CVTIOBP  EQU   CVTS01+360                                               00895000
CVTASMVT EQU   CVTS01+356                                               00896000
CVTRECRQ EQU   CVTS01+352                                               00897000
CVTWSAC  EQU   CVTS01+348                                               00898000
CVTRV149 EQU   CVTS01+344                                               00899000
CVTWSAL  EQU   CVTS01+340                                               00900000
CVTSPSA  EQU   CVTS01+336                                               00901000
CVTGLMN  EQU   CVTS01+332                                               00902000
CVTVEAC0 EQU   CVTS01+328                                               00903000
CVT062R1 EQU   CVTS01+324                                               00904000
CVTRPOST EQU   CVTS01+320                                               00905000
CVTDQIQE EQU   CVTS01+316                                               00906000
CVTCSD   EQU   CVTS01+312                                               00907000
CVTLKRMA EQU   CVTS01+308                                               00908000
CVTRSPIE EQU   CVTS01+304                                               00909000
CVTRENQ  EQU   CVTS01+300                                               00910000
CVTLQCB  EQU   CVTS01+296                                               00911000
CVTFQCB  EQU   CVTS01+292                                               00912000
CVTQCS01 EQU   CVTS01+288                                               00913000
CVTAPFT  EQU   CVTS01+284                                               00914000
CVTPARRL EQU   CVTS01+280                                               00915000
CVTVWAIT EQU   CVTS01+276                                               00916000
CVTGSPL  EQU   CVTS01+272                                               00917000
CVTLSMQ  EQU   CVTS01+268                                               00918000
CVTGSMQ  EQU   CVTS01+264                                               00919000
CVTEXPRO EQU   CVTS01+260                                               00920000
CVTOPCTP EQU   CVTS01+256                                               00921000
CVTSIC   EQU   CVTS01+252                                               00922000
CVTTPIOS EQU   CVTS01+248                                               00923000
CVTRTMS  EQU   CVTS01+244                                               00924000
CVTSDBF  EQU   CVTS01+240                                               00925000
CVTSCBP  EQU   CVTS01+236                                               00926000
CVTSDMP  EQU   CVTS01+232                                               00927000
CVTSV60  EQU   CVTS01+228                                               00928000
CVTRTMCT EQU   CVTS01+224                                               00929000
CVTASCBL EQU   CVTS01+220                                               00930000
CVTASCBH EQU   CVTS01+216                                               00931000
CVTGDA   EQU   CVTS01+212                                               00932000
CVTASVT  EQU   CVTS01+208                                               00933000
CVTVVMDI EQU   CVTS01+204                                               00934000
CVTAQTOP EQU   CVTS01+200                                               00935000
CVTIOSCS EQU   CVTS01+196                                               00936000
CVTSDRM  EQU   CVTS01+192                                               00937000
CVTOPTE  EQU   CVTS01+188                                               00938000
CVTSTXU  EQU   CVTS01+184                                               00939000
CVTQUIS  EQU   CVTS01+180                                               00940000
CVTPARS  EQU   CVTS01+176                                               00941000
CVTS1EE  EQU   CVTS01+172                                               00942000
CVTFRAS  EQU   CVTS01+168                                               00943000
CVTQSAS  EQU   CVTS01+164                                               00944000
CVTCRAS  EQU   CVTS01+160                                               00945000
CVTCRMN  EQU   CVTS01+156                                               00946000
CVTDELCP EQU   CVTS01+152                                               00947000
CVTFRECL EQU   CVTS01+148                                               00948000
CVTGETCL EQU   CVTS01+144                                               00949000
CVTBLDCP EQU   CVTS01+140                                               00950000
CVTAUTHL EQU   CVTS01+136                                               00951000
CVTSCAN  EQU   CVTS01+132                                               00952000
CVTRV144 EQU   CVTS01+130                                               00953000
CVTMAXMP EQU   CVTS01+128                                               00954000
CVTSTCK  EQU   CVTS01+124                                               00955000
CVTRV139 EQU   CVTS01+123                                               00956000
CVTDSSAC EQU   CVTS01+122                                               00957000
CVTRV513 EQU   CVTS01+121                                               00958000
CVTIOSPL EQU   CVTS01+120                                               00959000
CVTPTGT  EQU   CVTS01+116                                               00960000
CVTCSPIE EQU   CVTS01+112                                               00961000
CVTSMFEX EQU   CVTS01+108                                               00962000
CVTOLT0A EQU   CVTS01+104                                               00963000
CVTSRBRT EQU   CVTS01+100                                               00964000
CVTPUTL  EQU   CVTS01+96                                                00965000
CVTASCRL EQU   CVTS01+92                                                00966000
CVTASCRF EQU   CVTS01+88                                                00967000
CVTRV326 EQU   CVTS01+84                                                00968000
CVTRV325 EQU   CVTS01+80                                                00969000
CVTRV324 EQU   CVTS01+76                                                00970000
CVT0VL01 EQU   CVTS01+72                                                00971000
CVTSHRVM EQU   CVTS01+68                                                00972000
CVTRV332 EQU   CVTS01+64                                                00973000
CVTTAS   EQU   CVTS01+60                                                00974000
CVTRSCN  EQU   CVTS01+56                                                00975000
CVTTRAC2 EQU   CVTS01+54                                                00976000
CVTTRACE EQU   CVTS01+52                                                00977000
CVTAPG   EQU   CVTS01+51                                                00978000
CVTSDTRC EQU   CVTCTLFG                                                 00979000
CVTGTRCE EQU   CVTCTLFG                                                 00980000
CVTNOMP  EQU   CVTCTLFG                                                 00981000
CVTRSV79 EQU   CVTCTLFG                                                 00982000
CVTDSTAT EQU   CVTCTLFG                                                 00983000
CVTRSV78 EQU   CVTCTLFG                                                 00984000
CVTRV333 EQU   CVTCTLFG                                                 00985000
CVTRV323 EQU   CVTCTLFG                                                 00986000
CVTSPVLK EQU   CVTS01+49                                                00987000
CVTRSV77 EQU   CVTS01+48                                                00988000
CVTRV331 EQU   CVTS01+44                                                00989000
CVTRV330 EQU   CVTS01+40                                                00990000
CVTRV329 EQU   CVTS01+36                                                00991000
CVTRV328 EQU   CVTS01+32                                                00992000
CVTRV322 EQU   CVTS01+28                                                00993000
CVTSLID  EQU   CVTSLIDA+1                                               00994000
CVTSYLK  EQU   CVTSLIDA                                                 00995000
CVTRV321 EQU   CVTS01+20                                                00996000
CVTRV320 EQU   CVTS01+16                                                00997000
CVTLPDIR EQU   CVTLPDIA+1                                               00998000
CVTRSV69 EQU   CVTDIRST                                                 00999000
CVTRSV68 EQU   CVTDIRST                                                 01000000
CVTRSV67 EQU   CVTDIRST                                                 01001000
CVTRSV66 EQU   CVTDIRST                                                 01002000
CVTRSV65 EQU   CVTDIRST                                                 01003000
CVTRSV64 EQU   CVTDIRST                                                 01004000
CVTRSV63 EQU   CVTDIRST                                                 01005000
CVTDICOM EQU   CVTDIRST                                                 01006000
CVTPVTP  EQU   CVTS01+8                                                 01007000
CVTLPDSR EQU   CVTS01+4                                                 01008000
CVTGETL  EQU   CVTS01                                                   01009000
IOBR     EQU   IOBSEEK+7                                                01010000
IOBHH2   EQU   IOBHH+1                                                  01011000
IOBHH1   EQU   IOBHH                                                    01012000
IOBCC2   EQU   IOBCC+1                                                  01013000
IOBCC1   EQU   IOBCC                                                    01014000
IOBBB2   EQU   IOBBB+1                                                  01015000
IOBBB1   EQU   IOBBB                                                    01016000
IOBM     EQU   IOBSEEK                                                  01017000
ECBPOST  EQU   ECBCC                                                    01018000
ECBWAIT  EQU   ECBCC                                                    01019000
CSWBYTE  EQU   CSW+6                                                    01020000
CSWUNEXP EQU   CSWSTAT1                                                 01021000
@NM00051 EQU   CSWSTAT1                                                 01022000
CSWADDRB EQU   CSWADDRA+1                                               01023000
CSWKEY   EQU   CSWADDRA                                                 01024000
EWADDISP EQU   EWA+29                                                   01025000
EWADCNT  EQU   EWA+28                                                   01026000
EWACPU   EQU   EWA+27                                                   01027000
@NM00050 EQU   EWA+26                                                   01028000
EWACHA   EQU   EWA+24                                                   01029000
EWACSEQ  EQU   EWAXCSW2                                                 01030000
EWACDIN  EQU   EWAXCSW2                                                 01031000
@NM00049 EQU   EWAXCSW2                                                 01032000
EWACTEC  EQU   EWAXCSW2                                                 01033000
EWACDAV  EQU   EWAXCSW1                                                 01034000
EWACCHV  EQU   EWAXCSW1                                                 01035000
EWACCMD  EQU   EWAXCSW1                                                 01036000
EWACUNS  EQU   EWAXCSW1                                                 01037000
EWACSQV  EQU   EWAXCSW1                                                 01038000
@NM00048 EQU   EWAXCSW1                                                 01039000
EWACITF  EQU   EWAXCSW1                                                 01040000
@NM00047 EQU   EWARGFG2                                                 01041000
EWACCUE  EQU   EWARGFG2                                                 01042000
EWACSTG  EQU   EWARGFG2                                                 01043000
EWACSCU  EQU   EWARGFG2                                                 01044000
EWACCHA  EQU   EWARGFG2                                                 01045000
EWACCPU  EQU   EWARGFG2                                                 01046000
EWANORTY EQU   EWARGFG1                                                 01047000
EWACCNT  EQU   EWARGFG1                                                 01048000
EWACSNS  EQU   EWARGFG1                                                 01049000
@NM00046 EQU   EWARGFG1                                                 01050000
EWACHIO  EQU   EWARGFG1                                                 01051000
EWACTIO  EQU   EWARGFG1                                                 01052000
EWACINT  EQU   EWARGFG1                                                 01053000
EWACSIO  EQU   EWARGFG1                                                 01054000
EWAUCB   EQU   EWAERPIB+1                                               01055000
@NM00045 EQU   EWAERPIB                                                 01056000
EWASTUP  EQU   EWA+14                                                   01057000
EWACNTR4 EQU   EWACNTRS+3                                               01058000
EWACNTR3 EQU   EWACNTRS+2                                               01059000
EWACNTR2 EQU   EWACNTRS+1                                               01060000
EWACNTR1 EQU   EWACNTRS                                                 01061000
EWASSTAT EQU   EWA+8                                                    01062000
EWASCTMX EQU   EWASNSCT                                                 01063000
@NM00044 EQU   EWASNSCT                                                 01064000
EWAJAM   EQU   EWAFLG3                                                  01065000
@NM00043 EQU   EWAFLG2                                                  01066000
EWADIR   EQU   EWAFLG2                                                  01067000
EWACOVF  EQU   EWAFLG2                                                  01068000
EWAWTEMP EQU   EWAFLG2                                                  01069000
EWAMDR   EQU   EWAFLG2                                                  01070000
EWABDSNS EQU   EWAFLG1                                                  01071000
EWADDMSG EQU   EWAFLG1                                                  01072000
EWASCC1  EQU   EWASCC3                                                  01073000
EWASCC2  EQU   EWASCC3                                                  01074000
@NM00042 EQU   EWAFLG1                                                  01075000
EWASLIS  EQU   EWAFLG1                                                  01076000
EWAEXT   EQU   EWAHDR                                                   01077000
IOSEND   EQU   IOSB+108                                                 01078000
IOSSKR   EQU   IOSEEKA+7                                                01079000
IOSSKH2  EQU   IOSSKHH+1                                                01080000
IOSSKH1  EQU   IOSSKHH                                                  01081000
IOSSKCC  EQU   IOSCCHH                                                  01082000
IOSSKBB  EQU   IOSEEKA+1                                                01083000
IOSSKM   EQU   IOSEEKA                                                  01084000
IOSEEK   EQU   IOSB+92                                                  01085000
IOSMDM   EQU   IOSB+91                                                  01086000
IOSMDB   EQU   IOSB+90                                                  01087000
IOSCKEY7 EQU   IOSCKEY                                                  01088000
IOSCKEY6 EQU   IOSCKEY                                                  01089000
IOSCKEY5 EQU   IOSCKEY                                                  01090000
IOSCKEY4 EQU   IOSCKEY                                                  01091000
@NM00038 EQU   IOSCKEY                                                  01092000
IOSFMSK  EQU   IOSB+88                                                  01093000
IOSCUDEV EQU   IOSPATH+1                                                01094000
@NM00037 EQU   IOSCHN                                                   01095000
IOSPATH3 EQU   IOSCHN                                                   01096000
IOSPATH2 EQU   IOSCHN                                                   01097000
IOSEXP   EQU   IOSCHN                                                   01098000
IOSGDP   EQU   IOSCHN                                                   01099000
IOSAFF   EQU   IOSB+85                                                  01100000
IOSRSS1B EQU   IOSB+84                                                  01101000
IOSDSID  EQU   IOSB+80                                                  01102000
IOSVST   EQU   IOSB+76                                                  01103000
IOSRST   EQU   IOSB+72                                                  01104000
IOSDIE   EQU   IOSB+68                                                  01105000
IOSABN   EQU   IOSB+64                                                  01106000
IOSNRM   EQU   IOSB+60                                                  01107000
IOSPCI   EQU   IOSB+56                                                  01108000
IOSPCHN  EQU   IOSB+48                                                  01109000
IOSSNS   EQU   IOSB+42                                                  01110000
IOSAPMSK EQU   IOSB+40                                                  01111000
IOSRES4A EQU   IOSB+36                                                  01112000
IOSUSE   EQU   IOSB+32                                                  01113000
IOSSRB   EQU   IOSB+28                                                  01114000
IOSCSWRC EQU   IOSCSW+5                                                 01115000
IOSTSB   EQU   IOSTATUS+1                                               01116000
IOSTSA   EQU   IOSTATUS                                                 01117000
IOSCSWCA EQU   IOSCSW                                                   01118000
IOSCC    EQU   @NM00036                                                 01119000
IOSUCB   EQU   IOSB+16                                                  01120000
IOSOPT2X EQU   IOSOPT2                                                  01121000
IOSIGP   EQU   IOSOPT2                                                  01122000
IOSHTP   EQU   IOSOPT2                                                  01123000
IOSRELSE EQU   IOSOPT                                                   01124000
IOSAPR   EQU   IOSOPT                                                   01125000
IOSTSLL  EQU   IOSOPT                                                   01126000
IOSNERP  EQU   IOSOPT                                                   01127000
IOSPSLL  EQU   IOSOPT                                                   01128000
IOSQISCE EQU   IOSOPT                                                   01129000
IOSDEP   EQU   IOSOPT                                                   01130000
IOSBYP   EQU   IOSOPT                                                   01131000
IOSCOD   EQU   IOSB+13                                                  01132000
IOSPKY7  EQU   IOSPKEY                                                  01133000
IOSPGDPX EQU   IOSPKEY                                                  01134000
IOSIDR   EQU   IOSPKEY                                                  01135000
IOSLCL   EQU   IOSPKEY                                                  01136000
@NM00035 EQU   IOSPKEY                                                  01137000
IOSPGAD  EQU   IOSB+8                                                   01138000
IOSASID  EQU   IOSB+6                                                   01139000
IOSPRLVL EQU   IOSB+5                                                   01140000
IOSDVRID EQU   IOSB+4                                                   01141000
IOSPROC  EQU   IOSB+3                                                   01142000
IOSFLC7  EQU   IOSFLC                                                   01143000
IOSCTCNR EQU   IOSFLC                                                   01144000
IOSRWAIT EQU   IOSFLC                                                   01145000
IOSTP    EQU   IOSFLC                                                   01146000
IOSCC3WE EQU   IOSFLC                                                   01147000
IOSVERIF EQU   IOSDVALT                                                 01148000
IOSDVMNT EQU   IOSFLC                                                   01149000
IOSLOG   EQU   IOSFLB                                                   01150000
IOSBDCST EQU   IOSFLB                                                   01151000
IOSMSG   EQU   IOSFLB                                                   01152000
IOSFLB4  EQU   IOSFLB                                                   01153000
IOSFLB3  EQU   IOSFLB                                                   01154000
IOSNOTRS EQU   IOSFLB                                                   01155000
IOSSDR   EQU   IOSFLB                                                   01156000
IOSDIESE EQU   IOSFLB                                                   01157000
IOSIOSB  EQU   IOSFLA                                                   01158000
IOSDOM   EQU   IOSFLA                                                   01159000
IOSEX    EQU   IOSFLA                                                   01160000
IOSSMDB  EQU   IOSFLA                                                   01161000
IOSSMDA  EQU   IOSFLA                                                   01162000
IOSERR   EQU   IOSFLA                                                   01163000
IOSCCHN  EQU   IOSACHN                                                  01164000
IOSDCHN  EQU   IOSACHN                                                  01165000
@NM00034 EQU   SRB+40                                                   01166000
@NM00033 EQU   SRB+38                                                   01167000
SRBPRIOR EQU   SRB+37                                                   01168000
SRBPKF   EQU   SRB+36                                                   01169000
SRBSAVE  EQU   SRB+32                                                   01170000
SRBRMTR  EQU   SRB+24                                                   01171000
SRBEP    EQU   SRB+20                                                   01172000
SRBPTCB  EQU   SRBFLC+4                                                 01173000
SRBPASID EQU   SRBFLC+2                                                 01174000
SRBCPAFF EQU   SRBFLC                                                   01175000
SRBASCB  EQU   SRB+8                                                    01176000
SRBFLNK  EQU   SRB+4                                                    01177000
SRBID    EQU   SRB                                                      01178000
RQEEND   EQU   RQE+40                                                   01179000
@NM00032 EQU   RQEFLAG3                                                 01180000
RQEINIOS EQU   RQEFLAG3                                                 01181000
RQECHEAC EQU   RQEFLAG                                                  01182000
RQEPURGE EQU   RQEFLAG                                                  01183000
RQESRBS  EQU   RQEFLAG                                                  01184000
RQESTBL  EQU   RQEFLAG                                                  01185000
RQEFIXST EQU   RQEFLAG                                                  01186000
RQENOFRE EQU   RQEFLAG                                                  01187000
RQENOPST EQU   RQEFLAG                                                  01188000
RQERETRY EQU   RQEFLAG                                                  01189000
RQETYP1  EQU   RQETYP3                                                  01190000
RQETYP2  EQU   RQETYP3                                                  01191000
RQEDIE   EQU   RQETYPE                                                  01192000
RQEEOEE  EQU   RQETYPE                                                  01193000
RQEVAM   EQU   RQETYPE                                                  01194000
RQE1TO1  EQU   RQETYPE                                                  01195000
RQEVIRT  EQU   RQETYPE                                                  01196000
RQE114   EQU   RQETYPE                                                  01197000
RQESMFRQ EQU   RQEPRT                                                   01198000
@NM00031 EQU   RQEPRT                                                   01199000
RQEPKEY  EQU   RQEPRT                                                   01200000
RQEIPIB  EQU   RQE+32                                                   01201000
RQERRQ   EQU   RQE+24                                                   01202000
RQENRQE  EQU   RQE+20                                                   01203000
RQETCCW  EQU   RQE+16                                                   01204000
RQETCB   EQU   RQE+12                                                   01205000
RQEDEB   EQU   RQE+8                                                    01206000
RQEIOB   EQU   RQE+4                                                    01207000
RQEUCB   EQU   RQE                                                      01208000
IOBERRCT EQU   IOBSTDRD+30                                              01209000
IOBRSV19 EQU   IOBINCAM+1                                               01210000
IOBOLTST EQU   IOBBTAMF                                                 01211000
IOBRFTMG EQU   IOBBTAMF                                                 01212000
IOBRSV17 EQU   IOBBTAMF                                                 01213000
IOBRSV16 EQU   IOBBTAMF                                                 01214000
IOBRSV15 EQU   IOBBTAMF                                                 01215000
IOBRSV14 EQU   IOBBTAMF                                                 01216000
IOBINUSE EQU   IOBBTAMF                                                 01217000
IOBPRMER EQU   IOBBTAMF                                                 01218000
IOBRSTRB EQU   IOBRESTR+1                                               01219000
IOBREPOS EQU   IOBRESTR                                                 01220000
IOBDCBPB EQU   IOBDCBPT+1                                               01221000
IOBRSV44 EQU   IOBFLAG4                                                 01222000
IOBJES3I EQU   IOBFLAG4                                                 01223000
IOBRSV42 EQU   IOBFLAG4                                                 01224000
IOBRSV41 EQU   IOBFLAG4                                                 01225000
IOBRSV40 EQU   IOBFLAG4                                                 01226000
IOBPMERR EQU   IOBFLAG4                                                 01227000
IOBCC3WE EQU   IOBFLAG4                                                 01228000
IOBGDPOL EQU   IOBFLAG4                                                 01229000
IOBSTRTB EQU   IOBSTART+1                                               01230000
IOBSIOCC EQU   IOBSTART                                                 01231000
IOBCSB7  EQU   IOBCSTAT                                                 01232000
IOBCSB6  EQU   IOBCSTAT                                                 01233000
IOBCSB5  EQU   IOBCSTAT                                                 01234000
IOBCSB4  EQU   IOBCSTAT                                                 01235000
IOBCSB3  EQU   IOBCSTAT                                                 01236000
IOBCSB2  EQU   IOBCSTAT                                                 01237000
IOBCSB1  EQU   IOBCSTAT                                                 01238000
IOBCSB0  EQU   IOBCSTAT                                                 01239000
IOBUSB7  EQU   IOBUSTAT                                                 01240000
IOBUSB6  EQU   IOBUSTAT                                                 01241000
IOBUSB5  EQU   IOBUSTAT                                                 01242000
IOBUSB4  EQU   IOBUSTAT                                                 01243000
IOBUSB3  EQU   IOBUSTAT                                                 01244000
IOBUSB2  EQU   IOBUSTAT                                                 01245000
IOBUSB1  EQU   IOBUSTAT                                                 01246000
IOBUSB0  EQU   IOBUSTAT                                                 01247000
IOBCMDA  EQU   IOBIOCSW                                                 01248000
IOBLOG   EQU   IOBFL3                                                   01249000
IOBJAM   EQU   IOBICL                                                   01250000
IOBMSG   EQU   IOBFL3                                                   01251000
IOBSDR   EQU   IOBCNC                                                   01252000
IOBACU   EQU   IOBFL3                                                   01253000
IOBCDC   EQU   IOBFL3                                                   01254000
IOBICC   EQU   IOBFL3                                                   01255000
IOBCCC   EQU   IOBFL3                                                   01256000
IOBS1B7  EQU   IOBSENS1                                                 01257000
IOBS1B6  EQU   IOBSENS1                                                 01258000
IOBS1B5  EQU   IOBSENS1                                                 01259000
IOBS1B4  EQU   IOBSENS1                                                 01260000
IOBS1B3  EQU   IOBSENS1                                                 01261000
IOBS1B2  EQU   IOBSENS1                                                 01262000
IOBS1B1  EQU   IOBSENS1                                                 01263000
IOBS1B0  EQU   IOBSENS1                                                 01264000
IOBSNSC9 EQU   IOBS0B7                                                  01265000
IOBS0B6  EQU   IOBSENS0                                                 01266000
IOBS0B5  EQU   IOBSENS0                                                 01267000
IOBS0B4  EQU   IOBSENS0                                                 01268000
IOBS0B3  EQU   IOBSENS0                                                 01269000
IOBS0B2  EQU   IOBSENS0                                                 01270000
IOBS0B1  EQU   IOBSENS0                                                 01271000
IOBS0B0  EQU   IOBSENS0                                                 01272000
IOBPNCH  EQU   IOBFLAG2                                                 01273000
IOBSTATO EQU   IOBFLAG2                                                 01274000
IOBSKUPD EQU   IOBFLAG2                                                 01275000
IOBALTTR EQU   IOBFLAG2                                                 01276000
IOBRRT2  EQU   IOBRDHA0                                                 01277000
IOBRRT3  EQU   IOBPURGE                                                 01278000
IOBSENSE EQU   IOBFLAG2                                                 01279000
IOBHALT  EQU   IOBFLAG2                                                 01280000
IOBSPSVC EQU   IOBRSTRT                                                 01281000
IOBUNREL EQU   IOBFLAG1                                                 01282000
IOBFCREX EQU   IOBCYCCK                                                 01283000
IOBRPSTN EQU   IOBFLAG1                                                 01284000
IOBERRTN EQU   IOBFLAG1                                                 01285000
IOBCMDCH EQU   IOBFLAG1                                                 01286000
IOBDATCH EQU   IOBFLAG1                                                 01287000
IOBCNOPA EQU   IOBPREFX+12                                              01288000
IOBCICB  EQU   IOBPREFX+8                                               01289000
IOBCECB  EQU   IOBPREFX+4                                               01290000
IOBCONOP EQU   IOBPREFX+3                                               01291000
IOBCINOP EQU   IOBPREFX+2                                               01292000
IOBRSV05 EQU   IOBPREFX+1                                               01293000
IOBPCI   EQU   IOBCFLG1                                                 01294000
IOBRSTCH EQU   IOBCFLG1                                                 01295000
IOBABAPP EQU   IOBCFLG1                                                 01296000
IOBPTST  EQU   IOBCFLG1                                                 01297000
IOBRSV04 EQU   IOBCFLG1                                                 01298000
IOBRSV03 EQU   IOBCFLG1                                                 01299000
IOBRSV02 EQU   IOBCFLG1                                                 01300000
IOBRSV01 EQU   IOBCFLG1                                                 01301000
CVTLEVL  EQU   CVTRELNO+2                                               01302000
CVTNUMB  EQU   CVTRELNO                                                 01303000
CVTMDL   EQU   CVTFIX+250                                               01304000
@NM00006 EQU   CVTFIX+248                                               01305000
@NM00005 EQU   CVTFIX                                                   01306000
CVTRV482 EQU   CVTXTNT2+128                                             01307000
CVTRV481 EQU   CVTXTNT2+124                                             01308000
CVTRV480 EQU   CVTXTNT2+120                                             01309000
CVTRV479 EQU   CVTXTNT2+118                                             01310000
CVTRV478 EQU   CVTXTNT2+117                                             01311000
CVTRV477 EQU   CVTXTNT2+116                                             01312000
CVTRV476 EQU   CVTXTNT2+115                                             01313000
CVTRV475 EQU   CVTXTNT2+114                                             01314000
CVTRV474 EQU   CVTRV466                                                 01315000
CVTRV473 EQU   CVTRV466                                                 01316000
CVTRV472 EQU   CVTRV466                                                 01317000
CVTRV471 EQU   CVTRV466                                                 01318000
CVTRV470 EQU   CVTRV466                                                 01319000
CVTRV469 EQU   CVTRV466                                                 01320000
CVTRV468 EQU   CVTRV466                                                 01321000
CVTRV467 EQU   CVTRV466                                                 01322000
CVTRV465 EQU   CVTRV457                                                 01323000
CVTRV464 EQU   CVTRV457                                                 01324000
CVTRV463 EQU   CVTRV457                                                 01325000
CVTRV462 EQU   CVTRV457                                                 01326000
CVTRV461 EQU   CVTRV457                                                 01327000
CVTRV460 EQU   CVTRV457                                                 01328000
CVTRV459 EQU   CVTRV457                                                 01329000
CVTRV458 EQU   CVTRV457                                                 01330000
CVTRV456 EQU   CVTXTNT2+108                                             01331000
CVTRV455 EQU   CVTXTNT2+104                                             01332000
CVTRV454 EQU   CVTXTNT2+100                                             01333000
CVTRV453 EQU   CVTXTNT2+96                                              01334000
CVTRV452 EQU   CVTXTNT2+94                                              01335000
CVTRV451 EQU   CVTXTNT2+92                                              01336000
CVTRV450 EQU   CVTXTNT2+90                                              01337000
CVTRV449 EQU   CVTXTNT2+88                                              01338000
CVTRV448 EQU   CVTXTNT2+87                                              01339000
CVTRV447 EQU   CVTXTNT2+86                                              01340000
CVTRV446 EQU   CVTRV438                                                 01341000
CVTRV445 EQU   CVTRV438                                                 01342000
CVTRV444 EQU   CVTRV438                                                 01343000
CVTRV443 EQU   CVTRV438                                                 01344000
CVTRV442 EQU   CVTRV438                                                 01345000
CVTRV441 EQU   CVTRV438                                                 01346000
CVTRV440 EQU   CVTRV438                                                 01347000
CVTRV439 EQU   CVTRV438                                                 01348000
CVTRV437 EQU   CVTRV429                                                 01349000
CVTRV436 EQU   CVTRV429                                                 01350000
CVTRV435 EQU   CVTRV429                                                 01351000
CVTRV434 EQU   CVTRV429                                                 01352000
CVTRV433 EQU   CVTRV429                                                 01353000
CVTRV432 EQU   CVTRV429                                                 01354000
CVTRV431 EQU   CVTRV429                                                 01355000
CVTRV430 EQU   CVTRV429                                                 01356000
CVTRV428 EQU   CVTXTNT2+80                                              01357000
CVTRV427 EQU   CVTXTNT2+76                                              01358000
CVTRV426 EQU   CVTXTNT2+72                                              01359000
CVTRV425 EQU   CVTXTNT2+68                                              01360000
CVTATACT EQU   CVTATCVT                                                 01361000
CVTRV423 EQU   CVTXTNT2+62                                              01362000
CVTRV422 EQU   CVTXTNT2+60                                              01363000
CVTRV421 EQU   CVTXTNT2+58                                              01364000
CVTRV420 EQU   CVTXTNT2+56                                              01365000
CVTRV419 EQU   CVTXTNT2+55                                              01366000
CVTRV418 EQU   CVTXTNT2+54                                              01367000
CVTRV417 EQU   CVTRV409                                                 01368000
CVTRV416 EQU   CVTRV409                                                 01369000
CVTRV415 EQU   CVTRV409                                                 01370000
CVTRV414 EQU   CVTRV409                                                 01371000
CVTRV413 EQU   CVTRV409                                                 01372000
CVTRV412 EQU   CVTRV409                                                 01373000
CVTRV411 EQU   CVTRV409                                                 01374000
CVTRV410 EQU   CVTRV409                                                 01375000
CVTRV408 EQU   CVTRV400                                                 01376000
CVTRV407 EQU   CVTRV400                                                 01377000
CVTRV406 EQU   CVTRV400                                                 01378000
CVTRV405 EQU   CVTRV400                                                 01379000
CVTRV404 EQU   CVTRV400                                                 01380000
CVTRV403 EQU   CVTRV400                                                 01381000
CVTRV402 EQU   CVTRV400                                                 01382000
CVTRV401 EQU   CVTRV400                                                 01383000
CVTICB   EQU   CVTXTNT2+48                                              01384000
CVTSKTA  EQU   CVTXTNT2+44                                              01385000
CVTRSV99 EQU   CVTXTNT2+40                                              01386000
CVTRSV98 EQU   CVTXTNT2+36                                              01387000
CVTRSV97 EQU   CVTXTNT2+34                                              01388000
CVTRSV96 EQU   CVTXTNT2+32                                              01389000
CVTOLTEP EQU   CVTXTNT2+28                                              01390000
CVTQIDA  EQU   CVTQID+1                                                 01391000
CVTRSV95 EQU   CVTQID                                                   01392000
CVTRSV94 EQU   CVTXTNT2+20                                              01393000
CVTRSV93 EQU   CVTXTNT2+16                                              01394000
CVTRSV92 EQU   CVTXTNT2+12                                              01395000
CVTDEBVR EQU   CVTXTNT2+8                                               01396000
CVTRSV91 EQU   CVTXTNT2+6                                               01397000
CVTRSV9H EQU   CVTFLGBT                                                 01398000
CVTRSV9G EQU   CVTFLGBT                                                 01399000
CVTRSV9F EQU   CVTFLGBT                                                 01400000
CVTRSV9E EQU   CVTFLGBT                                                 01401000
CVTRSV9D EQU   CVTFLGBT                                                 01402000
CVTRSV9C EQU   CVTFLGBT                                                 01403000
CVTVME   EQU   CVTFLGBT                                                 01404000
CVTNPE   EQU   CVTFLGBT                                                 01405000
CVTNUCLS EQU   CVTXTNT2+4                                               01406000
CVTDSSVA EQU   CVTDSSV+1                                                01407000
CVTRSV89 EQU   CVTDSSV                                                  01408000
CVTRSV88 EQU   CVTXTNT1+8                                               01409000
CVTRSV87 EQU   CVTXTNT1+4                                               01410000
CVTFACHN EQU   CVTXTNT1                                                 01411000
CVTRV488 EQU   CVTMAP+412                                               01412000
CVTRV487 EQU   CVTMAP+408                                               01413000
CVTRV486 EQU   CVTMAP+404                                               01414000
CVTRV485 EQU   CVTMAP+400                                               01415000
CVTACTAP EQU   CVTMAP+396                                               01416000
CVTAUTH  EQU   CVTMAP+392                                               01417000
CVTATMCA EQU   CVTATMCT+1                                               01418000
CVTATMST EQU   CVTATMCT                                                 01419000
CVTRSV61 EQU   CVTMAP+384                                               01420000
CVTVOLT1 EQU   CVTVOLM1+1                                               01421000
CVTVOLI1 EQU   CVTVOLF1                                                 01422000
CVTSTOA  EQU   CVTMAP+376                                               01423000
CVTRSV58 EQU   CVTMAP+374                                               01424000
CVTRSV57 EQU   CVTMAP+372                                               01425000
CVTDDCE  EQU   CVTMAP+368                                               01426000
CVTPNWFR EQU   CVTMAP+364                                               01427000
CVTSMF   EQU   CVTMAP+360                                               01428000
CVTSULK  EQU   CVTMAP+358                                               01429000
CVTSLKO  EQU   CVTSYSK                                                  01430000
CVTSLKP  EQU   CVTSYSK                                                  01431000
CVTSLKQ  EQU   CVTSYSK                                                  01432000
CVTSLKR  EQU   CVTSYSK                                                  01433000
CVTRSV56 EQU   CVTSYSK                                                  01434000
CVTRSV55 EQU   CVTSYSK                                                  01435000
CVTRSV54 EQU   CVTSYSK                                                  01436000
CVTRSV53 EQU   CVTSYSK                                                  01437000
CVTRSV52 EQU   CVTA1F1                                                  01438000
CVTRSV51 EQU   CVTA1F1                                                  01439000
CVTRSV50 EQU   CVTA1F1                                                  01440000
CVTRSV49 EQU   CVTA1F1                                                  01441000
CVTRSV48 EQU   CVTA1F1                                                  01442000
CVTRSV47 EQU   CVTA1F1                                                  01443000
CVTSRSW  EQU   CVTA1F1                                                  01444000
CVTPFSW  EQU   CVTA1F1                                                  01445000
CVTPCVT  EQU   CVTMAP+352                                               01446000
CVTRSV46 EQU   CVTMAP+344                                               01447000
CVTRSV45 EQU   CVTMAP+340                                               01448000
CVTRSV44 EQU   CVTMAP+338                                               01449000
CVTRSV43 EQU   CVTMAP+336                                               01450000
CVTHJESA EQU   CVTHJES+1                                                01451000
CVTRSV42 EQU   CVTHJES                                                  01452000
CVTEXT2A EQU   CVTEXT2+1                                                01453000
CVTRSV41 EQU   CVTEXT2                                                  01454000
CVTAPFA  EQU   CVTAPF+1                                                 01455000
CVTRSV40 EQU   CVTAPF                                                   01456000
CVTRV518 EQU   CVTINTLA                                                 01457000
CVTRV517 EQU   CVTERPV                                                  01458000
CVTEORM  EQU   CVTMAP+312                                               01459000
CVTMCHPR EQU   CVTMAP+308                                               01460000
CVTTZ    EQU   CVTMAP+304                                               01461000
CVTJEPS  EQU   CVTMAP+300                                               01462000
CVTJESCT EQU   CVTMAP+296                                               01463000
CVTMODE  EQU   CVTMAP+292                                               01464000
CVTPTRV  EQU   CVTMAP+288                                               01465000
CVTREAL  EQU   CVTMAP+284                                               01466000
CVTRSV39 EQU   CVTMAP+280                                               01467000
CVTRSV38 EQU   CVTMAP+276                                               01468000
CVTDMSRA EQU   CVTDMSR+1                                                01469000
CVTRV634 EQU   CVTDMSRF                                                 01470000
CVTRV633 EQU   CVTDMSRF                                                 01471000
CVTRV632 EQU   CVTDMSRF                                                 01472000
CVTRV631 EQU   CVTDMSRF                                                 01473000
CVTRV630 EQU   CVTDMSRF                                                 01474000
CVTRV629 EQU   CVTDMSRF                                                 01475000
CVTUDUMP EQU   CVTDMSRF                                                 01476000
CVTSDUMP EQU   CVTDMSRF                                                 01477000
CVTQMSGA EQU   CVTQMSG+1                                                01478000
CVTRSV36 EQU   CVTQMSG                                                  01479000
CVTAMFF  EQU   CVTMAP+264                                               01480000
CVTPURGA EQU   CVTPURG+1                                                01481000
CVTRSV35 EQU   CVTPURG                                                  01482000
CVTCBSP  EQU   CVTMAP+256                                               01483000
CVTATERA EQU   CVTATER+1                                                01484000
CVTSYST  EQU   CVTATER                                                  01485000
CVTVOLT2 EQU   CVTTAT                                                   01486000
CVTVOLI2 EQU   CVTVOLF2                                                 01487000
CVTAQAVB EQU   CVTAQAVT+1                                               01488000
CVTRSV34 EQU   CVTTCMFG                                                 01489000
CVTRSV33 EQU   CVTTCMFG                                                 01490000
CVTRSV32 EQU   CVTTCMFG                                                 01491000
CVTRSV31 EQU   CVTTCMFG                                                 01492000
CVTRSV30 EQU   CVTTCMFG                                                 01493000
CVTRSV29 EQU   CVTTCMFG                                                 01494000
CVTRSV28 EQU   CVTTCMFG                                                 01495000
CVTTCRDY EQU   CVTTCMFG                                                 01496000
CVTGTFA  EQU   CVTGTF+1                                                 01497000
CVTRSV27 EQU   CVTGTFST                                                 01498000
CVTRNIO  EQU   CVTGTFST                                                 01499000
CVTUSR   EQU   CVTGTFST                                                 01500000
CVTRV318 EQU   CVTFORM                                                  01501000
CVTRV317 EQU   CVTTMODE                                                 01502000
CVTRV316 EQU   CVTSTATE                                                 01503000
CVTRV315 EQU   CVTGTFS                                                  01504000
CVTGTFAV EQU   CVTGTFS                                                  01505000
CVT0SCR1 EQU   CVTMAP+232                                               01506000
CVTRV515 EQU   CVTMAP+228                                               01507000
CVTRMS   EQU   CVTMAP+224                                               01508000
CVTPATCH EQU   CVTMAP+220                                               01509000
CVTTSCE  EQU   CVTMAP+216                                               01510000
CVTLNKSC EQU   CVTMAP+214                                               01511000
CVTQABST EQU   CVTMAP+212                                               01512000
CVTMDLDS EQU   CVTMAP+208                                               01513000
CVTUSER  EQU   CVTMAP+204                                               01514000
CVTABEND EQU   CVTMAP+200                                               01515000
CVTSMCA  EQU   CVTMAP+196                                               01516000
CVTRSV18 EQU   CVTMAP+192                                               01517000
CVTQLPAQ EQU   CVTMAP+188                                               01518000
CVTQCDSR EQU   CVTMAP+184                                               01519000
CVTRSV17 EQU   CVTOPTB                                                  01520000
CVTRSV16 EQU   CVTOPTB                                                  01521000
CVTFP    EQU   CVTOPTB                                                  01522000
CVTAPTHR EQU   CVTOPTB                                                  01523000
CVTNLOG  EQU   CVTOPTB                                                  01524000
CVTTOD   EQU   CVTOPTB                                                  01525000
CVTCTIMS EQU   CVTOPTB                                                  01526000
CVTPROT  EQU   CVTOPTB                                                  01527000
CVTXPFP  EQU   CVTOPTA                                                  01528000
CVTASCII EQU   CVTOPTA                                                  01529000
CVTRSV13 EQU   CVTOPTA                                                  01530000
CVTRSV12 EQU   CVTOPTA                                                  01531000
CVTNIP   EQU   CVTOPTA                                                  01532000
CVTDDR   EQU   CVTOPTA                                                  01533000
CVTAPR   EQU   CVTOPTA                                                  01534000
CVTCCH   EQU   CVTOPTA                                                  01535000
CVTSNCTR EQU   CVTMAP+180                                               01536000
CVTQMWR  EQU   CVTMAP+176                                               01537000
CVTQOCR  EQU   CVTMAP+172                                               01538000
CVT1EF00 EQU   CVTMAP+168                                               01539000
CVTMZ00  EQU   CVTMAP+164                                               01540000
CVTSV76Q EQU   CVTSV76C                                                 01541000
CVTRSV11 EQU   CVTMAP+156                                               01542000
CVTMSER  EQU   CVTMAP+148                                               01543000
CVTRV516 EQU   CVTIERLC                                                 01544000
CVTILCH  EQU   CVTMAP+140                                               01545000
CVT0DS   EQU   CVTMAP+136                                               01546000
CVTFBOSV EQU   CVTMAP+132                                               01547000
CVTNUCB  EQU   CVTMAP+128                                               01548000
CVTIXAVL EQU   CVTMAP+124                                               01549000
CVTSV76M EQU   CVTIOQET                                                 01550000
CVTDCBA  EQU   CVTMAP+117                                               01551000
CVTMVS2  EQU   CVTDCB                                                   01552000
CVT6DAT  EQU   CVTDCB                                                   01553000
CVT4MPS  EQU   CVTDCB                                                   01554000
CVTRSV09 EQU   CVTDCB                                                   01555000
CVT4MS1  EQU   CVTDCB                                                   01556000
CVT2SPS  EQU   CVTDCB                                                   01557000
CVT1SSS  EQU   CVTDCB                                                   01558000
CVTRSV08 EQU   CVTDCB                                                   01559000
CVTSTB   EQU   CVTMAP+112                                               01560000
CVTQTD00 EQU   CVTMAP+108                                               01561000
CVTQTE00 EQU   CVTMAP+104                                               01562000
CVTCUCB  EQU   CVTMAP+100                                               01563000
CVTSJQ   EQU   CVTMAP+96                                                01564000
CVTPBLDL EQU   CVTMAP+92                                                01565000
CVTTPC   EQU   CVTMAP+88                                                01566000
CVTSVDCB EQU   CVTMAP+84                                                01567000
CVTBRET  EQU   CVTMAP+82                                                01568000
CVTEXIT  EQU   CVTMAP+80                                                01569000
CVT0FN00 EQU   CVTMAP+76                                                01570000
CVTDARA  EQU   CVTDAR+1                                                 01571000
CVTRSV07 EQU   CVTFLGS1                                                 01572000
CVTRSV06 EQU   CVTFLGS1                                                 01573000
CVTRSV05 EQU   CVTFLGS1                                                 01574000
CVTRSV04 EQU   CVTFLGS1                                                 01575000
CVTRSV03 EQU   CVTFLGS1                                                 01576000
CVTRSV02 EQU   CVTFLGS1                                                 01577000
CVTRSV01 EQU   CVTFLGS1                                                 01578000
CVTDMPLK EQU   CVTFLGS1                                                 01579000
CVTXITP  EQU   CVTMAP+68                                                01580000
CVTZDTAB EQU   CVTMAP+64                                                01581000
CVTMSLT  EQU   CVTMAP+60                                                01582000
CVTDATE  EQU   CVTMAP+56                                                01583000
CVTBTERM EQU   CVTMAP+52                                                01584000
CVTSYSAD EQU   CVTMAP+48                                                01585000
CVTXTLER EQU   CVTMAP+44                                                01586000
CVTILK2  EQU   CVTMAP+40                                                01587000
CVTILK1  EQU   CVTMAP+36                                                01588000
CVTPRLTV EQU   CVTMAP+32                                                01589000
CVTPCNVT EQU   CVTMAP+28                                                01590000
CVT0VL00 EQU   CVTMAP+24                                                01591000
CVTXAPG  EQU   CVTMAP+20                                                01592000
CVTBUF   EQU   CVTMAP+16                                                01593000
CVTJOB   EQU   CVTMAP+12                                                01594000
CVTLINK  EQU   CVTMAP+8                                                 01595000
CVT0EF00 EQU   CVTMAP+4                                                 01596000
CVTTCBP  EQU   CVTMAP                                                   01597000
CVT      EQU   CVTMAP                                                   01598000
AP1END   EQU   AP1BLOCK+360                                             01599000
AP1ERRTF EQU   AP1BLOCK+300                                             01600000
AP1ERRTM EQU   AP1BLOCK+270                                             01601000
AP1ENQAD EQU   AP1BLOCK+266                                             01602000
AP1DEVAD EQU   AP1BLOCK+262                                             01603000
AP1LSTHH EQU   AP1BLOCK+260                                             01604000
AP1LSTCC EQU   AP1BLOCK+258                                             01605000
AP1SKCNT EQU   AP1BLOCK+256                                             01606000
AP1ETABA EQU   AP1BLOCK+252                                             01607000
AP1RET   EQU   AP1BLOCK+251                                             01608000
AP1DEVTP EQU   AP1BLOCK+250                                             01609000
AP1TSTNO EQU   AP1BLOCK+249                                             01610000
AP1DCCNT EQU   AP1BLOCK+248                                             01611000
@NM00004 EQU   AP1BLOCK+247                                             01612000
AP1ENQD  EQU   AP1FLG4                                                  01613000
AP1DEBCH EQU   AP1FLG4                                                  01614000
AP1READ  EQU   AP1FLG4                                                  01615000
AP1NORD  EQU   AP1FLG4                                                  01616000
AP1RDERR EQU   AP1FLG3                                                  01617000
AP1VERIF EQU   AP1FLG3                                                  01618000
AP1QUIT  EQU   AP1FLG3                                                  01619000
AP1PRERR EQU   AP1FLG3                                                  01620000
AP1ERROR EQU   AP1FLG3                                                  01621000
AP1LST   EQU   AP1FLG3                                                  01622000
AP1PTRN2 EQU   AP1FLG3                                                  01623000
AP1FHF   EQU   AP1FLG2                                                  01624000
AP1NOWR  EQU   AP1FLG2                                                  01625000
AP1IOECB EQU   AP1BLOCK+240                                             01626000
AP1IOBA  EQU   AP1BLOCK+236                                             01627000
AP1DEBA  EQU   AP1BLOCK+232                                             01628000
AP1DCBA  EQU   AP1BLOCK+228                                             01629000
CER      EQU   CECCHHR+4                                                01630000
CEHH     EQU   CECCHH+2                                                 01631000
CECC     EQU   CECCHH                                                   01632000
CEBB     EQU   AP1CESK                                                  01633000
R        EQU   CCHHR+4                                                  01634000
CC       EQU   CCHH                                                     01635000
BB       EQU   AP1SEEK+1                                                01636000
M        EQU   AP1SEEK                                                  01637000
AP1FM    EQU   AP1BLOCK+212                                             01638000
AP1PCODE EQU   AP1BLOCK+180                                             01639000
AP1TIMIN EQU   AP1TIMFA                                                 01640000
AP1IOACT EQU   AP1TIMFA                                                 01641000
AP1TIMEA EQU   AP1BLOCK+168                                             01642000
AP1BUFAB EQU   AP1BUFAD+1                                               01643000
@NM00003 EQU   AP1BUFAD                                                 01644000
AP1CCWAB EQU   AP1CCWA+1                                                01645000
@NM00002 EQU   AP1CCWA                                                  01646000
AP1WRKA  EQU   AP1BLOCK+156                                             01647000
AP1RECB  EQU   AP1BLOCK+152                                             01648000
@NM00001 EQU   AP1BLOCK+150                                             01649000
AP1CNRPL EQU   AP1BLOCK+146                                             01650000
AP1CNCOD EQU   AP1BLOCK+145                                             01651000
AP1PRCLS EQU   AP1PFLG1                                                 01652000
AP1PRNP  EQU   AP1PFLG1                                                 01653000
AP1PROPN EQU   AP1PFLG1                                                 01654000
AP1PRLIN EQU   AP1BLOCK+142                                             01655000
AP1PRPAG EQU   AP1BLOCK+140                                             01656000
AP1PRCOD EQU   AP1BLOCK+139                                             01657000
AP1PRMSG EQU   AP1PRINT+1                                               01658000
AP1PRASA EQU   AP1PRINT                                                 01659000
AP1PDCBA EQU   AP1BLOCK+4                                               01660000
AP1HDR   EQU   AP1BLOCK                                                 01661000
@NM00030 EQU   PSA+3668                                                 01662000
PSASTAK  EQU   PSA+3072                                                 01663000
@NM00029 EQU   PSA+1048                                                 01664000
PSAUSEND EQU   PSA+1048                                                 01665000
PSARV062 EQU   PSA+1044                                                 01666000
PSACDAL  EQU   PSA+1040                                                 01667000
PSAWTCOD EQU   PSA+1036                                                 01668000
PSAATCVT EQU   PSA+1032                                                 01669000
PSAPCPSW EQU   PSA+1024                                                 01670000
PSAPIR2  EQU   PSA+1020                                                 01671000
PSARV059 EQU   PSA+1018                                                 01672000
PSASVC13 EQU   PSA+1016                                                 01673000
PSALSFCC EQU   PSA+1012                                                 01674000
PSASFACC EQU   PSA+1008                                                 01675000
PSASTOP  EQU   PSA+992                                                  01676000
PSASTART EQU   PSA+976                                                  01677000
PSARSPSW EQU   PSA+968                                                  01678000
PSASRPSW EQU   PSA+960                                                  01679000
PSARV045 EQU   PSA+892                                                  01680000
PSARV044 EQU   PSA+888                                                  01681000
PSARV043 EQU   PSA+884                                                  01682000
PSARV042 EQU   PSA+880                                                  01683000
PSARV041 EQU   PSA+876                                                  01684000
PSARV040 EQU   PSA+872                                                  01685000
PSARV025 EQU   PSA+868                                                  01686000
PSADSSED EQU   PSA+868                                                  01687000
PSADSSPR EQU   PSA+864                                                  01688000
PSADSSFW EQU   PSA+860                                                  01689000
PSADSS14 EQU   PSA+856                                                  01690000
PSADSSPP EQU   PSA+848                                                  01691000
PSADSSRP EQU   PSA+840                                                  01692000
PSADSS05 EQU   PSADSSF4                                                 01693000
PSADSS10 EQU   PSADSSF4                                                 01694000
PSADSSVE EQU   PSADSSF4                                                 01695000
PSADSSDE EQU   PSADSSF4                                                 01696000
PSADSSC0 EQU   PSADSSF4                                                 01697000
PSADSSIE EQU   PSADSSF4                                                 01698000
PSADSS12 EQU   PSADSSF4                                                 01699000
PSADSSRC EQU   PSADSSF4                                                 01700000
PSARV057 EQU   PSADSSF3                                                 01701000
PSARV056 EQU   PSADSSF3                                                 01702000
PSARV055 EQU   PSADSSF3                                                 01703000
PSADSSMC EQU   PSADSSF3                                                 01704000
PSADSSRW EQU   PSADSSF3                                                 01705000
PSADSSNM EQU   PSADSSF3                                                 01706000
PSADSSES EQU   PSADSSF3                                                 01707000
PSADSSGP EQU   PSADSSF3                                                 01708000
PSADSSF2 EQU   PSADSSFL+1                                               01709000
PSADSSPI EQU   PSADSSF1                                                 01710000
PSADSSOI EQU   PSADSSF1                                                 01711000
PSADSSSP EQU   PSADSSF1                                                 01712000
PSADSSTP EQU   PSADSSF1                                                 01713000
PSADSSDW EQU   PSADSSF1                                                 01714000
PSADSSDD EQU   PSADSSF1                                                 01715000
PSADSSDM EQU   PSADSSF1                                                 01716000
PSADSSMV EQU   PSADSSF1                                                 01717000
PSADSSTS EQU   PSA+816                                                  01718000
PSADSSWK EQU   PSA+812                                                  01719000
PSADSSR3 EQU   PSA+808                                                  01720000
PSADSSR2 EQU   PSA+804                                                  01721000
PSADSSRS EQU   PSA+800                                                  01722000
PSASTOR  EQU   PSA+796                                                  01723000
PSACPUSA EQU   PSA+794                                                  01724000
PSAVSTAP EQU   PSA+792                                                  01725000
PSAWKVAP EQU   PSA+788                                                  01726000
PSAWKRAP EQU   PSA+784                                                  01727000
PSAMCHIC EQU   PSA+783                                                  01728000
PSARV061 EQU   PSA+782                                                  01729000
PSASYMSK EQU   PSA+781                                                  01730000
PSAMCHFL EQU   PSA+780                                                  01731000
PSACR0   EQU   PSA+776                                                  01732000
PSAPSWSV EQU   PSA+768                                                  01733000
PSALITA  EQU   PSA+764                                                  01734000
PSACLHS  EQU   PSAHLHI                                                  01735000
PSALKR15 EQU   PSALKSA+60                                               01736000
PSALKR14 EQU   PSALKSA+56                                               01737000
PSALKR13 EQU   PSALKSA+52                                               01738000
PSALKR12 EQU   PSALKSA+48                                               01739000
PSALKR11 EQU   PSALKSA+44                                               01740000
PSALKR10 EQU   PSALKSA+40                                               01741000
PSALKR9  EQU   PSALKSA+36                                               01742000
PSALKR8  EQU   PSALKSA+32                                               01743000
PSALKR7  EQU   PSALKSA+28                                               01744000
PSALKR6  EQU   PSALKSA+24                                               01745000
PSALKR5  EQU   PSALKSA+20                                               01746000
PSALKR4  EQU   PSALKSA+16                                               01747000
PSALKR3  EQU   PSALKSA+12                                               01748000
PSALKR2  EQU   PSALKSA+8                                                01749000
PSALKR1  EQU   PSALKSA+4                                                01750000
PSALKR0  EQU   PSALKSA                                                  01751000
PSARV023 EQU   PSACLHT+52                                               01752000
PSALOCAL EQU   PSACLHT+48                                               01753000
PSACMSL  EQU   PSACLHT+44                                               01754000
PSAOPTL  EQU   PSACLHT+40                                               01755000
PSATPACL EQU   PSACLHT+36                                               01756000
PSATPDNL EQU   PSACLHT+32                                               01757000
PSATPNCL EQU   PSACLHT+28                                               01758000
PSAIOSLL EQU   PSACLHT+24                                               01759000
PSAIOSUL EQU   PSACLHT+20                                               01760000
PSAIOSCL EQU   PSACLHT+16                                               01761000
PSAIOSSL EQU   PSACLHT+12                                               01762000
PSASALCL EQU   PSACLHT+8                                                01763000
PSAASML  EQU   PSACLHT+4                                                01764000
PSADISPL EQU   PSACLHT                                                  01765000
PSASRSA  EQU   PSA+636                                                  01766000
PSARV050 EQU   PSA+634                                                  01767000
PSADSSGO EQU   PSA+633                                                  01768000
PSARECUR EQU   PSA+632                                                  01769000
PSAHLHIS EQU   PSA+628                                                  01770000
PSAIPCSA EQU   PSA+624                                                  01771000
@NM00028 EQU   PSA+621                                                  01772000
PSAIPCDM EQU   PSA+620                                                  01773000
PSAIPCD  EQU   PSA+616                                                  01774000
@NM00027 EQU   PSA+613                                                  01775000
PSAIPCRM EQU   PSA+612                                                  01776000
PSAIPCR  EQU   PSA+608                                                  01777000
PSAMCHEX EQU   PSA+600                                                  01778000
PSAMPSW  EQU   PSA+592                                                  01779000
PSAEXPS2 EQU   PSA+584                                                  01780000
PSAEXPS1 EQU   PSA+576                                                  01781000
PSAPIREG EQU   PSA+572                                                  01782000
PSARSREG EQU   PSA+568                                                  01783000
PSAGPREG EQU   PSA+556                                                  01784000
PSARV022 EQU   PSASUP4                                                  01785000
PSARV021 EQU   PSASUP4                                                  01786000
PSARV020 EQU   PSASUP4                                                  01787000
PSARV019 EQU   PSASUP4                                                  01788000
PSARV018 EQU   PSASUP4                                                  01789000
PSARV017 EQU   PSASUP4                                                  01790000
PSARV016 EQU   PSASUP4                                                  01791000
PSARV015 EQU   PSASUP4                                                  01792000
PSARV014 EQU   PSASUP3                                                  01793000
PSARV013 EQU   PSASUP3                                                  01794000
PSARV012 EQU   PSASUP3                                                  01795000
PSAESTA  EQU   PSASUP3                                                  01796000
PSASPR   EQU   PSASUP3                                                  01797000
PSAPSREG EQU   PSASUP3                                                  01798000
PSAPI2   EQU   PSASUP3                                                  01799000
PSAIOSUP EQU   PSASUP3                                                  01800000
PSALCR   EQU   PSASUP2                                                  01801000
PSARTM   EQU   PSASUP2                                                  01802000
PSAACR   EQU   PSASUP2                                                  01803000
PSAIPCE2 EQU   PSASUP2                                                  01804000
PSAIPCES EQU   PSASUP2                                                  01805000
PSAIPCEC EQU   PSASUP2                                                  01806000
PSAGTF   EQU   PSASUP2                                                  01807000
PSAIPCRI EQU   PSASUP2                                                  01808000
PSATYPE6 EQU   PSASUP1                                                  01809000
PSATCTL  EQU   PSASUP1                                                  01810000
PSADISP  EQU   PSASUP1                                                  01811000
PSALOCK  EQU   PSASUP1                                                  01812000
PSAPI    EQU   PSASUP1                                                  01813000
PSAEXT   EQU   PSASUP1                                                  01814000
PSASVC   EQU   PSASUP1                                                  01815000
PSAIO    EQU   PSASUP1                                                  01816000
PSAAOLD  EQU   PSA+548                                                  01817000
PSAANEW  EQU   PSA+544                                                  01818000
PSATOLD  EQU   PSA+540                                                  01819000
PSATNEW  EQU   PSA+536                                                  01820000
PSALCCAR EQU   PSA+532                                                  01821000
PSALCCAV EQU   PSA+528                                                  01822000
PSAPCCAR EQU   PSA+524                                                  01823000
PSAPCCAV EQU   PSA+520                                                  01824000
PSACPULA EQU   PSA+518                                                  01825000
PSACPUPA EQU   PSA+516                                                  01826000
PSAPSA   EQU   PSA+512                                                  01827000
FLCHDEND EQU   PSA+512                                                  01828000
FLCCRSAV EQU   FLCMCLA+280                                              01829000
FLCGRSAV EQU   FLCMCLA+216                                              01830000
FLCFPSAV EQU   FLCMCLA+184                                              01831000
FLCFLA   EQU   FLCMCLA+88                                               01832000
FLCRGNCD EQU   FLCMCLA+84                                               01833000
FLCFSAA  EQU   FLCFSA+1                                                 01834000
@NM00026 EQU   FLCFSA                                                   01835000
@NM00025 EQU   FLCMCLA+72                                               01836000
FLCMCIC  EQU   FLCMCLA+64                                               01837000
@NM00024 EQU   FLCMCLA+20                                               01838000
FLCIOAA  EQU   FLCIOA+1                                                 01839000
@NM00023 EQU   FLCIOA                                                   01840000
@NM00022 EQU   FLCMCLA+15                                               01841000
@NM00021 EQU   FLCMCLA+14                                               01842000
@NM00020 EQU   FLCMCLA+12                                               01843000
FLCLCL   EQU   FLCMCLA+8                                                01844000
FLCIOELA EQU   FLCIOEL+1                                                01845000
@NM00019 EQU   FLCIOEL                                                  01846000
FLCCHNID EQU   FLCMCLA                                                  01847000
@NM00018 EQU   PSA+160                                                  01848000
FLCMTRCD EQU   PSA+157                                                  01849000
@NM00017 EQU   PSA+156                                                  01850000
FLCPERA  EQU   FLCPER+1                                                 01851000
@NM00016 EQU   FLCPER                                                   01852000
@NM00015 EQU   PSA+151                                                  01853000
FLCPERCD EQU   PSA+150                                                  01854000
FLCMCNUM EQU   PSA+149                                                  01855000
@NM00014 EQU   PSA+148                                                  01856000
FLCTEAA  EQU   FLCTEA+1                                                 01857000
@NM00013 EQU   FLCTEA                                                   01858000
PSAPIPC  EQU   PSAPICOD                                                 01859000
PSAPIMC  EQU   PSAPICOD                                                 01860000
PSAPIPER EQU   PSAPICOD                                                 01861000
PSARV049 EQU   FLCPICOD                                                 01862000
FLCPILCB EQU   FLCPIILC                                                 01863000
@NM00012 EQU   FLCPIILC                                                 01864000
@NM00011 EQU   PSAEPPSW                                                 01865000
FLCSVCN  EQU   PSAESPSW+2                                               01866000
FLCSILCB EQU   FLCSVILC                                                 01867000
@NM00010 EQU   FLCSVILC                                                 01868000
@NM00009 EQU   PSAESPSW                                                 01869000
FLCEICOD EQU   PSAEEPSW+2                                               01870000
PSASPAD  EQU   PSAEEPSW                                                 01871000
@NM00008 EQU   PSA+128                                                  01872000
FLCINPSW EQU   PSA+120                                                  01873000
FLCMNPSW EQU   PSA+112                                                  01874000
FLCPNPSW EQU   PSA+104                                                  01875000
FLCSNPSW EQU   PSA+96                                                   01876000
FLCENPSW EQU   PSA+88                                                   01877000
FLCTRACE EQU   PSA+84                                                   01878000
FLCTIMER EQU   PSA+80                                                   01879000
FLCCVT2  EQU   PSA+76                                                   01880000
FLCCAW   EQU   PSA+72                                                   01881000
FLCCSW   EQU   PSA+64                                                   01882000
FLCIOPSW EQU   PSA+56                                                   01883000
FLCMOPSW EQU   PSA+48                                                   01884000
FLCPOPSW EQU   PSA+40                                                   01885000
FLCSOPSW EQU   PSA+32                                                   01886000
FLCEOPSW EQU   PSA+24                                                   01887000
@NM00007 EQU   FLCICCW2+4                                               01888000
FLCICCW1 EQU   FLCROPSW                                                 01889000
FLCIPPSW EQU   FLCRNPSW                                                 01890000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01891000
@RC00136 EQU   @RC00134                                                 01892000
@RC00148 EQU   @RC00146                                                 01893000
@ENDDATA EQU   *                                                        01894000
         END   IAPABNAP,(C'PLS1707',0701,77308)                         01895000
./  ADD  SSI=73080181,NAME=IAPBLDIO
         TITLE 'IAPBLDIO - AP-1 CCW CHAIN BUILDER                      *00001000
                        '                                               00002000
IAPBLDIO CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(16)                                          01S0001 00007000
         DC    C'IAPBLDIO  77.308'                              01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @11,0                                            01S0001 00011000
@PSTART  LA    @12,4095(,@11)                                   01S0001 00012000
         USING @PSTART,@11                                      01S0001 00013000
         USING @PSTART+4095,@12                                 01S0001 00014000
*                                                               01S0100 00015000
         USING @DATD+AP1BLOCK-AP1END,AP1REG  ADDRESSABILITY             00016000
         ST    13,@SA00001+4     BACKWARD POINTER                       00017000
         LA    15,@SA00001       OUR SAVE AREA                          00018000
         ST    15,8(,13)         FOREWARD POINTER                       00019000
         LR     13,15            SET REG 13                             00020000
*   /*****************************************************************/ 00021000
*   /*                                                               */ 00022000
*   /* SELECT BUILD ROUTINE BASED ON AP1TSTNO                        */ 00023000
*   /*                                                               */ 00024000
*   /*****************************************************************/ 00025000
*                                                               01S0101 00026000
*   DO;                             /* CASE(AP1TSTNO)NAMES(RECAL,SNS,   00027000
*                                      RECAL,RHAMHS,RHAMH,RHAFHS,RHAF   00028000
*                                      H,RPS,SK192,SKINCR,SKMAX,SKRAN   00029000
*                                      S,SKRAN,RHAS,CE,WRTS,CE,RR01S,   00030000
*                                      CE,RDMT,FTWRT,AMDET,WRTPAD,SD,   00031000
*                                      CLEANUP)                      */ 00032000
*     DCL                                                       01S0102 00033000
*       CL0001@ LABEL BASED(CP0001@(AP1TSTNO)) VALUERANGE(RECAL,SNS,    00034000
*           RECAL,RHAMHS,RHAMH,RHAFHS,RHAFH,RPS,SK192,SKINCR,SKMAX,     00035000
*           SKRANS,SKRAN,RHAS,CE,WRTS,CE,RR01S,CE,RDMT,FTWRT,AMDET,     00036000
*           WRTPAD,SD,CLEANUP);     /* BRANCH TARGET                 */ 00037000
*     DCL                                                       01S0103 00038000
*       CP0001@(25) PTR(31) INIT(ADDR(RECAL),ADDR(SNS),ADDR(RECAL),ADDR 00039000
*           (RHAMHS),ADDR(RHAMH),ADDR(RHAFHS),ADDR(RHAFH),ADDR(RPS),    00040000
*           ADDR(SK192),ADDR(SKINCR),ADDR(SKMAX),ADDR(SKRANS),ADDR(     00041000
*           SKRAN),ADDR(RHAS),ADDR(CE),ADDR(WRTS),ADDR(CE),ADDR(RR01S), 00042000
*           ADDR(CE),ADDR(RDMT),ADDR(FTWRT),ADDR(AMDET),ADDR(WRTPAD),   00043000
*           ADDR(SD),ADDR(CLEANUP));                            01S0103 00044000
*     GOTO CL0001@;                 /* BRANCH TO SELECTED CASE       */ 00045000
*                                                               01S0104 00046000
         SLR   @10,@10                                          01S0104 00047000
         IC    @10,AP1TSTNO(,AP1REG)                            01S0104 00048000
         SLA   @10,2                                            01S0104 00049000
         L     @10,CP0001@-4(@10)                               01S0104 00050000
         BR    @10                                              01S0104 00051000
*     /***************************************************************/ 00052000
*     /*                                                             */ 00053000
*     /* RECAL: DUMMY RECALIBRATE                                    */ 00054000
*     /*                                                             */ 00055000
*     /***************************************************************/ 00056000
*                                                               01S0105 00057000
*RECAL:                                                         01S0105 00058000
*     DO;                           /* SUBCASE RECALIBRATE           */ 00059000
RECAL    DS    0H                                               01S0106 00060000
*/*        CCW CHAIN:                                           01S0106 00061000
*                RECAL,0,SLI-CC,1     RECAL                     01S0106 00062000
*                NOP,0,0,1            TO GET DEVICE END              */ 00063000
*                                                               01S0106 00064000
*       AP1FM=READFM;               /* READ ONLY--ALL SEEKS          */ 00065000
         MVC   AP1FM(1,AP1REG),READFM                           01S0106 00066000
*       CCW(1)=RECALCCW;            /* RECAL,0,SLI-CC,1              */ 00067000
         L     @10,AP1CCWA(,AP1REG)                             01S0107 00068000
         MVC   CCW(8,@10),RECALCCW                              01S0107 00069000
*       CCW(2)=NOPCCW;              /* NOP,0,0,1                     */ 00070000
         MVC   CCW+8(8,@10),NOPCCW                              01S0108 00071000
*       CCHH=0;                     /* SEEK CYL 0, HD 0              */ 00072000
         SLR   @10,@10                                          01S0109 00073000
         ST    @10,CCHH(,AP1REG)                                01S0109 00074000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00075000
         B     CE0001@                                          01S0110 00076000
*     END RECAL;                    /* END OF SUBCASE                */ 00077000
*                                                               01S0111 00078000
*     /***************************************************************/ 00079000
*     /*                                                             */ 00080000
*     /* SNS: SENSE TO SEE IF EMULATED AND FIXED HEAD                */ 00081000
*     /*                                                             */ 00082000
*     /***************************************************************/ 00083000
*                                                               01S0112 00084000
*SNS:                                                           01S0112 00085000
*     DO;                           /* SUBCASE                       */ 00086000
SNS      DS    0H                                               01S0113 00087000
*/*                  CCW CHAIN:                                 01S0113 00088000
*                    SNS,BUFF,0,24                                   */ 00089000
*                                                               01S0113 00090000
*       AP1FM=READFM;               /* FILE MASK,READ ONLY--ALL SEEKS*/ 00091000
*                                                               01S0113 00092000
         MVC   AP1FM(1,AP1REG),READFM                           01S0113 00093000
*       /*************************************************************/ 00094000
*       /*                                                           */ 00095000
*       /* AP1SEEK IS STILL 000000000                                */ 00096000
*       /*                                                           */ 00097000
*       /*************************************************************/ 00098000
*                                                               01S0114 00099000
*       CCW(1)=SNSCCW;              /* SNS,0,0,24                    */ 00100000
         L     @10,AP1CCWA(,AP1REG)                             01S0114 00101000
         MVC   CCW(8,@10),SNSCCW                                01S0114 00102000
*       CCWADDRB(1)=AP1BUFAB;       /* READ SNS INTO BUFFER          */ 00103000
         MVC   CCWADDRB(3,@10),AP1BUFAB(AP1REG)                 01S0115 00104000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00105000
         B     CE0001@                                          01S0116 00106000
*     END SNS;                      /* END OF SUBCASE                */ 00107000
*                                                               01S0117 00108000
*     /***************************************************************/ 00109000
*     /*                                                             */ 00110000
*     /* RHAMHS: CHECK MOVEABLE HEADS                                */ 00111000
*     /*                                                             */ 00112000
*     /***************************************************************/ 00113000
*                                                               01S0118 00114000
*RHAMHS:                                                        01S0118 00115000
*     DO;                           /* SUBCASE READ HA ON MOVABLE       00116000
*                                      HDS--PHYS HD 0--RHAMH WILL       00117000
*                                      ALTER SEEK ADDRESS TO READ HDS   00118000
*                                      1-29                          */ 00119000
RHAMHS   DS    0H                                               01S0119 00120000
*/*        CCW CHAIN:                                           01S0119 00121000
*                READ HA,0,SKIP,5                                    */ 00122000
*                                                               01S0119 00123000
*       CCHH=0;                     /* CYL 0, HD 0                   */ 00124000
         SLR   @10,@10                                          01S0119 00125000
         ST    @10,CCHH(,AP1REG)                                01S0119 00126000
*       AP1FM=READFM;               /* READ ONLY -- ALL SEEKS        */ 00127000
         MVC   AP1FM(1,AP1REG),READFM                           01S0120 00128000
*       CCW(1)=RHASKCCW;            /* RHA,0,SKIP,5                  */ 00129000
         L     @10,AP1CCWA(,AP1REG)                             01S0121 00130000
         MVC   CCW(8,@10),RHASKCCW                              01S0121 00131000
*       AP1ETABA=ADDR(AP1ERRTM);    /* POINT TO HD0 OF MOVABLE HD       00132000
*                                      MATRIX                        */ 00133000
         LA    @10,AP1ERRTM(,AP1REG)                            01S0122 00134000
         ST    @10,AP1ETABA(,AP1REG)                            01S0122 00135000
*       AP1TSTNO=AP1TSTNO+1;        /* USE CHK RTN FOR RHAMH         */ 00136000
         LA    @10,1                                            01S0123 00137000
         SLR   @09,@09                                          01S0123 00138000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0123 00139000
         ALR   @10,@09                                          01S0123 00140000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0123 00141000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00142000
         B     CE0001@                                          01S0124 00143000
*     END RHAMHS;                   /* END OF SUBCASE                */ 00144000
*                                                               01S0125 00145000
*     /***************************************************************/ 00146000
*     /*                                                             */ 00147000
*     /* RHAMH: CHECK MOVEABLE HEADS                                 */ 00148000
*     /*                                                             */ 00149000
*     /***************************************************************/ 00150000
*                                                               01S0126 00151000
*RHAMH:                                                         01S0126 00152000
*     DO;                           /* SUBCASE READ HA ON MOVEABLE      00153000
*                                      HDS 1-29 --RHAMHS SET UP CCW     00154000
*                                      CHAIN                         */ 00155000
*                                                               01S0126 00156000
RHAMH    DS    0H                                               01S0127 00157000
*       /*************************************************************/ 00158000
*       /*                                                           */ 00159000
*       /* INCREMENT TO NEXT PHYSICAL HEAD                           */ 00160000
*       /*                                                           */ 00161000
*       /*************************************************************/ 00162000
*                                                               01S0127 00163000
*       IF HH=HI3330HD THEN         /* HEAD 18--LAST ON 3330 PACK    */ 00164000
         CLC   HH(2,AP1REG),@CB00215                            01S0127 00165000
         BNE   @RF00127                                         01S0127 00166000
*         IF AP1DEVTP=AP13350 THEN  /* 3350                          */ 00167000
         CLI   AP1DEVTP(AP1REG),4                               01S0128 00168000
         BNE   @RF00128                                         01S0128 00169000
*           DO;                                                 01S0129 00170000
*             AP1ETABA=AP1ETABA+1;  /* INCREMENT TABLE PTR           */ 00171000
         LA    @10,1                                            01S0130 00172000
         L     @09,AP1ETABA(,AP1REG)                            01S0130 00173000
         ALR   @09,@10                                          01S0130 00174000
         ST    @09,AP1ETABA(,AP1REG)                            01S0130 00175000
*             HH=HH+1;              /* GO TO HD 19                   */ 00176000
         LH    @09,HH(,AP1REG)                                  01S0131 00177000
         N     @09,@CF00595                                     01S0131 00178000
         ALR   @10,@09                                          01S0131 00179000
         STH   @10,HH(,AP1REG)                                  01S0131 00180000
*           END;                                                01S0132 00181000
*         ELSE                      /* MUST BE 3330                  */ 00182000
*           DO;                                                 01S0133 00183000
         B     @RC00128                                         01S0133 00184000
@RF00128 DS    0H                                               01S0134 00185000
*             AP1ETABA=AP1ETABA+2;  /* INCR TABLE PTR BY 2--PHYS HD     00186000
*                                      19 NOT USED                   */ 00187000
         LA    @10,2                                            01S0134 00188000
         AL    @10,AP1ETABA(,AP1REG)                            01S0134 00189000
         ST    @10,AP1ETABA(,AP1REG)                            01S0134 00190000
*             CCHH='00040000'X;     /* TO CYL 4 FOR PHYS HDS 20-29   */ 00191000
         MVC   CCHH(4,AP1REG),@CB00555                          01S0135 00192000
*           END;                                                01S0136 00193000
*       ELSE                        /* NOT HD 18                     */ 00194000
*         IF AP1DEVTP=AP13344 THEN  /* 3344                          */ 00195000
         B     @RC00127                                         01S0137 00196000
@RF00127 CLI   AP1DEVTP(AP1REG),3                               01S0137 00197000
         BNE   @RF00137                                         01S0137 00198000
*           IF CCHH='00000000'X THEN/* FIRST TRACK ON 3344           */ 00199000
         CLC   CCHH(4,AP1REG),@CB00556                          01S0138 00200000
         BNE   @RF00138                                         01S0138 00201000
*             HH='0001'X;           /* READ 2ND HALF OF TRK--SAME       00202000
*                                      PHYS HD                       */ 00203000
         MVC   HH(2,AP1REG),@CB00557                            01S0139 00204000
*           ELSE                    /* 3344 BUT NOT 1ST TRK          */ 00205000
*             DO;                                               01S0140 00206000
         B     @RC00138                                         01S0140 00207000
@RF00138 DS    0H                                               01S0141 00208000
*               IF CC=0&HH=HI3344HD THEN/* END OF CYL 0              */ 00209000
         LH    @10,CC(,AP1REG)                                  01S0141 00210000
         N     @10,@CF00595                                     01S0141 00211000
         LTR   @10,@10                                          01S0141 00212000
         BNZ   @RF00141                                         01S0141 00213000
         CLC   HH(2,AP1REG),@CB00235                            01S0141 00214000
         BNE   @RF00141                                         01S0141 00215000
*                 CC='000A'X;       /* SKIP 10 CYLS--MAY BE FIXED HDS*/ 00216000
         MVC   CC(2,AP1REG),@CB00558                            01S0142 00217000
*               ELSE                                            01S0143 00218000
*                 ;                 /* NOT END OF CYL 0              */ 00219000
@RF00141 DS    0H                                               01S0144 00220000
*               IF HH=HI3344HD THEN /* END OF CYL                    */ 00221000
         CLC   HH(2,AP1REG),@CB00235                            01S0144 00222000
         BNE   @RF00144                                         01S0144 00223000
*                 DO;                                           01S0145 00224000
*                   CC=CC+1;        /* GO TO NEXT CYL                */ 00225000
         LA    @10,1                                            01S0146 00226000
         LH    @09,CC(,AP1REG)                                  01S0146 00227000
         N     @09,@CF00595                                     01S0146 00228000
         ALR   @09,@10                                          01S0146 00229000
         STH   @09,CC(,AP1REG)                                  01S0146 00230000
*                   HH=1;           /* TRACK ONE                     */ 00231000
         STH   @10,HH(,AP1REG)                                  01S0147 00232000
*                 END;                                          01S0148 00233000
*               ELSE                /* NOT END OF CYL                */ 00234000
*                 HH=HH+2;          /* TO NEXT PHYSICAL TRACK        */ 00235000
         B     @RC00144                                         01S0149 00236000
@RF00144 LA    @10,2                                            01S0149 00237000
         LH    @09,HH(,AP1REG)                                  01S0149 00238000
         N     @09,@CF00595                                     01S0149 00239000
         ALR   @10,@09                                          01S0149 00240000
         STH   @10,HH(,AP1REG)                                  01S0149 00241000
*               AP1ETABA=AP1ETABA+1;/* INCR TABLE PTR TO NEXT PHYS      00242000
*                                      HEAD                          */ 00243000
@RC00144 LA    @10,1                                            01S0150 00244000
         AL    @10,AP1ETABA(,AP1REG)                            01S0150 00245000
         ST    @10,AP1ETABA(,AP1REG)                            01S0150 00246000
*             END;                                              01S0151 00247000
*         ELSE                      /* NOT 3344--NOT HD 18           */ 00248000
*           DO;                                                 01S0152 00249000
         B     @RC00137                                         01S0152 00250000
@RF00137 DS    0H                                               01S0153 00251000
*             AP1ETABA=AP1ETABA+1;  /* INCR TABLE PTR TO NEXT PHYS      00252000
*                                      HEAD                          */ 00253000
         LA    @10,1                                            01S0153 00254000
         L     @09,AP1ETABA(,AP1REG)                            01S0153 00255000
         ALR   @09,@10                                          01S0153 00256000
         ST    @09,AP1ETABA(,AP1REG)                            01S0153 00257000
*             HH=HH+1;              /* TO NEXT PHYS HEAD             */ 00258000
         LH    @09,HH(,AP1REG)                                  01S0154 00259000
         N     @09,@CF00595                                     01S0154 00260000
         ALR   @10,@09                                          01S0154 00261000
         STH   @10,HH(,AP1REG)                                  01S0154 00262000
*           END;                                                01S0155 00263000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00264000
         B     CE0001@                                          01S0156 00265000
*     END RHAMH;                    /* END OF SUBCASE                */ 00266000
*                                                               01S0157 00267000
*     /***************************************************************/ 00268000
*     /*                                                             */ 00269000
*     /* RHAFHS: CHECK FIXED HEADS                                   */ 00270000
*     /*                                                             */ 00271000
*     /***************************************************************/ 00272000
*                                                               01S0158 00273000
*RHAFHS:                                                        01S0158 00274000
*     DO;                           /* SUBCASE READ HA ON FIXED HEAD    00275000
*                                      0 --RHAFH WILL ALTER SEEK        00276000
*                                      ADDRESS TO HEADS 1-59         */ 00277000
RHAFHS   DS    0H                                               01S0159 00278000
*/*        CCW CHAIN:                                           01S0159 00279000
*                READ HA,0,SKIP,5                                    */ 00280000
*                                                               01S0159 00281000
*       CCHH=FIXEDHD1;              /* FIRST FIXED HEAD              */ 00282000
         MVC   CCHH(4,AP1REG),@CB00256                          01S0159 00283000
*       AP1ETABA=ADDR(AP1ERRTF);    /* POINT TO ERR TAB FOR FIXED HDS*/ 00284000
         LA    @10,AP1ERRTF(,AP1REG)                            01S0160 00285000
         ST    @10,AP1ETABA(,AP1REG)                            01S0160 00286000
*       CCW(1)=RHASKCCW;            /* RHA,0,SKIP,5                  */ 00287000
         L     @10,AP1CCWA(,AP1REG)                             01S0161 00288000
         MVC   CCW(8,@10),RHASKCCW                              01S0161 00289000
*       AP1TSTNO=AP1TSTNO+1;        /* USE CHK RTN FOR RHAFH         */ 00290000
         LA    @10,1                                            01S0162 00291000
         SLR   @09,@09                                          01S0162 00292000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0162 00293000
         ALR   @10,@09                                          01S0162 00294000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0162 00295000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00296000
         B     CE0001@                                          01S0163 00297000
*     END RHAFHS;                   /* END OF SUBCASE                */ 00298000
*                                                               01S0164 00299000
*     /***************************************************************/ 00300000
*     /*                                                             */ 00301000
*     /* RHAFH: CHECK FIXED HEADS                                    */ 00302000
*     /*                                                             */ 00303000
*     /***************************************************************/ 00304000
*                                                               01S0165 00305000
*RHAFH:                                                         01S0165 00306000
*     DO;                           /* SUBCASE READ HA ON FIXED HDS     00307000
*                                      1-59 --RHAFHS SET UP CCW CHAIN*/ 00308000
RHAFH    DS    0H                                               01S0166 00309000
*       IF AP1DEVTP=AP13344 THEN    /* 3344                          */ 00310000
         CLI   AP1DEVTP(AP1REG),3                               01S0166 00311000
         BNE   @RF00166                                         01S0166 00312000
*         IF HH=HI3344HD-1 THEN     /* LAST EVEN TRK ON CYL          */ 00313000
         CLC   HH(2,AP1REG),@CH00431                            01S0167 00314000
         BNE   @RF00167                                         01S0167 00315000
*           DO;                                                 01S0168 00316000
*             CC=CC+1;              /* GO TO NXT CYL                 */ 00317000
         LA    @10,1                                            01S0169 00318000
         LH    @09,CC(,AP1REG)                                  01S0169 00319000
         N     @09,@CF00595                                     01S0169 00320000
         ALR   @10,@09                                          01S0169 00321000
         STH   @10,CC(,AP1REG)                                  01S0169 00322000
*             HH=0;                 /* HEAD 0                        */ 00323000
         SLR   @10,@10                                          01S0170 00324000
         STH   @10,HH(,AP1REG)                                  01S0170 00325000
*           END;                                                01S0171 00326000
*         ELSE                      /* NOT LAST TRACK                */ 00327000
*           HH=HH+2;                /* GO TO NEXT PHYS TRACK         */ 00328000
         B     @RC00167                                         01S0172 00329000
@RF00167 LA    @10,2                                            01S0172 00330000
         LH    @09,HH(,AP1REG)                                  01S0172 00331000
         N     @09,@CF00595                                     01S0172 00332000
         ALR   @10,@09                                          01S0172 00333000
         STH   @10,HH(,AP1REG)                                  01S0172 00334000
*       ELSE                                                    01S0173 00335000
*         ;                         /* NOT 3344                      */ 00336000
@RF00166 DS    0H                                               01S0174 00337000
*       IF AP1DEVTP=AP13350 THEN    /* 3350                          */ 00338000
@RC00166 CLI   AP1DEVTP(AP1REG),4                               01S0174 00339000
         BNE   @RF00174                                         01S0174 00340000
*         IF HH=HI3350HD THEN       /* LAST TRK ON CYL               */ 00341000
         CLC   HH(2,AP1REG),@CB00233                            01S0175 00342000
         BNE   @RF00175                                         01S0175 00343000
*           DO;                                                 01S0176 00344000
*             CC=CC+1;              /* INCR TO NEXT CYL              */ 00345000
         LA    @10,1                                            01S0177 00346000
         LH    @09,CC(,AP1REG)                                  01S0177 00347000
         N     @09,@CF00595                                     01S0177 00348000
         ALR   @10,@09                                          01S0177 00349000
         STH   @10,CC(,AP1REG)                                  01S0177 00350000
*             HH=0;                 /* HEAD 0                        */ 00351000
         SLR   @10,@10                                          01S0178 00352000
         STH   @10,HH(,AP1REG)                                  01S0178 00353000
*           END;                                                01S0179 00354000
*         ELSE                      /* NOT LAST TRK ON CYL           */ 00355000
*           HH=HH+1;                /* GO TO NEXT TRK                */ 00356000
         B     @RC00175                                         01S0180 00357000
@RF00175 LA    @10,1                                            01S0180 00358000
         LH    @09,HH(,AP1REG)                                  01S0180 00359000
         N     @09,@CF00595                                     01S0180 00360000
         ALR   @10,@09                                          01S0180 00361000
         STH   @10,HH(,AP1REG)                                  01S0180 00362000
*       ELSE                                                    01S0181 00363000
*         ;                         /* NOT 3350                      */ 00364000
@RF00174 DS    0H                                               01S0182 00365000
*       IF AP1DEVTP<=AP13331 THEN   /* 3330                          */ 00366000
@RC00174 CLI   AP1DEVTP(AP1REG),2                               01S0182 00367000
         BH    @RF00182                                         01S0182 00368000
*         IF HH=HI3330HD THEN       /* LAST TRK ON CYL               */ 00369000
         CLC   HH(2,AP1REG),@CB00215                            01S0183 00370000
         BNE   @RF00183                                         01S0183 00371000
*           DO;                                                 01S0184 00372000
*             CC=CC+1;              /* INCR TO NEXT CYL              */ 00373000
         LA    @10,1                                            01S0185 00374000
         LH    @09,CC(,AP1REG)                                  01S0185 00375000
         N     @09,@CF00595                                     01S0185 00376000
         ALR   @10,@09                                          01S0185 00377000
         STH   @10,CC(,AP1REG)                                  01S0185 00378000
*             HH=0;                 /* HEAD 0                        */ 00379000
         SLR   @10,@10                                          01S0186 00380000
         STH   @10,HH(,AP1REG)                                  01S0186 00381000
*           END;                                                01S0187 00382000
*         ELSE                      /* NOT LAST TRK ON CYL           */ 00383000
*           HH=HH+1;                /* TO NEXT HEAD                  */ 00384000
         B     @RC00183                                         01S0188 00385000
@RF00183 LA    @10,1                                            01S0188 00386000
         LH    @09,HH(,AP1REG)                                  01S0188 00387000
         N     @09,@CF00595                                     01S0188 00388000
         ALR   @10,@09                                          01S0188 00389000
         STH   @10,HH(,AP1REG)                                  01S0188 00390000
*       ELSE                                                    01S0189 00391000
*         ;                         /* NOT 3330                      */ 00392000
@RF00182 DS    0H                                               01S0190 00393000
*       AP1ETABA=AP1ETABA+1;        /* POINT TO NEXT ERR TAB ENTRY   */ 00394000
@RC00182 LA    @10,1                                            01S0190 00395000
         AL    @10,AP1ETABA(,AP1REG)                            01S0190 00396000
         ST    @10,AP1ETABA(,AP1REG)                            01S0190 00397000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00398000
         B     CE0001@                                          01S0191 00399000
*     END RHAFH;                    /* END OF SUBCASE                */ 00400000
*                                                               01S0192 00401000
*     /***************************************************************/ 00402000
*     /*                                                             */ 00403000
*     /* RPS: RPS TEST                                               */ 00404000
*     /*                                                             */ 00405000
*     /***************************************************************/ 00406000
*                                                               01S0193 00407000
*RPS:                                                           01S0193 00408000
*     DO;                           /* SUBCASE CHKS RESPONSE TO RPS     00409000
*                                      CMDS                          */ 00410000
RPS      DS    0H                                               01S0194 00411000
*/*        CCW CHAIN:                                           01S0194 00412000
*                 READ SECTOR,BUFF,CC,1  READ RANDOM SECTOR     01S0194 00413000
*                 NO OP,0,CC,1           DISORIENT              01S0194 00414000
*                 SET SECTOR,BUFF,CC,1   TO SECTOR READ         01S0194 00415000
*                 NO OP,0,0,1            BRING IN CE-DE              */ 00416000
*                                                               01S0194 00417000
*       CCHH=0;                     /* CYL 0, HD 0                   */ 00418000
         SLR   @10,@10                                          01S0194 00419000
         ST    @10,CCHH(,AP1REG)                                01S0194 00420000
*       CCW(1)=RSCCCCW;             /* RS,0,CC,1                     */ 00421000
         L     @10,AP1CCWA(,AP1REG)                             01S0195 00422000
         MVC   CCW(8,@10),RSCCCCW                               01S0195 00423000
*       CCWADDRB(1)=AP1BUFAB;       /* INTO BUFFER                   */ 00424000
         MVC   CCWADDRB(3,@10),AP1BUFAB(AP1REG)                 01S0196 00425000
*       CCW(2)=NOPCCCCW;            /* NOP,0,CC,1                    */ 00426000
         MVC   CCW+8(8,@10),NOPCCCCW                            01S0197 00427000
*       CCW(3)=SSCCCCW;             /* SS,0,CC,1                     */ 00428000
         MVC   CCW+16(8,@10),SSCCCCW                            01S0198 00429000
*       CCWADDRB(3)=AP1BUFAB;       /* FROM BUFFER                   */ 00430000
         MVC   CCWADDRB+16(3,@10),AP1BUFAB(AP1REG)              01S0199 00431000
*       CCW(4)=NOPCCW;              /* NOP,0,0,1                     */ 00432000
         MVC   CCW+24(8,@10),NOPCCW                             01S0200 00433000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00434000
         B     CE0001@                                          01S0201 00435000
*     END RPS;                      /* END OF SUBCASE                */ 00436000
*                                                               01S0202 00437000
*     /***************************************************************/ 00438000
*     /*                                                             */ 00439000
*     /* SK192: 192 CYLINDER SEEKS                                   */ 00440000
*     /*                                                             */ 00441000
*     /***************************************************************/ 00442000
*                                                               01S0203 00443000
*SK192:                                                         01S0203 00444000
*     DO;                           /* SUBCASE 192 CYL SEEKS--SKIPPED   00445000
*                                      FOR 3344                      */ 00446000
SK192    DS    0H                                               01S0204 00447000
*/*       CCW CHAIN:                                            01S0204 00448000
*                ***********                    IOS SEEK TO CYL 0       00449000
*                SEEK,BUFF,CC,6                 TO PHYSICAL CYL 192     00450000
*                SEEK,AP1SEEK,CC,6              TO CYL 0        01S0204 00451000
*                SET SECT,BUFF,CC,1             SECTOR 0        01S0204 00452000
*                     REPEATED TO MAKE 99 CCWS                  01S0204 00453000
*                NOP,0,0,1            TO GET DEVICE END              */ 00454000
*                                                               01S0204 00455000
*       CCHH=0;                     /* CYL 0 HD 0                    */ 00456000
         SLR   @10,@10                                          01S0204 00457000
         ST    @10,CCHH(,AP1REG)                                01S0204 00458000
*       AP1FM=READFM;               /* READ ONLY--ALL SEEKS          */ 00459000
         MVC   AP1FM(1,AP1REG),READFM                           01S0205 00460000
*       AP1BUFAD->SEEK=ZERO7;       /* BB--HHR                       */ 00461000
         L     @10,AP1BUFAD(,AP1REG)                            01S0206 00462000
         MVC   SEEK(7,@10),ZERO7                                01S0206 00463000
*       IF AP1DEVTP=AP13350 THEN    /* 3350                          */ 00464000
         CLI   AP1DEVTP(AP1REG),4                               01S0207 00465000
         BNE   @RF00207                                         01S0207 00466000
*         AP1BUFAD->SEEKCC=REAL192; /* CYL 192                       */ 00467000
         MVC   SEEKCC(2,@10),@CB00248                           01S0208 00468000
*       ELSE                        /* 3330                          */ 00469000
*         AP1BUFAD->SEEKCC=EMU192;  /* PHYS CYL 192                  */ 00470000
         B     @RC00207                                         01S0209 00471000
@RF00207 L     @10,AP1BUFAD(,AP1REG)                            01S0209 00472000
         MVC   SEEKCC(2,@10),@CB00250                           01S0209 00473000
*       CCWPTR=AP1CCWA;             /* POINT TO FIRST SLOT           */ 00474000
@RC00207 L     CCWPTR,AP1CCWA(,AP1REG)                          01S0210 00475000
*       DO WHILE CCWPTR<AP1CCWA+(LENGTH(CCW)*99);/* BUILD 99 CCWS    */ 00476000
         B     @DE00211                                         01S0211 00477000
@DL00211 DS    0H                                               01S0212 00478000
*         CCWPTR->CCW(1)=SEEKCCW;   /* FULL SEEK,0,CC,6              */ 00479000
         MVC   CCW(8,CCWPTR),SEEKCCW                            01S0212 00480000
*         CCWPTR->CCWADDRB(1)=AP1BUFAB;/* PHYS CYL 192               */ 00481000
         MVC   CCWADDRB(3,CCWPTR),AP1BUFAB(AP1REG)              01S0213 00482000
*         CCWPTR=CCWPTR+LENGTH(CCW);/* NEXT SLOT                     */ 00483000
         LA    @10,8                                            01S0214 00484000
         ALR   CCWPTR,@10                                       01S0214 00485000
*         CCWPTR->CCW(1)=SEEKCCW;   /* FULL SEEK,0,CC,6              */ 00486000
         MVC   CCW(8,CCWPTR),SEEKCCW                            01S0215 00487000
*         CCWPTR->CCWADDRB(1)=ADDR(AP1SEEK);/* CYL 0                 */ 00488000
         LA    @09,AP1SEEK(,AP1REG)                             01S0216 00489000
         STCM  @09,7,CCWADDRB(CCWPTR)                           01S0216 00490000
*         CCWPTR=CCWPTR+LENGTH(CCW);/* NEXT SLOT                     */ 00491000
         ALR   CCWPTR,@10                                       01S0217 00492000
*         CCWPTR->CCW(1)=SSCCCCW;   /* SS,0,CC,1                     */ 00493000
         MVC   CCW(8,CCWPTR),SSCCCCW                            01S0218 00494000
*         CCWPTR->CCWADDRB(1)=AP1BUFAB;/* SECTOR ZERO                */ 00495000
         MVC   CCWADDRB(3,CCWPTR),AP1BUFAB(AP1REG)              01S0219 00496000
*         CCWPTR=CCWPTR+LENGTH(CCW);/* NEXT SLOT                     */ 00497000
         ALR   CCWPTR,@10                                       01S0220 00498000
*       END;                        /* OF DO WHILE                   */ 00499000
@DE00211 LA    @10,792                                          01S0221 00500000
         AL    @10,AP1CCWA(,AP1REG)                             01S0221 00501000
         CR    CCWPTR,@10                                       01S0221 00502000
         BL    @DL00211                                         01S0221 00503000
*       CCWPTR=CCWPTR-LENGTH(CCW);  /* LAST CCW                      */ 00504000
         SL    CCWPTR,@CF00047                                  01S0222 00505000
*       CCWPTR->CCW(1)=NOPCCW;      /* NOP,0,0,1                     */ 00506000
         MVC   CCW(8,CCWPTR),NOPCCW                             01S0223 00507000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00508000
         B     CE0001@                                          01S0224 00509000
*     END SK192;                    /* END OF SUBCASE                */ 00510000
*                                                               01S0225 00511000
*     /***************************************************************/ 00512000
*     /*                                                             */ 00513000
*     /* SKINCR: INCREMENTAL SEEKS                                   */ 00514000
*     /*                                                             */ 00515000
*     /***************************************************************/ 00516000
*                                                               01S0226 00517000
*SKINCR:                                                        01S0226 00518000
*     DO;                           /* SUBCASE INCREMENTAL SEEKS     */ 00519000
SKINCR   DS    0H                                               01S0227 00520000
*/*        CCW CHAIN:                                           01S0227 00521000
*                ************                 IOS SEEK TO CYL 0 01S0227 00522000
*                SEEK,BUFF,CC,6               SEEK CYL 11       01S0227 00523000
*                READ HA,0,SKIP-CC,5          VERIFY SEEK       01S0227 00524000
*                SEEK,BUFF+8,CC,6             SEEK NEXT PHYS CYL        00525000
*                READ HA,0,SKIP-CC,5          VERIFY SEEK       01S0227 00526000
*                      REPEAT ABOVE INCREMENTING BY 1 PHYS CYL FOR      00527000
*                         100 CCWS--LAST HAS CC OFF                  */ 00528000
*                                                               01S0227 00529000
*       CCHH=0;                     /* START CYL 0 HD 0              */ 00530000
         SLR   @10,@10                                          01S0227 00531000
         ST    @10,CCHH(,AP1REG)                                01S0227 00532000
*       AP1FM=READFM;               /* READ ONLY--ALL SEEKS          */ 00533000
         MVC   AP1FM(1,AP1REG),READFM                           01S0228 00534000
*       CCWPTR=AP1CCWA;             /* FIRST SLOT                    */ 00535000
         L     CCWPTR,AP1CCWA(,AP1REG)                          01S0229 00536000
*       BUFPTR=AP1BUFAD;            /* PUT SEEK ADDRESSES IN BUFFER  */ 00537000
         L     BUFPTR,AP1BUFAD(,AP1REG)                         01S0230 00538000
*       BUFPTR->SEEK=CYL11;         /* BBCCHHR FOR CYL 11            */ 00539000
         MVC   SEEK(7,BUFPTR),@CB00253                          01S0231 00540000
*       AP1PTRN2=OFF;               /* USED AS FLAG FOR DETERMINING     00541000
*                                      HOW MUCH TO INCREMENT 3330       00542000
*                                      SEEK                          */ 00543000
         NI    AP1PTRN2(AP1REG),B'01111111'                     01S0232 00544000
*       DO WHILE CCWPTR<AP1CCWA+(LENGTH(CCW)*100);/* BUILD 100 CCWS  */ 00545000
         B     @DE00233                                         01S0233 00546000
@DL00233 DS    0H                                               01S0234 00547000
*         CCWPTR->CCW(1)=SEEKCCW;   /* FULL SEEK,0,CC,6              */ 00548000
         MVC   CCW(8,CCWPTR),SEEKCCW                            01S0234 00549000
*         CCWPTR->CCWADDRB(1)=BUFPTR;/* SEEK ADDRESS--SET UP LAST       00550000
*                                      PASS                          */ 00551000
         STCM  BUFPTR,7,CCWADDRB(CCWPTR)                        01S0235 00552000
*         CCWPTR=CCWPTR+LENGTH(CCW);/* NEXT SLOT                     */ 00553000
         LA    @10,8                                            01S0236 00554000
         ALR   CCWPTR,@10                                       01S0236 00555000
*         CCWPTR->CCW(1)=RHACSCCW;  /* RHA,0,SKIP-CC,4               */ 00556000
         MVC   CCW(8,CCWPTR),RHACSCCW                           01S0237 00557000
*         CCWPTR=CCWPTR+LENGTH(CCW);/* NEXT SLOT                     */ 00558000
*                                                               01S0238 00559000
         ALR   CCWPTR,@10                                       01S0238 00560000
*         /***********************************************************/ 00561000
*         /*                                                         */ 00562000
*         /* SET UP SEEK ADDRESS FOR NEXT SEEK                       */ 00563000
*         /*                                                         */ 00564000
*         /***********************************************************/ 00565000
*                                                               01S0239 00566000
*         EVAL(BUFPTR+LENGTH(SEEK))->SEEK=ZERO7;/* BB--HHR           */ 00567000
         LA    @10,7                                            01S0239 00568000
         LR    @09,BUFPTR                                       01S0239 00569000
         ALR   @09,@10                                          01S0239 00570000
         MVC   SEEK(7,@09),ZERO7                                01S0239 00571000
*         EVAL(BUFPTR+LENGTH(SEEK))->SEEKCC=BUFPTR->SEEKCC+1;/* INCR    00572000
*                                      CYL BY ONE                    */ 00573000
         LR    @09,BUFPTR                                       01S0240 00574000
         ALR   @09,@10                                          01S0240 00575000
         LA    @15,1                                            01S0240 00576000
         SLR   @14,@14                                          01S0240 00577000
         ICM   @14,3,SEEKCC(BUFPTR)                             01S0240 00578000
         ALR   @15,@14                                          01S0240 00579000
         STCM  @15,3,SEEKCC(@09)                                01S0240 00580000
*         BUFPTR=BUFPTR+LENGTH(SEEK);/* POINT TO NEW SLOT            */ 00581000
         ALR   BUFPTR,@10                                       01S0241 00582000
*         IF AP1DEVTP=AP13344 THEN  /* 3344                          */ 00583000
         CLI   AP1DEVTP(AP1REG),3                               01S0242 00584000
         BNE   @RF00242                                         01S0242 00585000
*           BUFPTR->SEEKCC=BUFPTR->SEEKCC+4;/* INCR TOTAL OF 5  01S0243 00586000
*                                      LOGICAL CYL PER PHYSICAL 01S0243 00587000
*                                      CYLINDER                      */ 00588000
         LA    @10,4                                            01S0243 00589000
         SLR   @09,@09                                          01S0243 00590000
         ICM   @09,3,SEEKCC(BUFPTR)                             01S0243 00591000
         ALR   @10,@09                                          01S0243 00592000
         STCM  @10,3,SEEKCC(BUFPTR)                             01S0243 00593000
*         ELSE                      /* NOT 3344                      */ 00594000
*           IF AP1DEVTP<=AP13331 THEN/* 3330                         */ 00595000
         B     @RC00242                                         01S0244 00596000
@RF00242 CLI   AP1DEVTP(AP1REG),2                               01S0244 00597000
         BH    @RF00244                                         01S0244 00598000
*             IF AP1PTRN2=OFF THEN  /* INCR BY ONLY ONE CYL FOR NEXT    00599000
*                                      PHYSICAL CYLINDER             */ 00600000
         TM    AP1PTRN2(AP1REG),B'10000000'                     01S0245 00601000
         BNZ   @RF00245                                         01S0245 00602000
*               AP1PTRN2=ON;        /* BY 2 NEXT TIME                */ 00603000
         OI    AP1PTRN2(AP1REG),B'10000000'                     01S0246 00604000
*             ELSE                  /* INCR BY 2 CYL FOR NEXT PHYS   */ 00605000
*               DO;                                             01S0247 00606000
         B     @RC00245                                         01S0247 00607000
@RF00245 DS    0H                                               01S0248 00608000
*                 BUFPTR->SEEKCC=BUFPTR->SEEKCC+1;/* INCR BY TOTAL OF   00609000
*                                      2                             */ 00610000
         LA    @10,1                                            01S0248 00611000
         SLR   @09,@09                                          01S0248 00612000
         ICM   @09,3,SEEKCC(BUFPTR)                             01S0248 00613000
         ALR   @10,@09                                          01S0248 00614000
         STCM  @10,3,SEEKCC(BUFPTR)                             01S0248 00615000
*                 AP1PTRN2=OFF;     /* BY 1 NEXT TIME                */ 00616000
         NI    AP1PTRN2(AP1REG),B'01111111'                     01S0249 00617000
*               END;                                            01S0250 00618000
*           ELSE                                                01S0251 00619000
*             ;                     /* NOT 3330                      */ 00620000
@RF00244 DS    0H                                               01S0252 00621000
*       END;                        /* OF DO WHILE                   */ 00622000
@RC00244 DS    0H                                               01S0252 00623000
@RC00242 DS    0H                                               01S0252 00624000
@DE00233 LA    @10,800                                          01S0252 00625000
         AL    @10,AP1CCWA(,AP1REG)                             01S0252 00626000
         CR    CCWPTR,@10                                       01S0252 00627000
         BL    @DL00233                                         01S0252 00628000
*       CCWPTR=CCWPTR-LENGTH(CCW);  /* LAST CCW                      */ 00629000
         SL    CCWPTR,@CF00047                                  01S0253 00630000
*       CCWPTR->CCWCC(1)=OFF;       /* BREAK CHAIN                   */ 00631000
         NI    CCWCC(CCWPTR),B'10111111'                        01S0254 00632000
*       AP1PTRN2=OFF;               /* RESET FOR NEXT TEST           */ 00633000
         NI    AP1PTRN2(AP1REG),B'01111111'                     01S0255 00634000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00635000
         B     CE0001@                                          01S0256 00636000
*     END SKINCR;                   /* END OF SUBCASE                */ 00637000
*                                                               01S0257 00638000
*     /***************************************************************/ 00639000
*     /*                                                             */ 00640000
*     /* SKMAX: MAXIMUM SEEKS                                        */ 00641000
*     /*                                                             */ 00642000
*     /***************************************************************/ 00643000
*                                                               01S0258 00644000
*SKMAX:                                                         01S0258 00645000
*     DO;                           /* SUBCASE MAXIMUM SEEKS         */ 00646000
SKMAX    DS    0H                                               01S0259 00647000
*/*      CCW CHAIN:                                             01S0259 00648000
*                ************            IOS SEEK TO CYL 0      01S0259 00649000
*                SEEK,BUFF,CC,6          SEEK TO HI CYL         01S0259 00650000
*                RD HA,0,SKIP-CC,5       VERIFY SEEK            01S0259 00651000
*                SEEK,AP1SEEK,CC,6       SEEK TO CYL 0          01S0259 00652000
*                RD HA,0,SKIP-CC,5       VERIFY SEEK            01S0259 00653000
*                     REPEAT ABOVE 4 CCWS FOR A TOTAL OF 100--  01S0259 00654000
*                          TURN CHAIN CMD OFF IN LAST                */ 00655000
*                                                               01S0259 00656000
*       CCHH=0;                     /* CYL 0 HD 0                    */ 00657000
         SLR   @10,@10                                          01S0259 00658000
         ST    @10,CCHH(,AP1REG)                                01S0259 00659000
*       AP1FM=READFM;               /* READ ONLY -- ALL SEEKS        */ 00660000
         MVC   AP1FM(1,AP1REG),READFM                           01S0260 00661000
*       AP1BUFAD->SEEK=ZERO7;       /* BBCCHHR                       */ 00662000
         L     @09,AP1BUFAD(,AP1REG)                            01S0261 00663000
         MVC   SEEK(7,@09),ZERO7                                01S0261 00664000
*       AP1BUFAD->SEEKCC=AP1LSTCC;  /* CC OF LAST CYL ON VOLUME      */ 00665000
         MVC   SEEKCC(2,@09),AP1LSTCC(AP1REG)                   01S0262 00666000
*       AP1BUFAD->SEEKHH=0;         /* HH = 0                        */ 00667000
         STCM  @10,3,SEEKHH(@09)                                01S0263 00668000
*       CCWPTR=AP1CCWA;             /* FIRST CCW SLOT                */ 00669000
         L     CCWPTR,AP1CCWA(,AP1REG)                          01S0264 00670000
*       DO WHILE CCWPTR<AP1CCWA+(LENGTH(CCW)*100);/* 100 CCWS        */ 00671000
         B     @DE00265                                         01S0265 00672000
@DL00265 DS    0H                                               01S0266 00673000
*         CCWPTR->CCW(1)=SEEKCCW;   /* SEEK,0,CC,6                   */ 00674000
         MVC   CCW(8,CCWPTR),SEEKCCW                            01S0266 00675000
*         CCWPTR->CCWADDRB(1)=AP1BUFAB;/* HI CYL                     */ 00676000
         MVC   CCWADDRB(3,CCWPTR),AP1BUFAB(AP1REG)              01S0267 00677000
*         CCWPTR=CCWPTR+LENGTH(CCW);/* NEXT SLOT                     */ 00678000
         LA    @10,8                                            01S0268 00679000
         ALR   CCWPTR,@10                                       01S0268 00680000
*         CCWPTR->CCW(1)=RHACSCCW;  /* RD HA,0,SKIP-CC,5             */ 00681000
         MVC   CCW(8,CCWPTR),RHACSCCW                           01S0269 00682000
*         CCWPTR=CCWPTR+LENGTH(CCW);/* NEXT SLOT                     */ 00683000
         ALR   CCWPTR,@10                                       01S0270 00684000
*         CCWPTR->CCW(1)=SEEKCCW;   /* SEEK,0,CC,6                   */ 00685000
         MVC   CCW(8,CCWPTR),SEEKCCW                            01S0271 00686000
*         CCWPTR->CCWADDRB(1)=ADDR(AP1SEEK);/* CYL 0                 */ 00687000
         LA    @09,AP1SEEK(,AP1REG)                             01S0272 00688000
         STCM  @09,7,CCWADDRB(CCWPTR)                           01S0272 00689000
*         CCWPTR=CCWPTR+LENGTH(CCW);/* NEXT SLOT                     */ 00690000
         ALR   CCWPTR,@10                                       01S0273 00691000
*         CCWPTR->CCW(1)=RHACSCCW;  /* RD HA,0,SKIP-CC,5             */ 00692000
         MVC   CCW(8,CCWPTR),RHACSCCW                           01S0274 00693000
*         CCWPTR=CCWPTR+LENGTH(CCW);/* NEXT SLOT                     */ 00694000
         ALR   CCWPTR,@10                                       01S0275 00695000
*       END;                        /* OF DO WHILE                   */ 00696000
@DE00265 LA    @10,800                                          01S0276 00697000
         AL    @10,AP1CCWA(,AP1REG)                             01S0276 00698000
         CR    CCWPTR,@10                                       01S0276 00699000
         BL    @DL00265                                         01S0276 00700000
*       EVAL(CCWPTR-LENGTH(CCW))->CCWCC(1)=OFF;/* TURN OFF CC IN LAST   00701000
*                                      CCW                           */ 00702000
         LR    @10,CCWPTR                                       01S0277 00703000
         SL    @10,@CF00047                                     01S0277 00704000
         NI    CCWCC(@10),B'10111111'                           01S0277 00705000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00706000
         B     CE0001@                                          01S0278 00707000
*     END SKMAX;                    /* END OF SUBCASE                */ 00708000
*                                                               01S0279 00709000
*     /***************************************************************/ 00710000
*     /*                                                             */ 00711000
*     /* SKRANS: RANDOM SEEKS                                        */ 00712000
*     /*                                                             */ 00713000
*     /***************************************************************/ 00714000
*                                                               01S0280 00715000
*SKRANS:                                                        01S0280 00716000
*     DO;                           /* SUBCASE SETUP FOR RANDOM 01S0280 00717000
*                                      SEEKS--SETS UP FIRST CYL AND     00718000
*                                      SUBCASE SKRAN UPDATES CYL ADDR*/ 00719000
SKRANS   DS    0H                                               01S0281 00720000
*/*         CCW CHAIN:                                          01S0281 00721000
*                ***************       SEEK BY IOS              01S0281 00722000
*                READ HA,0,SKIP,5      VERIFY SEEK                   */ 00723000
*                                                               01S0281 00724000
*       CCHH=0;                     /* SEEK TO CYL 0 HD 0 FIRST      */ 00725000
         SLR   @10,@10                                          01S0281 00726000
         ST    @10,CCHH(,AP1REG)                                01S0281 00727000
*       AP1FM=READFM;               /* READ ONLY -- ALL SEEKS        */ 00728000
         MVC   AP1FM(1,AP1REG),READFM                           01S0282 00729000
*       CCW(1)=RHASKCCW;            /* RHA,0,SKIP,5                  */ 00730000
         L     @10,AP1CCWA(,AP1REG)                             01S0283 00731000
         MVC   CCW(8,@10),RHASKCCW                              01S0283 00732000
*       AP1TSTNO=AP1TSTNO+1;        /* USE CHK SUBCASE SKRAN         */ 00733000
         LA    @10,1                                            01S0284 00734000
         SLR   @09,@09                                          01S0284 00735000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0284 00736000
         ALR   @10,@09                                          01S0284 00737000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0284 00738000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00739000
         B     CE0001@                                          01S0285 00740000
*     END SKRANS;                   /* END OF SUBCASE                */ 00741000
*                                                               01S0286 00742000
*     /***************************************************************/ 00743000
*     /*                                                             */ 00744000
*     /* SKRAN: RANDOM SEEKS                                         */ 00745000
*     /*                                                             */ 00746000
*     /***************************************************************/ 00747000
*                                                               01S0287 00748000
*SKRAN:                                                         01S0287 00749000
*     DO;                           /* SUBCASE RANDOM SEEK      01S0287 00750000
*                                      GENERATOR--USES CCW CHAIN SET    00751000
*                                      UP BY SKRANS                  */ 00752000
SKRAN    DS    0H                                               01S0288 00753000
*       AP1SKCNT=AP1SKCNT+1;        /* INCREMENT COUNT OF PASSES     */ 00754000
         LA    @10,1                                            01S0288 00755000
         LH    @09,AP1SKCNT(,AP1REG)                            01S0288 00756000
         ALR   @09,@10                                          01S0288 00757000
         STH   @09,AP1SKCNT(,AP1REG)                            01S0288 00758000
*       CC=RANTBL(AP1SKCNT)//AP1LSTCC+1;/* RANDOM NUMBER LESS THAN OR   00759000
*                                      EQUAL TO END CYL              */ 00760000
         ALR   @09,@09                                          01S0289 00761000
         LH    @00,RANTBL-2(@09)                                01S0289 00762000
         SRDA  @00,32                                           01S0289 00763000
         LH    @09,AP1LSTCC(,AP1REG)                            01S0289 00764000
         DR    @00,@09                                          01S0289 00765000
         ALR   @00,@10                                          01S0289 00766000
         STH   @00,CC(,AP1REG)                                  01S0289 00767000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00768000
         B     CE0001@                                          01S0290 00769000
*     END SKRAN;                    /* END OF SUBCASE                */ 00770000
*                                                               01S0291 00771000
*     /***************************************************************/ 00772000
*     /*                                                             */ 00773000
*     /* RHAS: VERIFY HOME ADDRESS ON CE CYLINDER                    */ 00774000
*     /*                                                             */ 00775000
*     /***************************************************************/ 00776000
*                                                               01S0292 00777000
*RHAS:                                                          01S0292 00778000
*     DO;                           /* SUBCASE READ HA ON CE CYL HD     00779000
*                                      0--SUBCASE 'CE' WILL INCREMENT   00780000
*                                      TO NEXT TRACKS                */ 00781000
RHAS     DS    0H                                               01S0293 00782000
*/*         CCW CHAIN:                                          01S0293 00783000
*                SEEK,AP1CESK,CC,6          SEEK TO CE CYL      01S0293 00784000
*                READ HA,BUFFER,0,5         READ FOR COMPARE         */ 00785000
*/*  SETS CECCHH TO CE CYL TRK 0                                     */ 00786000
*                                                               01S0293 00787000
*       IF AP1DEVTP=AP13344 THEN    /* 3344                          */ 00788000
         CLI   AP1DEVTP(AP1REG),3                               01S0293 00789000
         BNE   @RF00293                                         01S0293 00790000
*         CECCHH=I3344CE0;          /* CYL 2800 HD 0                 */ 00791000
         MVC   CECCHH(4,AP1REG),@CB00205                        01S0294 00792000
*       ELSE                        /* NOT 3344                      */ 00793000
*         CECCHH=I3350CE0;          /* CYL 1024 HD 0                 */ 00794000
         B     @RC00293                                         01S0295 00795000
@RF00293 MVC   CECCHH(4,AP1REG),@CB00209                        01S0295 00796000
*       AP1FM=CEREADFM;             /* READ ONLY--CE CYL             */ 00797000
*                                                               01S0296 00798000
@RC00293 MVC   AP1FM(1,AP1REG),CEREADFM                         01S0296 00799000
*       /*************************************************************/ 00800000
*       /*                                                           */ 00801000
*       /* SETUP FOR IOBSEEK WHICH MUST BE IN USER AREA OF PACK      */ 00802000
*       /*                                                           */ 00803000
*       /*************************************************************/ 00804000
*                                                               01S0297 00805000
*       HH='0000'X;                 /* HEAD 0                        */ 00806000
         MVC   HH(2,AP1REG),@CB00571                            01S0297 00807000
*       IF AP1FHF=ON THEN           /* FIXED HEAD ON THIS PACK       */ 00808000
         TM    AP1FHF(AP1REG),B'00010000'                       01S0298 00809000
         BNO   @RF00298                                         01S0298 00810000
*         CC='0001'X;               /* SEEK WILL INVOLVE NO ARM 01S0299 00811000
*                                      MOVEMENT                      */ 00812000
         MVC   CC(2,AP1REG),@CB00557                            01S0299 00813000
*       ELSE                        /* NO FIXED HEADS                */ 00814000
*         CC=AP1LSTCC;              /* CYL CLOSEST TO CE CYL         */ 00815000
*                                                               01S0300 00816000
         B     @RC00298                                         01S0300 00817000
@RF00298 LH    @10,AP1LSTCC(,AP1REG)                            01S0300 00818000
         STH   @10,CC(,AP1REG)                                  01S0300 00819000
*       /*************************************************************/ 00820000
*       /*                                                           */ 00821000
*       /* SETUP CCWS                                                */ 00822000
*       /*                                                           */ 00823000
*       /*************************************************************/ 00824000
*                                                               01S0301 00825000
*       CCW(1)=SEEKCCW;             /* FULL SEEK, 0, CC, 6           */ 00826000
@RC00298 L     @10,AP1CCWA(,AP1REG)                             01S0301 00827000
         MVC   CCW(8,@10),SEEKCCW                               01S0301 00828000
*       CCWADDRB(1)=ADDR(AP1CESK);  /* POINT TO CE SEEK ADDRESS      */ 00829000
         LA    @09,AP1CESK(,AP1REG)                             01S0302 00830000
         STCM  @09,7,CCWADDRB(@10)                              01S0302 00831000
*       CCW(2)=RHACCW;              /* RHA,0,0,5                     */ 00832000
         MVC   CCW+8(8,@10),RHACCW                              01S0303 00833000
*       CCWADDRB(2)=AP1BUFAD;       /* READ INTO BUFFER              */ 00834000
         MVC   CCWADDRB+8(3,@10),AP1BUFAD+1(AP1REG)             01S0304 00835000
*       AP1ETABA=ADDR(AP1ERRTM);    /* POINT TO MOVEABLE HD TABLE, HD   00836000
*                                      0                             */ 00837000
         LA    @10,AP1ERRTM(,AP1REG)                            01S0305 00838000
         ST    @10,AP1ETABA(,AP1REG)                            01S0305 00839000
*       AP1TSTNO=AP1TSTNO+1;        /* USE CHK SUBCASE RHA           */ 00840000
         LA    @10,1                                            01S0306 00841000
         SLR   @09,@09                                          01S0306 00842000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0306 00843000
         ALR   @10,@09                                          01S0306 00844000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0306 00845000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00846000
         B     CE0001@                                          01S0307 00847000
*     END RHAS;                     /* END OF SUBCASE                */ 00848000
*                                                               01S0308 00849000
*     /***************************************************************/ 00850000
*     /*                                                             */ 00851000
*     /* CE: UPDATE SEEK TO NEXT HEAD ON CE CYLINDER                 */ 00852000
*     /*                                                             */ 00853000
*     /***************************************************************/ 00854000
*                                                               01S0309 00855000
*CE:                                                            01S0309 00856000
*     DO;                           /* SUBCASE INCREMENTS TO NEXT       00857000
*                                      HEAD ON CE CYL--USES CCW 01S0309 00858000
*                                      CHAINS BUILT BY RHAS, WRTS, OR   00859000
*                                      RR01S                         */ 00860000
CE       DS    0H                                               01S0310 00861000
*       AP1ETABA=AP1ETABA+1;        /* TO NEXT ENTRY IN HEAD TABLE   */ 00862000
         LA    @10,1                                            01S0310 00863000
         L     @09,AP1ETABA(,AP1REG)                            01S0310 00864000
         ALR   @09,@10                                          01S0310 00865000
         ST    @09,AP1ETABA(,AP1REG)                            01S0310 00866000
*       CEHH=CEHH+1;                /* GO TO NEXT HEAD               */ 00867000
         SLR   @15,@15                                          01S0311 00868000
         ICM   @15,3,CEHH(AP1REG)                               01S0311 00869000
         ALR   @15,@10                                          01S0311 00870000
         STCM  @15,3,CEHH(AP1REG)                               01S0311 00871000
*       IF AP1DEVTP<=AP13331&CEHH=HI3330HD+1 THEN/* 3330 AND AT HEAD    00872000
*                                      19                            */ 00873000
         CLI   AP1DEVTP(AP1REG),2                               01S0312 00874000
         BH    @RF00312                                         01S0312 00875000
         C     @15,@CF00589                                     01S0312 00876000
         BNE   @RF00312                                         01S0312 00877000
*         DO;                                                   01S0313 00878000
*           CEHH=CEHH+1;            /* SKIP HEAD 19                  */ 00879000
         ALR   @15,@10                                          01S0314 00880000
         STCM  @15,3,CEHH(AP1REG)                               01S0314 00881000
*           AP1ETABA=AP1ETABA+1;    /* SKIP TABLE ENTRY FOR HD 19    */ 00882000
         ALR   @09,@10                                          01S0315 00883000
         ST    @09,AP1ETABA(,AP1REG)                            01S0315 00884000
*         END;                                                  01S0316 00885000
*       ELSE                                                    01S0317 00886000
*         ;                         /* NOT 3330 HEAD 19              */ 00887000
@RF00312 DS    0H                                               01S0318 00888000
*       IF AP1DEVTP=AP13344 THEN    /* 3344                          */ 00889000
         CLI   AP1DEVTP(AP1REG),3                               01S0318 00890000
         BNE   @RF00318                                         01S0318 00891000
*         DO;                                                   01S0319 00892000
*           CEHH=CEHH+1;            /* MAKE INCR TWO HEADS--ONE PHS     00893000
*                                      HD                            */ 00894000
         LA    @10,1                                            01S0320 00895000
         SLR   @09,@09                                          01S0320 00896000
         ICM   @09,3,CEHH(AP1REG)                               01S0320 00897000
         ALR   @10,@09                                          01S0320 00898000
         STCM  @10,3,CEHH(AP1REG)                               01S0320 00899000
*           IF CEHH>HI3344HD THEN   /* OVER HEAD 11                  */ 00900000
         CLC   CEHH(2,AP1REG),@CB00235                          01S0321 00901000
         BNH   @RF00321                                         01S0321 00902000
*             IF CECC=HI3344CC THEN /* LAST CE CYL                   */ 00903000
         CLC   CECC(2,AP1REG),@CB00213                          01S0322 00904000
         BNE   @RF00322                                         01S0322 00905000
*               DO;                                             01S0323 00906000
*                 CECCHH='0AF00001'X;/* GO TO CE CYL 0 HD 1 TO CHECK    00907000
*                                      ODD HEADS--THESE PHYSICAL        00908000
*                                      HEADS WERE CHECKED BEFORE     */ 00909000
         MVC   CECCHH(4,AP1REG),@CB00207                        01S0324 00910000
*                 AP1ETABA=ADDR(AP1ERRTM);/* POINT TO PHYS HD 0 IN      00911000
*                                      MATRIX                        */ 00912000
         LA    @10,AP1ERRTM(,AP1REG)                            01S0325 00913000
         ST    @10,AP1ETABA(,AP1REG)                            01S0325 00914000
*               END;                                            01S0326 00915000
*             ELSE                  /* LAST TRK BUT NOT LAST CYL     */ 00916000
*               DO;                                             01S0327 00917000
         B     @RC00322                                         01S0327 00918000
@RF00322 DS    0H                                               01S0328 00919000
*                 CECC=CECC+1;      /* INCR TO NEXT CYL              */ 00920000
         LA    @10,1                                            01S0328 00921000
         SLR   @09,@09                                          01S0328 00922000
         ICM   @09,3,CECC(AP1REG)                               01S0328 00923000
         ALR   @10,@09                                          01S0328 00924000
         STCM  @10,3,CECC(AP1REG)                               01S0328 00925000
*                 CEHH=0;           /* FIRST HEAD                    */ 00926000
         SLR   @10,@10                                          01S0329 00927000
         STCM  @10,3,CEHH(AP1REG)                               01S0329 00928000
*               END;                                            01S0330 00929000
*           ELSE                                                01S0331 00930000
*             ;                     /* NOT HEAD 11                   */ 00931000
@RF00321 DS    0H                                               01S0332 00932000
*         END;                                                  01S0332 00933000
*       ELSE                                                    01S0333 00934000
*         ;                         /* NOT 3344                      */ 00935000
*                                                               01S0333 00936000
@RF00318 DS    0H                                               01S0334 00937000
*       /*************************************************************/ 00938000
*       /*                                                           */ 00939000
*       /* MOVE CCHH TO BUFFER FOR WRITE                             */ 00940000
*       /*                                                           */ 00941000
*       /*************************************************************/ 00942000
*                                                               01S0334 00943000
*       IF CCWCOMCD(2)=SHA THEN     /* WRITE TEST                    */ 00944000
@RC00318 L     @10,AP1CCWA(,AP1REG)                             01S0334 00945000
         CLI   CCWCOMCD+8(@10),57                               01S0334 00946000
         BNE   @RF00334                                         01S0334 00947000
*         DO;                                                   01S0335 00948000
*           AP1BUFAD->CNTCCHH=CECCHH;/* CCHH FOR R0                  */ 00949000
         L     @10,AP1BUFAD(,AP1REG)                            01S0336 00950000
         MVC   CNTCCHH(4,@10),CECCHH(AP1REG)                    01S0336 00951000
*           EVAL(AP1BUFAD+2*LENGTH(CNT))->CNTCCHH=CECCHH;/* CCHH FOR    00952000
*                                      R1                            */ 00953000
         AL    @10,@CF00167                                     01S0337 00954000
         MVC   CNTCCHH(4,@10),CECCHH(AP1REG)                    01S0337 00955000
*         END;                                                  01S0338 00956000
*       ELSE                                                    01S0339 00957000
*         ;                         /* NOT WRITE TEST                */ 00958000
@RF00334 DS    0H                                               01S0340 00959000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00960000
         B     CE0001@                                          01S0340 00961000
*     END CE;                       /* END OF SUBCASE                */ 00962000
*                                                               01S0341 00963000
*     /***************************************************************/ 00964000
*     /*                                                             */ 00965000
*     /* WRTS: WRITE ON CE CYLINDER                                  */ 00966000
*     /*                                                             */ 00967000
*     /***************************************************************/ 00968000
*                                                               01S0342 00969000
*WRTS:                                                          01S0342 00970000
*     DO;                           /* SUBCASE WRITE R0-R1 ON CE CYL    00971000
*                                      HD 0 --SUBCASE CE WILL ALTER     00972000
*                                      SEEK TO GO TO TRKS 1-29       */ 00973000
WRTS     DS    0H                                               01S0343 00974000
*/*         CCW CHAIN:                                          01S0343 00975000
*                SEEK,AP1CESK,CC,6          SEEK TO CE CYL      01S0343 00976000
*                SRCH HA,AP1CESK+2,CC,4     VALIDATE ON CORRECT TRK     00977000
*                TIC,*-8                                        01S0343 00978000
*                WRT R0,BUFF,CC,16          WRITE R0            01S0343 00979000
*                WCKD,BUFF+16,0,264         WRITE R1                 */ 00980000
*/*  SETS CECCHH TO CE CYL TRK 0                                     */ 00981000
*                                                               01S0343 00982000
*       IF AP1DEVTP=AP13344 THEN    /* 3344                          */ 00983000
         CLI   AP1DEVTP(AP1REG),3                               01S0343 00984000
         BNE   @RF00343                                         01S0343 00985000
*         CECCHH=I3344CE0;          /* CYL 2800 HD 0                 */ 00986000
         MVC   CECCHH(4,AP1REG),@CB00205                        01S0344 00987000
*       ELSE                        /* NOT 3344                      */ 00988000
*         CECCHH=I3350CE0;          /* CYL 1024 HD 0                 */ 00989000
         B     @RC00343                                         01S0345 00990000
@RF00343 MVC   CECCHH(4,AP1REG),@CB00209                        01S0345 00991000
*       AP1FM=CEHAR0FM;             /* ALL WRITES--CE CYL            */ 00992000
*                                                               01S0346 00993000
@RC00343 MVC   AP1FM(1,AP1REG),CEHAR0FM                         01S0346 00994000
*       /*************************************************************/ 00995000
*       /*                                                           */ 00996000
*       /* AP1SEEK AND A SEEK CCW TO CE CYL SETUP FROM PREVIOUS TEST */ 00997000
*       /*                                                           */ 00998000
*       /*************************************************************/ 00999000
*                                                               01S0347 01000000
*       CCW(2)=SHACCCCW;            /* SEARCH HA EQ,0,CC,4           */ 01001000
         L     @10,AP1CCWA(,AP1REG)                             01S0347 01002000
         MVC   CCW+8(8,@10),SHACCCCW                            01S0347 01003000
*       CCWADDRB(2)=ADDR(CECCHH);   /* ADDRESS OF TRACK              */ 01004000
         LA    @09,CECCHH(,AP1REG)                              01S0348 01005000
         STCM  @09,7,CCWADDRB+8(@10)                            01S0348 01006000
*       CCW(3)=TICCCW;              /* TIC,0,0,0                     */ 01007000
         MVC   CCW+16(8,@10),TICCCW                             01S0349 01008000
*       CCWADDRB(3)=AP1CCWAB+LENGTH(CCW);/* TIC TO SEARCH            */ 01009000
         LA    @09,8                                            01S0350 01010000
         L     @15,AP1CCWAB-1(,AP1REG)                          01S0350 01011000
         LA    @15,0(,@15)                                      01S0350 01012000
         ALR   @15,@09                                          01S0350 01013000
         STCM  @15,7,CCWADDRB+16(@10)                           01S0350 01014000
*       CCW(4)=WR0CCCCW;            /* WRT R0,0,CC,16                */ 01015000
         MVC   CCW+24(8,@10),WR0CCCCW                           01S0351 01016000
*       CCWADDRB(4)=AP1BUFAB;       /* WRITE FROM BUFFER             */ 01017000
         L     @15,AP1BUFAB-1(,AP1REG)                          01S0352 01018000
         LA    @15,0(,@15)                                      01S0352 01019000
         STCM  @15,7,CCWADDRB+24(@10)                           01S0352 01020000
*       CCW(5)=WCDCCW;              /* WCKD,0,0,264                  */ 01021000
         MVC   CCW+32(8,@10),WCDCCW                             01S0353 01022000
*       CCWADDRB(5)=AP1BUFAB+2*LENGTH(CNT);/* WRITE FROM BUFFER      */ 01023000
*                                                               01S0354 01024000
         LA    @14,16                                           01S0354 01025000
         ALR   @15,@14                                          01S0354 01026000
         STCM  @15,7,CCWADDRB+32(@10)                           01S0354 01027000
*       /*************************************************************/ 01028000
*       /*                                                           */ 01029000
*       /* BUILD COUNT AND DATA FOR R0                               */ 01030000
*       /*                                                           */ 01031000
*       /*************************************************************/ 01032000
*                                                               01S0355 01033000
*       AP1BUFAD->CNTCCHHR=CECCHHR; /* CCHHR                         */ 01034000
         L     @10,AP1BUFAD(,AP1REG)                            01S0355 01035000
         MVC   CNTCCHHR(5,@10),CECCHHR(AP1REG)                  01S0355 01036000
*       AP1BUFAD->CNTKDD=DL8;       /* KDD                           */ 01037000
         MVC   CNTKDD(3,@10),@CB00217                           01S0356 01038000
*       EVAL(AP1BUFAD+LENGTH(CNT))->BYTE8=R0DATA;/* DATA FOR R0      */ 01039000
*                                                               01S0357 01040000
         ALR   @09,@10                                          01S0357 01041000
         MVC   BYTE8(8,@09),R0DATA                              01S0357 01042000
*       /*************************************************************/ 01043000
*       /*                                                           */ 01044000
*       /* BUILD COUNT AND DATA FOR R1                               */ 01045000
*       /*                                                           */ 01046000
*       /*************************************************************/ 01047000
*                                                               01S0358 01048000
*       EVAL(AP1BUFAD+2*LENGTH(CNT))->CNTCCHH=CECCHH;/* CCHH         */ 01049000
         LR    @09,@10                                          01S0358 01050000
         ALR   @09,@14                                          01S0358 01051000
         MVC   CNTCCHH(4,@09),CECCHH(AP1REG)                    01S0358 01052000
*       EVAL(AP1BUFAD+2*LENGTH(CNT))->CNTRKDD=R1DL256;/* RKDD        */ 01053000
         ALR   @14,@10                                          01S0359 01054000
         MVC   CNTRKDD(4,@14),@CB00227                          01S0359 01055000
*       IF AP1PTRN2=OFF THEN        /* WRITE PATTERN ONE             */ 01056000
         TM    AP1PTRN2(AP1REG),B'10000000'                     01S0360 01057000
         BNZ   @RF00360                                         01S0360 01058000
*         EVAL(AP1BUFAD+3*LENGTH(CNT))->BYTE256=R1DATA1;/* DATA1 FOR    01059000
*                                      R1                            */ 01060000
         AL    @10,@CF00064                                     01S0361 01061000
         MVC   BYTE256(256,@10),R1DATA1                         01S0361 01062000
*       ELSE                        /* WRITE PATTERN TWO             */ 01063000
*         EVAL(AP1BUFAD+3*LENGTH(CNT))->BYTE256=R1DATA2;/* DATA2 FOR    01064000
*                                      R1                            */ 01065000
         B     @RC00360                                         01S0362 01066000
@RF00360 LA    @10,24                                           01S0362 01067000
         AL    @10,AP1BUFAD(,AP1REG)                            01S0362 01068000
         MVC   BYTE256(256,@10),R1DATA2                         01S0362 01069000
*       AP1ETABA=ADDR(AP1ERRTM);    /* POINT TO HD0 OF MOVEABLE HD      01070000
*                                      TABLE                         */ 01071000
@RC00360 LA    @10,AP1ERRTM(,AP1REG)                            01S0363 01072000
         ST    @10,AP1ETABA(,AP1REG)                            01S0363 01073000
*       AP1TSTNO=AP1TSTNO+1;        /* USE CHK SUBCASE WRT           */ 01074000
         LA    @10,1                                            01S0364 01075000
         SLR   @09,@09                                          01S0364 01076000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0364 01077000
         ALR   @10,@09                                          01S0364 01078000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0364 01079000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01080000
         B     CE0001@                                          01S0365 01081000
*     END WRTS;                     /* END OF SUBCASE                */ 01082000
*                                                               01S0366 01083000
*     /***************************************************************/ 01084000
*     /*                                                             */ 01085000
*     /* RR01S: READ CE CYLINDER                                     */ 01086000
*     /*                                                             */ 01087000
*     /***************************************************************/ 01088000
*                                                               01S0367 01089000
*RR01S:                                                         01S0367 01090000
*     DO;                           /* SUBCASE READ R0 AND R1 ON CE     01091000
*                                      CYL HD 0 --SUBCASE CE ALTERS     01092000
*                                      SEEK FOR HDS 1-29             */ 01093000
RR01S    DS    0H                                               01S0368 01094000
*/*          CCW CHAIN:                                         01S0368 01095000
*                SEEK,AP1CESK,CC,6          SEEK TO CE CYL      01S0368 01096000
*                READ HA,0,CC-SKIP,4        VALIDATE SEEK       01S0368 01097000
*                READ R0,0,CC-SKIP,16                           01S0368 01098000
*                RD CKD,0,CC-SKIP,264                           01S0368 01099000
*                        REPEAT ABOVE READS 13 TIMES            01S0368 01100000
*                READ HA,0,CC-SKIP,4                            01S0368 01101000
*                READ R0,BUFF,CC,16         READ FOR COUNT COMPARE      01102000
*                RD CKD,BUFF+8,0,264        READ FOR COUNT AND  01S0368 01103000
*                                           FIRST 8 BYTES OF DATA       01104000
*                                           TO COMPARE               */ 01105000
*/*  SETS CECCHH TO CE CYL TRK 0                                     */ 01106000
*                                                               01S0368 01107000
*       IF AP1DEVTP=AP13344 THEN    /* 3344                          */ 01108000
         CLI   AP1DEVTP(AP1REG),3                               01S0368 01109000
         BNE   @RF00368                                         01S0368 01110000
*         CECCHH=I3344CE0;          /* CYL 2800 HD 0                 */ 01111000
         MVC   CECCHH(4,AP1REG),@CB00205                        01S0369 01112000
*       ELSE                        /* NOT 3344                      */ 01113000
*         CECCHH=I3350CE0;          /* CYL 1024 HD 0                 */ 01114000
         B     @RC00368                                         01S0370 01115000
@RF00368 MVC   CECCHH(4,AP1REG),@CB00209                        01S0370 01116000
*       AP1FM=CEREADFM;             /* READ ONLY--CE CYL             */ 01117000
*                                                               01S0371 01118000
@RC00368 MVC   AP1FM(1,AP1REG),CEREADFM                         01S0371 01119000
*       /*************************************************************/ 01120000
*       /*                                                           */ 01121000
*       /* USE AP1SEEK AND SEEK CCW SETUP BY RHAS SUBCASE            */ 01122000
*       /*                                                           */ 01123000
*       /*************************************************************/ 01124000
*                                                               01S0372 01125000
*       CCWPTR=AP1CCWA+LENGTH(CCW); /* POINT TO 1ST SLOT AFTER SEEK  */ 01126000
         LA    CCWPTR,8                                         01S0372 01127000
         AL    CCWPTR,AP1CCWA(,AP1REG)                          01S0372 01128000
*       DO COUNTER=1 TO 15;         /* BLD 15 CHAINS                 */ 01129000
         LA    COUNTER,1                                        01S0373 01130000
@DL00373 DS    0H                                               01S0374 01131000
*         CCWPTR->CCW(1)=RHACSCCW;  /* RHA,0,CC-SKIP,4               */ 01132000
         MVC   CCW(8,CCWPTR),RHACSCCW                           01S0374 01133000
*         CCWPTR=CCWPTR+LENGTH(CCW);/* POINT TO NEXT SLOT            */ 01134000
         LA    @10,8                                            01S0375 01135000
         ALR   CCWPTR,@10                                       01S0375 01136000
*         CCWPTR->CCW(1)=RR0CSCCW;  /* RR0,0,CC-SKIP,16              */ 01137000
         MVC   CCW(8,CCWPTR),RR0CSCCW                           01S0376 01138000
*         CCWPTR=CCWPTR+LENGTH(CCW);/* POINT TO NEXT SLOT            */ 01139000
         ALR   CCWPTR,@10                                       01S0377 01140000
*         CCWPTR->CCW(1)=RCDCSCCW;  /* RCKD,0,CC-SKIP,264            */ 01141000
         MVC   CCW(8,CCWPTR),RCDCSCCW                           01S0378 01142000
*         CCWPTR=CCWPTR+LENGTH(CCW);/* POINT TO NEXT SLOT            */ 01143000
         ALR   CCWPTR,@10                                       01S0379 01144000
*       END;                        /* OF DO WHILE                   */ 01145000
         AL    COUNTER,@CF00043                                 01S0380 01146000
         C     COUNTER,@CF00049                                 01S0380 01147000
         BNH   @DL00373                                         01S0380 01148000
*       CCWPTR=CCWPTR-2*LENGTH(CCW);/* POINT TO LAST RR0             */ 01149000
         SL    CCWPTR,@CF00167                                  01S0381 01150000
*       CCWPTR->CCWSKIP(1)=OFF;     /* TURN OFF SKIP                 */ 01151000
         NI    CCWSKIP(CCWPTR),B'11101111'                      01S0382 01152000
*       CCWPTR->CCWADDRB(1)=AP1BUFAB;/* READ R0 INTO BUFFER + 0      */ 01153000
         L     @10,AP1BUFAB-1(,AP1REG)                          01S0383 01154000
         LA    @10,0(,@10)                                      01S0383 01155000
         STCM  @10,7,CCWADDRB(CCWPTR)                           01S0383 01156000
*       CCWPTR=CCWPTR+LENGTH(CCW);  /* POINT TO READ CKD             */ 01157000
         LA    @09,8                                            01S0384 01158000
         ALR   CCWPTR,@09                                       01S0384 01159000
*       CCWPTR->CCWSKIP(1)=OFF;     /* TURN OFF SKIP                 */ 01160000
*       CCWPTR->CCWCC(1)=OFF;       /* AND CHAIN CMD                 */ 01161000
         NI    CCWSKIP(CCWPTR),B'10101111'                      01S0386 01162000
*       CCWPTR->CCWADDRB(1)=AP1BUFAB+LENGTH(CNT);/* READ R1 INTO        01163000
*                                      BUFFER + 8                    */ 01164000
         ALR   @10,@09                                          01S0387 01165000
         STCM  @10,7,CCWADDRB(CCWPTR)                           01S0387 01166000
*       AP1BUFAD->BYTE24=AP1BUFAD->BYTE24&&AP1BUFAD->BYTE24;/* CLEAR    01167000
*                                      BUFFER                        */ 01168000
         L     @10,AP1BUFAD(,AP1REG)                            01S0388 01169000
         XC    BYTE24(24,@10),BYTE24(@10)                       01S0388 01170000
*       AP1ETABA=ADDR(AP1ERRTM);    /* POINT TO HD 0 OF MOVEABLE HEAD   01171000
*                                      TABLE                         */ 01172000
         LA    @10,AP1ERRTM(,AP1REG)                            01S0389 01173000
         ST    @10,AP1ETABA(,AP1REG)                            01S0389 01174000
*       AP1TSTNO=AP1TSTNO+1;        /* USE CHK SUBCASE RR01          */ 01175000
         LA    @10,1                                            01S0390 01176000
         SLR   @09,@09                                          01S0390 01177000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0390 01178000
         ALR   @10,@09                                          01S0390 01179000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0390 01180000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01181000
         B     CE0001@                                          01S0391 01182000
*     END RR01S;                    /* END OF SUBCASE                */ 01183000
*                                                               01S0392 01184000
*     /***************************************************************/ 01185000
*     /*                                                             */ 01186000
*     /* RDMT: READ MULTI-TRACK                                      */ 01187000
*     /*                                                             */ 01188000
*     /***************************************************************/ 01189000
*                                                               01S0393 01190000
*RDMT:                                                          01S0393 01191000
*     DO;                           /* SUBCASE MULTI-TRACK READ      */ 01192000
RDMT     DS    0H                                               01S0394 01193000
*/*         CCW CHAIN:                                          01S0394 01194000
*                SEEK,AP1CESK,CC,6          SEEK TO CE CYL      01S0394 01195000
*                READ R0,BUFF,CC,16         READ R0 FOR COMPARE CNT     01196000
*                MT-RD CNT,BUFF+8,CC,8      READ R1 COUNT FOR COMPARE   01197000
*                      REPEAT 11 TIMES, INCREMENTING THRU BUFFER        01198000
*                NOP,0,CC,1                 DISORIENT           01S0394 01199000
*                RD CNT,BUFF+104,0,8        READ R1 COUNT TRK 11 AGAIN  01200000
*                                                                    */ 01201000
*/*  SETS CECCHH TO CE CYL TRK 0                                     */ 01202000
*                                                               01S0394 01203000
*       IF AP1DEVTP=AP13344 THEN    /* 3344                          */ 01204000
         CLI   AP1DEVTP(AP1REG),3                               01S0394 01205000
         BNE   @RF00394                                         01S0394 01206000
*         CECCHH=I3344CE0;          /* CYL 2800 HD 0                 */ 01207000
         MVC   CECCHH(4,AP1REG),@CB00205                        01S0395 01208000
*       ELSE                        /* NOT 3344                      */ 01209000
*         CECCHH=I3350CE0;          /* CYL 1024 HD 0                 */ 01210000
         B     @RC00394                                         01S0396 01211000
@RF00394 MVC   CECCHH(4,AP1REG),@CB00209                        01S0396 01212000
*       AP1FM=CEREADFM;             /* READ ONLY--CE CYL             */ 01213000
*                                                               01S0397 01214000
@RC00394 MVC   AP1FM(1,AP1REG),CEREADFM                         01S0397 01215000
*       /*************************************************************/ 01216000
*       /*                                                           */ 01217000
*       /* USE AP1SEEK AND SEEK CCW SET UP BY RHAS SUBCASE           */ 01218000
*       /*                                                           */ 01219000
*       /*************************************************************/ 01220000
*                                                               01S0398 01221000
*       BUFPTR=AP1BUFAD;            /* POINT TO BUFFER               */ 01222000
         L     BUFPTR,AP1BUFAD(,AP1REG)                         01S0398 01223000
*       CCWPTR=AP1CCWA+LENGTH(CCW); /* POINT TO 1ST SLOT AFTER SEEK  */ 01224000
         LA    @10,8                                            01S0399 01225000
         L     CCWPTR,AP1CCWA(,AP1REG)                          01S0399 01226000
         ALR   CCWPTR,@10                                       01S0399 01227000
*       CCWPTR->CCW(1)=RR0CCCCW;    /* RR0,0,CC,16                   */ 01228000
         MVC   CCW(8,CCWPTR),RR0CCCCW                           01S0400 01229000
*       CCWPTR->CCWADDRB(1)=BUFPTR; /* READ INTO BUFFER              */ 01230000
         STCM  BUFPTR,7,CCWADDRB(CCWPTR)                        01S0401 01231000
*       CCWPTR=CCWPTR+LENGTH(CCW);  /* NEXT CCW SLOT                 */ 01232000
         ALR   CCWPTR,@10                                       01S0402 01233000
*       BUFPTR=BUFPTR+LENGTH(CNT);  /* NEXT SPACE IN BUFFER          */ 01234000
         ALR   BUFPTR,@10                                       01S0403 01235000
*       DO COUNTER=1 TO 12;         /* BUILD 12 CCWS                 */ 01236000
         LA    COUNTER,1                                        01S0404 01237000
@DL00404 DS    0H                                               01S0405 01238000
*         CCWPTR->CCW(1)=MRCCCCCW;  /* MT-RCNT,0,CC,8                */ 01239000
         MVC   CCW(8,CCWPTR),MRCCCCCW                           01S0405 01240000
*         CCWPTR->CCWADDRB(1)=BUFPTR;/* READ INTO BUFFER             */ 01241000
         STCM  BUFPTR,7,CCWADDRB(CCWPTR)                        01S0406 01242000
*         CCWPTR=CCWPTR+LENGTH(CCW);/* NEXT CCW SLOT                 */ 01243000
         LA    @10,8                                            01S0407 01244000
         ALR   CCWPTR,@10                                       01S0407 01245000
*         BUFPTR=BUFPTR+LENGTH(CNT);/* NEXT SPACE IN BUFFER          */ 01246000
         ALR   BUFPTR,@10                                       01S0408 01247000
*       END;                        /* OF DO WHILE                   */ 01248000
         AL    COUNTER,@CF00043                                 01S0409 01249000
         C     COUNTER,@CF00033                                 01S0409 01250000
         BNH   @DL00404                                         01S0409 01251000
*       CCWPTR->CCW(1)=NOPCCCCW;    /* NOP,0,CC,1                    */ 01252000
         MVC   CCW(8,CCWPTR),NOPCCCCW                           01S0410 01253000
*       CCWPTR=CCWPTR+LENGTH(CCW);  /* NEXT CCW SLOT                 */ 01254000
         AL    CCWPTR,@CF00047                                  01S0411 01255000
*       CCWPTR->CCW(1)=RCCCW;       /* RDCNT,0,0,8                   */ 01256000
         MVC   CCW(8,CCWPTR),RCCCW                              01S0412 01257000
*       CCWPTR->CCWADDRB(1)=BUFPTR; /* READ INTO BUFFER              */ 01258000
         STCM  BUFPTR,7,CCWADDRB(CCWPTR)                        01S0413 01259000
*       AP1BUFAD->BYTE112=AP1BUFAD->BYTE112&&AP1BUFAD->BYTE112;/*       01260000
*                                      CLEAR BUFFER                  */ 01261000
         L     @10,AP1BUFAD(,AP1REG)                            01S0414 01262000
         XC    BYTE112(112,@10),BYTE112(@10)                    01S0414 01263000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01264000
         B     CE0001@                                          01S0415 01265000
*     END RDMT;                     /* END OF SUBCASE                */ 01266000
*                                                               01S0416 01267000
*     /***************************************************************/ 01268000
*     /*                                                             */ 01269000
*     /* FTWRT: FULL TRACK WRITE                                     */ 01270000
*     /*                                                             */ 01271000
*     /***************************************************************/ 01272000
*                                                               01S0417 01273000
*FTWRT:                                                         01S0417 01274000
*     DO;                           /* SUBCASE FULL TRACK WRITE      */ 01275000
FTWRT    DS    0H                                               01S0418 01276000
*/*       CCW CHAIN:                                            01S0418 01277000
*                SEEK,AP1CESK,CC,6          SEEK TO CE CYL      01S0418 01278000
*                SEARCH ID,AP1CESK+2,CC,5   SID R0              01S0418 01279000
*                TIC,*-8                                        01S0418 01280000
*                WRT CKD,BUFF,CD,8          WRITE R1 COUNT AND  01S0418 01281000
*                WRT CKD,0,CC,XXXX          FULL TRK OF DATA    01S0418 01282000
*                RD CKD,0,SKIP,XXXX+8       READ IT BACK             */ 01283000
*/*  SETS CECCHH TO CE CYL TRK 1                                     */ 01284000
*                                                               01S0418 01285000
*       IF AP1DEVTP=AP13344 THEN    /* 3344                          */ 01286000
         CLI   AP1DEVTP(AP1REG),3                               01S0418 01287000
         BNE   @RF00418                                         01S0418 01288000
*         CECCHH=I3344CE1;          /* CYL 2800 HD 1                 */ 01289000
         MVC   CECCHH(4,AP1REG),@CB00207                        01S0419 01290000
*       ELSE                        /* NOT 3344                      */ 01291000
*         CECCHH=I3350CE1;          /* CYL 1024 HD 1                 */ 01292000
         B     @RC00418                                         01S0420 01293000
@RF00418 MVC   CECCHH(4,AP1REG),@CB00211                        01S0420 01294000
*       CER=0;                      /* RECORD 0                      */ 01295000
@RC00418 MVI   CER(AP1REG),X'00'                                01S0421 01296000
*       AP1FM=CEFM;                 /* ALLOW WRITE--CE CYL           */ 01297000
*                                                               01S0422 01298000
         MVC   AP1FM(1,AP1REG),CEFM                             01S0422 01299000
*       /*************************************************************/ 01300000
*       /*                                                           */ 01301000
*       /* USE AP1SEEK AND SEEK CCW SET UP BY RHAS SUBCASE           */ 01302000
*       /*                                                           */ 01303000
*       /*************************************************************/ 01304000
*                                                               01S0423 01305000
*       CCW(2)=SIDCCCCW;            /* SEARCH ID,0,CC,5              */ 01306000
         L     @10,AP1CCWA(,AP1REG)                             01S0423 01307000
         MVC   CCW+8(8,@10),SIDCCCCW                            01S0423 01308000
*       CCWADDRB(2)=ADDR(CECCHH);   /* ADDR OF R0                    */ 01309000
         LA    @09,CECCHH(,AP1REG)                              01S0424 01310000
         STCM  @09,7,CCWADDRB+8(@10)                            01S0424 01311000
*       CCW(3)=TICCCW;              /* TIC,0,0,0                     */ 01312000
         MVC   CCW+16(8,@10),TICCCW                             01S0425 01313000
*       CCWADDRB(3)=AP1CCWAB+LENGTH(CCW);/* TIC TO SRCH HA           */ 01314000
         LA    @09,8                                            01S0426 01315000
         L     @15,AP1CCWAB-1(,AP1REG)                          01S0426 01316000
         LA    @15,0(,@15)                                      01S0426 01317000
         ALR   @09,@15                                          01S0426 01318000
         STCM  @09,7,CCWADDRB+16(@10)                           01S0426 01319000
*       CCW(4)=WCDCDCCW;            /* WCKD,0,CD,8                   */ 01320000
         MVC   CCW+24(8,@10),WCDCDCCW                           01S0427 01321000
*       CCWADDRB(4)=AP1BUFAB;       /* R1 COUNT IN BUFFER            */ 01322000
         MVC   CCWADDRB+24(3,@10),AP1BUFAB(AP1REG)              01S0428 01323000
*       AP1BUFAD->CNTCCHH=CECCHH;   /* CCHH                          */ 01324000
         L     @09,AP1BUFAD(,AP1REG)                            01S0429 01325000
         MVC   CNTCCHH(4,@09),CECCHH(AP1REG)                    01S0429 01326000
*       AP1BUFAD->CNTRKDD=R1DL0;    /* RK                            */ 01327000
         MVC   CNTRKDD(4,@09),@CB00221                          01S0430 01328000
*       CCW(5)=WCDCCCCW;            /* WCKD,0,CC,0                   */ 01329000
         MVC   CCW+32(8,@10),WCDCCCCW                           01S0431 01330000
*       CCW(6)=RCDSCCW;             /* RCKD,0,SKIP,264               */ 01331000
         MVC   CCW+40(8,@10),RCDSCCW                            01S0432 01332000
*       IF AP1DEVTP=AP13350 THEN    /* 3350                          */ 01333000
         CLI   AP1DEVTP(AP1REG),4                               01S0433 01334000
         BNE   @RF00433                                         01S0433 01335000
*         DO;                                                   01S0434 01336000
*           AP1BUFAD->CNTDD=FT3350; /* DL                            */ 01337000
         L     @15,@CF00242                                     01S0435 01338000
         STCM  @15,3,CNTDD(@09)                                 01S0435 01339000
*           CCWBYTE(5)=FT3350;      /* DL                            */ 01340000
         STH   @15,CCWBYTE+32(,@10)                             01S0436 01341000
*           CCWBYTE(6)=FT3350+LENGTH(CNT);/* DL + 8                  */ 01342000
         MVC   CCWBYTE+40(2,@10),@CH00591                       01S0437 01343000
*         END;                                                  01S0438 01344000
*       ELSE                        /* NOT 3350                      */ 01345000
*         IF AP1DEVTP=AP13344 THEN  /* 3344                          */ 01346000
         B     @RC00433                                         01S0439 01347000
@RF00433 CLI   AP1DEVTP(AP1REG),3                               01S0439 01348000
         BNE   @RF00439                                         01S0439 01349000
*           DO;                                                 01S0440 01350000
*             AP1BUFAD->CNTDD=FT3344;/* DL                           */ 01351000
         L     @10,@CF00244                                     01S0441 01352000
         L     @09,AP1BUFAD(,AP1REG)                            01S0441 01353000
         STCM  @10,3,CNTDD(@09)                                 01S0441 01354000
*             CCWBYTE(5)=FT3344;    /* DL                            */ 01355000
         L     @09,AP1CCWA(,AP1REG)                             01S0442 01356000
         STH   @10,CCWBYTE+32(,@09)                             01S0442 01357000
*             CCWBYTE(6)=FT3344+LENGTH(CNT);/* DL + 8                */ 01358000
         MVC   CCWBYTE+40(2,@09),@CH00592                       01S0443 01359000
*           END;                                                01S0444 01360000
*         ELSE                      /* 3330                          */ 01361000
*           DO;                                                 01S0445 01362000
         B     @RC00439                                         01S0445 01363000
@RF00439 DS    0H                                               01S0446 01364000
*             AP1BUFAD->CNTDD=FT3330;/* DL                           */ 01365000
         L     @10,@CF00246                                     01S0446 01366000
         L     @09,AP1BUFAD(,AP1REG)                            01S0446 01367000
         STCM  @10,3,CNTDD(@09)                                 01S0446 01368000
*             CCWBYTE(5)=FT3330;    /* DL                            */ 01369000
         L     @09,AP1CCWA(,AP1REG)                             01S0447 01370000
         STH   @10,CCWBYTE+32(,@09)                             01S0447 01371000
*             CCWBYTE(6)=FT3330+LENGTH(CNT);/* DL + 8                */ 01372000
         MVC   CCWBYTE+40(2,@09),@CH00593                       01S0448 01373000
*           END;                                                01S0449 01374000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01375000
         B     CE0001@                                          01S0450 01376000
*     END FTWRT;                    /* END OF SUBCASE                */ 01377000
*                                                               01S0451 01378000
*     /***************************************************************/ 01379000
*     /*                                                             */ 01380000
*     /* AMDET: ADDRESS MARK DETECT                                  */ 01381000
*     /*                                                             */ 01382000
*     /***************************************************************/ 01383000
*                                                               01S0452 01384000
*AMDET:                                                         01S0452 01385000
*     DO;                           /* SUBCASE AM DETECTION TEST     */ 01386000
AMDET    DS    0H                                               01S0453 01387000
*/*       CCW CHAIN:                                            01S0453 01388000
*                SEEK,AP1CESK,CC,6            TO CE CYL         01S0453 01389000
*                SRCH ID,AP1CESK+2,CC,5       SID R0            01S0453 01390000
*                TIC,*-8                                        01S0453 01391000
*                WRT CKD,BUFF,CD,8        WRITE R1              01S0453 01392000
*                WRT CKD,0,CC,1024                              01S0453 01393000
*                WRT CKD,BUFF+8,CD,8      WRITE R2              01S0453 01394000
*                WRT CKD,0,CC,1024                              01S0453 01395000
*                SID,BUFF,CC,5            SID R1                01S0453 01396000
*                TIC,*-8                                        01S0453 01397000
*                NOP,0,0,1                DESTROY ORIENTATION   01S0453 01398000
*                RD CNT,BUFF+16,0,8       READ CNT R2                */ 01399000
*/*  SETS CECCHH TO CE CYL TRK 1                                     */ 01400000
*                                                               01S0453 01401000
*       IF AP1DEVTP=AP13344 THEN    /* 3344                          */ 01402000
         CLI   AP1DEVTP(AP1REG),3                               01S0453 01403000
         BNE   @RF00453                                         01S0453 01404000
*         CECCHH=I3344CE1;          /* CYL 2800 HD 1                 */ 01405000
         MVC   CECCHH(4,AP1REG),@CB00207                        01S0454 01406000
*       ELSE                        /* NOT 3344                      */ 01407000
*         CECCHH=I3350CE1;          /* CYL 1024 HD 1                 */ 01408000
         B     @RC00453                                         01S0455 01409000
@RF00453 MVC   CECCHH(4,AP1REG),@CB00211                        01S0455 01410000
*       CER=0;                      /* RECORD 0                      */ 01411000
@RC00453 MVI   CER(AP1REG),X'00'                                01S0456 01412000
*       AP1FM=CEFM;                 /* WRITE--CE CYL                 */ 01413000
*                                                               01S0457 01414000
         MVC   AP1FM(1,AP1REG),CEFM                             01S0457 01415000
*       /*************************************************************/ 01416000
*       /*                                                           */ 01417000
*       /* USE AP1SEEK AND SEEK CCW SET UP BY RHAS SUBCASE           */ 01418000
*       /*                                                           */ 01419000
*       /*************************************************************/ 01420000
*                                                               01S0458 01421000
*       BUFPTR=AP1BUFAD;            /* POINT TO BUFFER               */ 01422000
         L     BUFPTR,AP1BUFAD(,AP1REG)                         01S0458 01423000
*       CCWPTR=AP1CCWA+LENGTH(CCW); /* 1ST CCW AFTER SEEK            */ 01424000
         LA    @10,8                                            01S0459 01425000
         L     CCWPTR,AP1CCWA(,AP1REG)                          01S0459 01426000
         ALR   CCWPTR,@10                                       01S0459 01427000
*       CCWPTR->CCW(1)=SIDCCCCW;    /* SRCH ID,0,CC,5                */ 01428000
         MVC   CCW(8,CCWPTR),SIDCCCCW                           01S0460 01429000
*       CCWPTR->CCWADDRB(1)=ADDR(CECCHH);/* ADDRESS OF R0            */ 01430000
         LA    @09,CECCHH(,AP1REG)                              01S0461 01431000
         STCM  @09,7,CCWADDRB(CCWPTR)                           01S0461 01432000
*       EVAL(CCWPTR+LENGTH(CCW))->CCW(1)=TICCCW;/* TIC,0,0,0         */ 01433000
         LR    @09,CCWPTR                                       01S0462 01434000
         ALR   @09,@10                                          01S0462 01435000
         MVC   CCW(8,@09),TICCCW                                01S0462 01436000
*       EVAL(CCWPTR+LENGTH(CCW))->CCWADDRB(1)=CCWPTR;/* TIC TO SEARCH*/ 01437000
         ALR   @10,CCWPTR                                       01S0463 01438000
         STCM  CCWPTR,7,CCWADDRB(@10)                           01S0463 01439000
*       CCWPTR=CCWPTR+2*LENGTH(CCW);/* NEXT SLOT                     */ 01440000
         AL    CCWPTR,@CF00167                                  01S0464 01441000
*       DO COUNTER=1 TO 2;          /* WRITE TWO RECORDS             */ 01442000
         LA    COUNTER,1                                        01S0465 01443000
@DL00465 DS    0H                                               01S0466 01444000
*         CCWPTR->CCW(1)=WCDCDCCW;  /* WCKD,0,CD,8                   */ 01445000
         MVC   CCW(8,CCWPTR),WCDCDCCW                           01S0466 01446000
*         CCWPTR->CCWADDRB(1)=BUFPTR;/* COUNT IN BUFFER              */ 01447000
         STCM  BUFPTR,7,CCWADDRB(CCWPTR)                        01S0467 01448000
*         CCWPTR=CCWPTR+LENGTH(CCW);/* NEXT SLOT                     */ 01449000
         LA    @10,8                                            01S0468 01450000
         ALR   CCWPTR,@10                                       01S0468 01451000
*         CCWPTR->CCW(1)=WCDCCCCW;  /* WCKD,0,CC,0                   */ 01452000
         MVC   CCW(8,CCWPTR),WCDCCCCW                           01S0469 01453000
*         CCWPTR->CCWBYTE(1)=1024;  /* 1 K RECORDS                   */ 01454000
         MVC   CCWBYTE(2,CCWPTR),@CH00578                       01S0470 01455000
*         CCWPTR=CCWPTR+LENGTH(CCW);/* NEXT SLOT                     */ 01456000
         ALR   CCWPTR,@10                                       01S0471 01457000
*         BUFPTR->CNTCCHH=CECCHH;   /* CCHH                          */ 01458000
         MVC   CNTCCHH(4,BUFPTR),CECCHH(AP1REG)                 01S0472 01459000
*         BUFPTR->CNTKDD=DL1024;    /* KDD                           */ 01460000
         MVC   CNTKDD(3,BUFPTR),@CB00219                        01S0473 01461000
*         BUFPTR->CNTR=COUNTER;     /* R                             */ 01462000
         STC   COUNTER,CNTR(,BUFPTR)                            01S0474 01463000
*         BUFPTR=BUFPTR+LENGTH(CNT);/* NEXT SLOT                     */ 01464000
         ALR   BUFPTR,@10                                       01S0475 01465000
*       END;                        /* OF DO                         */ 01466000
         AL    COUNTER,@CF00043                                 01S0476 01467000
         C     COUNTER,@CF00058                                 01S0476 01468000
         BNH   @DL00465                                         01S0476 01469000
*       CCWPTR->CCW(1)=SIDCCCCW;    /* SID,0,CC,5                    */ 01470000
         MVC   CCW(8,CCWPTR),SIDCCCCW                           01S0477 01471000
*       CCWPTR->CCWADDRB(1)=AP1BUFAD;/* SEARCH R1                    */ 01472000
         MVC   CCWADDRB(3,CCWPTR),AP1BUFAD+1(AP1REG)            01S0478 01473000
*       EVAL(CCWPTR+LENGTH(CCW))->CCW(1)=TICCCW;/* TIC,0,0,0         */ 01474000
         LA    @10,8                                            01S0479 01475000
         LR    @09,CCWPTR                                       01S0479 01476000
         ALR   @09,@10                                          01S0479 01477000
         MVC   CCW(8,@09),TICCCW                                01S0479 01478000
*       EVAL(CCWPTR+LENGTH(CCW))->CCWADDRB(1)=CCWPTR;/* TIC TO SEARCH*/ 01479000
         LR    @09,CCWPTR                                       01S0480 01480000
         ALR   @09,@10                                          01S0480 01481000
         STCM  CCWPTR,7,CCWADDRB(@09)                           01S0480 01482000
*       CCWPTR=CCWPTR+LENGTH(CCW)*2;/* NEXT SLOT                     */ 01483000
         AL    CCWPTR,@CF00167                                  01S0481 01484000
*       CCWPTR->CCW(1)=NOPCCCCW;    /* NOP,0,CC,1                    */ 01485000
         MVC   CCW(8,CCWPTR),NOPCCCCW                           01S0482 01486000
*       CCWPTR=CCWPTR+LENGTH(CCW);  /* NEXT SLOT                     */ 01487000
         ALR   CCWPTR,@10                                       01S0483 01488000
*       CCWPTR->CCW(1)=RCCCW;       /* RD CNT,0,0,8                  */ 01489000
         MVC   CCW(8,CCWPTR),RCCCW                              01S0484 01490000
*       CCWPTR->CCWADDRB(1)=BUFPTR; /* READ INTO BUFFER              */ 01491000
         STCM  BUFPTR,7,CCWADDRB(CCWPTR)                        01S0485 01492000
*       BUFPTR->BYTE8=BUFPTR->BYTE8&&BUFPTR->BYTE8;/* CLEAR BUFFER   */ 01493000
         XC    BYTE8(8,BUFPTR),BYTE8(BUFPTR)                    01S0486 01494000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01495000
         B     CE0001@                                          01S0487 01496000
*     END AMDET;                    /* END OF SUBCASE                */ 01497000
*                                                               01S0488 01498000
*     /***************************************************************/ 01499000
*     /*                                                             */ 01500000
*     /* WRTPAD: FORMAT WRITE PADDING                                */ 01501000
*     /*                                                             */ 01502000
*     /***************************************************************/ 01503000
*                                                               01S0489 01504000
*WRTPAD:                                                        01S0489 01505000
*     DO;                           /* SUBCASE WRITE PADDING         */ 01506000
WRTPAD   DS    0H                                               01S0490 01507000
*/*      CCW CHAIN:                                             01S0490 01508000
*                SEEK,AP1CESK,CC,6        TO CE CYL             01S0490 01509000
*                SRCH ID,AP1CESK+2,CC,5   SID R0                01S0490 01510000
*                TIC,*-8                                        01S0490 01511000
*                WRT CKD,BUFF,CC,264      WRITE R1              01S0490 01512000
*                WRT CKD,BUFF+8,CC,8      WRITE R2              01S0490 01513000
*                SRCH ID,AP1CESK+2,CC,5   SID R0                01S0490 01514000
*                TIC,*-8                                        01S0490 01515000
*                WRT CKD,BUFF,CC,264      WRITE NEW R1          01S0490 01516000
*                RHA,0,CC-SKIP,4          RE-POSITION           01S0490 01517000
*                RDCNT,0,CC-SKIP,8        READ R1               01S0490 01518000
*                RDCNT,BUFF+24,0,8        READ R1 AGAIN              */ 01519000
*                                                               01S0490 01520000
*       RFY                                                     01S0490 01521000
*         CCW BASED(CCWPTR);        /* ADDRESSABILITY                */ 01522000
*/*  SETS CECCHH TO CE CYL TRK 1                                     */ 01523000
*                                                               01S0491 01524000
*       IF AP1DEVTP=AP13344 THEN    /* 3344                          */ 01525000
         CLI   AP1DEVTP(AP1REG),3                               01S0491 01526000
         BNE   @RF00491                                         01S0491 01527000
*         CECCHH=I3344CE1;          /* CYL 2800 HD 1                 */ 01528000
         MVC   CECCHH(4,AP1REG),@CB00207                        01S0492 01529000
*       ELSE                        /* NOT 3344                      */ 01530000
*         CECCHH=I3350CE1;          /* CYL 1024 HD 1                 */ 01531000
         B     @RC00491                                         01S0493 01532000
@RF00491 MVC   CECCHH(4,AP1REG),@CB00211                        01S0493 01533000
*       CER=0;                      /* RECORD 0                      */ 01534000
@RC00491 MVI   CER(AP1REG),X'00'                                01S0494 01535000
*       AP1FM=CEFM;                 /* WRITE--CE CYL                 */ 01536000
*                                                               01S0495 01537000
         MVC   AP1FM(1,AP1REG),CEFM                             01S0495 01538000
*       /*************************************************************/ 01539000
*       /*                                                           */ 01540000
*       /* AP1SEEK AND SEEK CCW TO CE CYL SET UP BY SUBCASE RHAS     */ 01541000
*       /*                                                           */ 01542000
*       /*************************************************************/ 01543000
*                                                               01S0496 01544000
*       BUFPTR=AP1BUFAD;            /* POINT TO BUFFER               */ 01545000
         L     BUFPTR,AP1BUFAD(,AP1REG)                         01S0496 01546000
*       CCWPTR=AP1CCWA+LENGTH(CCW); /* 1ST CCW AFTER SEEK            */ 01547000
         LA    @10,8                                            01S0497 01548000
         L     CCWPTR,AP1CCWA(,AP1REG)                          01S0497 01549000
         ALR   CCWPTR,@10                                       01S0497 01550000
*       CCW(1)=SIDCCCCW;            /* SRCH ID,0,CC,5                */ 01551000
         MVC   CCW(8,CCWPTR),SIDCCCCW                           01S0498 01552000
*       CCWADDRB(1)=ADDR(CECCHH);   /* ADDRESS OF R0                 */ 01553000
         LA    @09,CECCHH(,AP1REG)                              01S0499 01554000
         STCM  @09,7,CCWADDRB(CCWPTR)                           01S0499 01555000
*       EVAL(CCWPTR+LENGTH(CCW))->CCW(1)=TICCCW;/* TIC,0,0,0         */ 01556000
         LR    @15,CCWPTR                                       01S0500 01557000
         ALR   @15,@10                                          01S0500 01558000
         MVC   CCW(8,@15),TICCCW                                01S0500 01559000
*       EVAL(CCWPTR+LENGTH(CCW))->CCWADDRB(1)=CCWPTR;/* TIC TO SEARCH*/ 01560000
         LR    @15,CCWPTR                                       01S0501 01561000
         ALR   @15,@10                                          01S0501 01562000
         STCM  CCWPTR,7,CCWADDRB(@15)                           01S0501 01563000
*       CCWPTR=CCWPTR+2*LENGTH(CCW);/* NEXT SLOT                     */ 01564000
         LA    @15,16                                           01S0502 01565000
         ALR   CCWPTR,@15                                       01S0502 01566000
*       CCW(1)=WCDCCCCW;            /* WCKD,0,CC,264                 */ 01567000
         MVC   CCW(8,CCWPTR),WCDCCCCW                           01S0503 01568000
*       CCWADDRB(1)=BUFPTR;         /* COUNT IN BUFFER               */ 01569000
         STCM  BUFPTR,7,CCWADDRB(CCWPTR)                        01S0504 01570000
*       CNTCCHH=CECCHH;             /* CE CCHH                       */ 01571000
         MVC   CNTCCHH(4,BUFPTR),CECCHH(AP1REG)                 01S0505 01572000
*       CNTRKDD=R1DL256;            /* RKDD                          */ 01573000
         MVC   CNTRKDD(4,BUFPTR),@CB00227                       01S0506 01574000
*       BUFPTR=BUFPTR+LENGTH(CNT);  /* NEXT SLOT                     */ 01575000
         ALR   BUFPTR,@10                                       01S0507 01576000
*       CCWPTR=CCWPTR+LENGTH(CCW);  /* NEXT SLOT                     */ 01577000
         ALR   CCWPTR,@10                                       01S0508 01578000
*       CCW(1)=WCDCCCCW;            /* WCKD,0,CC,0                   */ 01579000
         MVC   CCW(8,CCWPTR),WCDCCCCW                           01S0509 01580000
*       CCWBYTE(1)=LENGTH(CNT);     /* COUNT ONLY                    */ 01581000
         STH   @10,CCWBYTE(,CCWPTR)                             01S0510 01582000
*       CCWADDRB(1)=BUFPTR;         /* COUNT IN BUFFER               */ 01583000
         STCM  BUFPTR,7,CCWADDRB(CCWPTR)                        01S0511 01584000
*       CNTCCHH=CECCHH;             /* CE CCHH                       */ 01585000
         MVC   CNTCCHH(4,BUFPTR),CECCHH(AP1REG)                 01S0512 01586000
*       CNTRKDD=R2DL0;              /* RKDD                          */ 01587000
         MVC   CNTRKDD(4,BUFPTR),@CB00223                       01S0513 01588000
*       CCWPTR=CCWPTR+LENGTH(CCW);  /* NEXT SLOT                     */ 01589000
         ALR   CCWPTR,@10                                       01S0514 01590000
*       BUFPTR=BUFPTR+LENGTH(CNT);  /* BUFFER + 16                   */ 01591000
         ALR   BUFPTR,@10                                       01S0515 01592000
*       CCW(1)=SIDCCCCW;            /* SRCH ID,0,CC,5                */ 01593000
         MVC   CCW(8,CCWPTR),SIDCCCCW                           01S0516 01594000
*       CCWADDRB(1)=ADDR(CECCHH);   /* ADDRESS OF R0                 */ 01595000
         STCM  @09,7,CCWADDRB(CCWPTR)                           01S0517 01596000
*       EVAL(CCWPTR+LENGTH(CCW))->CCW(1)=TICCCW;/* TIC,0,0,0         */ 01597000
         LR    @09,CCWPTR                                       01S0518 01598000
         ALR   @09,@10                                          01S0518 01599000
         MVC   CCW(8,@09),TICCCW                                01S0518 01600000
*       EVAL(CCWPTR+LENGTH(CCW))->CCWADDRB(1)=CCWPTR;/* TIC TO SEARCH*/ 01601000
         LR    @09,CCWPTR                                       01S0519 01602000
         ALR   @09,@10                                          01S0519 01603000
         STCM  CCWPTR,7,CCWADDRB(@09)                           01S0519 01604000
*       CCWPTR=CCWPTR+2*LENGTH(CCW);/* NEXT SLOT                     */ 01605000
         ALR   CCWPTR,@15                                       01S0520 01606000
*       CCW(1)=WCDCCCCW;            /* WCKD,0,CC,264                 */ 01607000
         MVC   CCW(8,CCWPTR),WCDCCCCW                           01S0521 01608000
*       CCWADDRB(1)=BUFPTR-(2*LENGTH(CNT));/* COUNT IN BUFFER        */ 01609000
         LCR   @15,@15                                          01S0522 01610000
         ALR   @15,BUFPTR                                       01S0522 01611000
         STCM  @15,7,CCWADDRB(CCWPTR)                           01S0522 01612000
*       CCWPTR=CCWPTR+LENGTH(CCW);  /* NEXT SLOT                     */ 01613000
         ALR   CCWPTR,@10                                       01S0523 01614000
*       CCW(1)=RHACSCCW;            /* RHA,0,SKIP-CC,5               */ 01615000
         MVC   CCW(8,CCWPTR),RHACSCCW                           01S0524 01616000
*       CCWPTR=CCWPTR+LENGTH(CCW);  /* NEXT SLOT                     */ 01617000
         ALR   CCWPTR,@10                                       01S0525 01618000
*       CCW(1)=RCCSCCW;             /* RDCNT,0,SKIP-CC,8             */ 01619000
         MVC   CCW(8,CCWPTR),RCCSCCW                            01S0526 01620000
*       CCWPTR=CCWPTR+LENGTH(CCW);  /* NEXT SLOT                     */ 01621000
         ALR   CCWPTR,@10                                       01S0527 01622000
*       CCW(1)=RCCCW;               /* RDCNT,0,0,8                   */ 01623000
         MVC   CCW(8,CCWPTR),RCCCW                              01S0528 01624000
*       CCWADDRB(1)=BUFPTR;         /* READ IN TO BUFFER             */ 01625000
         STCM  BUFPTR,7,CCWADDRB(CCWPTR)                        01S0529 01626000
*       BUFPTR->BYTE8=BUFPTR->BYTE8&&BUFPTR->BYTE8;/* CLEAR BUFFER   */ 01627000
         XC    BYTE8(8,BUFPTR),BYTE8(BUFPTR)                    01S0530 01628000
*       RFY                                                     01S0531 01629000
*         CCW BASED(AP1CCWA);       /* ADDRESSABILITY                */ 01630000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01631000
         B     CE0001@                                          01S0532 01632000
*     END WRTPAD;                   /* END OF SUBCASE                */ 01633000
*                                                               01S0533 01634000
*     /***************************************************************/ 01635000
*     /*                                                             */ 01636000
*     /* SD: SKIP DEFECTS                                            */ 01637000
*     /*                                                             */ 01638000
*     /***************************************************************/ 01639000
*                                                               01S0534 01640000
*SD:                                                            01S0534 01641000
*     DO;                           /* SUBCASE SKIP DEFECT TEST      */ 01642000
SD       DS    0H                                               01S0535 01643000
*/*     CCW CHAIN:                                              01S0535 01644000
*                SEEK,AP1CESK,CC,6     TO CE CYL                01S0535 01645000
*                SRCH HA,AP1CESK+2,CC,4 VERIFY SEEK             01S0535 01646000
*                TIC,*-8                                        01S0535 01647000
*                WRT HA,BUFF+Y,CC,11-Y WRITE HA WITH SD INFO    01S0535 01648000
*                WRT R0,BUFF+11,CC,N   WRITE R0 WITH DUMMY SD AND R1    01649000
*                RD HA,0,SKIP-CC,5     READ HA                  01S0535 01650000
*                SP CNT,BUFF+11+N,CC,3 SPACE ACROSS R0 CNT      01S0535 01651000
*                RD CKD,0,SKIP,264     READ R1                       */ 01652000
*/*  SETS CECCHH TO CE CYL TRK 1                                     */ 01653000
*                                                               01S0535 01654000
*       IF AP1DEVTP=AP13344 THEN    /* 3344                          */ 01655000
         CLI   AP1DEVTP(AP1REG),3                               01S0535 01656000
         BNE   @RF00535                                         01S0535 01657000
*         CECCHH=I3344CE1;          /* CYL 2800 HD 1                 */ 01658000
         MVC   CECCHH(4,AP1REG),@CB00207                        01S0536 01659000
*       ELSE                        /* NOT 3344                      */ 01660000
*         CECCHH=I3350CE1;          /* CYL 1024 HD 1                 */ 01661000
         B     @RC00535                                         01S0537 01662000
@RF00535 MVC   CECCHH(4,AP1REG),@CB00211                        01S0537 01663000
*       CER=0;                      /* RECORD 0                      */ 01664000
@RC00535 MVI   CER(AP1REG),X'00'                                01S0538 01665000
*       AP1FM=CEHAR0FM;             /* ALL WRITES--CE CYL            */ 01666000
*                                                               01S0539 01667000
         MVC   AP1FM(1,AP1REG),CEHAR0FM                         01S0539 01668000
*       /*************************************************************/ 01669000
*       /*                                                           */ 01670000
*       /* USE AP1SEEK AND SEEK CCW SET UP BY RHAS SUBCASE           */ 01671000
*       /*                                                           */ 01672000
*       /*************************************************************/ 01673000
*                                                               01S0540 01674000
*       BUFPTR=AP1BUFAD;            /* POINT TO BUFFER               */ 01675000
         L     BUFPTR,AP1BUFAD(,AP1REG)                         01S0540 01676000
*       CCWPTR=AP1CCWA+LENGTH(CCW); /* FIRST CCW SLOT AFTER SEEK     */ 01677000
         LA    @10,8                                            01S0541 01678000
         L     CCWPTR,AP1CCWA(,AP1REG)                          01S0541 01679000
         ALR   CCWPTR,@10                                       01S0541 01680000
*       CCWPTR->CCW(1)=SHACCCCW;    /* SRCH HA,0,CC,4                */ 01681000
         MVC   CCW(8,CCWPTR),SHACCCCW                           01S0542 01682000
*       CCWPTR->CCWADDRB(1)=ADDR(CECCHH);/* TRACK ADDRESS            */ 01683000
         LA    @09,CECCHH(,AP1REG)                              01S0543 01684000
         STCM  @09,7,CCWADDRB(CCWPTR)                           01S0543 01685000
*       EVAL(CCWPTR+LENGTH(CCW))->CCW(1)=TICCCW;/* TIC,0,0,0         */ 01686000
         LR    @09,CCWPTR                                       01S0544 01687000
         ALR   @09,@10                                          01S0544 01688000
         MVC   CCW(8,@09),TICCCW                                01S0544 01689000
*       EVAL(CCWPTR+LENGTH(CCW))->CCWADDRB(1)=CCWPTR;/* TIC TO SEARCH*/ 01690000
         ALR   @10,CCWPTR                                       01S0545 01691000
         STCM  CCWPTR,7,CCWADDRB(@10)                           01S0545 01692000
*       CCWPTR=CCWPTR+2*LENGTH(CCW);/* NEXT SLOT                     */ 01693000
         AL    CCWPTR,@CF00167                                  01S0546 01694000
*       CCWPTR->CCW(1)=WHACCCCW;    /* WRT HA,0,CC,11                */ 01695000
         MVC   CCW(8,CCWPTR),WHACCCCW                           01S0547 01696000
*       IF AP1DEVTP=AP13350 THEN    /* 3350                          */ 01697000
         CLI   AP1DEVTP(AP1REG),4                               01S0548 01698000
         BNE   @RF00548                                         01S0548 01699000
*         CCWPTR->CCWADDRB(1)=BUFPTR;/* WRITE FROM BUFFER            */ 01700000
         STCM  BUFPTR,7,CCWADDRB(CCWPTR)                        01S0549 01701000
*       ELSE                        /* NOT 3350                      */ 01702000
*         IF AP1DEVTP=AP13344 THEN  /* 3344                          */ 01703000
         B     @RC00548                                         01S0550 01704000
@RF00548 CLI   AP1DEVTP(AP1REG),3                               01S0550 01705000
         BNE   @RF00550                                         01S0550 01706000
*           DO;                                                 01S0551 01707000
*             CCWPTR->CCWADDRB(1)=BUFPTR+4;/* SD FOR 3344            */ 01708000
         LA    @10,4                                            01S0552 01709000
         ALR   @10,BUFPTR                                       01S0552 01710000
         STCM  @10,7,CCWADDRB(CCWPTR)                           01S0552 01711000
*             CCWPTR->CCWBYTE(1)=LENGTH(CECCHH)+3;/* SD+FLG+CCHH     */ 01712000
         MVC   CCWBYTE(2,CCWPTR),@CH00076                       01S0553 01713000
*           END;                                                01S0554 01714000
*         ELSE                      /* 3330                          */ 01715000
*           DO;                                                 01S0555 01716000
         B     @RC00550                                         01S0555 01717000
@RF00550 DS    0H                                               01S0556 01718000
*             CCWPTR->CCWADDRB(1)=BUFPTR+LENGTH(SDZERO);/* FLAG      */ 01719000
         LA    @10,6                                            01S0556 01720000
         ALR   @10,BUFPTR                                       01S0556 01721000
         STCM  @10,7,CCWADDRB(CCWPTR)                           01S0556 01722000
*             CCWPTR->CCWBYTE(1)=LENGTH(CECCHH)+1;/* FLG+CCHH        */ 01723000
         MVC   CCWBYTE(2,CCWPTR),@CH00083                       01S0557 01724000
*           END;                                                01S0558 01725000
*       CCWPTR=CCWPTR+LENGTH(CCW);  /* NEXT SLOT                     */ 01726000
@RC00550 DS    0H                                               01S0559 01727000
@RC00548 AL    CCWPTR,@CF00047                                  01S0559 01728000
*       BUFPTR->BYTE6=SDZERO;       /* MOVE IN SKIP DEFECT           */ 01729000
         MVC   BYTE6(6,BUFPTR),SDZERO                           01S0560 01730000
*       BUFPTR=BUFPTR+LENGTH(SDZERO);/* TO FLAG                      */ 01731000
         AL    BUFPTR,@CF00155                                  01S0561 01732000
*       BUFPTR->BYTE1='00'X;        /* FLAG OF ZERO                  */ 01733000
         MVI   BYTE1(BUFPTR),X'00'                              01S0562 01734000
*       BUFPTR=BUFPTR+1;            /* TO CCHH                       */ 01735000
         AL    BUFPTR,@CF00043                                  01S0563 01736000
*       BUFPTR->CNTCCHH=CECCHH;     /* CCHH                          */ 01737000
         MVC   CNTCCHH(4,BUFPTR),CECCHH(AP1REG)                 01S0564 01738000
*       BUFPTR=BUFPTR+LENGTH(CCHH); /* TO R0                         */ 01739000
         AL    BUFPTR,@CF00038                                  01S0565 01740000
*       CCWPTR->CCW(1)=WR0CCCCW;    /* WRT R0,0,CC,16                */ 01741000
         MVC   CCW(8,CCWPTR),WR0CCCCW                           01S0566 01742000
*       CCWPTR->CCWADDRB(1)=BUFPTR; /* POINT TO COUNT                */ 01743000
         STCM  BUFPTR,7,CCWADDRB(CCWPTR)                        01S0567 01744000
*       BUFPTR->CNTCCHH=CECCHH;     /* CCHH FOR R0                   */ 01745000
         MVC   CNTCCHH(4,BUFPTR),CECCHH(AP1REG)                 01S0568 01746000
*       IF AP1DEVTP=AP13344 THEN    /* 3344                          */ 01747000
         CLI   AP1DEVTP(AP1REG),3                               01S0569 01748000
         BNE   @RF00569                                         01S0569 01749000
*         BUFPTR->CNTRKDD=R0DL565;  /* RKDD                          */ 01750000
         MVC   CNTRKDD(4,BUFPTR),R0DL565                        01S0570 01751000
*       ELSE                        /* 3350 OR 3330                  */ 01752000
*         BUFPTR->CNTRKDD=R0DL839;  /* RKDD                          */ 01753000
         B     @RC00569                                         01S0571 01754000
@RF00569 MVC   CNTRKDD(4,BUFPTR),R0DL839                        01S0571 01755000
*       CCWPTR->CCWBYTE(1)=BUFPTR->CNTDD+LENGTH(CNT);/* PUT BYTE CNT    01756000
*                                      IN WR0                        */ 01757000
@RC00569 LA    @10,8                                            01S0572 01758000
         SLR   @09,@09                                          01S0572 01759000
         ICM   @09,3,CNTDD(BUFPTR)                              01S0572 01760000
         ALR   @09,@10                                          01S0572 01761000
         STH   @09,CCWBYTE(,CCWPTR)                             01S0572 01762000
*       CCWPTR=CCWPTR+LENGTH(CCW);  /* NEXT SLOT                     */ 01763000
*                                                               01S0573 01764000
         ALR   CCWPTR,@10                                       01S0573 01765000
*       /*************************************************************/ 01766000
*       /*                                                           */ 01767000
*       /* MOVE IN R0                                                */ 01768000
*       /*                                                           */ 01769000
*       /*************************************************************/ 01770000
*                                                               01S0574 01771000
*       RFY                                                     01S0574 01772000
*        (GPR00P,                                               01S0574 01773000
*         GPR01F,                                               01S0574 01774000
*         GPR14P,                                               01S0574 01775000
*         GPR15F) RSTD;                                         01S0574 01776000
*       IF AP1DEVTP=AP13344 THEN    /* 3344                          */ 01777000
         CLI   AP1DEVTP(AP1REG),3                               01S0575 01778000
         BNE   @RF00575                                         01S0575 01779000
*         GPR00P=ADDR(SDR03344);    /* FROM ADDR                     */ 01780000
         LA    GPR00P,SDR03344                                  01S0576 01781000
*       ELSE                        /* 3330 OR 3350                  */ 01782000
*         GPR00P=ADDR(SDR03350);    /* FROM ADDR                     */ 01783000
         B     @RC00575                                         01S0577 01784000
@RF00575 LA    GPR00P,SDR03350                                  01S0577 01785000
*       GPR01F=BUFPTR->CNTDD;       /* FROM LENGTH                   */ 01786000
@RC00575 SLR   @10,@10                                          01S0578 01787000
         ICM   @10,3,CNTDD(BUFPTR)                              01S0578 01788000
         LR    GPR01F,@10                                       01S0578 01789000
*       GPR15F=BUFPTR->CNTDD;       /* TO LENGTH                     */ 01790000
         LR    GPR15F,@10                                       01S0579 01791000
*       BUFPTR=BUFPTR+LENGTH(CNT);  /* SLOT FOR R0 DATA              */ 01792000
         AL    BUFPTR,@CF00047                                  01S0580 01793000
*       GPR14P=BUFPTR;              /* TO ADDR                       */ 01794000
         LR    GPR14P,BUFPTR                                    01S0581 01795000
*       BUFPTR=BUFPTR+GPR15F;       /* NEXT SLOT                     */ 01796000
         ALR   BUFPTR,GPR15F                                    01S0582 01797000
*       MVCL(GPR14P,GPR00P);        /* MOVE IN R0 DATA               */ 01798000
         MVCL  GPR14P,GPR00P                                    01S0583 01799000
*       RFY                                                     01S0584 01800000
*        (GPR00P,                                               01S0584 01801000
*         GPR01F,                                               01S0584 01802000
*         GPR14P,                                               01S0584 01803000
*         GPR15F) UNRSTD;                                       01S0584 01804000
*       CCWPTR->CCW(1)=RHACSCCW;    /* RHA,0,SKIP-CC,5               */ 01805000
         MVC   CCW(8,CCWPTR),RHACSCCW                           01S0585 01806000
*       CCWPTR=CCWPTR+LENGTH(CCW);  /* NEXT SLOT                     */ 01807000
         LA    @10,8                                            01S0586 01808000
         ALR   CCWPTR,@10                                       01S0586 01809000
*       CCWPTR->CCW(1)=SPCCCCCW;    /* SP CNT,0,CC,3                 */ 01810000
         MVC   CCW(8,CCWPTR),SPCCCCCW                           01S0587 01811000
*       CCWPTR->CCWADDRB(1)=BUFPTR+LENGTH(CNTR);/* POINT TO BUFFER   */ 01812000
         LA    @09,1                                            01S0588 01813000
         ALR   @09,BUFPTR                                       01S0588 01814000
         STCM  @09,7,CCWADDRB(CCWPTR)                           01S0588 01815000
*       BUFPTR->BYTE4=R0DL8;        /* RKDD                          */ 01816000
         MVC   BYTE4(4,BUFPTR),@CB00225                         01S0589 01817000
*       CCWPTR=CCWPTR+LENGTH(CCW);  /* NEXT SLOT                     */ 01818000
         ALR   CCWPTR,@10                                       01S0590 01819000
*       CCWPTR->CCW(1)=RCDSCCW;     /* RD CKD,0,SKIP,264             */ 01820000
         MVC   CCW(8,CCWPTR),RCDSCCW                            01S0591 01821000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01822000
         B     CE0001@                                          01S0592 01823000
*     END SD;                       /* END OF SUBCASE                */ 01824000
*                                                               01S0593 01825000
*     /***************************************************************/ 01826000
*     /*                                                             */ 01827000
*     /* CLEANUP: RESTORE CE CYL TRK 1                               */ 01828000
*     /*                                                             */ 01829000
*     /***************************************************************/ 01830000
*                                                               01S0594 01831000
*CLEANUP:                                                       01S0594 01832000
*     DO;                           /* SUBCASE                       */ 01833000
CLEANUP  DS    0H                                               01S0595 01834000
*/*   WRITE RECORD ZERO AND ONE ON CE CYL TRK 1                      */ 01835000
*/*         CCW CHAIN:                                          01S0595 01836000
*                SEEK,AP1CESK,CC,6          SEEK TO CE CYL      01S0595 01837000
*                SRCH HA,AP1CESK,CC,4       VALIDATE ON CORRECT TRK     01838000
*                TIC,*-8                                        01S0595 01839000
*                WRT R0,BUFF,CC,16          WRITE R0            01S0595 01840000
*                WCKD,BUFF+16,0,264         WRITE R1                 */ 01841000
*/*  SETS CECCHH TO CE CYL TRK 1                                     */ 01842000
*                                                               01S0595 01843000
*       IF AP1DEVTP=AP13344 THEN    /* 3344                          */ 01844000
         CLI   AP1DEVTP(AP1REG),3                               01S0595 01845000
         BNE   @RF00595                                         01S0595 01846000
*         CECCHH=I3344CE1;          /* CYL 2800 HD 1                 */ 01847000
         MVC   CECCHH(4,AP1REG),@CB00207                        01S0596 01848000
*       ELSE                        /* NOT 3344                      */ 01849000
*         CECCHH=I3350CE1;          /* CYL 1024 HD 1                 */ 01850000
         B     @RC00595                                         01S0597 01851000
@RF00595 MVC   CECCHH(4,AP1REG),@CB00211                        01S0597 01852000
*       AP1FM=CEHAR0FM;             /* ALL WRITES--CE CYL            */ 01853000
*                                                               01S0598 01854000
@RC00595 MVC   AP1FM(1,AP1REG),CEHAR0FM                         01S0598 01855000
*       /*************************************************************/ 01856000
*       /*                                                           */ 01857000
*       /* AP1SEEK AND A SEEK CCW TO CE CYL SETUP FROM PREVIOUS TEST */ 01858000
*       /*                                                           */ 01859000
*       /*************************************************************/ 01860000
*                                                               01S0599 01861000
*       CCW(2)=SHACCCCW;            /* SEARCH HA EQ,0,CC,4           */ 01862000
         L     @10,AP1CCWA(,AP1REG)                             01S0599 01863000
         MVC   CCW+8(8,@10),SHACCCCW                            01S0599 01864000
*       CCWADDRB(2)=ADDR(CECCHH);   /* ADDRESS OF TRACK              */ 01865000
         LA    @09,CECCHH(,AP1REG)                              01S0600 01866000
         STCM  @09,7,CCWADDRB+8(@10)                            01S0600 01867000
*       CCW(3)=TICCCW;              /* TIC,0,0,0                     */ 01868000
         MVC   CCW+16(8,@10),TICCCW                             01S0601 01869000
*       CCWADDRB(3)=AP1CCWAB+LENGTH(CCW);/* TIC TO SEARCH            */ 01870000
         LA    @09,8                                            01S0602 01871000
         L     @15,AP1CCWAB-1(,AP1REG)                          01S0602 01872000
         LA    @15,0(,@15)                                      01S0602 01873000
         ALR   @15,@09                                          01S0602 01874000
         STCM  @15,7,CCWADDRB+16(@10)                           01S0602 01875000
*       CCW(4)=WR0CCCCW;            /* WRT R0,0,CC,16                */ 01876000
         MVC   CCW+24(8,@10),WR0CCCCW                           01S0603 01877000
*       CCWADDRB(4)=AP1BUFAB;       /* WRITE FROM BUFFER             */ 01878000
         L     @15,AP1BUFAB-1(,AP1REG)                          01S0604 01879000
         LA    @15,0(,@15)                                      01S0604 01880000
         STCM  @15,7,CCWADDRB+24(@10)                           01S0604 01881000
*       CCW(5)=WCDCCW;              /* WCKD,0,0,264                  */ 01882000
         MVC   CCW+32(8,@10),WCDCCW                             01S0605 01883000
*       CCWADDRB(5)=AP1BUFAB+2*LENGTH(CNT);/* WRITE FROM BUFFER      */ 01884000
*                                                               01S0606 01885000
         LA    @14,16                                           01S0606 01886000
         ALR   @15,@14                                          01S0606 01887000
         STCM  @15,7,CCWADDRB+32(@10)                           01S0606 01888000
*       /*************************************************************/ 01889000
*       /*                                                           */ 01890000
*       /* BUILD COUNT AND DATA FOR R0                               */ 01891000
*       /*                                                           */ 01892000
*       /*************************************************************/ 01893000
*                                                               01S0607 01894000
*       AP1BUFAD->CNTCCHHR=CECCHHR; /* CCHHR                         */ 01895000
         L     @10,AP1BUFAD(,AP1REG)                            01S0607 01896000
         MVC   CNTCCHHR(5,@10),CECCHHR(AP1REG)                  01S0607 01897000
*       AP1BUFAD->CNTKDD=DL8;       /* KDD                           */ 01898000
         MVC   CNTKDD(3,@10),@CB00217                           01S0608 01899000
*       EVAL(AP1BUFAD+LENGTH(CNT))->BYTE8=R0DATA;/* DATA FOR R0      */ 01900000
*                                                               01S0609 01901000
         ALR   @09,@10                                          01S0609 01902000
         MVC   BYTE8(8,@09),R0DATA                              01S0609 01903000
*       /*************************************************************/ 01904000
*       /*                                                           */ 01905000
*       /* BUILD COUNT AND DATA FOR R1                               */ 01906000
*       /*                                                           */ 01907000
*       /*************************************************************/ 01908000
*                                                               01S0610 01909000
*       EVAL(AP1BUFAD+2*LENGTH(CNT))->CNTCCHH=CECCHH;/* CCHH         */ 01910000
         LR    @09,@10                                          01S0610 01911000
         ALR   @09,@14                                          01S0610 01912000
         MVC   CNTCCHH(4,@09),CECCHH(AP1REG)                    01S0610 01913000
*       EVAL(AP1BUFAD+2*LENGTH(CNT))->CNTRKDD=R1DL256;/* RKDD        */ 01914000
         ALR   @14,@10                                          01S0611 01915000
         MVC   CNTRKDD(4,@14),@CB00227                          01S0611 01916000
*       EVAL(AP1BUFAD+3*LENGTH(CNT))->BYTE256=R1DATA2;/* DATA2 FOR R1*/ 01917000
         AL    @10,@CF00064                                     01S0612 01918000
         MVC   BYTE256(256,@10),R1DATA2                         01S0612 01919000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01920000
         B     CE0001@                                          01S0613 01921000
*     END CLEANUP;                  /* END OF SUBCASE                */ 01922000
*CE0001@:                                                       01S0615 01923000
*   END;                            /* END OF CASE                   */ 01924000
CE0001@  DS    0H                                               01S0616 01925000
*   GEN DATA DEFS(PATCH);                                       01S0616 01926000
*   END                             /* OF IAPBLDIO PROC              */ 01927000
*                                                               01S0617 01928000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01929000
*/*%INCLUDE SYSLIB  (AP1BLOCK)                                       */ 01930000
*                                                               01S0617 01931000
*       ;                                                       01S0617 01932000
@EL00001 L     @13,4(,@13)                                      01S0617 01933000
@EF00001 DS    0H                                               01S0617 01934000
@ER00001 LM    @14,@12,12(@13)                                  01S0617 01935000
         BR    @14                                              01S0617 01936000
@DATA    DS    0H                                                       01937000
@CH00083 DC    H'5'                                                     01938000
@CH00076 DC    H'7'                                                     01939000
@CH00431 DC    H'10'                                                    01940000
@CH00578 DC    H'1024'                                                  01941000
@CH00592 DC    H'8376'                                                  01942000
@CH00593 DC    H'13038'                                                 01943000
@CH00591 DC    H'19077'                                                 01944000
@DATD    DSECT                                                          01945000
         DS    0F                                                       01946000
@SA00001 DS    18F                                                      01947000
IAPBLDIO CSECT                                                          01948000
         DS    0F                                                       01949000
@CF00043 DC    F'1'                                                     01950000
@CF00058 DC    F'2'                                                     01951000
@CF00038 DC    F'4'                                                     01952000
@CF00155 DC    F'6'                                                     01953000
@CF00047 DC    F'8'                                                     01954000
@CF00033 DC    F'12'                                                    01955000
@CF00049 DC    F'15'                                                    01956000
@CF00167 DC    F'16'                                                    01957000
@CF00589 DC    F'19'                                                    01958000
@CF00064 DC    F'24'                                                    01959000
@CF00244 DC    F'8368'                                                  01960000
@CF00246 DC    F'13030'                                                 01961000
@CF00242 DC    F'19069'                                                 01962000
@CF00595 DC    XL4'0000FFFF'                                            01963000
@DATD    DSECT                                                          01964000
         DS    0D                                                       01965000
IAPBLDIO CSECT                                                          01966000
         NOPR  ((@ENDDATD-@DATD)/257*16)                                01967000
         DS    0F                                                       01968000
@SIZDATD DC    AL1(0)                                                   01969000
         DC    AL3(@ENDDATD-@DATD)                                      01970000
         DS    0D                                                       01971000
@CB00253 DC    X'0000000B000000'                                        01972000
@CB00205 DC    X'0AF00000'                                              01973000
@CB00207 DC    X'0AF00001'                                              01974000
@CB00209 DC    X'04000000'                                              01975000
@CB00211 DC    X'04000001'                                              01976000
@CB00221 DC    X'01000000'                                              01977000
@CB00223 DC    X'02000000'                                              01978000
@CB00225 DC    X'00000008'                                              01979000
@CB00227 DC    X'01000100'                                              01980000
@CB00256 DC    X'00010000'                                              01981000
@CB00555 DC    X'00040000'                                              01982000
@CB00556 DC    X'00000000'                                              01983000
@CB00217 DC    X'000008'                                                01984000
@CB00219 EQU   @CB00555                                                 01985000
@CB00213 DC    X'0AF4'                                                  01986000
@CB00215 DC    X'0012'                                                  01987000
@CB00233 DC    X'001D'                                                  01988000
@CB00235 DC    X'000B'                                                  01989000
@CB00248 DC    X'00C0'                                                  01990000
@CB00250 DC    X'0120'                                                  01991000
@CB00557 EQU   @CB00256                                                 01992000
@CB00558 DC    X'000A'                                                  01993000
@CB00571 EQU   @CB00253                                                 01994000
R0DL565  DC    X'00000235'                                              01995000
R0DL839  DC    X'00000347'                                              01996000
ZERO     DC    X'0000000000000000'                                      01997000
SPCCCCCW DC    X'0F00000040000003'                                      01998000
SNSCCW   DC    X'0400000020000018'                                      01999000
SEEKCCW  DC    X'0700000040000006'                                      02000000
RHASKCCW DC    X'1A00000010000005'                                      02001000
RECALCCW DC    X'1300000060000001'                                      02002000
SSCCCCW  DC    X'2300000040000001'                                      02003000
RSCCCCW  DC    X'2200000040000001'                                      02004000
RHACSCCW DC    X'1A00000050000005'                                      02005000
SHACCCCW DC    X'3900000040000004'                                      02006000
WR0CCCCW DC    X'1500000040000010'                                      02007000
WCDCCW   DC    X'1D00000000000108'                                      02008000
RR0CSCCW DC    X'1600000050000010'                                      02009000
RCDCSCCW DC    X'1E00000050000108'                                      02010000
RR0CCCCW DC    X'1600000040000010'                                      02011000
MRCCCCCW DC    X'9200000040000008'                                      02012000
RCCCW    DC    X'1200000000000008'                                      02013000
TICCCW   DC    X'0800000000000000'                                      02014000
WCDCDCCW DC    X'1D00000080000008'                                      02015000
WCDCCCCW DC    X'1D00000040000108'                                      02016000
RCDSCCW  DC    X'1E00000010000108'                                      02017000
SIDCCCCW DC    X'3100000040000005'                                      02018000
RCCSCCW  DC    X'1200000050000008'                                      02019000
WHACCCCW DC    X'190000004000000B'                                      02020000
NOPCCCCW DC    X'0300000040000001'                                      02021000
RHACCW   DC    X'1A00000000000005'                                      02022000
NOPCCW   DC    X'0300000000000001'                                      02023000
READFM   DC    X'40'                                                    02024000
CEREADFM DC    X'44'                                                    02025000
CEHAR0FM DC    X'C4'                                                    02026000
CEFM     DC    X'04'                                                    02027000
R1DATA1  DS    CL256                                                    02028000
         ORG   R1DATA1                                                  02029000
@NM00011 DS    CL64                                                     02030000
         ORG   @NM00011                                                 02031000
@NM00012 DC    8X'EB6DB6DB'                                             02032000
         DC    2X'FFFFFFFF'                                             02033000
         DC    2X'AAAAAAAA'                                             02034000
         DC    2X'FFFFFFFF'                                             02035000
         DC    2X'AAAAAAAA'                                             02036000
         ORG   R1DATA1+64                                               02037000
@NM00013 DS    CL64                                                     02038000
         ORG   @NM00013                                                 02039000
@NM00014 DC    8X'EB6DB6DB'                                             02040000
         DC    2X'FFFFFFFF'                                             02041000
         DC    2X'AAAAAAAA'                                             02042000
         DC    2X'FFFFFFFF'                                             02043000
         DC    2X'AAAAAAAA'                                             02044000
         ORG   R1DATA1+128                                              02045000
@NM00015 DS    CL64                                                     02046000
         ORG   @NM00015                                                 02047000
@NM00016 DC    8X'EB6DB6DB'                                             02048000
         DC    2X'FFFFFFFF'                                             02049000
         DC    2X'AAAAAAAA'                                             02050000
         DC    2X'FFFFFFFF'                                             02051000
         DC    2X'AAAAAAAA'                                             02052000
         ORG   R1DATA1+192                                              02053000
@NM00017 DS    CL64                                                     02054000
         ORG   @NM00017                                                 02055000
@NM00018 DC    8X'EB6DB6DB'                                             02056000
         DC    2X'FFFFFFFF'                                             02057000
         DC    2X'AAAAAAAA'                                             02058000
         DC    2X'FFFFFFFF'                                             02059000
         DC    2X'AAAAAAAA'                                             02060000
         ORG   R1DATA1+256                                              02061000
R1DATA2  DS    CL256                                                    02062000
         ORG   R1DATA2                                                  02063000
@NM00019 DC    X'AAAAAAAAAAAAAAAAAAAA'                                  02064000
@NM00020 DC    15X'FFFFFFFFFFFFFFFFAAAAAAAAAAAAAAAA'                    02065000
@NM00021 DC    X'FFFFFFFFFFFF'                                          02066000
         ORG   R1DATA2+256                                              02067000
SDR03344 DS    CL565                                                    02068000
         ORG   SDR03344                                                 02069000
@NM00022 DC    X'00'                                                    02070000
         DC    XL7'0'                                                   02071000
@NM00023 DC    X'FFFFFFFFFFFF'                                          02072000
@NM00024 DC    X'00'                                                    02073000
         DC    XL71'0'                                                  02074000
@NM00025 DC    X'19'                                                    02075000
@NM00026 DC    X'0035'                                                  02076000
@NM00027 DC    X'3081'                                                  02077000
@NM00028 DC    X'20'                                                    02078000
@NM00029 DC    X'0AF00001'                                              02079000
@NM00030 DC    X'01000100'                                              02080000
@NM00031 DC    X'1930493ACC2D'                                          02081000
@NM00032 DC    X'00'                                                    02082000
         DC    XL67'0'                                                  02083000
@NM00033 DC    X'19'                                                    02084000
@NM00034 DC    X'AAAAAAAAAAAAAAAAAAAA'                                  02085000
@NM00035 DC    2X'FFFFFFFFFFFFFFFFAAAAAAAAAAAAAAAA'                     02086000
@NM00036 DC    X'FFFFFFFFFFFFFFFFAAAAAA'                                02087000
@NM00037 DC    X'00'                                                    02088000
         DC    XL126'0'                                                 02089000
@NM00038 DC    X'19'                                                    02090000
@NM00039 DC    X'AAAAAAAAAA'                                            02091000
@NM00040 DC    12X'FFFFFFFFFFFFFFFFAAAAAAAAAAAAAAAA'                    02092000
@NM00041 DC    X'FFFFFFFFFFFF'                                          02093000
@NM00042 DC    X'1A112E0FD408'                                          02094000
         ORG   SDR03344+565                                             02095000
SDR03350 DS    CL839                                                    02096000
         ORG   SDR03350                                                 02097000
@NM00043 DC    X'00'                                                    02098000
         DC    XL7'0'                                                   02099000
@NM00044 DC    X'FFFFFFFFFFFF'                                          02100000
@NM00045 DC    X'800000'                                                02101000
@NM00046 DC    X'00'                                                    02102000
         DC    XL74'0'                                                  02103000
@NM00047 DC    X'19'                                                    02104000
@NM00048 DC    X'00BD00BD8088'                                          02105000
@NM00049 DC    X'023002'                                                02106000
@NM00050 DC    X'20'                                                    02107000
@NM00051 DC    X'04000001'                                              02108000
@NM00052 DC    X'01000100'                                              02109000
@NM00053 DC    X'D6AFF9022805'                                          02110000
@NM00054 DC    X'8156C0'                                                02111000
@NM00055 DC    X'00'                                                    02112000
         DC    XL72'0'                                                  02113000
@NM00056 DC    X'00'                                                    02114000
         DC    XL126'0'                                                 02115000
@NM00057 DC    X'19'                                                    02116000
@NM00058 DC    X'AAAAAAAAAAAAAAAAAAAA'                                  02117000
@NM00059 DC    3X'FFFFFFFFFFFFFFFFAAAAAAAAAAAAAAAA'                     02118000
@NM00060 DC    X'FFFFFFFF'                                              02119000
@NM00061 DC    X'00'                                                    02120000
         DC    XL126'0'                                                 02121000
@NM00062 DC    X'19'                                                    02122000
@NM00063 DC    X'FFFFFFFFAAAAAAAAAAAAAAAA'                              02123000
@NM00064 DC    3X'FFFFFFFFFFFFFFFFAAAAAAAAAAAAAAAA'                     02124000
@NM00065 DC    X'FF'                                                    02125000
@NM00066 DC    X'00'                                                    02126000
         DC    XL126'0'                                                 02127000
@NM00067 DC    X'19'                                                    02128000
@NM00068 DC    X'FFFFFFFFFFFFFFAAAAAAAAAAAAAAAA'                        02129000
@NM00069 DC    7X'FFFFFFFFFFFFFFFFAAAAAAAAAAAAAAAA'                     02130000
@NM00070 DC    X'FFFFFFFFFFFF'                                          02131000
@NM00071 DC    X'1A112E0FD408'                                          02132000
         ORG   SDR03350+839                                             02133000
RANTBL   DC    H'10480'                                                 02134000
         DC    H'15011'                                                 02135000
         DC    H'1536'                                                  02136000
         DC    H'2011'                                                  02137000
         DC    H'14194'                                                 02138000
         DC    H'20969'                                                 02139000
         DC    H'22368'                                                 02140000
         DC    H'25595'                                                 02141000
         DC    H'30995'                                                 02142000
         DC    H'27982'                                                 02143000
         DC    H'19174'                                                 02144000
         DC    H'24130'                                                 02145000
         DC    H'22527'                                                 02146000
         DC    H'15179'                                                 02147000
         DC    H'24830'                                                 02148000
         DC    H'32081'                                                 02149000
         DC    H'30680'                                                 02150000
         DC    H'19655'                                                 02151000
         DC    H'6243'                                                  02152000
         DC    H'7856'                                                  02153000
         DC    H'16376'                                                 02154000
         DC    H'849'                                                   02155000
         DC    H'16379'                                                 02156000
         DC    H'16656'                                                 02157000
         DC    H'6121'                                                  02158000
         DC    H'14110'                                                 02159000
         DC    H'6927'                                                  02160000
         DC    H'1263'                                                  02161000
         DC    H'6907'                                                  02162000
         DC    H'11008'                                                 02163000
         DC    H'27756'                                                 02164000
         DC    H'18602'                                                 02165000
         DC    H'15053'                                                 02166000
         DC    H'21916'                                                 02167000
         DC    H'31016'                                                 02168000
         DC    H'18738'                                                 02169000
         DC    H'21069'                                                 02170000
         DC    H'10634'                                                 02171000
         DC    H'12952'                                                 02172000
         DC    H'5463'                                                  02173000
         DC    H'7972'                                                  02174000
         DC    H'18876'                                                 02175000
         DC    H'20922'                                                 02176000
         DC    H'18425'                                                 02177000
         DC    H'32307'                                                 02178000
         DC    H'14342'                                                 02179000
         DC    H'10281'                                                 02180000
         DC    H'17453'                                                 02181000
         DC    H'18103'                                                 02182000
         DC    H'25331'                                                 02183000
CP0001@  DC    AL4(RECAL)                                               02184000
         DC    AL4(SNS)                                                 02185000
         DC    AL4(RECAL)                                               02186000
         DC    AL4(RHAMHS)                                              02187000
         DC    AL4(RHAMH)                                               02188000
         DC    AL4(RHAFHS)                                              02189000
         DC    AL4(RHAFH)                                               02190000
         DC    AL4(RPS)                                                 02191000
         DC    AL4(SK192)                                               02192000
         DC    AL4(SKINCR)                                              02193000
         DC    AL4(SKMAX)                                               02194000
         DC    AL4(SKRANS)                                              02195000
         DC    AL4(SKRAN)                                               02196000
         DC    AL4(RHAS)                                                02197000
         DC    AL4(CE)                                                  02198000
         DC    AL4(WRTS)                                                02199000
         DC    AL4(CE)                                                  02200000
         DC    AL4(RR01S)                                               02201000
         DC    AL4(CE)                                                  02202000
         DC    AL4(RDMT)                                                02203000
         DC    AL4(FTWRT)                                               02204000
         DC    AL4(AMDET)                                               02205000
         DC    AL4(WRTPAD)                                              02206000
         DC    AL4(SD)                                                  02207000
         DC    AL4(CLEANUP)                                             02208000
IAPBLDIO CSECT                                                          02209000
*                                /*  PATCH AREA  */                     02210000
         CNOP  0,4               FULLWORD BDWY                          02211000
PATCH    DC    2XL((*-@MAINENT)/40)'0' FIVE PERCENT.                    02212000
@DATD    DSECT                                                          02213000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02214000
@ENDDATD EQU   *                                                        02215000
IAPBLDIO CSECT                                                          02216000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02217000
@01      EQU   01                                                       02218000
@02      EQU   02                                                       02219000
@03      EQU   03                                                       02220000
@04      EQU   04                                                       02221000
@05      EQU   05                                                       02222000
@06      EQU   06                                                       02223000
@07      EQU   07                                                       02224000
@08      EQU   08                                                       02225000
@09      EQU   09                                                       02226000
@10      EQU   10                                                       02227000
@11      EQU   11                                                       02228000
@12      EQU   12                                                       02229000
@13      EQU   13                                                       02230000
@14      EQU   14                                                       02231000
@15      EQU   15                                                       02232000
COUNTER  EQU   @02                                                      02233000
CCWPTR   EQU   @06                                                      02234000
BUFPTR   EQU   @07                                                      02235000
AP1REG   EQU   @08                                                      02236000
GPR00P   EQU   @00                                                      02237000
GPR01F   EQU   @01                                                      02238000
GPR14P   EQU   @14                                                      02239000
GPR15F   EQU   @15                                                      02240000
GPR13P   EQU   @13                                                      02241000
GPR15P   EQU   @15                                                      02242000
AP1BLOCK EQU   0                                                        02243000
AP1PRINT EQU   AP1BLOCK+8                                               02244000
AP1PFLG1 EQU   AP1BLOCK+144                                             02245000
AP1WRKA  EQU   AP1BLOCK+156                                             02246000
AP1CCWA  EQU   AP1BLOCK+160                                             02247000
AP1CCWAB EQU   AP1CCWA+1                                                02248000
AP1BUFAD EQU   AP1BLOCK+164                                             02249000
AP1BUFAB EQU   AP1BUFAD+1                                               02250000
AP1TIMFL EQU   AP1BLOCK+176                                             02251000
AP1TIMFA EQU   AP1TIMFL                                                 02252000
AP1FM    EQU   AP1BLOCK+212                                             02253000
AP1SEEK  EQU   AP1BLOCK+213                                             02254000
CCHHR    EQU   AP1SEEK+3                                                02255000
CCHH     EQU   CCHHR                                                    02256000
CC       EQU   CCHH                                                     02257000
HH       EQU   CCHH+2                                                   02258000
AP1CESK  EQU   AP1BLOCK+221                                             02259000
CECCHHR  EQU   AP1CESK+2                                                02260000
CECCHH   EQU   CECCHHR                                                  02261000
CECC     EQU   CECCHH                                                   02262000
CEHH     EQU   CECCHH+2                                                 02263000
CER      EQU   CECCHHR+4                                                02264000
AP1FLG2  EQU   AP1BLOCK+244                                             02265000
AP1FHF   EQU   AP1FLG2                                                  02266000
AP1FLG3  EQU   AP1BLOCK+245                                             02267000
AP1PTRN2 EQU   AP1FLG3                                                  02268000
AP1FLG4  EQU   AP1BLOCK+246                                             02269000
AP1TSTNO EQU   AP1BLOCK+249                                             02270000
AP1DEVTP EQU   AP1BLOCK+250                                             02271000
AP1ETABA EQU   AP1BLOCK+252                                             02272000
AP1SKCNT EQU   AP1BLOCK+256                                             02273000
AP1LSTCC EQU   AP1BLOCK+258                                             02274000
AP1ERRTM EQU   AP1BLOCK+270                                             02275000
AP1ERRTF EQU   AP1BLOCK+300                                             02276000
AP1END   EQU   AP1BLOCK+360                                             02277000
ERRTAB   EQU   0                                                        02278000
CCW      EQU   0                                                        02279000
CCWADDRA EQU   CCW                                                      02280000
CCWCOMCD EQU   CCWADDRA                                                 02281000
@NM00005 EQU   CCWCOMCD                                                 02282000
CCWADDRB EQU   CCWADDRA+1                                               02283000
CCWFLGS  EQU   CCW+4                                                    02284000
CCWCC    EQU   CCWFLGS                                                  02285000
CCWSKIP  EQU   CCWFLGS                                                  02286000
CCWBYTE  EQU   CCW+6                                                    02287000
WRKAREA  EQU   0                                                        02288000
WRKAD    EQU   WRKAREA                                                  02289000
WRKFLG   EQU   WRKAD                                                    02290000
BYTE1    EQU   0                                                        02291000
BYTE4    EQU   0                                                        02292000
BYTE6    EQU   0                                                        02293000
BYTE8    EQU   0                                                        02294000
BYTE24   EQU   0                                                        02295000
BYTE112  EQU   0                                                        02296000
BYTE256  EQU   0                                                        02297000
SEEK     EQU   0                                                        02298000
SEEKCCHH EQU   SEEK+2                                                   02299000
SEEKCC   EQU   SEEKCCHH                                                 02300000
SEEKHH   EQU   SEEKCCHH+2                                               02301000
CNT      EQU   0                                                        02302000
CNTCCHHR EQU   CNT                                                      02303000
CNTCCHH  EQU   CNTCCHHR                                                 02304000
CNTHH    EQU   CNTCCHH+2                                                02305000
CNTR     EQU   CNTCCHHR+4                                               02306000
CL0001@  EQU   0                                                        02307000
BUFFER   EQU   0                                                        02308000
@NM00008 EQU   WRKAREA                                                  02309000
ZERO7    EQU   ZERO                                                     02310000
CNTRKDD  EQU   CNTR                                                     02311000
CNTKDD   EQU   CNTRKDD+1                                                02312000
CNTDD    EQU   CNTKDD+1                                                 02313000
SDZERO   EQU   ZERO                                                     02314000
R0DATA   EQU   ZERO                                                     02315000
CNTHHR   EQU   CNTHH                                                    02316000
HHR      EQU   HH                                                       02317000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02318000
CNTK     EQU   CNTKDD                                                   02319000
@NM00010 EQU   CNTRKDD                                                  02320000
WRKHW2   EQU   @NM00008+2                                               02321000
WRKHW1   EQU   @NM00008                                                 02322000
@NM00009 EQU   CNT+5                                                    02323000
CNTCC    EQU   CNTCCHH                                                  02324000
SEEKR    EQU   SEEK+6                                                   02325000
SEEKBB   EQU   SEEK                                                     02326000
WRKAB    EQU   WRKAD+1                                                  02327000
WRKENDFL EQU   WRKFLG                                                   02328000
@NM00007 EQU   CCW+5                                                    02329000
CCWPCI   EQU   CCWFLGS                                                  02330000
CCWSLI   EQU   CCWFLGS                                                  02331000
CCWCD    EQU   CCWFLGS                                                  02332000
CCWWR    EQU   @NM00005                                                 02333000
CCWRD    EQU   @NM00005                                                 02334000
@NM00006 EQU   @NM00005                                                 02335000
DATACOMP EQU   ERRTAB                                                   02336000
DCKCE    EQU   ERRTAB                                                   02337000
WRTCK    EQU   ERRTAB                                                   02338000
SKVERCK  EQU   ERRTAB                                                   02339000
DCK      EQU   ERRTAB                                                   02340000
AP1ENQAD EQU   AP1BLOCK+266                                             02341000
AP1DEVAD EQU   AP1BLOCK+262                                             02342000
AP1LSTHH EQU   AP1BLOCK+260                                             02343000
AP1RET   EQU   AP1BLOCK+251                                             02344000
AP1DCCNT EQU   AP1BLOCK+248                                             02345000
@NM00004 EQU   AP1BLOCK+247                                             02346000
AP1ENQD  EQU   AP1FLG4                                                  02347000
AP1DEBCH EQU   AP1FLG4                                                  02348000
AP1READ  EQU   AP1FLG4                                                  02349000
AP1NORD  EQU   AP1FLG4                                                  02350000
AP1RDERR EQU   AP1FLG3                                                  02351000
AP1RDTST EQU   AP1FLG3                                                  02352000
AP1VERIF EQU   AP1FLG3                                                  02353000
AP1QUIT  EQU   AP1FLG3                                                  02354000
AP1PRERR EQU   AP1FLG3                                                  02355000
AP1ERROR EQU   AP1FLG3                                                  02356000
AP1LST   EQU   AP1FLG3                                                  02357000
AP1NOERP EQU   AP1FLG2                                                  02358000
AP1EDP   EQU   AP1FLG2                                                  02359000
AP1IOC   EQU   AP1FLG2                                                  02360000
AP1NOWR  EQU   AP1FLG2                                                  02361000
AP1IOECB EQU   AP1BLOCK+240                                             02362000
AP1IOBA  EQU   AP1BLOCK+236                                             02363000
AP1DEBA  EQU   AP1BLOCK+232                                             02364000
AP1DCBA  EQU   AP1BLOCK+228                                             02365000
CEBB     EQU   AP1CESK                                                  02366000
R        EQU   CCHHR+4                                                  02367000
BB       EQU   AP1SEEK+1                                                02368000
M        EQU   AP1SEEK                                                  02369000
AP1SNS   EQU   AP1BLOCK+188                                             02370000
AP1CSW   EQU   AP1BLOCK+181                                             02371000
AP1PCODE EQU   AP1BLOCK+180                                             02372000
AP1TIMIN EQU   AP1TIMFA                                                 02373000
AP1IOACT EQU   AP1TIMFA                                                 02374000
AP1TCBAD EQU   AP1BLOCK+172                                             02375000
AP1TIMEA EQU   AP1BLOCK+168                                             02376000
@NM00003 EQU   AP1BUFAD                                                 02377000
@NM00002 EQU   AP1CCWA                                                  02378000
AP1RECB  EQU   AP1BLOCK+152                                             02379000
@NM00001 EQU   AP1BLOCK+150                                             02380000
AP1CNRPL EQU   AP1BLOCK+146                                             02381000
AP1CNCOD EQU   AP1BLOCK+145                                             02382000
AP1PRCLS EQU   AP1PFLG1                                                 02383000
AP1PRNP  EQU   AP1PFLG1                                                 02384000
AP1PROPN EQU   AP1PFLG1                                                 02385000
AP1PRLIN EQU   AP1BLOCK+142                                             02386000
AP1PRPAG EQU   AP1BLOCK+140                                             02387000
AP1PRCOD EQU   AP1BLOCK+139                                             02388000
AP1PRMSG EQU   AP1PRINT+1                                               02389000
AP1PRASA EQU   AP1PRINT                                                 02390000
AP1PDCBA EQU   AP1BLOCK+4                                               02391000
AP1HDR   EQU   AP1BLOCK                                                 02392000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02393000
@RC00137 EQU   CE0001@                                                  02394000
@RC00127 EQU   CE0001@                                                  02395000
@RC00167 EQU   @RC00166                                                 02396000
@RC00175 EQU   @RC00174                                                 02397000
@RC00183 EQU   @RC00182                                                 02398000
@RC00245 EQU   @RC00244                                                 02399000
@RC00321 EQU   @RC00318                                                 02400000
@RC00439 EQU   CE0001@                                                  02401000
@RC00433 EQU   CE0001@                                                  02402000
@RC00128 EQU   @RC00127                                                 02403000
@RC00138 EQU   @RC00137                                                 02404000
@RC00322 EQU   @RC00321                                                 02405000
@ENDDATA EQU   *                                                        02406000
         END   IAPBLDIO,(C'PLS1717',0701,77308)                         02407000
./  ADD  SSI=73080182,NAME=IAPCHKIO
         TITLE 'IAPCHKIO - AP-1 CHECK ROUTINE                          *00001000
                        '                                               00002000
IAPCHKIO CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(16)                                          01S0001 00007000
         DC    C'IAPCHKIO  77.308'                              01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @11,0                                            01S0001 00011000
@PSTART  LA    @12,4095(,@11)                                   01S0001 00012000
         USING @PSTART,@11                                      01S0001 00013000
         USING @PSTART+4095,@12                                 01S0001 00014000
*                                                               01S0091 00015000
         USING @DATD+AP1BLOCK-AP1END,AP1REG  ADDRESSABILITY             00016000
         ST    13,@SA00001+4     BACKWARD POINTER                       00017000
         LA    15,@SA00001       OUR SAVE AREA                          00018000
         ST    15,8(,13)         FOREWARD POINTER                       00019000
         LR     13,15            SET REG 13                             00020000
*   /*****************************************************************/ 00021000
*   /*                                                               */ 00022000
*   /* SELECT CHECK ROUTINE BASED ON AP1TSTNO                        */ 00023000
*   /*                                                               */ 00024000
*   /*****************************************************************/ 00025000
*                                                               01S0092 00026000
*   DO;                             /* CASE(AP1TSTNO)NAMES(RECAL1,SNS   00027000
*                                      ,RECAL2,RET,RHAMH,RET,RHAFH,RP   00028000
*                                      S,SK192,SKINCR,SKMAX,RET,SKRAN   00029000
*                                      ,RET,RHA,RET,WRT,RET,RR01,RDMT   00030000
*                                      ,FTWRT,AMDET,WRTPAD,SD,CLEANUP   00031000
*                                      )                             */ 00032000
*     DCL                                                       01S0093 00033000
*       CL0001@ LABEL BASED(CP0001@(AP1TSTNO)) VALUERANGE(RECAL1,SNS,   00034000
*           RECAL2,RET,RHAMH,RET,RHAFH,RPS,SK192,SKINCR,SKMAX,RET,SKRAN 00035000
*           ,RET,RHA,RET,WRT,RET,RR01,RDMT,FTWRT,AMDET,WRTPAD,SD,       00036000
*           CLEANUP);               /* BRANCH TARGET                 */ 00037000
*     DCL                                                       01S0094 00038000
*       CP0001@(25) PTR(31) INIT(ADDR(RECAL1),ADDR(SNS),ADDR(RECAL2),   00039000
*           ADDR(RET),ADDR(RHAMH),ADDR(RET),ADDR(RHAFH),ADDR(RPS),ADDR( 00040000
*           SK192),ADDR(SKINCR),ADDR(SKMAX),ADDR(RET),ADDR(SKRAN),ADDR( 00041000
*           RET),ADDR(RHA),ADDR(RET),ADDR(WRT),ADDR(RET),ADDR(RR01),    00042000
*           ADDR(RDMT),ADDR(FTWRT),ADDR(AMDET),ADDR(WRTPAD),ADDR(SD),   00043000
*           ADDR(CLEANUP));                                     01S0094 00044000
*     GOTO CL0001@;                 /* BRANCH TO SELECTED CASE       */ 00045000
*                                                               01S0095 00046000
         SLR   @10,@10                                          01S0095 00047000
         IC    @10,AP1TSTNO(,AP1REG)                            01S0095 00048000
         SLA   @10,2                                            01S0095 00049000
         L     @10,CP0001@-4(@10)                               01S0095 00050000
         BR    @10                                              01S0095 00051000
*     /***************************************************************/ 00052000
*     /*                                                             */ 00053000
*     /* RET: ABENDS--WILL NOT BE ENTERED EXCEPT ON INVALID VALUE OF */ 00054000
*     /* AP1TSTNO                                                    */ 00055000
*     /*                                                             */ 00056000
*     /***************************************************************/ 00057000
*                                                               01S0096 00058000
*RET:                                                           01S0096 00059000
*     DO;                           /* SUBCASE RETURNS (BR14)        */ 00060000
RET      DS    0H                                               01S0097 00061000
*       DO;                         /* ABEND(1004) DUMP STEP USER    */ 00062000
*         RESPECIFY                                             01S0098 00063000
*          (GPR01F) RESTRICTED;                                 01S0098 00064000
*         GPR01F=(1004)&'00000FFF'X;/* COMP CODE IN BITS 20-31       */ 00065000
         LA    GPR01F,1004                                      01S0099 00066000
*         GPR01F=GPR01F|'C0000000'X;/* DUMP/STEP/DUMPOPTS FLAG       */ 00067000
         O     GPR01F,@CF00415                                  01S0100 00068000
*         SVC(13);                  /* ISSUE ABEND SVC               */ 00069000
         SVC   13                                               01S0101 00070000
*         RESPECIFY                                             01S0102 00071000
*          (GPR01F) UNRESTRICTED;                               01S0102 00072000
*       END;                        /* ABEND(1004) DUMP STEP USER       00073000
*                                      U1004 ABEND                   */ 00074000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00075000
         B     CE0001@                                          01S0104 00076000
*     END RET;                      /* END OF SUBCASE                */ 00077000
*                                                               01S0105 00078000
*     /***************************************************************/ 00079000
*     /*                                                             */ 00080000
*     /* RECAL1: DUMMY RECALIBRATE                                   */ 00081000
*     /*                                                             */ 00082000
*     /***************************************************************/ 00083000
*                                                               01S0106 00084000
*RECAL1:                                                        01S0106 00085000
*     DO;                           /* SUBCASE CHECKS FIRST     01S0106 00086000
*                                      RECALIBRATE-- IGNORED         */ 00087000
RECAL1   DS    0H                                               01S0107 00088000
*/*   IGNORES STATUS                                                 */ 00089000
*                                                               01S0107 00090000
*       AP1TSTNO=AP1TSTNO+1;        /* IGNORE RESULT--GO TO NXT TEST */ 00091000
         LA    @10,1                                            01S0107 00092000
         SLR   @09,@09                                          01S0107 00093000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0107 00094000
         ALR   @10,@09                                          01S0107 00095000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0107 00096000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00097000
         B     CE0001@                                          01S0108 00098000
*     END RECAL1;                   /* END OF SUBCASE                */ 00099000
*                                                               01S0109 00100000
*     /***************************************************************/ 00101000
*     /*                                                             */ 00102000
*     /* SNS: SENSE TO SEE IF EMULATED AND FIXED HEADS               */ 00103000
*     /*                                                             */ 00104000
*     /***************************************************************/ 00105000
*                                                               01S0110 00106000
*SNS:                                                           01S0110 00107000
*     DO;                           /* SUBCASE CHECKS SENSE          */ 00108000
SNS      DS    0H                                               01S0111 00109000
*/*   TESTS TO SEE IF A 3350, E-3340 OR E-3330                  01S0111 00110000
*       ENQS ON BASE ADDRESS                                    01S0111 00111000
*       CHECKS FOR FIXED HEADS ON 3344                               */ 00112000
*                                                               01S0111 00113000
*       IF AP1PCODEÂ¬=NRMC THEN      /* ERROR ON I/O                  */ 00114000
         CLI   AP1PCODE(AP1REG),X'7F'                           01S0111 00115000
         BE    @RF00111                                         01S0111 00116000
*         AP1PRERR=ON;              /* INDICATE ERROR                */ 00117000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0112 00118000
*       ELSE                                                    01S0113 00119000
*         ;                         /* I/O OK                        */ 00120000
@RF00111 DS    0H                                               01S0114 00121000
*       IF AP1PRERR=OFF THEN        /* SNS WENT OK                   */ 00122000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0114 00123000
         BNZ   @RF00114                                         01S0114 00124000
*         DO;                                                   01S0115 00125000
*           IF AP1DEVTPÂ¬=AP13350 THEN/* NOT 3350--MUST BE EMULATED      00126000
*                                      DEV                           */ 00127000
         CLI   AP1DEVTP(AP1REG),4                               01S0116 00128000
         BE    @RF00116                                         01S0116 00129000
*             IF AP1BUFAD->SNSEMU=ON THEN/* EMULATED                 */ 00130000
         L     @10,AP1BUFAD(,AP1REG)                            01S0117 00131000
         TM    SNSEMU(@10),B'00001000'                          01S0117 00132000
         BNO   @RF00117                                         01S0117 00133000
*               DO;                                             01S0118 00134000
*                                                               01S0118 00135000
*                 /***************************************************/ 00136000
*                 /*                                                 */ 00137000
*                 /* GET EBCDIC OF BASE ADDRESS                      */ 00138000
*                 /*                                                 */ 00139000
*                 /***************************************************/ 00140000
*                                                               01S0119 00141000
*                 RFY                                           01S0119 00142000
*                  (GPR00F,                                     01S0119 00143000
*                   GPR01P) RSTD;                               01S0119 00144000
*                 GPR01P=ADDR(AP1DEVAD);/* ADDR OF DEV ADDR IN EBCDIC*/ 00145000
         LA    GPR01P,AP1DEVAD(,AP1REG)                         01S0120 00146000
*                 RFY                                           01S0121 00147000
*                  (GPR00F,                                     01S0121 00148000
*                   GPR01P) UNRSTD;                             01S0121 00149000
*                                                               02S0122 00150000
*                 /***************************************************/ 00151000
*                 /*                                                 */ 00152000
*                 /* CONVERTS EBCDIC TO BINARY REG1 POINTS TO FULL   */ 00153000
*                 /* WORD OF EBCDIC (HEX)..REG0 RETURNED WITH BINARY */ 00154000
*                 /* VALUE                                           */ 00155000
*                 /*                                                 */ 00156000
*                 /***************************************************/ 00157000
*                                                               02S0122 00158000
*                 RFY                                           02S0122 00159000
*                  (GPR00F,                                     02S0122 00160000
*                   GPR01P,                                     02S0122 00161000
*                   GPR02F,                                     02S0122 00162000
*                   GPR03F) RSTD;                               02S0122 00163000
*                 GENERATE REFS(ALPHACNV,ALPHACV2);             02S0123 00164000
*                     INPUT =    FWFXFYFZ                               00165000
         SLR   @00,@00           CLEAR REG                              00166000
         LA    @02,4             LOOP COUNT                             00167000
LOOPBIN  SLR   @03,@03           CLEAR REG                              00168000
         IC    @03,0(@01)        GET CHAR                               00169000
         CLI   0(@01),X'F0'      IS IT ALPHA                            00170000
         BL    ALPHA                                                    00171000
         SH    @03,ALPHACNV      F0-B7                                  00172000
ALPHA    SH    @03,ALPHACV2      C1-A                                   00173000
         SLL   @00,4             SAVE LAST BYTE                         00174000
         AR    @00,@03           PUT IN NEW BYTE                        00175000
         LA    @01,1(@01)        INCR TO NEXT BYTE                      00176000
         BCT   @02,LOOPBIN       GET THE REST                           00177000
*                 RFY                                           02S0124 00178000
*                  (GPR00F,                                     02S0124 00179000
*                   GPR01P,                                     02S0124 00180000
*                   GPR02F,                                     02S0124 00181000
*                   GPR03F) UNRSTD;                             02S0124 00182000
*                 RFY                                           01S0125 00183000
*                  (GPR00F,                                     01S0125 00184000
*                   GPR01P) RSTD;                               01S0125 00185000
*                 IF AP1DEVTP<=AP13331 THEN/* 3330                   */ 00186000
         CLI   AP1DEVTP(AP1REG),2                               01S0126 00187000
         BH    @RF00126                                         01S0126 00188000
*                   GPR00F=GPR00F&'00000FDF'X;/* GET BASE ADDR       */ 00189000
         N     GPR00F,@CF00420                                  01S0127 00190000
*                 ELSE              /* 3344                          */ 00191000
*                   DO;                                         01S0128 00192000
         B     @RC00126                                         01S0128 00193000
@RF00126 DS    0H                                               01S0129 00194000
*                     GPR01P=AP1WRKA;/* ADDR FOR ID                  */ 00195000
         L     GPR01P,AP1WRKA(,AP1REG)                          01S0129 00196000
*                     GEN REFS(AP1WRKA) SETS(GPR01P,WRKAREA);   01S0130 00197000
                   STIDP 0(GPR01P)  STORE CALL ID                       00198000
*                     IF WRKHW1(2)='0135'X THEN/* ON MODEL 135 CPU   */ 00199000
         L     @10,AP1WRKA(,AP1REG)                             01S0131 00200000
         CLC   WRKHW1+4(2,@10),@CH00421                         01S0131 00201000
         BNE   @RF00131                                         01S0131 00202000
*                       GPR00F='3135'X;/* ENQ FOR 135 CPU            */ 00203000
         L     GPR00F,@CF00422                                  01S0132 00204000
*                     ELSE          /* NOT ON MODEL 135 CPU          */ 00205000
*                       DO;                                     01S0133 00206000
         B     @RC00131                                         01S0133 00207000
@RF00131 DS    0H                                               01S0134 00208000
*                         CCUSAV=GPR00F&'00000FC0'X;/* SAVE CU ADDR  */ 00209000
         LR    CCUSAV,GPR00F                                    01S0134 00210000
         N     CCUSAV,@CF00423                                  01S0134 00211000
*                         GPR00F=GPR00F&'0000003F'X;/* REMOVE CU ADDR*/ 00212000
         N     GPR00F,@CF00424                                  01S0135 00213000
*                         TBLPTR=ADDR(TBL3344);/* POINT TO 3344 01S0136 00214000
*                                      ADDRESS TABLE                 */ 00215000
         LA    TBLPTR,TBL3344                                   01S0136 00216000
*                         DO WHILE TBLPTR->BYTE1Â¬=GPR00F&TBLPTR->BYTE1  00217000
*                               Â¬=0;/* UNTIL OUR ADDRESS FOUND OR END   00218000
*                                      OF TABLE                      */ 00219000
         B     @DE00137                                         01S0137 00220000
@DL00137 DS    0H                                               01S0138 00221000
*                           TBLPTR=TBLPTR+1;/* TRY NEXT ADDRESS      */ 00222000
         AL    TBLPTR,@CF00043                                  01S0138 00223000
*                         END;      /* OF DO WHILE                   */ 00224000
@DE00137 SLR   @10,@10                                          01S0139 00225000
         IC    @10,BYTE1(,TBLPTR)                               01S0139 00226000
         CR    GPR00F,@10                                       01S0139 00227000
         BE    @DC00137                                         01S0139 00228000
         CLI   BYTE1(TBLPTR),0                                  01S0139 00229000
         BNE   @DL00137                                         01S0139 00230000
@DC00137 DS    0H                                               01S0140 00231000
*                         TBLPTR=(TBLPTR/4)*4;/* FWORD BDWY CONTAINS    00232000
*                                      BASE PACK ADDRESS             */ 00233000
         LR    @10,TBLPTR                                       01S0140 00234000
         SRL   @10,2                                            01S0140 00235000
         SLA   @10,2                                            01S0140 00236000
         LR    TBLPTR,@10                                       01S0140 00237000
*                         GPR00F=TBLPTR->BYTE1;/* GET IT             */ 00238000
         SLR   GPR00F,GPR00F                                    01S0141 00239000
         IC    GPR00F,BYTE1(,TBLPTR)                            01S0141 00240000
*                         GPR00F=GPR00F|CCUSAV;/* OR IN CU ADDR      */ 00241000
         OR    GPR00F,CCUSAV                                    01S0142 00242000
*                       END;                                    01S0143 00243000
*                   END;                                        01S0144 00244000
@RC00131 DS    0H                                               01S0145 00245000
*                 GPR01P=ADDR(AP1ENQAD);/* ADDR FOR ENQ ADDR IN 01S0145 00246000
*                                      EBCDIC                        */ 00247000
@RC00126 LA    GPR01P,AP1ENQAD(,AP1REG)                         01S0145 00248000
*                 CALL CVTEBCD;     /* CONVERT TO EBCDIC             */ 00249000
         BAL   @14,CVTEBCD                                      01S0146 00250000
*                 RFY                                           01S0147 00251000
*                  (GPR00F,                                     01S0147 00252000
*                   GPR01P) UNRSTD;                             01S0147 00253000
*               END;                                            01S0148 00254000
*             ELSE                  /* REAL DEVICE--DONT CONTINUE    */ 00255000
*               DO;                                             01S0149 00256000
         B     @RC00117                                         01S0149 00257000
@RF00117 DS    0H                                               01S0150 00258000
*                 AP1CNCOD=MIDT;    /* SETUP FOR INCOR DEV TYPE MSG  */ 00259000
         MVI   AP1CNCOD(AP1REG),X'0E'                           01S0150 00260000
*                 AP1QUIT=ON;       /* DONT DO ANY MORE TESTS        */ 00261000
         OI    AP1QUIT(AP1REG),B'00001000'                      01S0151 00262000
*               END;                                            01S0152 00263000
*           ELSE                    /* 3350                          */ 00264000
*             AP1ENQAD=AP1DEVAD;    /* ENQ ON THE DEVICE ADDRESS     */ 00265000
         B     @RC00116                                         01S0153 00266000
@RF00116 MVC   AP1ENQAD(4,AP1REG),AP1DEVAD(AP1REG)              01S0153 00267000
*           IF AP1ENQADÂ¬=0 THEN     /* DO ENQ                        */ 00268000
@RC00116 ICM   @10,15,AP1ENQAD(AP1REG)                          01S0154 00269000
         BZ    @RF00154                                         01S0154 00270000
*             DO;                                               01S0155 00271000
*               DO;                 /* ENQ (QNAME,AP1ENQAD,E,LENGTH(A   00272000
*                                      P1ENQAD),SYSTEM) RET(NONE)    */ 00273000
*                 RESPECIFY                                     01S0157 00274000
*                  (GPR01P) RESTRICTED;                         01S0157 00275000
*                 I056(1:20)=I056(1:20)&&I056(1:20);/* ZERO OUT THE     00276000
*                                      TABLE                         */ 00277000
         XC    I056(20),I056                                    01S0158 00278000
*                 I05604(1)=LENGTH(AP1ENQAD);/* LENGTH OF MINOR 01S0159 00279000
*                                      RESOURCE NAME                 */ 00280000
         MVI   I05604,X'04'                                     01S0159 00281000
*                 I05606(1)=ADDR(QNAME);/* ADDRESS OF MAJOR RESOURCE    00282000
*                                      NAME                          */ 00283000
         LA    @10,QNAME                                        01S0160 00284000
         ST    @10,I05606                                       01S0160 00285000
*                 I05607(1)=ADDR(AP1ENQAD);/* ADDRESS OF MINOR  01S0161 00286000
*                                      RESOURCE NAME                 */ 00287000
         LA    @10,AP1ENQAD(,AP1REG)                            01S0161 00288000
         ST    @10,I05607                                       01S0161 00289000
*                 I05603(1)='01000000'B;/* SET BIT STRING 1 FOR 01S0162 00290000
*                                      RESOURCE ELEMENT              */ 00291000
         MVI   I05603,B'01000000'                               01S0162 00292000
*                 I05605(1)='01000000'B;/* SET BIT STRING 2 FOR 01S0163 00293000
*                                      RESOURCE ELEMENT              */ 00294000
         MVI   I05605,B'01000000'                               01S0163 00295000
*                 I05603(1,1)='1'B; /* SET END OF LIST BIT           */ 00296000
         OI    I05603,B'10000000'                               01S0164 00297000
*                 GPR01P=ADDR(I05602);/* LOAD LIST ADDRESS           */ 00298000
         LA    GPR01P,I05602                                    01S0165 00299000
*                 SVC(56);          /* ISSUE ENQ SVC                 */ 00300000
         SVC   56                                               01S0166 00301000
*                 RESPECIFY                                     01S0167 00302000
*                  (GPR01P) UNRESTRICTED;                       01S0167 00303000
*               END;                /* ENQ (QNAME,AP1ENQAD,E,LENGTH(A   00304000
*                                      P1ENQAD),SYSTEM) RET(NONE)    */ 00305000
*               AP1ENQD=ON;         /* INDICATE ENQ DONE             */ 00306000
         OI    AP1ENQD(AP1REG),B'00010000'                      01S0169 00307000
*             END;                                              01S0170 00308000
*           ELSE                                                01S0171 00309000
*             ;                     /* ERROR DISCOVERED--DONT ENQ    */ 00310000
@RF00154 DS    0H                                               01S0172 00311000
*           IF AP1BUFAD->SNSFHF=ON THEN/* FIXED HEAD ON THIS PACK    */ 00312000
         L     @10,AP1BUFAD(,AP1REG)                            01S0172 00313000
         TM    SNSFHF(@10),B'00000100'                          01S0172 00314000
         BNO   @RF00172                                         01S0172 00315000
*             AP1FHF=ON;            /* INDICATE FIXED HEADS          */ 00316000
         OI    AP1FHF(AP1REG),B'00010000'                       01S0173 00317000
*           ELSE                                                01S0174 00318000
*             ;                     /* NO FIXED HDS OR NOT 3344      */ 00319000
@RF00172 DS    0H                                               01S0175 00320000
*           AP1TSTNO=AP1TSTNO+1;    /* GO TO NEXT TEST               */ 00321000
         LA    @10,1                                            01S0175 00322000
         SLR   @09,@09                                          01S0175 00323000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0175 00324000
         ALR   @10,@09                                          01S0175 00325000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0175 00326000
*         END;                                                  01S0176 00327000
*       ELSE                        /* SNS FAILED                    */ 00328000
*         DO;                                                   01S0177 00329000
         B     @RC00114                                         01S0177 00330000
@RF00114 DS    0H                                               01S0178 00331000
*           AP1QUIT=ON;             /* DONT DO ANY MORE TESTS        */ 00332000
         OI    AP1QUIT(AP1REG),B'00001000'                      01S0178 00333000
*           IF SNSINT=ON THEN       /* DRIVE NOT READY               */ 00334000
         TM    SNSINT+188(AP1REG),B'01000000'                   01S0179 00335000
         BNO   @RF00179                                         01S0179 00336000
*             AP1CNCOD=MDNR;        /* TELL OPER DEVICE NOT READY    */ 00337000
         MVI   AP1CNCOD(AP1REG),X'11'                           01S0180 00338000
*           ELSE                    /* OTHER PROBLEM                 */ 00339000
*             AP1ERROR=ON;          /* DRIVE PROBLEM                 */ 00340000
         B     @RC00179                                         01S0181 00341000
@RF00179 OI    AP1ERROR(AP1REG),B'00100000'                     01S0181 00342000
*           AP1PRCOD=PSNSER;        /* SENSE ERROR MESSAGE           */ 00343000
@RC00179 MVI   AP1PRCOD(AP1REG),X'07'                           01S0182 00344000
*         END;                                                  01S0183 00345000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00346000
         B     CE0001@                                          01S0184 00347000
*     END SNS;                      /* END OF SUBCASE                */ 00348000
*                                                               01S0185 00349000
*     /***************************************************************/ 00350000
*     /*                                                             */ 00351000
*     /* RECAL2: RECALIBRATE                                         */ 00352000
*     /*                                                             */ 00353000
*     /***************************************************************/ 00354000
*                                                               01S0186 00355000
*RECAL2:                                                        01S0186 00356000
*     DO;                           /* SUBCASE CHECKS SECOND    01S0186 00357000
*                                      RECALIBRATE                   */ 00358000
RECAL2   DS    0H                                               01S0187 00359000
*/*   CHECKS FOR I/O FAILURE                                         */ 00360000
*                                                               01S0187 00361000
*       IF AP1PCODEÂ¬=NRMC THEN      /* ERROR ON I/O                  */ 00362000
         CLI   AP1PCODE(AP1REG),X'7F'                           01S0187 00363000
         BE    @RF00187                                         01S0187 00364000
*         AP1PRERR=ON;              /* INDICATE ERROR                */ 00365000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0188 00366000
*       ELSE                                                    01S0189 00367000
*         ;                         /* I/O OK                        */ 00368000
@RF00187 DS    0H                                               01S0190 00369000
*       AP1TSTNO=AP1TSTNO+1;        /* INCR TO NEXT TEST             */ 00370000
         LA    @10,1                                            01S0190 00371000
         SLR   @09,@09                                          01S0190 00372000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0190 00373000
         ALR   @10,@09                                          01S0190 00374000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0190 00375000
*       IF AP1PRERR=ON THEN         /* RECALIBRATE FAILED            */ 00376000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0191 00377000
         BNO   @RF00191                                         01S0191 00378000
*         DO;                                                   01S0192 00379000
*           AP1ERROR=ON;            /* INDICATE DRIVE FAILURE        */ 00380000
*           AP1QUIT=ON;             /* STOP TESTING                  */ 00381000
         OI    AP1ERROR(AP1REG),B'00101000'                     01S0194 00382000
*           AP1PRCOD=PRECALER;      /* RECALIBRATE ERROR MESSAGE     */ 00383000
         MVI   AP1PRCOD(AP1REG),X'08'                           01S0195 00384000
*         END;                                                  01S0196 00385000
*       ELSE                                                    01S0197 00386000
*         ;                         /* OK                            */ 00387000
@RF00191 DS    0H                                               01S0198 00388000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00389000
         B     CE0001@                                          01S0198 00390000
*     END RECAL2;                   /* END OF SUBCASE                */ 00391000
*                                                               01S0199 00392000
*     /***************************************************************/ 00393000
*     /*                                                             */ 00394000
*     /* RHAMH: CHECK MOVEABLE HEADS                                 */ 00395000
*     /*                                                             */ 00396000
*     /***************************************************************/ 00397000
*                                                               01S0200 00398000
*RHAMH:                                                         01S0200 00399000
*     DO;                           /* SUBCASE CHECKS READ HA ON        00400000
*                                      MOVABLE HEADS                 */ 00401000
RHAMH    DS    0H                                               01S0201 00402000
*/*   CHECKS FOR SEEK VERIFY CHECK, DATA CHECK AND OTHER I/O ERRORS     00403000
*     UPDATES HEAD TABLE                                             */ 00404000
*                                                               01S0201 00405000
*       IF AP1PCODEÂ¬=NRMC THEN      /* ERROR ON I/O                  */ 00406000
         CLI   AP1PCODE(AP1REG),X'7F'                           01S0201 00407000
         BE    @RF00201                                         01S0201 00408000
*         AP1PRERR=ON;              /* INDICATE ERROR                */ 00409000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0202 00410000
*       ELSE                                                    01S0203 00411000
*         ;                         /* I/O OK                        */ 00412000
@RF00201 DS    0H                                               01S0204 00413000
*       IF AP1PRERR=ON THEN         /* I/O FAILED                    */ 00414000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0204 00415000
         BNO   @RF00204                                         01S0204 00416000
*         DO;                                                   01S0205 00417000
*           AP1PRCOD=PRHAMHER;      /* RHAMH ERROR MSG               */ 00418000
         MVI   AP1PRCOD(AP1REG),X'09'                           01S0206 00419000
*           CALL ERROR1;            /* ANALYZE ERROR AND SET FLAGS   */ 00420000
         BAL   @14,ERROR1                                       01S0207 00421000
*         END;                                                  01S0208 00422000
*       ELSE                                                    01S0209 00423000
*         ;                         /* I/O OK                        */ 00424000
@RF00204 DS    0H                                               01S0210 00425000
*       IF HH=HI3350HD|CCHH=HI3330CH|CCHH=HI3344CH THEN/* LAST  01S0210 00426000
*                                      MOVABLE HEAD READ             */ 00427000
         CLC   HH(2,AP1REG),@CB00314                            01S0210 00428000
         BE    @RT00210                                         01S0210 00429000
         CLC   CCHH(4,AP1REG),@CB00327                          01S0210 00430000
         BE    @RT00210                                         01S0210 00431000
         CLC   CCHH(4,AP1REG),@CB00329                          01S0210 00432000
         BNE   @RF00210                                         01S0210 00433000
@RT00210 DS    0H                                               01S0211 00434000
*         DO;                                                   01S0211 00435000
*           AP1TSTNO=AP1TSTNO+1;    /* INCREMENT TO NEXT TEST        */ 00436000
         LA    @10,1                                            01S0212 00437000
         SLR   @09,@09                                          01S0212 00438000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0212 00439000
         ALR   @10,@09                                          01S0212 00440000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0212 00441000
*           IF AP1ERROR=ON THEN     /* BAD MOVEABLE HEAD             */ 00442000
         TM    AP1ERROR(AP1REG),B'00100000'                     01S0213 00443000
         BNO   @RF00213                                         01S0213 00444000
*             AP1QUIT=ON;           /* QUIT TESTING                  */ 00445000
         OI    AP1QUIT(AP1REG),B'00001000'                      01S0214 00446000
*           ELSE                                                01S0215 00447000
*             ;                     /* NO ERRORS                     */ 00448000
@RF00213 DS    0H                                               01S0216 00449000
*           IF AP1FHF=OFF&AP1DEVTP=AP13344 THEN/* NO FIXED HEADS     */ 00450000
         TM    AP1FHF(AP1REG),B'00010000'                       01S0216 00451000
         BNZ   @RF00216                                         01S0216 00452000
         CLI   AP1DEVTP(AP1REG),3                               01S0216 00453000
         BNE   @RF00216                                         01S0216 00454000
*             AP1TSTNO=AP1TSTNO+2;  /* SKIP FIXED HD TEST            */ 00455000
         LA    @10,2                                            01S0217 00456000
         SLR   @09,@09                                          01S0217 00457000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0217 00458000
         ALR   @10,@09                                          01S0217 00459000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0217 00460000
*           ELSE                                                01S0218 00461000
*             ;                     /* MAY BE FIXED HEADS ON THIS       00462000
*                                      PACK                          */ 00463000
@RF00216 DS    0H                                               01S0219 00464000
*         END;                                                  01S0219 00465000
*       ELSE                                                    01S0220 00466000
*         ;                         /* NOT LAST HEAD YET             */ 00467000
@RF00210 DS    0H                                               01S0221 00468000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00469000
         B     CE0001@                                          01S0221 00470000
*     END RHAMH;                    /* END OF SUBCASE                */ 00471000
*                                                               01S0222 00472000
*     /***************************************************************/ 00473000
*     /*                                                             */ 00474000
*     /* RHAFH: CHECKS FIXED HEADS                                   */ 00475000
*     /*                                                             */ 00476000
*     /***************************************************************/ 00477000
*                                                               01S0223 00478000
*RHAFH:                                                         01S0223 00479000
*     DO;                           /* SUBCASE CHECKS READ HA ON        00480000
*                                      FIXED HEADS                   */ 00481000
RHAFH    DS    0H                                               01S0224 00482000
*/*   CHECKS FOR SEEK VERIFY CHECKS, DATA CHECKS, AND OTHER I/O ERRORS  00483000
*     UPDATES HEAD TABLE                                             */ 00484000
*                                                               01S0224 00485000
*       IF AP1PCODEÂ¬=NRMC THEN      /* ERROR ON I/O                  */ 00486000
         CLI   AP1PCODE(AP1REG),X'7F'                           01S0224 00487000
         BE    @RF00224                                         01S0224 00488000
*         AP1PRERR=ON;              /* INDICATE ERROR                */ 00489000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0225 00490000
*       ELSE                                                    01S0226 00491000
*         ;                         /* I/O OK                        */ 00492000
@RF00224 DS    0H                                               01S0227 00493000
*       IF AP1PRERR=ON THEN         /* ERROR ON I/O                  */ 00494000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0227 00495000
         BNO   @RF00227                                         01S0227 00496000
*         DO;                                                   01S0228 00497000
*           AP1PRCOD=PRHAFHER;      /* RHAFH ERROR MSG               */ 00498000
         MVI   AP1PRCOD(AP1REG),X'0A'                           01S0229 00499000
*           CALL ERROR1;            /* ANALYZE ERROR AND SET FLAGS   */ 00500000
         BAL   @14,ERROR1                                       01S0230 00501000
*         END;                                                  01S0231 00502000
*       ELSE                                                    01S0232 00503000
*         ;                         /* I/O OK                        */ 00504000
@RF00227 DS    0H                                               01S0233 00505000
*       IF CCHH='0002001D'X|CCHH='00030012'X|CCHH='000A000A'X THEN/*    00506000
*                                      HAVE READ LAST HEAD           */ 00507000
         CLC   CCHH(4,AP1REG),@CB00440                          01S0233 00508000
         BE    @RT00233                                         01S0233 00509000
         CLC   CCHH(4,AP1REG),@CB00441                          01S0233 00510000
         BE    @RT00233                                         01S0233 00511000
         CLC   CCHH(4,AP1REG),@CB00442                          01S0233 00512000
         BNE   @RF00233                                         01S0233 00513000
@RT00233 DS    0H                                               01S0234 00514000
*         DO;                                                   01S0234 00515000
*           AP1TSTNO=AP1TSTNO+1;    /* GO TO NEXT TEST               */ 00516000
         LA    @10,1                                            01S0235 00517000
         SLR   @09,@09                                          01S0235 00518000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0235 00519000
         ALR   @10,@09                                          01S0235 00520000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0235 00521000
*           IF AP1ERROR=ON THEN     /* AT LEAST ONE HEAD HAD ERROR   */ 00522000
         TM    AP1ERROR(AP1REG),B'00100000'                     01S0236 00523000
         BNO   @RF00236                                         01S0236 00524000
*             AP1QUIT=ON;           /* STOP TESTING                  */ 00525000
         OI    AP1QUIT(AP1REG),B'00001000'                      01S0237 00526000
*           ELSE                                                01S0238 00527000
*             ;                     /* ALL HEADS OK                  */ 00528000
@RF00236 DS    0H                                               01S0239 00529000
*         END;                                                  01S0239 00530000
*       ELSE                                                    01S0240 00531000
*         ;                         /* NOT FINISHED YET              */ 00532000
@RF00233 DS    0H                                               01S0241 00533000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00534000
         B     CE0001@                                          01S0241 00535000
*     END RHAFH;                    /* END OF SUBCASE                */ 00536000
*                                                               01S0242 00537000
*     /***************************************************************/ 00538000
*     /*                                                             */ 00539000
*     /* RPS: CHECKS RPS                                             */ 00540000
*     /*                                                             */ 00541000
*     /***************************************************************/ 00542000
*                                                               01S0243 00543000
*RPS:                                                           01S0243 00544000
*     DO;                           /* SUBCASE CHECK ONLY FOR I/O       00545000
*                                      ERROR                         */ 00546000
RPS      DS    0H                                               01S0244 00547000
*       IF AP1PCODEÂ¬=NRMC THEN      /* ERROR ON I/O                  */ 00548000
         CLI   AP1PCODE(AP1REG),X'7F'                           01S0244 00549000
         BE    @RF00244                                         01S0244 00550000
*         AP1PRERR=ON;              /* INDICATE ERROR                */ 00551000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0245 00552000
*       ELSE                                                    01S0246 00553000
*         ;                         /* I/O OK                        */ 00554000
@RF00244 DS    0H                                               01S0247 00555000
*       IF AP1PRERR=ON THEN         /* ERROR ON I/O                  */ 00556000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0247 00557000
         BNO   @RF00247                                         01S0247 00558000
*         DO;                                                   01S0248 00559000
*           AP1PRCOD=PRPSER;        /* RPS ERROR MSG                 */ 00560000
         MVI   AP1PRCOD(AP1REG),X'24'                           01S0249 00561000
*           AP1ERROR=ON;            /* DRIVE ERROR                   */ 00562000
*           AP1QUIT=ON;             /* STOP TESTING                  */ 00563000
         OI    AP1ERROR(AP1REG),B'00101000'                     01S0251 00564000
*         END;                                                  01S0252 00565000
*       ELSE                                                    01S0253 00566000
*         ;                         /* I/O OK                        */ 00567000
@RF00247 DS    0H                                               01S0254 00568000
*       AP1TSTNO=AP1TSTNO+1;        /* GO TO NEXT TEST               */ 00569000
         LA    @10,1                                            01S0254 00570000
         SLR   @09,@09                                          01S0254 00571000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0254 00572000
         ALR   @09,@10                                          01S0254 00573000
         STC   @09,AP1TSTNO(,AP1REG)                            01S0254 00574000
*       IF AP1DEVTP=AP13344 THEN    /* 3344                          */ 00575000
         CLI   AP1DEVTP(AP1REG),3                               01S0255 00576000
         BNE   @RF00255                                         01S0255 00577000
*         AP1TSTNO=AP1TSTNO+1;      /* SKIP SK192                    */ 00578000
         ALR   @09,@10                                          01S0256 00579000
         STC   @09,AP1TSTNO(,AP1REG)                            01S0256 00580000
*       ELSE                                                    01S0257 00581000
*         ;                         /* NOT 3344                      */ 00582000
@RF00255 DS    0H                                               01S0258 00583000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00584000
         B     CE0001@                                          01S0258 00585000
*     END RPS;                      /* END OF SUBCASE                */ 00586000
*                                                               01S0259 00587000
*     /***************************************************************/ 00588000
*     /*                                                             */ 00589000
*     /* SK192: 192 CYLINDER SEEKS                                   */ 00590000
*     /*                                                             */ 00591000
*     /***************************************************************/ 00592000
*                                                               01S0260 00593000
*SK192:                                                         01S0260 00594000
*     DO;                           /* SUBCASE CHECKS 192 CYL SEEKS  */ 00595000
SK192    DS    0H                                               01S0261 00596000
*/*   CHECKS FOR I/O ERRORS                                          */ 00597000
*                                                               01S0261 00598000
*       IF AP1PCODEÂ¬=NRMC THEN      /* ERROR ON I/O                  */ 00599000
         CLI   AP1PCODE(AP1REG),X'7F'                           01S0261 00600000
         BE    @RF00261                                         01S0261 00601000
*         AP1PRERR=ON;              /* INDICATE ERROR                */ 00602000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0262 00603000
*       ELSE                                                    01S0263 00604000
*         ;                         /* I/O OK                        */ 00605000
@RF00261 DS    0H                                               01S0264 00606000
*       AP1TSTNO=AP1TSTNO+1;        /* INCREMENT TO NEXT TEST        */ 00607000
         LA    @10,1                                            01S0264 00608000
         SLR   @09,@09                                          01S0264 00609000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0264 00610000
         ALR   @10,@09                                          01S0264 00611000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0264 00612000
*       IF AP1PRERR=ON THEN         /* I/O ERROR                     */ 00613000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0265 00614000
         BNO   @RF00265                                         01S0265 00615000
*         DO;                                                   01S0266 00616000
*           AP1ERROR=ON;            /* DRIVE PROBLEM                 */ 00617000
*           AP1QUIT=ON;             /* STOP TESTING                  */ 00618000
         OI    AP1ERROR(AP1REG),B'00101000'                     01S0268 00619000
*           AP1PRCOD=PSK192ER;      /* SK192 ERROR MSG               */ 00620000
         MVI   AP1PRCOD(AP1REG),X'0B'                           01S0269 00621000
*         END;                                                  01S0270 00622000
*       ELSE                                                    01S0271 00623000
*         ;                         /* NO ERRORS                     */ 00624000
@RF00265 DS    0H                                               01S0272 00625000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00626000
         B     CE0001@                                          01S0272 00627000
*     END SK192;                    /* END OF SUBCASE                */ 00628000
*                                                               01S0273 00629000
*     /***************************************************************/ 00630000
*     /*                                                             */ 00631000
*     /* SKINCR: INCREMENTAL SEEKS                                   */ 00632000
*     /*                                                             */ 00633000
*     /***************************************************************/ 00634000
*                                                               01S0274 00635000
*SKINCR:                                                        01S0274 00636000
*     DO;                           /* SUBCASE CHECKS INCREMENTAL       00637000
*                                      SEEKS                         */ 00638000
SKINCR   DS    0H                                               01S0275 00639000
*/*   CHECKS FOR I/O ERRORS                                          */ 00640000
*                                                               01S0275 00641000
*       IF AP1PCODEÂ¬=NRMC THEN      /* ERROR ON I/O                  */ 00642000
         CLI   AP1PCODE(AP1REG),X'7F'                           01S0275 00643000
         BE    @RF00275                                         01S0275 00644000
*         AP1PRERR=ON;              /* INDICATE ERROR                */ 00645000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0276 00646000
*       ELSE                                                    01S0277 00647000
*         ;                         /* I/O OK                        */ 00648000
@RF00275 DS    0H                                               01S0278 00649000
*       AP1TSTNO=AP1TSTNO+1;        /* INCREMENT TO NEXT TEST        */ 00650000
         LA    @10,1                                            01S0278 00651000
         SLR   @09,@09                                          01S0278 00652000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0278 00653000
         ALR   @10,@09                                          01S0278 00654000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0278 00655000
*       IF AP1PRERR=ON THEN         /* I/O ERROR                     */ 00656000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0279 00657000
         BNO   @RF00279                                         01S0279 00658000
*         DO;                                                   01S0280 00659000
*           AP1ERROR=ON;            /* DRIVE PROBLEM                 */ 00660000
*           AP1QUIT=ON;             /* STOP TESTING                  */ 00661000
         OI    AP1ERROR(AP1REG),B'00101000'                     01S0282 00662000
*           AP1PRCOD=PINCRER;       /* SKINCR ERROR MSG              */ 00663000
         MVI   AP1PRCOD(AP1REG),X'0C'                           01S0283 00664000
*         END;                                                  01S0284 00665000
*       ELSE                                                    01S0285 00666000
*         ;                         /* NO ERRORS                     */ 00667000
@RF00279 DS    0H                                               01S0286 00668000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00669000
         B     CE0001@                                          01S0286 00670000
*     END SKINCR;                   /* END OF SUBCASE                */ 00671000
*                                                               01S0287 00672000
*     /***************************************************************/ 00673000
*     /*                                                             */ 00674000
*     /* SKMAX: MAXIMUM SEEKS                                        */ 00675000
*     /*                                                             */ 00676000
*     /***************************************************************/ 00677000
*                                                               01S0288 00678000
*SKMAX:                                                         01S0288 00679000
*     DO;                           /* SUBCASE CHECKS MAXIMUM SEEKS  */ 00680000
SKMAX    DS    0H                                               01S0289 00681000
*/*   CHECKS FOR I/O ERRORS                                          */ 00682000
*                                                               01S0289 00683000
*       IF AP1PCODEÂ¬=NRMC THEN      /* ERROR ON I/O                  */ 00684000
         CLI   AP1PCODE(AP1REG),X'7F'                           01S0289 00685000
         BE    @RF00289                                         01S0289 00686000
*         AP1PRERR=ON;              /* INDICATE ERROR                */ 00687000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0290 00688000
*       ELSE                                                    01S0291 00689000
*         ;                         /* I/O OK                        */ 00690000
@RF00289 DS    0H                                               01S0292 00691000
*       AP1TSTNO=AP1TSTNO+1;        /* INCREMENT TO NEXT TEST        */ 00692000
         LA    @10,1                                            01S0292 00693000
         SLR   @09,@09                                          01S0292 00694000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0292 00695000
         ALR   @10,@09                                          01S0292 00696000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0292 00697000
*       IF AP1PRERR=ON THEN         /* I/O ERROR                     */ 00698000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0293 00699000
         BNO   @RF00293                                         01S0293 00700000
*         DO;                                                   01S0294 00701000
*           AP1ERROR=ON;            /* DRIVE PROBLEM                 */ 00702000
*           AP1QUIT=ON;             /* STOP TESTING                  */ 00703000
         OI    AP1ERROR(AP1REG),B'00101000'                     01S0296 00704000
*           AP1PRCOD=PSKMAXER;      /* SKMAX ERROR MSG               */ 00705000
         MVI   AP1PRCOD(AP1REG),X'0D'                           01S0297 00706000
*         END;                                                  01S0298 00707000
*       ELSE                                                    01S0299 00708000
*         ;                         /* NO ERRORS                     */ 00709000
@RF00293 DS    0H                                               01S0300 00710000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00711000
         B     CE0001@                                          01S0300 00712000
*     END SKMAX;                    /* END OF SUBCASE                */ 00713000
*                                                               01S0301 00714000
*     /***************************************************************/ 00715000
*     /*                                                             */ 00716000
*     /* SKRAN: RANDOM SEEKS                                         */ 00717000
*     /*                                                             */ 00718000
*     /***************************************************************/ 00719000
*                                                               01S0302 00720000
*SKRAN:                                                         01S0302 00721000
*     DO;                           /* SUBCASE CHECKS RANDOM SEEKS   */ 00722000
SKRAN    DS    0H                                               01S0303 00723000
*/*   CHECKS FOR I/O ERRORS                                          */ 00724000
*                                                               01S0303 00725000
*       IF AP1PCODEÂ¬=NRMC THEN      /* ERROR ON I/O                  */ 00726000
         CLI   AP1PCODE(AP1REG),X'7F'                           01S0303 00727000
         BE    @RF00303                                         01S0303 00728000
*         AP1PRERR=ON;              /* INDICATE ERROR                */ 00729000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0304 00730000
*       ELSE                                                    01S0305 00731000
*         ;                         /* I/O OK                        */ 00732000
@RF00303 DS    0H                                               01S0306 00733000
*       IF AP1PRERR=ON THEN         /* I/O ERROR                     */ 00734000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0306 00735000
         BNO   @RF00306                                         01S0306 00736000
*         DO;                                                   01S0307 00737000
*           AP1ERROR=ON;            /* DRIVE PROBLEM                 */ 00738000
*           AP1QUIT=ON;             /* STOP TESTING                  */ 00739000
         OI    AP1ERROR(AP1REG),B'00101000'                     01S0309 00740000
*           AP1PRCOD=PSKRANER;      /* SKRAN ERROR MSG               */ 00741000
         MVI   AP1PRCOD(AP1REG),X'0E'                           01S0310 00742000
*         END;                                                  01S0311 00743000
*       ELSE                                                    01S0312 00744000
*         ;                         /* NO ERRORS                     */ 00745000
@RF00306 DS    0H                                               01S0313 00746000
*       IF AP1SKCNT=RANSKMAX THEN   /* FIFTY SEEKS                   */ 00747000
         CLC   AP1SKCNT(2,AP1REG),@CH00318                      01S0313 00748000
         BNE   @RF00313                                         01S0313 00749000
*         AP1TSTNO=AP1TSTNO+1;      /* GO TO NEXT TEST               */ 00750000
         LA    @10,1                                            01S0314 00751000
         SLR   @09,@09                                          01S0314 00752000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0314 00753000
         ALR   @10,@09                                          01S0314 00754000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0314 00755000
*       ELSE                                                    01S0315 00756000
*         ;                         /* NOT ENOUGH SEEKS YET          */ 00757000
@RF00313 DS    0H                                               01S0316 00758000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00759000
         B     CE0001@                                          01S0316 00760000
*     END SKRAN;                    /* END OF SUBCASE                */ 00761000
*                                                               01S0317 00762000
*     /***************************************************************/ 00763000
*     /*                                                             */ 00764000
*     /* RHA: VERIFY HOME ADDRESS ON CE CYLINDER                     */ 00765000
*     /*                                                             */ 00766000
*     /***************************************************************/ 00767000
*                                                               01S0318 00768000
*RHA:                                                           01S0318 00769000
*     DO;                           /* SUBCASE CHECKS READ HA ON CE     00770000
*                                      CYL                           */ 00771000
RHA      DS    0H                                               01S0319 00772000
*/*   CHECKS FOR SEEK VERIFY CHECKS, DATA CHECKS AND OTHER I/O ERRORS   00773000
*     IF EITHER OF THE FIRST, SKIPS ALL WRITE DEPENDENT TESTS   01S0319 00774000
*     BUT DOES NOT TERMINATE                                    01S0319 00775000
*     UPDATES HEAD TABLE                                             */ 00776000
*                                                               01S0319 00777000
*       IF AP1PCODEÂ¬=NRMC THEN      /* ERROR ON I/O                  */ 00778000
         CLI   AP1PCODE(AP1REG),X'7F'                           01S0319 00779000
         BE    @RF00319                                         01S0319 00780000
*         AP1PRERR=ON;              /* INDICATE ERROR                */ 00781000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0320 00782000
*       ELSE                                                    01S0321 00783000
*         ;                         /* I/O OK                        */ 00784000
@RF00319 DS    0H                                               01S0322 00785000
*       IF AP1PRERR=ON THEN         /* ERROR                         */ 00786000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0322 00787000
         BNO   @RF00322                                         01S0322 00788000
*         DO;                                                   01S0323 00789000
*           AP1PRCOD=PRHAER;        /* RHA ERROR MSG                 */ 00790000
         MVI   AP1PRCOD(AP1REG),X'0F'                           01S0324 00791000
*           IF AP1PCODE=ERRC&CSWUNCHK=ON&(CSWADDRB-LENGTH(CCW))->CCWRD( 00792000
*               1)=ON&(CSWADDRB-LENGTH(CCW))->CCWWR(1)=OFF THEN/*       00793000
*                                      UNIT CHK ON READ              */ 00794000
         CLI   AP1PCODE(AP1REG),X'41'                           01S0325 00795000
         BNE   @RF00325                                         01S0325 00796000
         LA    @10,AP1CSW(,AP1REG)                              01S0325 00797000
         BCTR  @10,0                                            01S0325 00798000
         TM    CSWUNCHK(@10),B'00000010'                        01S0325 00799000
         BNO   @RF00325                                         01S0325 00800000
         L     @10,CSWADDRB-1(,@10)                             01S0325 00801000
         AL    @10,@CF00504                                     01S0325 00802000
         TM    CCWRD(@10),B'00000010'                           01S0325 00803000
         BNO   @RF00325                                         01S0325 00804000
         TM    CCWWR(@10),B'00000001'                           01S0325 00805000
         BNZ   @RF00325                                         01S0325 00806000
*             IF SNSDATA=ON|(SNSEQU=ON&SNS7=FMT10&(SNS17&NDFMSK)=NDF)   00807000
*               THEN                /* DATA CHECK                    */ 00808000
         LA    @10,188                                          01S0326 00809000
         ALR   @10,AP1REG                                       01S0326 00810000
         TM    SNSDATA(@10),B'00001000'                         01S0326 00811000
         BO    @RT00326                                         01S0326 00812000
         TM    SNSEQU(@10),B'00010000'                          01S0326 00813000
         BNO   @RF00326                                         01S0326 00814000
         CLI   SNS7(@10),X'10'                                  01S0326 00815000
         BNE   @RF00326                                         01S0326 00816000
         MVC   @TS00001(1),SNS17(@10)                           01S0326 00817000
         NI    @TS00001,X'FE'                                   01S0326 00818000
         CLI   @TS00001,X'C0'                                   01S0326 00819000
         BNE   @RF00326                                         01S0326 00820000
@RT00326 DS    0H                                               01S0327 00821000
*               DO;                                             01S0327 00822000
*                 AP1NOWR=ON;       /* CANT DO WRITE TESTS           */ 00823000
         OI    AP1NOWR(AP1REG),B'10000000'                      01S0328 00824000
*                 DCKCE=ON;         /* SET IN TABLE                  */ 00825000
         L     @10,AP1ETABA(,AP1REG)                            01S0329 00826000
         OI    DCKCE(@10),B'00010000'                           01S0329 00827000
*               END;                                            01S0330 00828000
*             ELSE                  /* NOT DATA CHECK                */ 00829000
*               IF SNS7=SKCHK7&((AP1DEVTP=AP13344&SNSSKCK=ON)|(AP1DEVTP 00830000
*                   Â¬=AP13344&SNSEQU=ON)) THEN                  01S0331 00831000
         B     @RC00326                                         01S0331 00832000
@RF00326 LA    @10,188                                          01S0331 00833000
         ALR   @10,AP1REG                                       01S0331 00834000
         CLI   SNS7(@10),X'1A'                                  01S0331 00835000
         BNE   @RF00331                                         01S0331 00836000
         CLI   AP1DEVTP(AP1REG),3                               01S0331 00837000
         BNE   @GL00013                                         01S0331 00838000
         TM    SNSSKCK(@10),B'00000001'                         01S0331 00839000
         BO    @RT00331                                         01S0331 00840000
@GL00013 CLI   AP1DEVTP(AP1REG),3                               01S0331 00841000
         BE    @RF00331                                         01S0331 00842000
         TM    SNSEQU+188(AP1REG),B'00010000'                   01S0331 00843000
         BNO   @RF00331                                         01S0331 00844000
@RT00331 DS    0H                                               01S0332 00845000
*                 DO;                                           01S0332 00846000
*                   AP1NOWR=ON;     /* CANT DO WRITE TESTS           */ 00847000
         OI    AP1NOWR(AP1REG),B'10000000'                      01S0333 00848000
*                   SKVERCK=ON;     /* SET IN TABLE                  */ 00849000
         L     @10,AP1ETABA(,AP1REG)                            01S0334 00850000
         OI    SKVERCK(@10),B'01000000'                         01S0334 00851000
*                 END;                                          01S0335 00852000
*               ELSE                /* NOT DCK OR SKVERCK            */ 00853000
*                 DO;                                           01S0336 00854000
         B     @RC00331                                         01S0336 00855000
@RF00331 DS    0H                                               01S0337 00856000
*                   AP1ERROR=ON;    /* DRIVE PROBLEM                 */ 00857000
*                   AP1QUIT=ON;     /* STOP TESTING                  */ 00858000
         OI    AP1ERROR(AP1REG),B'00101000'                     01S0338 00859000
*                 END;                                          01S0339 00860000
*           ELSE                    /* NOT UCK ON RHA                */ 00861000
*             DO;                                               01S0340 00862000
         B     @RC00325                                         01S0340 00863000
@RF00325 DS    0H                                               01S0341 00864000
*               AP1ERROR=ON;        /* DRIVE PROBLEM                 */ 00865000
*               AP1QUIT=ON;         /* STOP TESTING                  */ 00866000
         OI    AP1ERROR(AP1REG),B'00101000'                     01S0342 00867000
*             END;                                              01S0343 00868000
*         END;                                                  01S0344 00869000
*       ELSE                        /* NO HDWE ERROR                 */ 00870000
*         IF AP1BUFAD->BYTE5(2:5)Â¬=CECCHH THEN/* CCHH IN HA INCORRECT*/ 00871000
         B     @RC00322                                         01S0345 00872000
@RF00322 L     @10,AP1BUFAD(,AP1REG)                            01S0345 00873000
         CLC   BYTE5+1(4,@10),CECCHH(AP1REG)                    01S0345 00874000
         BE    @RF00345                                         01S0345 00875000
*           DO;                                                 01S0346 00876000
*             AP1NOWR=ON;           /* CANT DO WRITE TESTS           */ 00877000
         OI    AP1NOWR(AP1REG),B'10000000'                      01S0347 00878000
*             AP1PRERR=ON;          /* PRINT MSG                     */ 00879000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0348 00880000
*             AP1PRCOD=PRHADC;      /* DATA COMPARE ERR              */ 00881000
         MVI   AP1PRCOD(AP1REG),X'22'                           01S0349 00882000
*             CALL CVTEBCDX(ADDR(CECCHH),ADDR(AP1PRMSG)+25,LENGTH(      00883000
*                 CECCHH));         /* CNVT EXPECTED TO EBCDIC       */ 00884000
         LA    @10,CECCHH(,AP1REG)                              01S0350 00885000
         ST    @10,@AFTEMPS                                     01S0350 00886000
         LA    @10,@AFTEMPS                                     01S0350 00887000
         ST    @10,@AL00001                                     01S0350 00888000
         LA    @10,AP1PRMSG(,AP1REG)                            01S0350 00889000
         AL    @10,@CF00411                                     01S0350 00890000
         ST    @10,@AFTEMPS+4                                   01S0350 00891000
         LA    @10,@AFTEMPS+4                                   01S0350 00892000
         ST    @10,@AL00001+4                                   01S0350 00893000
         LA    @10,@CF00038                                     01S0350 00894000
         ST    @10,@AL00001+8                                   01S0350 00895000
         LA    @01,@AL00001                                     01S0350 00896000
         BAL   @14,CVTEBCDX                                     01S0350 00897000
*             CALL CVTEBCDX(AP1BUFAD+1,ADDR(AP1PRMSG)+41,LENGTH(CECCHH) 00898000
*                 );                /* CNVT RECEIVED TO EBCDIC       */ 00899000
         LA    @10,1                                            01S0351 00900000
         AL    @10,AP1BUFAD(,AP1REG)                            01S0351 00901000
         ST    @10,@AFTEMPS                                     01S0351 00902000
         LA    @10,@AFTEMPS                                     01S0351 00903000
         ST    @10,@AL00001                                     01S0351 00904000
         LA    @10,AP1PRMSG(,AP1REG)                            01S0351 00905000
         AL    @10,@CF00450                                     01S0351 00906000
         ST    @10,@AFTEMPS+4                                   01S0351 00907000
         LA    @10,@AFTEMPS+4                                   01S0351 00908000
         ST    @10,@AL00001+4                                   01S0351 00909000
         LA    @10,@CF00038                                     01S0351 00910000
         ST    @10,@AL00001+8                                   01S0351 00911000
         LA    @01,@AL00001                                     01S0351 00912000
         BAL   @14,CVTEBCDX                                     01S0351 00913000
*           END;                                                01S0352 00914000
*         ELSE                                                  01S0353 00915000
*           ;                       /* HA CORRECT                    */ 00916000
@RF00345 DS    0H                                               01S0354 00917000
*       IF CEHH=HI3350HD|CECCHH=HI3344CE THEN/* LAST TRK READ        */ 00918000
@RC00322 CLC   CEHH(2,AP1REG),@CB00314                          01S0354 00919000
         BE    @RT00354                                         01S0354 00920000
         CLC   CECCHH(4,AP1REG),@CB00290                        01S0354 00921000
         BNE   @RF00354                                         01S0354 00922000
@RT00354 DS    0H                                               01S0355 00923000
*         DO;                                                   01S0355 00924000
*           AP1TSTNO=AP1TSTNO+1;    /* INCR TO NEXT TEST             */ 00925000
         LA    @10,1                                            01S0356 00926000
         SLR   @09,@09                                          01S0356 00927000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0356 00928000
         ALR   @10,@09                                          01S0356 00929000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0356 00930000
*           IF AP1NOWR=ON THEN      /* BAD HA                        */ 00931000
         TM    AP1NOWR(AP1REG),B'10000000'                      01S0357 00932000
         BNO   @RF00357                                         01S0357 00933000
*             DO;                                               01S0358 00934000
*               AP1LST=ON;          /* SKIP WRITE DEPENDENT TESTS    */ 00935000
         OI    AP1LST(AP1REG),B'01000000'                       01S0359 00936000
*               AP1RET=AP1SKRET;    /* INDICATE TESTS SKIPPED        */ 00937000
         MVI   AP1RET(AP1REG),X'04'                             01S0360 00938000
*               AP1CNCOD=MWTB;      /* SETUP FOR WRITE TESTS BYPASSED   00939000
*                                      MESSAGE                       */ 00940000
         MVI   AP1CNCOD(AP1REG),X'08'                           01S0361 00941000
*             END;                                              01S0362 00942000
*           ELSE                                                01S0363 00943000
*             ;                     /* ALL HA''S GOOD                */ 00944000
@RF00357 DS    0H                                               01S0364 00945000
*         END;                                                  01S0364 00946000
*       ELSE                                                    01S0365 00947000
*         ;                         /* NOT LAST TRK YET              */ 00948000
@RF00354 DS    0H                                               01S0366 00949000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00950000
         B     CE0001@                                          01S0366 00951000
*     END RHA;                      /* END OF SUBCASE                */ 00952000
*                                                               01S0367 00953000
*     /***************************************************************/ 00954000
*     /*                                                             */ 00955000
*     /* WRT: WRITE ON CE CYLINDER                                   */ 00956000
*     /*                                                             */ 00957000
*     /***************************************************************/ 00958000
*                                                               01S0368 00959000
*WRT:                                                           01S0368 00960000
*     DO;                           /* SUBCASE CHECKS WRITE R0 R1 ON    00961000
*                                      CE CYL                        */ 00962000
WRT      DS    0H                                               01S0369 00963000
*/*   CHECKS FOR WRITE INHIBIT, WRITE CHECKS AND OTHER I/O ERRORS.      00964000
*     IF WRITE INHIBIT, BYPASSES ALL WRITE DEPENDENT TESTS      01S0369 00965000
*     BUT DOES NOT TERMINATE TESTING.                           01S0369 00966000
*     UPDATES HEAD TABLE                                             */ 00967000
*                                                               01S0369 00968000
*       IF AP1PCODEÂ¬=NRMC THEN      /* ERROR ON I/O                  */ 00969000
         CLI   AP1PCODE(AP1REG),X'7F'                           01S0369 00970000
         BE    @RF00369                                         01S0369 00971000
*         AP1PRERR=ON;              /* INDICATE ERROR                */ 00972000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0370 00973000
*       ELSE                                                    01S0371 00974000
*         ;                         /* I/O OK                        */ 00975000
@RF00369 DS    0H                                               01S0372 00976000
*       IF AP1PRERR=ON THEN         /* ERROR                         */ 00977000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0372 00978000
         BNO   @RF00372                                         01S0372 00979000
*         DO;                                                   01S0373 00980000
*           AP1PRCOD=PWRTER;        /* WRT ERROR MSG                 */ 00981000
         MVI   AP1PRCOD(AP1REG),X'10'                           01S0374 00982000
*           IF AP1PCODE=ERRC&CSWUNCHK=ON&(CSWADDRB-LENGTH(CCW))->CCWWR( 00983000
*               1)=ON&(CSWADDRB-LENGTH(CCW))->CCWRD(1)=OFF THEN/*       00984000
*                                      UNIT CHECK ON WRITE           */ 00985000
         CLI   AP1PCODE(AP1REG),X'41'                           01S0375 00986000
         BNE   @RF00375                                         01S0375 00987000
         LA    @10,AP1CSW(,AP1REG)                              01S0375 00988000
         BCTR  @10,0                                            01S0375 00989000
         TM    CSWUNCHK(@10),B'00000010'                        01S0375 00990000
         BNO   @RF00375                                         01S0375 00991000
         L     @10,CSWADDRB-1(,@10)                             01S0375 00992000
         AL    @10,@CF00504                                     01S0375 00993000
         TM    CCWWR(@10),B'00000001'                           01S0375 00994000
         BNO   @RF00375                                         01S0375 00995000
         TM    CCWRD(@10),B'00000010'                           01S0375 00996000
         BNZ   @RF00375                                         01S0375 00997000
*             IF SNSINHI=ON THEN    /* WRITE INHIBIT                 */ 00998000
         TM    SNSINHI+188(AP1REG),B'00000010'                  01S0376 00999000
         BNO   @RF00376                                         01S0376 01000000
*               DO;                                             01S0377 01001000
*                 AP1NOWR=ON;       /* SET NO WRITE BIT              */ 01002000
         OI    AP1NOWR(AP1REG),B'10000000'                      01S0378 01003000
*                 AP1PRCOD=PWRINH;  /* WRT WRITE INHIBIT ERROR MSG   */ 01004000
         MVI   AP1PRCOD(AP1REG),X'1B'                           01S0379 01005000
*               END;                                            01S0380 01006000
*             ELSE                  /* NOT WRITE INHIBIT             */ 01007000
*               DO;                                             01S0381 01008000
         B     @RC00376                                         01S0381 01009000
@RF00376 DS    0H                                               01S0382 01010000
*                 AP1ERROR=ON;      /* INDICATE ERROR                */ 01011000
         OI    AP1ERROR(AP1REG),B'00100000'                     01S0382 01012000
*                 WRTCK=ON;         /* SET IN TABLE                  */ 01013000
         L     @10,AP1ETABA(,AP1REG)                            01S0383 01014000
         OI    WRTCK(@10),B'00100000'                           01S0383 01015000
*               END;                                            01S0384 01016000
*           ELSE                    /* NOT UCK ON WRT                */ 01017000
*             DO;                                               01S0385 01018000
         B     @RC00375                                         01S0385 01019000
@RF00375 DS    0H                                               01S0386 01020000
*               AP1ERROR=ON;        /* DRIVE PROBLEM                 */ 01021000
*               AP1QUIT=ON;         /* STOP TESTING                  */ 01022000
         OI    AP1ERROR(AP1REG),B'00101000'                     01S0387 01023000
*             END;                                              01S0388 01024000
*         END;                                                  01S0389 01025000
*       ELSE                                                    01S0390 01026000
*         ;                         /* NO ERROR                      */ 01027000
@RF00372 DS    0H                                               01S0391 01028000
*       IF AP1NOWR=ON&AP1ERROR=OFF THEN/* WRITE INHIBIT ON--NO OTHER    01029000
*                                      ERRORS                        */ 01030000
@RC00372 TM    AP1NOWR(AP1REG),B'10000000'                      01S0391 01031000
         BNO   @RF00391                                         01S0391 01032000
         TM    AP1ERROR(AP1REG),B'00100000'                     01S0391 01033000
         BNZ   @RF00391                                         01S0391 01034000
*         DO;                                                   01S0392 01035000
*           AP1LST=ON;              /* SKIP WRITE DEPENDENT TESTS    */ 01036000
         OI    AP1LST(AP1REG),B'01000000'                       01S0393 01037000
*           AP1RET=AP1SKRET;        /* INDICATE TESTS SKIPPED        */ 01038000
         MVI   AP1RET(AP1REG),X'04'                             01S0394 01039000
*           AP1CNCOD=MWIS;          /* SETUP WRITE INHIBIT SW ON MSG */ 01040000
         MVI   AP1CNCOD(AP1REG),X'10'                           01S0395 01041000
*         END;                                                  01S0396 01042000
*       ELSE                        /* NOT WRITE INHIBIT OR ANOTHER     01043000
*                                      ERROR                         */ 01044000
*         IF CEHH=HI3350HD|CECCHH=HI3344CE THEN/* LAST TRACK READ    */ 01045000
         B     @RC00391                                         01S0397 01046000
@RF00391 CLC   CEHH(2,AP1REG),@CB00314                          01S0397 01047000
         BE    @RT00397                                         01S0397 01048000
         CLC   CECCHH(4,AP1REG),@CB00290                        01S0397 01049000
         BNE   @RF00397                                         01S0397 01050000
@RT00397 DS    0H                                               01S0398 01051000
*           DO;                                                 01S0398 01052000
*             AP1TSTNO=AP1TSTNO+1;  /* INCR TO NEXT TEST             */ 01053000
         LA    @10,1                                            01S0399 01054000
         SLR   @09,@09                                          01S0399 01055000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0399 01056000
         ALR   @10,@09                                          01S0399 01057000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0399 01058000
*             IF AP1ERROR=ON THEN   /* WRITE ERROR                   */ 01059000
         TM    AP1ERROR(AP1REG),B'00100000'                     01S0400 01060000
         BNO   @RF00400                                         01S0400 01061000
*               AP1QUIT=ON;         /* STOP TESTING                  */ 01062000
         OI    AP1QUIT(AP1REG),B'00001000'                      01S0401 01063000
*             ELSE                                              01S0402 01064000
*               ;                   /* NO ERROR                      */ 01065000
@RF00400 DS    0H                                               01S0403 01066000
*           END;                                                01S0403 01067000
*         ELSE                                                  01S0404 01068000
*           ;                       /* NOT LAST TRACK                */ 01069000
@RF00397 DS    0H                                               01S0405 01070000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01071000
         B     CE0001@                                          01S0405 01072000
*     END WRT;                      /* END OF SUBCASE                */ 01073000
*                                                               01S0406 01074000
*     /***************************************************************/ 01075000
*     /*                                                             */ 01076000
*     /* RR01: READ CE CYLINDER                                      */ 01077000
*     /*                                                             */ 01078000
*     /***************************************************************/ 01079000
*                                                               01S0407 01080000
*RR01:                                                          01S0407 01081000
*     DO;                           /* SUBCASE CHECK READ OF REC 0      01082000
*                                      AND 1                         */ 01083000
RR01     DS    0H                                               01S0408 01084000
*/*   CHECKS FOR SEEK VERIFY CHECKS, DATA CHECKS, OTHER I/O ERRORS AND  01085000
*     COMPARES COUNTS AND DATA READ                             01S0408 01086000
*     UPDATES HEAD TABLE                                             */ 01087000
*                                                               01S0408 01088000
*       IF AP1PCODEÂ¬=NRMC THEN      /* ERROR ON I/O                  */ 01089000
         CLI   AP1PCODE(AP1REG),X'7F'                           01S0408 01090000
         BE    @RF00408                                         01S0408 01091000
*         AP1PRERR=ON;              /* INDICATE ERROR                */ 01092000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0409 01093000
*       ELSE                                                    01S0410 01094000
*         ;                         /* I/O OK                        */ 01095000
@RF00408 DS    0H                                               01S0411 01096000
*       IF AP1PRERR=ON THEN         /* ERROR                         */ 01097000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0411 01098000
         BNO   @RF00411                                         01S0411 01099000
*         DO;                                                   01S0412 01100000
*           AP1PRCOD=PRR01ER;       /* RR01 ERR MSG                  */ 01101000
         MVI   AP1PRCOD(AP1REG),X'11'                           01S0413 01102000
*           CALL ERROR2;            /* ANALYZE ERROR AND SET FLAGS   */ 01103000
         BAL   @14,ERROR2                                       01S0414 01104000
*         END;                                                  01S0415 01105000
*       ELSE                        /* NO HARDWARE DETECTED ERROR    */ 01106000
*         DO;                                                   01S0416 01107000
         B     @RC00411                                         01S0416 01108000
@RF00411 DS    0H                                               01S0417 01109000
*           BUFPTR=AP1BUFAD;        /* POINT TO COUNT READ ON R0     */ 01110000
*                                                               01S0417 01111000
         L     @10,AP1BUFAD(,AP1REG)                            01S0417 01112000
         ST    @10,BUFPTR                                       01S0417 01113000
*           /*********************************************************/ 01114000
*           /*                                                       */ 01115000
*           /* BUILD EXPECTED R0 COUNT FOR COMPARE                   */ 01116000
*           /*                                                       */ 01117000
*           /*********************************************************/ 01118000
*                                                               01S0418 01119000
*           AP1WRKA->CNTCCHH=CECCHH;/* CCHH                          */ 01120000
         L     @09,AP1WRKA(,AP1REG)                             01S0418 01121000
         MVC   CNTCCHH(4,@09),CECCHH(AP1REG)                    01S0418 01122000
*           AP1WRKA->CNTRKDD=R0DL8; /* RKDD                          */ 01123000
         MVC   CNTRKDD(4,@09),@CB00292                          01S0419 01124000
*           IF BUFPTR->CNT=AP1WRKA->CNT THEN/* R0 OK                 */ 01125000
         CLC   CNT(8,@10),CNT(@09)                              01S0420 01126000
         BNE   @RF00420                                         01S0420 01127000
*             DO;                                               01S0421 01128000
*               BUFPTR=BUFPTR+LENGTH(CNT);/* POINT TO COUNT OF R1       01129000
*                                      READ                          */ 01130000
*                                                               01S0422 01131000
         LA    @15,8                                            01S0422 01132000
         ALR   @10,@15                                          01S0422 01133000
         ST    @10,BUFPTR                                       01S0422 01134000
*               /*****************************************************/ 01135000
*               /*                                                   */ 01136000
*               /* BUILD EXPECTED R1 COUNT FOR COMPARE               */ 01137000
*               /*                                                   */ 01138000
*               /*****************************************************/ 01139000
*                                                               01S0423 01140000
*               AP1WRKA->CNTRKDD=R1DL256;/* RKDD                     */ 01141000
         MVC   CNTRKDD(4,@09),@CB00294                          01S0423 01142000
*               IF BUFPTR->CNT=AP1WRKA->CNT THEN/* R1 COUNT OK       */ 01143000
         CLC   CNT(8,@10),CNT(@09)                              01S0424 01144000
         BNE   @RF00424                                         01S0424 01145000
*                 DO;                                           01S0425 01146000
*                   BUFPTR=BUFPTR+LENGTH(CNT);/* POINT TO R1 DATA    */ 01147000
*                                                               01S0426 01148000
         ALR   @10,@15                                          01S0426 01149000
         ST    @10,BUFPTR                                       01S0426 01150000
*                   /*************************************************/ 01151000
*                   /*                                               */ 01152000
*                   /* BUILD EXPECTED DATA FOR COMPARE               */ 01153000
*                   /*                                               */ 01154000
*                   /*************************************************/ 01155000
*                                                               01S0427 01156000
*                   IF AP1PTRN2=OFF THEN/* PATTERN ONE               */ 01157000
         TM    AP1PTRN2(AP1REG),B'10000000'                     01S0427 01158000
         BNZ   @RF00427                                         01S0427 01159000
*                     AP1WRKA->BYTE8=R1DATA1;                   01S0428 01160000
         MVC   BYTE8(8,@09),R1DATA1                             01S0428 01161000
*                   ELSE            /* PATTERN TWO                   */ 01162000
*                     AP1WRKA->BYTE8=R1DATA2;                   01S0429 01163000
         B     @RC00427                                         01S0429 01164000
@RF00427 L     @10,AP1WRKA(,AP1REG)                             01S0429 01165000
         MVC   BYTE8(8,@10),R1DATA2                             01S0429 01166000
*                   IF BUFPTR->BYTE8=AP1WRKA->BYTE8 THEN        01S0430 01167000
@RC00427 L     @10,AP1WRKA(,AP1REG)                             01S0430 01168000
         L     @09,BUFPTR                                       01S0430 01169000
         CLC   BYTE8(8,@09),BYTE8(@10)                          01S0430 01170000
         BE    @RT00430                                         01S0430 01171000
*                     ;             /* EVERYTHING COMPARES           */ 01172000
*                   ELSE            /* DATA DOESNT COMPARE           */ 01173000
*                     DATACOMP=ON;  /* SET IN TABLE                  */ 01174000
         L     @10,AP1ETABA(,AP1REG)                            01S0432 01175000
         OI    DATACOMP(@10),B'00001000'                        01S0432 01176000
*                 END;                                          01S0433 01177000
*               ELSE                /* R1 COUNT DOESNT COMPARE       */ 01178000
*                 DATACOMP=ON;      /* SET IN TABLE                  */ 01179000
         B     @RC00424                                         01S0434 01180000
@RF00424 L     @10,AP1ETABA(,AP1REG)                            01S0434 01181000
         OI    DATACOMP(@10),B'00001000'                        01S0434 01182000
*             END;                                              01S0435 01183000
*           ELSE                    /* R0 COUNT DOESNT COMPARE       */ 01184000
*             DATACOMP=ON;          /* SET IN TABLE                  */ 01185000
         B     @RC00420                                         01S0436 01186000
@RF00420 L     @10,AP1ETABA(,AP1REG)                            01S0436 01187000
         OI    DATACOMP(@10),B'00001000'                        01S0436 01188000
*           IF DATACOMP=ON THEN     /* DATA COMPARE ERROR            */ 01189000
@RC00420 L     @10,AP1ETABA(,AP1REG)                            01S0437 01190000
         TM    DATACOMP(@10),B'00001000'                        01S0437 01191000
         BNO   @RF00437                                         01S0437 01192000
*             DO;                                               01S0438 01193000
*               AP1PRCOD=PRR01DC;   /* RR01 DATA COMPARE MESSAGE     */ 01194000
         MVI   AP1PRCOD(AP1REG),X'12'                           01S0439 01195000
*               CALL CVTEBCDX(AP1WRKA,ADDR(AP1PRMSG)+32,LENGTH(CNT));   01196000
         LA    @10,AP1WRKA(,AP1REG)                             01S0440 01197000
         ST    @10,@AL00001                                     01S0440 01198000
         LA    @10,AP1PRMSG(,AP1REG)                            01S0440 01199000
         AL    @10,@CF00289                                     01S0440 01200000
         ST    @10,@AFTEMPS                                     01S0440 01201000
         LA    @10,@AFTEMPS                                     01S0440 01202000
         ST    @10,@AL00001+4                                   01S0440 01203000
         LA    @10,@CF00047                                     01S0440 01204000
         ST    @10,@AL00001+8                                   01S0440 01205000
         LA    @01,@AL00001                                     01S0440 01206000
         BAL   @14,CVTEBCDX                                     01S0440 01207000
*                                   /* CNVT EXPECTED TO EBCDIC       */ 01208000
*               CALL CVTEBCDX(BUFPTR,ADDR(AP1PRMSG)+60,LENGTH(CNT));    01209000
         LA    @10,BUFPTR                                       01S0441 01210000
         ST    @10,@AL00001                                     01S0441 01211000
         LA    @10,AP1PRMSG(,AP1REG)                            01S0441 01212000
         AL    @10,@CF00133                                     01S0441 01213000
         ST    @10,@AFTEMPS                                     01S0441 01214000
         LA    @10,@AFTEMPS                                     01S0441 01215000
         ST    @10,@AL00001+4                                   01S0441 01216000
         LA    @10,@CF00047                                     01S0441 01217000
         ST    @10,@AL00001+8                                   01S0441 01218000
         LA    @01,@AL00001                                     01S0441 01219000
         BAL   @14,CVTEBCDX                                     01S0441 01220000
*                                   /* CNVT RECEIVED TO EBCDIC       */ 01221000
*               AP1PRERR=ON;        /* CAUSE MSG TO BE PRINTED       */ 01222000
*               AP1ERROR=ON;        /* DRIVE PROBLEM                 */ 01223000
         OI    AP1PRERR(AP1REG),B'00110000'                     01S0443 01224000
*             END;                                              01S0444 01225000
*           ELSE                                                01S0445 01226000
*             ;                     /* ALL DATA COMPARED             */ 01227000
@RF00437 DS    0H                                               01S0446 01228000
*         END;                                                  01S0446 01229000
*       IF CEHH=HI3350HD|CECCHH=HI3344CE THEN/* LAST TRK READ        */ 01230000
@RC00411 CLC   CEHH(2,AP1REG),@CB00314                          01S0447 01231000
         BE    @RT00447                                         01S0447 01232000
         CLC   CECCHH(4,AP1REG),@CB00290                        01S0447 01233000
         BNE   @RF00447                                         01S0447 01234000
@RT00447 DS    0H                                               01S0448 01235000
*         IF AP1PTRN2=OFF THEN      /* JUST READ PTRN ONE            */ 01236000
         TM    AP1PTRN2(AP1REG),B'10000000'                     01S0448 01237000
         BNZ   @RF00448                                         01S0448 01238000
*           DO;                                                 01S0449 01239000
*             AP1TSTNO=AP1TSTNO-3;  /* GO BACK TO WRITE PTRN 2       */ 01240000
         SLR   @10,@10                                          01S0450 01241000
         IC    @10,AP1TSTNO(,AP1REG)                            01S0450 01242000
         SL    @10,@CF00137                                     01S0450 01243000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0450 01244000
*             AP1PTRN2=ON;          /* TELL WRITE PTRN 2             */ 01245000
         OI    AP1PTRN2(AP1REG),B'10000000'                     01S0451 01246000
*           END;                                                01S0452 01247000
*         ELSE                      /* JUST READ PTRN TWO            */ 01248000
*           DO;                                                 01S0453 01249000
         B     @RC00448                                         01S0453 01250000
@RF00448 DS    0H                                               01S0454 01251000
*             AP1TSTNO=AP1TSTNO+1;  /* INCR TO NEXT TEST             */ 01252000
         LA    @10,1                                            01S0454 01253000
         SLR   @09,@09                                          01S0454 01254000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0454 01255000
         ALR   @10,@09                                          01S0454 01256000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0454 01257000
*             IF AP1ERROR=ON THEN   /* ERROR IN READ                 */ 01258000
         TM    AP1ERROR(AP1REG),B'00100000'                     01S0455 01259000
         BNO   @RF00455                                         01S0455 01260000
*               AP1QUIT=ON;         /* STOP TESTING                  */ 01261000
         OI    AP1QUIT(AP1REG),B'00001000'                      01S0456 01262000
*             ELSE                                              01S0457 01263000
*               ;                   /* NO ERROR                      */ 01264000
@RF00455 DS    0H                                               01S0458 01265000
*           END;                                                01S0458 01266000
*       ELSE                                                    01S0459 01267000
*         ;                         /* NOT FINISHED YET              */ 01268000
@RF00447 DS    0H                                               01S0460 01269000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01270000
         B     CE0001@                                          01S0460 01271000
*     END RR01;                     /* END OF SUBCASE                */ 01272000
*                                                               01S0461 01273000
*     /***************************************************************/ 01274000
*     /*                                                             */ 01275000
*     /* RDMT: READ MULTI-TRACK                                      */ 01276000
*     /*                                                             */ 01277000
*     /***************************************************************/ 01278000
*                                                               01S0462 01279000
*RDMT:                                                          01S0462 01280000
*     DO;                           /* SUBCASE CHECKS MULTI TRK READ */ 01281000
RDMT     DS    0H                                               01S0463 01282000
*/*   CHECKS FOR I/O ERRORS AND COMPARES COUNTS READ                 */ 01283000
*                                                               01S0463 01284000
*       IF AP1PCODEÂ¬=NRMC THEN      /* ERROR ON I/O                  */ 01285000
         CLI   AP1PCODE(AP1REG),X'7F'                           01S0463 01286000
         BE    @RF00463                                         01S0463 01287000
*         AP1PRERR=ON;              /* INDICATE ERROR                */ 01288000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0464 01289000
*       ELSE                                                    01S0465 01290000
*         ;                         /* I/O OK                        */ 01291000
@RF00463 DS    0H                                               01S0466 01292000
*       IF AP1PRERR=ON THEN         /* I/O ERROR                     */ 01293000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0466 01294000
         BNO   @RF00466                                         01S0466 01295000
*         DO;                                                   01S0467 01296000
*           AP1PRCOD=PRDMTER;       /* RDMT ERROR MSG                */ 01297000
         MVI   AP1PRCOD(AP1REG),X'13'                           01S0468 01298000
*           AP1ERROR=ON;            /* DRIVE FAILURE                 */ 01299000
*           AP1QUIT=ON;             /* STOP TESTING                  */ 01300000
         OI    AP1ERROR(AP1REG),B'00101000'                     01S0470 01301000
*         END;                                                  01S0471 01302000
*       ELSE                        /* NO HDWE DETECTED ERROR        */ 01303000
*         DO;                                                   01S0472 01304000
         B     @RC00466                                         01S0472 01305000
@RF00466 DS    0H                                               01S0473 01306000
*           BUFPTR=AP1BUFAD;        /* POINT TO R0 COUNT             */ 01307000
*                                                               01S0473 01308000
         L     @10,AP1BUFAD(,AP1REG)                            01S0473 01309000
         ST    @10,BUFPTR                                       01S0473 01310000
*           /*********************************************************/ 01311000
*           /*                                                       */ 01312000
*           /* BUILD EXPECTED R0 COUNT FOR COMPARE                   */ 01313000
*           /*                                                       */ 01314000
*           /*********************************************************/ 01315000
*                                                               01S0474 01316000
*           AP1WRKA->CNTCCHH=CECCHH;/* CCHH                          */ 01317000
         L     @09,AP1WRKA(,AP1REG)                             01S0474 01318000
         MVC   CNTCCHH(4,@09),CECCHH(AP1REG)                    01S0474 01319000
*           AP1WRKA->CNTRKDD=R0DL8; /* RKDD                          */ 01320000
         MVC   CNTRKDD(4,@09),@CB00292                          01S0475 01321000
*           IF BUFPTR->CNT=AP1WRKA->CNT THEN/* R0 OK                 */ 01322000
         CLC   CNT(8,@10),CNT(@09)                              01S0476 01323000
         BNE   @RF00476                                         01S0476 01324000
*             DO;                                               01S0477 01325000
*               BUFPTR=BUFPTR+LENGTH(CNT);/* POINT TO FIRST R1 COUNT */ 01326000
*                                                               01S0478 01327000
         AL    @10,@CF00047                                     01S0478 01328000
         ST    @10,BUFPTR                                       01S0478 01329000
*               /*****************************************************/ 01330000
*               /*                                                   */ 01331000
*               /* BUILD EXPECTED R1 COUNT                           */ 01332000
*               /*                                                   */ 01333000
*               /*****************************************************/ 01334000
*                                                               01S0479 01335000
*               AP1WRKA->CNTRKDD=R1DL256;/* RKDD                     */ 01336000
         MVC   CNTRKDD(4,@09),@CB00294                          01S0479 01337000
*               DO WHILE AP1WRKA->CNTHH<=HI3344HD&AP1ERROR=OFF;/*       01338000
*                                      CHECK TRACKS 0 TO 11          */ 01339000
         B     @DE00480                                         01S0480 01340000
@DL00480 DS    0H                                               01S0481 01341000
*                 IF BUFPTR->CNTÂ¬=AP1WRKA->CNT THEN/* COMPARE ERROR  */ 01342000
         L     @10,AP1WRKA(,AP1REG)                             01S0481 01343000
         L     @09,BUFPTR                                       01S0481 01344000
         CLC   CNT(8,@09),CNT(@10)                              01S0481 01345000
         BE    @RF00481                                         01S0481 01346000
*                   AP1ERROR=ON;    /* DRIVE PROBLEM                 */ 01347000
         OI    AP1ERROR(AP1REG),B'00100000'                     01S0482 01348000
*                 ELSE              /* COUNT OK                      */ 01349000
*                   DO;                                         01S0483 01350000
         B     @RC00481                                         01S0483 01351000
@RF00481 DS    0H                                               01S0484 01352000
*                     BUFPTR=BUFPTR+LENGTH(CNT);/* TO NEXT COUNT     */ 01353000
         LA    @10,8                                            01S0484 01354000
         AL    @10,BUFPTR                                       01S0484 01355000
         ST    @10,BUFPTR                                       01S0484 01356000
*                     AP1WRKA->CNTHH=AP1WRKA->CNTHH+1;/* NEXT TRACK  */ 01357000
         L     @10,AP1WRKA(,AP1REG)                             01S0485 01358000
         LA    @09,1                                            01S0485 01359000
         SLR   @15,@15                                          01S0485 01360000
         ICM   @15,3,CNTHH(@10)                                 01S0485 01361000
         ALR   @09,@15                                          01S0485 01362000
         STCM  @09,3,CNTHH(@10)                                 01S0485 01363000
*                   END;                                        01S0486 01364000
*               END;                /* DO WHILE                      */ 01365000
@RC00481 DS    0H                                               01S0487 01366000
@DE00480 L     @10,AP1WRKA(,AP1REG)                             01S0487 01367000
         CLC   CNTHH(2,@10),@CB00316                            01S0487 01368000
         BH    @DC00480                                         01S0487 01369000
         TM    AP1ERROR(AP1REG),B'00100000'                     01S0487 01370000
         BZ    @DL00480                                         01S0487 01371000
@DC00480 DS    0H                                               01S0488 01372000
*               IF AP1ERROR=OFF THEN/* NO ERRORS SO FAR              */ 01373000
         TM    AP1ERROR(AP1REG),B'00100000'                     01S0488 01374000
         BNZ   @RF00488                                         01S0488 01375000
*                 DO;                                           01S0489 01376000
*                   AP1WRKA->CNTHH=HI3344HD;/* BACK TO HD 11         */ 01377000
         L     @10,AP1WRKA(,AP1REG)                             01S0490 01378000
         MVC   CNTHH(2,@10),@CB00316                            01S0490 01379000
*                   IF BUFPTR->CNTÂ¬=AP1WRKA->CNT THEN/* RCKD READ       01380000
*                                      WRONG COUNT                   */ 01381000
         L     @09,BUFPTR                                       01S0491 01382000
         CLC   CNT(8,@09),CNT(@10)                              01S0491 01383000
         BE    @RF00491                                         01S0491 01384000
*                     AP1ERROR=ON;  /* DRIVE FAILURE                 */ 01385000
         OI    AP1ERROR(AP1REG),B'00100000'                     01S0492 01386000
*                   ELSE                                        01S0493 01387000
*                     ;             /* COUNT OK                      */ 01388000
@RF00491 DS    0H                                               01S0494 01389000
*                 END;                                          01S0494 01390000
*               ELSE                                            01S0495 01391000
*                 ;                 /* ERROR ALLREADY                */ 01392000
@RF00488 DS    0H                                               01S0496 01393000
*             END;                                              01S0496 01394000
*           ELSE                    /* R0 COUNT BAD                  */ 01395000
*             AP1ERROR=ON;          /* DRIVE FAILURE                 */ 01396000
         B     @RC00476                                         01S0497 01397000
@RF00476 OI    AP1ERROR(AP1REG),B'00100000'                     01S0497 01398000
*           IF AP1ERROR=ON THEN     /* DATA COMPARE ERROR            */ 01399000
@RC00476 TM    AP1ERROR(AP1REG),B'00100000'                     01S0498 01400000
         BNO   @RF00498                                         01S0498 01401000
*             DO;                                               01S0499 01402000
*               AP1PRCOD=PRDMTDC;   /* RDMT DATA COMPARE MESSAGE     */ 01403000
         MVI   AP1PRCOD(AP1REG),X'14'                           01S0500 01404000
*               CALL CVTEBCDX(AP1WRKA,ADDR(AP1PRMSG)+32,LENGTH(CNT));   01405000
         LA    @10,AP1WRKA(,AP1REG)                             01S0501 01406000
         ST    @10,@AL00001                                     01S0501 01407000
         LA    @10,AP1PRMSG(,AP1REG)                            01S0501 01408000
         AL    @10,@CF00289                                     01S0501 01409000
         ST    @10,@AFTEMPS                                     01S0501 01410000
         LA    @10,@AFTEMPS                                     01S0501 01411000
         ST    @10,@AL00001+4                                   01S0501 01412000
         LA    @10,@CF00047                                     01S0501 01413000
         ST    @10,@AL00001+8                                   01S0501 01414000
         LA    @01,@AL00001                                     01S0501 01415000
         BAL   @14,CVTEBCDX                                     01S0501 01416000
*                                   /* CNVT EXPECTED TO EBCDIC       */ 01417000
*               CALL CVTEBCDX(BUFPTR,ADDR(AP1PRMSG)+60,LENGTH(CNT));    01418000
         LA    @10,BUFPTR                                       01S0502 01419000
         ST    @10,@AL00001                                     01S0502 01420000
         LA    @10,AP1PRMSG(,AP1REG)                            01S0502 01421000
         AL    @10,@CF00133                                     01S0502 01422000
         ST    @10,@AFTEMPS                                     01S0502 01423000
         LA    @10,@AFTEMPS                                     01S0502 01424000
         ST    @10,@AL00001+4                                   01S0502 01425000
         LA    @10,@CF00047                                     01S0502 01426000
         ST    @10,@AL00001+8                                   01S0502 01427000
         LA    @01,@AL00001                                     01S0502 01428000
         BAL   @14,CVTEBCDX                                     01S0502 01429000
*                                   /* CNVT RECEIVED TO EBCDIC       */ 01430000
*               AP1PRERR=ON;        /* CAUSE MSG TO BE PRINTED       */ 01431000
*               AP1QUIT=ON;         /* STOP TESTING                  */ 01432000
         OI    AP1PRERR(AP1REG),B'00011000'                     01S0504 01433000
*             END;                                              01S0505 01434000
*           ELSE                                                01S0506 01435000
*             ;                     /* DATA COMPARED OK              */ 01436000
@RF00498 DS    0H                                               01S0507 01437000
*         END;                                                  01S0507 01438000
*       AP1TSTNO=AP1TSTNO+1;        /* GO TO NEXT TEST               */ 01439000
@RC00466 LA    @10,1                                            01S0508 01440000
         SLR   @09,@09                                          01S0508 01441000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0508 01442000
         ALR   @10,@09                                          01S0508 01443000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0508 01444000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01445000
         B     CE0001@                                          01S0509 01446000
*     END RDMT;                     /* END OF SUBCASE                */ 01447000
*                                                               01S0510 01448000
*     /***************************************************************/ 01449000
*     /*                                                             */ 01450000
*     /* FTWRT: FULL TRACK WRITE                                     */ 01451000
*     /*                                                             */ 01452000
*     /***************************************************************/ 01453000
*                                                               01S0511 01454000
*FTWRT:                                                         01S0511 01455000
*     DO;                           /* SUBCASE CHECKS FULL TRACK        01456000
*                                      WRITE                         */ 01457000
FTWRT    DS    0H                                               01S0512 01458000
*/*   CHECKS FOR I/O ERRORS                                          */ 01459000
*                                                               01S0512 01460000
*       IF AP1PCODEÂ¬=NRMC THEN      /* ERROR ON I/O                  */ 01461000
         CLI   AP1PCODE(AP1REG),X'7F'                           01S0512 01462000
         BE    @RF00512                                         01S0512 01463000
*         AP1PRERR=ON;              /* INDICATE ERROR                */ 01464000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0513 01465000
*       ELSE                                                    01S0514 01466000
*         ;                         /* I/O OK                        */ 01467000
@RF00512 DS    0H                                               01S0515 01468000
*       AP1TSTNO=AP1TSTNO+1;        /* INCREMENT TO NEXT TEST        */ 01469000
         LA    @10,1                                            01S0515 01470000
         SLR   @09,@09                                          01S0515 01471000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0515 01472000
         ALR   @10,@09                                          01S0515 01473000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0515 01474000
*       IF AP1PRERR=ON THEN         /* I/O ERROR                     */ 01475000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0516 01476000
         BNO   @RF00516                                         01S0516 01477000
*         DO;                                                   01S0517 01478000
*           AP1ERROR=ON;            /* DRIVE PROBLEM                 */ 01479000
*           AP1QUIT=ON;             /* STOP TESTING                  */ 01480000
         OI    AP1ERROR(AP1REG),B'00101000'                     01S0519 01481000
*           AP1PRCOD=PFTWRTER;      /* FTWRT ERROR MSG               */ 01482000
         MVI   AP1PRCOD(AP1REG),X'15'                           01S0520 01483000
*         END;                                                  01S0521 01484000
*       ELSE                                                    01S0522 01485000
*         ;                         /* NO ERROR                      */ 01486000
@RF00516 DS    0H                                               01S0523 01487000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01488000
         B     CE0001@                                          01S0523 01489000
*     END FTWRT;                    /* END OF SUBCASE                */ 01490000
*                                                               01S0524 01491000
*     /***************************************************************/ 01492000
*     /*                                                             */ 01493000
*     /* AMDET: ADDRESS MARK DETECT                                  */ 01494000
*     /*                                                             */ 01495000
*     /***************************************************************/ 01496000
*                                                               01S0525 01497000
*AMDET:                                                         01S0525 01498000
*     DO;                           /* SUBCASE CHECK AM DETECTION    */ 01499000
AMDET    DS    0H                                               01S0526 01500000
*/*   CHECKS FOR I/O ERRORS AND COMPARES COUNT READ                  */ 01501000
*                                                               01S0526 01502000
*       IF AP1PCODEÂ¬=NRMC THEN      /* ERROR ON I/O                  */ 01503000
         CLI   AP1PCODE(AP1REG),X'7F'                           01S0526 01504000
         BE    @RF00526                                         01S0526 01505000
*         AP1PRERR=ON;              /* INDICATE ERROR                */ 01506000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0527 01507000
*       ELSE                                                    01S0528 01508000
*         ;                         /* I/O OK                        */ 01509000
@RF00526 DS    0H                                               01S0529 01510000
*       AP1TSTNO=AP1TSTNO+1;        /* GO TO NEXT TEST               */ 01511000
         LA    @10,1                                            01S0529 01512000
         SLR   @09,@09                                          01S0529 01513000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0529 01514000
         ALR   @10,@09                                          01S0529 01515000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0529 01516000
*       IF AP1PRERR=ON THEN         /* I/O ERROR                     */ 01517000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0530 01518000
         BNO   @RF00530                                         01S0530 01519000
*         DO;                                                   01S0531 01520000
*           AP1PRCOD=PAMDETER;      /* AMDET ERROR MSG               */ 01521000
         MVI   AP1PRCOD(AP1REG),X'16'                           01S0532 01522000
*           AP1ERROR=ON;            /* DRIVE PROBLEM                 */ 01523000
*           AP1QUIT=ON;             /* STOP TESTING                  */ 01524000
         OI    AP1ERROR(AP1REG),B'00101000'                     01S0534 01525000
*         END;                                                  01S0535 01526000
*       ELSE                        /* NO HDWE DETECTED ERROR        */ 01527000
*         IF(AP1BUFAD+LENGTH(CNT))->CNTÂ¬=(AP1BUFAD+LENGTH(CNT)*2)->CNT  01528000
*           THEN                    /* READ WRONG RECORD             */ 01529000
         B     @RC00530                                         01S0536 01530000
@RF00530 L     @10,AP1BUFAD(,AP1REG)                            01S0536 01531000
         CLC   CNT+8(8,@10),CNT+16(@10)                         01S0536 01532000
         BE    @RF00536                                         01S0536 01533000
*           DO;                                                 01S0537 01534000
*             AP1PRCOD=PAMDETDC;    /* AMDET DATA COMPARE ERROR MSG  */ 01535000
         MVI   AP1PRCOD(AP1REG),X'17'                           01S0538 01536000
*             CALL CVTEBCDX(BUFPTR,ADDR(AP1PRMSG)+33,LENGTH(CNT));/*    01537000
*                                      CNVT EXPECTED TP EBCDIC       */ 01538000
         LA    @10,BUFPTR                                       01S0539 01539000
         ST    @10,@AL00001                                     01S0539 01540000
         LA    @10,AP1PRMSG(,AP1REG)                            01S0539 01541000
         AL    @10,@CF00283                                     01S0539 01542000
         ST    @10,@AFTEMPS                                     01S0539 01543000
         LA    @10,@AFTEMPS                                     01S0539 01544000
         ST    @10,@AL00001+4                                   01S0539 01545000
         LA    @10,@CF00047                                     01S0539 01546000
         ST    @10,@AL00001+8                                   01S0539 01547000
         LA    @01,@AL00001                                     01S0539 01548000
         BAL   @14,CVTEBCDX                                     01S0539 01549000
*             CALL CVTEBCDX(BUFPTR+LENGTH(CNT)*2,ADDR(AP1PRMSG)+61,     01550000
*                 LENGTH(CNT));     /* CNVT RECEIVED TO EBCDIC       */ 01551000
         LA    @10,16                                           01S0540 01552000
         AL    @10,BUFPTR                                       01S0540 01553000
         ST    @10,@AFTEMPS                                     01S0540 01554000
         LA    @10,@AFTEMPS                                     01S0540 01555000
         ST    @10,@AL00001                                     01S0540 01556000
         LA    @10,AP1PRMSG(,AP1REG)                            01S0540 01557000
         AL    @10,@CF00457                                     01S0540 01558000
         ST    @10,@AFTEMPS+4                                   01S0540 01559000
         LA    @10,@AFTEMPS+4                                   01S0540 01560000
         ST    @10,@AL00001+4                                   01S0540 01561000
         LA    @10,@CF00047                                     01S0540 01562000
         ST    @10,@AL00001+8                                   01S0540 01563000
         LA    @01,@AL00001                                     01S0540 01564000
         BAL   @14,CVTEBCDX                                     01S0540 01565000
*             AP1ERROR=ON;          /* DRIVE PROBLEM                 */ 01566000
*             AP1PRERR=ON;          /* PRINT MSG                     */ 01567000
*             AP1QUIT=ON;           /* STOP TESTING                  */ 01568000
         OI    AP1ERROR(AP1REG),B'00111000'                     01S0543 01569000
*           END;                                                01S0544 01570000
*         ELSE                                                  01S0545 01571000
*           ;                       /* RECORD CORRECT                */ 01572000
@RF00536 DS    0H                                               01S0546 01573000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01574000
         B     CE0001@                                          01S0546 01575000
*     END AMDET;                    /* END OF SUBCASE                */ 01576000
*                                                               01S0547 01577000
*     /***************************************************************/ 01578000
*     /*                                                             */ 01579000
*     /* WRTPAD: FORMAT WRITE PADDING                                */ 01580000
*     /*                                                             */ 01581000
*     /***************************************************************/ 01582000
*                                                               01S0548 01583000
*WRTPAD:                                                        01S0548 01584000
*     DO;                           /* SUBCASE CHECKS WRITE PAD TEST */ 01585000
WRTPAD   DS    0H                                               01S0549 01586000
*/*   CHECKS FOR I/O ERRORS AND TO SEE THAT ONLY RECORD ONE READ     */ 01587000
*                                                               01S0549 01588000
*       IF AP1PCODEÂ¬=NRMC THEN      /* ERROR ON I/O                  */ 01589000
         CLI   AP1PCODE(AP1REG),X'7F'                           01S0549 01590000
         BE    @RF00549                                         01S0549 01591000
*         AP1PRERR=ON;              /* INDICATE ERROR                */ 01592000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0550 01593000
*       ELSE                                                    01S0551 01594000
*         ;                         /* I/O OK                        */ 01595000
@RF00549 DS    0H                                               01S0552 01596000
*       AP1TSTNO=AP1TSTNO+1;        /* GO TO NEXT TEST               */ 01597000
         LA    @10,1                                            01S0552 01598000
         SLR   @09,@09                                          01S0552 01599000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0552 01600000
         ALR   @10,@09                                          01S0552 01601000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0552 01602000
*       IF AP1PRERR=ON THEN         /* I/O ERROR                     */ 01603000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0553 01604000
         BNO   @RF00553                                         01S0553 01605000
*         DO;                                                   01S0554 01606000
*           AP1PRCOD=PWPADER;       /* WRTPAD ERROR MSG              */ 01607000
         MVI   AP1PRCOD(AP1REG),X'1C'                           01S0555 01608000
*           AP1ERROR=ON;            /* DRIVE FAILURE                 */ 01609000
*           AP1QUIT=ON;             /* STOP TESTING                  */ 01610000
         OI    AP1ERROR(AP1REG),B'00101000'                     01S0557 01611000
*         END;                                                  01S0558 01612000
*       ELSE                        /* NO HDWE DETECTED ERROR        */ 01613000
*         IF(AP1BUFAD+LENGTH(CNT)*2)->CNTÂ¬=AP1BUFAD->CNT THEN/* READ    01614000
*                                      OVERWRITTEN RECORD            */ 01615000
         B     @RC00553                                         01S0559 01616000
@RF00553 L     @10,AP1BUFAD(,AP1REG)                            01S0559 01617000
         LA    @09,16                                           01S0559 01618000
         ALR   @09,@10                                          01S0559 01619000
         CLC   CNT(8,@09),CNT(@10)                              01S0559 01620000
         BE    @RF00559                                         01S0559 01621000
*           DO;                                                 01S0560 01622000
*             AP1PRCOD=PWPADDC;     /* WRTPAD WRONG RECORD           */ 01623000
         MVI   AP1PRCOD(AP1REG),X'1D'                           01S0561 01624000
*             CALL CVTEBCDX(AP1BUFAD+LENGTH(CNT)*2,ADDR(AP1PRMSG)+33,   01625000
*                 LENGTH(CNT));     /* CNVT EXPECTED TO EBCDIC       */ 01626000
         ST    @09,@AFTEMPS                                     01S0562 01627000
         LA    @10,@AFTEMPS                                     01S0562 01628000
         ST    @10,@AL00001                                     01S0562 01629000
         LA    @10,AP1PRMSG(,AP1REG)                            01S0562 01630000
         AL    @10,@CF00283                                     01S0562 01631000
         ST    @10,@AFTEMPS+4                                   01S0562 01632000
         LA    @10,@AFTEMPS+4                                   01S0562 01633000
         ST    @10,@AL00001+4                                   01S0562 01634000
         LA    @10,@CF00047                                     01S0562 01635000
         ST    @10,@AL00001+8                                   01S0562 01636000
         LA    @01,@AL00001                                     01S0562 01637000
         BAL   @14,CVTEBCDX                                     01S0562 01638000
*             CALL CVTEBCDX(AP1BUFAD+LENGTH(CNT)*3,ADDR(AP1PRMSG)+61,   01639000
*                 LENGTH(CNT));     /* CNVT RECEIVED TO EBCDIC       */ 01640000
         LA    @10,24                                           01S0563 01641000
         AL    @10,AP1BUFAD(,AP1REG)                            01S0563 01642000
         ST    @10,@AFTEMPS                                     01S0563 01643000
         LA    @10,@AFTEMPS                                     01S0563 01644000
         ST    @10,@AL00001                                     01S0563 01645000
         LA    @10,AP1PRMSG(,AP1REG)                            01S0563 01646000
         AL    @10,@CF00457                                     01S0563 01647000
         ST    @10,@AFTEMPS+4                                   01S0563 01648000
         LA    @10,@AFTEMPS+4                                   01S0563 01649000
         ST    @10,@AL00001+4                                   01S0563 01650000
         LA    @10,@CF00047                                     01S0563 01651000
         ST    @10,@AL00001+8                                   01S0563 01652000
         LA    @01,@AL00001                                     01S0563 01653000
         BAL   @14,CVTEBCDX                                     01S0563 01654000
*             AP1ERROR=ON;          /* DRIVE PROBLEM                 */ 01655000
*             AP1PRERR=ON;          /* PRINT MSG                     */ 01656000
*             AP1QUIT=ON;           /* STOP TESTING                  */ 01657000
         OI    AP1ERROR(AP1REG),B'00111000'                     01S0566 01658000
*           END;                                                01S0567 01659000
*         ELSE                                                  01S0568 01660000
*           ;                       /* CORRECT RECORD                */ 01661000
@RF00559 DS    0H                                               01S0569 01662000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01663000
         B     CE0001@                                          01S0569 01664000
*     END WRTPAD;                   /* END OF SUBCASE                */ 01665000
*                                                               01S0570 01666000
*     /***************************************************************/ 01667000
*     /*                                                             */ 01668000
*     /* SD: SKIP DEFECTS                                            */ 01669000
*     /*                                                             */ 01670000
*     /***************************************************************/ 01671000
*                                                               01S0571 01672000
*SD:                                                            01S0571 01673000
*     DO;                           /* SUBCASE CHKS SKIP DEFECT      */ 01674000
SD       DS    0H                                               01S0572 01675000
*/*   CHECKS FOR I/O ERRORS                                          */ 01676000
*                                                               01S0572 01677000
*       IF AP1PCODEÂ¬=NRMC THEN      /* ERROR ON I/O                  */ 01678000
         CLI   AP1PCODE(AP1REG),X'7F'                           01S0572 01679000
         BE    @RF00572                                         01S0572 01680000
*         AP1PRERR=ON;              /* INDICATE ERROR                */ 01681000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0573 01682000
*       ELSE                                                    01S0574 01683000
*         ;                         /* I/O OK                        */ 01684000
@RF00572 DS    0H                                               01S0575 01685000
*       IF AP1PRERR=ON THEN         /* I/O ERROR                     */ 01686000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0575 01687000
         BNO   @RF00575                                         01S0575 01688000
*         DO;                                                   01S0576 01689000
*           AP1ERROR=ON;            /* DRIVE PROBLEM                 */ 01690000
         OI    AP1ERROR(AP1REG),B'00100000'                     01S0577 01691000
*           AP1PRCOD=PSDER;         /* SD ERROR MSG                  */ 01692000
         MVI   AP1PRCOD(AP1REG),X'18'                           01S0578 01693000
*         END;                                                  01S0579 01694000
*       ELSE                                                    01S0580 01695000
*         ;                         /* NO I/O ERROR                  */ 01696000
@RF00575 DS    0H                                               01S0581 01697000
*       AP1TSTNO=AP1TSTNO+1;        /* INCR TO NEXT TEST             */ 01698000
         LA    @10,1                                            01S0581 01699000
         SLR   @09,@09                                          01S0581 01700000
         IC    @09,AP1TSTNO(,AP1REG)                            01S0581 01701000
         ALR   @10,@09                                          01S0581 01702000
         STC   @10,AP1TSTNO(,AP1REG)                            01S0581 01703000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01704000
         B     CE0001@                                          01S0582 01705000
*     END SD;                       /* END OF SUBCASE                */ 01706000
*                                                               01S0583 01707000
*     /***************************************************************/ 01708000
*     /*                                                             */ 01709000
*     /* CLEANUP: RESTORE CE CYL TRK 1                               */ 01710000
*     /*                                                             */ 01711000
*     /***************************************************************/ 01712000
*                                                               01S0584 01713000
*CLEANUP:                                                       01S0584 01714000
*     DO;                           /* SUBCASE                       */ 01715000
CLEANUP  DS    0H                                               01S0585 01716000
*/*   CHECKS FOR I/O ERRORS                                          */ 01717000
*                                                               01S0585 01718000
*       IF AP1PCODEÂ¬=NRMC THEN      /* ERROR                         */ 01719000
         CLI   AP1PCODE(AP1REG),X'7F'                           01S0585 01720000
         BE    @RF00585                                         01S0585 01721000
*         AP1PRERR=ON;              /* INDICATE ERROR                */ 01722000
         OI    AP1PRERR(AP1REG),B'00010000'                     01S0586 01723000
*       ELSE                                                    01S0587 01724000
*         ;                         /* NO ERROR                      */ 01725000
@RF00585 DS    0H                                               01S0588 01726000
*       AP1LST=ON;                  /* LAST TEST                     */ 01727000
         OI    AP1LST(AP1REG),B'01000000'                       01S0588 01728000
*       IF AP1PRERR=ON THEN         /* CLEANUP FAILED                */ 01729000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0589 01730000
         BNO   @RF00589                                         01S0589 01731000
*         DO;                                                   01S0590 01732000
*           AP1ERROR=ON;            /* DRIVE FAILURE                 */ 01733000
*           AP1QUIT=ON;             /* STOP TESTING                  */ 01734000
         OI    AP1ERROR(AP1REG),B'00101000'                     01S0592 01735000
*           AP1PRCOD=PCLNERR;       /* ERROR MSG                     */ 01736000
         MVI   AP1PRCOD(AP1REG),X'21'                           01S0593 01737000
*         END;                                                  01S0594 01738000
*       ELSE                                                    01S0595 01739000
*         ;                         /* OK                            */ 01740000
@RF00589 DS    0H                                               01S0596 01741000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01742000
         B     CE0001@                                          01S0596 01743000
*     END CLEANUP;                  /* END OF SUBCASE                */ 01744000
*CE0001@:                                                       01S0598 01745000
*   END;                            /* END OF CASE                   */ 01746000
         EJECT                                                          01747000
*                                                               01S0599 01748000
*   /*****************************************************************/ 01749000
*   /*                                                               */ 01750000
*   /* CVTEBCDX: PROCEDURE                                           */ 01751000
*   /*                                                               */ 01752000
*   /*****************************************************************/ 01753000
*                                                               01S0599 01754000
*CVTEBCDX:                                                      01S0599 01755000
*   PROC(INAREA,OUTAREA,BYTES);     /* INTERNAL TO AP1 PROC          */ 01756000
*                                                               01S0599 01757000
         B     @PB00002                                         01S0599 01758000
CVTEBCDX STM   @14,@12,@SA00002                                 01S0599 01759000
         MVC   @PC00002(12),0(@01)                              01S0599 01760000
*   /*****************************************************************/ 01761000
*   /*                                                               */ 01762000
*   /* CONVERTS BINARY DATA IN STORAGE TO EBCDIC DATA IN STORAGE     */ 01763000
*   /* INAREA IS AREA CONTAINING BINARY DATA. OUTAREA IS AREA TO     */ 01764000
*   /* CONTAIN EBCDIC DATA IN THE FORM XXXX XXXX.... BYTES IS NUMBER */ 01765000
*   /* OF BYTES IN INAREA.                                           */ 01766000
*   /*                                                               */ 01767000
*   /*****************************************************************/ 01768000
*                                                               01S0600 01769000
*   RFY                                                         01S0600 01770000
*    (GPR00F,                                                   01S0600 01771000
*     GPR01P) RSTD;                                             01S0600 01772000
*   DO COUNTER=1 TO(BYTES/2);       /* TWO BYTES AT A TIME           */ 01773000
         LA    COUNTER,1                                        01S0601 01774000
         B     @DE00601                                         01S0601 01775000
@DL00601 DS    0H                                               01S0602 01776000
*     GPR00F=INAREA->FIXED16(COUNTER);/* GET HALFWORD OF BINARY      */ 01777000
         LR    @10,COUNTER                                      01S0602 01778000
         ALR   @10,@10                                          01S0602 01779000
         L     @09,@PC00002                                     01S0602 01780000
         L     @09,INAREA(,@09)                                 01S0602 01781000
         BCTR  @09,0                                            01S0602 01782000
         BCTR  @09,0                                            01S0602 01783000
         LH    GPR00F,FIXED16(@10,@09)                          01S0602 01784000
         N     GPR00F,@CF00505                                  01S0602 01785000
*     GPR01P=OUTAREA+(5*(COUNTER-1));/* AREA FOR EBCDIC              */ 01786000
         L     @10,@PC00002+4                                   01S0603 01787000
         LR    GPR01P,COUNTER                                   01S0603 01788000
         BCTR  GPR01P,0                                         01S0603 01789000
         MH    GPR01P,@CH00083                                  01S0603 01790000
         AL    GPR01P,OUTAREA(,@10)                             01S0603 01791000
*     CALL CVTEBCD;                 /* CONVERTS TO EBCDIC            */ 01792000
         BAL   @14,CVTEBCD                                      01S0604 01793000
*   END;                            /* OF DO                         */ 01794000
         AL    COUNTER,@CF00043                                 01S0605 01795000
@DE00601 L     @10,@PC00002+8                                   01S0605 01796000
         L     @04,BYTES(,@10)                                  01S0605 01797000
         SRDA  @04,32                                           01S0605 01798000
         D     @04,@CF00058                                     01S0605 01799000
         CR    COUNTER,@05                                      01S0605 01800000
         BNH   @DL00601                                         01S0605 01801000
*   RFY                                                         01S0606 01802000
*    (GPR00F,                                                   01S0606 01803000
*     GPR01P) UNRSTD;                                           01S0606 01804000
*   END;                            /* OF CVTEBCDX PROC              */ 01805000
@EL00002 DS    0H                                               01S0607 01806000
@EF00002 DS    0H                                               01S0607 01807000
@ER00002 LM    @14,@12,@SA00002                                 01S0607 01808000
         BR    @14                                              01S0607 01809000
         EJECT                                                          01810000
*                                                               01S0608 01811000
*   /*****************************************************************/ 01812000
*   /*                                                               */ 01813000
*   /* ERROR1: PROCEDURE                                             */ 01814000
*   /*                                                               */ 01815000
*   /*****************************************************************/ 01816000
*                                                               01S0608 01817000
*ERROR1:                                                        01S0608 01818000
*   PROC;                           /* INTERNAL TO AP1 PROC          */ 01819000
*                                                               01S0608 01820000
ERROR1   STM   @14,@12,12(@13)                                  01S0608 01821000
*   /*****************************************************************/ 01822000
*   /*                                                               */ 01823000
*   /* INTERPRETS ERRORS FOR READ HA NOT ON CE CYL TURNS BITS ON IN  */ 01824000
*   /* HEAD ERROR TABLE-- DCK FOR A DATA CHECK AND SKVERCK FOR A SEEK*/ 01825000
*   /* VERIFY CHECK--IF NEITHER, TURNS ON AP1QUIT                    */ 01826000
*   /*                                                               */ 01827000
*   /*****************************************************************/ 01828000
*                                                               01S0609 01829000
*   AP1ERROR=ON;                    /* INDICATE DRIVE FAILURE        */ 01830000
         OI    AP1ERROR(AP1REG),B'00100000'                     01S0609 01831000
*   IF AP1PCODE=ERRC&CSWUNCHK=ON&(CSWADDRB-LENGTH(CCW))->CCWCOMCD(1)=   01832000
*       RDHA THEN                   /* UNIT CHECK ON THE READ HA     */ 01833000
         CLI   AP1PCODE(AP1REG),X'41'                           01S0610 01834000
         BNE   @RF00610                                         01S0610 01835000
         LA    @10,AP1CSW(,AP1REG)                              01S0610 01836000
         BCTR  @10,0                                            01S0610 01837000
         TM    CSWUNCHK(@10),B'00000010'                        01S0610 01838000
         BNO   @RF00610                                         01S0610 01839000
         L     @10,CSWADDRB-1(,@10)                             01S0610 01840000
         AL    @10,@CF00504                                     01S0610 01841000
         CLI   CCWCOMCD(@10),26                                 01S0610 01842000
         BNE   @RF00610                                         01S0610 01843000
*     IF SNSDATA=ON|(SNSEQU=ON&SNS7=FMT10&(SNS17&NDFMSK)=NDF) THEN/*    01844000
*                                      DATA CHECK                    */ 01845000
         LA    @10,188                                          01S0611 01846000
         ALR   @10,AP1REG                                       01S0611 01847000
         TM    SNSDATA(@10),B'00001000'                         01S0611 01848000
         BO    @RT00611                                         01S0611 01849000
         TM    SNSEQU(@10),B'00010000'                          01S0611 01850000
         BNO   @RF00611                                         01S0611 01851000
         CLI   SNS7(@10),X'10'                                  01S0611 01852000
         BNE   @RF00611                                         01S0611 01853000
         MVC   @TS00001(1),SNS17(@10)                           01S0611 01854000
         NI    @TS00001,X'FE'                                   01S0611 01855000
         CLI   @TS00001,X'C0'                                   01S0611 01856000
         BNE   @RF00611                                         01S0611 01857000
@RT00611 DS    0H                                               01S0612 01858000
*       DCK=ON;                     /* INDICATE IN TABLE             */ 01859000
         L     @10,AP1ETABA(,AP1REG)                            01S0612 01860000
         OI    DCK(@10),B'10000000'                             01S0612 01861000
*     ELSE                          /* NOT DATA CHECK                */ 01862000
*       IF SNS7=SKCHK7&((AP1DEVTP=AP13344&SNSSKCK=ON)|(AP1DEVTPÂ¬=       01863000
*           AP13344&SNSEQU=ON)) THEN/* SEEK VERIFY ERROR             */ 01864000
         B     @RC00611                                         01S0613 01865000
@RF00611 LA    @10,188                                          01S0613 01866000
         ALR   @10,AP1REG                                       01S0613 01867000
         CLI   SNS7(@10),X'1A'                                  01S0613 01868000
         BNE   @RF00613                                         01S0613 01869000
         CLI   AP1DEVTP(AP1REG),3                               01S0613 01870000
         BNE   @GL00029                                         01S0613 01871000
         TM    SNSSKCK(@10),B'00000001'                         01S0613 01872000
         BO    @RT00613                                         01S0613 01873000
@GL00029 CLI   AP1DEVTP(AP1REG),3                               01S0613 01874000
         BE    @RF00613                                         01S0613 01875000
         TM    SNSEQU+188(AP1REG),B'00010000'                   01S0613 01876000
         BNO   @RF00613                                         01S0613 01877000
@RT00613 DS    0H                                               01S0614 01878000
*         SKVERCK=ON;               /* INDICATE IN TABLE             */ 01879000
         L     @10,AP1ETABA(,AP1REG)                            01S0614 01880000
         OI    SKVERCK(@10),B'01000000'                         01S0614 01881000
*       ELSE                        /* NOT DCK OR SKVERCK            */ 01882000
*         AP1QUIT=ON;               /* STOP TESTING                  */ 01883000
         B     @RC00613                                         01S0615 01884000
@RF00613 OI    AP1QUIT(AP1REG),B'00001000'                      01S0615 01885000
*   ELSE                            /* NOT DCK OR SKVERCK ON RHA     */ 01886000
*     AP1QUIT=ON;                   /* STOP TESTING                  */ 01887000
         B     @RC00610                                         01S0616 01888000
@RF00610 OI    AP1QUIT(AP1REG),B'00001000'                      01S0616 01889000
*   END;                            /* OR ERROR1 PROC                */ 01890000
@EL00003 DS    0H                                               01S0617 01891000
@EF00003 DS    0H                                               01S0617 01892000
@ER00003 LM    @14,@12,12(@13)                                  01S0617 01893000
         BR    @14                                              01S0617 01894000
         EJECT                                                          01895000
*                                                               01S0618 01896000
*   /*****************************************************************/ 01897000
*   /*                                                               */ 01898000
*   /* ERROR2: PROCEDURE                                             */ 01899000
*   /*                                                               */ 01900000
*   /*****************************************************************/ 01901000
*                                                               01S0618 01902000
*ERROR2:                                                        01S0618 01903000
*   PROC;                           /* INTERNAL TO AP1 PROC          */ 01904000
*                                                               01S0618 01905000
ERROR2   STM   @14,@12,12(@13)                                  01S0618 01906000
*   /*****************************************************************/ 01907000
*   /*                                                               */ 01908000
*   /* INTERPRETS ERRORS FOR READ HA ON CE CYL SETS BITS IN HEAD     */ 01909000
*   /* ERROR TABLE-- SETS DCKCE FOR DATA CHECK AND SKVERCK FOR SEEK  */ 01910000
*   /* VERIFY CHECK--IF NEITHER, SETS AP1QUIT                        */ 01911000
*   /*                                                               */ 01912000
*   /*****************************************************************/ 01913000
*                                                               01S0619 01914000
*   AP1ERROR=ON;                    /* INDICATE DRIVE FAILURE        */ 01915000
         OI    AP1ERROR(AP1REG),B'00100000'                     01S0619 01916000
*   IF AP1PCODE=ERRC&CSWUNCHK=ON&(CSWADDRB-LENGTH(CCW))->CCWRD(1)=ON&(  01917000
*       CSWADDRB-LENGTH(CCW))->CCWWR(1)=OFF THEN/* UNIT CHK ON READ  */ 01918000
         CLI   AP1PCODE(AP1REG),X'41'                           01S0620 01919000
         BNE   @RF00620                                         01S0620 01920000
         LA    @10,AP1CSW(,AP1REG)                              01S0620 01921000
         BCTR  @10,0                                            01S0620 01922000
         TM    CSWUNCHK(@10),B'00000010'                        01S0620 01923000
         BNO   @RF00620                                         01S0620 01924000
         L     @10,CSWADDRB-1(,@10)                             01S0620 01925000
         AL    @10,@CF00504                                     01S0620 01926000
         TM    CCWRD(@10),B'00000010'                           01S0620 01927000
         BNO   @RF00620                                         01S0620 01928000
         TM    CCWWR(@10),B'00000001'                           01S0620 01929000
         BNZ   @RF00620                                         01S0620 01930000
*     IF SNSDATA=ON|(SNSEQU=ON&SNS7=FMT10&(SNS17&NDFMSK)=NDF) THEN/*    01931000
*                                      DATA CHECK                    */ 01932000
         LA    @10,188                                          01S0621 01933000
         ALR   @10,AP1REG                                       01S0621 01934000
         TM    SNSDATA(@10),B'00001000'                         01S0621 01935000
         BO    @RT00621                                         01S0621 01936000
         TM    SNSEQU(@10),B'00010000'                          01S0621 01937000
         BNO   @RF00621                                         01S0621 01938000
         CLI   SNS7(@10),X'10'                                  01S0621 01939000
         BNE   @RF00621                                         01S0621 01940000
         MVC   @TS00001(1),SNS17(@10)                           01S0621 01941000
         NI    @TS00001,X'FE'                                   01S0621 01942000
         CLI   @TS00001,X'C0'                                   01S0621 01943000
         BNE   @RF00621                                         01S0621 01944000
@RT00621 DS    0H                                               01S0622 01945000
*       DCKCE=ON;                   /* SET IN TABLE                  */ 01946000
         L     @10,AP1ETABA(,AP1REG)                            01S0622 01947000
         OI    DCKCE(@10),B'00010000'                           01S0622 01948000
*     ELSE                          /* NOT DATA CHECK                */ 01949000
*       IF SNS7=SKCHK7&((AP1DEVTP=AP13344&SNSSKCK=ON)|(AP1DEVTPÂ¬=       01950000
*           AP13344&SNSEQU=ON)) THEN                            01S0623 01951000
         B     @RC00621                                         01S0623 01952000
@RF00621 LA    @10,188                                          01S0623 01953000
         ALR   @10,AP1REG                                       01S0623 01954000
         CLI   SNS7(@10),X'1A'                                  01S0623 01955000
         BNE   @RF00623                                         01S0623 01956000
         CLI   AP1DEVTP(AP1REG),3                               01S0623 01957000
         BNE   @GL00038                                         01S0623 01958000
         TM    SNSSKCK(@10),B'00000001'                         01S0623 01959000
         BO    @RT00623                                         01S0623 01960000
@GL00038 CLI   AP1DEVTP(AP1REG),3                               01S0623 01961000
         BE    @RF00623                                         01S0623 01962000
         TM    SNSEQU+188(AP1REG),B'00010000'                   01S0623 01963000
         BNO   @RF00623                                         01S0623 01964000
@RT00623 DS    0H                                               01S0624 01965000
*         SKVERCK=ON;               /* SET IN TABLE                  */ 01966000
         L     @10,AP1ETABA(,AP1REG)                            01S0624 01967000
         OI    SKVERCK(@10),B'01000000'                         01S0624 01968000
*       ELSE                        /* NOT DCK OR SKVERCK            */ 01969000
*         AP1QUIT=ON;               /* STOP TESTING                  */ 01970000
         B     @RC00623                                         01S0625 01971000
@RF00623 OI    AP1QUIT(AP1REG),B'00001000'                      01S0625 01972000
*   ELSE                            /* NOT UCK ON RHA                */ 01973000
*     AP1QUIT=ON;                   /* STOP TESTING                  */ 01974000
         B     @RC00620                                         01S0626 01975000
@RF00620 OI    AP1QUIT(AP1REG),B'00001000'                      01S0626 01976000
*   END;                            /* OF ERROR2 PROC                */ 01977000
@EL00004 DS    0H                                               01S0627 01978000
@EF00004 DS    0H                                               01S0627 01979000
@ER00004 LM    @14,@12,12(@13)                                  01S0627 01980000
         BR    @14                                              01S0627 01981000
         EJECT                                                          01982000
*                                                               01S0628 01983000
*   /*****************************************************************/ 01984000
*   /*                                                               */ 01985000
*   /* CVTEBCD: PROCEDURE                                            */ 01986000
*   /*                                                               */ 01987000
*   /*****************************************************************/ 01988000
*                                                               01S0628 01989000
*CVTEBCD:                                                       01S0628 01990000
*   PROC;                           /* INTERNAL TO AP1CHK PROC       */ 01991000
*                                                               01S0628 01992000
CVTEBCD  STM   @14,@12,@SA00005                                 01S0628 01993000
*   /*****************************************************************/ 01994000
*   /*                                                               */ 01995000
*   /* CONVERTS BINARY TO EBCDIC REG0 CONTAINS HALFWORD OF BINARY    */ 01996000
*   /* INFO (SIGN IGNORED)..REG1 POINTS TO FULLWORD TO CONTAIN EBCDIC*/ 01997000
*   /* REPRESENTATION                                                */ 01998000
*   /*                                                               */ 01999000
*   /*****************************************************************/ 02000000
*                                                               01S0629 02001000
*   RFY                                                         01S0629 02002000
*    (GPR00F,                                                   01S0629 02003000
*     GPR01P,                                                   01S0629 02004000
*     GPR02F,                                                   01S0629 02005000
*     GPR03F) RSTD;                                             01S0629 02006000
*   GENERATE REFS(ALPHACNV);                                    01S0630 02007000
*                      INPUT =   0000WXYZ                               02008000
         SLL   @00,12            0WXYZ000                               02009000
         ST    @00,0(@01)                                               02010000
         UNPK  0(4,@01),0(3,@01) FWFXFY0Z                               02011000
         OI    3(@01),X'F0'      FWFXFYFZ                               02012000
         LA    @00,4             LOOP COUNTER                           02013000
LOOPEBCD CLI   0(@01),X'F9'      IS IT A NUMBER                         02014000
         BNH   NUMBER                                                   02015000
         IC    @02,0(@01)        GET CHARACTER                          02016000
         SH    @02,ALPHACNV      CHANGE TO ALPHA                        02017000
         STC   @02,0(@01)        PUT IT BACK                            02018000
NUMBER   LA    @01,1(@01)        GO TO NEXT CHAR                        02019000
         BCT   @00,LOOPEBCD      AGAIN                                  02020000
*   RFY                                                         01S0631 02021000
*    (GPR00F,                                                   01S0631 02022000
*     GPR01P,                                                   01S0631 02023000
*     GPR02F,                                                   01S0631 02024000
*     GPR03F) UNRSTD;                                           01S0631 02025000
*   END;                            /* OF CVTEBCD PROC               */ 02026000
*                                                               01S0632 02027000
@EL00005 DS    0H                                               01S0632 02028000
@EF00005 DS    0H                                               01S0632 02029000
@ER00005 LM    @14,@12,@SA00005                                 01S0632 02030000
         BR    @14                                              01S0632 02031000
@PB00005 DS    0H                                               01S0633 02032000
*   /*****************************************************************/ 02033000
*   /*                                                               */ 02034000
*   /* DECLARES FOR MACROS                                           */ 02035000
*   /*                                                               */ 02036000
*   /*****************************************************************/ 02037000
*                                                               01S0633 02038000
*   DCL                                                         01S0633 02039000
*     1 I056 DEF(ILIST) BDY(WORD) CHAR(32767),/* LIST FOR ENQ        */ 02040000
*       3 I05600 PTR(31),           /* TCB ADDR IF BOTH TCB AND ECB  */ 02041000
*       3 I05601 PTR(31),           /* TCB OR ECB ADDRESS            */ 02042000
*       3 I05602(*) CHAR(12) BDY(WORD),/* ARRAY OF RESOURCE ELEMENTS */ 02043000
*         5 I05603 BIT(8),          /* BIT FLAGS 1                   */ 02044000
*         5 I05604 PTR(8),          /* MINOR RESOURCE NAME LENGTH    */ 02045000
*         5 I05605 BIT(8),          /* BIT FLAGS 2                   */ 02046000
*         5 I05655 CHAR(1),         /* CONTROL PGM USE               */ 02047000
*         5 I05606 PTR(31),         /* MAJOR RESOURCE NAME ADDR      */ 02048000
*         5 I05607 PTR(31);         /* MINOR RESOURCE NAME ADDR      */ 02049000
*   DECLARE                                                     01S0634 02050000
*     ILIST CHAR(16) BDY(DWORD);    /* STANDARD LIST                 */ 02051000
*   DECLARE                         /* COMMON VARIABLES              */ 02052000
*     I256C CHAR(256) BASED,                                    01S0635 02053000
*     I031F FIXED(31) BASED,                                    01S0635 02054000
*     I031P PTR(31) BASED,                                      01S0635 02055000
*     I015F FIXED(15) BASED,                                    01S0635 02056000
*     I015P PTR(15) BASED,                                      01S0635 02057000
*     I008P PTR(8) BASED,                                       01S0635 02058000
*     I001C CHAR(1) BASED;          /* GENERATE DSECTS FOR MACROS    */ 02059000
*                                                               01S0635 02060000
*   /*****************************************************************/ 02061000
*   /*                                                               */ 02062000
*   /* PATCH AREA                                                    */ 02063000
*   /*                                                               */ 02064000
*   /*****************************************************************/ 02065000
*                                                               01S0636 02066000
*   GEN DATA DEFS(PATCH);                                       01S0636 02067000
*   END                             /* OF IAPCHKIO PROC              */ 02068000
*                                                               01S0637 02069000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02070000
*/*%INCLUDE SYSLIB  (AP1BLOCK)                                       */ 02071000
*/*%INCLUDE SYSUT5  (CVTBIN  )                                       */ 02072000
*                                                               01S0637 02073000
*       ;                                                       01S0637 02074000
@EL00001 L     @13,4(,@13)                                      01S0637 02075000
@EF00001 DS    0H                                               01S0637 02076000
@ER00001 LM    @14,@12,12(@13)                                  01S0637 02077000
         BR    @14                                              01S0637 02078000
@DATA    DS    0H                                                       02079000
@CH00083 DC    H'5'                                                     02080000
@CH00318 DC    H'50'                                                    02081000
@CH00421 DC    XL2'0135'                                                02082000
@DATD    DSECT                                                          02083000
         DS    0F                                                       02084000
@SA00001 DS    18F                                                      02085000
@SA00005 DS    15F                                                      02086000
@SA00002 DS    15F                                                      02087000
@PC00002 DS    3F                                                       02088000
@AL00001 DS    3A                                                       02089000
@AFTEMPS DS    2F                                                       02090000
IAPCHKIO CSECT                                                          02091000
         DS    0F                                                       02092000
@CF00043 DC    F'1'                                                     02093000
@CF00058 DC    F'2'                                                     02094000
@CF00137 DC    F'3'                                                     02095000
@CF00038 DC    F'4'                                                     02096000
@CF00047 DC    F'8'                                                     02097000
@CF00411 DC    F'25'                                                    02098000
@CF00289 DC    F'32'                                                    02099000
@CF00283 DC    F'33'                                                    02100000
@CF00450 DC    F'41'                                                    02101000
@CF00133 DC    F'60'                                                    02102000
@CF00457 DC    F'61'                                                    02103000
@CF00504 DC    F'-8'                                                    02104000
@CF00415 DC    XL4'C0000000'                                            02105000
@CF00420 DC    XL4'00000FDF'                                            02106000
@CF00423 DC    XL4'00000FC0'                                            02107000
@CF00424 DC    XL4'0000003F'                                            02108000
@CF00505 DC    XL4'0000FFFF'                                            02109000
@CF00422 DC    XL4'3135'                                                02110000
@DATD    DSECT                                                          02111000
         DS    0D                                                       02112000
BUFPTR   DS    A                                                        02113000
@TS00001 DS    CL1                                                      02114000
         DS    CL3                                                      02115000
ILIST    DS    CL16                                                     02116000
IAPCHKIO CSECT                                                          02117000
         NOPR  ((@ENDDATD-@DATD)/257*16)                                02118000
         DS    0F                                                       02119000
@SIZDATD DC    AL1(0)                                                   02120000
         DC    AL3(@ENDDATD-@DATD)                                      02121000
         DS    0D                                                       02122000
ALPHACNV DC    XL2'39'                                                  02123000
ALPHACV2 DC    XL2'B7'                                                  02124000
@CB00290 DC    X'0AF0000B'                                              02125000
@CB00292 DC    X'00000008'                                              02126000
@CB00294 DC    X'01000100'                                              02127000
@CB00327 DC    X'00040009'                                              02128000
@CB00329 DC    X'000E000B'                                              02129000
@CB00440 DC    X'0002001D'                                              02130000
@CB00441 DC    X'00030012'                                              02131000
@CB00442 DC    X'000A000A'                                              02132000
@CB00314 DC    X'001D'                                                  02133000
@CB00316 DC    X'000B'                                                  02134000
ZERO     DC    X'0000000000000000'                                      02135000
TBL3344  DC    X'02222A3203232B3304242C3405252D3506262E3607272F37102028C02136000
               3011212931141C383C15391D3D163A1E3E173B1F3F00'            02137000
QNAME    DC    CL8'AP1QNAME'                                            02138000
R1DATA1  DS    CL256                                                    02139000
         ORG   R1DATA1                                                  02140000
@NM00013 DS    CL64                                                     02141000
         ORG   @NM00013                                                 02142000
@NM00014 DC    8X'EB6DB6DB'                                             02143000
         DC    2X'FFFFFFFF'                                             02144000
         DC    2X'AAAAAAAA'                                             02145000
         DC    2X'FFFFFFFF'                                             02146000
         DC    2X'AAAAAAAA'                                             02147000
         ORG   R1DATA1+64                                               02148000
@NM00015 DS    CL64                                                     02149000
         ORG   @NM00015                                                 02150000
@NM00016 DC    8X'EB6DB6DB'                                             02151000
         DC    2X'FFFFFFFF'                                             02152000
         DC    2X'AAAAAAAA'                                             02153000
         DC    2X'FFFFFFFF'                                             02154000
         DC    2X'AAAAAAAA'                                             02155000
         ORG   R1DATA1+128                                              02156000
@NM00017 DS    CL64                                                     02157000
         ORG   @NM00017                                                 02158000
@NM00018 DC    8X'EB6DB6DB'                                             02159000
         DC    2X'FFFFFFFF'                                             02160000
         DC    2X'AAAAAAAA'                                             02161000
         DC    2X'FFFFFFFF'                                             02162000
         DC    2X'AAAAAAAA'                                             02163000
         ORG   R1DATA1+192                                              02164000
@NM00019 DS    CL64                                                     02165000
         ORG   @NM00019                                                 02166000
@NM00020 DC    8X'EB6DB6DB'                                             02167000
         DC    2X'FFFFFFFF'                                             02168000
         DC    2X'AAAAAAAA'                                             02169000
         DC    2X'FFFFFFFF'                                             02170000
         DC    2X'AAAAAAAA'                                             02171000
         ORG   R1DATA1+256                                              02172000
R1DATA2  DS    CL256                                                    02173000
         ORG   R1DATA2                                                  02174000
@NM00021 DC    X'AAAAAAAAAAAAAAAAAAAA'                                  02175000
@NM00022 DC    X'FFFFFFFFFFFFFFFFAAAAAAAAAAAAAAAA'                      02176000
         DS    14XL16                                                   02177000
@NM00023 DC    X'FFFFFFFFFFFF'                                          02178000
         ORG   R1DATA2+256                                              02179000
         DS    CL3                                                      02180000
CP0001@  DC    AL4(RECAL1)                                              02181000
         DC    AL4(SNS)                                                 02182000
         DC    AL4(RECAL2)                                              02183000
         DC    AL4(RET)                                                 02184000
         DC    AL4(RHAMH)                                               02185000
         DC    AL4(RET)                                                 02186000
         DC    AL4(RHAFH)                                               02187000
         DC    AL4(RPS)                                                 02188000
         DC    AL4(SK192)                                               02189000
         DC    AL4(SKINCR)                                              02190000
         DC    AL4(SKMAX)                                               02191000
         DC    AL4(RET)                                                 02192000
         DC    AL4(SKRAN)                                               02193000
         DC    AL4(RET)                                                 02194000
         DC    AL4(RHA)                                                 02195000
         DC    AL4(RET)                                                 02196000
         DC    AL4(WRT)                                                 02197000
         DC    AL4(RET)                                                 02198000
         DC    AL4(RR01)                                                02199000
         DC    AL4(RDMT)                                                02200000
         DC    AL4(FTWRT)                                               02201000
         DC    AL4(AMDET)                                               02202000
         DC    AL4(WRTPAD)                                              02203000
         DC    AL4(SD)                                                  02204000
         DC    AL4(CLEANUP)                                             02205000
IAPCHKIO CSECT                                                          02206000
*                                /*  PATCH AREA  */                     02207000
         CNOP  0,4               FULLWORD BDWY                          02208000
PATCH    DC    2XL((*-@MAINENT)/40)'0' FIVE PERCENT.                    02209000
@DATD    DSECT                                                          02210000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02211000
@ENDDATD EQU   *                                                        02212000
IAPCHKIO CSECT                                                          02213000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02214000
@01      EQU   01                                                       02215000
@02      EQU   02                                                       02216000
@03      EQU   03                                                       02217000
@04      EQU   04                                                       02218000
@05      EQU   05                                                       02219000
@06      EQU   06                                                       02220000
@07      EQU   07                                                       02221000
@08      EQU   08                                                       02222000
@09      EQU   09                                                       02223000
@10      EQU   10                                                       02224000
@11      EQU   11                                                       02225000
@12      EQU   12                                                       02226000
@13      EQU   13                                                       02227000
@14      EQU   14                                                       02228000
@15      EQU   15                                                       02229000
COUNTER  EQU   @02                                                      02230000
CCUSAV   EQU   @03                                                      02231000
TBLPTR   EQU   @02                                                      02232000
AP1REG   EQU   @08                                                      02233000
GPR00F   EQU   @00                                                      02234000
GPR01P   EQU   @01                                                      02235000
GPR01F   EQU   @01                                                      02236000
GPR02F   EQU   @02                                                      02237000
GPR03F   EQU   @03                                                      02238000
GPR13P   EQU   @13                                                      02239000
GPR15F   EQU   @15                                                      02240000
GPR15P   EQU   @15                                                      02241000
AP1BLOCK EQU   0                                                        02242000
AP1PRINT EQU   AP1BLOCK+8                                               02243000
AP1PRMSG EQU   AP1PRINT+1                                               02244000
AP1PRCOD EQU   AP1BLOCK+139                                             02245000
AP1PFLG1 EQU   AP1BLOCK+144                                             02246000
AP1CNCOD EQU   AP1BLOCK+145                                             02247000
AP1WRKA  EQU   AP1BLOCK+156                                             02248000
AP1CCWA  EQU   AP1BLOCK+160                                             02249000
AP1BUFAD EQU   AP1BLOCK+164                                             02250000
AP1TIMFL EQU   AP1BLOCK+176                                             02251000
AP1TIMFA EQU   AP1TIMFL                                                 02252000
AP1PCODE EQU   AP1BLOCK+180                                             02253000
AP1CSW   EQU   AP1BLOCK+181                                             02254000
AP1SNS   EQU   AP1BLOCK+188                                             02255000
AP1SEEK  EQU   AP1BLOCK+213                                             02256000
CCHHR    EQU   AP1SEEK+3                                                02257000
CCHH     EQU   CCHHR                                                    02258000
HH       EQU   CCHH+2                                                   02259000
AP1CESK  EQU   AP1BLOCK+221                                             02260000
CECCHHR  EQU   AP1CESK+2                                                02261000
CECCHH   EQU   CECCHHR                                                  02262000
CEHH     EQU   CECCHH+2                                                 02263000
AP1FLG2  EQU   AP1BLOCK+244                                             02264000
AP1NOWR  EQU   AP1FLG2                                                  02265000
AP1FHF   EQU   AP1FLG2                                                  02266000
AP1FLG3  EQU   AP1BLOCK+245                                             02267000
AP1PTRN2 EQU   AP1FLG3                                                  02268000
AP1LST   EQU   AP1FLG3                                                  02269000
AP1ERROR EQU   AP1FLG3                                                  02270000
AP1PRERR EQU   AP1FLG3                                                  02271000
AP1QUIT  EQU   AP1FLG3                                                  02272000
AP1FLG4  EQU   AP1BLOCK+246                                             02273000
AP1ENQD  EQU   AP1FLG4                                                  02274000
AP1TSTNO EQU   AP1BLOCK+249                                             02275000
AP1DEVTP EQU   AP1BLOCK+250                                             02276000
AP1RET   EQU   AP1BLOCK+251                                             02277000
AP1ETABA EQU   AP1BLOCK+252                                             02278000
AP1SKCNT EQU   AP1BLOCK+256                                             02279000
AP1DEVAD EQU   AP1BLOCK+262                                             02280000
AP1ENQAD EQU   AP1BLOCK+266                                             02281000
AP1END   EQU   AP1BLOCK+360                                             02282000
ERRTAB   EQU   0                                                        02283000
DCK      EQU   ERRTAB                                                   02284000
SKVERCK  EQU   ERRTAB                                                   02285000
WRTCK    EQU   ERRTAB                                                   02286000
DCKCE    EQU   ERRTAB                                                   02287000
DATACOMP EQU   ERRTAB                                                   02288000
CCW      EQU   0                                                        02289000
CCWADDRA EQU   CCW                                                      02290000
CCWCOMCD EQU   CCWADDRA                                                 02291000
@NM00005 EQU   CCWCOMCD                                                 02292000
CCWRD    EQU   @NM00005                                                 02293000
CCWWR    EQU   @NM00005                                                 02294000
CCWFLGS  EQU   CCW+4                                                    02295000
WRKAREA  EQU   0                                                        02296000
WRKAD    EQU   WRKAREA                                                  02297000
WRKFLG   EQU   WRKAD                                                    02298000
BYTE1    EQU   0                                                        02299000
BYTE5    EQU   0                                                        02300000
BYTE8    EQU   0                                                        02301000
FIXED16  EQU   0                                                        02302000
CSW      EQU   0                                                        02303000
CSWADDRA EQU   CSW                                                      02304000
CSWADDRB EQU   CSWADDRA+1                                               02305000
CSWSTATS EQU   CSW+4                                                    02306000
CSWSTAT1 EQU   CSWSTATS                                                 02307000
CSWUNCHK EQU   CSWSTAT1                                                 02308000
SNSD     EQU   0                                                        02309000
SNS0     EQU   SNSD                                                     02310000
SNSINT   EQU   SNS0                                                     02311000
SNSEQU   EQU   SNS0                                                     02312000
SNSDATA  EQU   SNS0                                                     02313000
SNSSKCK  EQU   SNS0                                                     02314000
SNS1     EQU   SNSD+1                                                   02315000
SNSINHI  EQU   SNS1                                                     02316000
SNS2     EQU   SNSD+2                                                   02317000
SNSEMU   EQU   SNS2                                                     02318000
SNSFHF   EQU   SNS2                                                     02319000
SNS6     EQU   SNSD+6                                                   02320000
SNS7     EQU   SNSD+7                                                   02321000
SNS17    EQU   SNSD+17                                                  02322000
ECBCC    EQU   0                                                        02323000
CNT      EQU   0                                                        02324000
CNTCCHHR EQU   CNT                                                      02325000
CNTCCHH  EQU   CNTCCHHR                                                 02326000
CNTHH    EQU   CNTCCHH+2                                                02327000
CNTR     EQU   CNTCCHHR+4                                               02328000
CL0001@  EQU   0                                                        02329000
BYTE6    EQU   0                                                        02330000
I001C    EQU   0                                                        02331000
I008P    EQU   0                                                        02332000
I015F    EQU   0                                                        02333000
I015P    EQU   0                                                        02334000
I031F    EQU   0                                                        02335000
I031P    EQU   0                                                        02336000
I256C    EQU   0                                                        02337000
INAREA   EQU   0                                                        02338000
OUTAREA  EQU   0                                                        02339000
BYTES    EQU   0                                                        02340000
@NM00008 EQU   WRKAREA                                                  02341000
WRKHW1   EQU   @NM00008                                                 02342000
CNTRKDD  EQU   CNTR                                                     02343000
CNTKDD   EQU   CNTRKDD                                                  02344000
I056     EQU   ILIST                                                    02345000
I05602   EQU   I056+8                                                   02346000
I05603   EQU   I05602                                                   02347000
I05604   EQU   I05602+1                                                 02348000
I05605   EQU   I05602+2                                                 02349000
I05606   EQU   I05602+4                                                 02350000
I05607   EQU   I05602+8                                                 02351000
CNTHHR   EQU   CNTHH                                                    02352000
HHR      EQU   HH                                                       02353000
ZERO6    EQU   ZERO                                                     02354000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02355000
I05655   EQU   I05602+3                                                 02356000
I05601   EQU   I056+4                                                   02357000
I05600   EQU   I056                                                     02358000
CNTDD    EQU   CNTKDD+1                                                 02359000
CNTK     EQU   CNTKDD                                                   02360000
WRKHW2   EQU   @NM00008+2                                               02361000
@NM00024 EQU   CNT+5                                                    02362000
CNTCC    EQU   CNTCCHH                                                  02363000
ECBPOST  EQU   ECBCC                                                    02364000
ECBWAIT  EQU   ECBCC                                                    02365000
@NM00012 EQU   SNSD+8                                                   02366000
SNSHD1   EQU   SNS6                                                     02367000
SNSHD2   EQU   SNS6                                                     02368000
SNSHD4   EQU   SNS6                                                     02369000
SNSHD8   EQU   SNS6                                                     02370000
SNSHD16  EQU   SNS6                                                     02371000
SNSCYLC  EQU   SNS6                                                     02372000
SNSCYLB  EQU   SNS6                                                     02373000
SNSCYLA  EQU   SNS6                                                     02374000
SNS5     EQU   SNSD+5                                                   02375000
SNS4     EQU   SNSD+4                                                   02376000
SNS3     EQU   SNSD+3                                                   02377000
SNSEDAT  EQU   SNS2                                                     02378000
@NM00011 EQU   SNS2                                                     02379000
SNSCORR  EQU   SNS2                                                     02380000
SNSWRPS  EQU   SNS2                                                     02381000
SNSOFLO  EQU   SNS1                                                     02382000
SNSFP    EQU   SNS1                                                     02383000
SNSNRF   EQU   SNS1                                                     02384000
@NM00010 EQU   SNS1                                                     02385000
SNSEOC   EQU   SNS1                                                     02386000
SNSIFMT  EQU   SNS1                                                     02387000
SNSPERM  EQU   SNS1                                                     02388000
SNSTCC   EQU   SNS0                                                     02389000
SNSOVRN  EQU   SNS0                                                     02390000
SNSBUSO  EQU   SNS0                                                     02391000
SNSCREJ  EQU   SNS0                                                     02392000
CSWBYTE  EQU   CSW+6                                                    02393000
CSWUNEXP EQU   CSWSTAT1                                                 02394000
@NM00009 EQU   CSWSTAT1                                                 02395000
CSWKEY   EQU   CSWADDRA                                                 02396000
WRKAB    EQU   WRKAD+1                                                  02397000
WRKENDFL EQU   WRKFLG                                                   02398000
CCWBYTE  EQU   CCW+6                                                    02399000
@NM00007 EQU   CCW+5                                                    02400000
CCWPCI   EQU   CCWFLGS                                                  02401000
CCWSKIP  EQU   CCWFLGS                                                  02402000
CCWSLI   EQU   CCWFLGS                                                  02403000
CCWCC    EQU   CCWFLGS                                                  02404000
CCWCD    EQU   CCWFLGS                                                  02405000
CCWADDRB EQU   CCWADDRA+1                                               02406000
@NM00006 EQU   @NM00005                                                 02407000
AP1ERRTF EQU   AP1BLOCK+300                                             02408000
AP1ERRTM EQU   AP1BLOCK+270                                             02409000
AP1LSTHH EQU   AP1BLOCK+260                                             02410000
AP1LSTCC EQU   AP1BLOCK+258                                             02411000
AP1DCCNT EQU   AP1BLOCK+248                                             02412000
@NM00004 EQU   AP1BLOCK+247                                             02413000
AP1DEBCH EQU   AP1FLG4                                                  02414000
AP1READ  EQU   AP1FLG4                                                  02415000
AP1NORD  EQU   AP1FLG4                                                  02416000
AP1RDERR EQU   AP1FLG3                                                  02417000
AP1RDTST EQU   AP1FLG3                                                  02418000
AP1VERIF EQU   AP1FLG3                                                  02419000
AP1NOERP EQU   AP1FLG2                                                  02420000
AP1EDP   EQU   AP1FLG2                                                  02421000
AP1IOC   EQU   AP1FLG2                                                  02422000
AP1IOECB EQU   AP1BLOCK+240                                             02423000
AP1IOBA  EQU   AP1BLOCK+236                                             02424000
AP1DEBA  EQU   AP1BLOCK+232                                             02425000
AP1DCBA  EQU   AP1BLOCK+228                                             02426000
CER      EQU   CECCHHR+4                                                02427000
CECC     EQU   CECCHH                                                   02428000
CEBB     EQU   AP1CESK                                                  02429000
R        EQU   CCHHR+4                                                  02430000
CC       EQU   CCHH                                                     02431000
BB       EQU   AP1SEEK+1                                                02432000
M        EQU   AP1SEEK                                                  02433000
AP1FM    EQU   AP1BLOCK+212                                             02434000
AP1TIMIN EQU   AP1TIMFA                                                 02435000
AP1IOACT EQU   AP1TIMFA                                                 02436000
AP1TCBAD EQU   AP1BLOCK+172                                             02437000
AP1TIMEA EQU   AP1BLOCK+168                                             02438000
AP1BUFAB EQU   AP1BUFAD+1                                               02439000
@NM00003 EQU   AP1BUFAD                                                 02440000
AP1CCWAB EQU   AP1CCWA+1                                                02441000
@NM00002 EQU   AP1CCWA                                                  02442000
AP1RECB  EQU   AP1BLOCK+152                                             02443000
@NM00001 EQU   AP1BLOCK+150                                             02444000
AP1CNRPL EQU   AP1BLOCK+146                                             02445000
AP1PRCLS EQU   AP1PFLG1                                                 02446000
AP1PRNP  EQU   AP1PFLG1                                                 02447000
AP1PROPN EQU   AP1PFLG1                                                 02448000
AP1PRLIN EQU   AP1BLOCK+142                                             02449000
AP1PRPAG EQU   AP1BLOCK+140                                             02450000
AP1PRASA EQU   AP1PRINT                                                 02451000
AP1PDCBA EQU   AP1BLOCK+4                                               02452000
AP1HDR   EQU   AP1BLOCK                                                 02453000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02454000
@RC00117 EQU   @RC00116                                                 02455000
@RC00325 EQU   @RC00322                                                 02456000
@RC00375 EQU   @RC00372                                                 02457000
@RC00424 EQU   @RC00420                                                 02458000
@RC00610 EQU   @EL00003                                                 02459000
@RC00620 EQU   @EL00004                                                 02460000
@PB00004 EQU   @PB00005                                                 02461000
@RC00331 EQU   @RC00325                                                 02462000
@RC00326 EQU   @RC00325                                                 02463000
@RC00376 EQU   @RC00375                                                 02464000
@RT00430 EQU   @RC00424                                                 02465000
@RC00613 EQU   @RC00610                                                 02466000
@RC00611 EQU   @RC00610                                                 02467000
@PB00003 EQU   @PB00004                                                 02468000
@RC00623 EQU   @RC00620                                                 02469000
@RC00621 EQU   @RC00620                                                 02470000
@PB00002 EQU   @PB00003                                                 02471000
CE0001@  EQU   @PB00002                                                 02472000
@RC00114 EQU   CE0001@                                                  02473000
@RC00391 EQU   CE0001@                                                  02474000
@RC00447 EQU   CE0001@                                                  02475000
@RC00530 EQU   CE0001@                                                  02476000
@RC00553 EQU   CE0001@                                                  02477000
@RC00448 EQU   @RC00447                                                 02478000
@ENDDATA EQU   *                                                        02479000
         END   IAPCHKIO,(C'PLS1722',0701,77308)                         02480000
./  ADD  SSI=73080184,NAME=IAPCNTRL
         TITLE 'IAPCNTRL - AP-1 MAIN CSECT                             *00001000
                        '                                               00002000
IAPCNTRL CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(16)                                          01S0001 00007000
         DC    C'IAPCNTRL  77.308'                              01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @10,0                                            01S0001 00011000
@PSTART  LA    @11,4095(,@10)                                   01S0001 00012000
         LA    @12,4095(,@11)                                   01S0001 00013000
         USING @PSTART,@10                                      01S0001 00014000
         USING @PSTART+4095,@11                                 01S0001 00015000
         USING @PSTART+8190,@12                                 01S0001 00016000
         L     @00,@SIZDATD                                     01S0001 00017000
         GETMAIN  R,LV=(0)                                              00018000
         LR    @07,@01                                          01S0001 00019000
         USING @DATD,@07                                        01S0001 00020000
         ST    @13,@SA00001+4                                   01S0001 00021000
         LM    @00,@01,20(@13)                                  01S0001 00022000
         ST    @07,8(,@13)                                      01S0001 00023000
         LR    @13,@07                                          01S0001 00024000
         MVC   @PC00001(4),0(@01)                               01S0001 00025000
         EJECT                                                          00026000
*                                                               01S0265 00027000
*   /*****************************************************************/ 00028000
*   /*                                                               */ 00029000
*   /* INITIALIZATION ROUTINE GETS SPACE FOR CONTROL BLOCKS AND      */ 00030000
*   /* BUILDS THEM. CALLS INITGET PROC TO GETMAIN AREAS AND SET UP   */ 00031000
*   /* ADDRESSES. MOVES DCBS AND BUILDS IOB. CALLS INITDEVT TO FIND  */ 00032000
*   /* DEVICE TYPE AND INITIALIZE AP1DEVTP. CALLS INITDEB TO BUILD   */ 00033000
*   /* THE DEB. ATTACHES SUBTASK TO TIME FOR MISSING INTERRUPTS.     */ 00034000
*   /* ISSUES NO MESSAGES.                                           */ 00035000
*   /*                                                               */ 00036000
*   /*****************************************************************/ 00037000
*                                                               01S0265 00038000
*   DO;                             /* MODESET MODE(SUP)             */ 00039000
*     I10701='00000000'B;           /* OR MASK                       */ 00040000
         MVI   I10701,B'00000000'                               01S0266 00041000
*     I10702='00000000'B;           /* AND MASK                      */ 00042000
         MVI   I10702,B'00000000'                               01S0267 00043000
*     I10703='00000000'B;           /* RESERVED                      */ 00044000
         MVI   I10703,B'00000000'                               01S0268 00045000
*     I10704='00001100'B;                                       01S0269 00046000
         MVI   I10704,B'00001100'                               01S0269 00047000
*     RESPECIFY                                                 01S0270 00048000
*       GPR01F RESTRICTED;                                      01S0270 00049000
*     GPR01F=I107;                  /* MODESET PARMLIST              */ 00050000
         L     GPR01F,I107                                      01S0271 00051000
*     SVC(107);                     /* ISSUE MODESET SVC             */ 00052000
         SVC   107                                              01S0272 00053000
*     RESPECIFY                                                 01S0273 00054000
*      (GPR01F) UNRESTRICTED;                                   01S0273 00055000
*   END;                            /* MODESET MODE(SUP) GET INTO       00056000
*                                      SUPERVISOR STATE              */ 00057000
*                                                               01S0274 00058000
*   /*****************************************************************/ 00059000
*   /*                                                               */ 00060000
*   /* GETMAIN ROUTINE                                               */ 00061000
*   /*                                                               */ 00062000
*   /*****************************************************************/ 00063000
*                                                               01S0275 00064000
*                                                               01S0275 00065000
*   /*****************************************************************/ 00066000
*   /*                                                               */ 00067000
*   /* GETMAIN AREA FOR AP1BLOCK, PRINT DCB, SAVE AREA, TEST DCB,TEST*/ 00068000
*   /* IOB, CCW BUILD AREA, AND MACRO WORK AREA.                     */ 00069000
*   /*                                                               */ 00070000
*   /*****************************************************************/ 00071000
*                                                               01S0275 00072000
*   DO;                             /* GETMAIN (R) LV(LENGTH(AP1BLOCK   00073000
*                                      )+DATDLEN+PRDCBL+TESTDCBL+LENG   00074000
*                                      TH(IOBSTDRD)+LENGTH(IOBEXTEN)+   00075000
*                                      LENGTH(IOBAP1PT)+(LENGTH(CCW)*   00076000
*                                      MAXCCWS)+(LENGTH(WRKAREA)*WRKW   00077000
*                                      ORDS)+FUDGE)SP(DEBSP)         */ 00078000
*     RESPECIFY                                                 01S0276 00079000
*      (GPR01F,                                                 01S0276 00080000
*       GPR00F) RESTRICTED;                                     01S0276 00081000
*     GPR00F=LENGTH(AP1BLOCK)+DATDLEN+PRDCBL+TESTDCBL+LENGTH(IOBSTDRD)+ 00082000
*         LENGTH(IOBEXTEN)+LENGTH(IOBAP1PT)+(LENGTH(CCW)*MAXCCWS)+(     00083000
*         LENGTH(WRKAREA)*WRKWORDS)+FUDGE;/* LENGTH REQUESTED        */ 00084000
         LA    GPR00F,616                                       01S0277 00085000
         AL    GPR00F,PRDCBL                                    01S0277 00086000
         AL    GPR00F,TESTDCBL                                  01S0277 00087000
         AL    GPR00F,@CF03848                                  01S0277 00088000
*     GPR01F=DEBSP;                 /* SP IN REG 1                   */ 00089000
         LA    GPR01F,230                                       01S0278 00090000
*     GEN(SLL   GPR01F,24)                                      01S0279 00091000
*     NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;              01S0279 00092000
         SLL   GPR01F,24                                                00093000
*     GPR00F=GPR00F|GPR01F;         /* SP IN HIGH BYTE               */ 00094000
         OR    GPR00F,GPR01F                                    01S0280 00095000
*     GPR01F=-1;                    /* INDICATE A GETMAIN REQUEST    */ 00096000
         SLR   GPR01F,GPR01F                                    01S0281 00097000
         BCTR  GPR01F,0                                         01S0281 00098000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 00099000
         SVC   10                                               01S0282 00100000
*     RESPECIFY                                                 01S0283 00101000
*      (GPR01F,                                                 01S0283 00102000
*       GPR00F) UNRESTRICTED;                                   01S0283 00103000
*   END;                            /* GETMAIN (R) LV(LENGTH(AP1BLOCK   00104000
*                                      )+DATDLEN+PRDCBL+TESTDCBL+LENG   00105000
*                                      TH(IOBSTDRD)+LENGTH(IOBEXTEN)+   00106000
*                                      LENGTH(IOBAP1PT)+(LENGTH(CCW)*   00107000
*                                      MAXCCWS)+(LENGTH(WRKAREA)*WRKW   00108000
*                                      ORDS)+FUDGE)SP(DEBSP)         */ 00109000
*   RFY                                                         01S0285 00110000
*     GPR01F RSTD;                                              01S0285 00111000
*   AP1REG=GPR01F;                  /* BASE REG FOR AP1BLOCK         */ 00112000
         LR    AP1REG,GPR01F                                    01S0286 00113000
*   RFY                                                         01S0287 00114000
*     GPR01F UNRSTD;                                            01S0287 00115000
*                                                               01S0287 00116000
*   /*****************************************************************/ 00117000
*   /*                                                               */ 00118000
*   /* CLEAR AP1BLOCK                                                */ 00119000
*   /*                                                               */ 00120000
*   /*****************************************************************/ 00121000
*                                                               01S0288 00122000
*   RFY                                                         01S0288 00123000
*    (GPR00P,                                                   01S0288 00124000
*     GPR01F,                                                   01S0288 00125000
*     GPR14P,                                                   01S0288 00126000
*     GPR15F) RSTD;                                             01S0288 00127000
*   GPR00P=AP1REG;                  /* ADDRESS OF AP1BLOCK           */ 00128000
         LR    GPR00P,AP1REG                                    01S0289 00129000
*   GPR01F=LENGTH(AP1BLOCK);        /* LENGTH                        */ 00130000
         LA    GPR01F,360                                       01S0290 00131000
*   GPR14P=0;                       /* DUMMY ADDRESS                 */ 00132000
         SLR   GPR14P,GPR14P                                    01S0291 00133000
*   GPR15P=0;                       /* PAD CHAR 0, LENGTH 0          */ 00134000
         SLR   GPR15P,GPR15P                                    01S0292 00135000
*   MVCL(GPR00P,GPR14P);            /* ZERO AP1BLOCK                 */ 00136000
         MVCL  GPR00P,GPR14P                                    01S0293 00137000
*   RFY                                                         01S0294 00138000
*    (GPR00P,                                                   01S0294 00139000
*     GPR01F,                                                   01S0294 00140000
*     GPR14P,                                                   01S0294 00141000
*     GPR15F) UNRSTD;                                           01S0294 00142000
*                                                               01S0294 00143000
*   /*****************************************************************/ 00144000
*   /*                                                               */ 00145000
*   /* PUT ADDRESSES IN AP1BLOCK                                     */ 00146000
*   /*                                                               */ 00147000
*   /*****************************************************************/ 00148000
*                                                               01S0295 00149000
*   AP1HDR='AP1B';                  /* PUT IN ID                     */ 00150000
         MVC   AP1HDR(4,AP1REG),@CC03242                        01S0295 00151000
*   AP1DEVAD='    ';                /* CLEAR DEVICE ADDR             */ 00152000
         MVC   AP1DEVAD(4,AP1REG),@CC03243                      01S0296 00153000
*   AP1PDCBA=((AP1REG+LENGTH(AP1BLOCK)+DATDLEN+3)/4)*4;/* ADDR OF       00154000
*                                      PRINT DCB                     */ 00155000
         LA    @00,619                                          01S0297 00156000
         ALR   @00,AP1REG                                       01S0297 00157000
         SRDA  @00,32                                           01S0297 00158000
         D     @00,@CF00040                                     01S0297 00159000
         SLA   @01,2                                            01S0297 00160000
         ST    @01,AP1PDCBA(,AP1REG)                            01S0297 00161000
*   AP1DCBA=AP1PDCBA+PRDCBL;        /* ADDR OF TEST DCB              */ 00162000
         AL    @01,PRDCBL                                       01S0298 00163000
         ST    @01,AP1DCBA(,AP1REG)                             01S0298 00164000
*   AP1IOBA=AP1DCBA+TESTDCBL;       /* ADDR OF TEST IOB              */ 00165000
         AL    @01,TESTDCBL                                     01S0299 00166000
         ST    @01,AP1IOBA(,AP1REG)                             01S0299 00167000
*   AP1CCWA=((AP1IOBA+LENGTH(IOBSTDRD)+LENGTH(IOBEXTEN)+LENGTH(IOBAP1PT 00168000
*       )+7)/8)*8;                  /* ADDR OF CCW AREA              */ 00169000
         LR    @02,@01                                          01S0300 00170000
         AL    @02,@CF03282                                     01S0300 00171000
         SRDA  @02,32                                           01S0300 00172000
         D     @02,@CF00049                                     01S0300 00173000
         SLA   @03,3                                            01S0300 00174000
         ST    @03,AP1CCWA(,AP1REG)                             01S0300 00175000
*   AP1WRKA=AP1CCWA+(LENGTH(CCW)*MAXCCWS);/* ADDR OF WORK AREA       */ 00176000
*                                                               01S0301 00177000
         AL    @03,@CF03845                                     01S0301 00178000
         ST    @03,AP1WRKA(,AP1REG)                             01S0301 00179000
*   /*****************************************************************/ 00180000
*   /*                                                               */ 00181000
*   /* GETMAIN FOR BUFFER AREA                                       */ 00182000
*   /*                                                               */ 00183000
*   /*****************************************************************/ 00184000
*                                                               01S0302 00185000
*   DO;                             /* GETMAIN (R)              01S0302 00186000
*                                      LV(BUFFLEN)SP(DEBSP)          */ 00187000
*     RESPECIFY                                                 01S0303 00188000
*      (GPR01F,                                                 01S0303 00189000
*       GPR00F) RESTRICTED;                                     01S0303 00190000
*     GPR00F=BUFFLEN;               /* LENGTH REQUESTED              */ 00191000
         LA    GPR00F,864                                       01S0304 00192000
*     GPR01F=DEBSP;                 /* SP IN REG 1                   */ 00193000
         LA    GPR01F,230                                       01S0305 00194000
*     GEN(SLL   GPR01F,24)                                      01S0306 00195000
*     NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;              01S0306 00196000
         SLL   GPR01F,24                                                00197000
*     GPR00F=GPR00F|GPR01F;         /* SP IN HIGH BYTE               */ 00198000
         OR    GPR00F,GPR01F                                    01S0307 00199000
*     GPR01F=-1;                    /* INDICATE A GETMAIN REQUEST    */ 00200000
         SLR   GPR01F,GPR01F                                    01S0308 00201000
         BCTR  GPR01F,0                                         01S0308 00202000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 00203000
         SVC   10                                               01S0309 00204000
*     RESPECIFY                                                 01S0310 00205000
*      (GPR01F,                                                 01S0310 00206000
*       GPR00F) UNRESTRICTED;                                   01S0310 00207000
*   END;                            /* GETMAIN (R)              01S0311 00208000
*                                      LV(BUFFLEN)SP(DEBSP) GET AREA    00209000
*                                      TWO                           */ 00210000
*                                                               01S0311 00211000
*   /*****************************************************************/ 00212000
*   /*                                                               */ 00213000
*   /* PUT ADDRESS IN AP1BLOCK                                       */ 00214000
*   /*                                                               */ 00215000
*   /*****************************************************************/ 00216000
*                                                               01S0312 00217000
*   RFY                                                         01S0312 00218000
*     GPR01F RSTD;                                              01S0312 00219000
*   AP1BUFAD=GPR01F;                /* ADDR OF BUFFER                */ 00220000
         ST    GPR01F,AP1BUFAD(,AP1REG)                         01S0313 00221000
*   RFY                                                         01S0314 00222000
*     GPR01F UNRSTD;                                            01S0314 00223000
*                                                               01S0314 00224000
*   /*****************************************************************/ 00225000
*   /*                                                               */ 00226000
*   /* PROCESS PARMS                                                 */ 00227000
*   /*                                                               */ 00228000
*   /*****************************************************************/ 00229000
*                                                               01S0315 00230000
*   IF PARMLEN=6&PARMDATA='NODATA' THEN/* REQUEST NODATA OPTION      */ 00231000
         L     @06,@PC00001                                     01S0315 00232000
         CLC   PARMLEN(2,@06),@CH01082                          01S0315 00233000
         BNE   @RF00315                                         01S0315 00234000
         CLC   PARMDATA(6,@06),@CC03244                         01S0315 00235000
         BNE   @RF00315                                         01S0315 00236000
*     AP1NORD=ON;                                               01S0316 00237000
         OI    AP1NORD(AP1REG),B'10000000'                      01S0316 00238000
*   ELSE                                                        01S0317 00239000
*     ;                                                         01S0317 00240000
@RF00315 DS    0H                                               01S0318 00241000
*   IF PARMLEN=4&PARMDATA(1:4)='DATA' THEN/* REQUEST DATA OPTION     */ 00242000
         L     @06,@PC00001                                     01S0318 00243000
         CLC   PARMLEN(2,@06),@CH00040                          01S0318 00244000
         BNE   @RF00318                                         01S0318 00245000
         CLC   PARMDATA(4,@06),@CC03245                         01S0318 00246000
         BNE   @RF00318                                         01S0318 00247000
*     AP1READ=ON;                                               01S0319 00248000
         OI    AP1READ(AP1REG),B'01000000'                      01S0319 00249000
*   ELSE                                                        01S0320 00250000
*     ;                                                         01S0320 00251000
*                                                               01S0320 00252000
@RF00318 DS    0H                                               01S0321 00253000
*   /*****************************************************************/ 00254000
*   /*                                                               */ 00255000
*   /* MOVE IN DCBS, OPEN PRINT, AND BUILD IOB                       */ 00256000
*   /*                                                               */ 00257000
*   /*****************************************************************/ 00258000
*                                                               01S0321 00259000
*   AP1DCBA->BYTE256(1:TESTDCBL)=ADDR(TESTDCB)->BYTE256(1:TESTDCBL);    00260000
         L     @06,AP1DCBA(,AP1REG)                             01S0321 00261000
         L     @15,TESTDCBL                                     01S0321 00262000
         BCTR  @15,0                                            01S0321 00263000
         LA    @14,TESTDCB                                      01S0321 00264000
         EX    @15,@SM03864                                     01S0321 00265000
*                                   /* MOVE IN TEST DCB              */ 00266000
*   AP1PDCBA->BYTE256(1:PRDCBL)=ADDR(PRDCB)->BYTE256(1:PRDCBL);/*       00267000
*                                      MOVE IN PRINT DCB             */ 00268000
         L     @06,AP1PDCBA(,AP1REG)                            01S0322 00269000
         L     @15,PRDCBL                                       01S0322 00270000
         BCTR  @15,0                                            01S0322 00271000
         LA    @14,PRDCB                                        01S0322 00272000
         EX    @15,@SM03864                                     01S0322 00273000
*   AP1PRNP=ON;                     /* GO TO NEW (FIRST) PAGE        */ 00274000
         OI    AP1PRNP(AP1REG),B'01000000'                      01S0323 00275000
*   CALL COMM;                      /* GO TO NEW PAGE                */ 00276000
         BAL   @14,COMM                                         01S0324 00277000
*   IOBSTDRD=IOBSTDRD&&IOBSTDRD;    /* CLEAR IOB AREA                */ 00278000
         L     @06,AP1IOBA(,AP1REG)                             01S0325 00279000
         XC    IOBSTDRD(32,@06),IOBSTDRD(@06)                   01S0325 00280000
*   IOBCMDCH=ON;                    /* CMD CHAIN FOR ERPS            */ 00281000
*   IOBUNREL=ON;                    /* UNRELATED REQUEST             */ 00282000
         OI    IOBCMDCH(@06),B'01000010'                        01S0327 00283000
*   IOBECBPT=ADDR(AP1IOECB);        /* ECB ADDRESS                   */ 00284000
         LA    @15,AP1IOECB(,AP1REG)                            01S0328 00285000
         ST    @15,IOBECBPT(,@06)                               01S0328 00286000
*   IOBDCBPT=AP1DCBA;               /* DCB ADDRESS                   */ 00287000
         L     @15,AP1DCBA(,AP1REG)                             01S0329 00288000
         ST    @15,IOBDCBPT(,@06)                               01S0329 00289000
*   IOBAP1PT=AP1REG;                /* ADDR OF AP1BLOCK INTO IOB     */ 00290000
         ST    AP1REG,IOBAP1PT(,@06)                            01S0330 00291000
*   IOBSTART=AP1CCWA;               /* ADDR OF CCWS INTO IOB         */ 00292000
         L     @15,AP1CCWA(,AP1REG)                             01S0331 00293000
         ST    @15,IOBSTART(,@06)                               01S0331 00294000
*   IF AP1QUIT=ON THEN                                          01S0332 00295000
         TM    AP1QUIT(AP1REG),B'00001000'                      01S0332 00296000
         BO    @RT00332                                         01S0332 00297000
*     ;                             /* ERROR ALLREADY--SKIP FURTHER     00298000
*                                      PROCESSING                    */ 00299000
*   ELSE                            /* NO ERROR FOUND SO FAR         */ 00300000
*     DO;                                                       01S0334 00301000
*                                                               01S0334 00302000
*       /*************************************************************/ 00303000
*       /*                                                           */ 00304000
*       /* DETERMINES DEVICE TYPE AND SETS UP AP1DEVTP. FINDS DD CARD*/ 00305000
*       /* ENTRY--IF NO DD ISSUES MSG 12. CHECKS UCB DEVICE TYPE FOR */ 00306000
*       /* 3330, 3340 OR 3350--IF NONE, ISSUES MESSAGE 14.           */ 00307000
*       /*                                                           */ 00308000
*       /*************************************************************/ 00309000
*                                                               01S0335 00310000
*                                                               01S0335 00311000
*       /*************************************************************/ 00312000
*       /*                                                           */ 00313000
*       /* DETERMINE DEVICE TYPE                                     */ 00314000
*       /*                                                           */ 00315000
*       /*************************************************************/ 00316000
*                                                               01S0335 00317000
*       DDPTR=ADDR(TIOENTRY);       /* 1ST DEV SEG OF TIOT           */ 00318000
         L     @06,FLCCVT                                       01S0335 00319000
         L     @06,CVTTCBP(,@06)                                01S0335 00320000
         L     @06,TCBPTR(,@06)                                 01S0335 00321000
         L     DDPTR,TCBTIO(,@06)                               01S0335 00322000
         LA    DDPTR,TIOENTRY(,DDPTR)                           01S0335 00323000
*       RFY                                                     01S0336 00324000
*         TIOT1 BASED(DDPTR-LENGTH(TIOT1));                     01S0336 00325000
*       UCBPTR=0;                   /* CLEAR UCBPTR                  */ 00326000
         SLR   UCBPTR,UCBPTR                                    01S0337 00327000
*       DO WHILE TIOELNGHÂ¬=0&UCBPTR=0;/* AS LONG AS THERE IS ANOTHER    00328000
*                                      DD ENTRY AND CORRECT ENTRY NOT   00329000
*                                      FOUND                         */ 00330000
         B     @DE00338                                         01S0338 00331000
@DL00338 DS    0H                                               01S0339 00332000
*         IF TIOEDDNM='TESTDD  ' THEN/* CORRECT DD FOUND             */ 00333000
         LR    @06,DDPTR                                        01S0339 00334000
         SL    @06,@CF00066                                     01S0339 00335000
         CLC   TIOEDDNM(8,@06),@CC03249                         01S0339 00336000
         BNE   @RF00339                                         01S0339 00337000
*           UCBPTR=TIOEFSRT;        /* GET UCB ADDRESS               */ 00338000
         L     UCBPTR,TIOEFSRT-1(,@06)                          01S0340 00339000
         LA    UCBPTR,0(,UCBPTR)                                01S0340 00340000
*         ELSE                      /* NOT CORRECT DD                */ 00341000
*           DDPTR=DDPTR+TIOELNGH;   /* INCR TO NEXT ENTRY            */ 00342000
         B     @RC00339                                         01S0341 00343000
@RF00339 SLR   @06,@06                                          01S0341 00344000
         IC    @06,TIOELNGH-24(,DDPTR)                          01S0341 00345000
         ALR   DDPTR,@06                                        01S0341 00346000
*       END;                        /* DO WHILE                      */ 00347000
@RC00339 DS    0H                                               01S0342 00348000
@DE00338 CLI   TIOELNGH-24(DDPTR),0                             01S0342 00349000
         BE    @DC00338                                         01S0342 00350000
         LTR   UCBPTR,UCBPTR                                    01S0342 00351000
         BZ    @DL00338                                         01S0342 00352000
@DC00338 DS    0H                                               01S0343 00353000
*       IF UCBPTR=0 THEN            /* NO DD CARD FOR TEST DEVICE    */ 00354000
         LTR   UCBPTR,UCBPTR                                    01S0343 00355000
         BNZ   @RF00343                                         01S0343 00356000
*         DO;                                                   01S0344 00357000
*           AP1CNCOD=MNDD;          /* SETUP FOR DD STMT MISSING MSG */ 00358000
         MVI   AP1CNCOD(AP1REG),X'0C'                           01S0345 00359000
*           CALL COMM;              /* SEND MSG TO CONSOLE           */ 00360000
         BAL   @14,COMM                                         01S0346 00361000
*           AP1QUIT=ON;             /* BYPASS ALL TESTING            */ 00362000
         OI    AP1QUIT(AP1REG),B'00001000'                      01S0347 00363000
*         END;                                                  01S0348 00364000
*       ELSE                        /* OK SO FAR, CONTINUE           */ 00365000
*         DO;                                                   01S0349 00366000
         B     @RC00343                                         01S0349 00367000
@RF00343 DS    0H                                               01S0350 00368000
*           AP1DEVAD(1:1)='0';      /* PUT EBCDIC ADDR IN AP1DEVAD      00369000
*                                      FROM UCB                      */ 00370000
         MVI   AP1DEVAD(AP1REG),C'0'                            01S0350 00371000
*           AP1DEVAD(2:4)=UCBNAME;                              01S0351 00372000
         MVC   AP1DEVAD+1(3,AP1REG),UCBNAME(UCBPTR)             01S0351 00373000
*           IF UCB3DACC=ON THEN     /* DASD                          */ 00374000
         TM    UCB3DACC(UCBPTR),B'00100000'                     01S0352 00375000
         BNO   @RF00352                                         01S0352 00376000
*             DO;                                               01S0353 00377000
*               IF UCBTBYT4=UCB3330 THEN/* 3330                      */ 00378000
         CLI   UCBTBYT4(UCBPTR),X'09'                           01S0354 00379000
         BNE   @RF00354                                         01S0354 00380000
*                 AP1DEVTP=AP13330;                             01S0355 00381000
         MVI   AP1DEVTP(AP1REG),X'01'                           01S0355 00382000
*               ELSE                                            01S0356 00383000
*                 ;                 /* NOT 3330                      */ 00384000
@RF00354 DS    0H                                               01S0357 00385000
*               IF UCBTBYT4=UCB3331 THEN/* 3330 MOD 2                */ 00386000
         CLI   UCBTBYT4(UCBPTR),X'0D'                           01S0357 00387000
         BNE   @RF00357                                         01S0357 00388000
*                 AP1DEVTP=AP13331;                             01S0358 00389000
         MVI   AP1DEVTP(AP1REG),X'02'                           01S0358 00390000
*               ELSE                                            01S0359 00391000
*                 ;                                             01S0359 00392000
@RF00357 DS    0H                                               01S0360 00393000
*               IF UCBTBYT4=UCB3340 THEN/* 3344                      */ 00394000
         CLI   UCBTBYT4(UCBPTR),X'0A'                           01S0360 00395000
         BNE   @RF00360                                         01S0360 00396000
*                 AP1DEVTP=AP13344;                             01S0361 00397000
         MVI   AP1DEVTP(AP1REG),X'03'                           01S0361 00398000
*               ELSE                                            01S0362 00399000
*                 ;                 /* NOT 3344                      */ 00400000
@RF00360 DS    0H                                               01S0363 00401000
*               IF UCBTBYT4=UCB3350 THEN/* 3350                      */ 00402000
         CLI   UCBTBYT4(UCBPTR),X'0B'                           01S0363 00403000
         BNE   @RF00363                                         01S0363 00404000
*                 AP1DEVTP=AP13350;                             01S0364 00405000
         MVI   AP1DEVTP(AP1REG),X'04'                           01S0364 00406000
*               ELSE                                            01S0365 00407000
*                 ;                 /* NOT 3350                      */ 00408000
@RF00363 DS    0H                                               01S0366 00409000
*             END;                                              01S0366 00410000
*           ELSE                                                01S0367 00411000
*             ;                     /* NOT DASD                      */ 00412000
@RF00352 DS    0H                                               01S0368 00413000
*           IF UCBVRDEV=ON THEN     /* VIO                           */ 00414000
         TM    UCBVRDEV(UCBPTR),B'10000000'                     01S0368 00415000
         BNO   @RF00368                                         01S0368 00416000
*             AP1DEVTP=0;           /* DO NOT ACCEPT DEVICE          */ 00417000
         MVI   AP1DEVTP(AP1REG),X'00'                           01S0369 00418000
*           ELSE                                                01S0370 00419000
*             ;                     /* NOT VIO -- OK                 */ 00420000
@RF00368 DS    0H                                               01S0371 00421000
*           IF AP1DEVTP=0 THEN      /* NOT ELLIGIBLE DEVICE          */ 00422000
         CLI   AP1DEVTP(AP1REG),0                               01S0371 00423000
         BNE   @RF00371                                         01S0371 00424000
*             DO;                                               01S0372 00425000
*               AP1CNCOD=MIDT;      /* SETUP 'INCORR DEV TYPE' MSG   */ 00426000
         MVI   AP1CNCOD(AP1REG),X'0E'                           01S0373 00427000
*               CALL COMM;          /* SEND MSG TO CONSOLE           */ 00428000
         BAL   @14,COMM                                         01S0374 00429000
*               AP1QUIT=ON;         /* BYPASS TESTING                */ 00430000
         OI    AP1QUIT(AP1REG),B'00001000'                      01S0375 00431000
*             END;                                              01S0376 00432000
*           ELSE                                                01S0377 00433000
*             ;                     /* OK SO FAR, CONTINUE           */ 00434000
@RF00371 DS    0H                                               01S0378 00435000
*         END;                                                  01S0378 00436000
*     END;                                                      01S0379 00437000
@RC00343 DS    0H                                               01S0380 00438000
*   IF AP1QUIT=ON THEN                                          01S0380 00439000
@RT00332 TM    AP1QUIT(AP1REG),B'00001000'                      01S0380 00440000
         BO    @RT00380                                         01S0380 00441000
*     ;                             /* ERROR ALREADY--SKIP FURTHER      00442000
*                                      PROCESSING                    */ 00443000
*   ELSE                            /* NO ERROR FOUND SO FAR         */ 00444000
*     DO;                                                       01S0382 00445000
*                                                               01S0382 00446000
*       /*************************************************************/ 00447000
*       /*                                                           */ 00448000
*       /* DEB BUILD ROUTINE                                         */ 00449000
*       /*                                                           */ 00450000
*       /*************************************************************/ 00451000
*                                                               01S0383 00452000
*                                                               01S0383 00453000
*       /*************************************************************/ 00454000
*       /*                                                           */ 00455000
*       /* GETMAINS CORE FOR DEB. PUTS EXTENTS INTO DEB FOR WHOLE    */ 00456000
*       /* PACK. POINTS APP ADDRESSES TO OUR APPENDAGES.             */ 00457000
*       /*                                                           */ 00458000
*       /*************************************************************/ 00459000
*                                                               01S0383 00460000
*       WRKAD(1)=UCBPTR;            /* SAVE UCB ADDRESS IN NON FETCH    00461000
*                                      PROTECTED AREA                */ 00462000
*                                                               01S0383 00463000
         L     @06,AP1WRKA(,AP1REG)                             01S0383 00464000
         ST    UCBPTR,WRKAD(,@06)                               01S0383 00465000
*       /*************************************************************/ 00466000
*       /*                                                           */ 00467000
*       /* GETMAIN AREA FOR DEB                                      */ 00468000
*       /*                                                           */ 00469000
*       /*************************************************************/ 00470000
*                                                               01S0384 00471000
*       DO;                         /* MODESET EXTKEY(DATAMGT)       */ 00472000
*         SPKA(80);                 /* SET PSW KEY                   */ 00473000
         LA    @09,80                                           01S0385 00474000
         SPKA  0(@09)                                           01S0385 00475000
*       END;                        /* MODESET EXTKEY(DATAMGT) DATA     00476000
*                                      MGT KEY                       */ 00477000
*       DO;                         /* GETMAIN (R) LV(LENGTH(DEBBASIC   00478000
*                                      )+LENGTH(DEBDASD)+LENGTH(DEB))   00479000
*                                      SP(DEBSP)                     */ 00480000
*         RESPECIFY                                             01S0388 00481000
*          (GPR01F,                                             01S0388 00482000
*           GPR00F) RESTRICTED;                                 01S0388 00483000
*         GPR00F=LENGTH(DEBBASIC)+LENGTH(DEBDASD)+LENGTH(DEB);/*        00484000
*                                      LENGTH REQUESTED              */ 00485000
         LA    GPR00F,84                                        01S0389 00486000
*         GPR01F=DEBSP;             /* SP IN REG 1                   */ 00487000
         LA    GPR01F,230                                       01S0390 00488000
*         GEN(SLL   GPR01F,24)                                  01S0391 00489000
*         NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;          01S0391 00490000
         SLL   GPR01F,24                                                00491000
*         GPR00F=GPR00F|GPR01F;     /* SP IN HIGH BYTE               */ 00492000
         OR    GPR00F,GPR01F                                    01S0392 00493000
*         GPR01F=-1;                /* INDICATE A GETMAIN REQUEST    */ 00494000
         SLR   GPR01F,GPR01F                                    01S0393 00495000
         BCTR  GPR01F,0                                         01S0393 00496000
*         SVC(10);                  /* R-FORM OF GETMAIN             */ 00497000
         SVC   10                                               01S0394 00498000
*         RESPECIFY                                             01S0395 00499000
*          (GPR01F,                                             01S0395 00500000
*           GPR00F) UNRESTRICTED;                               01S0395 00501000
*       END;                        /* GETMAIN (R) LV(LENGTH(DEBBASIC   00502000
*                                      )+LENGTH(DEBDASD)+LENGTH(DEB))   00503000
*                                      SP(DEBSP) GET DEB             */ 00504000
*       RFY                                                     01S0397 00505000
*        (GPR01P,                                               01S0397 00506000
*         GPR03P) RSTD;                                         01S0397 00507000
*       GPR03P=GPR01P+LENGTH(DEB);  /* SAVE ADDRESS OF DEB BASIC        00508000
*                                      SECTION                       */ 00509000
         LA    @09,36                                           01S0398 00510000
         LR    GPR03P,GPR01P                                    01S0398 00511000
         ALR   GPR03P,@09                                       01S0398 00512000
*       RFY                                                     01S0399 00513000
*         GPR01P UNRSTD;                                        01S0399 00514000
*       RFY                                                     01S0400 00515000
*         DEBBASIC BASED(GPR03P);   /* TEMP ADDRESSABILITY           */ 00516000
*       DEBBASIC=DEBBASIC&&DEBBASIC;/* CLEAR DEB                     */ 00517000
         XC    DEBBASIC(32,GPR03P),DEBBASIC(GPR03P)             01S0401 00518000
*       DEBDASD=DEBDASD&&DEBDASD;   /* CLEAR DEB                     */ 00519000
         LA    @06,32                                           01S0402 00520000
         ALR   @06,GPR03P                                       01S0402 00521000
         XC    DEBDASD(16,@06),DEBDASD(@06)                     01S0402 00522000
*       DEBAPPAD=ADDR(DEBBASIC)-LENGTH(DEB);/* AVT ADDRESS           */ 00523000
         LCR   @09,@09                                          01S0403 00524000
         ALR   @09,GPR03P                                       01S0403 00525000
         ST    @09,DEBAPPAD(,GPR03P)                            01S0403 00526000
*       DEBEXSCL=DEBEXDA;           /* EXTENT SCALE                  */ 00527000
         MVI   DEBEXSCL(GPR03P),X'04'                           01S0404 00528000
*       DEBPREFX=DEBPREFX&&DEBPREFX;/* CLEAR DEB                     */ 00529000
         L     @09,DEBAPPAD(,GPR03P)                            01S0405 00530000
         XC    DEBPREFX(16,@09),DEBPREFX(@09)                   01S0405 00531000
*       DEBEOEA=ADDR(CVTBRET);      /* DUMMY EOE                     */ 00532000
         L     @06,FLCCVT                                       01S0406 00533000
         LA    @02,CVTBRET(,@06)                                01S0406 00534000
         ST    @02,DEBEOEA(,@09)                                01S0406 00535000
*       DEBSIOA=ADDR(IAPPFXAP);     /* POINT TO OUR PFX APP          */ 00536000
         L     @15,@CV03170                                     01S0407 00537000
         ST    @15,DEBSIOA(,@09)                                01S0407 00538000
*       DEBSIONP=ONEPAGE;           /* FIX ONE PAGE                  */ 00539000
         NI    DEBSIONP(@09),B'11110001'                        01S0408 00540000
         OI    DEBSIONP(@09),B'00000001'                        01S0408 00541000
*       DEBPGFX=ON;                 /* PFX APPENDAGE PRESENT         */ 00542000
         OI    DEBPGFX(@09),B'10000000'                         01S0409 00543000
*       DEBPCIA=ADDR(CVTBRET);      /* DUMMY PCI                     */ 00544000
         ST    @02,DEBPCIA(,@09)                                01S0410 00545000
*       DEBCEA=ADDR(CVTBRET);       /* DUMMY CE                      */ 00546000
         ST    @02,DEBCEA(,@09)                                 01S0411 00547000
*       DEBXCEA=ADDR(IAPABNAP);     /* POINT TO OUR ABNORMAL APP     */ 00548000
         L     @02,@CV03167                                     01S0412 00549000
         ST    @02,DEBXCEA(,@09)                                01S0412 00550000
*       DEBXCENP=ONEPAGE;           /* FIX ONE PAGE                  */ 00551000
         NI    DEBXCENP(@09),B'11110001'                        01S0413 00552000
         OI    DEBXCENP(@09),B'00000001'                        01S0413 00553000
*       DEBLNGTH=(LENGTH(DEB)+LENGTH(DEBBASIC)+LENGTH(DEBDASD))/8;/*    00554000
*                                      LENGTH DEB                    */ 00555000
         MVI   DEBLNGTH(@09),X'0A'                              01S0414 00556000
*       DEBNMEXT=1;                 /* NUMBER OF EXTENTS             */ 00557000
         MVI   DEBNMEXT(GPR03P),X'01'                           01S0415 00558000
*       DEBDCBAD=AP1DCBA;           /* DCB ADDRESS                   */ 00559000
         L     @09,AP1DCBA(,AP1REG)                             01S0416 00560000
         ST    @09,DEBDCBAD(,GPR03P)                            01S0416 00561000
*       DEBDEBID=DEBID|TCBPKF;      /* DEBID + KEY                   */ 00562000
         L     @09,CVTTCBP(,@06)                                01S0417 00563000
         L     @09,TCBPTR(,@09)                                 01S0417 00564000
         MVC   DEBDEBID(1,GPR03P),TCBPKF(@09)                   01S0417 00565000
         OI    DEBDEBID(GPR03P),X'0F'                           01S0417 00566000
*       DEBUCBAD=WRKAD(1);          /* FROM INITDEVT                 */ 00567000
         LA    @06,32                                           01S0418 00568000
         ALR   @06,GPR03P                                       01S0418 00569000
         L     @02,AP1WRKA(,AP1REG)                             01S0418 00570000
         L     @02,WRKAD(,@02)                                  01S0418 00571000
         ST    @02,DEBUCBAD(,@06)                               01S0418 00572000
*       DEBTCBAD=ADDR(TCB);         /* CURRENT TCB ADDRESS           */ 00573000
*                                                               01S0419 00574000
         ST    @09,DEBTCBAD(,GPR03P)                            01S0419 00575000
*       /*************************************************************/ 00576000
*       /*                                                           */ 00577000
*       /* SET UP DEB EXTENTS                                        */ 00578000
*       /*                                                           */ 00579000
*       /*************************************************************/ 00580000
*                                                               01S0420 00581000
*       DEBSTRCC='0000'X;           /* SET FIRST CYL                 */ 00582000
         MVC   DEBSTRCC(2,@06),@CB03253                         01S0420 00583000
*       DEBSTRHH='0000'X;           /* SET FIRST HEAD                */ 00584000
         MVC   DEBSTRHH(2,@06),@CB03253                         01S0421 00585000
*       IF AP1DEVTP=AP13330|AP1DEVTP=AP13331 THEN/* 3330 MOD 1 OR 11 */ 00586000
         CLI   AP1DEVTP(AP1REG),1                               01S0422 00587000
         BE    @RT00422                                         01S0422 00588000
         CLI   AP1DEVTP(AP1REG),2                               01S0422 00589000
         BNE   @RF00422                                         01S0422 00590000
@RT00422 DS    0H                                               01S0423 00591000
*         DO;                                                   01S0423 00592000
*           DEBENDHH=HI3330HD;      /* LAST HEAD FOR 3330S           */ 00593000
         LA    @09,32                                           01S0424 00594000
         ALR   @09,GPR03P                                       01S0424 00595000
         MVC   DEBENDHH(2,@09),@CB03072                         01S0424 00596000
*           IF AP1DEVTP=AP13330 THEN/* 3330 MOD 1                    */ 00597000
         CLI   AP1DEVTP(AP1REG),1                               01S0425 00598000
         BNE   @RF00425                                         01S0425 00599000
*             DEBENDCC='0193'X;     /* LAST CYL 3330 MOD 1           */ 00600000
         MVC   DEBENDCC(2,@09),@CB03254                         01S0426 00601000
*           ELSE                    /* 3330 MOD 11                   */ 00602000
*             DEBENDCC='0327'X;     /* LAST CYL 3330 MOD 11          */ 00603000
         B     @RC00425                                         01S0427 00604000
@RF00425 MVC   DEBENDCC+32(2,GPR03P),@CB03255                   01S0427 00605000
*         END;                                                  01S0428 00606000
*       ELSE                                                    01S0429 00607000
*         ;                         /* NOT 3330 MOD 1 OR 11          */ 00608000
@RF00422 DS    0H                                               01S0430 00609000
*       IF AP1DEVTP=AP13344 THEN    /* 3344                          */ 00610000
@RC00422 CLI   AP1DEVTP(AP1REG),3                               01S0430 00611000
         BNE   @RF00430                                         01S0430 00612000
*         DO;                                                   01S0431 00613000
*           DEBENDHH=HI3344HD;      /* LAST HEAD 3344                */ 00614000
         LA    @09,32                                           01S0432 00615000
         ALR   @09,GPR03P                                       01S0432 00616000
         MVC   DEBENDHH(2,@09),@CB03128                         01S0432 00617000
*           DEBENDCC='02B7'X;       /* LAST CYL 3344                 */ 00618000
         MVC   DEBENDCC(2,@09),@CB03256                         01S0433 00619000
*         END;                                                  01S0434 00620000
*       ELSE                                                    01S0435 00621000
*         ;                         /* NOT 3344                      */ 00622000
@RF00430 DS    0H                                               01S0436 00623000
*       IF AP1DEVTP=AP13350 THEN    /* 3350                          */ 00624000
         CLI   AP1DEVTP(AP1REG),4                               01S0436 00625000
         BNE   @RF00436                                         01S0436 00626000
*         DO;                                                   01S0437 00627000
*           DEBENDHH=HI3350HD;      /* LAST HEAD 3350                */ 00628000
         LA    @09,32                                           01S0438 00629000
         ALR   @09,GPR03P                                       01S0438 00630000
         MVC   DEBENDHH(2,@09),@CB03126                         01S0438 00631000
*           DEBENDCC='022A'X;       /* LAST CYL 3350                 */ 00632000
         MVC   DEBENDCC(2,@09),@CB03257                         01S0439 00633000
*         END;                                                  01S0440 00634000
*       ELSE                                                    01S0441 00635000
*         ;                         /* NOT 3350                      */ 00636000
*                                                               01S0441 00637000
@RF00436 DS    0H                                               01S0442 00638000
*       /*************************************************************/ 00639000
*       /*                                                           */ 00640000
*       /* PUT DEB ON DEBCHAIN                                       */ 00641000
*       /*                                                           */ 00642000
*       /*************************************************************/ 00643000
*                                                               01S0442 00644000
*       DEBDEBAD=TCBDEB;            /* CURRENT FIRST INTO OUR CHAIN  */ 00645000
         L     @09,FLCCVT                                       01S0442 00646000
         L     @09,CVTTCBP(,@09)                                01S0442 00647000
         L     @09,TCBPTR(,@09)                                 01S0442 00648000
         L     @06,TCBDEB(,@09)                                 01S0442 00649000
         ST    @06,DEBDEBAD(,GPR03P)                            01S0442 00650000
*       RFY                                                     01S0443 00651000
*         GPR04F RSTD;                                          01S0443 00652000
*       DO;                         /* MODESET EXTKEY(TCB)      01S0444 00653000
*                                      WORKREG(GPR04F)               */ 00654000
*         GPR04F=TCBPKF;            /* GET KEY FROM TCB              */ 00655000
         SLR   GPR04F,GPR04F                                    01S0445 00656000
         IC    GPR04F,TCBPKF(,@09)                              01S0445 00657000
*         SPKA(GPR04F);             /* SET PSW KEY                   */ 00658000
         SPKA  0(GPR04F)                                        01S0446 00659000
*       END;                        /* MODESET EXTKEY(TCB)      01S0447 00660000
*                                      WORKREG(GPR04F) USER KEY      */ 00661000
*       RFY                                                     01S0448 00662000
*         GPR04F UNRSTD;                                        01S0448 00663000
*       AP1DEBA=GPR03P;             /* PUT DEB ADDRESS IN AP1B       */ 00664000
         ST    GPR03P,AP1DEBA(,AP1REG)                          01S0449 00665000
*       RFY                                                     01S0450 00666000
*         DEBBASIC;                 /* ADDRESS FROM AP1DEBAD         */ 00667000
*       RFY                                                     01S0451 00668000
*         GPR03P UNRSTD;                                        01S0451 00669000
*       DO;                         /* MODESET KEY(ZERO)             */ 00670000
*         I10701='00000000'B;       /* OR MASK                       */ 00671000
         MVI   I10701,B'00000000'                               01S0453 00672000
*         I10702='00000000'B;       /* AND MASK                      */ 00673000
         MVI   I10702,B'00000000'                               01S0454 00674000
*         I10703='00000000'B;       /* RESERVED                      */ 00675000
         MVI   I10703,B'00000000'                               01S0455 00676000
*         I10704='00110000'B;                                   01S0456 00677000
         MVI   I10704,B'00110000'                               01S0456 00678000
*         RESPECIFY                                             01S0457 00679000
*           GPR01F RESTRICTED;                                  01S0457 00680000
*         GPR01F=I107;              /* MODESET PARMLIST              */ 00681000
         L     GPR01F,I107                                      01S0458 00682000
*         SVC(107);                 /* ISSUE MODESET SVC             */ 00683000
         SVC   107                                              01S0459 00684000
*         RESPECIFY                                             01S0460 00685000
*          (GPR01F) UNRESTRICTED;                               01S0460 00686000
*       END;                        /* MODESET KEY(ZERO) KEY 0 FOR      00687000
*                                      TCB                           */ 00688000
*HANGDEB:                                                       01S0462 00689000
*       ;                           /* FOR CS LOOP                   */ 00690000
HANGDEB  DS    0H                                               01S0463 00691000
*       CS(DEBDEBAD,AP1DEBA,TCBDEB);/* PUT OUR ADDR INTO TCB         */ 00692000
         L     @09,AP1DEBA(,AP1REG)                             01S0463 00693000
         L     @06,DEBDEBAD(,@09)                               01S0463 00694000
         LR    @15,@09                                          01S0463 00695000
         L     @14,FLCCVT                                       01S0463 00696000
         L     @14,CVTTCBP(,@14)                                01S0463 00697000
         L     @14,TCBPTR(,@14)                                 01S0463 00698000
         CS    @06,@15,TCBDEB(@14)                              01S0463 00699000
         BZ    @BC00463                                         01S0463 00700000
         ST    @06,DEBDEBAD(,@09)                               01S0463 00701000
@BC00463 DS    0H                                               01S0464 00702000
*       BC(7,HANGDEB);              /* LOOP IF FIRST DEB CHANGED     */ 00703000
         BC    7,HANGDEB                                        01S0464 00704000
*       DO;                         /* MODESET KEY(NZERO)            */ 00705000
*         I10701='00000000'B;       /* OR MASK                       */ 00706000
         MVI   I10701,B'00000000'                               01S0466 00707000
*         I10702='00000000'B;       /* AND MASK                      */ 00708000
         MVI   I10702,B'00000000'                               01S0467 00709000
*         I10703='00000000'B;       /* RESERVED                      */ 00710000
         MVI   I10703,B'00000000'                               01S0468 00711000
*         I10704='00100000'B;                                   01S0469 00712000
         MVI   I10704,B'00100000'                               01S0469 00713000
*         RESPECIFY                                             01S0470 00714000
*           GPR01F RESTRICTED;                                  01S0470 00715000
*         GPR01F=I107;              /* MODESET PARMLIST              */ 00716000
         L     GPR01F,I107                                      01S0471 00717000
*         SVC(107);                 /* ISSUE MODESET SVC             */ 00718000
         SVC   107                                              01S0472 00719000
*         RESPECIFY                                             01S0473 00720000
*          (GPR01F) UNRESTRICTED;                               01S0473 00721000
*       END;                        /* MODESET KEY(NZERO) USER KEY   */ 00722000
*       AP1LSTCC=DEBENDCC;          /* SAVE LAST CYL NUMBER          */ 00723000
         L     @09,AP1DEBA(,AP1REG)                             01S0475 00724000
         LA    @06,32                                           01S0475 00725000
         ALR   @06,@09                                          01S0475 00726000
         LH    @15,DEBENDCC(,@06)                               01S0475 00727000
         N     @15,@CF03868                                     01S0475 00728000
         STH   @15,AP1LSTCC(,AP1REG)                            01S0475 00729000
*       AP1LSTHH=DEBENDHH;          /* SAVE LAST HEAD                */ 00730000
*                                                               01S0476 00731000
         LH    @06,DEBENDHH(,@06)                               01S0476 00732000
         N     @06,@CF03868                                     01S0476 00733000
         STH   @06,AP1LSTHH(,AP1REG)                            01S0476 00734000
*       /*************************************************************/ 00735000
*       /*                                                           */ 00736000
*       /* ALTER DCB FIELDS                                          */ 00737000
*       /*                                                           */ 00738000
*       /*************************************************************/ 00739000
*                                                               01S0477 00740000
*       DCBDEBAD=AP1DEBA;           /* POINT DCB TO DEB              */ 00741000
         L     @06,AP1DCBA(,AP1REG)                             01S0477 00742000
         LA    @15,40                                           01S0477 00743000
         ALR   @15,@06                                          01S0477 00744000
         ST    @09,DCBDEBAD(,@15)                               01S0477 00745000
*       DCBIFLGS=DCBIFLG;           /* I-FLGS                        */ 00746000
         MVC   DCBIFLGS(1,@15),DCBIFLG(@15)                     01S0478 00747000
*       DCBTIOT=0;                  /* CLEAR                         */ 00748000
         SLR   @09,@09                                          01S0479 00749000
         STH   @09,DCBTIOT(,@15)                                01S0479 00750000
*       DCBMACRF=DCBMACR;           /* MACRF                         */ 00751000
*                                                               01S0480 00752000
         MVC   DCBMACRF(2,@15),DCBMACR(@15)                     01S0480 00753000
*       /*************************************************************/ 00754000
*       /*                                                           */ 00755000
*       /* ISSUE DEBCHK ADD                                          */ 00756000
*       /*                                                           */ 00757000
*       /*************************************************************/ 00758000
*                                                               01S0481 00759000
*       RFY                                                     01S0481 00760000
*        (GPR01P) RSTD;                                         01S0481 00761000
*       GPR01P=AP1DCBA;             /* DCB ADDRESS                   */ 00762000
         LR    GPR01P,@06                                       01S0482 00763000
*       RFY                                                     01S0483 00764000
*         GPR01P UNRSTD;                                        01S0483 00765000
*       GENERATE;                                               01S0484 00766000
         DEBCHK (GPR01P),TYPE=ADD,AM=EXCP ADD DEB                       00767000
*       RFY                                                     01S0485 00768000
*         GPR15F RSTD;                                          01S0485 00769000
*       IF GPR15FÂ¬=0 THEN           /* DEBCHK ADD FAILED             */ 00770000
         LTR   GPR15F,GPR15F                                    01S0486 00771000
         BZ    @RF00486                                         01S0486 00772000
*         DO;                                                   01S0487 00773000
*           RFY                                                 01S0488 00774000
*             GPR15F UNRSTD;                                    01S0488 00775000
*           AP1CNCOD=MUTO;          /* SETUP FOR OPEN FAILED MSG     */ 00776000
         MVI   AP1CNCOD(AP1REG),X'0D'                           01S0489 00777000
*           CALL COMM;              /* SEND MSG TO CONSOLE           */ 00778000
         BAL   @14,COMM                                         01S0490 00779000
*           RFY                                                 01S0491 00780000
*             GPR15F RSTD;                                      01S0491 00781000
*           AP1QUIT=ON;             /* BYPASS TESTS                  */ 00782000
         OI    AP1QUIT(AP1REG),B'00001000'                      01S0492 00783000
*         END;                                                  01S0493 00784000
*       ELSE                        /* DEBCHK ADD OK                 */ 00785000
*         AP1DEBCH=ON;              /* DEB CHAINED AND DEBCHK ADDED  */ 00786000
         B     @RC00486                                         01S0494 00787000
@RF00486 OI    AP1DEBCH(AP1REG),B'00100000'                     01S0494 00788000
*       RFY                                                     01S0495 00789000
*         GPR15F UNRSTD;                                        01S0495 00790000
@RC00486 DS    0H                                               01S0496 00791000
*       IF AP1QUIT=ON THEN                                      01S0496 00792000
         TM    AP1QUIT(AP1REG),B'00001000'                      01S0496 00793000
         BO    @RT00496                                         01S0496 00794000
*         ;                         /* ERROR ALLREADY--DONT CONTINUE */ 00795000
*       ELSE                        /* NO ERROR FOUND SO FAR         */ 00796000
*         DO;                                                   01S0498 00797000
*                                                               01S0498 00798000
*           /*********************************************************/ 00799000
*           /*                                                       */ 00800000
*           /* ATTACH TIMER SUBTASK                                  */ 00801000
*           /*                                                       */ 00802000
*           /*********************************************************/ 00803000
*                                                               01S0499 00804000
*           AP1TCBAD=TCBPTR;        /* OUR TCB FOR SUBTASK           */ 00805000
         L     @09,FLCCVT                                       01S0499 00806000
         L     @09,CVTTCBP(,@09)                                01S0499 00807000
         L     @09,TCBPTR(,@09)                                 01S0499 00808000
         ST    @09,AP1TCBAD(,AP1REG)                            01S0499 00809000
*           DO;                     /* ATTACH EP(IAPTIMER) DPMOD(-1)    00810000
*                                      PARAM(AP1BLOCK) TCB(AP1TIMEA) */ 00811000
*             I042=I042&&I042;      /* ZERO THE LIST                 */ 00812000
         XC    I042(60),I042                                    01S0501 00813000
*             I04202=ADDR(IAPTIMER);/* EP/DE ADDRESS                 */ 00814000
         LA    @09,IAPTIMER                                     01S0502 00815000
         STCM  @09,7,I04202                                     01S0502 00816000
*             I04216=' ';           /* DE OR ENTRY POINT ADDRESS        00817000
*                                      GIVEN                         */ 00818000
         MVI   I04216+1,C' '                                    01S0503 00819000
         MVC   I04216+2(6),I04216+1                             01S0503 00820000
         MVI   I04216,C' '                                      01S0503 00821000
*             I04205=I04205|'00001000'B;/* STATUS BYTE               */ 00822000
         LA    @09,8                                            01S0504 00823000
         SLR   @06,@06                                          01S0504 00824000
         IC    @06,I04205                                       01S0504 00825000
         OR    @09,@06                                          01S0504 00826000
         STC   @09,I04205                                       01S0504 00827000
*             I04213=-1;            /* ADJUST DISPATCHING PRIORITY   */ 00828000
         MVC   I04213(2),@CH03240                               01S0505 00829000
*             IOPTLIST(1)=ADDR(AP1BLOCK);/* PROBLEM PROGRAM PARAMETER   00830000
*                                      ADDRESS                       */ 00831000
         ST    AP1REG,IOPTLIST                                  01S0506 00832000
*             IOPTLIST(1)=IOPTLIST(1)|'80000000'X;/* INDICATE END OF    00833000
*                                      LIST                          */ 00834000
         L     @09,IOPTLIST                                     01S0507 00835000
         O     @09,@CF03272                                     01S0507 00836000
         ST    @09,IOPTLIST                                     01S0507 00837000
*             I04226=LENGTH(I042);  /* LENGTH OF LIST                */ 00838000
         MVC   I04226(2),@CH00135                               01S0508 00839000
*             RFY                                               01S0509 00840000
*              (GPR01P,                                         01S0509 00841000
*               GPR15P) RSTD;                                   01S0509 00842000
*             GPR01P=ADDR(IOPTLIST);/* PROBLEM PROGRAM LIST ADDRESS  */ 00843000
         LA    GPR01P,IOPTLIST                                  01S0510 00844000
*             GPR15P=ADDR(I042);    /* ATTACH LIST ADDRESS           */ 00845000
         LA    GPR15P,I042                                      01S0511 00846000
*             SVC(42);              /* ATTACH SVC                    */ 00847000
         SVC   42                                               01S0512 00848000
*             AP1TIMEA=GPR01P;      /* SAVE NEW TCB ADDRESS          */ 00849000
         ST    GPR01P,AP1TIMEA(,AP1REG)                         01S0513 00850000
*             RFY                                               01S0514 00851000
*              (GPR01P,                                         01S0514 00852000
*               GPR15P) UNRSTD;                                 01S0514 00853000
*           END;                    /* ATTACH EP(IAPTIMER) DPMOD(-1)    00854000
*                                      PARAM(AP1BLOCK) TCB(AP1TIMEA) */ 00855000
*         END;                                                  01S0516 00856000
*     END;                                                      01S0517 00857000
@RT00496 DS    0H                                               01S0518 00858000
*   IF AP1QUIT=OFF THEN             /* OK - SO FAR                   */ 00859000
@RT00380 TM    AP1QUIT(AP1REG),B'00001000'                      01S0518 00860000
         BNZ   @RF00518                                         01S0518 00861000
*     DO;                                                       01S0519 00862000
*       AP1CNCOD=MBTS;              /* SETUP FOR STARTED MESSAGE     */ 00863000
         MVI   AP1CNCOD(AP1REG),X'02'                           01S0520 00864000
*       CALL COMM;                  /* SEND MSG TO CONSOLE           */ 00865000
         BAL   @14,COMM                                         01S0521 00866000
*     END;                                                      01S0522 00867000
*   ELSE                                                        01S0523 00868000
*     ;                             /* ERROR ENCOUNTERED             */ 00869000
*                                                               01S0523 00870000
@RF00518 DS    0H                                               01S0524 00871000
*   /*****************************************************************/ 00872000
*   /*                                                               */ 00873000
*   /* HARDWARE TEST ROUTINE. IT CALLS IAPBLDIO WHICH, BASED ON      */ 00874000
*   /* AP1TSTNO, BUILDS A CCW CHAIN. IF IT DETECTS A TIMEOUT, IT SETS*/ 00875000
*   /* AP1ERROR AND AP1QUIT TO STOP FURTHER TESTING. IT CALLS        */ 00876000
*   /* IAPCHKIO TO SEE IF TEST COMPLETED CORRECTLY. IF IAPCHKIO      */ 00877000
*   /* RETURNS WITH AP1PRERR ON, IT PRINTS (CCW,CSW AND SNS). IF THE */ 00878000
*   /* HEAD ERROR TABLES HAVE ENTRIES, IT FORMATS AND PRINTS THEM. IF*/ 00879000
*   /* AP1QUIT OR AP1LST IS TURNED ON BY A HDWE TST, IT RETURNS.     */ 00880000
*   /*                                                               */ 00881000
*   /*****************************************************************/ 00882000
*                                                               01S0524 00883000
*   AP1TSTNO=1;                     /* INITIALIZE TEST NUMBER        */ 00884000
         MVI   AP1TSTNO(AP1REG),X'01'                           01S0524 00885000
*   DO WHILE AP1LST=OFF&AP1QUIT=OFF;/* UNITL LAST HDWE TEST HAS BEEN    00886000
*                                      EXECUTED OR ONE OF THE HDWE      00887000
*                                      TESTS HAS REQUESTED THAT NO      00888000
*                                      MORE BE RUN                   */ 00889000
*                                                               01S0525 00890000
         B     @DE00525                                         01S0525 00891000
@DL00525 DS    0H                                               01S0526 00892000
*     /***************************************************************/ 00893000
*     /*                                                             */ 00894000
*     /* BUILD CCW CHAINS AND SETUP FOR I/O                          */ 00895000
*     /*                                                             */ 00896000
*     /***************************************************************/ 00897000
*                                                               01S0526 00898000
*     CALL IAPBLDIO;                /* BUILD CCWS BASED ON AP1TSTNO  */ 00899000
*                                                               01S0526 00900000
         L     @15,@CV03168                                     01S0526 00901000
         BALR  @14,@15                                          01S0526 00902000
*     /***************************************************************/ 00903000
*     /*                                                             */ 00904000
*     /* DO THE I/O                                                  */ 00905000
*     /*                                                             */ 00906000
*     /***************************************************************/ 00907000
*                                                               01S0527 00908000
*     CALL IO;                      /* GO DO I/O                     */ 00909000
*                                                               01S0527 00910000
         BAL   @14,IO                                           01S0527 00911000
*     /***************************************************************/ 00912000
*     /*                                                             */ 00913000
*     /* TEST I/O RETURN CODE                                        */ 00914000
*     /*                                                             */ 00915000
*     /***************************************************************/ 00916000
*                                                               01S0528 00917000
*     IF AP1PCODE=TIMC&AP1TSTNOÂ¬=1 THEN/* DEVICE NEVER RESPONDED TO     00918000
*                                      SIO-- NOT FIRST RECAL TEST    */ 00919000
*                                                               01S0528 00920000
         CLI   AP1PCODE(AP1REG),X'48'                           01S0528 00921000
         BNE   @RF00528                                         01S0528 00922000
         CLI   AP1TSTNO(AP1REG),1                               01S0528 00923000
         BE    @RF00528                                         01S0528 00924000
*       /*************************************************************/ 00925000
*       /*                                                           */ 00926000
*       /* I/O ROUTINE TIMED OUT                                     */ 00927000
*       /*                                                           */ 00928000
*       /*************************************************************/ 00929000
*                                                               01S0529 00930000
*       DO;                                                     01S0529 00931000
*         AP1CNCOD=MDDR;            /* SETUP FOR TIMED OUT MESSAGE   */ 00932000
         MVI   AP1CNCOD(AP1REG),X'09'                           01S0530 00933000
*         CALL COMM;                /* SEND MSG TO CONSOLE           */ 00934000
         BAL   @14,COMM                                         01S0531 00935000
*       END;                                                    01S0532 00936000
*     ELSE                                                      01S0533 00937000
*       ;                           /* I/O FINISHED                  */ 00938000
*                                                               01S0533 00939000
@RF00528 DS    0H                                               01S0534 00940000
*     /***************************************************************/ 00941000
*     /*                                                             */ 00942000
*     /* TEST STATUS                                                 */ 00943000
*     /*                                                             */ 00944000
*     /***************************************************************/ 00945000
*                                                               01S0534 00946000
*     CALL IAPCHKIO;                /* CHECK STATUS OF TESTS         */ 00947000
         L     @15,@CV03169                                     01S0534 00948000
         BALR  @14,@15                                          01S0534 00949000
*     IF AP1CNCODÂ¬=0 THEN           /* CHECK HAD A CONSOLE MESSAGE   */ 00950000
         CLI   AP1CNCOD(AP1REG),0                               01S0535 00951000
         BE    @RF00535                                         01S0535 00952000
*       CALL COMM;                  /* SEND MSG TO CONSOLE           */ 00953000
         BAL   @14,COMM                                         01S0536 00954000
*     ELSE                                                      01S0537 00955000
*       ;                           /* CHECK HAD NO CONSOLE MESSAGE  */ 00956000
@RF00535 DS    0H                                               01S0538 00957000
*     IF AP1PRERR=ON THEN           /* ERROR OCCURED--PRINT STATUS   */ 00958000
         TM    AP1PRERR(AP1REG),B'00010000'                     01S0538 00959000
         BNO   @RF00538                                         01S0538 00960000
*       DO;                                                     01S0539 00961000
*         CALL COMM;                /* PRINT TEST ID                 */ 00962000
         BAL   @14,COMM                                         01S0540 00963000
*         CALL PRTCCW;              /* PRINT CCW, CSW, SNS           */ 00964000
         BAL   @14,PRTCCW                                       01S0541 00965000
*         AP1PRERR=OFF;             /* STATUS PRINTED                */ 00966000
         NI    AP1PRERR(AP1REG),B'11101111'                     01S0542 00967000
*       END;                                                    01S0543 00968000
*     ELSE                                                      01S0544 00969000
*       ;                           /* NO ERROR                      */ 00970000
@RF00538 DS    0H                                               01S0545 00971000
*   END;                            /* DO WHILE                      */ 00972000
*                                                               01S0545 00973000
@DE00525 TM    AP1LST(AP1REG),B'01001000'                       01S0545 00974000
         BZ    @DL00525                                         01S0545 00975000
*   /*****************************************************************/ 00976000
*   /*                                                               */ 00977000
*   /* PRINT MOVEABLE HEAD MATRIX                                    */ 00978000
*   /*                                                               */ 00979000
*   /*****************************************************************/ 00980000
*                                                               01S0546 00981000
*   AP1WRKA->BYTE30=AP1WRKA->BYTE30&&AP1WRKA->BYTE30;/* CLEAR WORK      00982000
*                                      AREA FOR COMPARE              */ 00983000
         L     @09,AP1WRKA(,AP1REG)                             01S0546 00984000
         XC    BYTE30(30,@09),BYTE30(@09)                       01S0546 00985000
*   IF AP1ERRTMÂ¬=AP1WRKA->BYTE30 THEN/* SOMETHING IN MOVEABLE HD TBL */ 00986000
         CLC   AP1ERRTM(30,AP1REG),BYTE30(@09)                  01S0547 00987000
         BE    @RF00547                                         01S0547 00988000
*     DO;                                                       01S0548 00989000
*       AP1PRNP=ON;                 /* GO TO NEW PAGE                */ 00990000
         OI    AP1PRNP(AP1REG),B'01000000'                      01S0549 00991000
*       CALL COMM;                  /* GO TO NEW PAGE                */ 00992000
         BAL   @14,COMM                                         01S0550 00993000
*       AP1PRCOD=PMH1;                                          01S0551 00994000
         MVI   AP1PRCOD(AP1REG),X'01'                           01S0551 00995000
*       CALL COMM;                  /* PRINT TABLE NAME              */ 00996000
         BAL   @14,COMM                                         01S0552 00997000
*       AP1PRCOD=PMH2;                                          01S0553 00998000
         MVI   AP1PRCOD(AP1REG),X'02'                           01S0553 00999000
*       CALL COMM;                  /* PRINT COLUMN HEADERS--LINE 1  */ 01000000
         BAL   @14,COMM                                         01S0554 01001000
*       AP1PRCOD=PMH3;                                          01S0555 01002000
         MVI   AP1PRCOD(AP1REG),X'03'                           01S0555 01003000
*       CALL COMM;                  /* PRINT COLUMN HEADERS--LINE 2  */ 01004000
         BAL   @14,COMM                                         01S0556 01005000
*       AP1ETABA=ADDR(AP1ERRTM);    /* POINT TO HD 0 ENTRY           */ 01006000
         LA    @09,AP1ERRTM(,AP1REG)                            01S0557 01007000
         ST    @09,AP1ETABA(,AP1REG)                            01S0557 01008000
*       DO COUNTER=0 TO HI3350HD;   /* 30 HDS                        */ 01009000
         SLR   COUNTER,COUNTER                                  01S0558 01010000
@DL00558 DS    0H                                               01S0559 01011000
*         CVD(COUNTER,WRKAREA(1));  /* CNVT HEAD NO TO DEC           */ 01012000
         L     @06,AP1WRKA(,AP1REG)                             01S0559 01013000
         CVD   COUNTER,@TS00001                                 01S0559 01014000
         MVC   WRKAREA(4,@06),@TS00001+4                        01S0559 01015000
*         UNPK(AP1PRMSG(11:12),WRKAREA(1));/* UNPACK                 */ 01016000
         UNPK  AP1PRMSG+10(2,AP1REG),WRKAREA(4,@06)             01S0560 01017000
*         AP1PRMSG(12)=AP1PRMSG(12)|ZONE;/* SET ZONE                 */ 01018000
         OI    AP1PRMSG+11(AP1REG),X'F0'                        01S0561 01019000
*         IF DCK=ON THEN            /* DATA CHECK                    */ 01020000
         L     @06,AP1ETABA(,AP1REG)                            01S0562 01021000
         TM    DCK(@06),B'10000000'                             01S0562 01022000
         BNO   @RF00562                                         01S0562 01023000
*           AP1PRMSG(23)='1';       /* SET IN TABLE                  */ 01024000
         MVI   AP1PRMSG+22(AP1REG),C'1'                         01S0563 01025000
*         ELSE                                                  01S0564 01026000
*           ;                                                   01S0564 01027000
@RF00562 DS    0H                                               01S0565 01028000
*         IF SKVERCK=ON THEN        /* SEEK VERIFY CHECK             */ 01029000
         L     @06,AP1ETABA(,AP1REG)                            01S0565 01030000
         TM    SKVERCK(@06),B'01000000'                         01S0565 01031000
         BNO   @RF00565                                         01S0565 01032000
*           AP1PRMSG(36)='1';       /* SET IN TABLE                  */ 01033000
         MVI   AP1PRMSG+35(AP1REG),C'1'                         01S0566 01034000
*         ELSE                                                  01S0567 01035000
*           ;                                                   01S0567 01036000
@RF00565 DS    0H                                               01S0568 01037000
*         IF WRTCK=ON THEN          /* WRITE ERROR                   */ 01038000
         L     @06,AP1ETABA(,AP1REG)                            01S0568 01039000
         TM    WRTCK(@06),B'00100000'                           01S0568 01040000
         BNO   @RF00568                                         01S0568 01041000
*           AP1PRMSG(49)='1';       /* SET IN TABLE                  */ 01042000
         MVI   AP1PRMSG+48(AP1REG),C'1'                         01S0569 01043000
*         ELSE                                                  01S0570 01044000
*           ;                                                   01S0570 01045000
@RF00568 DS    0H                                               01S0571 01046000
*         IF DCKCE=ON THEN          /* DATA CHECK ON CE CYL          */ 01047000
         L     @06,AP1ETABA(,AP1REG)                            01S0571 01048000
         TM    DCKCE(@06),B'00010000'                           01S0571 01049000
         BNO   @RF00571                                         01S0571 01050000
*           AP1PRMSG(61)='1';       /* SET IN TABLE                  */ 01051000
         MVI   AP1PRMSG+60(AP1REG),C'1'                         01S0572 01052000
*         ELSE                                                  01S0573 01053000
*           ;                                                   01S0573 01054000
@RF00571 DS    0H                                               01S0574 01055000
*         IF DATACOMP=ON THEN       /* DATA COMPARE ERROR            */ 01056000
         L     @06,AP1ETABA(,AP1REG)                            01S0574 01057000
         TM    DATACOMP(@06),B'00001000'                        01S0574 01058000
         BNO   @RF00574                                         01S0574 01059000
*           AP1PRMSG(73)='1';       /* SET IN TABLE                  */ 01060000
         MVI   AP1PRMSG+72(AP1REG),C'1'                         01S0575 01061000
*         ELSE                                                  01S0576 01062000
*           ;                                                   01S0576 01063000
@RF00574 DS    0H                                               01S0577 01064000
*         CALL COMM;                /* PRINT ENTRY FOR THIS HEAD     */ 01065000
         BAL   @14,COMM                                         01S0577 01066000
*         AP1ETABA=AP1ETABA+1;      /* POINT TO NEXT HEAD ENTRY      */ 01067000
         LA    @06,1                                            01S0578 01068000
         AL    @06,AP1ETABA(,AP1REG)                            01S0578 01069000
         ST    @06,AP1ETABA(,AP1REG)                            01S0578 01070000
*       END;                        /* OF DO COUNTER                 */ 01071000
         AL    COUNTER,@CF00045                                 01S0579 01072000
         C     COUNTER,@CF03126                                 01S0579 01073000
         BNH   @DL00558                                         01S0579 01074000
*     END;                          /* OF DO                         */ 01075000
*   ELSE                                                        01S0581 01076000
*     ;                             /* NO MOVEABLE HEAD ERRORS       */ 01077000
*                                                               01S0581 01078000
@RF00547 DS    0H                                               01S0582 01079000
*   /*****************************************************************/ 01080000
*   /*                                                               */ 01081000
*   /* PRINT FIXED HEAD MATRIX                                       */ 01082000
*   /*                                                               */ 01083000
*   /*****************************************************************/ 01084000
*                                                               01S0582 01085000
*   AP1WRKA->BYTE60=AP1WRKA->BYTE60&&AP1WRKA->BYTE60;/* CLEAR WORK      01086000
*                                      AREA FOR COMPARE              */ 01087000
         L     @09,AP1WRKA(,AP1REG)                             01S0582 01088000
         XC    BYTE60(60,@09),BYTE60(@09)                       01S0582 01089000
*   IF AP1ERRTFÂ¬=AP1WRKA->BYTE60 THEN/* SOMETHING IN FIXED HEAD TABLE*/ 01090000
         CLC   AP1ERRTF(60,AP1REG),BYTE60(@09)                  01S0583 01091000
         BE    @RF00583                                         01S0583 01092000
*     DO;                                                       01S0584 01093000
*       AP1PRNP=ON;                 /* GO TO NEW PAGE                */ 01094000
         OI    AP1PRNP(AP1REG),B'01000000'                      01S0585 01095000
*       CALL COMM;                  /* GO TO NEW PAGE                */ 01096000
         BAL   @14,COMM                                         01S0586 01097000
*       AP1PRCOD=PFH1;                                          01S0587 01098000
         MVI   AP1PRCOD(AP1REG),X'04'                           01S0587 01099000
*       CALL COMM;                  /* PRINT TABLE NAME              */ 01100000
         BAL   @14,COMM                                         01S0588 01101000
*       AP1PRCOD=PFH2;                                          01S0589 01102000
         MVI   AP1PRCOD(AP1REG),X'05'                           01S0589 01103000
*       CALL COMM;                  /* PRINT COLUMN HEADERS--LINE 1  */ 01104000
         BAL   @14,COMM                                         01S0590 01105000
*       AP1PRCOD=PFH3;                                          01S0591 01106000
         MVI   AP1PRCOD(AP1REG),X'06'                           01S0591 01107000
*       CALL COMM;                  /* PRINT COLUMN HEADERS--LINE 2  */ 01108000
         BAL   @14,COMM                                         01S0592 01109000
*       AP1ETABA=ADDR(AP1ERRTF);    /* POINT TO ERROR TABLE          */ 01110000
         LA    @09,AP1ERRTF(,AP1REG)                            01S0593 01111000
         ST    @09,AP1ETABA(,AP1REG)                            01S0593 01112000
*       DO COUNTER=0 TO HI3350HD;   /* 29 PAIRS OF HEADS             */ 01113000
         SLR   COUNTER,COUNTER                                  01S0594 01114000
@DL00594 DS    0H                                               01S0595 01115000
*         CVD(COUNTER,WRKAREA(1));  /* CNVT HEAD NO TO DEC           */ 01116000
         L     @06,AP1WRKA(,AP1REG)                             01S0595 01117000
         CVD   COUNTER,@TS00001                                 01S0595 01118000
         MVC   WRKAREA(4,@06),@TS00001+4                        01S0595 01119000
*         UNPK(AP1PRMSG(11:12),WRKAREA(1));/* UNPACK                 */ 01120000
         UNPK  AP1PRMSG+10(2,AP1REG),WRKAREA(4,@06)             01S0596 01121000
*         AP1PRMSG(12)=AP1PRMSG(12)|ZONE;/* SET ZONE                 */ 01122000
         OI    AP1PRMSG+11(AP1REG),X'F0'                        01S0597 01123000
*         COUNTER2=COUNTER+(HI3350HD+1);/* INCR TO 2ND SET           */ 01124000
         LA    COUNTER2,30                                      01S0598 01125000
         ALR   COUNTER2,COUNTER                                 01S0598 01126000
*         CVD(COUNTER2,WRKAREA(1)); /* CNVT HEAD NO TO DEC           */ 01127000
         CVD   COUNTER2,@TS00001                                01S0599 01128000
         MVC   WRKAREA(4,@06),@TS00001+4                        01S0599 01129000
*         UNPK(AP1PRMSG(50:51),WRKAREA(1));/* UNPACK                 */ 01130000
         UNPK  AP1PRMSG+49(2,AP1REG),WRKAREA(4,@06)             01S0600 01131000
*         AP1PRMSG(51)=AP1PRMSG(51)|ZONE;/* SET ZONE                 */ 01132000
         OI    AP1PRMSG+50(AP1REG),X'F0'                        01S0601 01133000
*         IF DCK=ON THEN            /* DATA CHECK ON LOW HEAD        */ 01134000
         L     @06,AP1ETABA(,AP1REG)                            01S0602 01135000
         TM    DCK(@06),B'10000000'                             01S0602 01136000
         BNO   @RF00602                                         01S0602 01137000
*           AP1PRMSG(25)='1';       /* PUT IN TABLE                  */ 01138000
         MVI   AP1PRMSG+24(AP1REG),C'1'                         01S0603 01139000
*         ELSE                                                  01S0604 01140000
*           ;                                                   01S0604 01141000
@RF00602 DS    0H                                               01S0605 01142000
*         IF SKVERCK=ON THEN        /* SEEK VER CHK ON LOW HEAD      */ 01143000
         L     @06,AP1ETABA(,AP1REG)                            01S0605 01144000
         TM    SKVERCK(@06),B'01000000'                         01S0605 01145000
         BNO   @RF00605                                         01S0605 01146000
*           AP1PRMSG(38)='1';       /* PUT IN TABLE                  */ 01147000
         MVI   AP1PRMSG+37(AP1REG),C'1'                         01S0606 01148000
*         ELSE                                                  01S0607 01149000
*           ;                                                   01S0607 01150000
@RF00605 DS    0H                                               01S0608 01151000
*         IF(AP1ETABA+30)->DCK=ON THEN/* DATA CHK ON HI HEAD         */ 01152000
         L     @06,AP1ETABA(,AP1REG)                            01S0608 01153000
         TM    DCK+30(@06),B'10000000'                          01S0608 01154000
         BNO   @RF00608                                         01S0608 01155000
*           AP1PRMSG(64)='1';       /* PUT IN TABLE                  */ 01156000
         MVI   AP1PRMSG+63(AP1REG),C'1'                         01S0609 01157000
*         ELSE                                                  01S0610 01158000
*           ;                                                   01S0610 01159000
@RF00608 DS    0H                                               01S0611 01160000
*         IF(AP1ETABA+30)->SKVERCK=ON THEN/* SEEK VER CHK ON HI HEAD */ 01161000
         L     @06,AP1ETABA(,AP1REG)                            01S0611 01162000
         TM    SKVERCK+30(@06),B'01000000'                      01S0611 01163000
         BNO   @RF00611                                         01S0611 01164000
*           AP1PRMSG(77)='1';       /* PUT IN TABLE                  */ 01165000
         MVI   AP1PRMSG+76(AP1REG),C'1'                         01S0612 01166000
*         ELSE                                                  01S0613 01167000
*           ;                                                   01S0613 01168000
@RF00611 DS    0H                                               01S0614 01169000
*         CALL COMM;                /* PRINT ENTRY FOR THESE HEADS   */ 01170000
         BAL   @14,COMM                                         01S0614 01171000
*         AP1ETABA=AP1ETABA+1;      /* POINT TO NEXT HEAD ENTRIES    */ 01172000
         LA    @06,1                                            01S0615 01173000
         AL    @06,AP1ETABA(,AP1REG)                            01S0615 01174000
         ST    @06,AP1ETABA(,AP1REG)                            01S0615 01175000
*       END;                        /* OF DO COUNTER                 */ 01176000
         AL    COUNTER,@CF00045                                 01S0616 01177000
         C     COUNTER,@CF03126                                 01S0616 01178000
         BNH   @DL00594                                         01S0616 01179000
*     END;                          /* OF DO                         */ 01180000
*   ELSE                                                        01S0618 01181000
*     ;                             /* FIXED HEAD TABLE EMPTY        */ 01182000
*                                                               01S0618 01183000
@RF00583 DS    0H                                               01S0619 01184000
*   /*****************************************************************/ 01185000
*   /*                                                               */ 01186000
*   /* WTO A MESSAGE INDICATING THE RESULTS OF THE HARDWARE TESTS    */ 01187000
*   /*                                                               */ 01188000
*   /*****************************************************************/ 01189000
*                                                               01S0619 01190000
*   IF AP1ERROR=ON THEN             /* ERROR DETECTED BY HDWE TEST   */ 01191000
         TM    AP1ERROR(AP1REG),B'00100000'                     01S0619 01192000
         BNO   @RF00619                                         01S0619 01193000
*     DO;                                                       01S0620 01194000
*       AP1RET=AP1ERRET;            /* SET RETURN CODE TO ERROR FOUND*/ 01195000
         MVI   AP1RET(AP1REG),X'08'                             01S0621 01196000
*       AP1CNCOD=MSDP;              /* SETUP FOR 'DRIVE PROB' MSG    */ 01197000
         MVI   AP1CNCOD(AP1REG),X'03'                           01S0622 01198000
*       CALL COMM;                  /* SEND MSG TO CONSOLE           */ 01199000
         BAL   @14,COMM                                         01S0623 01200000
*     END;                                                      01S0624 01201000
*   ELSE                            /* NO ERRORS--GO TO READ PORTION */ 01202000
*     IF AP1QUIT=OFF THEN           /* TEST FINISHED WITH NO ERRORS  */ 01203000
         B     @RC00619                                         01S0625 01204000
@RF00619 TM    AP1QUIT(AP1REG),B'00001000'                      01S0625 01205000
         BNZ   @RF00625                                         01S0625 01206000
*       DO;                                                     01S0626 01207000
*         AP1CNCOD=MNDP;            /* SETUP FOR NO HDWE PROBLEM MSG */ 01208000
         MVI   AP1CNCOD(AP1REG),X'0A'                           01S0627 01209000
*         CALL COMM;                /* SEND MSG TO CONSOLE           */ 01210000
         BAL   @14,COMM                                         01S0628 01211000
*       END;                                                    01S0629 01212000
*     ELSE                          /* UNABLE TO TEST--MSG ALREADY      01213000
*                                      ISSUED                        */ 01214000
*       AP1RET=AP1QRET;             /* SET RETURN CODE UNABLE TO TEST*/ 01215000
*                                                               01S0630 01216000
         B     @RC00625                                         01S0630 01217000
@RF00625 MVI   AP1RET(AP1REG),X'0C'                             01S0630 01218000
*   /*****************************************************************/ 01219000
*   /*                                                               */ 01220000
*   /* READ TESTING -DO IF NO DRIVE PROBLEMS AND IF OPERATOR REQUESTS*/ 01221000
*   /* IT EITHER BY PARM OR REPLY TO WTOR                            */ 01222000
*   /*                                                               */ 01223000
*   /*****************************************************************/ 01224000
*                                                               01S0631 01225000
*   IF AP1QUIT=OFF&AP1NORD=OFF&AP1ERROR=OFF THEN/* NO HDWE BUGS AND     01226000
*                                      PARMÂ¬=NOREAD                  */ 01227000
@RC00625 DS    0H                                               01S0631 01228000
@RC00619 TM    AP1QUIT(AP1REG),B'00001000'                      01S0631 01229000
         BNZ   @RF00631                                         01S0631 01230000
         TM    AP1NORD(AP1REG),B'10000000'                      01S0631 01231000
         BNZ   @RF00631                                         01S0631 01232000
         TM    AP1ERROR(AP1REG),B'00100000'                     01S0631 01233000
         BNZ   @RF00631                                         01S0631 01234000
*     IF AP1READ=ON THEN            /* PARM=READ                     */ 01235000
         TM    AP1READ(AP1REG),B'01000000'                      01S0632 01236000
         BNO   @RF00632                                         01S0632 01237000
*       AP1VERIF=ON;                /* DO VERIFY TEST                */ 01238000
         OI    AP1VERIF(AP1REG),B'00000100'                     01S0633 01239000
*     ELSE                          /* PARM=CONS OR NOT SPECIFIED    */ 01240000
*       DO;                                                     01S0634 01241000
         B     @RC00632                                         01S0634 01242000
@RF00632 DS    0H                                               01S0635 01243000
*         DO WHILE AP1CNRPLÂ¬='YES '&AP1CNRPLÂ¬='NO  ';           01S0635 01244000
         B     @DE00635                                         01S0635 01245000
@DL00635 DS    0H                                               01S0636 01246000
*           AP1CNCOD=MDVQ;          /* SETUP FOR 'DATA VERIF' MSG    */ 01247000
         MVI   AP1CNCOD(AP1REG),X'01'                           01S0636 01248000
*           AP1CNRPL='    ';        /* CLEAR REPLY AREA              */ 01249000
         MVC   AP1CNRPL(4,AP1REG),@CC03243                      01S0637 01250000
*           CALL COMM;              /* SEND MSG TO CONSOLE AND WAIT     01251000
*                                      FOR REPLY                     */ 01252000
         BAL   @14,COMM                                         01S0638 01253000
*         END;                      /* OF DO WHILE                   */ 01254000
@DE00635 CLC   AP1CNRPL(4,AP1REG),@CC03285                      01S0639 01255000
         BE    @DC00635                                         01S0639 01256000
         CLC   AP1CNRPL(4,AP1REG),@CC03286                      01S0639 01257000
         BNE   @DL00635                                         01S0639 01258000
@DC00635 DS    0H                                               01S0640 01259000
*         IF AP1CNRPL='YES ' THEN   /* OPERATOR WANTS DATA VERIF     */ 01260000
         CLC   AP1CNRPL(4,AP1REG),@CC03285                      01S0640 01261000
         BNE   @RF00640                                         01S0640 01262000
*           AP1VERIF=ON;            /* DO VERIFY TESTS               */ 01263000
         OI    AP1VERIF(AP1REG),B'00000100'                     01S0641 01264000
*         ELSE                                                  01S0642 01265000
*           ;                       /* OPERATOR DOESNT WANT VERIFY   */ 01266000
@RF00640 DS    0H                                               01S0643 01267000
*       END;                                                    01S0643 01268000
*   ELSE                                                        01S0644 01269000
*     ;                             /* HARDWARE ERROR OR PARM=NODATA */ 01270000
@RF00631 DS    0H                                               01S0645 01271000
*   IF AP1VERIF=ON THEN             /* DO READ VERIFY TESTS          */ 01272000
@RC00631 TM    AP1VERIF(AP1REG),B'00000100'                     01S0645 01273000
         BNO   @RF00645                                         01S0645 01274000
*     DO;                                                       01S0646 01275000
*       AP1CNCOD=MDVS;              /* SET UP VERIFY STARTED         */ 01276000
         MVI   AP1CNCOD(AP1REG),X'0F'                           01S0647 01277000
*       CALL COMM;                  /* SEND MSG TO CONSOLE           */ 01278000
*                                                               01S0648 01279000
         BAL   @14,COMM                                         01S0648 01280000
*       /*************************************************************/ 01281000
*       /*                                                           */ 01282000
*       /* DATA VERIFICATION ROUTINE. THIS ROUTINE BUILDS THE CCW    */ 01283000
*       /* CHAINS TO VERIFY THE DATA. IF AN ERROR IS DETECTED, IT    */ 01284000
*       /* SETS AP1ERROR AND PRINTS ERROR INFORMATION.               */ 01285000
*       /*                                                           */ 01286000
*       /*************************************************************/ 01287000
*                                                               01S0649 01288000
*                                                               01S0649 01289000
*       /*************************************************************/ 01290000
*       /*                                                           */ 01291000
*       /* INITIALIZE FOR FIRST READ PASS                            */ 01292000
*       /*                                                           */ 01293000
*       /*************************************************************/ 01294000
*                                                               01S0649 01295000
*       AP1RDTST=ON;                /* USE ERP'S                     */ 01296000
*       AP1LST=OFF;                 /* RESET INDICATOR               */ 01297000
         OI    AP1RDTST(AP1REG),B'00000010'                     01S0650 01298000
         NI    AP1LST(AP1REG),B'10111111'                       01S0650 01299000
*       AP1FM=READFM;               /* SET FILEMODE TO READ ONLY     */ 01300000
         MVC   AP1FM(1,AP1REG),READFM                           01S0651 01301000
*       AP1SEEK=AP1SEEK&&AP1SEEK;   /* SET SEEK TO CYL 0, HD 0       */ 01302000
*                                                               01S0652 01303000
         XC    AP1SEEK(8,AP1REG),AP1SEEK(AP1REG)                01S0652 01304000
*       /*************************************************************/ 01305000
*       /*                                                           */ 01306000
*       /* GET INTO DEB KEY TO SET DEBENDCC TO ZERO                  */ 01307000
*       /*                                                           */ 01308000
*       /*************************************************************/ 01309000
*                                                               01S0653 01310000
*       DO;                         /* MODESET EXTKEY(DATAMGT)       */ 01311000
*         SPKA(80);                 /* SET PSW KEY                   */ 01312000
         LA    @09,80                                           01S0654 01313000
         SPKA  0(@09)                                           01S0654 01314000
*       END;                        /* MODESET EXTKEY(DATAMGT) DATA     01315000
*                                      MGT KEY                       */ 01316000
*       DEBENDCC=0;                 /* READ FIRST CYLINDER           */ 01317000
         L     @09,AP1DEBA(,AP1REG)                             01S0656 01318000
         SLR   @06,@06                                          01S0656 01319000
         STH   @06,DEBENDCC+32(,@09)                            01S0656 01320000
*       RFY                                                     01S0657 01321000
*         GPR04F RSTD;                                          01S0657 01322000
*       DO;                         /* MODESET EXTKEY(TCB)      01S0658 01323000
*                                      WORKREG(GPR04F)               */ 01324000
*         GPR04F=TCBPKF;            /* GET KEY FROM TCB              */ 01325000
         L     @09,FLCCVT                                       01S0659 01326000
         L     @09,CVTTCBP(,@09)                                01S0659 01327000
         L     @09,TCBPTR(,@09)                                 01S0659 01328000
         SLR   GPR04F,GPR04F                                    01S0659 01329000
         IC    GPR04F,TCBPKF(,@09)                              01S0659 01330000
*         SPKA(GPR04F);             /* SET PSW KEY                   */ 01331000
         SPKA  0(GPR04F)                                        01S0660 01332000
*       END;                        /* MODESET EXTKEY(TCB)      01S0661 01333000
*                                      WORKREG(GPR04F) USER KEY      */ 01334000
*       RFY                                                     01S0662 01335000
*         GPR04F UNRSTD;                                        01S0662 01336000
*                                                               01S0662 01337000
*       /*************************************************************/ 01338000
*       /*                                                           */ 01339000
*       /* INITIALIZE DATA CHECK COUNTER TO NUMBER OF ALTERNATES +1  */ 01340000
*       /*                                                           */ 01341000
*       /*************************************************************/ 01342000
*                                                               01S0663 01343000
*       IF AP1DEVTP=AP13350 THEN    /* 3350                          */ 01344000
         CLI   AP1DEVTP(AP1REG),4                               01S0663 01345000
         BNE   @RF00663                                         01S0663 01346000
*         AP1DCCNT=151;             /* SET COUNTER TO ALTERNATES + 1 */ 01347000
         MVI   AP1DCCNT(AP1REG),X'97'                           01S0664 01348000
*       ELSE                        /* NOT 3350                      */ 01349000
*         IF AP1DEVTP=AP13344 THEN  /* 3340                          */ 01350000
         B     @RC00663                                         01S0665 01351000
@RF00663 CLI   AP1DEVTP(AP1REG),3                               01S0665 01352000
         BNE   @RF00665                                         01S0665 01353000
*           AP1DCCNT=25;            /* SET COUNTER TO ALTERNATES + 1 */ 01354000
         MVI   AP1DCCNT(AP1REG),X'19'                           01S0666 01355000
*         ELSE                      /* 3330 OR 3330-11               */ 01356000
*           AP1DCCNT=134;           /* SET COUNTER TO ALTERNATES + 1 */ 01357000
*                                                               01S0667 01358000
         B     @RC00665                                         01S0667 01359000
@RF00665 MVI   AP1DCCNT(AP1REG),X'86'                           01S0667 01360000
*       /*************************************************************/ 01361000
*       /*                                                           */ 01362000
*       /* BUILD FIRST CCW CHAIN                                     */ 01363000
*       /*                                                           */ 01364000
*       /*************************************************************/ 01365000
*                                                               01S0668 01366000
*       CALL READBLD1;              /* BUILD CCW CHAIN 1             */ 01367000
*                                                               01S0668 01368000
@RC00665 DS    0H                                               01S0668 01369000
@RC00663 BAL   @14,READBLD1                                     01S0668 01370000
*       /*************************************************************/ 01371000
*       /*                                                           */ 01372000
*       /* BEGIN READ PASS                                           */ 01373000
*       /*                                                           */ 01374000
*       /*************************************************************/ 01375000
*                                                               01S0669 01376000
*       DO WHILE AP1QUIT=OFF&AP1LST=OFF;/* BEGIN FIRST READ PASS     */ 01377000
*                                                               01S0669 01378000
         B     @DE00669                                         01S0669 01379000
@DL00669 DS    0H                                               01S0670 01380000
*         /***********************************************************/ 01381000
*         /*                                                         */ 01382000
*         /* DO THE I/O                                              */ 01383000
*         /*                                                         */ 01384000
*         /***********************************************************/ 01385000
*                                                               01S0670 01386000
*         CALL IO;                  /* GO DO I/O                     */ 01387000
*                                                               01S0670 01388000
         BAL   @14,IO                                           01S0670 01389000
*         /***********************************************************/ 01390000
*         /*                                                         */ 01391000
*         /* TEST I/O RETURN CODE                                    */ 01392000
*         /*                                                         */ 01393000
*         /***********************************************************/ 01394000
*                                                               01S0671 01395000
*         IF AP1PCODE=TIMC THEN     /* NO RESPONSE WITHIN TIME LIMIT */ 01396000
*                                                               01S0671 01397000
         CLI   AP1PCODE(AP1REG),X'48'                           01S0671 01398000
         BNE   @RF00671                                         01S0671 01399000
*           /*********************************************************/ 01400000
*           /*                                                       */ 01401000
*           /* TIMED OUT                                             */ 01402000
*           /*                                                       */ 01403000
*           /*********************************************************/ 01404000
*                                                               01S0672 01405000
*           DO;                                                 01S0672 01406000
*             AP1CNCOD=MDDR;        /* SET UP TIMED-OUT MSG          */ 01407000
         MVI   AP1CNCOD(AP1REG),X'09'                           01S0673 01408000
*             CALL COMM;            /* ISSUE MSG TO CONSOLE          */ 01409000
         BAL   @14,COMM                                         01S0674 01410000
*             CALL BADATA;          /* DATA FMT UNACCEPTABLE MSG     */ 01411000
         BAL   @14,BADATA                                       01S0675 01412000
*           END;                    /* END DO                        */ 01413000
*         ELSE                      /* RESPONDED WITHIN TIME LIMIT   */ 01414000
*           DO;                                                 01S0677 01415000
*                                                               01S0677 01416000
         B     @RC00671                                         01S0677 01417000
@RF00671 DS    0H                                               01S0678 01418000
*             /*******************************************************/ 01419000
*             /*                                                     */ 01420000
*             /* I/O COMPLETED--CHECK STATUS                         */ 01421000
*             /*                                                     */ 01422000
*             /*******************************************************/ 01423000
*                                                               01S0678 01424000
*             IF AP1PCODE=EXTC THEN /* END OF EXTENT                 */ 01425000
*                                                               01S0678 01426000
         CLI   AP1PCODE(AP1REG),X'42'                           01S0678 01427000
         BNE   @RF00678                                         01S0678 01428000
*               /*****************************************************/ 01429000
*               /*                                                   */ 01430000
*               /* END OF EXTENT                                     */ 01431000
*               /*                                                   */ 01432000
*               /*****************************************************/ 01433000
*                                                               01S0679 01434000
*               DO;                                             01S0679 01435000
*                 CALL READBLD1;    /* BUILD CCW CHAIN ONE           */ 01436000
         BAL   @14,READBLD1                                     01S0680 01437000
*                 CALL UPDTCC;      /* INCREMENT CC AND CONTINUE     */ 01438000
         BAL   @14,UPDTCC                                       01S0681 01439000
*               END;                                            01S0682 01440000
*             ELSE                  /* NOT EOE                       */ 01441000
*               IF AP1PCODE=ERRC&(CSWUNEXP=ON|CSWUNCHK=ON|CSWERR1Â¬=     01442000
*                   '0000'B|CSWSTAT2Â¬='00000000'B) THEN/* ERROR 01S0683 01443000
*                                      STATUS                        */ 01444000
         B     @RC00678                                         01S0683 01445000
@RF00678 CLI   AP1PCODE(AP1REG),X'41'                           01S0683 01446000
         BNE   @RF00683                                         01S0683 01447000
         LA    @09,AP1CSW(,AP1REG)                              01S0683 01448000
         BCTR  @09,0                                            01S0683 01449000
         TM    CSWUNEXP(@09),B'00000011'                        01S0683 01450000
         BNZ   @RT00683                                         01S0683 01451000
         TM    CSWERR1(@09),B'11110000'                         01S0683 01452000
         BNZ   @RT00683                                         01S0683 01453000
         CLI   CSWSTAT2(@09),B'00000000'                        01S0683 01454000
         BE    @RF00683                                         01S0683 01455000
@RT00683 DS    0H                                               01S0684 01456000
*                 IF CSWUNEXP=ON THEN/* EOD RECORD                   */ 01457000
         LA    @09,AP1CSW(,AP1REG)                              01S0684 01458000
         TM    CSWUNEXP-1(@09),B'00000001'                      01S0684 01459000
         BNO   @RF00684                                         01S0684 01460000
*                   IF AP1BUFAD->CNTHHR>HHR&AP1BUFAD->CNTHH<=AP1LSTHH   01461000
*                     THEN          /* EOD RECORD COUNT OK           */ 01462000
*                                                               01S0685 01463000
         L     @09,AP1BUFAD(,AP1REG)                            01S0685 01464000
         CLC   CNTHHR(3,@09),HHR(AP1REG)                        01S0685 01465000
         BNH   @RF00685                                         01S0685 01466000
         SLR   @06,@06                                          01S0685 01467000
         ICM   @06,3,CNTHH(@09)                                 01S0685 01468000
         CH    @06,AP1LSTHH(,AP1REG)                            01S0685 01469000
         BH    @RF00685                                         01S0685 01470000
*                     /***********************************************/ 01471000
*                     /*                                             */ 01472000
*                     /* EOD--OK                                     */ 01473000
*                     /*                                             */ 01474000
*                     /***********************************************/ 01475000
*                                                               01S0686 01476000
*                     DO;                                       01S0686 01477000
*                       HHR=AP1BUFAD->CNTHHR;/* SET SEEK TO LAST        01478000
*                                      COUNT                         */ 01479000
*                                                               01S0687 01480000
         MVC   HHR(3,AP1REG),CNTHHR(@09)                        01S0687 01481000
*                       /*********************************************/ 01482000
*                       /*                                           */ 01483000
*                       /* READBLD2 ROUTINE BUILDS CCW CHAIN TO READ */ 01484000
*                       /* RECORDS EXCEPT RECORD ZERO FROM EOD RECORD*/ 01485000
*                       /* TO END OF CYLINDER.                       */ 01486000
*                       /*                                           */ 01487000
*                       /*********************************************/ 01488000
*                                                               01S0688 01489000
*/*  CCW CHAIN:                                                 01S0688 01490000
*        SID,BUFF,CC,5               SEARCH FOR EOD RECORD     @ZM01503 01491000
*        TIC,*-8                                                01S0688 01492000
*        MT-RDCNT,BUFF,CC,8          READ COUNT, MULTI-TRACK    01S0688 01493000
*        RD-KD,0,CC-SKIP-SLI,65535   CHECK KEY - DATA           01S0688 01494000
*        TIC,*-16                    LOOP - READ TO END OF CYL       */ 01495000
*                                                               01S0688 01496000
*                       CCWPTR=1;   /* FIRST SLOT                    */ 01497000
         LA    @09,1                                            01S0688 01498000
         LR    CCWPTR,@09                                       01S0688 01499000
*                       CCW(CCWPTR)=SIDCCCCW;/* SID,0,CC,5           */ 01500000
         LR    @06,CCWPTR                                       01S0689 01501000
         SLA   @06,3                                            01S0689 01502000
         L     @03,AP1CCWA(,AP1REG)                             01S0689 01503000
         ALR   @06,@03                                          01S0689 01504000
         AL    @06,@CF03871                                     01S0689 01505000
         MVC   CCW(8,@06),SIDCCCCW                              01S0689 01506000
*                       CCWADDRB(CCWPTR)=AP1BUFAB;/* SEARCH ON  01S0690 01507000
*                                      ADDRESS READ          @ZM01503*/ 01508000
         LR    @06,CCWPTR                                       01S0690 01509000
         SLA   @06,3                                            01S0690 01510000
         ALR   @06,@03                                          01S0690 01511000
         AL    @06,@CF03872                                     01S0690 01512000
         MVC   CCWADDRB-1(3,@06),AP1BUFAB(AP1REG)               01S0690 01513000
*                       CCWPTR=CCWPTR+1;/* NEXT SLOT                 */ 01514000
         ALR   CCWPTR,@09                                       01S0691 01515000
*                       CCW(CCWPTR)=TICCCW;/* TIC,0,0,0              */ 01516000
         LR    @06,CCWPTR                                       01S0692 01517000
         SLA   @06,3                                            01S0692 01518000
         ALR   @06,@03                                          01S0692 01519000
         AL    @06,@CF03871                                     01S0692 01520000
         MVC   CCW(8,@06),TICCCW                                01S0692 01521000
*                       CCWADDRB(CCWPTR)=AP1CCWA+(CCWPTR-2)*LENGTH(CCW) 01522000
*                           ;       /* TIC TO SID                    */ 01523000
         LR    @06,CCWPTR                                       01S0693 01524000
         SLA   @06,3                                            01S0693 01525000
         LR    @15,CCWPTR                                       01S0693 01526000
         BCTR  @15,0                                            01S0693 01527000
         BCTR  @15,0                                            01S0693 01528000
         SLA   @15,3                                            01S0693 01529000
         ALR   @15,@03                                          01S0693 01530000
         ALR   @06,@03                                          01S0693 01531000
         AL    @06,@CF03872                                     01S0693 01532000
         STCM  @15,7,CCWADDRB-1(@06)                            01S0693 01533000
*                       CCWPTR=CCWPTR+1;/* NEXT SLOT                 */ 01534000
         ALR   CCWPTR,@09                                       01S0694 01535000
*                       CCW(CCWPTR)=MRCCCCCW;/* MT-RDCNT,0,CC,8      */ 01536000
         LR    @06,CCWPTR                                       01S0695 01537000
         SLA   @06,3                                            01S0695 01538000
         ALR   @06,@03                                          01S0695 01539000
         AL    @06,@CF03871                                     01S0695 01540000
         MVC   CCW(8,@06),MRCCCCCW                              01S0695 01541000
*                       CCWADDRB(CCWPTR)=AP1BUFAB;/* READ INTO BUFFER*/ 01542000
         LR    @06,CCWPTR                                       01S0696 01543000
         SLA   @06,3                                            01S0696 01544000
         ALR   @06,@03                                          01S0696 01545000
         AL    @06,@CF03872                                     01S0696 01546000
         MVC   CCWADDRB-1(3,@06),AP1BUFAB(AP1REG)               01S0696 01547000
*                       CCWPTR=CCWPTR+1;/* NEXT SLOT                 */ 01548000
         ALR   CCWPTR,@09                                       01S0697 01549000
*                       CCW(CCWPTR)=RKDSSCCW;/*                 01S0698 01550000
*                                      RKD,0,CC-SKIP-SLI,65535       */ 01551000
         LR    @06,CCWPTR                                       01S0698 01552000
         SLA   @06,3                                            01S0698 01553000
         ALR   @06,@03                                          01S0698 01554000
         AL    @06,@CF03871                                     01S0698 01555000
         MVC   CCW(8,@06),RKDSSCCW                              01S0698 01556000
*                       CCWPTR=CCWPTR+1;/* NEXT SLOT                 */ 01557000
         ALR   CCWPTR,@09                                       01S0699 01558000
*                       CCW(CCWPTR)=TICCCW;/* TIC,0,0,0              */ 01559000
         LR    @09,CCWPTR                                       01S0700 01560000
         SLA   @09,3                                            01S0700 01561000
         ALR   @09,@03                                          01S0700 01562000
         AL    @09,@CF03871                                     01S0700 01563000
         MVC   CCW(8,@09),TICCCW                                01S0700 01564000
*                       CCWADDRB(CCWPTR)=AP1CCWA+(CCWPTR-3)*LENGTH(CCW) 01565000
*                           ;       /* TIC TO RD CNT CCW CHAIN 2     */ 01566000
         LR    @09,CCWPTR                                       01S0701 01567000
         SLA   @09,3                                            01S0701 01568000
         LR    @06,CCWPTR                                       01S0701 01569000
         SL    @06,@CF00139                                     01S0701 01570000
         SLA   @06,3                                            01S0701 01571000
         ALR   @06,@03                                          01S0701 01572000
         ALR   @03,@09                                          01S0701 01573000
         AL    @03,@CF03872                                     01S0701 01574000
         STCM  @06,7,CCWADDRB-1(@03)                            01S0701 01575000
*                     END;                                      01S0702 01576000
*                   ELSE            /* EOD RECORD COUNT BAD          */ 01577000
*                                                               01S0703 01578000
*                     /***********************************************/ 01579000
*                     /*                                             */ 01580000
*                     /* EOD--POSSIBLE LOOP OR INVALID SEEK          */ 01581000
*                     /*                                             */ 01582000
*                     /***********************************************/ 01583000
*                                                               01S0703 01584000
*                     CALL BADATA;  /* HANDLE BAD EOD RECORD         */ 01585000
         B     @RC00685                                         01S0703 01586000
@RF00685 BAL   @14,BADATA                                       01S0703 01587000
*                 ELSE              /* NOT EOD RECORD                */ 01588000
*                   IF SNSNRF=ON&CCWCOMCD(1)=SID&CSWADDRB=AP1CCWA+      01589000
*                       LENGTH(CCW) THEN/* COULDNT FIND EXPECTED EOD */ 01590000
         B     @RC00684                                         01S0704 01591000
@RF00684 TM    SNSNRF+188(AP1REG),B'00001000'                   01S0704 01592000
         BNO   @RF00704                                         01S0704 01593000
         L     @09,AP1CCWA(,AP1REG)                             01S0704 01594000
         CLI   CCWCOMCD(@09),49                                 01S0704 01595000
         BNE   @RF00704                                         01S0704 01596000
         LA    @06,AP1CSW(,AP1REG)                              01S0704 01597000
         AL    @09,@CF00049                                     01S0704 01598000
         BCTR  @06,0                                            01S0704 01599000
         L     @06,CSWADDRB-1(,@06)                             01S0704 01600000
         LA    @06,0(,@06)                                      01S0704 01601000
         CR    @09,@06                                          01S0704 01602000
         BNE   @RF00704                                         01S0704 01603000
*                     DO;                                       01S0705 01604000
*                       CALL BADATA;/* HANDLE BAD EOD RECORD         */ 01605000
         BAL   @14,BADATA                                       01S0706 01606000
*                       CALL PRTCCW;/* PRINT CSW, CCW, SNS           */ 01607000
         BAL   @14,PRTCCW                                       01S0707 01608000
*                     END;                                      01S0708 01609000
*                   ELSE            /* CHECK FOR OTHER ERRORS        */ 01610000
*                     DO;                                       01S0709 01611000
         B     @RC00704                                         01S0709 01612000
@RF00704 DS    0H                                               01S0710 01613000
*                       IF SNSNRF=ON THEN/* NRF ON ERP CCW--TRYING TO   01614000
*                                      FIND NEXT PART OF OVERFLOW       01615000
*                                      RECORD                        */ 01616000
         TM    SNSNRF+188(AP1REG),B'00001000'                   01S0710 01617000
         BNO   @RF00710                                         01S0710 01618000
*                         CALL SNSCCHH;/* GET CCHH FROM SNS TO RETRY    01619000
*                                      TRK                           */ 01620000
         BAL   @14,SNSCCHH                                      01S0711 01621000
*                       ELSE        /* ERROR ON TRACK                */ 01622000
*                         CALL BADTRK;/* HANDLES UNREADABLE TRACK    */ 01623000
         B     @RC00710                                         01S0712 01624000
@RF00710 BAL   @14,BADTRK                                       01S0712 01625000
*                       CALL READBLD1;/* BUILD CCW CHAIN 1           */ 01626000
@RC00710 BAL   @14,READBLD1                                     01S0713 01627000
*                     END;                                      01S0714 01628000
*               ELSE                /* ERROR POST CODE WITH NO ERROR */ 01629000
*                 DO;                                           01S0715 01630000
         B     @RC00683                                         01S0715 01631000
@RF00683 DS    0H                                               01S0716 01632000
*                   CALL BADATA;    /* DATA FMT UNACCEPTABLE MSG     */ 01633000
         BAL   @14,BADATA                                       01S0716 01634000
*                   CALL PRTCCW;    /* PRT CCW, CSW, SNS             */ 01635000
         BAL   @14,PRTCCW                                       01S0717 01636000
*                 END;              /* END DO                        */ 01637000
*           END;                    /* END DO                        */ 01638000
@RC00683 DS    0H                                               01S0719 01639000
@RC00678 DS    0H                                               01S0720 01640000
*       END;                        /* END DO WHILE                  */ 01641000
*                                                               01S0720 01642000
@RC00671 DS    0H                                               01S0720 01643000
@DE00669 TM    AP1QUIT(AP1REG),B'01001000'                      01S0720 01644000
         BZ    @DL00669                                         01S0720 01645000
*       /*************************************************************/ 01646000
*       /*                                                           */ 01647000
*       /* INITIALIZE FOR SECOND READ PASS                           */ 01648000
*       /*                                                           */ 01649000
*       /*************************************************************/ 01650000
*                                                               01S0721 01651000
*       AP1LST=OFF;                 /* RESET INDICATOR               */ 01652000
         NI    AP1LST(AP1REG),B'10111111'                       01S0721 01653000
*       AP1SEEK=AP1SEEK&&AP1SEEK;   /* SET SEEK TO CYL 0, HD 0       */ 01654000
*                                                               01S0722 01655000
         XC    AP1SEEK(8,AP1REG),AP1SEEK(AP1REG)                01S0722 01656000
*       /*************************************************************/ 01657000
*       /*                                                           */ 01658000
*       /* GET INTO DEB KEY                                          */ 01659000
*       /*                                                           */ 01660000
*       /*************************************************************/ 01661000
*                                                               01S0723 01662000
*       DO;                         /* MODESET EXTKEY(DATAMGT)       */ 01663000
*         SPKA(80);                 /* SET PSW KEY                   */ 01664000
         LA    @09,80                                           01S0724 01665000
         SPKA  0(@09)                                           01S0724 01666000
*       END;                        /* MODESET EXTKEY(DATAMGT) DATA     01667000
*                                      MGT KEY                       */ 01668000
*       DEBENDCC=0;                 /* READ FIRST CYLINDER           */ 01669000
         L     @09,AP1DEBA(,AP1REG)                             01S0726 01670000
         SLR   @06,@06                                          01S0726 01671000
         STH   @06,DEBENDCC+32(,@09)                            01S0726 01672000
*       RFY                                                     01S0727 01673000
*         GPR04F RSTD;                                          01S0727 01674000
*       DO;                         /* MODESET EXTKEY(TCB)      01S0728 01675000
*                                      WORKREG(GPR04F)               */ 01676000
*         GPR04F=TCBPKF;            /* GET KEY FROM TCB              */ 01677000
         L     @09,FLCCVT                                       01S0729 01678000
         L     @09,CVTTCBP(,@09)                                01S0729 01679000
         L     @09,TCBPTR(,@09)                                 01S0729 01680000
         SLR   GPR04F,GPR04F                                    01S0729 01681000
         IC    GPR04F,TCBPKF(,@09)                              01S0729 01682000
*         SPKA(GPR04F);             /* SET PSW KEY                   */ 01683000
         SPKA  0(GPR04F)                                        01S0730 01684000
*       END;                        /* MODESET EXTKEY(TCB)      01S0731 01685000
*                                      WORKREG(GPR04F) USER KEY      */ 01686000
*       RFY                                                     01S0732 01687000
*         GPR04F UNRSTD;                                        01S0732 01688000
*                                                               01S0732 01689000
*       /*************************************************************/ 01690000
*       /*                                                           */ 01691000
*       /* INITIALIZE DATA CHECK COUNTER                             */ 01692000
*       /*                                                           */ 01693000
*       /*************************************************************/ 01694000
*                                                               01S0733 01695000
*       IF AP1DEVTP=AP13350 THEN    /* 3350                          */ 01696000
         CLI   AP1DEVTP(AP1REG),4                               01S0733 01697000
         BNE   @RF00733                                         01S0733 01698000
*         AP1DCCNT=151;             /* SET COUNTER TO ALTERNATES + 1 */ 01699000
         MVI   AP1DCCNT(AP1REG),X'97'                           01S0734 01700000
*       ELSE                        /* NOT 3350                      */ 01701000
*         IF AP1DEVTP=AP13344 THEN  /* 3340                          */ 01702000
         B     @RC00733                                         01S0735 01703000
@RF00733 CLI   AP1DEVTP(AP1REG),3                               01S0735 01704000
         BNE   @RF00735                                         01S0735 01705000
*           AP1DCCNT=25;            /* SET COUNTER TO ALTERNATES + 1 */ 01706000
         MVI   AP1DCCNT(AP1REG),X'19'                           01S0736 01707000
*         ELSE                      /* 3330 OR 3330-11               */ 01708000
*           AP1DCCNT=134;           /* SET COUNTER TO ALTERNATES + 1 */ 01709000
*                                                               01S0737 01710000
         B     @RC00735                                         01S0737 01711000
@RF00735 MVI   AP1DCCNT(AP1REG),X'86'                           01S0737 01712000
*       /*************************************************************/ 01713000
*       /*                                                           */ 01714000
*       /* BUILD CCW CHAIN FOR SECOND READ PASS. READBLD3 ROUTINE    */ 01715000
*       /* BUILDS CCW CHAIN TO READ RECORD ZEROS TO END OF CYLINDER  */ 01716000
*       /*                                                           */ 01717000
*       /*************************************************************/ 01718000
*                                                               01S0738 01719000
*/*  CCW CHAIN:                                                 01S0738 01720000
*        RD-R0,BUFF,CD,8             READ COUNT                 01S0738 01721000
*        RD-R0,0,CC-SKIP-SLI,65535   CHECK KEY - DATA           01S0738 01722000
*        SET-SECTOR,BUFF+8,CC,1      HIGH DATA SECTOR           01S0738 01723000
*        MT-R0,BUFF,CD,8             READ COUNT FOR EOD         01S0738 01724000
*        RD-R0,0,CC-SKIP-SLI,65535   CHECK KEY - DATA           01S0738 01725000
*        TIC,*-24                    LOOP - READ TO END OF CYL       */ 01726000
*                                                               01S0738 01727000
*       CCWPTR=1;                   /* FIRST SLOT                    */ 01728000
@RC00735 DS    0H                                               01S0738 01729000
@RC00733 LA    @09,1                                            01S0738 01730000
         LR    CCWPTR,@09                                       01S0738 01731000
*       CCW(CCWPTR)=RR0CDCCW;       /* RR0,0,CD,8                    */ 01732000
         LR    @06,CCWPTR                                       01S0739 01733000
         SLA   @06,3                                            01S0739 01734000
         L     @03,AP1CCWA(,AP1REG)                             01S0739 01735000
         ALR   @06,@03                                          01S0739 01736000
         AL    @06,@CF03871                                     01S0739 01737000
         MVC   CCW(8,@06),RR0CDCCW                              01S0739 01738000
*       CCWADDRB(CCWPTR)=AP1BUFAD;  /* INTO BUFFER                   */ 01739000
         LR    @06,CCWPTR                                       01S0740 01740000
         SLA   @06,3                                            01S0740 01741000
         L     @15,AP1BUFAD(,AP1REG)                            01S0740 01742000
         ALR   @06,@03                                          01S0740 01743000
         AL    @06,@CF03872                                     01S0740 01744000
         STCM  @15,7,CCWADDRB-1(@06)                            01S0740 01745000
*       CCWPTR=CCWPTR+1;            /* NEXT SLOT                     */ 01746000
         ALR   CCWPTR,@09                                       01S0741 01747000
*       CCW(CCWPTR)=RR0SSCCW;       /* RR0,0,CC-SKIP-SLI,65535       */ 01748000
         LR    @06,CCWPTR                                       01S0742 01749000
         SLA   @06,3                                            01S0742 01750000
         ALR   @06,@03                                          01S0742 01751000
         AL    @06,@CF03871                                     01S0742 01752000
         MVC   CCW(8,@06),RR0SSCCW                              01S0742 01753000
*       CCWPTR=CCWPTR+1;            /* NEXT SLOT                     */ 01754000
         ALR   CCWPTR,@09                                       01S0743 01755000
*       CCW(CCWPTR)=SSCCCCW;        /* SET SECTOR,0,CC,1             */ 01756000
         LR    @09,CCWPTR                                       01S0744 01757000
         SLA   @09,3                                            01S0744 01758000
         ALR   @09,@03                                          01S0744 01759000
         AL    @09,@CF03871                                     01S0744 01760000
         MVC   CCW(8,@09),SSCCCCW                               01S0744 01761000
*       CCWADDRB(CCWPTR)=AP1BUFAB+LENGTH(CNT);/* SECTOR IN BUFFER    */ 01762000
         LR    @09,CCWPTR                                       01S0745 01763000
         SLA   @09,3                                            01S0745 01764000
         LA    @06,8                                            01S0745 01765000
         L     @14,AP1BUFAB-1(,AP1REG)                          01S0745 01766000
         LA    @14,0(,@14)                                      01S0745 01767000
         ALR   @14,@06                                          01S0745 01768000
         ALR   @03,@09                                          01S0745 01769000
         AL    @03,@CF03872                                     01S0745 01770000
         STCM  @14,7,CCWADDRB-1(@03)                            01S0745 01771000
*       IF AP1DEVTP=AP13344 THEN    /* 3344                          */ 01772000
         CLI   AP1DEVTP(AP1REG),3                               01S0746 01773000
         BNE   @RF00746                                         01S0746 01774000
*         EVAL(AP1BUFAD+LENGTH(CNT))->BYTE1=63;/* SECTOR 63          */ 01775000
         ALR   @15,@06                                          01S0747 01776000
         MVI   BYTE1(@15),X'3F'                                 01S0747 01777000
*       ELSE                        /* NOT 3344                      */ 01778000
*         EVAL(AP1BUFAD+LENGTH(CNT))->BYTE1=127;/* SECTOR 127        */ 01779000
         B     @RC00746                                         01S0748 01780000
@RF00746 LA    @09,8                                            01S0748 01781000
         AL    @09,AP1BUFAD(,AP1REG)                            01S0748 01782000
         MVI   BYTE1(@09),X'7F'                                 01S0748 01783000
*       CCWPTR=CCWPTR+1;            /* NEXT SLOT                     */ 01784000
@RC00746 LA    @09,1                                            01S0749 01785000
         ALR   CCWPTR,@09                                       01S0749 01786000
*       CCW(CCWPTR)=MR0CDCCW;       /* MTRR0,0,CD,8                  */ 01787000
         LR    @06,CCWPTR                                       01S0750 01788000
         SLA   @06,3                                            01S0750 01789000
         L     @03,AP1CCWA(,AP1REG)                             01S0750 01790000
         ALR   @06,@03                                          01S0750 01791000
         AL    @06,@CF03871                                     01S0750 01792000
         MVC   CCW(8,@06),MR0CDCCW                              01S0750 01793000
*       CCWADDRB(CCWPTR)=AP1BUFAD;  /* INTO BUFFER                   */ 01794000
         LR    @06,CCWPTR                                       01S0751 01795000
         SLA   @06,3                                            01S0751 01796000
         L     @15,AP1BUFAD(,AP1REG)                            01S0751 01797000
         ALR   @06,@03                                          01S0751 01798000
         AL    @06,@CF03872                                     01S0751 01799000
         STCM  @15,7,CCWADDRB-1(@06)                            01S0751 01800000
*       CCWPTR=CCWPTR+1;            /* NEXT SLOT                     */ 01801000
         ALR   CCWPTR,@09                                       01S0752 01802000
*       CCW(CCWPTR)=RR0SSCCW;       /* RR0,0,CC-SKIP-SLI,65535       */ 01803000
         LR    @06,CCWPTR                                       01S0753 01804000
         SLA   @06,3                                            01S0753 01805000
         ALR   @06,@03                                          01S0753 01806000
         AL    @06,@CF03871                                     01S0753 01807000
         MVC   CCW(8,@06),RR0SSCCW                              01S0753 01808000
*       CCWPTR=CCWPTR+1;            /* NEXT SLOT                     */ 01809000
         ALR   CCWPTR,@09                                       01S0754 01810000
*       CCW(CCWPTR)=TICCCW;         /* TIC,0,0,0                     */ 01811000
         LR    @09,CCWPTR                                       01S0755 01812000
         SLA   @09,3                                            01S0755 01813000
         ALR   @09,@03                                          01S0755 01814000
         AL    @09,@CF03871                                     01S0755 01815000
         MVC   CCW(8,@09),TICCCW                                01S0755 01816000
*       CCWADDRB(CCWPTR)=AP1CCWA+(CCWPTR-4)*LENGTH(CCW);/* TIC TO SET   01817000
*                                      SECTOR                        */ 01818000
*                                                               01S0756 01819000
         LR    @09,CCWPTR                                       01S0756 01820000
         SLA   @09,3                                            01S0756 01821000
         LR    @06,CCWPTR                                       01S0756 01822000
         SL    @06,@CF00040                                     01S0756 01823000
         SLA   @06,3                                            01S0756 01824000
         ALR   @06,@03                                          01S0756 01825000
         ALR   @03,@09                                          01S0756 01826000
         AL    @03,@CF03872                                     01S0756 01827000
         STCM  @06,7,CCWADDRB-1(@03)                            01S0756 01828000
*       /*************************************************************/ 01829000
*       /*                                                           */ 01830000
*       /* BEGIN READ PASS                                           */ 01831000
*       /*                                                           */ 01832000
*       /*************************************************************/ 01833000
*                                                               01S0757 01834000
*       DO WHILE AP1QUIT=OFF&AP1LST=OFF;/* BEGIN SECOND READ PASS    */ 01835000
         B     @DE00757                                         01S0757 01836000
@DL00757 DS    0H                                               01S0758 01837000
*         CALL IO;                  /* GO DO I/O                     */ 01838000
*                                                               01S0758 01839000
         BAL   @14,IO                                           01S0758 01840000
*         /***********************************************************/ 01841000
*         /*                                                         */ 01842000
*         /* TEST I/O RETURN CODE                                    */ 01843000
*         /*                                                         */ 01844000
*         /***********************************************************/ 01845000
*                                                               01S0759 01846000
*         IF AP1PCODE=TIMC THEN     /* NO RESPONSE WITHIN TIME LIMIT */ 01847000
*                                                               01S0759 01848000
         CLI   AP1PCODE(AP1REG),X'48'                           01S0759 01849000
         BNE   @RF00759                                         01S0759 01850000
*           /*********************************************************/ 01851000
*           /*                                                       */ 01852000
*           /* TIMED OUT                                             */ 01853000
*           /*                                                       */ 01854000
*           /*********************************************************/ 01855000
*                                                               01S0760 01856000
*           DO;                                                 01S0760 01857000
*             AP1CNCOD=MDDR;        /* SET UP TIMED-OUT MSG          */ 01858000
         MVI   AP1CNCOD(AP1REG),X'09'                           01S0761 01859000
*             CALL COMM;            /* ISSUE MSG TO CONSOLE          */ 01860000
         BAL   @14,COMM                                         01S0762 01861000
*             CALL BADATA;          /* DATA FMT UNACCEPTABLE MSG     */ 01862000
         BAL   @14,BADATA                                       01S0763 01863000
*           END;                    /* END DO                        */ 01864000
*         ELSE                      /* RESPONDED WITHIN TIME LIMIT   */ 01865000
*           DO;                                                 01S0765 01866000
*                                                               01S0765 01867000
         B     @RC00759                                         01S0765 01868000
@RF00759 DS    0H                                               01S0766 01869000
*             /*******************************************************/ 01870000
*             /*                                                     */ 01871000
*             /* I/O COMPLETED--CHECK STATUS                         */ 01872000
*             /*                                                     */ 01873000
*             /*******************************************************/ 01874000
*                                                               01S0766 01875000
*             IF AP1PCODE=EXTC THEN /* END OF EXTENT                 */ 01876000
*                                                               01S0766 01877000
         CLI   AP1PCODE(AP1REG),X'42'                           01S0766 01878000
         BNE   @RF00766                                         01S0766 01879000
*               /*****************************************************/ 01880000
*               /*                                                   */ 01881000
*               /* END OF EXTENT                                     */ 01882000
*               /*                                                   */ 01883000
*               /*****************************************************/ 01884000
*                                                               01S0767 01885000
*               CALL UPDTCC;        /* INCREMENT CC AND CONTINUE     */ 01886000
         BAL   @14,UPDTCC                                       01S0767 01887000
*             ELSE                  /* NOT EOE                       */ 01888000
*               IF AP1PCODE=ERRC&(CSWUNEXP=ON|CSWUNCHK=ON|CSWERR1Â¬=     01889000
*                   '0000'B|CSWSTAT2Â¬='00000000'B) THEN/* ERROR 01S0768 01890000
*                                      STATUS                        */ 01891000
         B     @RC00766                                         01S0768 01892000
@RF00766 CLI   AP1PCODE(AP1REG),X'41'                           01S0768 01893000
         BNE   @RF00768                                         01S0768 01894000
         LA    @09,AP1CSW(,AP1REG)                              01S0768 01895000
         BCTR  @09,0                                            01S0768 01896000
         TM    CSWUNEXP(@09),B'00000011'                        01S0768 01897000
         BNZ   @RT00768                                         01S0768 01898000
         TM    CSWERR1(@09),B'11110000'                         01S0768 01899000
         BNZ   @RT00768                                         01S0768 01900000
         CLI   CSWSTAT2(@09),B'00000000'                        01S0768 01901000
         BE    @RF00768                                         01S0768 01902000
@RT00768 DS    0H                                               01S0769 01903000
*                 IF CSWUNEXP=ON THEN/* EOD RECORD                   */ 01904000
*                                                               01S0769 01905000
         LA    @09,AP1CSW(,AP1REG)                              01S0769 01906000
         TM    CSWUNEXP-1(@09),B'00000001'                      01S0769 01907000
         BNO   @RF00769                                         01S0769 01908000
*                   /*************************************************/ 01909000
*                   /*                                               */ 01910000
*                   /* END OF DATA--OK                               */ 01911000
*                   /*                                               */ 01912000
*                   /*************************************************/ 01913000
*                                                               01S0770 01914000
*                   IF AP1BUFAD->CNTHH>HH&AP1BUFAD->CNTHH<=AP1LSTHH     01915000
*                     THEN          /* EOD RECORD COUNT OK           */ 01916000
         L     @09,AP1BUFAD(,AP1REG)                            01S0770 01917000
         CLC   CNTHH(2,@09),HH(AP1REG)                          01S0770 01918000
         BNH   @RF00770                                         01S0770 01919000
         SLR   @06,@06                                          01S0770 01920000
         ICM   @06,3,CNTHH(@09)                                 01S0770 01921000
         CH    @06,AP1LSTHH(,AP1REG)                            01S0770 01922000
         BH    @RF00770                                         01S0770 01923000
*                     DO;                                       01S0771 01924000
*                       HHR=AP1BUFAD->CNTHHR;/* SET SEEK TO LAST        01925000
*                                      COUNT                         */ 01926000
*                                                               01S0772 01927000
         MVC   HHR(3,AP1REG),CNTHHR(@09)                        01S0772 01928000
*                       /*********************************************/ 01929000
*                       /*                                           */ 01930000
*                       /* UPDATE SEEK TO NEXT TRACK                 */ 01931000
*                       /*                                           */ 01932000
*                       /*********************************************/ 01933000
*                                                               01S0773 01934000
*                       CALL UPDTHH;/* TO NXT TRK                    */ 01935000
         BAL   @14,UPDTHH                                       01S0773 01936000
*                     END;                                      01S0774 01937000
*                   ELSE            /* EOD RECORD COUNT BAD          */ 01938000
*                                                               01S0775 01939000
*                     /***********************************************/ 01940000
*                     /*                                             */ 01941000
*                     /* EOD--POSSIBLE LOOP                          */ 01942000
*                     /*                                             */ 01943000
*                     /***********************************************/ 01944000
*                                                               01S0775 01945000
*                     CALL BADATA;  /* HANDLE BAD EOD RECORD         */ 01946000
         B     @RC00770                                         01S0775 01947000
@RF00770 BAL   @14,BADATA                                       01S0775 01948000
*                 ELSE              /* NOT EOD RECORD                */ 01949000
*                   CALL BADTRK;    /* HANDLES UNREADABLE TRACK      */ 01950000
         B     @RC00769                                         01S0776 01951000
@RF00769 BAL   @14,BADTRK                                       01S0776 01952000
*               ELSE                /* ERROR POST CODE WITH NO ERROR */ 01953000
*                 DO;                                           01S0777 01954000
         B     @RC00768                                         01S0777 01955000
@RF00768 DS    0H                                               01S0778 01956000
*                   CALL BADATA;    /* DATA FMT UNACCEPTABLE MSG     */ 01957000
         BAL   @14,BADATA                                       01S0778 01958000
*                   CALL PRTCCW;    /* PRT CCW, CSW, SNS             */ 01959000
         BAL   @14,PRTCCW                                       01S0779 01960000
*                 END;              /* END DO                        */ 01961000
*           END;                    /* END DO                        */ 01962000
@RC00768 DS    0H                                               01S0781 01963000
@RC00766 DS    0H                                               01S0782 01964000
*       END;                        /* END DO WHILE                  */ 01965000
*                                                               01S0782 01966000
@RC00759 DS    0H                                               01S0782 01967000
@DE00757 TM    AP1QUIT(AP1REG),B'01001000'                      01S0782 01968000
         BZ    @DL00757                                         01S0782 01969000
*       /*************************************************************/ 01970000
*       /*                                                           */ 01971000
*       /* WTO A MESSAGE INDICATING THE RESULTS OF THE DATA          */ 01972000
*       /* VERIFICATION TEST                                         */ 01973000
*       /*                                                           */ 01974000
*       /*************************************************************/ 01975000
*                                                               01S0783 01976000
*       IF AP1ERROR=ON|AP1RDERR=ON THEN/* A BAD RECORD FOUND         */ 01977000
         TM    AP1ERROR(AP1REG),B'00100001'                     01S0783 01978000
         BZ    @RF00783                                         01S0783 01979000
*         DO;                                                   01S0784 01980000
*           AP1RET=AP1ERRET;        /* SET RETURN CODE--ERROR FOUND  */ 01981000
         MVI   AP1RET(AP1REG),X'08'                             01S0785 01982000
*           IF AP1ERROR=ON THEN     /* DRIVE ERROR                   */ 01983000
         TM    AP1ERROR(AP1REG),B'00100000'                     01S0786 01984000
         BNO   @RF00786                                         01S0786 01985000
*             AP1CNCOD=MSDP;        /* SET UP DRIVE PROB MSG         */ 01986000
         MVI   AP1CNCOD(AP1REG),X'03'                           01S0787 01987000
*           ELSE                    /* ONLY READ ERROR               */ 01988000
*             AP1CNCOD=MCRD;        /* SET UNABLE TO READ MSG        */ 01989000
         B     @RC00786                                         01S0788 01990000
@RF00786 MVI   AP1CNCOD(AP1REG),X'05'                           01S0788 01991000
*           CALL COMM;              /* SEND MSG TO CONSOLE           */ 01992000
@RC00786 BAL   @14,COMM                                         01S0789 01993000
*         END;                                                  01S0790 01994000
*       ELSE                        /* NO ERRORS                     */ 01995000
*         IF AP1QUIT=OFF THEN       /* TEST FINISHED WITH NO ERRORS  */ 01996000
         B     @RC00783                                         01S0791 01997000
@RF00783 TM    AP1QUIT(AP1REG),B'00001000'                      01S0791 01998000
         BNZ   @RF00791                                         01S0791 01999000
*           DO;                                                 01S0792 02000000
*             AP1CNCOD=MADR;        /* SETUP FOR 'NO DATA PROBS' MSG */ 02001000
         MVI   AP1CNCOD(AP1REG),X'06'                           01S0793 02002000
*             CALL COMM;            /* SEND MSG TO CONSOLE           */ 02003000
         BAL   @14,COMM                                         01S0794 02004000
*           END;                                                01S0795 02005000
*         ELSE                      /* UNABLE TO TEST--MSG ALREADY      02006000
*                                      ISSUED                        */ 02007000
*           AP1RET=AP1QRET;         /* SET RETURN CODE--UNABLE TO       02008000
*                                      TEST                          */ 02009000
         B     @RC00791                                         01S0796 02010000
@RF00791 MVI   AP1RET(AP1REG),X'0C'                             01S0796 02011000
*     END;                                                      01S0797 02012000
*   ELSE                                                        01S0798 02013000
*     ;                             /* SKIP READ VERIFY TEST         */ 02014000
*                                                               01S0798 02015000
@RF00645 DS    0H                                               01S0799 02016000
*   /*****************************************************************/ 02017000
*   /*                                                               */ 02018000
*   /* TESTING FINISHED -- CLEANUP                                   */ 02019000
*   /*                                                               */ 02020000
*   /*****************************************************************/ 02021000
*                                                               01S0799 02022000
*   AP1CNCOD=MPC;                   /* SETUP FOR COMPLETED MSG       */ 02023000
@RC00645 MVI   AP1CNCOD(AP1REG),X'07'                           01S0799 02024000
*   CALL COMM;                      /* SEND MSG TO CONSOLE           */ 02025000
         BAL   @14,COMM                                         01S0800 02026000
*   AP1PRCLS=ON;                    /* SETUP FOR CLOSE PRINTER       */ 02027000
         OI    AP1PRCLS(AP1REG),B'00100000'                     01S0801 02028000
*   CALL COMM;                      /* CLOSE IT                      */ 02029000
*                                                               01S0802 02030000
         BAL   @14,COMM                                         01S0802 02031000
*   /*****************************************************************/ 02032000
*   /*                                                               */ 02033000
*   /* TERMINATION ROUTINE                                           */ 02034000
*   /*                                                               */ 02035000
*   /*****************************************************************/ 02036000
*                                                               01S0803 02037000
*                                                               01S0803 02038000
*   /*****************************************************************/ 02039000
*   /*                                                               */ 02040000
*   /* DETACHES TIMER, FREES SPACE GOTTEN BY INIT ROUTINE, DELETES   */ 02041000
*   /* DEB AND DEQS                                                  */ 02042000
*   /*                                                               */ 02043000
*   /*****************************************************************/ 02044000
*                                                               01S0803 02045000
*                                                               01S0803 02046000
*   /*****************************************************************/ 02047000
*   /*                                                               */ 02048000
*   /* DETACH TIMER SUBTASK                                          */ 02049000
*   /*                                                               */ 02050000
*   /*****************************************************************/ 02051000
*                                                               01S0803 02052000
*   IF AP1TIMEAÂ¬=0 THEN             /* SUBTASK EXISTS                */ 02053000
         L     @09,AP1TIMEA(,AP1REG)                            01S0803 02054000
         LTR   @09,@09                                          01S0803 02055000
         BZ    @RF00803                                         01S0803 02056000
*     DO;                           /* DETACH (AP1TIMEA)             */ 02057000
*       RESPECIFY                                               01S0805 02058000
*        (GPR01P) RESTRICTED;                                   01S0805 02059000
*       GPR01P=ADDR(AP1TIMEA);      /* TCB ADDRESS                   */ 02060000
         LA    GPR01P,AP1TIMEA(,AP1REG)                         01S0806 02061000
*       SVC(62);                    /* DETACH SVC                    */ 02062000
         SVC   62                                               01S0807 02063000
*       RESPECIFY                                               01S0808 02064000
*        (GPR01P) UNRESTRICTED;                                 01S0808 02065000
*     END;                          /* DETACH (AP1TIMEA) ADDRESS OF     02066000
*                                      SUB TCB                       */ 02067000
*   ELSE                                                        01S0810 02068000
*     ;                             /* NO SUBTASK TO DETACH          */ 02069000
*                                                               01S0810 02070000
@RF00803 DS    0H                                               01S0811 02071000
*   /*****************************************************************/ 02072000
*   /*                                                               */ 02073000
*   /* ISSUE DEBCHK DELETE                                           */ 02074000
*   /*                                                               */ 02075000
*   /*****************************************************************/ 02076000
*                                                               01S0811 02077000
*   IF AP1DEBCH=ON THEN             /* DEBCHK ADD DONE               */ 02078000
         TM    AP1DEBCH(AP1REG),B'00100000'                     01S0811 02079000
         BNO   @RF00811                                         01S0811 02080000
*     DO;                                                       01S0812 02081000
*       RFY                                                     01S0813 02082000
*        (GPR15F,                                               01S0813 02083000
*         GPR00F,                                               01S0813 02084000
*         GPR01P) RSTD;                                         01S0813 02085000
*       GPR01P=AP1DCBA;             /* DCB ADDRESS                   */ 02086000
         L     GPR01P,AP1DCBA(,AP1REG)                          01S0814 02087000
*       GENERATE;                                               01S0815 02088000
         DEBCHK (GPR01P),TYPE=DELETE,AM=EXCP DELETE DEB                 02089000
*       RFY                                                     01S0816 02090000
*        (GPR15F,                                               01S0816 02091000
*         GPR00F,                                               01S0816 02092000
*         GPR01P) UNRSTD;                                       01S0816 02093000
*     END;                                                      01S0817 02094000
*   ELSE                                                        01S0818 02095000
*     ;                             /* DEBCHK ADD NOT DONE--DONT DEL */ 02096000
*                                                               01S0818 02097000
@RF00811 DS    0H                                               01S0819 02098000
*   /*****************************************************************/ 02099000
*   /*                                                               */ 02100000
*   /* DECHAIN DEB                                                   */ 02101000
*   /*                                                               */ 02102000
*   /*****************************************************************/ 02103000
*                                                               01S0819 02104000
*   DO;                             /* MODESET KEY(ZERO)             */ 02105000
*     I10701='00000000'B;           /* OR MASK                       */ 02106000
         MVI   I10701,B'00000000'                               01S0820 02107000
*     I10702='00000000'B;           /* AND MASK                      */ 02108000
         MVI   I10702,B'00000000'                               01S0821 02109000
*     I10703='00000000'B;           /* RESERVED                      */ 02110000
         MVI   I10703,B'00000000'                               01S0822 02111000
*     I10704='00110000'B;                                       01S0823 02112000
         MVI   I10704,B'00110000'                               01S0823 02113000
*     RESPECIFY                                                 01S0824 02114000
*       GPR01F RESTRICTED;                                      01S0824 02115000
*     GPR01F=I107;                  /* MODESET PARMLIST              */ 02116000
         L     GPR01F,I107                                      01S0825 02117000
*     SVC(107);                     /* ISSUE MODESET SVC             */ 02118000
         SVC   107                                              01S0826 02119000
*     RESPECIFY                                                 01S0827 02120000
*      (GPR01F) UNRESTRICTED;                                   01S0827 02121000
*   END;                            /* MODESET KEY(ZERO) SUPERVISOR     02122000
*                                      KEY                           */ 02123000
*                                                               01S0828 02124000
*   /*****************************************************************/ 02125000
*   /*                                                               */ 02126000
*   /* OBTAIN LOCAL LOCK                                             */ 02127000
*   /*                                                               */ 02128000
*   /*****************************************************************/ 02129000
*                                                               01S0829 02130000
*   RFY                                                         01S0829 02131000
*    (GPR02F,                                                   01S0829 02132000
*     GPR04F,                                                   01S0829 02133000
*     GPR09F,                                                   01S0829 02134000
*     GPR11F,                                                   01S0829 02135000
*     GPR12F,                                                   01S0829 02136000
*     GPR13F) RSTD;                                             01S0829 02137000
*   GPR02F=GPR11F;                  /* SAVE REG 11                   */ 02138000
         LR    GPR02F,GPR11F                                    01S0830 02139000
*   GPR04F=GPR12F;                  /* SAVE REG 12                   */ 02140000
         LR    GPR04F,GPR12F                                    01S0831 02141000
*   GPR09F=GPR13F;                  /* SAVE REG 13                   */ 02142000
         LR    GPR09F,GPR13F                                    01S0832 02143000
*SET:                                                           01S0833 02144000
*   DO;                             /* SETLOCK (OBTAIN) MODE(UNCOND)    02145000
*                                      TYPE(LOCAL) RELATED(REL)      */ 02146000
SET      DS    0H                                               01S0834 02147000
*     RFY                                                       01S0834 02148000
*      (GPR11P,                                                 01S0834 02149000
*       GPR12P,                                                 01S0834 02150000
*       GPR13P,                                                 01S0834 02151000
*       GPR14P) RSTD;                                           01S0834 02152000
*     GPR13P=PSALITA;               /* ADDRESS OF LOCK INTERFACE        02153000
*                                      TABLE.                        */ 02154000
         L     GPR13P,PSALITA                                   01S0835 02155000
*     GEN(LM GPR11P,GPR13P,576(GPR13P));/* LOAD LOCKWORD, CLHT AND      02156000
*                                      ENTRY ADRS.                   */ 02157000
         LM GPR11P,GPR13P,576(GPR13P)                                   02158000
*     GEN(BALR GPR14P,GPR13P);      /* BALR TO SETLOCK RTN.          */ 02159000
         BALR GPR14P,GPR13P                                             02160000
*     RFY                                                       01S0838 02161000
*      (GPR11P,                                                 01S0838 02162000
*       GPR12P,                                                 01S0838 02163000
*       GPR13P,                                                 01S0838 02164000
*       GPR14P) UNRSTD;                                         01S0838 02165000
*   END;                            /* SETLOCK (OBTAIN) MODE(UNCOND)    02166000
*                                      TYPE(LOCAL) RELATED(REL)      */ 02167000
*   GPR13F=GPR09F;                  /* RESTORE REG 13                */ 02168000
         LR    GPR13F,GPR09F                                    01S0840 02169000
*   GPR12F=GPR04F;                  /* RESTORE REG 12                */ 02170000
         LR    GPR12F,GPR04F                                    01S0841 02171000
*   GPR11F=GPR02F;                  /* RESTORE REG 11                */ 02172000
         LR    GPR11F,GPR02F                                    01S0842 02173000
*   RFY                                                         01S0843 02174000
*    (GPR02F,                                                   01S0843 02175000
*     GPR04F,                                                   01S0843 02176000
*     GPR09F,                                                   01S0843 02177000
*     GPR11F,                                                   01S0843 02178000
*     GPR12F,                                                   01S0843 02179000
*     GPR13F) UNRSTD;                                           01S0843 02180000
*   DEBPTR=ADDR(TCBDEB)+ADDR(DEBBASIC)-ADDR(DEBDEBAD);/* ADDRESS TCB    02181000
*                                      AS IF TCBDEB WERE IN A DEB    */ 02182000
         L     @09,FLCCVT                                       01S0844 02183000
         L     @09,CVTTCBP(,@09)                                01S0844 02184000
         L     DEBPTR,TCBPTR(,@09)                              01S0844 02185000
         LA    DEBPTR,TCBDEB(,DEBPTR)                           01S0844 02186000
         L     @09,AP1DEBA(,AP1REG)                             01S0844 02187000
         ALR   DEBPTR,@09                                       01S0844 02188000
         LA    @09,DEBDEBAD(,@09)                               01S0844 02189000
         SLR   DEBPTR,@09                                       01S0844 02190000
*   DO WHILE DEBPTR->DEBDEBBÂ¬=0&DEBPTR->DEBDEBBÂ¬=AP1DEBA;/* WHILE       02191000
*                                      HAVNT FOUND OUR DEB AND NOT      02192000
*                                      END OF CHAIN                  */ 02193000
         B     @DE00845                                         01S0845 02194000
@DL00845 DS    0H                                               01S0846 02195000
*     DEBPTR=DEBPTR->DEBDEBB;       /* POINT TO NEXT DEB IN CHAIN    */ 02196000
         L     @09,DEBDEBB-1(,DEBPTR)                           01S0846 02197000
         LA    @09,0(,@09)                                      01S0846 02198000
         LR    DEBPTR,@09                                       01S0846 02199000
*   END;                            /* OF DO WHILE                   */ 02200000
@DE00845 L     @09,DEBDEBB-1(,DEBPTR)                           01S0847 02201000
         LA    @09,0(,@09)                                      01S0847 02202000
         LTR   @09,@09                                          01S0847 02203000
         BZ    @DC00845                                         01S0847 02204000
         C     @09,AP1DEBA(,AP1REG)                             01S0847 02205000
         BNE   @DL00845                                         01S0847 02206000
@DC00845 DS    0H                                               01S0848 02207000
*   IF DEBPTR->DEBDEBBÂ¬=0 THEN      /* FOUND OUR DEB                 */ 02208000
         L     @09,DEBDEBB-1(,DEBPTR)                           01S0848 02209000
         LA    @09,0(,@09)                                      01S0848 02210000
         LTR   @09,@09                                          01S0848 02211000
         BZ    @RF00848                                         01S0848 02212000
*     DEBPTR->DEBDEBB=DEBDEBB;      /* DE-CHAIN--MOVE OUR DEB PTR       02213000
*                                      INTO PREVIOUS DEB             */ 02214000
         L     @09,AP1DEBA(,AP1REG)                             01S0849 02215000
         MVC   DEBDEBB(3,DEBPTR),DEBDEBB(@09)                   01S0849 02216000
*   ELSE                                                        01S0850 02217000
*     ;                             /* DIDNT FIND OUR DEB--ASSUME       02218000
*                                      ALREADY DE-CHAINED            */ 02219000
*                                                               01S0850 02220000
@RF00848 DS    0H                                               01S0851 02221000
*   /*****************************************************************/ 02222000
*   /*                                                               */ 02223000
*   /* RELEASE LOCAL LOCK                                            */ 02224000
*   /*                                                               */ 02225000
*   /*****************************************************************/ 02226000
*                                                               01S0851 02227000
*   RFY                                                         01S0851 02228000
*    (GPR02F,                                                   01S0851 02229000
*     GPR04F,                                                   01S0851 02230000
*     GPR09F,                                                   01S0851 02231000
*     GPR11F,                                                   01S0851 02232000
*     GPR12F,                                                   01S0851 02233000
*     GPR13F) RSTD;                                             01S0851 02234000
*   GPR02F=GPR11F;                  /* SAVE REG 11                   */ 02235000
         LR    GPR02F,GPR11F                                    01S0852 02236000
*   GPR04F=GPR12F;                  /* SAVE REG 12                   */ 02237000
         LR    GPR04F,GPR12F                                    01S0853 02238000
*   GPR09F=GPR13F;                  /* SAVE REG 13                   */ 02239000
         LR    GPR09F,GPR13F                                    01S0854 02240000
*REL:                                                           01S0855 02241000
*   DO;                             /* SETLOCK (RELEASE) TYPE(LOCAL)    02242000
*                                      RELATED(SET)                  */ 02243000
REL      DS    0H                                               01S0856 02244000
*     RFY                                                       01S0856 02245000
*      (GPR11P,                                                 01S0856 02246000
*       GPR12P,                                                 01S0856 02247000
*       GPR13P,                                                 01S0856 02248000
*       GPR14P) RSTD;                                           01S0856 02249000
*     GPR13P=PSALITA;               /* ADDRESS OF LOCK INTERFACE        02250000
*                                      TABLE.                        */ 02251000
         L     GPR13P,PSALITA                                   01S0857 02252000
*     GEN(LM GPR11P,GPR13P,588(GPR13P));/* LOAD LOCKWORD, CLHT AND      02253000
*                                      ENTRY ADRS.                   */ 02254000
         LM GPR11P,GPR13P,588(GPR13P)                                   02255000
*     GEN(BALR GPR14P,GPR13P);      /* BALR TO SETLOCK RTN.          */ 02256000
         BALR GPR14P,GPR13P                                             02257000
*     RFY                                                       01S0860 02258000
*      (GPR11P,                                                 01S0860 02259000
*       GPR12P,                                                 01S0860 02260000
*       GPR13P,                                                 01S0860 02261000
*       GPR14P) UNRSTD;                                         01S0860 02262000
*   END;                            /* SETLOCK (RELEASE) TYPE(LOCAL)    02263000
*                                      RELATED(SET)                  */ 02264000
*   GPR13F=GPR09F;                  /* RESTORE REG 13                */ 02265000
         LR    GPR13F,GPR09F                                    01S0862 02266000
*   GPR12F=GPR04F;                  /* RESTORE REG 12                */ 02267000
         LR    GPR12F,GPR04F                                    01S0863 02268000
*   GPR11F=GPR02F;                  /* RESTORE REG 11                */ 02269000
         LR    GPR11F,GPR02F                                    01S0864 02270000
*   RFY                                                         01S0865 02271000
*    (GPR02F,                                                   01S0865 02272000
*     GPR04F,                                                   01S0865 02273000
*     GPR09F,                                                   01S0865 02274000
*     GPR11F,                                                   01S0865 02275000
*     GPR12F,                                                   01S0865 02276000
*     GPR13F) UNRSTD;                                           01S0865 02277000
*   DO;                             /* MODESET KEY(NZERO)            */ 02278000
*     I10701='00000000'B;           /* OR MASK                       */ 02279000
         MVI   I10701,B'00000000'                               01S0867 02280000
*     I10702='00000000'B;           /* AND MASK                      */ 02281000
         MVI   I10702,B'00000000'                               01S0868 02282000
*     I10703='00000000'B;           /* RESERVED                      */ 02283000
         MVI   I10703,B'00000000'                               01S0869 02284000
*     I10704='00100000'B;                                       01S0870 02285000
         MVI   I10704,B'00100000'                               01S0870 02286000
*     RESPECIFY                                                 01S0871 02287000
*       GPR01F RESTRICTED;                                      01S0871 02288000
*     GPR01F=I107;                  /* MODESET PARMLIST              */ 02289000
         L     GPR01F,I107                                      01S0872 02290000
*     SVC(107);                     /* ISSUE MODESET SVC             */ 02291000
         SVC   107                                              01S0873 02292000
*     RESPECIFY                                                 01S0874 02293000
*      (GPR01F) UNRESTRICTED;                                   01S0874 02294000
*   END;                            /* MODESET KEY(NZERO) BACK TO       02295000
*                                      USERS KEY                     */ 02296000
*                                                               01S0875 02297000
*   /*****************************************************************/ 02298000
*   /*                                                               */ 02299000
*   /* DEQ - ENQ DONE IN IAPCHKIO ON BASE ADDR OF SPINDLE            */ 02300000
*   /*                                                               */ 02301000
*   /*****************************************************************/ 02302000
*                                                               01S0876 02303000
*   IF AP1ENQD=ON THEN              /* ENQ WAS DONE                  */ 02304000
         TM    AP1ENQD(AP1REG),B'00010000'                      01S0876 02305000
         BNO   @RF00876                                         01S0876 02306000
*     DO;                           /* DEQ (QNAME,AP1ENQAD,LENGTH(AP1   02307000
*                                      ENQAD),SYSTEM) RET(NONE)      */ 02308000
*       I048(1:20)=I048(1:20)&&I048(1:20);                      01S0878 02309000
         XC    I048(20),I048                                    01S0878 02310000
*       RFY                                                     01S0879 02311000
*         GPR01F RESTRICTED;                                    01S0879 02312000
*       I04804(1)='11000000'B;      /* LISTEND BYTE                  */ 02313000
         MVI   I04804,B'11000000'                               01S0880 02314000
*       I04805(1)=LENGTH(AP1ENQAD); /* SET LENGTH                    */ 02315000
         MVI   I04805,X'04'                                     01S0881 02316000
*       I04806(1)='01000000'B;      /* OPTIONS                       */ 02317000
         MVI   I04806,B'01000000'                               01S0882 02318000
*       I04807(1)=ADDR(QNAME);      /* QNAME ADDRESS                 */ 02319000
         LA    @09,QNAME                                        01S0883 02320000
         ST    @09,I04807                                       01S0883 02321000
*       I04808(1)=ADDR(AP1ENQAD);   /* RNAME ADDRESS                 */ 02322000
         LA    @09,AP1ENQAD(,AP1REG)                            01S0884 02323000
         ST    @09,I04808                                       01S0884 02324000
*       GPR01F=ADDR(I04802);                                    01S0885 02325000
         LA    GPR01F,I04802                                    01S0885 02326000
*       SVC(48);                                                01S0886 02327000
         SVC   48                                               01S0886 02328000
*       RFY                                                     01S0887 02329000
*         GPR01F UNRESTRICTED;                                  01S0887 02330000
*     END;                          /* DEQ (QNAME,AP1ENQAD,LENGTH(AP1   02331000
*                                      ENQAD),SYSTEM) RET(NONE)      */ 02332000
*   ELSE                                                        01S0889 02333000
*     ;                             /* ENQ NOT DONE--DONT DEQ        */ 02334000
*                                                               01S0889 02335000
@RF00876 DS    0H                                               01S0890 02336000
*   /*****************************************************************/ 02337000
*   /*                                                               */ 02338000
*   /* FREEMAINS                                                     */ 02339000
*   /*                                                               */ 02340000
*   /*****************************************************************/ 02341000
*                                                               01S0890 02342000
*                                                               01S0890 02343000
*   /*****************************************************************/ 02344000
*   /*                                                               */ 02345000
*   /* FREE BUFFER                                                   */ 02346000
*   /*                                                               */ 02347000
*   /*****************************************************************/ 02348000
*                                                               01S0890 02349000
*   DO;                             /* FREEMAIN(R)              01S0890 02350000
*                                      LV(BUFFLEN)SP(DEBSP)A(BUFFER) */ 02351000
*     RESPECIFY                                                 01S0891 02352000
*      (GPR01F,                                                 01S0891 02353000
*       GPR00F) RESTRICTED;                                     01S0891 02354000
*     GPR00F=BUFFLEN;               /* LENGTH REQUESTED              */ 02355000
         LA    GPR00F,864                                       01S0892 02356000
*     GPR01F=DEBSP;                 /* SP IN REG 1                   */ 02357000
         LA    GPR01F,230                                       01S0893 02358000
*     GEN(SLL   GPR01F,24)                                      01S0894 02359000
*     NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;              01S0894 02360000
         SLL   GPR01F,24                                                02361000
*     GPR00F=GPR00F|GPR01F;         /* SP IN HI BYTE                 */ 02362000
         OR    GPR00F,GPR01F                                    01S0895 02363000
*     GPR01F=ADDR(BUFFER);          /* SET REGISTER ONE              */ 02364000
         L     GPR01F,AP1BUFAD(,AP1REG)                         01S0896 02365000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 02366000
         SVC   10                                               01S0897 02367000
*     RESPECIFY                                                 01S0898 02368000
*      (GPR01F,                                                 01S0898 02369000
*       GPR00F) UNRESTRICTED;                                   01S0898 02370000
*   END;                            /* FREEMAIN(R)              01S0899 02371000
*                                      LV(BUFFLEN)SP(DEBSP)A(BUFFER)    02372000
*                                      FREE BUFR                     */ 02373000
*                                                               01S0899 02374000
*   /*****************************************************************/ 02375000
*   /*                                                               */ 02376000
*   /* FREE DEB                                                      */ 02377000
*   /*                                                               */ 02378000
*   /*****************************************************************/ 02379000
*                                                               01S0900 02380000
*   IF AP1DEBAÂ¬=0 THEN              /* DEB EXISTS                    */ 02381000
         L     @09,AP1DEBA(,AP1REG)                             01S0900 02382000
         LTR   @09,@09                                          01S0900 02383000
         BZ    @RF00900                                         01S0900 02384000
*     DO;                                                       01S0901 02385000
*       DO;                         /* MODESET EXTKEY(DATAMGT)       */ 02386000
*         SPKA(80);                 /* SET PSW KEY                   */ 02387000
         LA    @09,80                                           01S0903 02388000
         SPKA  0(@09)                                           01S0903 02389000
*       END;                        /* MODESET EXTKEY(DATAMGT) DEB      02390000
*                                      KEY                           */ 02391000
*       RFY                                                     01S0905 02392000
*         DEB BASED(DEBAPPB);       /* SO FREEMAIN WONT GET HI BYTE  */ 02393000
*       DO;                         /* FREEMAIN(R) LV(LENGTH(DEBBASIC   02394000
*                                      )+LENGTH(DEB)+LENGTH(DEBDASD))   02395000
*                                      SP(DEBSP)A(DEB)               */ 02396000
*         RESPECIFY                                             01S0907 02397000
*          (GPR01F,                                             01S0907 02398000
*           GPR00F) RESTRICTED;                                 01S0907 02399000
*         GPR00F=LENGTH(DEBBASIC)+LENGTH(DEB)+LENGTH(DEBDASD);/*        02400000
*                                      LENGTH REQUESTED              */ 02401000
         LA    GPR00F,84                                        01S0908 02402000
*         GPR01F=DEBSP;             /* SP IN REG 1                   */ 02403000
         LA    GPR01F,230                                       01S0909 02404000
*         GEN(SLL   GPR01F,24)                                  01S0910 02405000
*         NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;          01S0910 02406000
         SLL   GPR01F,24                                                02407000
*         GPR00F=GPR00F|GPR01F;     /* SP IN HI BYTE                 */ 02408000
         OR    GPR00F,GPR01F                                    01S0911 02409000
*         GPR01F=ADDR(DEB);         /* SET REGISTER ONE              */ 02410000
         L     @09,AP1DEBA(,AP1REG)                             01S0912 02411000
         L     GPR01F,DEBAPPB-1(,@09)                           01S0912 02412000
         LA    GPR01F,0(,GPR01F)                                01S0912 02413000
*         SVC(10);                  /* R-FORM OF GETMAIN             */ 02414000
         SVC   10                                               01S0913 02415000
*         RESPECIFY                                             01S0914 02416000
*          (GPR01F,                                             01S0914 02417000
*           GPR00F) UNRESTRICTED;                               01S0914 02418000
*       END;                        /* FREEMAIN(R) LV(LENGTH(DEBBASIC   02419000
*                                      )+LENGTH(DEB)+LENGTH(DEBDASD))   02420000
*                                      SP(DEBSP)A(DEB) FREE DEB      */ 02421000
*       RFY                                                     01S0916 02422000
*         DEB;                      /* RESET                         */ 02423000
*       RFY                                                     01S0917 02424000
*         GPR04F RSTD;                                          01S0917 02425000
*       DO;                         /* MODESET EXTKEY(TCB)      01S0918 02426000
*                                      WORKREG(GPR04F)               */ 02427000
*         GPR04F=TCBPKF;            /* GET KEY FROM TCB              */ 02428000
         L     @09,FLCCVT                                       01S0919 02429000
         L     @09,CVTTCBP(,@09)                                01S0919 02430000
         L     @09,TCBPTR(,@09)                                 01S0919 02431000
         SLR   GPR04F,GPR04F                                    01S0919 02432000
         IC    GPR04F,TCBPKF(,@09)                              01S0919 02433000
*         SPKA(GPR04F);             /* SET PSW KEY                   */ 02434000
         SPKA  0(GPR04F)                                        01S0920 02435000
*       END;                        /* MODESET EXTKEY(TCB)      01S0921 02436000
*                                      WORKREG(GPR04F) USER KEY      */ 02437000
*       RFY                                                     01S0922 02438000
*         GPR04F UNRSTD;                                        01S0922 02439000
*     END;                                                      01S0923 02440000
*   ELSE                                                        01S0924 02441000
*     ;                             /* DEB DOES NOT EXIST            */ 02442000
*                                                               01S0924 02443000
@RF00900 DS    0H                                               01S0925 02444000
*   /*****************************************************************/ 02445000
*   /*                                                               */ 02446000
*   /* FREE AP1BLOCK                                                 */ 02447000
*   /*                                                               */ 02448000
*   /*****************************************************************/ 02449000
*                                                               01S0925 02450000
*   RFY                                                         01S0925 02451000
*     GPR09F RSTD;                                              01S0925 02452000
*   GPR09F=AP1RET;                  /* SAVE RETURN CODE              */ 02453000
         SLR   GPR09F,GPR09F                                    01S0926 02454000
         IC    GPR09F,AP1RET(,AP1REG)                           01S0926 02455000
*   RFY                                                         01S0927 02456000
*     GPR01F RSTD;                                              01S0927 02457000
*   RFY                                                         01S0928 02458000
*     GPR01F UNRSTD;                                            01S0928 02459000
*   DO;                             /* FREEMAIN(R) LV(LENGTH(AP1BLOCK   02460000
*                                      )+DATDLEN+PRDCBL+TESTDCBL+LENG   02461000
*                                      TH(IOBSTDRD)+LENGTH(IOBEXTEN)+   02462000
*                                      LENGTH(IOBAP1PT)+(LENGTH(CCW)*   02463000
*                                      MAXCCWS)+(LENGTH(WRKAREA)*WRKW   02464000
*                                      ORDS)+FUDGE)SP(DEBSP)A(AP1BLOC   02465000
*                                      K)                            */ 02466000
*     RESPECIFY                                                 01S0930 02467000
*      (GPR01F,                                                 01S0930 02468000
*       GPR00F) RESTRICTED;                                     01S0930 02469000
*     GPR00F=LENGTH(AP1BLOCK)+DATDLEN+PRDCBL+TESTDCBL+LENGTH(IOBSTDRD)+ 02470000
*         LENGTH(IOBEXTEN)+LENGTH(IOBAP1PT)+(LENGTH(CCW)*MAXCCWS)+(     02471000
*         LENGTH(WRKAREA)*WRKWORDS)+FUDGE;/* LENGTH REQUESTED        */ 02472000
         LA    GPR00F,616                                       01S0931 02473000
         AL    GPR00F,PRDCBL                                    01S0931 02474000
         AL    GPR00F,TESTDCBL                                  01S0931 02475000
         AL    GPR00F,@CF03848                                  01S0931 02476000
*     GPR01F=DEBSP;                 /* SP IN REG 1                   */ 02477000
         LA    GPR01F,230                                       01S0932 02478000
*     GEN(SLL   GPR01F,24)                                      01S0933 02479000
*     NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;              01S0933 02480000
         SLL   GPR01F,24                                                02481000
*     GPR00F=GPR00F|GPR01F;         /* SP IN HI BYTE                 */ 02482000
         OR    GPR00F,GPR01F                                    01S0934 02483000
*     GPR01F=ADDR(AP1BLOCK);        /* SET REGISTER ONE              */ 02484000
         LR    GPR01F,AP1REG                                    01S0935 02485000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 02486000
         SVC   10                                               01S0936 02487000
*     RESPECIFY                                                 01S0937 02488000
*      (GPR01F,                                                 01S0937 02489000
*       GPR00F) UNRESTRICTED;                                   01S0937 02490000
*   END;                            /* FREEMAIN(R) LV(LENGTH(AP1BLOCK   02491000
*                                      )+DATDLEN+PRDCBL+TESTDCBL+LENG   02492000
*                                      TH(IOBSTDRD)+LENGTH(IOBEXTEN)+   02493000
*                                      LENGTH(IOBAP1PT)+(LENGTH(CCW)*   02494000
*                                      MAXCCWS)+(LENGTH(WRKAREA)*WRKW   02495000
*                                      ORDS)+FUDGE)SP(DEBSP)A(AP1BLOC   02496000
*                                      K)                            */ 02497000
*   RETURN CODE(GPR09F);            /* RETURN WITH RETURN CODE       */ 02498000
         L     @13,4(,@13)                                      01S0939 02499000
         L     @00,@SIZDATD                                     01S0939 02500000
         LR    @01,@07                                          01S0939 02501000
         FREEMAIN R,LV=(0),A=(1)                                        02502000
         LR    @15,@09                                          01S0939 02503000
         L     @14,12(,@13)                                     01S0939 02504000
         LM    @00,@12,20(@13)                                  01S0939 02505000
         BR    @14                                              01S0939 02506000
*   RFY                                                         01S0940 02507000
*     GPR09F UNRSTD;                                            01S0940 02508000
         EJECT                                                          02509000
*                                                               01S0941 02510000
*   /*****************************************************************/ 02511000
*   /*                                                               */ 02512000
*   /* BADATA: PROCEDURE                                             */ 02513000
*   /*                                                               */ 02514000
*   /*****************************************************************/ 02515000
*                                                               01S0941 02516000
*BADATA:                                                        01S0941 02517000
*   PROC;                           /* INTERNAL PROCEEDURE           */ 02518000
*                                                               01S0941 02519000
BADATA   STM   @14,@12,@SA00002                                 01S0941 02520000
*   /*****************************************************************/ 02521000
*   /*                                                               */ 02522000
*   /* PRINT MESSAGES FOR BAD DATA FORMAT AND SET AP1QUIT            */ 02523000
*   /*                                                               */ 02524000
*   /*****************************************************************/ 02525000
*                                                               01S0942 02526000
*   AP1QUIT=ON;                     /* END TESTING                   */ 02527000
         OI    AP1QUIT(AP1REG),B'00001000'                      01S0942 02528000
*   AP1CNCOD=MDFU;                  /* DATA FORMAT UNACCEPTABLE      */ 02529000
         MVI   AP1CNCOD(AP1REG),X'04'                           01S0943 02530000
*   CALL COMM;                      /* SEND MSG TO CONSOLE           */ 02531000
         BAL   @14,COMM                                         01S0944 02532000
*   AP1PRCOD=PVERDFU;               /* DATA FORMAT UNACCEPTABLE      */ 02533000
         MVI   AP1PRCOD(AP1REG),X'23'                           01S0945 02534000
*   CNVTPRM(1)=ADDR(CC);            /* INAREA                @ZM01497*/ 02535000
         LA    @09,CC(,AP1REG)                                  01S0946 02536000
         ST    @09,CNVTPRM                                      01S0946 02537000
*   CNVTPRM(2)=ADDR(AP1PRMSG)+41;   /* OUTAREA               @ZM01497*/ 02538000
         LA    @09,AP1PRMSG(,AP1REG)                            01S0947 02539000
         AL    @09,@CF03317                                     01S0947 02540000
         ST    @09,CNVTPRM+4                                    01S0947 02541000
*   CNVTPRM(3)=ADDR(LENGTH(CC));    /* BYTES                 @ZM01497*/ 02542000
         LA    @09,@CF00060                                     01S0948 02543000
         ST    @09,CNVTPRM+8                                    01S0948 02544000
*   RFY                                                         01S0949 02545000
*     GPR01P RSTD;                  /*                       @ZM01497*/ 02546000
*   GPR01P=ADDR(CNVTPRM);           /* POINT TO PARMS        @ZM01497*/ 02547000
         LA    GPR01P,CNVTPRM                                   01S0950 02548000
*   CALL CVTEBCDX;                  /* CNVT CC TO EBCDIC     @ZM01497*/ 02549000
         BAL   @14,CVTEBCDX                                     01S0951 02550000
*   RFY                                                         01S0952 02551000
*     GPR01P UNRSTD;                /*                       @ZM01497*/ 02552000
*   CALL COMM;                      /* PRINT MESSAGE                 */ 02553000
         BAL   @14,COMM                                         01S0953 02554000
*   END;                            /* OF BADATA PROC                */ 02555000
@EL00002 DS    0H                                               01S0954 02556000
@EF00002 DS    0H                                               01S0954 02557000
@ER00002 LM    @14,@12,@SA00002                                 01S0954 02558000
         BR    @14                                              01S0954 02559000
         EJECT                                                          02560000
*                                                               01S0955 02561000
*   /*****************************************************************/ 02562000
*   /*                                                               */ 02563000
*   /* PRTCCW: PROCEDURE                                             */ 02564000
*   /*                                                               */ 02565000
*   /*****************************************************************/ 02566000
*                                                               01S0955 02567000
*PRTCCW:                                                        01S0955 02568000
*   PROC;                           /* INTERNAL TO AP1 PROC          */ 02569000
*                                                               01S0955 02570000
PRTCCW   STM   @14,@12,@SA00003                                 01S0955 02571000
*   /*****************************************************************/ 02572000
*   /*                                                               */ 02573000
*   /* FORMAT CCW, CSW AND SNS AND PRINT                             */ 02574000
*   /*                                                               */ 02575000
*   /*****************************************************************/ 02576000
*                                                               01S0956 02577000
*   AP1PRCOD=PFCCW;                 /* FAILING CCW CSW MESSAGE       */ 02578000
         MVI   AP1PRCOD(AP1REG),X'19'                           01S0956 02579000
*   IF CSWADDRBÂ¬=0 THEN             /* CCW EXISTS                    */ 02580000
         LA    @09,AP1CSW(,AP1REG)                              01S0957 02581000
         BCTR  @09,0                                            01S0957 02582000
         L     @09,CSWADDRB-1(,@09)                             01S0957 02583000
         LA    @09,0(,@09)                                      01S0957 02584000
         LTR   @09,@09                                          01S0957 02585000
         BZ    @RF00957                                         01S0957 02586000
*     DO;                           /*                       @ZM01497*/ 02587000
*       CNVTPRM(1)=CSWADDRB-LENGTH(CCW);/* INAREA            @ZM01497*/ 02588000
         SL    @09,@CF00049                                     01S0959 02589000
         ST    @09,CNVTPRM                                      01S0959 02590000
*       CNVTPRM(2)=ADDR(AP1PRMSG)+21;/* OUTAREA              @ZM01497*/ 02591000
         LA    @09,AP1PRMSG(,AP1REG)                            01S0960 02592000
         AL    @09,@CF03033                                     01S0960 02593000
         ST    @09,CNVTPRM+4                                    01S0960 02594000
*       CNVTPRM(3)=ADDR(LENGTH(CCW));/* BYTES                @ZM01497*/ 02595000
         LA    @09,@CF00049                                     01S0961 02596000
         ST    @09,CNVTPRM+8                                    01S0961 02597000
*       RFY                                                     01S0962 02598000
*         GPR01P RSTD;              /*                       @ZM01497*/ 02599000
*       GPR01P=ADDR(CNVTPRM);       /* POINT TO PARMS        @ZM01497*/ 02600000
         LA    GPR01P,CNVTPRM                                   01S0963 02601000
*       CALL CVTEBCDX;              /* CNVT CCW TO EBCDIC    @ZM01497*/ 02602000
         BAL   @14,CVTEBCDX                                     01S0964 02603000
*       RFY                                                     01S0965 02604000
*         GPR01P UNRSTD;            /*                       @ZM01497*/ 02605000
*     END;                          /*                       @ZM01497*/ 02606000
*   ELSE                                                        01S0967 02607000
*     ;                             /* NO CCW                        */ 02608000
@RF00957 DS    0H                                               01S0968 02609000
*   CNVTPRM(1)=ADDR(AP1CSW)-1;      /* INAREA                @ZM01497*/ 02610000
         LA    @09,AP1CSW(,AP1REG)                              01S0968 02611000
         BCTR  @09,0                                            01S0968 02612000
         ST    @09,CNVTPRM                                      01S0968 02613000
*   CNVTPRM(2)=ADDR(AP1PRMSG)+48;   /* OUTAREA               @ZM01497*/ 02614000
         LA    @09,AP1PRMSG(,AP1REG)                            01S0969 02615000
         AL    @09,@CF00997                                     01S0969 02616000
         ST    @09,CNVTPRM+4                                    01S0969 02617000
*   CNVTPRM(3)=ADDR(LENGTH(CSW));   /* BYTES                 @ZM01497*/ 02618000
         LA    @09,@CF00049                                     01S0970 02619000
         ST    @09,CNVTPRM+8                                    01S0970 02620000
*   RFY                                                         01S0971 02621000
*     GPR01P RSTD;                  /*                       @ZM01497*/ 02622000
*   GPR01P=ADDR(CNVTPRM);           /* POINT TO PARMS        @ZM01497*/ 02623000
         LA    GPR01P,CNVTPRM                                   01S0972 02624000
*   CALL CVTEBCDX;                  /* CNVT CSW TO EBCDIC    @ZM01497*/ 02625000
         BAL   @14,CVTEBCDX                                     01S0973 02626000
*   RFY                                                         01S0974 02627000
*     GPR01P UNRSTD;                /*                       @ZM01497*/ 02628000
*   AP1PRMSG(49:50)='  ';           /* BLANK FIRST BYTE OF CSW       */ 02629000
         MVC   AP1PRMSG+48(2,AP1REG),@CC03322                   01S0975 02630000
*   CNVTPRM(1)=ADDR(AP1PCODE)-1;    /* INAREA                @ZM01497*/ 02631000
         LA    @09,AP1PCODE(,AP1REG)                            01S0976 02632000
         BCTR  @09,0                                            01S0976 02633000
         ST    @09,CNVTPRM                                      01S0976 02634000
*   CNVTPRM(2)=ADDR(AP1PRMSG)+75;   /* OUTAREA               @ZM01497*/ 02635000
         LA    @09,AP1PRMSG(,AP1REG)                            01S0977 02636000
         AL    @09,@CF03323                                     01S0977 02637000
         ST    @09,CNVTPRM+4                                    01S0977 02638000
*   CNVTPRM(3)=ADDR(PCODELN1);      /* L(AP1PCODE)+1 BYTES   @ZM01497*/ 02639000
         LA    @09,PCODELN1                                     01S0978 02640000
         ST    @09,CNVTPRM+8                                    01S0978 02641000
*   RFY                                                         01S0979 02642000
*     GPR01P RSTD;                  /*                       @ZM01497*/ 02643000
*   GPR01P=ADDR(CNVTPRM);           /* POINT TO PARMS        @ZM01497*/ 02644000
         LA    GPR01P,CNVTPRM                                   01S0980 02645000
*   CALL CVTEBCDX;                  /* CNVT POST CD TO EBCDIC   01S0981 02646000
*                                                            @ZM01497*/ 02647000
         BAL   @14,CVTEBCDX                                     01S0981 02648000
*   RFY                                                         01S0982 02649000
*     GPR01P UNRSTD;                /*                       @ZM01497*/ 02650000
*   AP1PRMSG(76:77)='  ';           /* BLANK FIRST BYTE              */ 02651000
         MVC   AP1PRMSG+75(2,AP1REG),@CC03322                   01S0983 02652000
*   CALL COMM;                      /* PRINT CCW AND CSW             */ 02653000
         BAL   @14,COMM                                         01S0984 02654000
*   AP1PRCOD=PFSNS;                 /* FAILING SENSE MESSAGE         */ 02655000
         MVI   AP1PRCOD(AP1REG),X'1A'                           01S0985 02656000
*   CNVTPRM(1)=ADDR(AP1SNS);        /* INAREA                @ZM01497*/ 02657000
         LA    @09,AP1SNS(,AP1REG)                              01S0986 02658000
         ST    @09,CNVTPRM                                      01S0986 02659000
*   CNVTPRM(2)=ADDR(AP1PRMSG)+12;   /* OUTAREA               @ZM01497*/ 02660000
         LA    @09,AP1PRMSG(,AP1REG)                            01S0987 02661000
         AL    @09,@CF00035                                     01S0987 02662000
         ST    @09,CNVTPRM+4                                    01S0987 02663000
*   CNVTPRM(3)=ADDR(LENGTH(SNSD));  /* BYTES                 @ZM01497*/ 02664000
         LA    @09,@CF00066                                     01S0988 02665000
         ST    @09,CNVTPRM+8                                    01S0988 02666000
*   RFY                                                         01S0989 02667000
*     GPR01P RSTD;                  /*                       @ZM01497*/ 02668000
*   GPR01P=ADDR(CNVTPRM);           /* POINT TO PARMS        @ZM01497*/ 02669000
         LA    GPR01P,CNVTPRM                                   01S0990 02670000
*   CALL CVTEBCDX;                  /* CNVT SNS TO EBCDIC    @ZM01497*/ 02671000
         BAL   @14,CVTEBCDX                                     01S0991 02672000
*   RFY                                                         01S0992 02673000
*     GPR01P UNRSTD;                /*                       @ZM01497*/ 02674000
*   CALL COMM;                      /* PRINT SNS                     */ 02675000
         BAL   @14,COMM                                         01S0993 02676000
*   END;                            /* OF PRTCCW PROC                */ 02677000
@EL00003 DS    0H                                               01S0994 02678000
@EF00003 DS    0H                                               01S0994 02679000
@ER00003 LM    @14,@12,@SA00003                                 01S0994 02680000
         BR    @14                                              01S0994 02681000
         EJECT                                                          02682000
*                                                               01S0995 02683000
*   /*****************************************************************/ 02684000
*   /*                                                               */ 02685000
*   /* IO: PROCEDURE                                                 */ 02686000
*   /*                                                               */ 02687000
*   /*****************************************************************/ 02688000
*                                                               01S0995 02689000
*IO:                                                            01S0995 02690000
*   PROC;                           /* INTERNAL TO AP1 PROC          */ 02691000
*                                                               01S0995 02692000
IO       STM   @14,@12,@SA00004                                 01S0995 02693000
*   /*****************************************************************/ 02694000
*   /*                                                               */ 02695000
*   /* DOES ACTUAL I/O TO TEST DEVICE. SETS UP INTERFACE TO EXCP AND */ 02696000
*   /* CALLS IT. SUBTASK IAPTIMER CHECKS TO SEE IF I/O HAS GONE 1 TO */ 02697000
*   /* 2 MINUTES WITHOUT RESPONSE AND PURGES IT.                     */ 02698000
*   /*                                                               */ 02699000
*   /*****************************************************************/ 02700000
*                                                               01S0996 02701000
*                                                               01S0996 02702000
*   /*****************************************************************/ 02703000
*   /*                                                               */ 02704000
*   /* INITIALIZE                                                    */ 02705000
*   /*                                                               */ 02706000
*   /*****************************************************************/ 02707000
*                                                               01S0996 02708000
*   AP1IOC=OFF;                     /* RESET I/O COMPLETE FLAG       */ 02709000
*   AP1EDP=OFF;                     /* RESET ENV DATA FLAG           */ 02710000
         NI    AP1IOC(AP1REG),B'10011111'                       01S0997 02711000
*   IOBSEEK=AP1SEEK;                /* SET UP IOB SEEK               */ 02712000
*                                                               01S0998 02713000
         L     @09,AP1IOBA(,AP1REG)                             01S0998 02714000
         MVC   IOBSEEK(8,@09),AP1SEEK(AP1REG)                   01S0998 02715000
*   /*****************************************************************/ 02716000
*   /*                                                               */ 02717000
*   /* GET INTO DEB KEY                                              */ 02718000
*   /*                                                               */ 02719000
*   /*****************************************************************/ 02720000
*                                                               01S0999 02721000
*   DO;                             /* MODESET EXTKEY(DATAMGT)       */ 02722000
*     SPKA(80);                     /* SET PSW KEY                   */ 02723000
         LA    @09,80                                           01S1000 02724000
         SPKA  0(@09)                                           01S1000 02725000
*   END;                            /* MODESET EXTKEY(DATAMGT) DATA     02726000
*                                      MGT KEY                       */ 02727000
*   DEBDVMOD=AP1FM;                 /* SET UP DEB FILE MASK          */ 02728000
         L     @09,AP1DEBA(,AP1REG)                             01S1002 02729000
         MVC   DEBDVMOD+32(1,@09),AP1FM(AP1REG)                 01S1002 02730000
*   RFY                                                         01S1003 02731000
*     GPR04F RSTD;                                              01S1003 02732000
*   DO;                             /* MODESET EXTKEY(TCB)      01S1004 02733000
*                                      WORKREG(GPR04F)               */ 02734000
*     GPR04F=TCBPKF;                /* GET KEY FROM TCB              */ 02735000
         L     @09,FLCCVT                                       01S1005 02736000
         L     @09,CVTTCBP(,@09)                                01S1005 02737000
         L     @09,TCBPTR(,@09)                                 01S1005 02738000
         SLR   GPR04F,GPR04F                                    01S1005 02739000
         IC    GPR04F,TCBPKF(,@09)                              01S1005 02740000
*     SPKA(GPR04F);                 /* SET PSW KEY                   */ 02741000
         SPKA  0(GPR04F)                                        01S1006 02742000
*   END;                            /* MODESET EXTKEY(TCB)      01S1007 02743000
*                                      WORKREG(GPR04F) USER KEY      */ 02744000
*   RFY                                                         01S1008 02745000
*     GPR04F UNRSTD;                                            01S1008 02746000
*                                                               01S1008 02747000
*   /*****************************************************************/ 02748000
*   /*                                                               */ 02749000
*   /* LOOP UNTIL I/O COMPLETE (WITH NO ERPS FOR HDWE TEST)          */ 02750000
*   /*                                                               */ 02751000
*   /*****************************************************************/ 02752000
*                                                               01S1009 02753000
*   DO WHILE AP1IOC=OFF;            /* WHILE I/O NOT COMPLETE        */ 02754000
         B     @DE01009                                         01S1009 02755000
@DL01009 DS    0H                                               01S1010 02756000
*     AP1SNS=AP1SNS&&AP1SNS;        /* CLEAR SENSE                   */ 02757000
*                                                               01S1010 02758000
         XC    AP1SNS(24,AP1REG),AP1SNS(AP1REG)                 01S1010 02759000
*     /***************************************************************/ 02760000
*     /*                                                             */ 02761000
*     /* ISSUE SYSEVENT DONTSWAP                                     */ 02762000
*     /*                                                             */ 02763000
*     /***************************************************************/ 02764000
*                                                               01S1011 02765000
*     GENERATE;                                                 01S1011 02766000
*                                                               01S1011 02767000
         SYSEVENT DONTSWAP       DONT SWAP                              02768000
*     /***************************************************************/ 02769000
*     /*                                                             */ 02770000
*     /* SETUP FOR EXCP                                              */ 02771000
*     /*                                                             */ 02772000
*     /***************************************************************/ 02773000
*                                                               01S1012 02774000
*     AP1IOC=ON;                    /* ASSUME I/O COMPLETE--WILL BE     02775000
*                                      RESET BY ABN APP IF EDP       */ 02776000
         OI    AP1IOC(AP1REG),B'01000000'                       01S1012 02777000
*     RFY                                                       01S1013 02778000
*       GPR01P RSTD;                                            01S1013 02779000
*     GPR01P=AP1IOBA;               /* GET IOB FOR EXCP              */ 02780000
*                                                               01S1014 02781000
         L     GPR01P,AP1IOBA(,AP1REG)                          01S1014 02782000
*     /***************************************************************/ 02783000
*     /*                                                             */ 02784000
*     /* EXCP                                                        */ 02785000
*     /*                                                             */ 02786000
*     /***************************************************************/ 02787000
*                                                               01S1015 02788000
*     GENERATE;                                                 01S1015 02789000
        EXCP  (1)                IOB ADDRESS IN REG 1                   02790000
*     RFY                                                       01S1016 02791000
*       GPR01P UNRSTD;                                          01S1016 02792000
*     AP1IOACT=ON;                  /* I/O ACTIVE                    */ 02793000
*                                                               01S1017 02794000
         OI    AP1IOACT(AP1REG),B'10000000'                     01S1017 02795000
*     /***************************************************************/ 02796000
*     /*                                                             */ 02797000
*     /* WAIT ON I/O                                                 */ 02798000
*     /*                                                             */ 02799000
*     /***************************************************************/ 02800000
*                                                               01S1018 02801000
*     DO;                           /* WAIT ECB(AP1IOECB)            */ 02802000
*       RESPECIFY                                               01S1019 02803000
*        (GPR00P,                                               01S1019 02804000
*         GPR01P) RESTRICTED;                                   01S1019 02805000
*       GPR00P=1;                   /* LOAD WAIT COUNT               */ 02806000
         LA    GPR00P,1                                         01S1020 02807000
*       GPR01P=ADDR(AP1IOECB);      /* ADDRESS OF ECB                */ 02808000
         LA    GPR01P,AP1IOECB(,AP1REG)                         01S1021 02809000
*       SVC(1);                     /* WAIT SVC                      */ 02810000
         SVC   1                                                01S1022 02811000
*       RESPECIFY                                               01S1023 02812000
*        (GPR00P,                                               01S1023 02813000
*         GPR01P) UNRESTRICTED;                                 01S1023 02814000
*     END;                          /* WAIT ECB(AP1IOECB)            */ 02815000
*     AP1IOACT=OFF;                 /* I/O FINISHED                  */ 02816000
*     AP1TIMIN=OFF;                 /* RESET TIMER                   */ 02817000
*                                                               01S1026 02818000
         NI    AP1IOACT(AP1REG),B'00111111'                     01S1026 02819000
*     /***************************************************************/ 02820000
*     /*                                                             */ 02821000
*     /* ISSUE SYSEVENT OKSWAP                                       */ 02822000
*     /*                                                             */ 02823000
*     /***************************************************************/ 02824000
*                                                               01S1027 02825000
*     GENERATE;                                                 01S1027 02826000
*                                                               01S1027 02827000
         SYSEVENT OKSWAP         OK TO SWAP                             02828000
*     /***************************************************************/ 02829000
*     /*                                                             */ 02830000
*     /* MAP I/O STATUS TO AP1BLOCK. SENSE WAS MAPPED BY ABNORMAL END*/ 02831000
*     /* APPENDAGE                                                   */ 02832000
*     /*                                                             */ 02833000
*     /***************************************************************/ 02834000
*                                                               01S1028 02835000
*     AP1CSW=IOBCSW;                /* MAP CSW                       */ 02836000
         L     @09,AP1IOBA(,AP1REG)                             01S1028 02837000
         MVC   AP1CSW(7,AP1REG),IOBCSW(@09)                     01S1028 02838000
*     AP1PCODE=AP1IOECB(1:1);       /* MAP POST CODE                 */ 02839000
         MVC   AP1PCODE(1,AP1REG),AP1IOECB(AP1REG)              01S1029 02840000
*   END;                            /* DO WHILE                      */ 02841000
@DE01009 TM    AP1IOC(AP1REG),B'01000000'                       01S1030 02842000
         BZ    @DL01009                                         01S1030 02843000
*   END;                            /* OF IO PROC                    */ 02844000
@EL00004 DS    0H                                               01S1031 02845000
@EF00004 DS    0H                                               01S1031 02846000
@ER00004 LM    @14,@12,@SA00004                                 01S1031 02847000
         BR    @14                                              01S1031 02848000
         EJECT                                                          02849000
*                                                               01S1032 02850000
*   /*****************************************************************/ 02851000
*   /*                                                               */ 02852000
*   /* CVTEBCDX: PROCEDURE                                           */ 02853000
*   /*                                                               */ 02854000
*   /*****************************************************************/ 02855000
*                                                               01S1032 02856000
*CVTEBCDX:                                                      01S1032 02857000
*   PROC(INAREA,OUTAREA,BYTES);     /* INTERNAL TO AP1 PROC          */ 02858000
*                                                               01S1032 02859000
CVTEBCDX STM   @14,@12,@SA00005                                 01S1032 02860000
         MVC   @PC00005(12),0(@01)                              01S1032 02861000
*   /*****************************************************************/ 02862000
*   /*                                                               */ 02863000
*   /* CONVERTS BINARY DATA IN STORAGE TO EBCDIC DATA IN STORAGE.    */ 02864000
*   /* INAREA IS AREA CONTAINING BINARY DATA. OUTAREA IS AREA TO     */ 02865000
*   /* CONTAIN EBCDIC DATA IN THE FORM XXXX XXXX.... BYTES IS NUMBER */ 02866000
*   /* OF BYTES IN INAREA.                                           */ 02867000
*   /*                                                               */ 02868000
*   /*****************************************************************/ 02869000
*                                                               01S1033 02870000
*   RFY                                                         01S1033 02871000
*    (GPR00F,                                                   01S1033 02872000
*     GPR01P) RSTD;                                             01S1033 02873000
*                                                               01S1033 02874000
*   /*****************************************************************/ 02875000
*   /*                                                               */ 02876000
*   /* CONVERT TWO BINARY BYTES AT A TIME                            */ 02877000
*   /*                                                               */ 02878000
*   /*****************************************************************/ 02879000
*                                                               01S1034 02880000
*   DO COUNTER=1 TO(BYTES/2);       /* TWO BYTES AT A TIME           */ 02881000
         LA    COUNTER,1                                        01S1034 02882000
         B     @DE01034                                         01S1034 02883000
@DL01034 DS    0H                                               01S1035 02884000
*     GPR00F=ADDR(INAREA)->FIXED16(COUNTER);/* GET HALFWORD  @ZM01497*/ 02885000
*                                                               01S1035 02886000
         LR    @06,COUNTER                                      01S1035 02887000
         ALR   @06,@06                                          01S1035 02888000
         L     @15,@PC00005                                     01S1035 02889000
         BCTR  @15,0                                            01S1035 02890000
         BCTR  @15,0                                            01S1035 02891000
         LH    GPR00F,FIXED16(@06,@15)                          01S1035 02892000
         N     GPR00F,@CF03868                                  01S1035 02893000
*     /***************************************************************/ 02894000
*     /*                                                             */ 02895000
*     /* OF BINARY                                           @ZM01497*/ 02896000
*     /*                                                             */ 02897000
*     /***************************************************************/ 02898000
*                                                               01S1036 02899000
*     GPR01P=ADDR(OUTAREA)+(5*(COUNTER-1));/* AREA FOR EBCDIC   01S1036 02900000
*                                                            @ZM01497*/ 02901000
*                                                               01S1036 02902000
         L     GPR01P,@PC00005+4                                01S1036 02903000
         LR    @06,COUNTER                                      01S1036 02904000
         BCTR  @06,0                                            01S1036 02905000
         MH    @06,@CH00085                                     01S1036 02906000
         ALR   GPR01P,@06                                       01S1036 02907000
*     /***************************************************************/ 02908000
*     /*                                                             */ 02909000
*     /* REG0 CONTAINS HALFWORD OF BINARY INFO (SIGN IGNORED)..REG1  */ 02910000
*     /* POINTS TO FULLWORD TO CONTAIN EBCDIC REPRESENTATION         */ 02911000
*     /*                                                             */ 02912000
*     /***************************************************************/ 02913000
*                                                               01S1037 02914000
*     RFY                                                       01S1037 02915000
*      (GPR02F,                                                 01S1037 02916000
*       GPR03F) RSTD;                                           01S1037 02917000
*     GENERATE;                                                 01S1038 02918000
*                      INPUT =   0000WXYZ                               02919000
         SLL   @00,12            0WXYZ000                               02920000
         ST    @00,0(@01)                                               02921000
         UNPK  0(4,@01),0(3,@01) FWFXFY0Z                               02922000
         OI    3(@01),X'F0'      FWFXFYFZ                               02923000
         LA    @00,4             LOOP COUNTER                           02924000
LOOPEBCD CLI   0(@01),X'F9'      IS IT A NUMBER                         02925000
         BNH   NUMBER                                                   02926000
         IC    @02,0(@01)        GET CHARACTER                          02927000
         SH    @02,=X'0039'      CHANGE TO ALPHA                        02928000
         STC   @02,0(@01)        PUT IT BACK                            02929000
NUMBER   LA    @01,1(@01)        GO TO NEXT CHAR                        02930000
         BCT   @00,LOOPEBCD      AGAIN                                  02931000
*     RFY                                                       01S1039 02932000
*      (GPR02F,                                                 01S1039 02933000
*       GPR03F) UNRSTD;                                         01S1039 02934000
*   END;                            /* OF DO                         */ 02935000
         AL    COUNTER,@CF00045                                 01S1040 02936000
@DE01034 L     @06,@PC00005+8                                   01S1040 02937000
         L     @02,BYTES(,@06)                                  01S1040 02938000
         SRDA  @02,32                                           01S1040 02939000
         D     @02,@CF00060                                     01S1040 02940000
         CR    COUNTER,@03                                      01S1040 02941000
         BNH   @DL01034                                         01S1040 02942000
*   RFY                                                         01S1041 02943000
*    (GPR00F,                                                   01S1041 02944000
*     GPR01P) UNRSTD;                                           01S1041 02945000
*   END;                            /* OF CVTEBCDX PROC              */ 02946000
@EL00005 DS    0H                                               01S1042 02947000
@EF00005 DS    0H                                               01S1042 02948000
@ER00005 LM    @14,@12,@SA00005                                 01S1042 02949000
         BR    @14                                              01S1042 02950000
         EJECT                                                          02951000
*                                                               01S1043 02952000
*   /*****************************************************************/ 02953000
*   /*                                                               */ 02954000
*   /* COMM: PROCEDURE                                               */ 02955000
*   /*                                                               */ 02956000
*   /*****************************************************************/ 02957000
*                                                               01S1043 02958000
*COMM:                                                          01S1043 02959000
*   PROC;                           /* INTERNAL TO AP1 PROC          */ 02960000
*                                                               01S1043 02961000
COMM     STM   @14,@12,@SA00006                                 01S1043 02962000
*   /*****************************************************************/ 02963000
*   /*                                                               */ 02964000
*   /* CALLS PRINT OR CONS PROCS. IF AP1CNCOD IS NON-ZERO, THE       */ 02965000
*   /* CONSOLE PROC IS CALLED AND CONSOLE MESSAGES AND REPLIES ARE   */ 02966000
*   /* SENT TO THE PRINTER. IF AP1CNCOD IS ZERO, THE PRINT PROC IS   */ 02967000
*   /* CALLED.                                                       */ 02968000
*   /*                                                               */ 02969000
*   /*****************************************************************/ 02970000
*                                                               01S1044 02971000
*/* CNCOD  TYPE    TEXT     (XXX = DEVICE ADDRESS)              01S1044 02972000
*    01    WTOR    XXX DO YOU WANT TO RUN DATA VERIFICATION TEST,       02973000
*                        YES OR NO?                             01S1044 02974000
*    02    WTO     XXX AP1 STARTED                              01S1044 02975000
*    03    WTO     XXX SUSPECTED DRIVE PROBLEM                  01S1044 02976000
*    04    WTO     XXX DATA FORMAT UNACCEPTABLE, TESTING TERMINATED     02977000
*    05    WTO     XXX ERROR READING DATA                       01S1044 02978000
*    06    WTO     XXX ALL DATA 'MACHINE READABLE' WITHOUT ERRORS       02979000
*    07    WTO     XXX AP1 ENDED                                01S1044 02980000
*    08    WTO     XXX WRITE TESTS BYPASSED                     01S1044 02981000
*    09    WTO     XXX I/O TIMEOUT, TESTING TERMINATED          01S1044 02982000
*    10    WTO     XXX NO DRIVE PROBLEMS FOUND                  01S1044 02983000
*    11    WTO     XXX SYSOUT OPEN FAILED, TESTING TERMINATED   01S1044 02984000
*    12    WTO     XXX NO ''TESTDD'' DD CARD, TESTING BYPASSED  01S1044 02985000
*    13    WTO     XXX UNABLE TO OPEN ''TESTDD'', TESTING TERMINATED    02986000
*    14    WTO     XXX INCORRECT DEVICE TYPE, TESTING TERMINATED        02987000
*    15    WTO     XXX DATA VERIFICATION TEST STARTED           01S1044 02988000
*    16    WTO     XXX WRITE INHIBIT SWITCH ON, WRITE TESTS BYPASSED    02989000
*    17    WTO     XXX DEVICE NOT READY, TESTING TERMINATED     01S1044 02990000
*                                                               01S1044 02991000
*    PRCOD  TEXT                                                01S1044 02992000
*    01  '          M O V E A B L E   H E A D   E R R O R   T A B L E'  02993000
*    02  '      HEAD NUMBER  DATA CHK   SEEK VERIFY   WRITE CHK   DATA  02994000
*         CHK    DATA COMP'                                     01S1044 02995000
*    03  '                                CHECK                 01S1044 02996000
*        CE CYL     ERROR'                                      01S1044 02997000
*    04  '          F I X E D   H E A D   E R R O R   T A B L E'        02998000
*    05  '      HEAD NUMBER   DATA CHECK   SEEK VERIFY   HEAD NUMBER    02999000
*         DATA CHECK   SEEK VERIFY'                             01S1044 03000000
*    06  '                                   CHECK              01S1044 03001000
*                        CHECK'                                 01S1044 03002000
*    07  'SENSE TEST'                                           01S1044 03003000
*    08  'RECALIBRATE TEST'                                     01S1044 03004000
*    09  'RHAMH TEST'                                           01S1044 03005000
*    10  'RHAFH TEST'                                           01S1044 03006000
*    11  'SK192 TEST'                                           01S1044 03007000
*    12  'SKINCR TEST'                                          01S1044 03008000
*    13  'SKMAX TEST'                                           01S1044 03009000
*    14  'SKRAN TEST'                                           01S1044 03010000
*    15  'RHA TEST'                                             01S1044 03011000
*    16  'WRT TEST'                                             01S1044 03012000
*    17  'RR01 TEST'                                            01S1044 03013000
*    18  'RR01 DATA COMPARE ERROR--EXP =                       REC ='   03014000
*    19  'RDMT TEST'                                            01S1044 03015000
*    20  'RDMT DATA COMPARE ERROR--EXP =                       REC ='   03016000
*    21  'FTWRT TEST'                                           01S1044 03017000
*    22  'AMDET TEST'                                           01S1044 03018000
*    23  'AMDET DATA COMPARE ERROR--EXP =                      REC ='   03019000
*    24  'SD TEST'                                              01S1044 03020000
*    25  '      FAILING CCW =                        CSW =      01S1044 03021000
*                 ECB ='                                        01S1044 03022000
*    26  '      SNS ='                                          01S1044 03023000
*    27  'WRT WRITE INIHIBIT SWITCH ON'                         01S1044 03024000
*    28  'WRTPAD TEST'                                          01S1044 03025000
*    29  'WRTPAD READ WRONG RECORD--EXP =                       REC ='  03026000
*    30  'DATAVER DATA CHECKS EXCEEDED THRESHOLD'               01S1044 03027000
*    31  'DATAVER DATA CHECK CCHH ='                            01S1044 03028000
*    32  'DATAVER TEST'                                         01S1044 03029000
*    33  'CLEANUP TEST'                                         01S1044 03030000
*    34  'RHA HA INCORRECT -- EXP=            REC='             01S1044 03031000
*    35  'DATAVER DATA FORMAT UNACCEPTABLE ON CYL'              01S1044 03032000
*    36  'RPS TEST'                                             01S1044 03033000
*                                                                    */ 03034000
*                                                               01S1044 03035000
*   /*****************************************************************/ 03036000
*   /*                                                               */ 03037000
*   /* CONSOLE MESSAGE ADDRESSES                                     */ 03038000
*   /*                                                               */ 03039000
*   /*****************************************************************/ 03040000
*                                                               01S1044 03041000
*   DCL                                                         01S1044 03042000
*     CNMSGPTR(17) PTR(31) INIT(ADDR(CNMSG01),ADDR(CNMSG02),ADDR(       03043000
*         CNMSG03),ADDR(CNMSG04),ADDR(CNMSG05),ADDR(CNMSG06),ADDR(      03044000
*         CNMSG07),ADDR(CNMSG08),ADDR(CNMSG09),ADDR(CNMSG10),ADDR(      03045000
*         CNMSG11),ADDR(CNMSG12),ADDR(CNMSG13),ADDR(CNMSG14),ADDR(      03046000
*         CNMSG15),ADDR(CNMSG16),ADDR(CNMSG17));/* ARRAY OF CONSOLE     03047000
*                                      MESSAGE ADDRESSES             */ 03048000
*                                                               01S1044 03049000
*   /*****************************************************************/ 03050000
*   /*                                                               */ 03051000
*   /* PRINTER MESSAGE ADDRESSES                                     */ 03052000
*   /*                                                               */ 03053000
*   /*****************************************************************/ 03054000
*                                                               01S1045 03055000
*   DCL                                                         01S1045 03056000
*     PRMSGPTR(36) PTR(31) INIT(ADDR(PRMSG01),ADDR(PRMSG02),ADDR(       03057000
*         PRMSG03),ADDR(PRMSG04),ADDR(PRMSG05),ADDR(PRMSG06),ADDR(      03058000
*         PRMSG07),ADDR(PRMSG08),ADDR(PRMSG09),ADDR(PRMSG10),ADDR(      03059000
*         PRMSG11),ADDR(PRMSG12),ADDR(PRMSG13),ADDR(PRMSG14),ADDR(      03060000
*         PRMSG15),ADDR(PRMSG16),ADDR(PRMSG17),ADDR(PRMSG18),ADDR(      03061000
*         PRMSG19),ADDR(PRMSG20),ADDR(PRMSG21),ADDR(PRMSG22),ADDR(      03062000
*         PRMSG23),ADDR(PRMSG24),ADDR(PRMSG25),ADDR(PRMSG26),ADDR(      03063000
*         PRMSG27),ADDR(PRMSG28),ADDR(PRMSG29),ADDR(PRMSG30),ADDR(      03064000
*         PRMSG31),ADDR(PRMSG32),ADDR(PRMSG33),ADDR(PRMSG34),ADDR(      03065000
*         PRMSG35),ADDR(PRMSG36));  /* ADDRESSES OF PRINTER MESSAGES */ 03066000
*                                                               01S1045 03067000
*   /*****************************************************************/ 03068000
*   /*                                                               */ 03069000
*   /* CONSOLE MESSAGES                                              */ 03070000
*   /*                                                               */ 03071000
*   /*****************************************************************/ 03072000
*                                                               01S1046 03073000
*   DCL                                                         01S1046 03074000
*     1 CNMSG01 LOCAL,                                          01S1046 03075000
*      2 * FIXED(8) INIT(3),        /* REPLY LENGTH                  */ 03076000
*      2 * PTR(24) INIT(0),         /* REPLY ADDRESS                 */ 03077000
*      2 * PTR(31) INIT(0),         /* REPLY ECB ADDRESS             */ 03078000
*      2 * FIXED(15) INIT(68),      /* MESSAGE LENGTH                */ 03079000
*      2 * BIT(16) INIT('8000'X),   /* MCS FLAGS                     */ 03080000
*      2 * CHAR(64) INIT(                                       01S1046 03081000
*'IAP001A XXX DO YOU WANT TO RUN DATA VERIFICATION TEST, YES OR NO'),   03082000
*      2 * BIT(32) INIT('40001000'X);/* DESC=2, ROUT=4               */ 03083000
*   DCL                                                         01S1047 03084000
*     1 CNMSG02 LOCAL,                                          01S1047 03085000
*      2 * FIXED(8) INIT(0),                                    01S1047 03086000
*      2 * PTR(24) INIT(0),                                     01S1047 03087000
*      2 * PTR(31) INIT(0),                                     01S1047 03088000
*      2 * FIXED(15) INIT(27),                                  01S1047 03089000
*      2 * BIT(16) INIT('8000'X),                               01S1047 03090000
*      2 * CHAR(23) INIT('IAP002I XXX AP1 STARTED'),            01S1047 03091000
*      2 * BIT(32) INIT('10001000'X);/* DESC=4, ROUT=4               */ 03092000
*   DCL                                                         01S1048 03093000
*     1 CNMSG03 LOCAL,                                          01S1048 03094000
*      2 * FIXED(8) INIT(0),                                    01S1048 03095000
*      2 * PTR(24) INIT(0),                                     01S1048 03096000
*      2 * PTR(31) INIT(0),                                     01S1048 03097000
*      2 * FIXED(15) INIT(39),                                  01S1048 03098000
*      2 * BIT(16) INIT('8000'X),                               01S1048 03099000
*      2 * CHAR(35) INIT('IAP003I XXX SUSPECTED DRIVE PROBLEM'),        03100000
*      2 * BIT(32) INIT('10001000'X);/* DESC=4, ROUT=4               */ 03101000
*   DCL                                                         01S1049 03102000
*     1 CNMSG04 LOCAL,                                          01S1049 03103000
*      2 * FIXED(8) INIT(0),                                    01S1049 03104000
*      2 * PTR(24) INIT(0),                                     01S1049 03105000
*      2 * PTR(31) INIT(0),                                     01S1049 03106000
*      2 * FIXED(15) INIT(60),                                  01S1049 03107000
*      2 * BIT(16) INIT('8000'X),                               01S1049 03108000
*      2 * CHAR(56) INIT(                                       01S1049 03109000
*            'IAP004I XXX DATA FORMAT UNACCEPTABLE, TESTING TERMINATED' 03110000
*            ),                                                 01S1049 03111000
*      2 * BIT(32) INIT('10001000'X);/* DESC=4, ROUT=4               */ 03112000
*   DCL                                                         01S1050 03113000
*     1 CNMSG05 LOCAL,                                          01S1050 03114000
*      2 * FIXED(8) INIT(0),                                    01S1050 03115000
*      2 * PTR(24) INIT(0),                                     01S1050 03116000
*      2 * PTR(31) INIT(0),                                     01S1050 03117000
*      2 * FIXED(15) INIT(34),                                  01S1050 03118000
*      2 * BIT(16) INIT('8000'X),                               01S1050 03119000
*      2 * CHAR(30) INIT('IAP005I XXX ERROR READING DATA'),     01S1050 03120000
*      2 * BIT(32) INIT('10001000'X);/* DESC=4, ROUT=4               */ 03121000
*   DCL                                                         01S1051 03122000
*     1 CNMSG06 LOCAL,                                          01S1051 03123000
*      2 * FIXED(8) INIT(0),                                    01S1051 03124000
*      2 * PTR(24) INIT(0),                                     01S1051 03125000
*      2 * PTR(31) INIT(0),                                     01S1051 03126000
*      2 * FIXED(15) INIT(58),                                  01S1051 03127000
*      2 * BIT(16) INIT('8000'X),                               01S1051 03128000
*      2 * CHAR(54) INIT(                                       01S1051 03129000
*            'IAP006I XXX ALL DATA ''MACHINE READABLE'' WITHOUT ERRORS' 03130000
*            ),                                                 01S1051 03131000
*      2 * BIT(32) INIT('10001000'X);/* DESC=4, ROUT=4               */ 03132000
*   DCL                                                         01S1052 03133000
*     1 CNMSG07 LOCAL,                                          01S1052 03134000
*      2 * FIXED(8) INIT(0),                                    01S1052 03135000
*      2 * PTR(24) INIT(0),                                     01S1052 03136000
*      2 * PTR(31) INIT(0),                                     01S1052 03137000
*      2 * FIXED(15) INIT(25),                                  01S1052 03138000
*      2 * BIT(16) INIT('8000'X),                               01S1052 03139000
*      2 * CHAR(21) INIT('IAP007I XXX AP1 ENDED'),              01S1052 03140000
*      2 * BIT(32) INIT('10001000'X);/* DESC=4, ROUT=4               */ 03141000
*   DCL                                                         01S1053 03142000
*     1 CNMSG08 LOCAL,                                          01S1053 03143000
*      2 * FIXED(8) INIT(0),                                    01S1053 03144000
*      2 * PTR(24) INIT(0),                                     01S1053 03145000
*      2 * PTR(31) INIT(0),                                     01S1053 03146000
*      2 * FIXED(15) INIT(36),                                  01S1053 03147000
*      2 * BIT(16) INIT('8000'X),                               01S1053 03148000
*      2 * CHAR(32) INIT('IAP008I XXX WRITE TESTS BYPASSED'),   01S1053 03149000
*      2 * BIT(32) INIT('10001000'X);/* DESC=4, ROUT=4               */ 03150000
*   DCL                                                         01S1054 03151000
*     1 CNMSG09 LOCAL,                                          01S1054 03152000
*      2 * FIXED(8) INIT(0),                                    01S1054 03153000
*      2 * PTR(24) INIT(0),                                     01S1054 03154000
*      2 * PTR(31) INIT(0),                                     01S1054 03155000
*      2 * FIXED(15) INIT(47),                                  01S1054 03156000
*      2 * BIT(16) INIT('8000'X),                               01S1054 03157000
*      2 * CHAR(43) INIT('IAP009I XXX I/O TIMEOUT, TESTING TERMINATED') 03158000
*         ,                                                     01S1054 03159000
*      2 * BIT(32) INIT('10001000'X);/* DESC=4, ROUT=4               */ 03160000
*   DCL                                                         01S1055 03161000
*     1 CNMSG10 LOCAL,                                          01S1055 03162000
*      2 * FIXED(8) INIT(0),                                    01S1055 03163000
*      2 * PTR(24) INIT(0),                                     01S1055 03164000
*      2 * PTR(31) INIT(0),                                     01S1055 03165000
*      2 * FIXED(15) INIT(39),                                  01S1055 03166000
*      2 * BIT(16) INIT('8000'X),                               01S1055 03167000
*      2 * CHAR(35) INIT('IAP010I XXX NO DRIVE PROBLEMS FOUND'),        03168000
*      2 * BIT(32) INIT('10001000'X);/* DESC=4, ROUT=4               */ 03169000
*   DCL                                                         01S1056 03170000
*     1 CNMSG11 LOCAL,                                          01S1056 03171000
*      2 * FIXED(8) INIT(0),                                    01S1056 03172000
*      2 * PTR(24) INIT(0),                                     01S1056 03173000
*      2 * PTR(31) INIT(0),                                     01S1056 03174000
*      2 * FIXED(15) INIT(54),                                  01S1056 03175000
*      2 * BIT(16) INIT('8000'X),                               01S1056 03176000
*      2 * CHAR(50) INIT(                                       01S1056 03177000
*            'IAP011I XXX SYSOUT OPEN FAILED, TESTING TERMINATED'),     03178000
*      2 * BIT(32) INIT('10001000'X);/* DESC=4, ROUT=4               */ 03179000
*   DCL                                                         01S1057 03180000
*     1 CNMSG12 LOCAL,                                          01S1057 03181000
*      2 * FIXED(8) INIT(0),                                    01S1057 03182000
*      2 * PTR(24) INIT(0),                                     01S1057 03183000
*      2 * PTR(31) INIT(0),                                     01S1057 03184000
*      2 * FIXED(15) INIT(53),                                  01S1057 03185000
*      2 * BIT(16) INIT('8000'X),                               01S1057 03186000
*      2 * CHAR(49) INIT(                                       01S1057 03187000
*            'IAP012I XXX NO ''TESTDD'' DD CARD, TESTING BYPASSED'),    03188000
*      2 * BIT(32) INIT('10001000'X);/* DESC=4, ROUT=4               */ 03189000
*   DCL                                                         01S1058 03190000
*     1 CNMSG13 LOCAL,                                          01S1058 03191000
*      2 * FIXED(8) INIT(0),                                    01S1058 03192000
*      2 * PTR(24) INIT(0),                                     01S1058 03193000
*      2 * PTR(31) INIT(0),                                     01S1058 03194000
*      2 * FIXED(15) INIT(59),                                  01S1058 03195000
*      2 * BIT(16) INIT('8000'X),                               01S1058 03196000
*      2 * CHAR(55) INIT(                                       01S1058 03197000
*            'IAP013I XXX UNABLE TO OPEN ''TESTDD'', TESTING TERMINATED 03198000
*            ),                                                 01S1058 03199000
*      2 * BIT(32) INIT('10001000'X);/* DESC=4, ROUT=4               */ 03200000
*   DCL                                                         01S1059 03201000
*     1 CNMSG14 LOCAL,                                          01S1059 03202000
*      2 * FIXED(8) INIT(0),                                    01S1059 03203000
*      2 * PTR(24) INIT(0),                                     01S1059 03204000
*      2 * PTR(31) INIT(0),                                     01S1059 03205000
*      2 * FIXED(15) INIT(57),                                  01S1059 03206000
*      2 * BIT(16) INIT('8000'X),                               01S1059 03207000
*      2 * CHAR(53) INIT(                                       01S1059 03208000
*            'IAP014I XXX INCORRECT DEVICE TYPE, TESTING TERMINATED'),  03209000
*      2 * BIT(32) INIT('10001000'X);/* DESC=4, ROUT=4               */ 03210000
*   DCL                                                         01S1060 03211000
*     1 CNMSG15 LOCAL,                                          01S1060 03212000
*      2 * FIXED(8) INIT(0),                                    01S1060 03213000
*      2 * PTR(24) INIT(0),                                     01S1060 03214000
*      2 * PTR(31) INIT(0),                                     01S1060 03215000
*      2 * FIXED(15) INIT(46),                                  01S1060 03216000
*      2 * BIT(16) INIT('8000'X),                               01S1060 03217000
*      2 * CHAR(42) INIT('IAP015I XXX DATA VERIFICATION TEST STARTED'), 03218000
*      2 * BIT(32) INIT('10001000'X);/* DESC=4, ROUT=4               */ 03219000
*   DCL                                                         01S1061 03220000
*     1 CNMSG16 LOCAL,                                          01S1061 03221000
*      2 * FIXED(8) INIT(0),                                    01S1061 03222000
*      2 * PTR(24) INIT(0),                                     01S1061 03223000
*      2 * PTR(31) INIT(0),                                     01S1061 03224000
*      2 * FIXED(15) INIT(61),                                  01S1061 03225000
*      2 * BIT(16) INIT('8000'X),                               01S1061 03226000
*      2 * CHAR(57) INIT(                                       01S1061 03227000
*            'IAP016I XXX WRITE INHIBIT SWITCH ON, WRITE TESTS BYPASSED 03228000
*            ),                                                 01S1061 03229000
*      2 * BIT(32) INIT('10001000'X);/* DESC=4, ROUT=4               */ 03230000
*   DCL                                                         01S1062 03231000
*     1 CNMSG17 LOCAL,                                          01S1062 03232000
*      2 * FIXED(8) INIT(0),                                    01S1062 03233000
*      2 * PTR(24) INIT(0),                                     01S1062 03234000
*      2 * PTR(31) INIT(0),                                     01S1062 03235000
*      2 * FIXED(15) INIT(52),                                  01S1062 03236000
*      2 * BIT(16) INIT('8000'X),                               01S1062 03237000
*      2 * CHAR(48) INIT(                                       01S1062 03238000
*            'IAP017I XXX DEVICE NOT READY, TESTING TERMINATED'),       03239000
*      2 * BIT(32) INIT('10001000'X);/* DESC=4, ROUT=4               */ 03240000
*                                                               01S1062 03241000
*   /*****************************************************************/ 03242000
*   /*                                                               */ 03243000
*   /* PRINTER MESSAGES                                              */ 03244000
*   /*                                                               */ 03245000
*   /*****************************************************************/ 03246000
*                                                               01S1063 03247000
*   DCL                                                         01S1063 03248000
*     HEADER CHAR(110) INIT('         A P 1    A N A L Y S I S  P R O G 03249000
*R A M   O N E                                       PAGE');/* PAGE     03250000
*                                      HEADER                        */ 03251000
*   DCL                                                         01S1064 03252000
*     1 PRMSG01 LOCAL,                                          01S1064 03253000
*      2 * FIXED(15) INIT(60),                                  01S1064 03254000
*      2 * CHAR(60) INIT(                                       01S1064 03255000
*'           M O V E A B L E   H E A D   E R R O R   T A B L E');       03256000
*   DCL                                                         01S1065 03257000
*     1 PRMSG02 LOCAL,                                          01S1065 03258000
*      2 * FIXED(15) INIT(77),                                  01S1065 03259000
*      2 * CHAR(77) INIT('      HEAD NUMBER  DATA CHK   SEEK VERIFY   W 03260000
*ITE CHK   DATA CHK    DATA COMP');                             01S1065 03261000
*   DCL                                                         01S1066 03262000
*     1 PRMSG03 LOCAL,                                          01S1066 03263000
*      2 * FIXED(15) INIT(75),                                  01S1066 03264000
*      2 * CHAR(75) INIT('                                 CHECK        03265000
*            CE CYL      ERROR');                               01S1066 03266000
*   DCL                                                         01S1067 03267000
*     1 PRMSG04 LOCAL,                                          01S1067 03268000
*      2 * FIXED(15) INIT(53),                                  01S1067 03269000
*      2 * CHAR(53) INIT(                                       01S1067 03270000
*            '          F I X E D   H E A D   E R R O R   T A B L E');  03271000
*   DCL                                                         01S1068 03272000
*     1 PRMSG05 LOCAL,                                          01S1068 03273000
*      2 * FIXED(15) INIT(83),                                  01S1068 03274000
*      2 * CHAR(83) INIT('      HEAD NUMBER  DATA CHECK   SEEK VERIFY   03275000
*HEAD NUMBER  DATA CHECK   SEEK VERIFY');                       01S1068 03276000
*   DCL                                                         01S1069 03277000
*     1 PRMSG06 LOCAL,                                          01S1069 03278000
*      2 * FIXED(15) INIT(80),                                  01S1069 03279000
*      2 * CHAR(80) INIT('                                   CHECK      03280000
*                             CHECK');                          01S1069 03281000
*   DCL                                                         01S1070 03282000
*     1 PRMSG07 LOCAL,                                          01S1070 03283000
*      2 * FIXED(15) INIT(8),                                   01S1070 03284000
*      2 * CHAR(8) INIT('SNS TEST');                            01S1070 03285000
*   DCL                                                         01S1071 03286000
*     1 PRMSG08 LOCAL,                                          01S1071 03287000
*      2 * FIXED(15) INIT(10),                                  01S1071 03288000
*      2 * CHAR(10) INIT('RECAL TEST');                         01S1071 03289000
*   DCL                                                         01S1072 03290000
*     1 PRMSG09 LOCAL,                                          01S1072 03291000
*      2 * FIXED(15) INIT(10),                                  01S1072 03292000
*      2 * CHAR(10) INIT('RHAMH TEST');                         01S1072 03293000
*   DCL                                                         01S1073 03294000
*     1 PRMSG10 LOCAL,                                          01S1073 03295000
*      2 * FIXED(15) INIT(10),                                  01S1073 03296000
*      2 * CHAR(10) INIT('RHAFH TEST');                         01S1073 03297000
*   DCL                                                         01S1074 03298000
*     1 PRMSG11 LOCAL,                                          01S1074 03299000
*      2 * FIXED(15) INIT(10),                                  01S1074 03300000
*      2 * CHAR(10) INIT('SK192 TEST');                         01S1074 03301000
*   DCL                                                         01S1075 03302000
*     1 PRMSG12 LOCAL,                                          01S1075 03303000
*      2 * FIXED(15) INIT(11),                                  01S1075 03304000
*      2 * CHAR(11) INIT('SKINCR TEST');                        01S1075 03305000
*   DCL                                                         01S1076 03306000
*     1 PRMSG13 LOCAL,                                          01S1076 03307000
*      2 * FIXED(15) INIT(10),                                  01S1076 03308000
*      2 * CHAR(10) INIT('SKMAX TEST');                         01S1076 03309000
*   DCL                                                         01S1077 03310000
*     1 PRMSG14 LOCAL,                                          01S1077 03311000
*      2 * FIXED(15) INIT(10),                                  01S1077 03312000
*      2 * CHAR(10) INIT('SKRAN TEST');                         01S1077 03313000
*   DCL                                                         01S1078 03314000
*     1 PRMSG15 LOCAL,                                          01S1078 03315000
*      2 * FIXED(15) INIT(8),                                   01S1078 03316000
*      2 * CHAR(8) INIT('RHA TEST');                            01S1078 03317000
*   DCL                                                         01S1079 03318000
*     1 PRMSG16 LOCAL,                                          01S1079 03319000
*      2 * FIXED(15) INIT(8),                                   01S1079 03320000
*      2 * CHAR(8) INIT('WRT TEST');                            01S1079 03321000
*   DCL                                                         01S1080 03322000
*     1 PRMSG17 LOCAL,                                          01S1080 03323000
*      2 * FIXED(15) INIT(9),                                   01S1080 03324000
*      2 * CHAR(9) INIT('RR01 TEST');                           01S1080 03325000
*   DCL                                                         01S1081 03326000
*     1 PRMSG18 LOCAL,                                          01S1081 03327000
*      2 * FIXED(15) INIT(58),                                  01S1081 03328000
*      2 * CHAR(58) INIT(                                       01S1081 03329000
*'RR01 DATA COMPARE ERROR--EXP =                       REC ='); 01S1081 03330000
*   DCL                                                         01S1082 03331000
*     1 PRMSG19 LOCAL,                                          01S1082 03332000
*      2 * FIXED(15) INIT(9),                                   01S1082 03333000
*      2 * CHAR(9) INIT('RDMT TEST');                           01S1082 03334000
*   DCL                                                         01S1083 03335000
*     1 PRMSG20 LOCAL,                                          01S1083 03336000
*      2 * FIXED(15) INIT(58),                                  01S1083 03337000
*      2 * CHAR(58) INIT(                                       01S1083 03338000
*'RDMT DATA COMPARE ERROR--EXP =                       REC ='); 01S1083 03339000
*   DCL                                                         01S1084 03340000
*     1 PRMSG21 LOCAL,                                          01S1084 03341000
*      2 * FIXED(15) INIT(10),                                  01S1084 03342000
*      2 * CHAR(10) INIT('FTWRT TEST');                         01S1084 03343000
*   DCL                                                         01S1085 03344000
*     1 PRMSG22 LOCAL,                                          01S1085 03345000
*      2 * FIXED(15) INIT(10),                                  01S1085 03346000
*      2 * CHAR(10) INIT('AMDET TEST');                         01S1085 03347000
*   DCL                                                         01S1086 03348000
*     1 PRMSG23 LOCAL,                                          01S1086 03349000
*      2 * FIXED(15) INIT(59),                                  01S1086 03350000
*      2 * CHAR(59) INIT(                                       01S1086 03351000
*'AMDET DATA COMPARE ERROR--EXP =                       REC =');        03352000
*   DCL                                                         01S1087 03353000
*     1 PRMSG24 LOCAL,                                          01S1087 03354000
*      2 * FIXED(15) INIT(7),                                   01S1087 03355000
*      2 * CHAR(7) INIT('SD TEST');                             01S1087 03356000
*   DCL                                                         01S1088 03357000
*     1 PRMSG25 LOCAL,                                          01S1088 03358000
*      2 * FIXED(15) INIT(75),                                  01S1088 03359000
*      2 * CHAR(75) INIT('      FAILING CCW =                        CS 03360000
* =                      ECB =');                               01S1088 03361000
*   DCL                                                         01S1089 03362000
*     1 PRMSG26 LOCAL,                                          01S1089 03363000
*      2 * FIXED(15) INIT(11),                                  01S1089 03364000
*      2 * CHAR(11) INIT('      SNS =');                        01S1089 03365000
*   DCL                                                         01S1090 03366000
*     1 PRMSG27 LOCAL,                                          01S1090 03367000
*      2 * FIXED(15) INIT(27),                                  01S1090 03368000
*      2 * CHAR(27) INIT('WRT WRITE INHIBIT SWITCH ON');        01S1090 03369000
*   DCL                                                         01S1091 03370000
*     1 PRMSG28 LOCAL,                                          01S1091 03371000
*      2 * FIXED(15) INIT(11),                                  01S1091 03372000
*      2 * CHAR(11) INIT('WRTPAD TEST');                        01S1091 03373000
*   DCL                                                         01S1092 03374000
*     1 PRMSG29 LOCAL,                                          01S1092 03375000
*      2 * FIXED(15) INIT(59),                                  01S1092 03376000
*      2 * CHAR(59) INIT(                                       01S1092 03377000
*'WRTPAD READ WRONG RECORD--EXP =                       REC =');        03378000
*   DCL                                                         01S1093 03379000
*     1 PRMSG30 LOCAL,                                          01S1093 03380000
*      2 * FIXED(15) INIT(38),                                  01S1093 03381000
*      2 * CHAR(38) INIT('DATAVER DATA CHECKS EXCEEDED THRESHOLD');     03382000
*   DCL                                                         01S1094 03383000
*     1 PRMSG31 LOCAL,                                          01S1094 03384000
*      2 * FIXED(15) INIT(25),                                  01S1094 03385000
*      2 * CHAR(25) INIT('DATAVER DATA CHECK CCHH =');          01S1094 03386000
*   DCL                                                         01S1095 03387000
*     1 PRMSG32 LOCAL,                                          01S1095 03388000
*      2 * FIXED(15) INIT(12),                                  01S1095 03389000
*      2 * CHAR(12) INIT('DATAVER TEST');                       01S1095 03390000
*   DCL                                                         01S1096 03391000
*     1 PRMSG33 LOCAL,                                          01S1096 03392000
*      2 * FIXED(15) INIT(12),                                  01S1096 03393000
*      2 * CHAR(12) INIT('CLEANUP TEST');                       01S1096 03394000
*   DCL                                                         01S1097 03395000
*     1 PRMSG34 LOCAL,                                          01S1097 03396000
*      2 * FIXED(15) INIT(40),                                  01S1097 03397000
*      2 * CHAR(40) INIT('RHA HA INCORRECT -- EXP=            REC=');   03398000
*   DCL                                                         01S1098 03399000
*     1 PRMSG35 LOCAL,                                          01S1098 03400000
*      2 * FIXED(15) INIT(39),                                  01S1098 03401000
*      2 * CHAR(39) INIT('DATAVER DATA FORMAT UNACCEPTABLE ON CYL');    03402000
*   DCL                                                         01S1099 03403000
*     1 PRMSG36 LOCAL,                                          01S1099 03404000
*      2 * FIXED(15) INIT(8),                                   01S1099 03405000
*      2 * CHAR(8) INIT('RPS TEST');                            01S1099 03406000
         EJECT                                                          03407000
*                                                               01S1100 03408000
*   /*****************************************************************/ 03409000
*   /*                                                               */ 03410000
*   /* DETERMINE IF CONSOLE OR PRINTER REQUEST                       */ 03411000
*   /*                                                               */ 03412000
*   /*****************************************************************/ 03413000
*                                                               01S1100 03414000
*   IF AP1CNCODÂ¬=0 THEN             /* CONSOLE REQUEST               */ 03415000
*                                                               01S1100 03416000
         CLI   AP1CNCOD(AP1REG),0                               01S1100 03417000
         BE    @RF01100                                         01S1100 03418000
*     /***************************************************************/ 03419000
*     /*                                                             */ 03420000
*     /* REQUEST FOR CONSOLE                                         */ 03421000
*     /*                                                             */ 03422000
*     /***************************************************************/ 03423000
*                                                               01S1101 03424000
*     DO;                                                       01S1101 03425000
*                                                               01S1101 03426000
*       /*************************************************************/ 03427000
*       /*                                                           */ 03428000
*       /* PUT CONSOLE MESSAGE IN WORK AREA                          */ 03429000
*       /*                                                           */ 03430000
*       /*************************************************************/ 03431000
*                                                               01S1102 03432000
*       CNMSGXX=CNMSGPTR(AP1CNCOD)->CNMSGXX;/* MOVE IT IN            */ 03433000
         L     @09,AP1WRKA(,AP1REG)                             01S1102 03434000
         SLR   @06,@06                                          01S1102 03435000
         IC    @06,AP1CNCOD(,AP1REG)                            01S1102 03436000
         SLA   @06,2                                            01S1102 03437000
         L     @06,CNMSGPTR-4(@06)                              01S1102 03438000
         MVC   CNMSGXX(80,@09),CNMSGXX(@06)                     01S1102 03439000
*       CALL CONS;                  /* WTO-WTOR                      */ 03440000
         BAL   @14,CONS                                         01S1103 03441000
*       IF AP1PROPN=ON THEN         /* PRINTER OPEN                  */ 03442000
         TM    AP1PROPN(AP1REG),B'10000000'                     01S1104 03443000
         BNO   @RF01104                                         01S1104 03444000
*         DO;                       /* SEND CONSOLE MESSAGE TO SYSOUT*/ 03445000
*           AP1PRMSG=CNMSGXXT(1:CNMSGXXL-4);/* MOVE CONSOLE MESSAGE     03446000
*                                      TO PRINT BUFFER               */ 03447000
         MVI   AP1PRMSG+1(AP1REG),C' '                          01S1106 03448000
         MVC   AP1PRMSG+2(128,AP1REG),AP1PRMSG+1(AP1REG)        01S1106 03449000
         L     @09,AP1WRKA(,AP1REG)                             01S1106 03450000
         LH    @06,CNMSGXXL(,@09)                               01S1106 03451000
         SL    @06,@CF00085                                     01S1106 03452000
         EX    @06,@SM03874                                     01S1106 03453000
*           CALL PRINT;             /* PRINT MESSAGE                 */ 03454000
         BAL   @14,PRINT                                        01S1107 03455000
*           IF MSGRLENÂ¬=0 THEN      /* WTOR                          */ 03456000
         L     @09,AP1WRKA(,AP1REG)                             01S1108 03457000
         CLI   MSGRLEN(@09),0                                   01S1108 03458000
         BE    @RF01108                                         01S1108 03459000
*             DO;                                               01S1109 03460000
*               AP1PRMSG=AP1CNRPL;  /* MOVE REPLY TO PRINT BUFFER    */ 03461000
         MVI   AP1PRMSG+4(AP1REG),C' '                          01S1110 03462000
         MVC   AP1PRMSG+5(125,AP1REG),AP1PRMSG+4(AP1REG)        01S1110 03463000
         MVC   AP1PRMSG(4,AP1REG),AP1CNRPL(AP1REG)              01S1110 03464000
*               CALL PRINT;         /* PRINT REPLY                   */ 03465000
         BAL   @14,PRINT                                        01S1111 03466000
*             END;                                              01S1112 03467000
*           ELSE                                                01S1113 03468000
*             ;                                                 01S1113 03469000
@RF01108 DS    0H                                               01S1114 03470000
*         END;                                                  01S1114 03471000
*       ELSE                                                    01S1115 03472000
*         ;                                                     01S1115 03473000
@RF01104 DS    0H                                               01S1116 03474000
*       AP1CNCOD=0;                 /* RESET                         */ 03475000
         MVI   AP1CNCOD(AP1REG),X'00'                           01S1116 03476000
*     END;                                                      01S1117 03477000
*   ELSE                            /* PRINTER REQUEST               */ 03478000
*     DO;                                                       01S1118 03479000
*                                                               01S1118 03480000
         B     @RC01100                                         01S1118 03481000
@RF01100 DS    0H                                               01S1119 03482000
*       /*************************************************************/ 03483000
*       /*                                                           */ 03484000
*       /* REQUEST FOR PRINTER                                       */ 03485000
*       /*                                                           */ 03486000
*       /*************************************************************/ 03487000
*                                                               01S1119 03488000
*       IF AP1PRCODÂ¬=0 THEN         /* PRINT REQUEST                 */ 03489000
*                                                               01S1119 03490000
         CLI   AP1PRCOD(AP1REG),0                               01S1119 03491000
         BE    @RF01119                                         01S1119 03492000
*         /***********************************************************/ 03493000
*         /*                                                         */ 03494000
*         /* MOVE IN PRINT MESSAGE                                   */ 03495000
*         /*                                                         */ 03496000
*         /***********************************************************/ 03497000
*                                                               01S1120 03498000
*         AP1PRMSG(1:PRMSGPTR(AP1PRCOD)->PRMSGXXL)=AP1PRMSG|PRMSGPTR(   03499000
*             AP1PRCOD)->PRMSGXXT;  /* OR IN TEXT                    */ 03500000
         SLR   @09,@09                                          01S1120 03501000
         IC    @09,AP1PRCOD(,AP1REG)                            01S1120 03502000
         SLA   @09,2                                            01S1120 03503000
         L     @09,PRMSGPTR-4(@09)                              01S1120 03504000
         LH    @06,PRMSGXXL(,@09)                               01S1120 03505000
         BCTR  @06,0                                            01S1120 03506000
         MVC   @TS00001(130),AP1PRMSG(AP1REG)                   01S1120 03507000
         OC    @TS00001(130),PRMSGXXT(@09)                      01S1120 03508000
         EX    @06,@SM03876                                     01S1120 03509000
*       ELSE                                                    01S1121 03510000
*         ;                         /* NEWPAGE OR CLOSE REQUEST      */ 03511000
@RF01119 DS    0H                                               01S1122 03512000
*       CALL PRINT;                 /* PRINT, NEW PAGE, OR CLOSE     */ 03513000
         BAL   @14,PRINT                                        01S1122 03514000
*       AP1PRCOD=0;                 /* RESET                         */ 03515000
         MVI   AP1PRCOD(AP1REG),X'00'                           01S1123 03516000
*       IF AP1CNCOD=MSOF THEN       /* OPEN REQUEST THAT FAILED      */ 03517000
         CLI   AP1CNCOD(AP1REG),11                              01S1124 03518000
         BNE   @RF01124                                         01S1124 03519000
*         DO;                                                   01S1125 03520000
*           CNMSGXX=CNMSGPTR(MSOF)->CNMSGXX;/* MOVE IN MESSAGE       */ 03521000
         L     @09,AP1WRKA(,AP1REG)                             01S1126 03522000
         L     @06,CNMSGPTR+40                                  01S1126 03523000
         MVC   CNMSGXX(80,@09),CNMSGXX(@06)                     01S1126 03524000
*           CALL CONS;              /* TELL OPR PRINT WOULDNT OPEN   */ 03525000
         BAL   @14,CONS                                         01S1127 03526000
*           AP1CNCOD=0;             /* RESET                         */ 03527000
         MVI   AP1CNCOD(AP1REG),X'00'                           01S1128 03528000
*         END;                                                  01S1129 03529000
*       ELSE                                                    01S1130 03530000
*         ;                         /* EVERYTHING OK                 */ 03531000
@RF01124 DS    0H                                               01S1131 03532000
*     END;                                                      01S1131 03533000
         EJECT                                                          03534000
*                                                               01S1132 03535000
*   /*****************************************************************/ 03536000
*   /*                                                               */ 03537000
*   /* CONS: PROCEDURE                                               */ 03538000
*   /*                                                               */ 03539000
*   /*****************************************************************/ 03540000
*                                                               01S1132 03541000
*CONS:                                                          01S1132 03542000
*   PROC;                           /* INTERNAL TO COMM PROC         */ 03543000
*                                                               01S1132 03544000
         B     @PB00007                                         01S1132 03545000
CONS     STM   @14,@12,@SA00007                                 01S1132 03546000
*   /*****************************************************************/ 03547000
*   /*                                                               */ 03548000
*   /* THIS PROC SENDS MESSAGES TO THE CONSOLE AND PASSES THE REPLIES*/ 03549000
*   /* TO THE CALLER. THERE ARE TWO TYPES OF MESSAGES IT HANDLES: WTO*/ 03550000
*   /* AND WTOR. THE WTO IS JUST PRINTED TO THE CONSOLE. THE WTOR IS */ 03551000
*   /* PRINTED TO THE CONSOLE AND A REPLY IS WAITED FOR.             */ 03552000
*   /*                                                               */ 03553000
*   /*****************************************************************/ 03554000
*                                                               01S1133 03555000
*                                                               01S1133 03556000
*   /*****************************************************************/ 03557000
*   /*                                                               */ 03558000
*   /* FINISH MESSAGE                                                */ 03559000
*   /*                                                               */ 03560000
*   /*****************************************************************/ 03561000
*                                                               01S1133 03562000
*   MSGDEVAD=AP1DEVAD(2:4);         /* MOVE DEVICE ADDRESS TO WORK      03563000
*                                      AREA                          */ 03564000
*                                                               01S1133 03565000
         L     @09,AP1WRKA(,AP1REG)                             01S1133 03566000
         MVI   MSGDEVAD+3(@09),C' '                             01S1133 03567000
         MVC   MSGDEVAD(3,@09),AP1DEVAD+1(AP1REG)               01S1133 03568000
*   /*****************************************************************/ 03569000
*   /*                                                               */ 03570000
*   /* DETERMINE IF WTO OR WTOR                                      */ 03571000
*   /*                                                               */ 03572000
*   /*****************************************************************/ 03573000
*                                                               01S1134 03574000
*   IF MSGRLEN=0 THEN               /* ISSUE WTO                     */ 03575000
         CLI   MSGRLEN(@09),0                                   01S1134 03576000
         BNE   @RF01134                                         01S1134 03577000
*     DO;                                                       01S1135 03578000
*       RFY                                                     01S1136 03579000
*        (GPR01P) RSTD;                                         01S1136 03580000
*       GPR01P=ADDR(CNMSGXXL);      /* POINT TO BEGIN OF WTO         */ 03581000
*                                                               01S1137 03582000
         LA    GPR01P,CNMSGXXL(,@09)                            01S1137 03583000
*       /*************************************************************/ 03584000
*       /*                                                           */ 03585000
*       /* WTO                                                       */ 03586000
*       /*                                                           */ 03587000
*       /*************************************************************/ 03588000
*                                                               01S1138 03589000
*       GENERATE;                                               01S1138 03590000
         WTO   MF=(E,(GPR01P))   WTO SELECTED MESSAGE                   03591000
*       RFY                                                     01S1139 03592000
*        (GPR01P) UNRSTD;                                       01S1139 03593000
*     END;                                                      01S1140 03594000
*   ELSE                            /* ISSUE WTOR                    */ 03595000
*     DO;                                                       01S1141 03596000
         B     @RC01134                                         01S1141 03597000
@RF01134 DS    0H                                               01S1142 03598000
*       AP1RECB=0;                  /* CLEAR ECB                     */ 03599000
         SLR   @09,@09                                          01S1142 03600000
         ST    @09,AP1RECB(,AP1REG)                             01S1142 03601000
*       MSGECBA=ADDR(AP1RECB);      /* POINT TO ECB                  */ 03602000
         L     @09,AP1WRKA(,AP1REG)                             01S1143 03603000
         LA    @06,AP1RECB(,AP1REG)                             01S1143 03604000
         ST    @06,MSGECBA(,@09)                                01S1143 03605000
*       MSGRPTR=ADDR(AP1CNRPL);     /* ADDRESS OF REPLY AREA         */ 03606000
         LA    @06,AP1CNRPL(,AP1REG)                            01S1144 03607000
         STCM  @06,7,MSGRPTR(@09)                               01S1144 03608000
*       RFY                                                     01S1145 03609000
*         GPR01P RSTD;                                          01S1145 03610000
*       GPR01P=ADDR(CNMSGXX);       /* POINT TO BEGIN OF WTOR        */ 03611000
*                                                               01S1146 03612000
         LR    GPR01P,@09                                       01S1146 03613000
*       /*************************************************************/ 03614000
*       /*                                                           */ 03615000
*       /* WTOR                                                      */ 03616000
*       /*                                                           */ 03617000
*       /*************************************************************/ 03618000
*                                                               01S1147 03619000
*       GENERATE;                                               01S1147 03620000
         WTOR  ,,,,MF=(E,(GPR01P)) WTOR SELECTED MESSAGE                03621000
*       RFY                                                     01S1148 03622000
*         GPR01P UNRSTD;                                        01S1148 03623000
*                                                               01S1148 03624000
*       /*************************************************************/ 03625000
*       /*                                                           */ 03626000
*       /* WAIT ON THE REPLY                                         */ 03627000
*       /*                                                           */ 03628000
*       /*************************************************************/ 03629000
*                                                               01S1149 03630000
*       DO;                         /* WAIT ECB(AP1RECB)             */ 03631000
*         RESPECIFY                                             01S1150 03632000
*          (GPR00P,                                             01S1150 03633000
*           GPR01P) RESTRICTED;                                 01S1150 03634000
*         GPR00P=1;                 /* LOAD WAIT COUNT               */ 03635000
         LA    GPR00P,1                                         01S1151 03636000
*         GPR01P=ADDR(AP1RECB);     /* ADDRESS OF ECB                */ 03637000
         LA    GPR01P,AP1RECB(,AP1REG)                          01S1152 03638000
*         SVC(1);                   /* WAIT SVC                      */ 03639000
         SVC   1                                                01S1153 03640000
*         RESPECIFY                                             01S1154 03641000
*          (GPR00P,                                             01S1154 03642000
*           GPR01P) UNRESTRICTED;                               01S1154 03643000
*       END;                        /* WAIT ECB(AP1RECB) FOR THE        03644000
*                                      REPLY                         */ 03645000
*     END;                                                      01S1156 03646000
*   END;                            /* OF CONS PROC                  */ 03647000
@EL00007 DS    0H                                               01S1157 03648000
@EF00007 DS    0H                                               01S1157 03649000
@ER00007 LM    @14,@12,@SA00007                                 01S1157 03650000
         BR    @14                                              01S1157 03651000
         EJECT                                                          03652000
*                                                               01S1158 03653000
*   /*****************************************************************/ 03654000
*   /*                                                               */ 03655000
*   /* PRINT: PROCEDURE                                              */ 03656000
*   /*                                                               */ 03657000
*   /*****************************************************************/ 03658000
*                                                               01S1158 03659000
*PRINT:                                                         01S1158 03660000
*   PROC;                           /* INTERNAL TO COMM PROC         */ 03661000
*                                                               01S1158 03662000
PRINT    STM   @14,@12,@SA00008                                 01S1158 03663000
*   /*****************************************************************/ 03664000
*   /*                                                               */ 03665000
*   /* THIS PROC PRINTS MESSAGES TO SYSPRINT-- IT IS PASSED AP1PRCLS */ 03666000
*   /* (INDICATES CLOSE REQUEST), AP1PRMSG (THE ACTUAL MESSAGE), AND */ 03667000
*   /* AP1PRNP (INDICATES GO TO NEW PAGE). IT PRINTS 55 LINES TO A   */ 03668000
*   /* PAGE UNLESS TOLD TO GO TO A NEW PAGE BEFORE 55 LINES. EACH    */ 03669000
*   /* PAGE HAS A HEADER WITH THE PAGE NUMBER IN IT.                 */ 03670000
*   /*                                                               */ 03671000
*   /*****************************************************************/ 03672000
*                                                               01S1159 03673000
*   IF AP1PRCLS=ON THEN             /* CLOSE REQUEST                 */ 03674000
*                                                               01S1159 03675000
         TM    AP1PRCLS(AP1REG),B'00100000'                     01S1159 03676000
         BNO   @RF01159                                         01S1159 03677000
*     /***************************************************************/ 03678000
*     /*                                                             */ 03679000
*     /* CLOSE REQUEST                                               */ 03680000
*     /*                                                             */ 03681000
*     /***************************************************************/ 03682000
*                                                               01S1160 03683000
*     IF AP1PROPN=ON THEN           /* PRINT OPEN                    */ 03684000
         TM    AP1PROPN(AP1REG),B'10000000'                     01S1160 03685000
         BNO   @RF01160                                         01S1160 03686000
*       DO;                                                     01S1161 03687000
*         AP1PROPN=OFF;             /* WILL CLOSE                    */ 03688000
         NI    AP1PROPN(AP1REG),B'01111111'                     01S1162 03689000
*         RFY                                                   01S1163 03690000
*          (GPR01P,                                             01S1163 03691000
*           GPR02P) RSTD;                                       01S1163 03692000
*         GPR01P=AP1WRKA;           /* PUT PARM ADDR IN REG 1        */ 03693000
         L     @09,AP1WRKA(,AP1REG)                             01S1164 03694000
         LR    GPR01P,@09                                       01S1164 03695000
*         WRKFLG(1)=0;              /* ZERO FLAGS                    */ 03696000
         MVI   WRKFLG(@09),X'00'                                01S1165 03697000
*         WRKENDFL(1)=ON;           /* END OF LIST                   */ 03698000
         OI    WRKENDFL(@09),B'10000000'                        01S1166 03699000
*         GPR02P=AP1PDCBA;          /* PRINT DCB ADDRESS             */ 03700000
*                                                               01S1167 03701000
         L     GPR02P,AP1PDCBA(,AP1REG)                         01S1167 03702000
*         /***********************************************************/ 03703000
*         /*                                                         */ 03704000
*         /* CLOSE                                                   */ 03705000
*         /*                                                         */ 03706000
*         /***********************************************************/ 03707000
*                                                               01S1168 03708000
*         GENERATE;                                             01S1168 03709000
         CLOSE ((GPR02P)),MF=(E,(GPR01P))                               03710000
*         RFY                                                   01S1169 03711000
*          (GPR01P,                                             01S1169 03712000
*           GPR02P) UNRSTD;                                     01S1169 03713000
*       END;                                                    01S1170 03714000
*     ELSE                                                      01S1171 03715000
*       ;                           /* NOT OPEN--CANT CLOSE          */ 03716000
@RF01160 DS    0H                                               01S1172 03717000
*   ELSE                            /* PRINT REQUEST                 */ 03718000
*                                                               01S1172 03719000
*     /***************************************************************/ 03720000
*     /*                                                             */ 03721000
*     /* PRINT OR NEW PAGE REQUEST                                   */ 03722000
*     /*                                                             */ 03723000
*     /***************************************************************/ 03724000
*                                                               01S1172 03725000
*     DO;                                                       01S1172 03726000
         B     @RC01159                                         01S1172 03727000
@RF01159 DS    0H                                               01S1173 03728000
*       IF AP1PROPN=OFF THEN        /* HAVENT YET OPENED             */ 03729000
         TM    AP1PROPN(AP1REG),B'10000000'                     01S1173 03730000
         BNZ   @RF01173                                         01S1173 03731000
*         DO;                                                   01S1174 03732000
*           RFY                                                 01S1175 03733000
*            (GPR01P,                                           01S1175 03734000
*             GPR02P) RSTD;                                     01S1175 03735000
*           GPR01P=AP1WRKA;         /* PUT PARM ADDR IN REG 1        */ 03736000
         L     @09,AP1WRKA(,AP1REG)                             01S1176 03737000
         LR    GPR01P,@09                                       01S1176 03738000
*           WRKFLG(1)=0;            /* ZERO FLAGS                    */ 03739000
         MVI   WRKFLG(@09),X'00'                                01S1177 03740000
*           WRKENDFL(1)=ON;         /* END OF LIST                   */ 03741000
         OI    WRKENDFL(@09),B'10000000'                        01S1178 03742000
*           GPR02P=AP1PDCBA;        /* PRINT DCB ADDRESS             */ 03743000
*                                                               01S1179 03744000
         L     GPR02P,AP1PDCBA(,AP1REG)                         01S1179 03745000
*           /*********************************************************/ 03746000
*           /*                                                       */ 03747000
*           /* OPEN                                                  */ 03748000
*           /*                                                       */ 03749000
*           /*********************************************************/ 03750000
*                                                               01S1180 03751000
*           GENERATE;                                           01S1180 03752000
         OPEN  ((GPR02P),(OUTPUT)),MF=(E,(GPR01P))                      03753000
*           RFY                                                 01S1181 03754000
*            (GPR01P,                                           01S1181 03755000
*             GPR02P) UNRSTD;                                   01S1181 03756000
*           RFY                                                 01S1182 03757000
*             IHADCB BASED(AP1PDCBA);/* ADDRESS PRINTER DCB          */ 03758000
*           IF DCBOFOPN=ON          /* CHECK OPENFLG                 */ 03759000
*             THEN                  /* OPEN WORKED                   */ 03760000
         L     @09,AP1PDCBA(,AP1REG)                            01S1183 03761000
         TM    DCBOFOPN+40(@09),B'00010000'                     01S1183 03762000
         BNO   @RF01183                                         01S1183 03763000
*             AP1PROPN=ON;          /* INDICATE SUCCESSFUL OPEN      */ 03764000
         OI    AP1PROPN(AP1REG),B'10000000'                     01S1184 03765000
*           ELSE                    /* OPEN FAILED                   */ 03766000
*             DO;                                               01S1185 03767000
         B     @RC01183                                         01S1185 03768000
@RF01183 DS    0H                                               01S1186 03769000
*               AP1CNCOD=MSOF;      /* SETUP FOR 'OPEN FAILED' MSG   */ 03770000
         MVI   AP1CNCOD(AP1REG),X'0B'                           01S1186 03771000
*               AP1QUIT=ON;         /* DONT DO ANY TESTS             */ 03772000
         OI    AP1QUIT(AP1REG),B'00001000'                      01S1187 03773000
*             END;                                              01S1188 03774000
*           RFY                                                 01S1189 03775000
*             IHADCB;               /* ADDRESS TEST DCB              */ 03776000
@RC01183 DS    0H                                               01S1190 03777000
*         END;                                                  01S1190 03778000
*       ELSE                                                    01S1191 03779000
*         ;                         /* OPEN                          */ 03780000
*                                                               01S1191 03781000
@RF01173 DS    0H                                               01S1192 03782000
*       /*************************************************************/ 03783000
*       /*                                                           */ 03784000
*       /* CONTINUE IF OPEN                                          */ 03785000
*       /*                                                           */ 03786000
*       /*************************************************************/ 03787000
*                                                               01S1192 03788000
*       IF AP1PROPN=ON THEN         /* OPEN                          */ 03789000
         TM    AP1PROPN(AP1REG),B'10000000'                     01S1192 03790000
         BNO   @RF01192                                         01S1192 03791000
*         DO;                                                   01S1193 03792000
*           IF AP1PRNP=ON THEN      /* NEW PAGE REQUEST              */ 03793000
*                                                               01S1194 03794000
         TM    AP1PRNP(AP1REG),B'01000000'                      01S1194 03795000
         BNO   @RF01194                                         01S1194 03796000
*             /*******************************************************/ 03797000
*             /*                                                     */ 03798000
*             /* NEW PAGE REQUEST                                    */ 03799000
*             /*                                                     */ 03800000
*             /*******************************************************/ 03801000
*                                                               01S1195 03802000
*             DO;                                               01S1195 03803000
*               AP1PRNP=OFF;        /* RESET                         */ 03804000
         NI    AP1PRNP(AP1REG),B'10111111'                      01S1196 03805000
*               IF AP1PRLINÂ¬=HDRLEN THEN/* NOT ALREADY ON NEW PAGE   */ 03806000
         CLC   AP1PRLIN(2,AP1REG),@CH00139                      01S1197 03807000
         BE    @RF01197                                         01S1197 03808000
*                 AP1PRLIN=PAGEFULL;/* INDICATE PAGE FULL            */ 03809000
         MVC   AP1PRLIN(2,AP1REG),@CH03120                      01S1198 03810000
*               ELSE                                            01S1199 03811000
*                 ;                 /* ON NEW PAGE ALREADY--IGNORE      03812000
*                                      REQUEST                       */ 03813000
@RF01197 DS    0H                                               01S1200 03814000
*             END;                                              01S1200 03815000
*           ELSE                    /* PRINT REQUEST                 */ 03816000
*                                                               01S1201 03817000
*             /*******************************************************/ 03818000
*             /*                                                     */ 03819000
*             /* VANILLA PRINT REQUEST                               */ 03820000
*             /*                                                     */ 03821000
*             /*******************************************************/ 03822000
*                                                               01S1201 03823000
*             DO;                                               01S1201 03824000
*                                                               01S1201 03825000
         B     @RC01194                                         01S1201 03826000
@RF01194 DS    0H                                               01S1202 03827000
*               /*****************************************************/ 03828000
*               /*                                                   */ 03829000
*               /* PUT RECORD TO PRINTER                             */ 03830000
*               /*                                                   */ 03831000
*               /*****************************************************/ 03832000
*                                                               01S1202 03833000
*               RFY                                             01S1202 03834000
*                (GPR00P,                                       01S1202 03835000
*                 GPR01P) RSTD;                                 01S1202 03836000
*               GPR00P=ADDR(AP1PRASA);/* BUFFER ADDRESS              */ 03837000
         LA    GPR00P,AP1PRASA(,AP1REG)                         01S1203 03838000
*               GPR01P=AP1PDCBA;    /* ADDRESS OF DCB                */ 03839000
         L     GPR01P,AP1PDCBA(,AP1REG)                         01S1204 03840000
*               GENERATE;                                       01S1205 03841000
         PUT   (GPR01P),(GPR00P) PRINT DCB                              03842000
*               RFY                                             01S1206 03843000
*                (GPR00P,                                       01S1206 03844000
*                 GPR01P) UNRSTD;                               01S1206 03845000
*               AP1PRLIN=AP1PRLIN+1;/* INCREMENT TO NEXT LINE        */ 03846000
         LA    @09,1                                            01S1207 03847000
         AH    @09,AP1PRLIN(,AP1REG)                            01S1207 03848000
         STH   @09,AP1PRLIN(,AP1REG)                            01S1207 03849000
*               AP1PRASA=' ';       /* PRINT NEXT LINE WITHOUT SPACE */ 03850000
         MVI   AP1PRASA(AP1REG),C' '                            01S1208 03851000
*             END;                                              01S1209 03852000
*           IF AP1PRLIN=PAGEFULL THEN/* GO TO NEW PAGE               */ 03853000
*                                                               01S1210 03854000
@RC01194 CLC   AP1PRLIN(2,AP1REG),@CH03120                      01S1210 03855000
         BNE   @RF01210                                         01S1210 03856000
*             /*******************************************************/ 03857000
*             /*                                                     */ 03858000
*             /* GO TO NEW PAGE                                      */ 03859000
*             /*                                                     */ 03860000
*             /*******************************************************/ 03861000
*                                                               01S1211 03862000
*             DO;                                               01S1211 03863000
*               AP1PRASA='1';       /* SKIP TO CHAN 1                */ 03864000
*                                                               01S1212 03865000
         MVI   AP1PRASA(AP1REG),C'1'                            01S1212 03866000
*               /*****************************************************/ 03867000
*               /*                                                   */ 03868000
*               /* BUILD PAGE HEADER                                 */ 03869000
*               /*                                                   */ 03870000
*               /*****************************************************/ 03871000
*                                                               01S1213 03872000
*               AP1PRMSG=HEADER;    /* MOVE IN HEADER                */ 03873000
         MVI   AP1PRMSG+110(AP1REG),C' '                        01S1213 03874000
         MVC   AP1PRMSG+111(19,AP1REG),AP1PRMSG+110(AP1REG)     01S1213 03875000
         MVC   AP1PRMSG(110,AP1REG),HEADER                      01S1213 03876000
*               AP1PRPAG=AP1PRPAG+1;/* INCR PAGE NUMBER              */ 03877000
         LA    @09,1                                            01S1214 03878000
         AH    @09,AP1PRPAG(,AP1REG)                            01S1214 03879000
         STH   @09,AP1PRPAG(,AP1REG)                            01S1214 03880000
*               CVD(AP1PRPAG,WRKAREA(1));/* CNVT PAGE TO DEC         */ 03881000
         L     @06,AP1WRKA(,AP1REG)                             01S1215 03882000
         CVD   @09,@TS00001                                     01S1215 03883000
         MVC   WRKAREA(4,@06),@TS00001+4                        01S1215 03884000
*               UNPK(AP1PRMSG(111:114),WRKAREA(1));/* UNPACK         */ 03885000
         UNPK  AP1PRMSG+110(4,AP1REG),WRKAREA(4,@06)            01S1216 03886000
*               AP1PRMSG(114)=AP1PRMSG(114)|ZONE;/* SET ZONE         */ 03887000
*                                                               01S1217 03888000
         OI    AP1PRMSG+113(AP1REG),X'F0'                       01S1217 03889000
*               /*****************************************************/ 03890000
*               /*                                                   */ 03891000
*               /* PUT RECORD TO PRINTER                             */ 03892000
*               /*                                                   */ 03893000
*               /*****************************************************/ 03894000
*                                                               01S1218 03895000
*               RFY                                             01S1218 03896000
*                (GPR00P,                                       01S1218 03897000
*                 GPR01P) RSTD;                                 01S1218 03898000
*               GPR00P=ADDR(AP1PRASA);/* BUFFER ADDRESS              */ 03899000
         LA    GPR00P,AP1PRASA(,AP1REG)                         01S1219 03900000
*               GPR01P=AP1PDCBA;    /* ADDRESS OF DCB                */ 03901000
         L     GPR01P,AP1PDCBA(,AP1REG)                         01S1220 03902000
*               GENERATE;                                       01S1221 03903000
         PUT   (GPR01P),(GPR00P) PRINT DCB                              03904000
*               RFY                                             01S1222 03905000
*                (GPR00P,                                       01S1222 03906000
*                 GPR01P) UNRSTD;                               01S1222 03907000
*               AP1PRASA='-';       /* SKIP TWO LINES                */ 03908000
         MVI   AP1PRASA(AP1REG),C'-'                            01S1223 03909000
*               AP1PRLIN=HDRLEN;    /* HAVE ACCOUNTED FOR 3 LINES    */ 03910000
         MVC   AP1PRLIN(2,AP1REG),@CH00139                      01S1224 03911000
*             END;                                              01S1225 03912000
*           ELSE                                                01S1226 03913000
*             ;                     /* DONT GO TO NEW PAGE           */ 03914000
@RF01210 DS    0H                                               01S1227 03915000
*         END;                                                  01S1227 03916000
*       ELSE                                                    01S1228 03917000
*         ;                         /* OPEN DIDNT WORK--OR CLOSE        03918000
*                                      REQUEST                       */ 03919000
*                                                               01S1228 03920000
@RF01192 DS    0H                                               01S1229 03921000
*       /*************************************************************/ 03922000
*       /*                                                           */ 03923000
*       /* INITIALIZE BUFFER FOR NEXT MESSAGE                        */ 03924000
*       /*                                                           */ 03925000
*       /*************************************************************/ 03926000
*                                                               01S1229 03927000
*       AP1PRMSG=' ';               /* CLEAR BUFFER                  */ 03928000
         MVI   AP1PRMSG+1(AP1REG),C' '                          01S1229 03929000
         MVC   AP1PRMSG+2(128,AP1REG),AP1PRMSG+1(AP1REG)        01S1229 03930000
         MVI   AP1PRMSG(AP1REG),C' '                            01S1229 03931000
*     END;                                                      01S1230 03932000
*   END;                            /* PROC                          */ 03933000
@EL00008 DS    0H                                               01S1231 03934000
@EF00008 DS    0H                                               01S1231 03935000
@ER00008 LM    @14,@12,@SA00008                                 01S1231 03936000
         BR    @14                                              01S1231 03937000
*   END;                            /* OF PROC                       */ 03938000
@EL00006 DS    0H                                               01S1232 03939000
@EF00006 DS    0H                                               01S1232 03940000
@ER00006 LM    @14,@12,@SA00006                                 01S1232 03941000
         BR    @14                                              01S1232 03942000
         EJECT                                                          03943000
*                                                               01S1233 03944000
*   /*****************************************************************/ 03945000
*   /*                                                               */ 03946000
*   /* READBLD1: PROCEDURE                                           */ 03947000
*   /*                                                               */ 03948000
*   /*****************************************************************/ 03949000
*                                                               01S1233 03950000
*READBLD1:                                                      01S1233 03951000
*   PROC;                                                       01S1233 03952000
*                                                               01S1233 03953000
READBLD1 STM   @14,@12,12(@13)                                  01S1233 03954000
*   /*****************************************************************/ 03955000
*   /*                                                               */ 03956000
*   /* BUILDS CCW CHAIN TO READ RECORDS EXCEPT RECORD ZERO FROM START*/ 03957000
*   /* OF A TRACK TO END OF CYLINDER                                 */ 03958000
*   /*                                                               */ 03959000
*   /*****************************************************************/ 03960000
*                                                               01S1234 03961000
*/*           CCW CHAIN:                                        01S1234 03962000
*                   RD HA,0,SKIP-CC,5      POSITION ON HA       01S1234 03963000
*                   MT-RD CNT,BUFF,CC,8    READ COUNT FOR RESTART       03964000
*                   RD KD,0,CC-SKIP-SLI,65535 CRC CHECK DATA    01S1234 03965000
*                   TIC,*-16,0,0           REPEAT UNTIL END OF CYL      03966000
*                                                                    */ 03967000
*                                                               01S1234 03968000
*   CCWPTR=1;                       /* FIRST SLOT                    */ 03969000
         LA    @09,1                                            01S1234 03970000
         LR    CCWPTR,@09                                       01S1234 03971000
*   CCW(CCWPTR)=RHACSCCW;           /* RHA,0,SKIP-CC,5               */ 03972000
         LR    @06,CCWPTR                                       01S1235 03973000
         SLA   @06,3                                            01S1235 03974000
         L     @03,AP1CCWA(,AP1REG)                             01S1235 03975000
         ALR   @06,@03                                          01S1235 03976000
         AL    @06,@CF03871                                     01S1235 03977000
         MVC   CCW(8,@06),RHACSCCW                              01S1235 03978000
*   CCWPTR=CCWPTR+1;                /* NEXT SLOT                     */ 03979000
         ALR   CCWPTR,@09                                       01S1236 03980000
*   CCW(CCWPTR)=MRCCCCCW;           /* MT-RDCNT,0,CC,8               */ 03981000
         LR    @06,CCWPTR                                       01S1237 03982000
         SLA   @06,3                                            01S1237 03983000
         ALR   @06,@03                                          01S1237 03984000
         AL    @06,@CF03871                                     01S1237 03985000
         MVC   CCW(8,@06),MRCCCCCW                              01S1237 03986000
*   CCWADDRB(CCWPTR)=AP1BUFAB;      /* READ INTO BUFFER              */ 03987000
         LR    @06,CCWPTR                                       01S1238 03988000
         SLA   @06,3                                            01S1238 03989000
         ALR   @06,@03                                          01S1238 03990000
         AL    @06,@CF03872                                     01S1238 03991000
         MVC   CCWADDRB-1(3,@06),AP1BUFAB(AP1REG)               01S1238 03992000
*   CCWPTR=CCWPTR+1;                /* NEXT SLOT                     */ 03993000
         ALR   CCWPTR,@09                                       01S1239 03994000
*   CCW(CCWPTR)=RKDSSCCW;           /* RKD,0,CC-SKIP-SLI,65535       */ 03995000
         LR    @06,CCWPTR                                       01S1240 03996000
         SLA   @06,3                                            01S1240 03997000
         ALR   @06,@03                                          01S1240 03998000
         AL    @06,@CF03871                                     01S1240 03999000
         MVC   CCW(8,@06),RKDSSCCW                              01S1240 04000000
*   CCWPTR=CCWPTR+1;                /* NEXT SLOT                     */ 04001000
         ALR   CCWPTR,@09                                       01S1241 04002000
*   CCW(CCWPTR)=TICCCW;             /* TIC,0,0,0                     */ 04003000
         LR    @09,CCWPTR                                       01S1242 04004000
         SLA   @09,3                                            01S1242 04005000
         ALR   @09,@03                                          01S1242 04006000
         AL    @09,@CF03871                                     01S1242 04007000
         MVC   CCW(8,@09),TICCCW                                01S1242 04008000
*   CCWADDRB(CCWPTR)=AP1CCWA+(CCWPTR-3)*LENGTH(CCW);/* TIC TO RD CNT */ 04009000
         LR    @09,CCWPTR                                       01S1243 04010000
         SLA   @09,3                                            01S1243 04011000
         LR    @06,CCWPTR                                       01S1243 04012000
         SL    @06,@CF00139                                     01S1243 04013000
         SLA   @06,3                                            01S1243 04014000
         ALR   @06,@03                                          01S1243 04015000
         ALR   @03,@09                                          01S1243 04016000
         AL    @03,@CF03872                                     01S1243 04017000
         STCM  @06,7,CCWADDRB-1(@03)                            01S1243 04018000
*   END;                            /* END OF PROC                   */ 04019000
@EL00009 DS    0H                                               01S1244 04020000
@EF00009 DS    0H                                               01S1244 04021000
@ER00009 LM    @14,@12,12(@13)                                  01S1244 04022000
         BR    @14                                              01S1244 04023000
         EJECT                                                          04024000
*                                                               01S1245 04025000
*   /*****************************************************************/ 04026000
*   /*                                                               */ 04027000
*   /* SNSCCHH: PROCEDURE                                            */ 04028000
*   /*                                                               */ 04029000
*   /*****************************************************************/ 04030000
*                                                               01S1245 04031000
*SNSCCHH:                                                       01S1245 04032000
*   PROC;                                                       01S1245 04033000
*                                                               01S1245 04034000
SNSCCHH  STM   @14,@12,12(@13)                                  01S1245 04035000
*   /*****************************************************************/ 04036000
*   /*                                                               */ 04037000
*   /* MOVES CCHH IN BYTES 5 & 6 OF SENSE DATA INTO CCHH IN AP1SEEK  */ 04038000
*   /*                                                               */ 04039000
*   /*****************************************************************/ 04040000
*                                                               01S1246 04041000
*   CCHH=0;                         /* CLEAR DESTINATION             */ 04042000
         SLR   @09,@09                                          01S1246 04043000
         ST    @09,CCHH(,AP1REG)                                01S1246 04044000
*   HH(2)=SNS6&HDMASK;              /* SET HEAD VALUE                */ 04045000
         LA    @09,188                                          01S1247 04046000
         ALR   @09,AP1REG                                       01S1247 04047000
         MVC   HH+1(1,AP1REG),SNS6(@09)                         01S1247 04048000
         NI    HH+1(AP1REG),X'1F'                               01S1247 04049000
*   CC(2)=SNS5;                     /* CYLINDER BYTE 2               */ 04050000
         MVC   CC+1(1,AP1REG),SNS5(@09)                         01S1248 04051000
*   IF AP1DEVTP=AP13330 THEN        /* 3330 MOD 1                    */ 04052000
         CLI   AP1DEVTP(AP1REG),1                               01S1249 04053000
         BNE   @RF01249                                         01S1249 04054000
*     IF SNSCYLB=ON THEN            /* CYLINDER 256                  */ 04055000
         TM    SNSCYLB(@09),B'01000000'                         01S1250 04056000
         BNO   @RF01250                                         01S1250 04057000
*       CC(1)='01'X;                /* SET CYLINDER 256              */ 04058000
         MVI   CC(AP1REG),X'01'                                 01S1251 04059000
*     ELSE                                                      01S1252 04060000
*       ;                           /* LESS THAN 256                 */ 04061000
@RF01250 DS    0H                                               01S1253 04062000
*   ELSE                            /* NOT 3330 MOD 1                */ 04063000
*     DO;                                                       01S1253 04064000
         B     @RC01249                                         01S1253 04065000
@RF01249 DS    0H                                               01S1254 04066000
*       IF SNSCYLB=ON THEN          /* CYLINDER 512                  */ 04067000
         TM    SNSCYLB+188(AP1REG),B'01000000'                  01S1254 04068000
         BNO   @RF01254                                         01S1254 04069000
*         CC(1)='02'X;              /* SET CYLINDER 512              */ 04070000
         MVI   CC(AP1REG),X'02'                                 01S1255 04071000
*       ELSE                                                    01S1256 04072000
*         ;                         /* SNSCYLB IS OFF                */ 04073000
@RF01254 DS    0H                                               01S1257 04074000
*       IF SNSCYLC=ON THEN          /* CYLINDER 256                  */ 04075000
         TM    SNSCYLC+188(AP1REG),B'00100000'                  01S1257 04076000
         BNO   @RF01257                                         01S1257 04077000
*         CC(1)=CC(1)|'01'X;        /* SET CYLINDER 256              */ 04078000
         OI    CC(AP1REG),X'01'                                 01S1258 04079000
*       ELSE                                                    01S1259 04080000
*         ;                         /* SNSCYLC IS OFF                */ 04081000
@RF01257 DS    0H                                               01S1260 04082000
*     END;                          /* END DO                        */ 04083000
*   END;                            /* END SNSCCHH PROC              */ 04084000
@EL00010 DS    0H                                               01S1261 04085000
@EF00010 DS    0H                                               01S1261 04086000
@ER00010 LM    @14,@12,12(@13)                                  01S1261 04087000
         BR    @14                                              01S1261 04088000
         EJECT                                                          04089000
*                                                               01S1262 04090000
*   /*****************************************************************/ 04091000
*   /*                                                               */ 04092000
*   /* UPDTCC: PROCEDURE                                             */ 04093000
*   /*                                                               */ 04094000
*   /*****************************************************************/ 04095000
*                                                               01S1262 04096000
*UPDTCC:                                                        01S1262 04097000
*   PROC;                                                       01S1262 04098000
*                                                               01S1262 04099000
UPDTCC   STM   @14,@12,12(@13)                                  01S1262 04100000
*   /*****************************************************************/ 04101000
*   /*                                                               */ 04102000
*   /* SETS SEEK TO NEXT CYL OR SETS AP1LST IF OUT OF EXTENT         */ 04103000
*   /*                                                               */ 04104000
*   /*****************************************************************/ 04105000
*                                                               01S1263 04106000
*   HHR=0;                          /* SET TRACK SEEK TO ZERO        */ 04107000
*                                                               01S1263 04108000
         SLR   @09,@09                                          01S1263 04109000
         STCM  @09,7,HHR(AP1REG)                                01S1263 04110000
*   /*****************************************************************/ 04111000
*   /*                                                               */ 04112000
*   /* GET INTO DEB KEY                                              */ 04113000
*   /*                                                               */ 04114000
*   /*****************************************************************/ 04115000
*                                                               01S1264 04116000
*   DO;                             /* MODESET EXTKEY(DATAMGT)       */ 04117000
*     SPKA(80);                     /* SET PSW KEY                   */ 04118000
         LA    @09,80                                           01S1265 04119000
         SPKA  0(@09)                                           01S1265 04120000
*   END;                            /* MODESET EXTKEY(DATAMGT) DATA     04121000
*                                      MGT KEY                       */ 04122000
*   DEBENDCC=DEBENDCC+1;            /* INCREMENT CYL BY ONE          */ 04123000
         LA    @09,32                                           01S1267 04124000
         AL    @09,AP1DEBA(,AP1REG)                             01S1267 04125000
         LA    @06,1                                            01S1267 04126000
         LH    @15,DEBENDCC(,@09)                               01S1267 04127000
         N     @15,@CF03868                                     01S1267 04128000
         ALR   @06,@15                                          01S1267 04129000
         STH   @06,DEBENDCC(,@09)                               01S1267 04130000
*   RFY                                                         01S1268 04131000
*     GPR04F RSTD;                                              01S1268 04132000
*   DO;                             /* MODESET EXTKEY(TCB)      01S1269 04133000
*                                      WORKREG(GPR04F)               */ 04134000
*     GPR04F=TCBPKF;                /* GET KEY FROM TCB              */ 04135000
         L     @06,FLCCVT                                       01S1270 04136000
         L     @06,CVTTCBP(,@06)                                01S1270 04137000
         L     @06,TCBPTR(,@06)                                 01S1270 04138000
         SLR   GPR04F,GPR04F                                    01S1270 04139000
         IC    GPR04F,TCBPKF(,@06)                              01S1270 04140000
*     SPKA(GPR04F);                 /* SET PSW KEY                   */ 04141000
         SPKA  0(GPR04F)                                        01S1271 04142000
*   END;                            /* MODESET EXTKEY(TCB)      01S1272 04143000
*                                      WORKREG(GPR04F) USER KEY      */ 04144000
*   RFY                                                         01S1273 04145000
*     GPR04F UNRSTD;                                            01S1273 04146000
*   CC=DEBENDCC;                    /* SET AP1SEEK                   */ 04147000
         MVC   CC(2,AP1REG),DEBENDCC(@09)                       01S1274 04148000
*   IF CC>AP1LSTCC THEN             /* CYL BEYOND PACK LIMIT         */ 04149000
         LH    @09,CC(,AP1REG)                                  01S1275 04150000
         N     @09,@CF03868                                     01S1275 04151000
         CH    @09,AP1LSTCC(,AP1REG)                            01S1275 04152000
         BNH   @RF01275                                         01S1275 04153000
*     AP1LST=ON;                    /* FINISHED                      */ 04154000
         OI    AP1LST(AP1REG),B'01000000'                       01S1276 04155000
*   ELSE                                                        01S1277 04156000
*     ;                             /* CONTINUE READ PASS            */ 04157000
@RF01275 DS    0H                                               01S1278 04158000
*   END;                            /* END OF UPDTCC PROC            */ 04159000
@EL00011 DS    0H                                               01S1278 04160000
@EF00011 DS    0H                                               01S1278 04161000
@ER00011 LM    @14,@12,12(@13)                                  01S1278 04162000
         BR    @14                                              01S1278 04163000
         EJECT                                                          04164000
*                                                               01S1279 04165000
*   /*****************************************************************/ 04166000
*   /*                                                               */ 04167000
*   /* UPDTHH: PROCEDURE                                             */ 04168000
*   /*                                                               */ 04169000
*   /*****************************************************************/ 04170000
*                                                               01S1279 04171000
*UPDTHH:                                                        01S1279 04172000
*   PROC;                           /* INTERNAL TO AP1 PROC          */ 04173000
*                                                               01S1279 04174000
UPDTHH   STM   @14,@12,@SA00012                                 01S1279 04175000
*   /*****************************************************************/ 04176000
*   /*                                                               */ 04177000
*   /* UPDATES AP1SEEK TO NEXT TRACK                                 */ 04178000
*   /*                                                               */ 04179000
*   /*****************************************************************/ 04180000
*                                                               01S1280 04181000
*   R=0;                            /* SET R TO 0                    */ 04182000
         MVI   R(AP1REG),X'00'                                  01S1280 04183000
*   IF HH>=AP1LSTHH THEN            /* END OF CYLINDER               */ 04184000
         LH    @09,HH(,AP1REG)                                  01S1281 04185000
         N     @09,@CF03868                                     01S1281 04186000
         CH    @09,AP1LSTHH(,AP1REG)                            01S1281 04187000
         BL    @RF01281                                         01S1281 04188000
*     CALL UPDTCC;                  /* GO TO NEXT CYL                */ 04189000
         BAL   @14,UPDTCC                                       01S1282 04190000
*   ELSE                            /* NOT EOC YET                   */ 04191000
*     HH=HH+1;                      /* GO TO NEXT TRACK              */ 04192000
         B     @RC01281                                         01S1283 04193000
@RF01281 LA    @09,1                                            01S1283 04194000
         LH    @06,HH(,AP1REG)                                  01S1283 04195000
         N     @06,@CF03868                                     01S1283 04196000
         ALR   @09,@06                                          01S1283 04197000
         STH   @09,HH(,AP1REG)                                  01S1283 04198000
*   END;                            /* OF UPDTHH PROC                */ 04199000
@EL00012 DS    0H                                               01S1284 04200000
@EF00012 DS    0H                                               01S1284 04201000
@ER00012 LM    @14,@12,@SA00012                                 01S1284 04202000
         BR    @14                                              01S1284 04203000
         EJECT                                                          04204000
*                                                               01S1285 04205000
*   /*****************************************************************/ 04206000
*   /*                                                               */ 04207000
*   /* BADTRK: PROCEDURE                                             */ 04208000
*   /*                                                               */ 04209000
*   /*****************************************************************/ 04210000
*                                                               01S1285 04211000
*BADTRK:                                                        01S1285 04212000
*   PROC;                           /* INTERNAL TO IAPCNTRL          */ 04213000
*                                                               01S1285 04214000
BADTRK   STM   @14,@12,@SA00013                                 01S1285 04215000
*   /*****************************************************************/ 04216000
*   /*                                                               */ 04217000
*   /* HANDLES UNREADABLE TRK ON DATA SCAN                           */ 04218000
*   /*                                                               */ 04219000
*   /*****************************************************************/ 04220000
*                                                               01S1286 04221000
*   IF SNSIFMT=ON|SNSDATA=ON|(SNSEQU=ON&SNS7=FMT10&(SNS17&NDFMSK)=NDF)  04222000
*     THEN                          /* ITF OR DATA CK                */ 04223000
         LA    @09,188                                          01S1286 04224000
         ALR   @09,AP1REG                                       01S1286 04225000
         TM    SNSIFMT(@09),B'01000000'                         01S1286 04226000
         BO    @RT01286                                         01S1286 04227000
         TM    SNSDATA(@09),B'00001000'                         01S1286 04228000
         BO    @RT01286                                         01S1286 04229000
         TM    SNSEQU(@09),B'00010000'                          01S1286 04230000
         BNO   @RF01286                                         01S1286 04231000
         CLI   SNS7(@09),X'10'                                  01S1286 04232000
         BNE   @RF01286                                         01S1286 04233000
         MVC   @TS00001(1),SNS17(@09)                           01S1286 04234000
         NI    @TS00001,X'FE'                                   01S1286 04235000
         CLI   @TS00001,X'C0'                                   01S1286 04236000
         BNE   @RF01286                                         01S1286 04237000
@RT01286 DS    0H                                               01S1287 04238000
*     DO;                                                       01S1287 04239000
*       CALL SNSCCHH;               /* SET SEEK TO SENSE DATA        */ 04240000
         BAL   @14,SNSCCHH                                      01S1288 04241000
*       IF SNSDATA=ON|(SNSEQU=ON&SNS7=FMT10&(SNS17&NDFMSK)=NDF) THEN    04242000
         LA    @09,188                                          01S1289 04243000
         ALR   @09,AP1REG                                       01S1289 04244000
         TM    SNSDATA(@09),B'00001000'                         01S1289 04245000
         BO    @RT01289                                         01S1289 04246000
         TM    SNSEQU(@09),B'00010000'                          01S1289 04247000
         BNO   @RF01289                                         01S1289 04248000
         CLI   SNS7(@09),X'10'                                  01S1289 04249000
         BNE   @RF01289                                         01S1289 04250000
         MVC   @TS00001(1),SNS17(@09)                           01S1289 04251000
         NI    @TS00001,X'FE'                                   01S1289 04252000
         CLI   @TS00001,X'C0'                                   01S1289 04253000
         BNE   @RF01289                                         01S1289 04254000
@RT01289 DS    0H                                               01S1290 04255000
*                                   /* DATA CK                       */ 04256000
*                                                               01S1290 04257000
*         /***********************************************************/ 04258000
*         /*                                                         */ 04259000
*         /* DATA CHECK                                              */ 04260000
*         /*                                                         */ 04261000
*         /***********************************************************/ 04262000
*                                                               01S1290 04263000
*         DO;                                                   01S1290 04264000
*           AP1PRCOD=PVERDCK;       /* DATACHECK MSG                 */ 04265000
         MVI   AP1PRCOD(AP1REG),X'1F'                           01S1291 04266000
*           CNVTPRM(1)=ADDR(CCHH);  /* INAREA                @ZM01497*/ 04267000
         LA    @09,CCHH(,AP1REG)                                01S1292 04268000
         ST    @09,CNVTPRM                                      01S1292 04269000
*           CNVTPRM(2)=ADDR(AP1PRMSG)+26;/* OUTAREA          @ZM01497*/ 04270000
         LA    @09,AP1PRMSG(,AP1REG)                            01S1293 04271000
         AL    @09,@CF03041                                     01S1293 04272000
         ST    @09,CNVTPRM+4                                    01S1293 04273000
*           CNVTPRM(3)=ADDR(LENGTH(CCHH));/* BYTES           @ZM01497*/ 04274000
         LA    @09,@CF00040                                     01S1294 04275000
         ST    @09,CNVTPRM+8                                    01S1294 04276000
*           RFY                                                 01S1295 04277000
*             GPR01P RSTD;          /*                       @ZM01497*/ 04278000
*           GPR01P=ADDR(CNVTPRM);   /* POINT TO PARMS        @ZM01497*/ 04279000
         LA    GPR01P,CNVTPRM                                   01S1296 04280000
*           CALL CVTEBCDX;          /* CNVT CCHH TO EBCDIC   @ZM01497*/ 04281000
         BAL   @14,CVTEBCDX                                     01S1297 04282000
*           RFY                                                 01S1298 04283000
*             GPR01P UNRSTD;        /*                       @ZM01497*/ 04284000
*           CALL COMM;              /* PRINT MSG                     */ 04285000
*                                                               01S1299 04286000
         BAL   @14,COMM                                         01S1299 04287000
*           /*********************************************************/ 04288000
*           /*                                                       */ 04289000
*           /* PRINT CCW, CSW, SENSE                                 */ 04290000
*           /*                                                       */ 04291000
*           /*********************************************************/ 04292000
*                                                               01S1300 04293000
*           CALL PRTCCW;            /* PRINT                         */ 04294000
         BAL   @14,PRTCCW                                       01S1300 04295000
*           AP1RDERR=ON;            /* INDICATE READ ERROR           */ 04296000
*                                                               01S1301 04297000
         OI    AP1RDERR(AP1REG),B'00000001'                     01S1301 04298000
*           /*********************************************************/ 04299000
*           /*                                                       */ 04300000
*           /* TEST FOR ERROR THRESHOLD                              */ 04301000
*           /*                                                       */ 04302000
*           /*********************************************************/ 04303000
*                                                               01S1302 04304000
*           AP1DCCNT=AP1DCCNT-1;    /* DECREMENT DCK COUNTER         */ 04305000
         SLR   @09,@09                                          01S1302 04306000
         IC    @09,AP1DCCNT(,AP1REG)                            01S1302 04307000
         BCTR  @09,0                                            01S1302 04308000
         STC   @09,AP1DCCNT(,AP1REG)                            01S1302 04309000
*           IF AP1DCCNT=0 THEN      /* MAX NO. ERRORS REACHED        */ 04310000
         CLI   AP1DCCNT(AP1REG),0                               01S1303 04311000
         BNE   @RF01303                                         01S1303 04312000
*             DO;                                               01S1304 04313000
*               AP1LST=ON;          /* END FIRST TEST                */ 04314000
         OI    AP1LST(AP1REG),B'01000000'                       01S1305 04315000
*               AP1PRCOD=PVERDCE;   /* THRESHOLD EXCEEDED MSG        */ 04316000
         MVI   AP1PRCOD(AP1REG),X'1E'                           01S1306 04317000
*               CALL COMM;          /* PRINT MSG                     */ 04318000
         BAL   @14,COMM                                         01S1307 04319000
*             END;                  /* END DO                        */ 04320000
*           ELSE                                                01S1309 04321000
*             ;                     /* COUNTER NON-ZERO              */ 04322000
@RF01303 DS    0H                                               01S1310 04323000
*         END;                      /* END DO                        */ 04324000
*       ELSE                                                    01S1311 04325000
*         ;                         /* NOT DATA CHECK (ITF)          */ 04326000
*                                                               01S1311 04327000
@RF01289 DS    0H                                               01S1312 04328000
*       /*************************************************************/ 04329000
*       /*                                                           */ 04330000
*       /* UPDATE SEEK TO NEXT TRACK                                 */ 04331000
*       /*                                                           */ 04332000
*       /*************************************************************/ 04333000
*                                                               01S1312 04334000
*       CALL UPDTHH;                /* TO NXT TRK                    */ 04335000
         BAL   @14,UPDTHH                                       01S1312 04336000
*     END;                          /* END DO                        */ 04337000
*   ELSE                            /* NOT DATA CHECK OR ITF         */ 04338000
*     DO;                                                       01S1314 04339000
         B     @RC01286                                         01S1314 04340000
@RF01286 DS    0H                                               01S1315 04341000
*       AP1ERROR=ON;                /* INDICATE ERROR OCCURED        */ 04342000
*       AP1QUIT=ON;                 /* END ALL TESTING               */ 04343000
         OI    AP1ERROR(AP1REG),B'00101000'                     01S1316 04344000
*       AP1PRCOD=PVERER;            /* DATAVER ERROR MSG             */ 04345000
         MVI   AP1PRCOD(AP1REG),X'20'                           01S1317 04346000
*       CALL COMM;                  /* PRINT MSG                     */ 04347000
         BAL   @14,COMM                                         01S1318 04348000
*       CALL PRTCCW;                /* PRT CCW, CSW, SNS             */ 04349000
         BAL   @14,PRTCCW                                       01S1319 04350000
*     END;                          /* END DO                        */ 04351000
*   END;                            /* OF BADTRK PROC                */ 04352000
@EL00013 DS    0H                                               01S1321 04353000
@EF00013 DS    0H                                               01S1321 04354000
@ER00013 LM    @14,@12,@SA00013                                 01S1321 04355000
         BR    @14                                              01S1321 04356000
         EJECT                                                          04357000
*                                                               01S1322 04358000
*   /*****************************************************************/ 04359000
*   /*                                                               */ 04360000
*   /* MACRO DECLARES                                                */ 04361000
*   /*                                                               */ 04362000
*   /*****************************************************************/ 04363000
*                                                               01S1322 04364000
*   DCL                                                         01S1322 04365000
*     1 I107 DEF(ILIST) BDY(WORD),  /* DEFINE LIST                   */ 04366000
*      2 I10701 BIT(8),             /* OR MASK                       */ 04367000
*      2 I10702 BIT(8),             /* AND MASK                      */ 04368000
*      2 I10703 BIT(8),             /* RESERVED                      */ 04369000
*      2 I10704 BIT(8);                                         01S1322 04370000
*   DCL                                                         01S1323 04371000
*     1 I048 DEF(ILIST) CHAR(32767) BDY(WORD),                  01S1323 04372000
*       3 I04801 PTR(31),           /* TCB ADDR                      */ 04373000
*       3 I04802(*) CHAR(12) BDY(WORD),                         01S1323 04374000
*         5 I04803 PTR(31),         /* UCB @ IN LAST ENTRY           */ 04375000
*           7 I04804 BIT(8),        /* FLAGS                         */ 04376000
*           7 I04805 PTR(8),        /* MINOR RESOURCE NAME LENGTH    */ 04377000
*           7 I04806 BIT(8),        /* FLAGS                         */ 04378000
*           7 * CHAR(1),            /* CONTROL PROGRAM USE           */ 04379000
*         5 I04807 PTR(31),         /* MAJOR RESOURCE NAME @         */ 04380000
*         5 I04808 PTR(31);         /* MINOR RESOURCE NAME @         */ 04381000
*   DCL                                                         01S1324 04382000
*     1 I042 DEF(ILIST),            /* ATTACH LIST                   */ 04383000
*      2 I04201 PTR(8),             /* DE-FLAG                       */ 04384000
*      2 I04202 PTR(24),            /* EP/DE ADDRESS                 */ 04385000
*      2 I04203 PTR(8),             /* RESERVED                      */ 04386000
*      2 I04204 PTR(24),            /* DCB ADDRESS                   */ 04387000
*      2 I04205 PTR(8),             /* STATUS BYTE                   */ 04388000
*      2 I04206 PTR(24),            /* ECB ADDRESS                   */ 04389000
*      2 I04207 PTR(8),             /* STATUS BYTE                   */ 04390000
*      2 I04208 PTR(24),            /* SUBPOOL LIST OR NUMBER        */ 04391000
*      2 I04209 PTR(8),             /* STATUS BYTE                   */ 04392000
*      2 I04210 PTR(24),            /* SUBPOOL LIST OR NUMBER        */ 04393000
*      2 I04211 PTR(8),             /* RESERVED                      */ 04394000
*      2 I04212 PTR(24),            /* END-OF-TASK EXIT ADDRESS      */ 04395000
*      2 I04213 FIXED(15),          /* PRIORITY ADJUSTMENT VALUE     */ 04396000
*      2 I04214 PTR(8),             /* PRIORITY ADJUSTMENT VALUE     */ 04397000
*      2 I04215 PTR(8),             /* STATUS BYTE                   */ 04398000
*      2 I04216 CHAR(8),            /* ENTRY POINT NAME              */ 04399000
*      2 I04217 PTR(31),            /* JSCB ADDRESS                  */ 04400000
*      2 I04218 PTR(8),             /* TASK ID                       */ 04401000
*      2 I04219 PTR(24),            /* STAI/ESTAI PARM-LIST ADDR     */ 04402000
*      2 I04220 PTR(8),             /* STATUS BYTE                   */ 04403000
*      2 I04221 PTR(24),            /* STAI/ESTAI EXIT ADDRESS       */ 04404000
*      2 I04222 PTR(8),             /* RESERVED                      */ 04405000
*      2 I04223 PTR(24),            /* TASKLIB DCB ADDRESS           */ 04406000
*      2 I04224 PTR(8),             /* STATUS BYTE                   */ 04407000
*      2 I04225 PTR(8),             /* RESERVED                      */ 04408000
*      2 I04226 FIXED(15),          /* LENGTH OF THIS LIST           */ 04409000
*      2 I04227 PTR(31);            /* SUBPOOL LIST OR NUMBER        */ 04410000
*   DECLARE                                                     01S1325 04411000
*     ILIST CHAR(60) BDY(DWORD);    /* STANDARD LIST                 */ 04412000
*   DECLARE                         /* COMMON VARIABLES              */ 04413000
*     I256C CHAR(256) BASED,                                    01S1326 04414000
*     I031F FIXED(31) BASED,                                    01S1326 04415000
*     I031P PTR(31) BASED,                                      01S1326 04416000
*     I015F FIXED(15) BASED,                                    01S1326 04417000
*     I015P PTR(15) BASED,                                      01S1326 04418000
*     I008P PTR(8) BASED,                                       01S1326 04419000
*     I001C CHAR(1) BASED;                                      01S1326 04420000
*   DECLARE                                                     01S1327 04421000
*     IOPTLIST(1) PTR(31) BDY(WORD);/* OPTION LIST ARRAY             */ 04422000
*                                                               01S1327 04423000
*   /*****************************************************************/ 04424000
*   /*                                                               */ 04425000
*   /* GENERATE MACRO DSECTS                                         */ 04426000
*   /*                                                               */ 04427000
*   /*****************************************************************/ 04428000
*                                                               01S1328 04429000
*   GEN DATA DEFS(PATCH);                                       01S1328 04430000
*   END                             /* OF PROCEDURE                  */ 04431000
*                                                               01S1329 04432000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 04433000
*/*%INCLUDE SYSLIB  (AP1BLOCK)                                       */ 04434000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 04435000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 04436000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 04437000
*/*%INCLUDE SYSLIB  (IEZIOB  )                                       */ 04438000
*/*%INCLUDE SYSLIB  (IEZDEB  )                                       */ 04439000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 04440000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */ 04441000
*/*%INCLUDE SYSLIB  (IEFTIOT1)                                       */ 04442000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */ 04443000
*/*%INCLUDE SYSUT5  (INIT    )                                       */ 04444000
*/*%INCLUDE SYSUT5  (INITGET )                                       */ 04445000
*/*%INCLUDE SYSUT5  (INITDEVT)                                       */ 04446000
*/*%INCLUDE SYSUT5  (INITDEB )                                       */ 04447000
*/*%INCLUDE SYSUT5  (HDWETST )                                       */ 04448000
*/*%INCLUDE SYSUT5  (READTST )                                       */ 04449000
*/*%INCLUDE SYSUT5  (READBLD2)                                       */ 04450000
*/*%INCLUDE SYSUT5  (READBLD3)                                       */ 04451000
*/*%INCLUDE SYSUT5  (TERM    )                                       */ 04452000
*                                                               01S1329 04453000
*       ;                                                       01S1329 04454000
@EL00001 L     @13,4(,@13)                                      01S1329 04455000
@EF00001 L     @00,@SIZDATD                                     01S1329 04456000
         LR    @01,@07                                          01S1329 04457000
         FREEMAIN R,LV=(0),A=(1)                                        04458000
@ER00001 LM    @14,@12,12(@13)                                  01S1329 04459000
         BR    @14                                              01S1329 04460000
@DATA    DS    0H                                                       04461000
@CH01082 DC    H'6'                                                     04462000
@CH03120 DC    H'55'                                                    04463000
@CH00135 DC    H'60'                                                    04464000
@CH03240 DC    H'-1'                                                    04465000
@SM03864 MVC   BYTE256(0,@06),BYTE256(@14)                              04466000
@SM03874 MVC   AP1PRMSG(0,AP1REG),CNMSGXXT(@09)                         04467000
@SM03876 MVC   AP1PRMSG(0,AP1REG),@TS00001                              04468000
@DATD    DSECT                                                          04469000
         DS    0F                                                       04470000
@SA00001 DS    18F                                                      04471000
@PC00001 DS    1F                                                       04472000
@SA00006 DS    15F                                                      04473000
@SA00004 DS    15F                                                      04474000
@SA00003 DS    15F                                                      04475000
@SA00002 DS    15F                                                      04476000
@SA00013 DS    15F                                                      04477000
@SA00012 DS    15F                                                      04478000
@SA00005 DS    15F                                                      04479000
@PC00005 DS    3F                                                       04480000
@SA00007 DS    15F                                                      04481000
@SA00008 DS    15F                                                      04482000
IAPCNTRL CSECT                                                          04483000
         DS    0F                                                       04484000
@CF00045 DC    F'1'                                                     04485000
@CF00060 DC    F'2'                                                     04486000
@CF00139 DC    F'3'                                                     04487000
@CH00139 EQU   @CF00139+2                                               04488000
@CF00040 DC    F'4'                                                     04489000
@CH00040 EQU   @CF00040+2                                               04490000
@CF00085 DC    F'5'                                                     04491000
@CH00085 EQU   @CF00085+2                                               04492000
@CF00049 DC    F'8'                                                     04493000
@CF00035 DC    F'12'                                                    04494000
@CF03033 DC    F'21'                                                    04495000
@CF00066 DC    F'24'                                                    04496000
@CF03041 DC    F'26'                                                    04497000
@CF03317 DC    F'41'                                                    04498000
@CF00997 DC    F'48'                                                    04499000
@CF03282 DC    F'51'                                                    04500000
@CF03323 DC    F'75'                                                    04501000
@CF03845 DC    F'800'                                                   04502000
@CF03848 DC    F'934'                                                   04503000
@CF03871 DC    F'-8'                                                    04504000
@CF03872 DC    F'-7'                                                    04505000
@CF03272 DC    XL4'80000000'                                            04506000
@CF03868 DC    XL4'0000FFFF'                                            04507000
@CF03126 DC    XL4'001D'                                                04508000
@DATD    DSECT                                                          04509000
         DS    0D                                                       04510000
BUFPTR   DS    A                                                        04511000
         DS    0D                                                       04512000
@TS00001 DS    CL130                                                    04513000
         DS    CL6                                                      04514000
ILIST    DS    CL60                                                     04515000
CNVTPRM  DS    3A                                                       04516000
IOPTLIST DS    1A                                                       04517000
IAPCNTRL CSECT                                                          04518000
         DS    0F                                                       04519000
@SIZDATD DC    AL1(0)                                                   04520000
         DC    AL3(@ENDDATD-@DATD)                                      04521000
@CV03167 DC    V(IAPABNAP)                                              04522000
@CV03168 DC    V(IAPBLDIO)                                              04523000
@CV03169 DC    V(IAPCHKIO)                                              04524000
@CV03170 DC    V(IAPPFXAP)                                              04525000
         DS    0D                                                       04526000
PCODELN1 DC    AL4(1+1)                                                 04527000
@CC03249 DC    C'TESTDD  '                                              04528000
@CC03244 DC    C'NODATA'                                                04529000
@CC03242 DC    C'AP1B'                                                  04530000
@CC03243 DC    C'    '                                                  04531000
@CC03245 DC    C'DATA'                                                  04532000
@CC03285 DC    C'YES '                                                  04533000
@CC03286 DC    C'NO  '                                                  04534000
@CC03322 EQU   @CC03243                                                 04535000
@CB03072 DC    X'0012'                                                  04536000
@CB03126 DC    X'001D'                                                  04537000
@CB03128 DC    X'000B'                                                  04538000
@CB03253 DC    X'0000'                                                  04539000
@CB03254 DC    X'0193'                                                  04540000
@CB03255 DC    X'0327'                                                  04541000
@CB03256 DC    X'02B7'                                                  04542000
@CB03257 DC    X'022A'                                                  04543000
IAPTIMER DC    CL8'IAPTIMER'                                            04544000
ZERO     DC    X'0000000000000000'                                      04545000
QNAME    DC    CL8'AP1QNAME'                                            04546000
SSCCCCW  DC    X'2300000040000001'                                      04547000
RHACSCCW DC    X'1A00000050000005'                                      04548000
TICCCW   DC    X'0800000000000000'                                      04549000
SIDCCCCW DC    X'3100000040000005'                                      04550000
MRCCCCCW DC    X'9200000040000008'                                      04551000
RKDSSCCW DC    X'0E0000007000FFFF'                                      04552000
RR0CDCCW DC    X'1600000080000008'                                      04553000
RR0SSCCW DC    X'160000007000FFFF'                                      04554000
MR0CDCCW DC    X'9600000080000008'                                      04555000
READFM   DC    X'40'                                                    04556000
         DS    CL1                                                      04557000
CNMSG01  DS    CL80                                                     04558000
         ORG   CNMSG01                                                  04559000
@NM00082 DC    AL1(3)                                                   04560000
@NM00083 DC    AL3(0)                                                   04561000
@NM00084 DC    A(0)                                                     04562000
@NM00085 DC    H'68'                                                    04563000
@NM00086 DC    X'8000'                                                  04564000
@NM00087 DC    CL64'IAP001A XXX DO YOU WANT TO RUN DATA VERIFICATION TEC04565000
               ST, YES OR NO'                                           04566000
@NM00088 DC    X'40001000'                                              04567000
         ORG   CNMSG01+80                                               04568000
CNMSG02  DS    CL39                                                     04569000
         ORG   CNMSG02                                                  04570000
@NM00089 DC    AL1(0)                                                   04571000
@NM00090 DC    AL3(0)                                                   04572000
@NM00091 DC    A(0)                                                     04573000
@NM00092 DC    H'27'                                                    04574000
@NM00093 DC    X'8000'                                                  04575000
@NM00094 DC    CL23'IAP002I XXX AP1 STARTED'                            04576000
@NM00095 DC    X'10001000'                                              04577000
         ORG   CNMSG02+39                                               04578000
         DS    CL1                                                      04579000
CNMSG03  DS    CL51                                                     04580000
         ORG   CNMSG03                                                  04581000
@NM00096 DC    AL1(0)                                                   04582000
@NM00097 DC    AL3(0)                                                   04583000
@NM00098 DC    A(0)                                                     04584000
@NM00099 DC    H'39'                                                    04585000
@NM00100 DC    X'8000'                                                  04586000
@NM00101 DC    CL35'IAP003I XXX SUSPECTED DRIVE PROBLEM'                04587000
@NM00102 DC    X'10001000'                                              04588000
         ORG   CNMSG03+51                                               04589000
         DS    CL1                                                      04590000
CNMSG04  DS    CL72                                                     04591000
         ORG   CNMSG04                                                  04592000
@NM00103 DC    AL1(0)                                                   04593000
@NM00104 DC    AL3(0)                                                   04594000
@NM00105 DC    A(0)                                                     04595000
@NM00106 DC    H'60'                                                    04596000
@NM00107 DC    X'8000'                                                  04597000
@NM00108 DC    CL56'IAP004I XXX DATA FORMAT UNACCEPTABLE, TESTING TERMIC04598000
               NATED'                                                   04599000
@NM00109 DC    X'10001000'                                              04600000
         ORG   CNMSG04+72                                               04601000
CNMSG05  DS    CL46                                                     04602000
         ORG   CNMSG05                                                  04603000
@NM00110 DC    AL1(0)                                                   04604000
@NM00111 DC    AL3(0)                                                   04605000
@NM00112 DC    A(0)                                                     04606000
@NM00113 DC    H'34'                                                    04607000
@NM00114 DC    X'8000'                                                  04608000
@NM00115 DC    CL30'IAP005I XXX ERROR READING DATA'                     04609000
@NM00116 DC    X'10001000'                                              04610000
         ORG   CNMSG05+46                                               04611000
         DS    CL2                                                      04612000
CNMSG06  DS    CL70                                                     04613000
         ORG   CNMSG06                                                  04614000
@NM00117 DC    AL1(0)                                                   04615000
@NM00118 DC    AL3(0)                                                   04616000
@NM00119 DC    A(0)                                                     04617000
@NM00120 DC    H'58'                                                    04618000
@NM00121 DC    X'8000'                                                  04619000
@NM00122 DC    CL54'IAP006I XXX ALL DATA ''MACHINE READABLE'' WITHOUT EC04620000
               RRORS'                                                   04621000
@NM00123 DC    X'10001000'                                              04622000
         ORG   CNMSG06+70                                               04623000
         DS    CL2                                                      04624000
CNMSG07  DS    CL37                                                     04625000
         ORG   CNMSG07                                                  04626000
@NM00124 DC    AL1(0)                                                   04627000
@NM00125 DC    AL3(0)                                                   04628000
@NM00126 DC    A(0)                                                     04629000
@NM00127 DC    H'25'                                                    04630000
@NM00128 DC    X'8000'                                                  04631000
@NM00129 DC    CL21'IAP007I XXX AP1 ENDED'                              04632000
@NM00130 DC    X'10001000'                                              04633000
         ORG   CNMSG07+37                                               04634000
         DS    CL3                                                      04635000
CNMSG08  DS    CL48                                                     04636000
         ORG   CNMSG08                                                  04637000
@NM00131 DC    AL1(0)                                                   04638000
@NM00132 DC    AL3(0)                                                   04639000
@NM00133 DC    A(0)                                                     04640000
@NM00134 DC    H'36'                                                    04641000
@NM00135 DC    X'8000'                                                  04642000
@NM00136 DC    CL32'IAP008I XXX WRITE TESTS BYPASSED'                   04643000
@NM00137 DC    X'10001000'                                              04644000
         ORG   CNMSG08+48                                               04645000
CNMSG09  DS    CL59                                                     04646000
         ORG   CNMSG09                                                  04647000
@NM00138 DC    AL1(0)                                                   04648000
@NM00139 DC    AL3(0)                                                   04649000
@NM00140 DC    A(0)                                                     04650000
@NM00141 DC    H'47'                                                    04651000
@NM00142 DC    X'8000'                                                  04652000
@NM00143 DC    CL43'IAP009I XXX I/O TIMEOUT, TESTING TERMINATED'        04653000
@NM00144 DC    X'10001000'                                              04654000
         ORG   CNMSG09+59                                               04655000
         DS    CL1                                                      04656000
CNMSG10  DS    CL51                                                     04657000
         ORG   CNMSG10                                                  04658000
@NM00145 DC    AL1(0)                                                   04659000
@NM00146 DC    AL3(0)                                                   04660000
@NM00147 DC    A(0)                                                     04661000
@NM00148 DC    H'39'                                                    04662000
@NM00149 DC    X'8000'                                                  04663000
@NM00150 DC    CL35'IAP010I XXX NO DRIVE PROBLEMS FOUND'                04664000
@NM00151 DC    X'10001000'                                              04665000
         ORG   CNMSG10+51                                               04666000
         DS    CL1                                                      04667000
CNMSG11  DS    CL66                                                     04668000
         ORG   CNMSG11                                                  04669000
@NM00152 DC    AL1(0)                                                   04670000
@NM00153 DC    AL3(0)                                                   04671000
@NM00154 DC    A(0)                                                     04672000
@NM00155 DC    H'54'                                                    04673000
@NM00156 DC    X'8000'                                                  04674000
@NM00157 DC    CL50'IAP011I XXX SYSOUT OPEN FAILED, TESTING TERMINATED' 04675000
@NM00158 DC    X'10001000'                                              04676000
         ORG   CNMSG11+66                                               04677000
         DS    CL2                                                      04678000
CNMSG12  DS    CL65                                                     04679000
         ORG   CNMSG12                                                  04680000
@NM00159 DC    AL1(0)                                                   04681000
@NM00160 DC    AL3(0)                                                   04682000
@NM00161 DC    A(0)                                                     04683000
@NM00162 DC    H'53'                                                    04684000
@NM00163 DC    X'8000'                                                  04685000
@NM00164 DC    CL49'IAP012I XXX NO ''TESTDD'' DD CARD, TESTING BYPASSEDC04686000
               '                                                        04687000
@NM00165 DC    X'10001000'                                              04688000
         ORG   CNMSG12+65                                               04689000
         DS    CL3                                                      04690000
CNMSG13  DS    CL71                                                     04691000
         ORG   CNMSG13                                                  04692000
@NM00166 DC    AL1(0)                                                   04693000
@NM00167 DC    AL3(0)                                                   04694000
@NM00168 DC    A(0)                                                     04695000
@NM00169 DC    H'59'                                                    04696000
@NM00170 DC    X'8000'                                                  04697000
@NM00171 DC    CL55'IAP013I XXX UNABLE TO OPEN ''TESTDD'', TESTING TERMC04698000
               INATED'                                                  04699000
@NM00172 DC    X'10001000'                                              04700000
         ORG   CNMSG13+71                                               04701000
         DS    CL1                                                      04702000
CNMSG14  DS    CL69                                                     04703000
         ORG   CNMSG14                                                  04704000
@NM00173 DC    AL1(0)                                                   04705000
@NM00174 DC    AL3(0)                                                   04706000
@NM00175 DC    A(0)                                                     04707000
@NM00176 DC    H'57'                                                    04708000
@NM00177 DC    X'8000'                                                  04709000
@NM00178 DC    CL53'IAP014I XXX INCORRECT DEVICE TYPE, TESTING TERMINATC04710000
               ED'                                                      04711000
@NM00179 DC    X'10001000'                                              04712000
         ORG   CNMSG14+69                                               04713000
         DS    CL3                                                      04714000
CNMSG15  DS    CL58                                                     04715000
         ORG   CNMSG15                                                  04716000
@NM00180 DC    AL1(0)                                                   04717000
@NM00181 DC    AL3(0)                                                   04718000
@NM00182 DC    A(0)                                                     04719000
@NM00183 DC    H'46'                                                    04720000
@NM00184 DC    X'8000'                                                  04721000
@NM00185 DC    CL42'IAP015I XXX DATA VERIFICATION TEST STARTED'         04722000
@NM00186 DC    X'10001000'                                              04723000
         ORG   CNMSG15+58                                               04724000
         DS    CL2                                                      04725000
CNMSG16  DS    CL73                                                     04726000
         ORG   CNMSG16                                                  04727000
@NM00187 DC    AL1(0)                                                   04728000
@NM00188 DC    AL3(0)                                                   04729000
@NM00189 DC    A(0)                                                     04730000
@NM00190 DC    H'61'                                                    04731000
@NM00191 DC    X'8000'                                                  04732000
@NM00192 DC    CL57'IAP016I XXX WRITE INHIBIT SWITCH ON, WRITE TESTS BYC04733000
               PASSED'                                                  04734000
@NM00193 DC    X'10001000'                                              04735000
         ORG   CNMSG16+73                                               04736000
         DS    CL3                                                      04737000
CNMSG17  DS    CL64                                                     04738000
         ORG   CNMSG17                                                  04739000
@NM00194 DC    AL1(0)                                                   04740000
@NM00195 DC    AL3(0)                                                   04741000
@NM00196 DC    A(0)                                                     04742000
@NM00197 DC    H'52'                                                    04743000
@NM00198 DC    X'8000'                                                  04744000
@NM00199 DC    CL48'IAP017I XXX DEVICE NOT READY, TESTING TERMINATED'   04745000
@NM00200 DC    X'10001000'                                              04746000
         ORG   CNMSG17+64                                               04747000
PRMSG01  DS    CL62                                                     04748000
         ORG   PRMSG01                                                  04749000
@NM00201 DC    H'60'                                                    04750000
@NM00202 DC    CL60'           M O V E A B L E   H E A D   E R R O R   C04751000
               T A B L E'                                               04752000
         ORG   PRMSG01+62                                               04753000
PRMSG02  DS    CL79                                                     04754000
         ORG   PRMSG02                                                  04755000
@NM00203 DC    H'77'                                                    04756000
@NM00204 DC    CL77'      HEAD NUMBER  DATA CHK   SEEK VERIFY   WRITE CC04757000
               HK   DATA CHK    DATA COMP'                              04758000
         ORG   PRMSG02+79                                               04759000
         DS    CL1                                                      04760000
PRMSG03  DS    CL77                                                     04761000
         ORG   PRMSG03                                                  04762000
@NM00205 DC    H'75'                                                    04763000
@NM00206 DC    CL75'                                 CHECK             C04764000
                      CE CYL      ERROR'                                04765000
         ORG   PRMSG03+77                                               04766000
         DS    CL1                                                      04767000
PRMSG04  DS    CL55                                                     04768000
         ORG   PRMSG04                                                  04769000
@NM00207 DC    H'53'                                                    04770000
@NM00208 DC    CL53'          F I X E D   H E A D   E R R O R   T A B LC04771000
                E'                                                      04772000
         ORG   PRMSG04+55                                               04773000
         DS    CL1                                                      04774000
PRMSG05  DS    CL85                                                     04775000
         ORG   PRMSG05                                                  04776000
@NM00209 DC    H'83'                                                    04777000
@NM00210 DC    CL83'      HEAD NUMBER  DATA CHECK   SEEK VERIFY   HEAD C04778000
               NUMBER  DATA CHECK   SEEK VERIFY'                        04779000
         ORG   PRMSG05+85                                               04780000
         DS    CL1                                                      04781000
PRMSG06  DS    CL82                                                     04782000
         ORG   PRMSG06                                                  04783000
@NM00211 DC    H'80'                                                    04784000
@NM00212 DC    CL80'                                   CHECK           C04785000
                                       CHECK'                           04786000
         ORG   PRMSG06+82                                               04787000
PRMSG07  DS    CL10                                                     04788000
         ORG   PRMSG07                                                  04789000
@NM00213 DC    H'8'                                                     04790000
@NM00214 DC    CL8'SNS TEST'                                            04791000
         ORG   PRMSG07+10                                               04792000
PRMSG08  DS    CL12                                                     04793000
         ORG   PRMSG08                                                  04794000
@NM00215 DC    H'10'                                                    04795000
@NM00216 DC    CL10'RECAL TEST'                                         04796000
         ORG   PRMSG08+12                                               04797000
PRMSG09  DS    CL12                                                     04798000
         ORG   PRMSG09                                                  04799000
@NM00217 DC    H'10'                                                    04800000
@NM00218 DC    CL10'RHAMH TEST'                                         04801000
         ORG   PRMSG09+12                                               04802000
PRMSG10  DS    CL12                                                     04803000
         ORG   PRMSG10                                                  04804000
@NM00219 DC    H'10'                                                    04805000
@NM00220 DC    CL10'RHAFH TEST'                                         04806000
         ORG   PRMSG10+12                                               04807000
PRMSG11  DS    CL12                                                     04808000
         ORG   PRMSG11                                                  04809000
@NM00221 DC    H'10'                                                    04810000
@NM00222 DC    CL10'SK192 TEST'                                         04811000
         ORG   PRMSG11+12                                               04812000
PRMSG12  DS    CL13                                                     04813000
         ORG   PRMSG12                                                  04814000
@NM00223 DC    H'11'                                                    04815000
@NM00224 DC    CL11'SKINCR TEST'                                        04816000
         ORG   PRMSG12+13                                               04817000
         DS    CL1                                                      04818000
PRMSG13  DS    CL12                                                     04819000
         ORG   PRMSG13                                                  04820000
@NM00225 DC    H'10'                                                    04821000
@NM00226 DC    CL10'SKMAX TEST'                                         04822000
         ORG   PRMSG13+12                                               04823000
PRMSG14  DS    CL12                                                     04824000
         ORG   PRMSG14                                                  04825000
@NM00227 DC    H'10'                                                    04826000
@NM00228 DC    CL10'SKRAN TEST'                                         04827000
         ORG   PRMSG14+12                                               04828000
PRMSG15  DS    CL10                                                     04829000
         ORG   PRMSG15                                                  04830000
@NM00229 DC    H'8'                                                     04831000
@NM00230 DC    CL8'RHA TEST'                                            04832000
         ORG   PRMSG15+10                                               04833000
PRMSG16  DS    CL10                                                     04834000
         ORG   PRMSG16                                                  04835000
@NM00231 DC    H'8'                                                     04836000
@NM00232 DC    CL8'WRT TEST'                                            04837000
         ORG   PRMSG16+10                                               04838000
PRMSG17  DS    CL11                                                     04839000
         ORG   PRMSG17                                                  04840000
@NM00233 DC    H'9'                                                     04841000
@NM00234 DC    CL9'RR01 TEST'                                           04842000
         ORG   PRMSG17+11                                               04843000
         DS    CL1                                                      04844000
PRMSG18  DS    CL60                                                     04845000
         ORG   PRMSG18                                                  04846000
@NM00235 DC    H'58'                                                    04847000
@NM00236 DC    CL58'RR01 DATA COMPARE ERROR--EXP =                     C04848000
                 REC ='                                                 04849000
         ORG   PRMSG18+60                                               04850000
PRMSG19  DS    CL11                                                     04851000
         ORG   PRMSG19                                                  04852000
@NM00237 DC    H'9'                                                     04853000
@NM00238 DC    CL9'RDMT TEST'                                           04854000
         ORG   PRMSG19+11                                               04855000
         DS    CL1                                                      04856000
PRMSG20  DS    CL60                                                     04857000
         ORG   PRMSG20                                                  04858000
@NM00239 DC    H'58'                                                    04859000
@NM00240 DC    CL58'RDMT DATA COMPARE ERROR--EXP =                     C04860000
                 REC ='                                                 04861000
         ORG   PRMSG20+60                                               04862000
PRMSG21  DS    CL12                                                     04863000
         ORG   PRMSG21                                                  04864000
@NM00241 DC    H'10'                                                    04865000
@NM00242 DC    CL10'FTWRT TEST'                                         04866000
         ORG   PRMSG21+12                                               04867000
PRMSG22  DS    CL12                                                     04868000
         ORG   PRMSG22                                                  04869000
@NM00243 DC    H'10'                                                    04870000
@NM00244 DC    CL10'AMDET TEST'                                         04871000
         ORG   PRMSG22+12                                               04872000
PRMSG23  DS    CL61                                                     04873000
         ORG   PRMSG23                                                  04874000
@NM00245 DC    H'59'                                                    04875000
@NM00246 DC    CL59'AMDET DATA COMPARE ERROR--EXP =                    C04876000
                  REC ='                                                04877000
         ORG   PRMSG23+61                                               04878000
         DS    CL1                                                      04879000
PRMSG24  DS    CL9                                                      04880000
         ORG   PRMSG24                                                  04881000
@NM00247 DC    H'7'                                                     04882000
@NM00248 DC    CL7'SD TEST'                                             04883000
         ORG   PRMSG24+9                                                04884000
         DS    CL1                                                      04885000
PRMSG25  DS    CL77                                                     04886000
         ORG   PRMSG25                                                  04887000
@NM00249 DC    H'75'                                                    04888000
@NM00250 DC    CL75'      FAILING CCW =                        CSW =   C04889000
                                  ECB ='                                04890000
         ORG   PRMSG25+77                                               04891000
         DS    CL1                                                      04892000
PRMSG26  DS    CL13                                                     04893000
         ORG   PRMSG26                                                  04894000
@NM00251 DC    H'11'                                                    04895000
@NM00252 DC    CL11'      SNS ='                                        04896000
         ORG   PRMSG26+13                                               04897000
         DS    CL1                                                      04898000
PRMSG27  DS    CL29                                                     04899000
         ORG   PRMSG27                                                  04900000
@NM00253 DC    H'27'                                                    04901000
@NM00254 DC    CL27'WRT WRITE INHIBIT SWITCH ON'                        04902000
         ORG   PRMSG27+29                                               04903000
         DS    CL1                                                      04904000
PRMSG28  DS    CL13                                                     04905000
         ORG   PRMSG28                                                  04906000
@NM00255 DC    H'11'                                                    04907000
@NM00256 DC    CL11'WRTPAD TEST'                                        04908000
         ORG   PRMSG28+13                                               04909000
         DS    CL1                                                      04910000
PRMSG29  DS    CL61                                                     04911000
         ORG   PRMSG29                                                  04912000
@NM00257 DC    H'59'                                                    04913000
@NM00258 DC    CL59'WRTPAD READ WRONG RECORD--EXP =                    C04914000
                  REC ='                                                04915000
         ORG   PRMSG29+61                                               04916000
         DS    CL1                                                      04917000
PRMSG30  DS    CL40                                                     04918000
         ORG   PRMSG30                                                  04919000
@NM00259 DC    H'38'                                                    04920000
@NM00260 DC    CL38'DATAVER DATA CHECKS EXCEEDED THRESHOLD'             04921000
         ORG   PRMSG30+40                                               04922000
PRMSG31  DS    CL27                                                     04923000
         ORG   PRMSG31                                                  04924000
@NM00261 DC    H'25'                                                    04925000
@NM00262 DC    CL25'DATAVER DATA CHECK CCHH ='                          04926000
         ORG   PRMSG31+27                                               04927000
         DS    CL1                                                      04928000
PRMSG32  DS    CL14                                                     04929000
         ORG   PRMSG32                                                  04930000
@NM00263 DC    H'12'                                                    04931000
@NM00264 DC    CL12'DATAVER TEST'                                       04932000
         ORG   PRMSG32+14                                               04933000
PRMSG33  DS    CL14                                                     04934000
         ORG   PRMSG33                                                  04935000
@NM00265 DC    H'12'                                                    04936000
@NM00266 DC    CL12'CLEANUP TEST'                                       04937000
         ORG   PRMSG33+14                                               04938000
PRMSG34  DS    CL42                                                     04939000
         ORG   PRMSG34                                                  04940000
@NM00267 DC    H'40'                                                    04941000
@NM00268 DC    CL40'RHA HA INCORRECT -- EXP=            REC='           04942000
         ORG   PRMSG34+42                                               04943000
PRMSG35  DS    CL41                                                     04944000
         ORG   PRMSG35                                                  04945000
@NM00269 DC    H'39'                                                    04946000
@NM00270 DC    CL39'DATAVER DATA FORMAT UNACCEPTABLE ON CYL'            04947000
         ORG   PRMSG35+41                                               04948000
         DS    CL1                                                      04949000
PRMSG36  DS    CL10                                                     04950000
         ORG   PRMSG36                                                  04951000
@NM00271 DC    H'8'                                                     04952000
@NM00272 DC    CL8'RPS TEST'                                            04953000
         ORG   PRMSG36+10                                               04954000
HEADER   DC    CL110'         A P 1    A N A L Y S I S  P R O G R A M  C04955000
                O N E                                       PAGE'       04956000
         DS    CL2                                                      04957000
CNMSGPTR DC    AL4(CNMSG01)                                             04958000
         DC    AL4(CNMSG02)                                             04959000
         DC    AL4(CNMSG03)                                             04960000
         DC    AL4(CNMSG04)                                             04961000
         DC    AL4(CNMSG05)                                             04962000
         DC    AL4(CNMSG06)                                             04963000
         DC    AL4(CNMSG07)                                             04964000
         DC    AL4(CNMSG08)                                             04965000
         DC    AL4(CNMSG09)                                             04966000
         DC    AL4(CNMSG10)                                             04967000
         DC    AL4(CNMSG11)                                             04968000
         DC    AL4(CNMSG12)                                             04969000
         DC    AL4(CNMSG13)                                             04970000
         DC    AL4(CNMSG14)                                             04971000
         DC    AL4(CNMSG15)                                             04972000
         DC    AL4(CNMSG16)                                             04973000
         DC    AL4(CNMSG17)                                             04974000
PRMSGPTR DC    AL4(PRMSG01)                                             04975000
         DC    AL4(PRMSG02)                                             04976000
         DC    AL4(PRMSG03)                                             04977000
         DC    AL4(PRMSG04)                                             04978000
         DC    AL4(PRMSG05)                                             04979000
         DC    AL4(PRMSG06)                                             04980000
         DC    AL4(PRMSG07)                                             04981000
         DC    AL4(PRMSG08)                                             04982000
         DC    AL4(PRMSG09)                                             04983000
         DC    AL4(PRMSG10)                                             04984000
         DC    AL4(PRMSG11)                                             04985000
         DC    AL4(PRMSG12)                                             04986000
         DC    AL4(PRMSG13)                                             04987000
         DC    AL4(PRMSG14)                                             04988000
         DC    AL4(PRMSG15)                                             04989000
         DC    AL4(PRMSG16)                                             04990000
         DC    AL4(PRMSG17)                                             04991000
         DC    AL4(PRMSG18)                                             04992000
         DC    AL4(PRMSG19)                                             04993000
         DC    AL4(PRMSG20)                                             04994000
         DC    AL4(PRMSG21)                                             04995000
         DC    AL4(PRMSG22)                                             04996000
         DC    AL4(PRMSG23)                                             04997000
         DC    AL4(PRMSG24)                                             04998000
         DC    AL4(PRMSG25)                                             04999000
         DC    AL4(PRMSG26)                                             05000000
         DC    AL4(PRMSG27)                                             05001000
         DC    AL4(PRMSG28)                                             05002000
         DC    AL4(PRMSG29)                                             05003000
         DC    AL4(PRMSG30)                                             05004000
         DC    AL4(PRMSG31)                                             05005000
         DC    AL4(PRMSG32)                                             05006000
         DC    AL4(PRMSG33)                                             05007000
         DC    AL4(PRMSG34)                                             05008000
         DC    AL4(PRMSG35)                                             05009000
         DC    AL4(PRMSG36)                                             05010000
IAPCNTRL CSECT                                                          05011000
TESTDCB  DCB   DDNAME=TESTDD,DSORG=PS,DEVD=DA,MACRF=(E)                 05012000
TESTDCBL DC    A(*-TESTDCB)      LENGTH OF TEST DCB                     05013000
PRDCB    DCB   DDNAME=SYSPRINT,BLKSIZE=131,DEVD=DA,LRECL=131,         XX05014000
               MACRF=(PM),RECFM=FBA,DSORG=PS                            05015000
PRDCBL   DC    A(*-PRDCB)        LENGTH OF PRINTER DCB                  05016000
IAPCNTRL CSECT                                                          05017000
*                                /*  PATCH AREA  */                     05018000
         CNOP  0,4               FULLWORD BDWY                          05019000
PATCH    DC    3XL((*-@MAINENT)/60)'0' FIVE PERCENT.                    05020000
@DATD    DSECT                                                          05021000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                05022000
@ENDDATD EQU   *                                                        05023000
IAPCNTRL CSECT                                                          05024000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       05025000
@01      EQU   01                                                       05026000
@02      EQU   02                                                       05027000
@03      EQU   03                                                       05028000
@04      EQU   04                                                       05029000
@05      EQU   05                                                       05030000
@06      EQU   06                                                       05031000
@07      EQU   07                                                       05032000
@08      EQU   08                                                       05033000
@09      EQU   09                                                       05034000
@10      EQU   10                                                       05035000
@11      EQU   11                                                       05036000
@12      EQU   12                                                       05037000
@13      EQU   13                                                       05038000
@14      EQU   14                                                       05039000
@15      EQU   15                                                       05040000
COUNTER2 EQU   @02                                                      05041000
COUNTER  EQU   @09                                                      05042000
CCWPTR   EQU   @02                                                      05043000
DDPTR    EQU   @02                                                      05044000
DEBPTR   EQU   @03                                                      05045000
UCBPTR   EQU   @09                                                      05046000
AP1REG   EQU   @08                                                      05047000
GPR00P   EQU   @00                                                      05048000
GPR00F   EQU   @00                                                      05049000
GPR01P   EQU   @01                                                      05050000
GPR01F   EQU   @01                                                      05051000
GPR15P   EQU   @15                                                      05052000
GPR15F   EQU   @15                                                      05053000
GPR02P   EQU   @02                                                      05054000
GPR02F   EQU   @02                                                      05055000
GPR03F   EQU   @03                                                      05056000
GPR03P   EQU   @03                                                      05057000
GPR04F   EQU   @04                                                      05058000
GPR09F   EQU   @09                                                      05059000
GPR11F   EQU   @11                                                      05060000
GPR11P   EQU   @11                                                      05061000
GPR12F   EQU   @12                                                      05062000
GPR12P   EQU   @12                                                      05063000
GPR13F   EQU   @13                                                      05064000
GPR13P   EQU   @13                                                      05065000
GPR14P   EQU   @14                                                      05066000
GPR10F   EQU   @10                                                      05067000
GPR10P   EQU   @10                                                      05068000
GPR14F   EQU   @14                                                      05069000
PSA      EQU   0                                                        05070000
FLCRNPSW EQU   PSA                                                      05071000
FLCROPSW EQU   PSA+8                                                    05072000
FLCICCW2 EQU   PSA+16                                                   05073000
FLCCVT   EQU   FLCICCW2                                                 05074000
PSAEEPSW EQU   PSA+132                                                  05075000
PSAESPSW EQU   PSA+136                                                  05076000
FLCSVILC EQU   PSAESPSW+1                                               05077000
PSAEPPSW EQU   PSA+140                                                  05078000
FLCPIILC EQU   PSAEPPSW+1                                               05079000
FLCPICOD EQU   PSAEPPSW+2                                               05080000
PSAPICOD EQU   FLCPICOD+1                                               05081000
FLCTEA   EQU   PSAEPPSW+4                                               05082000
FLCPER   EQU   PSA+152                                                  05083000
FLCMCLA  EQU   PSA+168                                                  05084000
FLCIOEL  EQU   FLCMCLA+4                                                05085000
FLCIOA   EQU   FLCMCLA+16                                               05086000
FLCFSA   EQU   FLCMCLA+80                                               05087000
PSASUPER EQU   PSA+552                                                  05088000
PSASUP1  EQU   PSASUPER                                                 05089000
PSASUP2  EQU   PSASUPER+1                                               05090000
PSASUP3  EQU   PSASUPER+2                                               05091000
PSASUP4  EQU   PSASUPER+3                                               05092000
PSACLHT  EQU   PSA+640                                                  05093000
PSALKSA  EQU   PSA+696                                                  05094000
PSAHLHI  EQU   PSA+760                                                  05095000
PSALITA  EQU   PSA+764                                                  05096000
PSADSSFL EQU   PSA+836                                                  05097000
PSADSSF1 EQU   PSADSSFL                                                 05098000
PSADSSF3 EQU   PSADSSFL+2                                               05099000
PSADSSF4 EQU   PSADSSFL+3                                               05100000
PSARSVT  EQU   PSA+896                                                  05101000
AP1BLOCK EQU   0                                                        05102000
AP1HDR   EQU   AP1BLOCK                                                 05103000
AP1PDCBA EQU   AP1BLOCK+4                                               05104000
AP1PRINT EQU   AP1BLOCK+8                                               05105000
AP1PRASA EQU   AP1PRINT                                                 05106000
AP1PRMSG EQU   AP1PRINT+1                                               05107000
AP1PRCOD EQU   AP1BLOCK+139                                             05108000
AP1PRPAG EQU   AP1BLOCK+140                                             05109000
AP1PRLIN EQU   AP1BLOCK+142                                             05110000
AP1PFLG1 EQU   AP1BLOCK+144                                             05111000
AP1PROPN EQU   AP1PFLG1                                                 05112000
AP1PRNP  EQU   AP1PFLG1                                                 05113000
AP1PRCLS EQU   AP1PFLG1                                                 05114000
AP1CNCOD EQU   AP1BLOCK+145                                             05115000
AP1CNRPL EQU   AP1BLOCK+146                                             05116000
AP1RECB  EQU   AP1BLOCK+152                                             05117000
AP1WRKA  EQU   AP1BLOCK+156                                             05118000
AP1CCWA  EQU   AP1BLOCK+160                                             05119000
AP1BUFAD EQU   AP1BLOCK+164                                             05120000
AP1BUFAB EQU   AP1BUFAD+1                                               05121000
AP1TIMEA EQU   AP1BLOCK+168                                             05122000
AP1TCBAD EQU   AP1BLOCK+172                                             05123000
AP1TIMFL EQU   AP1BLOCK+176                                             05124000
AP1TIMFA EQU   AP1TIMFL                                                 05125000
AP1IOACT EQU   AP1TIMFA                                                 05126000
AP1TIMIN EQU   AP1TIMFA                                                 05127000
AP1PCODE EQU   AP1BLOCK+180                                             05128000
AP1CSW   EQU   AP1BLOCK+181                                             05129000
AP1SNS   EQU   AP1BLOCK+188                                             05130000
AP1FM    EQU   AP1BLOCK+212                                             05131000
AP1SEEK  EQU   AP1BLOCK+213                                             05132000
CCHHR    EQU   AP1SEEK+3                                                05133000
CCHH     EQU   CCHHR                                                    05134000
CC       EQU   CCHH                                                     05135000
HH       EQU   CCHH+2                                                   05136000
R        EQU   CCHHR+4                                                  05137000
AP1CESK  EQU   AP1BLOCK+221                                             05138000
CECCHHR  EQU   AP1CESK+2                                                05139000
CECCHH   EQU   CECCHHR                                                  05140000
AP1DCBA  EQU   AP1BLOCK+228                                             05141000
AP1DEBA  EQU   AP1BLOCK+232                                             05142000
AP1IOBA  EQU   AP1BLOCK+236                                             05143000
AP1IOECB EQU   AP1BLOCK+240                                             05144000
AP1FLG2  EQU   AP1BLOCK+244                                             05145000
AP1IOC   EQU   AP1FLG2                                                  05146000
AP1EDP   EQU   AP1FLG2                                                  05147000
AP1FLG3  EQU   AP1BLOCK+245                                             05148000
AP1LST   EQU   AP1FLG3                                                  05149000
AP1ERROR EQU   AP1FLG3                                                  05150000
AP1PRERR EQU   AP1FLG3                                                  05151000
AP1QUIT  EQU   AP1FLG3                                                  05152000
AP1VERIF EQU   AP1FLG3                                                  05153000
AP1RDTST EQU   AP1FLG3                                                  05154000
AP1RDERR EQU   AP1FLG3                                                  05155000
AP1FLG4  EQU   AP1BLOCK+246                                             05156000
AP1NORD  EQU   AP1FLG4                                                  05157000
AP1READ  EQU   AP1FLG4                                                  05158000
AP1DEBCH EQU   AP1FLG4                                                  05159000
AP1ENQD  EQU   AP1FLG4                                                  05160000
AP1DCCNT EQU   AP1BLOCK+248                                             05161000
AP1TSTNO EQU   AP1BLOCK+249                                             05162000
AP1DEVTP EQU   AP1BLOCK+250                                             05163000
AP1RET   EQU   AP1BLOCK+251                                             05164000
AP1ETABA EQU   AP1BLOCK+252                                             05165000
AP1LSTCC EQU   AP1BLOCK+258                                             05166000
AP1LSTHH EQU   AP1BLOCK+260                                             05167000
AP1DEVAD EQU   AP1BLOCK+262                                             05168000
AP1ENQAD EQU   AP1BLOCK+266                                             05169000
AP1ERRTM EQU   AP1BLOCK+270                                             05170000
AP1ERRTF EQU   AP1BLOCK+300                                             05171000
CVTMAP   EQU   0                                                        05172000
CVTTCBP  EQU   CVTMAP                                                   05173000
CVTDAR   EQU   CVTMAP+72                                                05174000
CVTFLGS1 EQU   CVTDAR                                                   05175000
CVTBRET  EQU   CVTMAP+82                                                05176000
CVTDCB   EQU   CVTMAP+116                                               05177000
CVTIOQET EQU   CVTMAP+120                                               05178000
CVTIERLC EQU   CVTMAP+144                                               05179000
CVTHEAD  EQU   CVTMAP+160                                               05180000
CVTSV76C EQU   CVTHEAD                                                  05181000
CVTOPTA  EQU   CVTMAP+182                                               05182000
CVTOPTB  EQU   CVTMAP+183                                               05183000
CVTGTF   EQU   CVTMAP+236                                               05184000
CVTGTFST EQU   CVTGTF                                                   05185000
CVTGTFS  EQU   CVTGTFST                                                 05186000
CVTSTATE EQU   CVTGTFST                                                 05187000
CVTTMODE EQU   CVTGTFST                                                 05188000
CVTFORM  EQU   CVTGTFST                                                 05189000
CVTAQAVT EQU   CVTMAP+240                                               05190000
CVTTCMFG EQU   CVTAQAVT                                                 05191000
CVTVOLM2 EQU   CVTMAP+244                                               05192000
CVTTATA  EQU   CVTVOLM2                                                 05193000
CVTTSKS  EQU   CVTTATA                                                  05194000
CVTVOLF2 EQU   CVTTSKS                                                  05195000
CVTTAT   EQU   CVTTATA+1                                                05196000
CVTATER  EQU   CVTMAP+248                                               05197000
CVTEXT1  EQU   CVTMAP+252                                               05198000
CVTPURG  EQU   CVTMAP+260                                               05199000
CVTQMSG  EQU   CVTMAP+268                                               05200000
CVTDMSR  EQU   CVTMAP+272                                               05201000
CVTRSV37 EQU   CVTDMSR                                                  05202000
CVTDMSRF EQU   CVTRSV37                                                 05203000
CVTERPV  EQU   CVTMAP+316                                               05204000
CVTINTLA EQU   CVTMAP+320                                               05205000
CVTAPF   EQU   CVTMAP+324                                               05206000
CVTEXT2  EQU   CVTMAP+328                                               05207000
CVTHJES  EQU   CVTMAP+332                                               05208000
CVTPGSIA EQU   CVTMAP+348                                               05209000
CVTA1F1  EQU   CVTMAP+356                                               05210000
CVTSYSK  EQU   CVTMAP+357                                               05211000
CVTVOLM1 EQU   CVTMAP+380                                               05212000
CVTVOLF1 EQU   CVTVOLM1                                                 05213000
CVTATMCT EQU   CVTMAP+388                                               05214000
CVTXTNT1 EQU   0                                                        05215000
CVTXTNT2 EQU   0                                                        05216000
CVTDSSV  EQU   CVTXTNT2                                                 05217000
CVTFLGBT EQU   CVTXTNT2+5                                               05218000
CVTQID   EQU   CVTXTNT2+24                                              05219000
CVTRV400 EQU   CVTXTNT2+52                                              05220000
CVTRV409 EQU   CVTXTNT2+53                                              05221000
CVTATCVT EQU   CVTXTNT2+64                                              05222000
CVTRV429 EQU   CVTXTNT2+84                                              05223000
CVTRV438 EQU   CVTXTNT2+85                                              05224000
CVTRV457 EQU   CVTXTNT2+112                                             05225000
CVTRV466 EQU   CVTXTNT2+113                                             05226000
CVTFIX   EQU   0                                                        05227000
CVTRELNO EQU   CVTFIX+252                                               05228000
IHADCB   EQU   0                                                        05229000
IHADCS00 EQU   0                                                        05230000
DCBFDAD  EQU   IHADCS00+5                                               05231000
IHADCS01 EQU   0                                                        05232000
DCBDVTBL EQU   IHADCS01                                                 05233000
IHADCS11 EQU   0                                                        05234000
DCBRELB  EQU   IHADCS11                                                 05235000
DCBREL   EQU   DCBRELB+1                                                05236000
DCBBUFCB EQU   IHADCS11+4                                               05237000
DCBDSORG EQU   IHADCS11+10                                              05238000
DCBDSRG1 EQU   DCBDSORG                                                 05239000
DCBDSRG2 EQU   DCBDSORG+1                                               05240000
DCBIOBAD EQU   IHADCS11+12                                              05241000
DCBODEB  EQU   DCBIOBAD                                                 05242000
DCBLNP   EQU   DCBODEB                                                  05243000
DCBQSLM  EQU   DCBLNP                                                   05244000
DCBIOBAA EQU   DCBODEB+1                                                05245000
IHADCS50 EQU   0                                                        05246000
DCBSVCXL EQU   IHADCS50                                                 05247000
DCBEODAD EQU   IHADCS50+4                                               05248000
DCBBFALN EQU   DCBEODAD                                                 05249000
DCBHIARC EQU   DCBBFALN                                                 05250000
DCBBFTEK EQU   DCBHIARC                                                 05251000
DCBBFT   EQU   DCBBFTEK                                                 05252000
DCBEXLST EQU   IHADCS50+8                                               05253000
DCBRECFM EQU   DCBEXLST                                                 05254000
DCBRECLA EQU   DCBRECFM                                                 05255000
IHADCS24 EQU   0                                                        05256000
DCBOFLGS EQU   IHADCS24+8                                               05257000
DCBOFLWR EQU   DCBOFLGS                                                 05258000
DCBOFOPN EQU   DCBOFLGS                                                 05259000
DCBIFLG  EQU   IHADCS24+9                                               05260000
DCBIBPCT EQU   DCBIFLG                                                  05261000
DCBMACR  EQU   IHADCS24+10                                              05262000
DCBMACR1 EQU   DCBMACR                                                  05263000
DCBMRFE  EQU   DCBMACR1                                                 05264000
DCBMRGET EQU   DCBMRFE                                                  05265000
DCBMRAPG EQU   DCBMACR1                                                 05266000
DCBMRRD  EQU   DCBMRAPG                                                 05267000
DCBMRCI  EQU   DCBMACR1                                                 05268000
DCBMRMVG EQU   DCBMRCI                                                  05269000
DCBMRLCG EQU   DCBMACR1                                                 05270000
DCBMRABC EQU   DCBMACR1                                                 05271000
DCBMRPT1 EQU   DCBMRABC                                                 05272000
DCBMRSBG EQU   DCBMRPT1                                                 05273000
DCBMRCRL EQU   DCBMACR1                                                 05274000
DCBMRCHK EQU   DCBMRCRL                                                 05275000
DCBMRRDX EQU   DCBMRCHK                                                 05276000
DCBMRDMG EQU   DCBMACR1                                                 05277000
DCBMACR2 EQU   DCBMACR+1                                                05278000
DCBMRPUT EQU   DCBMACR2                                                 05279000
DCBMRWRT EQU   DCBMACR2                                                 05280000
DCBMRMVP EQU   DCBMACR2                                                 05281000
DCBMR5WD EQU   DCBMACR2                                                 05282000
DCBMRLDM EQU   DCBMR5WD                                                 05283000
DCBMRLCP EQU   DCBMRLDM                                                 05284000
DCBMR4WD EQU   DCBMACR2                                                 05285000
DCBMRPT2 EQU   DCBMR4WD                                                 05286000
DCBMRTMD EQU   DCBMRPT2                                                 05287000
DCBMR3WD EQU   DCBMACR2                                                 05288000
DCBMRCTL EQU   DCBMR3WD                                                 05289000
DCBMRSTK EQU   DCBMRCTL                                                 05290000
DCBMR1WD EQU   DCBMACR2                                                 05291000
DCBMRSWA EQU   DCBMR1WD                                                 05292000
DCBMRDMD EQU   DCBMRSWA                                                 05293000
IHADCS25 EQU   0                                                        05294000
DCBTIOT  EQU   IHADCS25                                                 05295000
DCBMACRF EQU   IHADCS25+2                                               05296000
DCBMACF1 EQU   DCBMACRF                                                 05297000
DCBMFFE  EQU   DCBMACF1                                                 05298000
DCBMFGET EQU   DCBMFFE                                                  05299000
DCBMFAPG EQU   DCBMACF1                                                 05300000
DCBMFRD  EQU   DCBMFAPG                                                 05301000
DCBMFCI  EQU   DCBMACF1                                                 05302000
DCBMFMVG EQU   DCBMFCI                                                  05303000
DCBMFLCG EQU   DCBMACF1                                                 05304000
DCBMFABC EQU   DCBMACF1                                                 05305000
DCBMFPT1 EQU   DCBMFABC                                                 05306000
DCBMFSBG EQU   DCBMFPT1                                                 05307000
DCBMFCRL EQU   DCBMACF1                                                 05308000
DCBMFCHK EQU   DCBMFCRL                                                 05309000
DCBMFDMG EQU   DCBMACF1                                                 05310000
DCBMACF2 EQU   DCBMACRF+1                                               05311000
DCBMFPUT EQU   DCBMACF2                                                 05312000
DCBMFWRT EQU   DCBMACF2                                                 05313000
DCBMFMVP EQU   DCBMACF2                                                 05314000
DCBMF5WD EQU   DCBMACF2                                                 05315000
DCBMFLDM EQU   DCBMF5WD                                                 05316000
DCBMFLCP EQU   DCBMFLDM                                                 05317000
DCBMF4WD EQU   DCBMACF2                                                 05318000
DCBMFPT2 EQU   DCBMF4WD                                                 05319000
DCBMFTMD EQU   DCBMFPT2                                                 05320000
DCBMF3WD EQU   DCBMACF2                                                 05321000
DCBMFCTL EQU   DCBMF3WD                                                 05322000
DCBMFSTK EQU   DCBMFCTL                                                 05323000
DCBMF1WD EQU   DCBMACF2                                                 05324000
DCBMFSWA EQU   DCBMF1WD                                                 05325000
DCBMFDMD EQU   DCBMFSWA                                                 05326000
DCBDEBAD EQU   IHADCS25+4                                               05327000
DCBIFLGS EQU   DCBDEBAD                                                 05328000
DCBIFPCT EQU   DCBIFLGS                                                 05329000
IHADCS27 EQU   0                                                        05330000
DCBGET   EQU   IHADCS27                                                 05331000
DCBPUT   EQU   DCBGET                                                   05332000
DCBGETA  EQU   DCBPUT+1                                                 05333000
IHADCS28 EQU   0                                                        05334000
IHADCS44 EQU   0                                                        05335000
IHADCS36 EQU   0                                                        05336000
DCBGERR  EQU   IHADCS36                                                 05337000
DCBPERR  EQU   DCBGERR                                                  05338000
DCBCHECK EQU   DCBPERR                                                  05339000
DCBOPTCD EQU   DCBCHECK                                                 05340000
DCBOPTH  EQU   DCBOPTCD                                                 05341000
DCBOPTO  EQU   DCBOPTH                                                  05342000
DCBOPTZ  EQU   DCBOPTCD                                                 05343000
DCBGERRA EQU   DCBCHECK+1                                               05344000
DCBPERRA EQU   DCBGERRA                                                 05345000
DCBSYNAD EQU   IHADCS36+4                                               05346000
DCBCIND1 EQU   IHADCS36+8                                               05347000
DCBCIND2 EQU   IHADCS36+9                                               05348000
DCBIOBA  EQU   IHADCS36+16                                              05349000
DCBCICB  EQU   DCBIOBA                                                  05350000
IHADCS52 EQU   0                                                        05351000
DCBDIRCT EQU   IHADCS52                                                 05352000
DCBQSWS  EQU   DCBDIRCT                                                 05353000
DCBUSASI EQU   DCBQSWS                                                  05354000
DCBQADFS EQU   DCBUSASI                                                 05355000
DCBBUFOF EQU   DCBDIRCT+1                                               05356000
IHADCS37 EQU   0                                                        05357000
DCBFLAG1 EQU   IHADCS37                                                 05358000
IHADCS40 EQU   0                                                        05359000
DCBEOBAD EQU   IHADCS40                                                 05360000
DCBCCCW  EQU   IHADCS40+4                                               05361000
DCBRECAD EQU   DCBCCCW                                                  05362000
DCBRECBT EQU   DCBRECAD                                                 05363000
DCBRCREL EQU   DCBRECBT                                                 05364000
DCBCNTRL EQU   IHADCS40+12                                              05365000
DCBEROPT EQU   DCBCNTRL                                                 05366000
IOBPREFX EQU   0                                                        05367000
IOBCFLG1 EQU   IOBPREFX                                                 05368000
IOBSTDRD EQU   0                                                        05369000
IOBFLAG1 EQU   IOBSTDRD                                                 05370000
IOBCMDCH EQU   IOBFLAG1                                                 05371000
IOBCYCCK EQU   IOBFLAG1                                                 05372000
IOBUNREL EQU   IOBFLAG1                                                 05373000
IOBRSTRT EQU   IOBFLAG1                                                 05374000
IOBFLAG2 EQU   IOBSTDRD+1                                               05375000
IOBPURGE EQU   IOBFLAG2                                                 05376000
IOBRDHA0 EQU   IOBFLAG2                                                 05377000
IOBSENS0 EQU   IOBSTDRD+2                                               05378000
IOBS0B7  EQU   IOBSENS0                                                 05379000
IOBSENS1 EQU   IOBSTDRD+3                                               05380000
IOBECBPT EQU   IOBSTDRD+4                                               05381000
IOBFLAG3 EQU   IOBSTDRD+8                                               05382000
IOBFL3   EQU   IOBFLAG3                                                 05383000
IOBCNC   EQU   IOBFL3                                                   05384000
IOBICL   EQU   IOBFL3                                                   05385000
IOBCSW   EQU   IOBSTDRD+9                                               05386000
IOBIOCSW EQU   IOBCSW                                                   05387000
IOBSTBYT EQU   IOBIOCSW+3                                               05388000
IOBUSTAT EQU   IOBSTBYT                                                 05389000
IOBCSTAT EQU   IOBSTBYT+1                                               05390000
IOBSTART EQU   IOBSTDRD+16                                              05391000
IOBDCBPT EQU   IOBSTDRD+20                                              05392000
IOBFLAG4 EQU   IOBDCBPT                                                 05393000
IOBRESTR EQU   IOBSTDRD+24                                              05394000
IOBINCAM EQU   IOBSTDRD+28                                              05395000
IOBBTAMF EQU   IOBINCAM                                                 05396000
DEBBASIC EQU   0                                                        05397000
DEBTCBAD EQU   DEBBASIC                                                 05398000
DEBDEBAD EQU   DEBBASIC+4                                               05399000
DEBDEBB  EQU   DEBDEBAD+1                                               05400000
DEBIRBAD EQU   DEBBASIC+8                                               05401000
DEBOFLGS EQU   DEBIRBAD                                                 05402000
DEBOPATB EQU   DEBBASIC+12                                              05403000
DEBFLGS1 EQU   DEBBASIC+14                                              05404000
DEBUSRPG EQU   DEBBASIC+16                                              05405000
DEBNMEXT EQU   DEBUSRPG                                                 05406000
DEBRRQ   EQU   DEBBASIC+20                                              05407000
DEBECBAD EQU   DEBRRQ                                                   05408000
DEBDCBAD EQU   DEBBASIC+24                                              05409000
DEBPROTG EQU   DEBDCBAD                                                 05410000
DEBDEBID EQU   DEBPROTG                                                 05411000
DEBAPPAD EQU   DEBBASIC+28                                              05412000
DEBEXSCL EQU   DEBAPPAD                                                 05413000
DEBAPPB  EQU   DEBAPPAD+1                                               05414000
DEBBASND EQU   DEBBASIC+32                                              05415000
DEBDASD  EQU   0                                                        05416000
DEBUCBAD EQU   DEBDASD                                                  05417000
DEBDVMOD EQU   DEBUCBAD                                                 05418000
DEBSTRCC EQU   DEBDASD+6                                                05419000
DEBSTRHH EQU   DEBDASD+8                                                05420000
DEBENDCC EQU   DEBDASD+10                                               05421000
DEBENDHH EQU   DEBDASD+12                                               05422000
DEBACSMD EQU   0                                                        05423000
DEBVOLSQ EQU   DEBACSMD                                                 05424000
DEBVOLBT EQU   DEBVOLSQ                                                 05425000
DEBDSNM  EQU   DEBACSMD+4                                               05426000
DEBUTSAA EQU   DEBDSNM                                                  05427000
DEBACS01 EQU   0                                                        05428000
DEBDSNAM EQU   DEBACS01                                                 05429000
DEBACS02 EQU   0                                                        05430000
DEBDBLK  EQU   DEBACS02                                                 05431000
DEBACS03 EQU   0                                                        05432000
DEBACS04 EQU   0                                                        05433000
DEBTBFRA EQU   DEBACS04                                                 05434000
DEBTCCWA EQU   DEBACS04+4                                               05435000
DEBACS05 EQU   0                                                        05436000
DEBFUCBA EQU   DEBACS05                                                 05437000
DEBLUCBA EQU   DEBACS05+4                                               05438000
DEBACS06 EQU   0                                                        05439000
DEBACS07 EQU   0                                                        05440000
DEBACS08 EQU   0                                                        05441000
DEBSUBNM EQU   0                                                        05442000
DEB      EQU   0                                                        05443000
DEBAVT   EQU   DEB                                                      05444000
DEBEOEA  EQU   DEBAVT                                                   05445000
DEBEOEAB EQU   DEBEOEA                                                  05446000
DEBSIOA  EQU   DEBAVT+4                                                 05447000
DEBSIOAB EQU   DEBSIOA                                                  05448000
DEBPGFX  EQU   DEBSIOAB                                                 05449000
DEBSIONP EQU   DEBSIOAB                                                 05450000
DEBPCIA  EQU   DEBAVT+8                                                 05451000
DEBPCIAB EQU   DEBPCIA                                                  05452000
DEBCEA   EQU   DEBAVT+12                                                05453000
DEBCEAB  EQU   DEBCEA                                                   05454000
DEBXCEA  EQU   DEBAVT+16                                                05455000
DEBXCEAB EQU   DEBXCEA                                                  05456000
DEBXCENP EQU   DEBXCEAB                                                 05457000
DEBPREFX EQU   DEB+20                                                   05458000
DEBXTNP  EQU   DEBPREFX+8                                               05459000
DEBLNGTH EQU   DEBPREFX+12                                              05460000
DEBXTN   EQU   0                                                        05461000
DEBXFLG1 EQU   DEBXTN+2                                                 05462000
TCBWORDS EQU   0                                                        05463000
TCBPTR   EQU   TCBWORDS+4                                               05464000
TCBFIX   EQU   0                                                        05465000
TCBFRS   EQU   TCBFIX                                                   05466000
TCB      EQU   0                                                        05467000
TCBPIE   EQU   TCB+4                                                    05468000
TCBPMASK EQU   TCBPIE                                                   05469000
TCBDEB   EQU   TCB+8                                                    05470000
TCBTIO   EQU   TCB+12                                                   05471000
TCBCMP   EQU   TCB+16                                                   05472000
TCBCMPF  EQU   TCBCMP                                                   05473000
TCBCPP   EQU   TCBCMPF                                                  05474000
TCBSTCC  EQU   TCBCMPF                                                  05475000
TCBCDBL  EQU   TCBCMPF                                                  05476000
TCBCWTO  EQU   TCBCMPF                                                  05477000
TCBCIND  EQU   TCBCMPF                                                  05478000
TCBCMSG  EQU   TCBCMPF                                                  05479000
TCBTRN   EQU   TCB+20                                                   05480000
TCBABF   EQU   TCBTRN                                                   05481000
TCBMSS   EQU   TCB+24                                                   05482000
TCBPKF   EQU   TCB+28                                                   05483000
TCBFLGS  EQU   TCB+29                                                   05484000
TCBFLGS1 EQU   TCBFLGS                                                  05485000
TCBFLGS2 EQU   TCBFLGS+1                                                05486000
TCBFLGS3 EQU   TCBFLGS+2                                                05487000
TCBFLGS4 EQU   TCBFLGS+3                                                05488000
TCBFLGS5 EQU   TCBFLGS+4                                                05489000
TCBABWF  EQU   TCBFLGS5                                                 05490000
TCBJPQ   EQU   TCB+44                                                   05491000
TCBPURGE EQU   TCBJPQ                                                   05492000
TCBGRS   EQU   TCB+48                                                   05493000
TCBFSA   EQU   TCB+112                                                  05494000
TCBTME   EQU   TCB+120                                                  05495000
TCBJSTCB EQU   TCB+124                                                  05496000
TCBTSFLG EQU   TCB+148                                                  05497000
TCBTSTSK EQU   TCBTSFLG                                                 05498000
TCBSTAB  EQU   TCB+160                                                  05499000
TCBNSTAE EQU   TCBSTAB                                                  05500000
TCBTCT   EQU   TCB+164                                                  05501000
TCBTCTGF EQU   TCBTCT                                                   05502000
TCBSCNDY EQU   TCB+172                                                  05503000
TCBNDSP  EQU   TCBSCNDY                                                 05504000
TCBNDSP1 EQU   TCBNDSP+1                                                05505000
TCBNDSP2 EQU   TCBNDSP+2                                                05506000
TCBNDSP3 EQU   TCBNDSP+3                                                05507000
TCBJSCB  EQU   TCB+180                                                  05508000
TCBRECDE EQU   TCBJSCB                                                  05509000
TCBEXT1  EQU   TCB+196                                                  05510000
TCBBITS  EQU   TCB+200                                                  05511000
TCBNDSP4 EQU   TCBBITS                                                  05512000
TCBNDSP5 EQU   TCBBITS+1                                                05513000
TCBFLGS6 EQU   TCBBITS+2                                                05514000
TCBFLGS7 EQU   TCBBITS+3                                                05515000
TCBDAR   EQU   TCB+204                                                  05516000
TCBDARC  EQU   TCBDAR                                                   05517000
TCBEXT2  EQU   TCB+208                                                  05518000
TCBFOE   EQU   TCB+244                                                  05519000
TCBESTAE EQU   TCB+264                                                  05520000
TCBESTRM EQU   TCBESTAE+1                                               05521000
TCBFBYT1 EQU   TCB+276                                                  05522000
TCBFBYT2 EQU   TCB+277                                                  05523000
TCBRV124 EQU   TCB+278                                                  05524000
TCBRV133 EQU   TCB+279                                                  05525000
TCBXTNT2 EQU   0                                                        05526000
TCBGTF   EQU   TCBXTNT2                                                 05527000
TCBTFLG  EQU   TCBGTF                                                   05528000
TCBRV146 EQU   TCBXTNT2+28                                              05529000
TCBRV155 EQU   TCBXTNT2+29                                              05530000
TCBRV164 EQU   TCBXTNT2+30                                              05531000
TCBRV173 EQU   TCBXTNT2+31                                              05532000
TIOT1    EQU   0                                                        05533000
UCB      EQU   0                                                        05534000
UCBOB    EQU   0                                                        05535000
UCBJBNR  EQU   UCBOB                                                    05536000
UCBVRDEV EQU   UCBJBNR                                                  05537000
UCBFL5   EQU   UCBOB+1                                                  05538000
UCBAF    EQU   UCBFL5                                                   05539000
UCBSTAT  EQU   UCBOB+3                                                  05540000
UCBCHAN  EQU   UCBOB+4                                                  05541000
UCBSFLS  EQU   UCBOB+6                                                  05542000
UCBFLA   EQU   UCBSFLS                                                  05543000
UCBFL1   EQU   UCBFLA                                                   05544000
UCBBSY   EQU   UCBFL1                                                   05545000
UCBNRY   EQU   UCBFL1                                                   05546000
UCBPST   EQU   UCBFL1                                                   05547000
UCBCUB   EQU   UCBFL1                                                   05548000
UCBFLB   EQU   UCBSFLS+1                                                05549000
UCBCHM   EQU   UCBOB+8                                                  05550000
UCBCHM1  EQU   UCBCHM                                                   05551000
UCBPTH0  EQU   UCBCHM1                                                  05552000
UCBPTH1  EQU   UCBCHM1                                                  05553000
UCBWGT   EQU   UCBOB+12                                                 05554000
UCBNAME  EQU   UCBOB+13                                                 05555000
UCBTYP   EQU   UCBOB+16                                                 05556000
UCBTBYT1 EQU   UCBTYP                                                   05557000
UCB1FEA5 EQU   UCBTBYT1                                                 05558000
UCB1FEA6 EQU   UCBTBYT1                                                 05559000
UCBTBYT2 EQU   UCBTYP+1                                                 05560000
UCB2OPT2 EQU   UCBTBYT2                                                 05561000
UCBDUDN1 EQU   UCB2OPT2                                                 05562000
UCB2OPT3 EQU   UCBTBYT2                                                 05563000
UCBDUDN2 EQU   UCB2OPT3                                                 05564000
UCB2OPT4 EQU   UCBTBYT2                                                 05565000
UCBRWTAU EQU   UCB2OPT4                                                 05566000
UCB2OPT6 EQU   UCBTBYT2                                                 05567000
UCB2OPT7 EQU   UCBTBYT2                                                 05568000
UCBTBYT3 EQU   UCBTYP+2                                                 05569000
UCBDVCLS EQU   UCBTBYT3                                                 05570000
UCB3DACC EQU   UCBDVCLS                                                 05571000
UCBTBYT4 EQU   UCBTYP+3                                                 05572000
UCBEXTPT EQU   UCBOB+20                                                 05573000
UCBFLC   EQU   UCBEXTPT                                                 05574000
UCBDEV   EQU   UCBOB+24                                                 05575000
UCBCMEXT EQU   0                                                        05576000
UCBATI   EQU   UCBCMEXT+3                                               05577000
@NM00072 EQU   UCBATI                                                   05578000
UCBFLP1  EQU   UCBCMEXT+5                                               05579000
UCBMT    EQU   0                                                        05580000
UCBOCR   EQU   0                                                        05581000
UCB3540X EQU   0                                                        05582000
UCBDKBYT EQU   UCB3540X+6                                               05583000
UCB3800X EQU   0                                                        05584000
UCBOPTNS EQU   UCB3800X                                                 05585000
UCBACTIV EQU   UCB3800X+3                                               05586000
UCBMDRBF EQU   UCB3800X+36                                              05587000
UCBUCS   EQU   0                                                        05588000
UCBUCSOP EQU   UCBUCS+4                                                 05589000
UCBFCBOP EQU   UCBUCS+5                                                 05590000
BUFFER   EQU   0                                                        05591000
ERRTAB   EQU   0                                                        05592000
DCK      EQU   ERRTAB                                                   05593000
SKVERCK  EQU   ERRTAB                                                   05594000
WRTCK    EQU   ERRTAB                                                   05595000
DCKCE    EQU   ERRTAB                                                   05596000
DATACOMP EQU   ERRTAB                                                   05597000
CCW      EQU   0                                                        05598000
CCWADDRA EQU   CCW                                                      05599000
CCWCOMCD EQU   CCWADDRA                                                 05600000
@NM00073 EQU   CCWCOMCD                                                 05601000
CCWADDRB EQU   CCWADDRA+1                                               05602000
CCWFLGS  EQU   CCW+4                                                    05603000
WRKAREA  EQU   0                                                        05604000
WRKAD    EQU   WRKAREA                                                  05605000
WRKFLG   EQU   WRKAD                                                    05606000
WRKENDFL EQU   WRKFLG                                                   05607000
CNMSGXX  EQU   0                                                        05608000
MSGRPLY  EQU   CNMSGXX                                                  05609000
MSGRLEN  EQU   MSGRPLY                                                  05610000
MSGRPTR  EQU   MSGRPLY+1                                                05611000
MSGECBA  EQU   CNMSGXX+4                                                05612000
CNMSGXXL EQU   CNMSGXX+8                                                05613000
CNMSGXXT EQU   CNMSGXX+12                                               05614000
MSGDEVAD EQU   CNMSGXXT+8                                               05615000
PRMSGXX  EQU   0                                                        05616000
PRMSGXXL EQU   PRMSGXX                                                  05617000
PRMSGXXT EQU   PRMSGXX+2                                                05618000
BYTE1    EQU   0                                                        05619000
BYTE30   EQU   0                                                        05620000
BYTE60   EQU   0                                                        05621000
BYTE256  EQU   0                                                        05622000
FIXED16  EQU   0                                                        05623000
SEEK     EQU   0                                                        05624000
SEEKCCHH EQU   SEEK+2                                                   05625000
CSW      EQU   0                                                        05626000
CSWADDRA EQU   CSW                                                      05627000
CSWADDRB EQU   CSWADDRA+1                                               05628000
CSWSTATS EQU   CSW+4                                                    05629000
CSWSTAT1 EQU   CSWSTATS                                                 05630000
CSWERR1  EQU   CSWSTAT1                                                 05631000
CSWUNCHK EQU   CSWSTAT1                                                 05632000
CSWUNEXP EQU   CSWSTAT1                                                 05633000
CSWSTAT2 EQU   CSWSTATS+1                                               05634000
SNSD     EQU   0                                                        05635000
SNS0     EQU   SNSD                                                     05636000
SNSEQU   EQU   SNS0                                                     05637000
SNSDATA  EQU   SNS0                                                     05638000
SNS1     EQU   SNSD+1                                                   05639000
SNSIFMT  EQU   SNS1                                                     05640000
SNSNRF   EQU   SNS1                                                     05641000
SNS2     EQU   SNSD+2                                                   05642000
SNS5     EQU   SNSD+5                                                   05643000
SNS6     EQU   SNSD+6                                                   05644000
SNSCYLB  EQU   SNS6                                                     05645000
SNSCYLC  EQU   SNS6                                                     05646000
SNS7     EQU   SNSD+7                                                   05647000
SNS17    EQU   SNSD+17                                                  05648000
ECBCC    EQU   0                                                        05649000
CNT      EQU   0                                                        05650000
CNTCCHHR EQU   CNT                                                      05651000
CNTCCHH  EQU   CNTCCHHR                                                 05652000
CNTHH    EQU   CNTCCHH+2                                                05653000
CNTR     EQU   CNTCCHHR+4                                               05654000
BYTE6    EQU   0                                                        05655000
BYTE8    EQU   0                                                        05656000
I001C    EQU   0                                                        05657000
I008P    EQU   0                                                        05658000
I015F    EQU   0                                                        05659000
I015P    EQU   0                                                        05660000
I031F    EQU   0                                                        05661000
I031P    EQU   0                                                        05662000
I256C    EQU   0                                                        05663000
UCBBGN   EQU   0                                                        05664000
PARM     EQU   0                                                        05665000
PARMLEN  EQU   PARM                                                     05666000
PARMDATA EQU   PARM+2                                                   05667000
INAREA   EQU   0                                                        05668000
OUTAREA  EQU   0                                                        05669000
BYTES    EQU   0                                                        05670000
HHR      EQU   HH                                                       05671000
CVTS01   EQU   CVTPGSIA                                                 05672000
CVTLPDIA EQU   CVTS01+12                                                05673000
CVTDIRST EQU   CVTLPDIA                                                 05674000
CVTSLIDA EQU   CVTS01+24                                                05675000
CVTCTLFG EQU   CVTS01+50                                                05676000
CVTRV210 EQU   CVTS01+424                                               05677000
CVTRV219 EQU   CVTS01+425                                               05678000
CVTRV228 EQU   CVTS01+426                                               05679000
CVTRV237 EQU   CVTS01+427                                               05680000
CVTMFRTR EQU   CVTS01+452                                               05681000
CVTRV262 EQU   CVTS01+468                                               05682000
CVTRV271 EQU   CVTS01+469                                               05683000
CVTRV280 EQU   CVTS01+470                                               05684000
CVTRV289 EQU   CVTS01+471                                               05685000
CVTGSDA  EQU   CVTS01+600                                               05686000
IOBORG01 EQU   IOBPREFX+8                                               05687000
IOBNIOBA EQU   IOBORG01                                                 05688000
IOBNFLG1 EQU   IOBNIOBA                                                 05689000
IOBPRTOV EQU   IOBNFLG1                                                 05690000
IOBORG02 EQU   IOBPREFX+8                                               05691000
IOBDQADA EQU   IOBORG02                                                 05692000
IOBDEQIN EQU   IOBDQADA                                                 05693000
IOBORG03 EQU   IOBPREFX+12                                              05694000
IOBORG04 EQU   IOBINCAM                                                 05695000
IOBORG12 EQU   IOBINCAM                                                 05696000
IOBFL4   EQU   IOBORG12                                                 05697000
IOBEXTEN EQU   IOBSTDRD+32                                              05698000
IOBSEEK  EQU   IOBEXTEN                                                 05699000
IOBBB    EQU   IOBSEEK+1                                                05700000
IOBCC    EQU   IOBSEEK+3                                                05701000
IOBHH    EQU   IOBSEEK+5                                                05702000
IOBORG05 EQU   IOBEXTEN                                                 05703000
IOBORG06 EQU   IOBEXTEN                                                 05704000
IOBNXTPT EQU   IOBORG06+4                                               05705000
IOBSTATA EQU   IOBNXTPT                                                 05706000
IOBORG07 EQU   IOBEXTEN+8                                               05707000
W1IEXTEN EQU   IOBORG07                                                 05708000
IOBORG08 EQU   IOBEXTEN+8                                               05709000
IOBINDCT EQU   IOBORG08+4                                               05710000
IOBUNSQR EQU   IOBORG08+5                                               05711000
IOBFCHAD EQU   IOBORG08+8                                               05712000
IOBORG09 EQU   IOBEXTEN+8                                               05713000
IOBDPLAD EQU   IOBORG09+4                                               05714000
IOBDTYPE EQU   IOBORG09+8                                               05715000
IOBDTYP2 EQU   IOBORG09+9                                               05716000
IOBDSTAT EQU   IOBORG09+10                                              05717000
IOBSTAT1 EQU   IOBDSTAT                                                 05718000
IOBORG10 EQU   IOBEXTEN+8                                               05719000
IOBSEEK2 EQU   IOBORG10                                                 05720000
IOBORG11 EQU   IOBEXTEN                                                 05721000
IOBERCT  EQU   IOBORG11                                                 05722000
IOBUCBXV EQU   IOBERCT                                                  05723000
IOBNAME  EQU   IOBORG11+4                                               05724000
IOBORG13 EQU   IOBEXTEN                                                 05725000
IOBSKADR EQU   IOBORG13                                                 05726000
DEBBAS02 EQU   DEBBASND                                                 05727000
DEBDDS1  EQU   DEBBAS02                                                 05728000
DEBSUCBA EQU   DEBDDS1                                                  05729000
DEBDEVED EQU   DEBDDS1+4                                                05730000
DEBRDCB  EQU   DEBDDS1+4                                                05731000
DEBPDCB  EQU   DEBDDS1+8                                                05732000
DEBWDCB  EQU   DEBDDS1+12                                               05733000
DEBACS09 EQU   DEBDEVED                                                 05734000
DEBASC09 EQU   DEBACS09                                                 05735000
DEBEAMFG EQU   DEBASC09+3                                               05736000
DEBDSID  EQU   DEBASC09+4                                               05737000
DEBEOD   EQU   DEBASC09+12                                              05738000
DEBBOE   EQU   DEBEOD                                                   05739000
DEBEODRV EQU   DEBBOE                                                   05740000
DEBEODTT EQU   DEBBOE+1                                                 05741000
DEBEOD0  EQU   DEBBOE+2                                                 05742000
DEBEODSS EQU   DEBBOE+3                                                 05743000
DEBBAS01 EQU   DEBBASND                                                 05744000
DEBISAM  EQU   DEBBAS01                                                 05745000
DEBFIEAD EQU   DEBISAM                                                  05746000
DEBFPEAD EQU   DEBISAM+4                                                05747000
DEBFOEAD EQU   DEBISAM+8                                                05748000
DEBEXPT  EQU   DEBISAM+12                                               05749000
DEBRPSID EQU   DEBEXPT                                                  05750000
PSARSVTE EQU   PSARSVT                                                  05751000
TIOENTRY EQU   TIOT1+24                                                 05752000
TIOELNGH EQU   TIOENTRY                                                 05753000
TIOESTTA EQU   TIOENTRY+1                                               05754000
TIOERLOC EQU   TIOENTRY+2                                               05755000
TIOELINK EQU   TIOERLOC+1                                               05756000
TIOESYOT EQU   TIOELINK                                                 05757000
TIOEDDNM EQU   TIOENTRY+4                                               05758000
TIOESTTC EQU   TIOENTRY+15                                              05759000
TIOESTTB EQU   TIOENTRY+16                                              05760000
TIOEFSRT EQU   TIOENTRY+17                                              05761000
POOLSTAR EQU   TIOENTRY+20                                              05762000
TIOEDEVE EQU   TIOESTTB                                                 05763000
TIOSTTB  EQU   TIOEDEVE                                                 05764000
UCBOBS01 EQU   UCBDEV                                                   05765000
UCBSTAB  EQU   UCBOBS01+10                                              05766000
UCBBSVL  EQU   UCBSTAB                                                  05767000
UCBPRSRS EQU   UCBSTAB                                                  05768000
UCBDMCT  EQU   UCBOBS01+11                                              05769000
UCBFL4   EQU   UCBOBS01+13                                              05770000
UCBOBS02 EQU   UCBDEV                                                   05771000
UCBTFL1  EQU   UCBOBS02+19                                              05772000
UCBXTN   EQU   UCBOBS02+20                                              05773000
UCBVOPT  EQU   UCBXTN                                                   05774000
UCBOBS03 EQU   UCBDEV                                                   05775000
UCBXTADR EQU   UCBOBS03                                                 05776000
UCBOBS04 EQU   UCBDEV                                                   05777000
UCBBTA   EQU   UCBOBS04+12                                              05778000
UCBOBS06 EQU   UCBDEV                                                   05779000
UCBAOF   EQU   UCBOBS06                                                 05780000
UCBAOF1  EQU   UCBAOF                                                   05781000
UCBAOF2  EQU   UCBAOF+1                                                 05782000
@NM00071 EQU   UCBOBS06+3                                               05783000
UCBIRB   EQU   UCBOBS06+4                                               05784000
UCBGRAF  EQU   UCBIRB                                                   05785000
UCBLDNCA EQU   UCBOBS06+8                                               05786000
UCBRDYQ  EQU   UCBLDNCA                                                 05787000
UCBIRLN  EQU   UCBRDYQ                                                  05788000
UCBLDNCB EQU   UCBRDYQ+1                                                05789000
UCBCTLNK EQU   UCBOBS06+12                                              05790000
UCBOBS07 EQU   UCBDEV                                                   05791000
UCBOBS08 EQU   UCBDEV                                                   05792000
UCBCTCAD EQU   UCBOBS08                                                 05793000
UCBCTCF1 EQU   UCBOBS08+4                                               05794000
UCBOBS09 EQU   UCBDEV                                                   05795000
IOBAP1PT EQU   IOBSEEK+8                                                05796000
@NM00076 EQU   WRKAREA                                                  05797000
CNTRKDD  EQU   CNTR                                                     05798000
CNTKDD   EQU   CNTRKDD                                                  05799000
CNTHHR   EQU   CNTHH                                                    05800000
I107     EQU   ILIST                                                    05801000
I10701   EQU   I107                                                     05802000
I10702   EQU   I107+1                                                   05803000
I10703   EQU   I107+2                                                   05804000
I10704   EQU   I107+3                                                   05805000
I042     EQU   ILIST                                                    05806000
I04202   EQU   I042+1                                                   05807000
I04205   EQU   I042+8                                                   05808000
I04213   EQU   I042+24                                                  05809000
I04216   EQU   I042+28                                                  05810000
I04226   EQU   I042+54                                                  05811000
I048     EQU   ILIST                                                    05812000
I04802   EQU   I048+4                                                   05813000
I04803   EQU   I04802                                                   05814000
I04804   EQU   I04803                                                   05815000
I04805   EQU   I04803+1                                                 05816000
I04806   EQU   I04803+2                                                 05817000
I04807   EQU   I04802+4                                                 05818000
I04808   EQU   I04802+8                                                 05819000
FLC      EQU   PSA                                                      05820000
WRKAREAD EQU   WRKAREA                                                  05821000
ZERO1    EQU   ZERO                                                     05822000
ZERO6    EQU   ZERO                                                     05823000
ZERO7    EQU   ZERO                                                     05824000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    05825000
@NM00273 EQU   I04803+3                                                 05826000
I04801   EQU   I048                                                     05827000
I04227   EQU   I042+56                                                  05828000
I04225   EQU   I042+53                                                  05829000
I04224   EQU   I042+52                                                  05830000
I04223   EQU   I042+49                                                  05831000
I04222   EQU   I042+48                                                  05832000
I04221   EQU   I042+45                                                  05833000
I04220   EQU   I042+44                                                  05834000
I04219   EQU   I042+41                                                  05835000
I04218   EQU   I042+40                                                  05836000
I04217   EQU   I042+36                                                  05837000
I04215   EQU   I042+27                                                  05838000
I04214   EQU   I042+26                                                  05839000
I04212   EQU   I042+21                                                  05840000
I04211   EQU   I042+20                                                  05841000
I04210   EQU   I042+17                                                  05842000
I04209   EQU   I042+16                                                  05843000
I04208   EQU   I042+13                                                  05844000
I04207   EQU   I042+12                                                  05845000
I04206   EQU   I042+9                                                   05846000
I04204   EQU   I042+5                                                   05847000
I04203   EQU   I042+4                                                   05848000
I04201   EQU   I042                                                     05849000
CNTDD    EQU   CNTKDD+1                                                 05850000
CNTK     EQU   CNTKDD                                                   05851000
WRKHW2   EQU   @NM00076+2                                               05852000
WRKHW1   EQU   @NM00076                                                 05853000
UCBRV066 EQU   UCBOBS09+4                                               05854000
UCBIOSBA EQU   UCBOBS09                                                 05855000
UCBRV042 EQU   UCBOBS08+5                                               05856000
UCBRV082 EQU   UCBCTCF1                                                 05857000
UCBRV081 EQU   UCBCTCF1                                                 05858000
UCBRV080 EQU   UCBCTCF1                                                 05859000
UCBRV079 EQU   UCBCTCF1                                                 05860000
UCBRV078 EQU   UCBCTCF1                                                 05861000
UCBRV077 EQU   UCBCTCF1                                                 05862000
UCBRV076 EQU   UCBCTCF1                                                 05863000
UCBCTC80 EQU   UCBCTCF1                                                 05864000
UCBCTCAL EQU   UCBCTCAD                                                 05865000
UCBICNCB EQU   UCBOBS07+4                                               05866000
UCBRV040 EQU   UCBOBS07                                                 05867000
UCBCTLNA EQU   UCBCTLNK+1                                               05868000
UCBRLN   EQU   UCBCTLNK                                                 05869000
UCBRDYQA EQU   UCBLDNCB                                                 05870000
UCBINRLN EQU   UCBIRLN                                                  05871000
UCBIRBA  EQU   UCBIRB+1                                                 05872000
UCBRV039 EQU   UCBGRAF                                                  05873000
UCBDWNR  EQU   UCBGRAF                                                  05874000
UCBRPND  EQU   UCBGRAF                                                  05875000
UCBUPM   EQU   UCBGRAF                                                  05876000
UCBBTAM  EQU   UCBGRAF                                                  05877000
UCBDRNO  EQU   UCBGRAF                                                  05878000
UCBDRO   EQU   UCBGRAF                                                  05879000
UCBOIP   EQU   UCBGRAF                                                  05880000
UCBATRCD EQU   @NM00071                                                 05881000
UCBSKPFG EQU   @NM00071                                                 05882000
UCBRIPND EQU   @NM00071                                                 05883000
UCBRTIAC EQU   @NM00071                                                 05884000
UCBRSV79 EQU   @NM00071                                                 05885000
UCBRSV78 EQU   @NM00071                                                 05886000
UCBRSV77 EQU   @NM00071                                                 05887000
UCBOLTEP EQU   @NM00071                                                 05888000
UCBATNCT EQU   UCBOBS06+2                                               05889000
UCBRSV76 EQU   UCBAOF2                                                  05890000
UCBRSV75 EQU   UCBAOF2                                                  05891000
UCBRSV74 EQU   UCBAOF2                                                  05892000
UCBRSV73 EQU   UCBAOF2                                                  05893000
UCBRSV72 EQU   UCBAOF2                                                  05894000
UCBRSV71 EQU   UCBAOF2                                                  05895000
UCBRSV70 EQU   UCBAOF2                                                  05896000
UCBRSV69 EQU   UCBAOF2                                                  05897000
UCBRSV68 EQU   UCBAOF1                                                  05898000
UCBRSV67 EQU   UCBAOF1                                                  05899000
UCBRSV66 EQU   UCBAOF1                                                  05900000
UCBRSV65 EQU   UCBAOF1                                                  05901000
UCBRSV64 EQU   UCBAOF1                                                  05902000
UCBOFNL  EQU   UCBAOF1                                                  05903000
UCBOFSP  EQU   UCBAOF1                                                  05904000
UCBOFMCR EQU   UCBAOF1                                                  05905000
UCBBTB   EQU   UCBBTA+1                                                 05906000
UCBDI    EQU   UCBBTA                                                   05907000
UCBSNS   EQU   UCBOBS04+8                                               05908000
UCBTEB   EQU   UCBOBS04+4                                               05909000
UCBGCB   EQU   UCBOBS04+3                                               05910000
UCBOPEN  EQU   UCBOBS04+2                                               05911000
UCBSTART EQU   UCBOBS04                                                 05912000
UCBXTNB  EQU   UCBXTN+1                                                 05913000
UCBRSV22 EQU   UCBVOPT                                                  05914000
UCBRSV21 EQU   UCBVOPT                                                  05915000
UCBRSV20 EQU   UCBVOPT                                                  05916000
UCBESVE  EQU   UCBVOPT                                                  05917000
UCBERPC  EQU   UCBVOPT                                                  05918000
UCBESVC  EQU   UCBVOPT                                                  05919000
UCBEVA   EQU   UCBVOPT                                                  05920000
UCBESV   EQU   UCBVOPT                                                  05921000
UCBRV009 EQU   UCBTFL1                                                  05922000
UCBRV008 EQU   UCBTFL1                                                  05923000
UCBRV007 EQU   UCBTFL1                                                  05924000
UCBRV006 EQU   UCBTFL1                                                  05925000
UCBRV005 EQU   UCBTFL1                                                  05926000
UCBDQDSP EQU   UCBTFL1                                                  05927000
UCBNSLTP EQU   UCBTFL1                                                  05928000
UCBNLTP  EQU   UCBTFL1                                                  05929000
UCBRES1B EQU   UCBOBS02+18                                              05930000
UCBFSER  EQU   UCBOBS02+12                                              05931000
@NM00070 EQU   UCBOBS02+4                                               05932000
UCBFSEQ  EQU   UCBOBS02+2                                               05933000
UCBFSCT  EQU   UCBOBS02                                                 05934000
UCBNEXP  EQU   UCBOBS01+20                                              05935000
UCBBASE  EQU   UCBOBS01+16                                              05936000
UCBRES1A EQU   UCBOBS01+15                                              05937000
UCBUSER  EQU   UCBOBS01+14                                              05938000
UCBFL47  EQU   UCBFL4                                                   05939000
UCBFL46  EQU   UCBFL4                                                   05940000
UCBFL45  EQU   UCBFL4                                                   05941000
UCBRV065 EQU   UCBFL4                                                   05942000
UCBDSS   EQU   UCBFL4                                                   05943000
UCBRESVP EQU   UCBFL4                                                   05944000
UCBWDAV  EQU   UCBFL4                                                   05945000
UCBDAVV  EQU   UCBFL4                                                   05946000
UCBSQC   EQU   UCBOBS01+12                                              05947000
UCBDATP  EQU   UCBOBS01+12                                              05948000
UCBDMC   EQU   UCBDMCT                                                  05949000
UCBMOUNT EQU   UCBDMCT                                                  05950000
UCBBNUL  EQU   UCBSTAB                                                  05951000
UCBSHAR  EQU   UCBSTAB                                                  05952000
UCBBSTR  EQU   UCBSTAB                                                  05953000
UCBBPUB  EQU   UCBSTAB                                                  05954000
UCBBPRV  EQU   UCBSTAB                                                  05955000
UCBBALB  EQU   UCBPRSRS                                                 05956000
UCBPGFL  EQU   UCBSTAB                                                  05957000
UCBDVSHR EQU   UCBBSVL                                                  05958000
UCBVOLI  EQU   UCBOBS01+4                                               05959000
UCBVTOC  EQU   UCBOBS01                                                 05960000
TIOUCBP  EQU   TIOEDEVE+1                                               05961000
TIOVERF  EQU   TIOSTTB                                                  05962000
TIOUNLD  EQU   TIOSTTB                                                  05963000
TIOMNTD  EQU   TIOSTTB                                                  05964000
TIOSETU  EQU   TIOSTTB                                                  05965000
TIOVLSR  EQU   TIOSTTB                                                  05966000
TIOPVIO  EQU   TIOSTTB                                                  05967000
TIOREQD  EQU   TIOSTTB                                                  05968000
TIOUSED  EQU   TIOSTTB                                                  05969000
TIOTFEND EQU   POOLSTAR+16                                              05970000
TIOPSLOT EQU   POOLSTAR+13                                              05971000
TIOPSTTB EQU   POOLSTAR+12                                              05972000
TIOPPOOL EQU   POOLSTAR+4                                               05973000
TIOPNSRT EQU   POOLSTAR+3                                               05974000
@NM00068 EQU   POOLSTAR+2                                               05975000
TIOPNSLT EQU   POOLSTAR+1                                               05976000
@NM00067 EQU   POOLSTAR                                                 05977000
TIOSVERF EQU   TIOESTTB                                                 05978000
TIOSUNLD EQU   TIOESTTB                                                 05979000
TIOSMNTD EQU   TIOESTTB                                                 05980000
TIOSSETU EQU   TIOESTTB                                                 05981000
TIOSVLSR EQU   TIOESTTB                                                 05982000
TIOSPVIO EQU   TIOESTTB                                                 05983000
TIOSREQD EQU   TIOESTTB                                                 05984000
TIOSUSED EQU   TIOESTTB                                                 05985000
TIOSBALS EQU   TIOESTTC                                                 05986000
TIOSBALP EQU   TIOESTTC                                                 05987000
TIOSVOLS EQU   TIOESTTC                                                 05988000
TIOSVOLP EQU   TIOESTTC                                                 05989000
TIOSAFFS EQU   TIOESTTC                                                 05990000
TIOSAFFP EQU   TIOESTTC                                                 05991000
TIOSDEFR EQU   TIOESTTC                                                 05992000
TIOSDKCR EQU   TIOESTTC                                                 05993000
TIOEJFCB EQU   TIOENTRY+12                                              05994000
TIOTREM  EQU   TIOELINK                                                 05995000
TIOESSDS EQU   TIOESYOT                                                 05996000
TIOESYIN EQU   TIOELINK                                                 05997000
TIOEQNAM EQU   TIOELINK                                                 05998000
TIOEDYNM EQU   TIOELINK                                                 05999000
TIOTTERM EQU   TIOELINK                                                 06000000
TIOTRV01 EQU   TIOELINK                                                 06001000
TIOSYOUT EQU   TIOELINK                                                 06002000
TIOEWTCT EQU   TIOERLOC                                                 06003000
TIOSDSP2 EQU   TIOESTTA                                                 06004000
TIOSDSP1 EQU   TIOESTTA                                                 06005000
TIOSLABL EQU   TIOESTTA                                                 06006000
TIOSDADS EQU   TIOESTTA                                                 06007000
TIOSJBLB EQU   TIOESTTA                                                 06008000
TIOSPLTS EQU   TIOESTTA                                                 06009000
TIOSPLTP EQU   TIOESTTA                                                 06010000
TIOSLTYP EQU   TIOESTTA                                                 06011000
PSARSAV  EQU   PSARSVTE+60                                              06012000
PSARSTK  EQU   PSARSVTE+56                                              06013000
PSAESAV3 EQU   PSARSVTE+52                                              06014000
PSAESTK3 EQU   PSARSVTE+48                                              06015000
PSAESAV2 EQU   PSARSVTE+44                                              06016000
PSAESTK2 EQU   PSARSVTE+40                                              06017000
PSAESAV1 EQU   PSARSVTE+36                                              06018000
PSAESTK1 EQU   PSARSVTE+32                                              06019000
PSAPSAV  EQU   PSARSVTE+28                                              06020000
PSAPSTK  EQU   PSARSVTE+24                                              06021000
PSAMSAV  EQU   PSARSVTE+20                                              06022000
PSAMSTK  EQU   PSARSVTE+16                                              06023000
PSASSAV  EQU   PSARSVTE+12                                              06024000
PSASSTK  EQU   PSARSVTE+8                                               06025000
PSANSTK  EQU   PSARSVTE+4                                               06026000
PSACSTK  EQU   PSARSVTE                                                 06027000
DEBEXPTA EQU   DEBEXPT+1                                                06028000
DEBRSV12 EQU   DEBRPSID                                                 06029000
DEBRSV11 EQU   DEBRPSID                                                 06030000
DEBRSV10 EQU   DEBRPSID                                                 06031000
DEBRSV09 EQU   DEBRPSID                                                 06032000
DEBRPSAP EQU   DEBRPSID                                                 06033000
DEBRPSO  EQU   DEBRPSID                                                 06034000
DEBRPSI  EQU   DEBRPSID                                                 06035000
DEBRPSP  EQU   DEBRPSID                                                 06036000
DEBFOEB  EQU   DEBFOEAD+1                                               06037000
DEBNOEE  EQU   DEBFOEAD                                                 06038000
DEBFPEB  EQU   DEBFPEAD+1                                               06039000
DEBNPEE  EQU   DEBFPEAD                                                 06040000
DEBFIEB  EQU   DEBFIEAD+1                                               06041000
DEBNIEE  EQU   DEBFIEAD                                                 06042000
DEBBOESS EQU   DEBEODSS                                                 06043000
DEBBOE0  EQU   DEBEOD0                                                  06044000
DEBBOETT EQU   DEBEODTT                                                 06045000
DEBBOERV EQU   DEBEODRV                                                 06046000
DEBRV008 EQU   DEBDSID+7                                                06047000
DEBWTPTI EQU   DEBDSID+6                                                06048000
DEBEXDTE EQU   DEBDSID                                                  06049000
DEBRV007 EQU   DEBEAMFG                                                 06050000
DEBRV006 EQU   DEBEAMFG                                                 06051000
DEBRV005 EQU   DEBEAMFG                                                 06052000
DEBRV004 EQU   DEBEAMFG                                                 06053000
DEBSECVL EQU   DEBEAMFG                                                 06054000
DEBVAMSG EQU   DEBEAMFG                                                 06055000
DEBDSOPN EQU   DEBEAMFG                                                 06056000
DEBMULTI EQU   DEBEAMFG                                                 06057000
DEBVSEQU EQU   DEBASC09+2                                               06058000
DEBDSSQL EQU   DEBASC09+1                                               06059000
DEBVOLAC EQU   DEBASC09                                                 06060000
DEBWDCBA EQU   DEBWDCB+1                                                06061000
DEBRSV08 EQU   DEBWDCB                                                  06062000
DEBPDCBA EQU   DEBPDCB+1                                                06063000
DEBRSV07 EQU   DEBPDCB                                                  06064000
DEBRDCBA EQU   DEBRDCB+1                                                06065000
DEBRSV06 EQU   DEBRDCB                                                  06066000
DEBSUCBB EQU   DEBSUCBA+1                                               06067000
DEBSDVM  EQU   DEBSUCBA                                                 06068000
IOBSKSS  EQU   IOBSKADR+3                                               06069000
IOBSK0   EQU   IOBSKADR+2                                               06070000
IOBSKTT  EQU   IOBSKADR+1                                               06071000
IOBSKRV  EQU   IOBSKADR                                                 06072000
IOBCSWSV EQU   IOBORG11+17                                              06073000
IOBSENSV EQU   IOBORG11+16                                              06074000
IOBRCD   EQU   IOBORG11+12                                              06075000
IOBMDREC EQU   IOBORG11+8                                               06076000
IOBNAMEA EQU   IOBNAME+1                                                06077000
IOBNAMSZ EQU   IOBNAME                                                  06078000
IOBERCTA EQU   IOBERCT+1                                                06079000
IOBRTYPE EQU   IOBUCBXV                                                 06080000
IOBRDCHP EQU   IOBORG10+20                                              06081000
IOBNEXTA EQU   IOBORG10+16                                              06082000
IOBREADA EQU   IOBORG10+12                                              06083000
IOBBUFC  EQU   IOBORG10+8                                               06084000
IOBSK2R  EQU   IOBSEEK2+7                                               06085000
IOBSK2HH EQU   IOBSEEK2+5                                               06086000
IOBSK2CC EQU   IOBSEEK2+3                                               06087000
IOBSK2BB EQU   IOBSEEK2+1                                               06088000
IOBSK2M  EQU   IOBSEEK2                                                 06089000
IOBCHNPR EQU   IOBORG09+40                                              06090000
IOBDNCRF EQU   IOBORG09+32                                              06091000
IOBRSV35 EQU   IOBORG09+24                                              06092000
IOBDQPTR EQU   IOBORG09+20                                              06093000
IOBRSV34 EQU   IOBORG09+18                                              06094000
IOBDBYTN EQU   IOBORG09+16                                              06095000
IOBDCPND EQU   IOBORG09+12                                              06096000
IOBSTAT2 EQU   IOBDSTAT+1                                               06097000
IOBSIORT EQU   IOBSTAT1                                                 06098000
IOBADDVU EQU   IOBSTAT1                                                 06099000
IOBBUFF  EQU   IOBSTAT1                                                 06100000
IOBENQUE EQU   IOBSTAT1                                                 06101000
IOBPASS2 EQU   IOBSTAT1                                                 06102000
IOBSYNCH EQU   IOBSTAT1                                                 06103000
IOBNEWVL EQU   IOBSTAT1                                                 06104000
IOBABNRM EQU   IOBSTAT1                                                 06105000
IOBRELEX EQU   IOBDTYP2                                                 06106000
IOBADDTY EQU   IOBDTYP2                                                 06107000
IOBTYPE  EQU   IOBDTYP2                                                 06108000
IOBRQUST EQU   IOBDTYP2                                                 06109000
IOBSUFFX EQU   IOBDTYP2                                                 06110000
IOBSBLKL EQU   IOBDTYP2                                                 06111000
IOBSKEY  EQU   IOBDTYP2                                                 06112000
IOBRELBL EQU   IOBDTYPE                                                 06113000
IOBRDEXC EQU   IOBDTYPE                                                 06114000
IOBDYNBF EQU   IOBDTYPE                                                 06115000
IOBACTAD EQU   IOBDTYPE                                                 06116000
IOBFDBCK EQU   IOBDTYPE                                                 06117000
IOBEXTSC EQU   IOBDTYPE                                                 06118000
IOBOVFLO EQU   IOBDTYPE                                                 06119000
IOBVERFY EQU   IOBDTYPE                                                 06120000
IOBDPLB  EQU   IOBDPLAD+1                                               06121000
IOBDAYLI EQU   IOBDPLAD                                                 06122000
IOBDIOBS EQU   IOBORG09+2                                               06123000
IOBDBYTR EQU   IOBORG09                                                 06124000
IOBBCHAD EQU   IOBORG08+12                                              06125000
IOBFCHNB EQU   IOBFCHAD+1                                               06126000
IOBCOUNT EQU   IOBFCHAD                                                 06127000
IOBASYN  EQU   IOBORG08+7                                               06128000
IOBAPP   EQU   IOBORG08+6                                               06129000
IOBRSV32 EQU   IOBUNSQR                                                 06130000
IOBRSV31 EQU   IOBUNSQR                                                 06131000
IOBRSV30 EQU   IOBUNSQR                                                 06132000
IOBKNRWR EQU   IOBUNSQR                                                 06133000
IOBKNWR  EQU   IOBUNSQR                                                 06134000
IOBNTAV2 EQU   IOBUNSQR                                                 06135000
IOBNTAV1 EQU   IOBUNSQR                                                 06136000
IOBCPBSY EQU   IOBUNSQR                                                 06137000
IOBCHNNL EQU   IOBINDCT                                                 06138000
IOBRSV29 EQU   IOBINDCT                                                 06139000
IOBRSV28 EQU   IOBINDCT                                                 06140000
IOBRSV27 EQU   IOBINDCT                                                 06141000
IOBKEYAD EQU   IOBINDCT                                                 06142000
IOBOVPTR EQU   IOBINDCT                                                 06143000
IOBUNSCH EQU   IOBINDCT                                                 06144000
IOBDEQCP EQU   IOBINDCT                                                 06145000
IOBCCWAD EQU   IOBORG08                                                 06146000
W1OEXTEN EQU   W1IEXTEN                                                 06147000
IOBCCW   EQU   IOBORG06+8                                               06148000
IOBNXTPB EQU   IOBNXTPT+1                                               06149000
IOBRSV26 EQU   IOBSTATA                                                 06150000
IOBRSV25 EQU   IOBSTATA                                                 06151000
IOBRSV24 EQU   IOBSTATA                                                 06152000
IOBRSV23 EQU   IOBSTATA                                                 06153000
IOBRSV22 EQU   IOBSTATA                                                 06154000
IOBRSV21 EQU   IOBSTATA                                                 06155000
IOBRSV20 EQU   IOBSTATA                                                 06156000
IOBAVLFL EQU   IOBSTATA                                                 06157000
IOBRSV37 EQU   IOBORG06+1                                               06158000
IOBUCBXG EQU   IOBORG06                                                 06159000
IOBCPA   EQU   IOBORG05+32                                              06160000
IOBERINF EQU   IOBORG05+16                                              06161000
IOBERCCW EQU   IOBORG05+8                                               06162000
IOBSNDPT EQU   IOBORG05+7                                               06163000
IOBRCVPT EQU   IOBORG05+6                                               06164000
IOBWORK  EQU   IOBORG05+1                                               06165000
IOBUCBX  EQU   IOBORG05                                                 06166000
IOBR     EQU   IOBSEEK+7                                                06167000
IOBHH2   EQU   IOBHH+1                                                  06168000
IOBHH1   EQU   IOBHH                                                    06169000
IOBCC2   EQU   IOBCC+1                                                  06170000
IOBCC1   EQU   IOBCC                                                    06171000
IOBBB2   EQU   IOBBB+1                                                  06172000
IOBBB1   EQU   IOBBB                                                    06173000
IOBM     EQU   IOBSEEK                                                  06174000
IOBRSV46 EQU   IOBFL4                                                   06175000
IOBRSV47 EQU   IOBFL4                                                   06176000
IOBENT   EQU   IOBFL4                                                   06177000
IOBEQP   EQU   IOBFL4                                                   06178000
IOBBUS   EQU   IOBFL4                                                   06179000
IOBDCK   EQU   IOBFL4                                                   06180000
IOBREJ   EQU   IOBFL4                                                   06181000
IOBOVR   EQU   IOBFL4                                                   06182000
IOBCRILC EQU   IOBORG04+1                                               06183000
IOBCRDCC EQU   IOBORG04                                                 06184000
IOBGQECB EQU   IOBORG03                                                 06185000
IOBSWAP  EQU   IOBORG02+4                                               06186000
IOBDQADB EQU   IOBDQADA+1                                               06187000
IOBRSV13 EQU   IOBDEQIN                                                 06188000
IOBRSV12 EQU   IOBDEQIN                                                 06189000
IOBRSV11 EQU   IOBDEQIN                                                 06190000
IOBRSV10 EQU   IOBDEQIN                                                 06191000
IOBRSV09 EQU   IOBDEQIN                                                 06192000
IOBRSV08 EQU   IOBDEQIN                                                 06193000
IOBRSV07 EQU   IOBDEQIN                                                 06194000
IOBDEQ   EQU   IOBDEQIN                                                 06195000
IOBNECB  EQU   IOBORG01+4                                               06196000
IOBNIOBB EQU   IOBNIOBA+1                                               06197000
IOBFIRST EQU   IOBNFLG1                                                 06198000
IOBUPERR EQU   IOBNFLG1                                                 06199000
IOBSPAN  EQU   IOBNFLG1                                                 06200000
IOBBKSPC EQU   IOBNFLG1                                                 06201000
IOBUPDAT EQU   IOBNFLG1                                                 06202000
IOBREAD  EQU   IOBNFLG1                                                 06203000
IOBWRITE EQU   IOBNFLG1                                                 06204000
IOBSEGMT EQU   IOBPRTOV                                                 06205000
CVTRV628 EQU   CVTS01+728                                               06206000
CVTRV627 EQU   CVTS01+724                                               06207000
CVTRV626 EQU   CVTS01+720                                               06208000
CVTRV625 EQU   CVTS01+716                                               06209000
CVTRV624 EQU   CVTS01+712                                               06210000
CVTRV623 EQU   CVTS01+708                                               06211000
CVTRV622 EQU   CVTS01+704                                               06212000
CVTRV621 EQU   CVTS01+700                                               06213000
CVTIHASU EQU   CVTS01+696                                               06214000
CVTRV619 EQU   CVTS01+692                                               06215000
CVTRV618 EQU   CVTS01+688                                               06216000
CVTRV617 EQU   CVTS01+684                                               06217000
CVTRV616 EQU   CVTS01+680                                               06218000
CVTRV615 EQU   CVTS01+676                                               06219000
CVTRV614 EQU   CVTS01+672                                               06220000
CVTRV613 EQU   CVTS01+668                                               06221000
CVTTCASP EQU   CVTS01+664                                               06222000
CVT0PT03 EQU   CVTS01+660                                               06223000
CVT0PT0E EQU   CVTS01+656                                               06224000
CVTRV609 EQU   CVTS01+652                                               06225000
CVTCGK   EQU   CVTS01+648                                               06226000
CVTRAC   EQU   CVTS01+644                                               06227000
CVTRV606 EQU   CVTS01+640                                               06228000
CVTRV605 EQU   CVTS01+636                                               06229000
CVTRV604 EQU   CVTS01+632                                               06230000
CVTEFF02 EQU   CVTS01+628                                               06231000
CVTCBBR  EQU   CVTS01+624                                               06232000
CVTSSCR  EQU   CVTS01+620                                               06233000
CVTEVENT EQU   CVTS01+616                                               06234000
CVTCRCA  EQU   CVTS01+612                                               06235000
CVTTPIO  EQU   CVTS01+608                                               06236000
CVTADV   EQU   CVTS01+604                                               06237000
CVTGSDAB EQU   CVTGSDA                                                  06238000
CVTQV3   EQU   CVTS01+596                                               06239000
CVTQV2   EQU   CVTS01+592                                               06240000
CVTQV1   EQU   CVTS01+588                                               06241000
CVTRPT   EQU   CVTS01+584                                               06242000
CVTSSRB  EQU   CVTS01+580                                               06243000
CVTCSDRL EQU   CVTS01+576                                               06244000
CVTEXP1  EQU   CVTS01+572                                               06245000
CVTRMPMT EQU   CVTS01+568                                               06246000
CVTRMPTT EQU   CVTS01+564                                               06247000
CVTVPSA  EQU   CVTS01+560                                               06248000
CVTVSTOP EQU   CVTS01+556                                               06249000
CVTGTFR8 EQU   CVTS01+552                                               06250000
CVTQUIT  EQU   CVTS01+548                                               06251000
CVTVACR  EQU   CVTS01+544                                               06252000
CVTWTCB  EQU   CVTS01+540                                               06253000
CVTSTPRS EQU   CVTS01+536                                               06254000
CVT0PT02 EQU   CVTS01+532                                               06255000
CVTDARCM EQU   CVTS01+528                                               06256000
CVTIRECM EQU   CVTS01+524                                               06257000
CVTJRECM EQU   CVTS01+520                                               06258000
CVTVEMS0 EQU   CVTS01+516                                               06259000
CVTSPFRR EQU   CVTS01+512                                               06260000
CVTRLSTG EQU   CVTS01+508                                               06261000
CVT0TC0A EQU   CVTS01+504                                               06262000
CVTGMBR  EQU   CVTS01+500                                               06263000
CVTLFRM  EQU   CVTS01+496                                               06264000
CVTRMBR  EQU   CVTS01+492                                               06265000
CVTVIOP  EQU   CVTS01+488                                               06266000
CVTRV307 EQU   CVTS01+486                                               06267000
CVTRV306 EQU   CVTS01+484                                               06268000
CVTRV305 EQU   CVTS01+482                                               06269000
CVTRV304 EQU   CVTS01+480                                               06270000
CVTRV303 EQU   CVTS01+478                                               06271000
CVTRV302 EQU   CVTS01+476                                               06272000
CVTTRCA  EQU   CVTS01+472                                               06273000
CVTRV297 EQU   CVTRV289                                                 06274000
CVTRV296 EQU   CVTRV289                                                 06275000
CVTRV295 EQU   CVTRV289                                                 06276000
CVTRV294 EQU   CVTRV289                                                 06277000
CVTRV293 EQU   CVTRV289                                                 06278000
CVTRV292 EQU   CVTRV289                                                 06279000
CVTRV291 EQU   CVTRV289                                                 06280000
CVTRV290 EQU   CVTRV289                                                 06281000
CVTRV288 EQU   CVTRV280                                                 06282000
CVTRV287 EQU   CVTRV280                                                 06283000
CVTRV286 EQU   CVTRV280                                                 06284000
CVTRV285 EQU   CVTRV280                                                 06285000
CVTRV284 EQU   CVTRV280                                                 06286000
CVTRV283 EQU   CVTRV280                                                 06287000
CVTRV282 EQU   CVTRV280                                                 06288000
CVTRV281 EQU   CVTRV280                                                 06289000
CVTRV279 EQU   CVTRV271                                                 06290000
CVTRV278 EQU   CVTRV271                                                 06291000
CVTRV277 EQU   CVTRV271                                                 06292000
CVTRV276 EQU   CVTRV271                                                 06293000
CVTRV275 EQU   CVTRV271                                                 06294000
CVTRV274 EQU   CVTRV271                                                 06295000
CVTRV273 EQU   CVTRV271                                                 06296000
CVTRV272 EQU   CVTRV271                                                 06297000
CVTRV270 EQU   CVTRV262                                                 06298000
CVTRV269 EQU   CVTRV262                                                 06299000
CVTRV268 EQU   CVTRV262                                                 06300000
CVTRV267 EQU   CVTRV262                                                 06301000
CVTRV266 EQU   CVTRV262                                                 06302000
CVTRV265 EQU   CVTRV262                                                 06303000
CVTRV264 EQU   CVTRV262                                                 06304000
CVTRV263 EQU   CVTRV262                                                 06305000
CVTVFP   EQU   CVTS01+464                                               06306000
CVTVSI   EQU   CVTS01+460                                               06307000
CVTVPSIB EQU   CVTS01+456                                               06308000
CVTMFACT EQU   CVTMFRTR                                                 06309000
CVTMFCTL EQU   CVTS01+448                                               06310000
CVTPVBP  EQU   CVTS01+444                                               06311000
CVTPWI   EQU   CVTS01+440                                               06312000
CVTRV254 EQU   CVTS01+438                                               06313000
CVTRV253 EQU   CVTS01+436                                               06314000
CVTRV252 EQU   CVTS01+434                                               06315000
CVTRV251 EQU   CVTS01+433                                               06316000
CVTRV250 EQU   CVTS01+432                                               06317000
CVTRV249 EQU   CVTS01+431                                               06318000
CVTRV248 EQU   CVTS01+430                                               06319000
CVTRV247 EQU   CVTS01+429                                               06320000
CVTRV246 EQU   CVTS01+428                                               06321000
CVTRV245 EQU   CVTRV237                                                 06322000
CVTRV244 EQU   CVTRV237                                                 06323000
CVTRV243 EQU   CVTRV237                                                 06324000
CVTRV242 EQU   CVTRV237                                                 06325000
CVTRV241 EQU   CVTRV237                                                 06326000
CVTRV240 EQU   CVTRV237                                                 06327000
CVTRV239 EQU   CVTRV237                                                 06328000
CVTRV238 EQU   CVTRV237                                                 06329000
CVTRV236 EQU   CVTRV228                                                 06330000
CVTRV235 EQU   CVTRV228                                                 06331000
CVTRV234 EQU   CVTRV228                                                 06332000
CVTRV233 EQU   CVTRV228                                                 06333000
CVTRV232 EQU   CVTRV228                                                 06334000
CVTRV231 EQU   CVTRV228                                                 06335000
CVTRV230 EQU   CVTRV228                                                 06336000
CVTRV229 EQU   CVTRV228                                                 06337000
CVTRV227 EQU   CVTRV219                                                 06338000
CVTRV226 EQU   CVTRV219                                                 06339000
CVTRV225 EQU   CVTRV219                                                 06340000
CVTRV224 EQU   CVTRV219                                                 06341000
CVTRV223 EQU   CVTRV219                                                 06342000
CVTRV222 EQU   CVTRV219                                                 06343000
CVTRV221 EQU   CVTRV219                                                 06344000
CVTRV220 EQU   CVTRV219                                                 06345000
CVTRV218 EQU   CVTRV210                                                 06346000
CVTRV217 EQU   CVTRV210                                                 06347000
CVTRV216 EQU   CVTRV210                                                 06348000
CVTRV215 EQU   CVTRV210                                                 06349000
CVTRV214 EQU   CVTRV210                                                 06350000
CVTRV213 EQU   CVTRV210                                                 06351000
CVTRV212 EQU   CVTRV210                                                 06352000
CVTRV211 EQU   CVTRV210                                                 06353000
CVTLCCAT EQU   CVTS01+420                                               06354000
CVTPCCAT EQU   CVTS01+416                                               06355000
CVTIPCRP EQU   CVTS01+412                                               06356000
CVTIPCRI EQU   CVTS01+408                                               06357000
CVTIPCDS EQU   CVTS01+404                                               06358000
CVTAIDVT EQU   CVTS01+400                                               06359000
CVTSSAP  EQU   CVTS01+396                                               06360000
CVTEHCIR EQU   CVTS01+392                                               06361000
CVTEHDEF EQU   CVTS01+388                                               06362000
CVTDAIR  EQU   CVTS01+384                                               06363000
CVTPERFM EQU   CVTS01+380                                               06364000
CVT044R2 EQU   CVTS01+376                                               06365000
CVTFETCH EQU   CVTS01+372                                               06366000
CVTRSTWD EQU   CVTS01+368                                               06367000
CVTSPOST EQU   CVTS01+364                                               06368000
CVTIOBP  EQU   CVTS01+360                                               06369000
CVTASMVT EQU   CVTS01+356                                               06370000
CVTRECRQ EQU   CVTS01+352                                               06371000
CVTWSAC  EQU   CVTS01+348                                               06372000
CVTRV149 EQU   CVTS01+344                                               06373000
CVTWSAL  EQU   CVTS01+340                                               06374000
CVTSPSA  EQU   CVTS01+336                                               06375000
CVTGLMN  EQU   CVTS01+332                                               06376000
CVTVEAC0 EQU   CVTS01+328                                               06377000
CVT062R1 EQU   CVTS01+324                                               06378000
CVTRPOST EQU   CVTS01+320                                               06379000
CVTDQIQE EQU   CVTS01+316                                               06380000
CVTCSD   EQU   CVTS01+312                                               06381000
CVTLKRMA EQU   CVTS01+308                                               06382000
CVTRSPIE EQU   CVTS01+304                                               06383000
CVTRENQ  EQU   CVTS01+300                                               06384000
CVTLQCB  EQU   CVTS01+296                                               06385000
CVTFQCB  EQU   CVTS01+292                                               06386000
CVTQCS01 EQU   CVTS01+288                                               06387000
CVTAPFT  EQU   CVTS01+284                                               06388000
CVTPARRL EQU   CVTS01+280                                               06389000
CVTVWAIT EQU   CVTS01+276                                               06390000
CVTGSPL  EQU   CVTS01+272                                               06391000
CVTLSMQ  EQU   CVTS01+268                                               06392000
CVTGSMQ  EQU   CVTS01+264                                               06393000
CVTEXPRO EQU   CVTS01+260                                               06394000
CVTOPCTP EQU   CVTS01+256                                               06395000
CVTSIC   EQU   CVTS01+252                                               06396000
CVTTPIOS EQU   CVTS01+248                                               06397000
CVTRTMS  EQU   CVTS01+244                                               06398000
CVTSDBF  EQU   CVTS01+240                                               06399000
CVTSCBP  EQU   CVTS01+236                                               06400000
CVTSDMP  EQU   CVTS01+232                                               06401000
CVTSV60  EQU   CVTS01+228                                               06402000
CVTRTMCT EQU   CVTS01+224                                               06403000
CVTASCBL EQU   CVTS01+220                                               06404000
CVTASCBH EQU   CVTS01+216                                               06405000
CVTGDA   EQU   CVTS01+212                                               06406000
CVTASVT  EQU   CVTS01+208                                               06407000
CVTVVMDI EQU   CVTS01+204                                               06408000
CVTAQTOP EQU   CVTS01+200                                               06409000
CVTIOSCS EQU   CVTS01+196                                               06410000
CVTSDRM  EQU   CVTS01+192                                               06411000
CVTOPTE  EQU   CVTS01+188                                               06412000
CVTSTXU  EQU   CVTS01+184                                               06413000
CVTQUIS  EQU   CVTS01+180                                               06414000
CVTPARS  EQU   CVTS01+176                                               06415000
CVTS1EE  EQU   CVTS01+172                                               06416000
CVTFRAS  EQU   CVTS01+168                                               06417000
CVTQSAS  EQU   CVTS01+164                                               06418000
CVTCRAS  EQU   CVTS01+160                                               06419000
CVTCRMN  EQU   CVTS01+156                                               06420000
CVTDELCP EQU   CVTS01+152                                               06421000
CVTFRECL EQU   CVTS01+148                                               06422000
CVTGETCL EQU   CVTS01+144                                               06423000
CVTBLDCP EQU   CVTS01+140                                               06424000
CVTAUTHL EQU   CVTS01+136                                               06425000
CVTSCAN  EQU   CVTS01+132                                               06426000
CVTRV144 EQU   CVTS01+130                                               06427000
CVTMAXMP EQU   CVTS01+128                                               06428000
CVTSTCK  EQU   CVTS01+124                                               06429000
CVTRV139 EQU   CVTS01+123                                               06430000
CVTDSSAC EQU   CVTS01+122                                               06431000
CVTRV513 EQU   CVTS01+121                                               06432000
CVTIOSPL EQU   CVTS01+120                                               06433000
CVTPTGT  EQU   CVTS01+116                                               06434000
CVTCSPIE EQU   CVTS01+112                                               06435000
CVTSMFEX EQU   CVTS01+108                                               06436000
CVTOLT0A EQU   CVTS01+104                                               06437000
CVTSRBRT EQU   CVTS01+100                                               06438000
CVTPUTL  EQU   CVTS01+96                                                06439000
CVTASCRL EQU   CVTS01+92                                                06440000
CVTASCRF EQU   CVTS01+88                                                06441000
CVTRV326 EQU   CVTS01+84                                                06442000
CVTRV325 EQU   CVTS01+80                                                06443000
CVTRV324 EQU   CVTS01+76                                                06444000
CVT0VL01 EQU   CVTS01+72                                                06445000
CVTSHRVM EQU   CVTS01+68                                                06446000
CVTRV332 EQU   CVTS01+64                                                06447000
CVTTAS   EQU   CVTS01+60                                                06448000
CVTRSCN  EQU   CVTS01+56                                                06449000
CVTTRAC2 EQU   CVTS01+54                                                06450000
CVTTRACE EQU   CVTS01+52                                                06451000
CVTAPG   EQU   CVTS01+51                                                06452000
CVTSDTRC EQU   CVTCTLFG                                                 06453000
CVTGTRCE EQU   CVTCTLFG                                                 06454000
CVTNOMP  EQU   CVTCTLFG                                                 06455000
CVTRSV79 EQU   CVTCTLFG                                                 06456000
CVTDSTAT EQU   CVTCTLFG                                                 06457000
CVTRSV78 EQU   CVTCTLFG                                                 06458000
CVTRV333 EQU   CVTCTLFG                                                 06459000
CVTRV323 EQU   CVTCTLFG                                                 06460000
CVTSPVLK EQU   CVTS01+49                                                06461000
CVTRSV77 EQU   CVTS01+48                                                06462000
CVTRV331 EQU   CVTS01+44                                                06463000
CVTRV330 EQU   CVTS01+40                                                06464000
CVTRV329 EQU   CVTS01+36                                                06465000
CVTRV328 EQU   CVTS01+32                                                06466000
CVTRV322 EQU   CVTS01+28                                                06467000
CVTSLID  EQU   CVTSLIDA+1                                               06468000
CVTSYLK  EQU   CVTSLIDA                                                 06469000
CVTRV321 EQU   CVTS01+20                                                06470000
CVTRV320 EQU   CVTS01+16                                                06471000
CVTLPDIR EQU   CVTLPDIA+1                                               06472000
CVTRSV69 EQU   CVTDIRST                                                 06473000
CVTRSV68 EQU   CVTDIRST                                                 06474000
CVTRSV67 EQU   CVTDIRST                                                 06475000
CVTRSV66 EQU   CVTDIRST                                                 06476000
CVTRSV65 EQU   CVTDIRST                                                 06477000
CVTRSV64 EQU   CVTDIRST                                                 06478000
CVTRSV63 EQU   CVTDIRST                                                 06479000
CVTDICOM EQU   CVTDIRST                                                 06480000
CVTPVTP  EQU   CVTS01+8                                                 06481000
CVTLPDSR EQU   CVTS01+4                                                 06482000
CVTGETL  EQU   CVTS01                                                   06483000
@NM00081 EQU   CNT+5                                                    06484000
CNTCC    EQU   CNTCCHH                                                  06485000
ECBPOST  EQU   ECBCC                                                    06486000
ECBWAIT  EQU   ECBCC                                                    06487000
@NM00080 EQU   SNSD+8                                                   06488000
SNSHD1   EQU   SNS6                                                     06489000
SNSHD2   EQU   SNS6                                                     06490000
SNSHD4   EQU   SNS6                                                     06491000
SNSHD8   EQU   SNS6                                                     06492000
SNSHD16  EQU   SNS6                                                     06493000
SNSCYLA  EQU   SNS6                                                     06494000
SNS4     EQU   SNSD+4                                                   06495000
SNS3     EQU   SNSD+3                                                   06496000
SNSFHF   EQU   SNS2                                                     06497000
SNSEMU   EQU   SNS2                                                     06498000
SNSEDAT  EQU   SNS2                                                     06499000
@NM00079 EQU   SNS2                                                     06500000
SNSCORR  EQU   SNS2                                                     06501000
SNSWRPS  EQU   SNS2                                                     06502000
SNSOFLO  EQU   SNS1                                                     06503000
SNSINHI  EQU   SNS1                                                     06504000
SNSFP    EQU   SNS1                                                     06505000
@NM00078 EQU   SNS1                                                     06506000
SNSEOC   EQU   SNS1                                                     06507000
SNSPERM  EQU   SNS1                                                     06508000
SNSSKCK  EQU   SNS0                                                     06509000
SNSTCC   EQU   SNS0                                                     06510000
SNSOVRN  EQU   SNS0                                                     06511000
SNSBUSO  EQU   SNS0                                                     06512000
SNSINT   EQU   SNS0                                                     06513000
SNSCREJ  EQU   SNS0                                                     06514000
CSWBYTE  EQU   CSW+6                                                    06515000
@NM00077 EQU   CSWSTAT1                                                 06516000
CSWKEY   EQU   CSWADDRA                                                 06517000
SEEKR    EQU   SEEK+6                                                   06518000
SEEKHH   EQU   SEEKCCHH+2                                               06519000
SEEKCC   EQU   SEEKCCHH                                                 06520000
SEEKBB   EQU   SEEK                                                     06521000
MSG      EQU   CNMSGXXT+12                                              06522000
MSGID    EQU   CNMSGXXT                                                 06523000
MSGFLAGS EQU   CNMSGXX+10                                               06524000
WRKAB    EQU   WRKAD+1                                                  06525000
CCWBYTE  EQU   CCW+6                                                    06526000
@NM00075 EQU   CCW+5                                                    06527000
CCWPCI   EQU   CCWFLGS                                                  06528000
CCWSKIP  EQU   CCWFLGS                                                  06529000
CCWSLI   EQU   CCWFLGS                                                  06530000
CCWCC    EQU   CCWFLGS                                                  06531000
CCWCD    EQU   CCWFLGS                                                  06532000
CCWWR    EQU   @NM00073                                                 06533000
CCWRD    EQU   @NM00073                                                 06534000
@NM00074 EQU   @NM00073                                                 06535000
UCBERADR EQU   UCBUCS+12                                                06536000
UCBFCBID EQU   UCBUCS+8                                                 06537000
UCBERCNT EQU   UCBUCS+7                                                 06538000
UCBRSV51 EQU   UCBUCS+6                                                 06539000
UCBFCBPE EQU   UCBFCBOP                                                 06540000
UCBRSV49 EQU   UCBFCBOP                                                 06541000
UCBRSV48 EQU   UCBFCBOP                                                 06542000
UCBRSV47 EQU   UCBFCBOP                                                 06543000
UCBRSV46 EQU   UCBFCBOP                                                 06544000
UCBRSV45 EQU   UCBFCBOP                                                 06545000
UCBRSV44 EQU   UCBFCBOP                                                 06546000
UCBFCBO1 EQU   UCBFCBOP                                                 06547000
UCBUCSPE EQU   UCBUCSOP                                                 06548000
UCBRSV43 EQU   UCBUCSOP                                                 06549000
UCBRSV42 EQU   UCBUCSOP                                                 06550000
UCBRSV41 EQU   UCBUCSOP                                                 06551000
UCBRSV40 EQU   UCBUCSOP                                                 06552000
UCBRSV39 EQU   UCBUCSOP                                                 06553000
UCBUCSO2 EQU   UCBUCSOP                                                 06554000
UCBUCSO1 EQU   UCBUCSOP                                                 06555000
UCBUCSID EQU   UCBUCS                                                   06556000
UCBMDRBA EQU   UCBMDRBF+1                                               06557000
UCBRV075 EQU   UCBMDRBF                                                 06558000
UCBRV074 EQU   UCB3800X+32                                              06559000
UCBIMAGE EQU   UCB3800X+28                                              06560000
UCBFCBNM EQU   UCB3800X+24                                              06561000
UCBCHAR4 EQU   UCB3800X+20                                              06562000
UCBCHAR3 EQU   UCB3800X+16                                              06563000
UCBCHAR2 EQU   UCB3800X+12                                              06564000
UCBCHAR1 EQU   UCB3800X+8                                               06565000
UCBCGMID EQU   UCB3800X+4                                               06566000
UCBBRSTA EQU   UCBACTIV                                                 06567000
UCBRV063 EQU   UCBACTIV                                                 06568000
UCBRV062 EQU   UCBACTIV                                                 06569000
UCBRV061 EQU   UCBACTIV                                                 06570000
UCBRV060 EQU   UCBACTIV                                                 06571000
UCBRV059 EQU   UCBACTIV                                                 06572000
UCBRV058 EQU   UCBACTIV                                                 06573000
UCBRV057 EQU   UCBACTIV                                                 06574000
UCBRV050 EQU   UCB3800X+2                                               06575000
UCBCGMNO EQU   UCB3800X+1                                               06576000
UCBRV083 EQU   UCBOPTNS                                                 06577000
UCBBRSTR EQU   UCBOPTNS                                                 06578000
UCBRV056 EQU   UCBOPTNS                                                 06579000
UCBRV055 EQU   UCBOPTNS                                                 06580000
UCBRV054 EQU   UCBOPTNS                                                 06581000
UCBRV053 EQU   UCBOPTNS                                                 06582000
UCBRV052 EQU   UCBOPTNS                                                 06583000
UCBRV051 EQU   UCBOPTNS                                                 06584000
UCBRV073 EQU   UCB3540X+7                                               06585000
UCBRV072 EQU   UCBDKBYT                                                 06586000
UCBRV071 EQU   UCBDKBYT                                                 06587000
UCBRV070 EQU   UCBDKBYT                                                 06588000
UCBRV069 EQU   UCBDKBYT                                                 06589000
UCBRV068 EQU   UCBDKBYT                                                 06590000
UCBRV067 EQU   UCBDKBYT                                                 06591000
UCBVLVER EQU   UCBDKBYT                                                 06592000
UCBDKAMX EQU   UCBDKBYT                                                 06593000
UCBVLSER EQU   UCB3540X                                                 06594000
UCBRDATA EQU   UCBOCR+4                                                 06595000
UCBFRID  EQU   UCBOCR                                                   06596000
UCBCLN   EQU   UCBMT+14                                                 06597000
UCBERG   EQU   UCBMT+12                                                 06598000
UCBMS    EQU   UCBMT+11                                                 06599000
UCBNB    EQU   UCBMT+10                                                 06600000
UCBPW    EQU   UCBMT+9                                                  06601000
UCBPR    EQU   UCBMT+8                                                  06602000
UCBSIO   EQU   UCBMT+6                                                  06603000
UCBTW    EQU   UCBMT+5                                                  06604000
UCBTR    EQU   UCBMT+4                                                  06605000
UCBTWT   EQU   UCBMT+3                                                  06606000
UCBTRT   EQU   UCBMT+2                                                  06607000
UCBCTD   EQU   UCBMT                                                    06608000
UCBWTOID EQU   UCBCMEXT+17                                              06609000
UCBRV043 EQU   UCBCMEXT+16                                              06610000
UCBASID  EQU   UCBCMEXT+14                                              06611000
UCBMFCNT EQU   UCBCMEXT+12                                              06612000
UCBPMSK  EQU   UCBCMEXT+10                                              06613000
UCBCCWOF EQU   UCBCMEXT+8                                               06614000
UCBRV041 EQU   UCBCMEXT+6                                               06615000
UCBRV036 EQU   UCBFLP1                                                  06616000
UCBRV035 EQU   UCBFLP1                                                  06617000
UCBERLOG EQU   UCBFLP1                                                  06618000
UCBRV033 EQU   UCBFLP1                                                  06619000
UCBINHIO EQU   UCBFLP1                                                  06620000
UCBNSWAP EQU   UCBFLP1                                                  06621000
UCBSHRUP EQU   UCBFLP1                                                  06622000
UCBNSRCH EQU   UCBFLP1                                                  06623000
UCBSNSCT EQU   UCBCMEXT+4                                               06624000
UCBHPDV  EQU   @NM00072                                                 06625000
UCBHALI  EQU   @NM00072                                                 06626000
UCBRSV09 EQU   @NM00072                                                 06627000
UCBRSV08 EQU   @NM00072                                                 06628000
UCBRSV07 EQU   @NM00072                                                 06629000
UCBRSV06 EQU   @NM00072                                                 06630000
UCBRSV05 EQU   @NM00072                                                 06631000
UCBRSV04 EQU   @NM00072                                                 06632000
UCBDTI   EQU   UCBCMEXT+2                                               06633000
UCBSTI   EQU   UCBCMEXT+1                                               06634000
UCBETI   EQU   UCBCMEXT                                                 06635000
UCBEXTP  EQU   UCBEXTPT+1                                               06636000
UCBDDRSW EQU   UCBFLC                                                   06637000
UCBTICBT EQU   UCBFLC                                                   06638000
UCBIVRR  EQU   UCBFLC                                                   06639000
UCBIVRS  EQU   UCBFLC                                                   06640000
UCBITF   EQU   UCBFLC                                                   06641000
UCBUDE   EQU   UCBFLC                                                   06642000
UCBWAA   EQU   UCBFLC                                                   06643000
UCBATTP  EQU   UCBFLC                                                   06644000
UCBUNTYP EQU   UCBTBYT4                                                 06645000
UCBRSV11 EQU   UCBDVCLS                                                 06646000
UCBRSV10 EQU   UCBDVCLS                                                 06647000
UCB3CHAR EQU   UCBDVCLS                                                 06648000
UCB3UREC EQU   UCBDVCLS                                                 06649000
UCB3DISP EQU   UCBDVCLS                                                 06650000
UCB3COMM EQU   UCBDVCLS                                                 06651000
UCB3TAPE EQU   UCBDVCLS                                                 06652000
UCBDVPWR EQU   UCB2OPT7                                                 06653000
UCBVLPWR EQU   UCB2OPT6                                                 06654000
UCB2OPT5 EQU   UCBTBYT2                                                 06655000
UCBRVDEV EQU   UCBRWTAU                                                 06656000
UCBRPS   EQU   UCBDUDN2                                                 06657000
UCBRR    EQU   UCBDUDN1                                                 06658000
UCB2OPT1 EQU   UCBTBYT2                                                 06659000
UCB2OPT0 EQU   UCBTBYT2                                                 06660000
UCB1FEA7 EQU   UCBTBYT1                                                 06661000
UCBD6250 EQU   UCB1FEA6                                                 06662000
UCBD1600 EQU   UCB1FEA5                                                 06663000
UCB1FEA4 EQU   UCBTBYT1                                                 06664000
UCB1FEA3 EQU   UCBTBYT1                                                 06665000
UCB1FEA2 EQU   UCBTBYT1                                                 06666000
UCB1FEA1 EQU   UCBTBYT1                                                 06667000
UCB1FEA0 EQU   UCBTBYT1                                                 06668000
UCBRV029 EQU   UCBWGT                                                   06669000
UCBVHRSN EQU   UCBWGT                                                   06670000
UCBVORSN EQU   UCBWGT                                                   06671000
UCBMTPXP EQU   UCBWGT                                                   06672000
UCBREW   EQU   UCBWGT                                                   06673000
UCBPUB   EQU   UCBWGT                                                   06674000
UCBOUT   EQU   UCBWGT                                                   06675000
UCBIN    EQU   UCBWGT                                                   06676000
UCBCPU   EQU   UCBOB+11                                                 06677000
UCBLCI   EQU   UCBOB+10                                                 06678000
UCBCNT   EQU   UCBOB+9                                                  06679000
UCBRV017 EQU   UCBCHM1                                                  06680000
UCBRV016 EQU   UCBCHM1                                                  06681000
UCBRV015 EQU   UCBCHM1                                                  06682000
UCBRV014 EQU   UCBCHM1                                                  06683000
UCBSPB   EQU   UCBPTH1                                                  06684000
UCBPPB   EQU   UCBPTH1                                                  06685000
UCBSPA   EQU   UCBPTH0                                                  06686000
UCBPPA   EQU   UCBPTH0                                                  06687000
UCBSIGP  EQU   UCBFLB                                                   06688000
UCBVALPH EQU   UCBFLB                                                   06689000
UCBCRHSN EQU   UCBFLB                                                   06690000
UCBCRHRV EQU   UCBFLB                                                   06691000
UCBRESVH EQU   UCBFLB                                                   06692000
UCBSPST  EQU   UCBFLB                                                   06693000
UCBASNS  EQU   UCBFLB                                                   06694000
UCBIORST EQU   UCBFLB                                                   06695000
UCBQISCE EQU   UCBFL1                                                   06696000
UCBACTV  EQU   UCBFL1                                                   06697000
UCBSAP   EQU   UCBFL1                                                   06698000
UCBNOTRC EQU   UCBCUB                                                   06699000
UCBPSNS  EQU   UCBFL1                                                   06700000
UCBUSING EQU   UCBPST                                                   06701000
UCBNOTRD EQU   UCBNRY                                                   06702000
UCBBUSYD EQU   UCBBSY                                                   06703000
UCBUA    EQU   UCBCHAN+1                                                06704000
UCBCHA   EQU   UCBCHAN                                                  06705000
UCBDADI  EQU   UCBSTAT                                                  06706000
UCBSYSR  EQU   UCBSTAT                                                  06707000
UCBPRES  EQU   UCBSTAT                                                  06708000
UCBALOC  EQU   UCBSTAT                                                  06709000
UCBUNLD  EQU   UCBSTAT                                                  06710000
UCBRESV  EQU   UCBSTAT                                                  06711000
UCBCHGS  EQU   UCBSTAT                                                  06712000
UCBONLI  EQU   UCBSTAT                                                  06713000
UCBID    EQU   UCBOB+2                                                  06714000
UCBALTPH EQU   UCBFL5                                                   06715000
UCBALTCU EQU   UCBFL5                                                   06716000
UCBNALOC EQU   UCBFL5                                                   06717000
UCBENVRD EQU   UCBFL5                                                   06718000
UCBVSDR  EQU   UCBFL5                                                   06719000
UCBSASK  EQU   UCBFL5                                                   06720000
UCBAMV   EQU   UCBAF                                                    06721000
UCBDCC   EQU   UCBFL5                                                   06722000
UCBMONT  EQU   UCBJBNR                                                  06723000
UCBRV011 EQU   UCBJBNR                                                  06724000
UCBMMSGP EQU   UCBJBNR                                                  06725000
UCBOLDSM EQU   UCBJBNR                                                  06726000
UCBRV003 EQU   UCBJBNR                                                  06727000
UCBDUC   EQU   UCBJBNR                                                  06728000
UCBJES3  EQU   UCBJBNR                                                  06729000
UCBCMSEG EQU   UCBOB                                                    06730000
UCBPFXND EQU   UCB+512                                                  06731000
UCBIOQ   EQU   UCB+508                                                  06732000
UCBLOCK  EQU   UCB+504                                                  06733000
UCBPXST  EQU   UCB+504                                                  06734000
@NM00069 EQU   UCB                                                      06735000
TIOCSTEP EQU   TIOT1+8                                                  06736000
TIOCNJOB EQU   TIOT1                                                    06737000
@NM00066 EQU   TCBXTNT2+32                                              06738000
TCBRV181 EQU   TCBRV173                                                 06739000
TCBRV180 EQU   TCBRV173                                                 06740000
TCBRV179 EQU   TCBRV173                                                 06741000
TCBRV178 EQU   TCBRV173                                                 06742000
TCBRV177 EQU   TCBRV173                                                 06743000
TCBRV176 EQU   TCBRV173                                                 06744000
TCBRV175 EQU   TCBRV173                                                 06745000
TCBRV174 EQU   TCBRV173                                                 06746000
TCBRV172 EQU   TCBRV164                                                 06747000
TCBRV171 EQU   TCBRV164                                                 06748000
TCBRV170 EQU   TCBRV164                                                 06749000
TCBRV169 EQU   TCBRV164                                                 06750000
TCBRV168 EQU   TCBRV164                                                 06751000
TCBRV167 EQU   TCBRV164                                                 06752000
TCBRV166 EQU   TCBRV164                                                 06753000
TCBRV165 EQU   TCBRV164                                                 06754000
TCBRV163 EQU   TCBRV155                                                 06755000
TCBRV162 EQU   TCBRV155                                                 06756000
TCBRV161 EQU   TCBRV155                                                 06757000
TCBRV160 EQU   TCBRV155                                                 06758000
TCBRV159 EQU   TCBRV155                                                 06759000
TCBRV158 EQU   TCBRV155                                                 06760000
TCBRV157 EQU   TCBRV155                                                 06761000
TCBRV156 EQU   TCBRV155                                                 06762000
TCBRV154 EQU   TCBRV146                                                 06763000
TCBRV153 EQU   TCBRV146                                                 06764000
TCBRV152 EQU   TCBRV146                                                 06765000
TCBRV151 EQU   TCBRV146                                                 06766000
TCBRV150 EQU   TCBRV146                                                 06767000
TCBRV149 EQU   TCBRV146                                                 06768000
TCBRV148 EQU   TCBRV146                                                 06769000
TCBRV147 EQU   TCBRV146                                                 06770000
TCBRV145 EQU   TCBXTNT2+26                                              06771000
TCBRV144 EQU   TCBXTNT2+24                                              06772000
TCBRV143 EQU   TCBXTNT2+20                                              06773000
TCBRV142 EQU   TCBXTNT2+16                                              06774000
TCBRSV49 EQU   TCBXTNT2+12                                              06775000
TCBEVENT EQU   TCBXTNT2+8                                               06776000
TCBRCMP  EQU   TCBXTNT2+5                                               06777000
TCBRSVAB EQU   TCBXTNT2+4                                               06778000
TCBGTFA  EQU   TCBGTF+1                                                 06779000
TCBRSV47 EQU   TCBTFLG                                                  06780000
TCBRSV46 EQU   TCBTFLG                                                  06781000
TCBRSV45 EQU   TCBTFLG                                                  06782000
TCBRSV44 EQU   TCBTFLG                                                  06783000
TCBRSV43 EQU   TCBTFLG                                                  06784000
TCBDSPIT EQU   TCBTFLG                                                  06785000
TCBERRTN EQU   TCBTFLG                                                  06786000
TCBASYNC EQU   TCBTFLG                                                  06787000
@NM00065 EQU   TCB+296                                                  06788000
TCBSVCA2 EQU   TCB+292                                                  06789000
TCBSWASA EQU   TCB+288                                                  06790000
TCBDBTB  EQU   TCB+284                                                  06791000
TCBRPT   EQU   TCB+280                                                  06792000
TCBRV141 EQU   TCBRV133                                                 06793000
TCBRV140 EQU   TCBRV133                                                 06794000
TCBRV139 EQU   TCBRV133                                                 06795000
TCBRV138 EQU   TCBRV133                                                 06796000
TCBRV137 EQU   TCBRV133                                                 06797000
TCBRV136 EQU   TCBRV133                                                 06798000
TCBRV135 EQU   TCBRV133                                                 06799000
TCBRV134 EQU   TCBRV133                                                 06800000
TCBRV132 EQU   TCBRV124                                                 06801000
TCBRV131 EQU   TCBRV124                                                 06802000
TCBRV130 EQU   TCBRV124                                                 06803000
TCBRV129 EQU   TCBRV124                                                 06804000
TCBRV128 EQU   TCBRV124                                                 06805000
TCBRV127 EQU   TCBRV124                                                 06806000
TCBRV126 EQU   TCBRV124                                                 06807000
TCBRV125 EQU   TCBRV124                                                 06808000
TCBRV123 EQU   TCBFBYT2                                                 06809000
TCBRV122 EQU   TCBFBYT2                                                 06810000
TCBECBNV EQU   TCBFBYT2                                                 06811000
TCBSSSYN EQU   TCBFBYT2                                                 06812000
TCBFPRAP EQU   TCBFBYT2                                                 06813000
TCBFDW   EQU   TCBFBYT2                                                 06814000
TCBFMW   EQU   TCBFBYT2                                                 06815000
TCBCNCB  EQU   TCBFBYT2                                                 06816000
TCBLLH   EQU   TCBFBYT1                                                 06817000
TCBRV113 EQU   TCBFBYT1                                                 06818000
TCBEOT   EQU   TCBFBYT1                                                 06819000
TCBRTM2  EQU   TCBFBYT1                                                 06820000
TCBPGNLY EQU   TCBFBYT1                                                 06821000
TCBNDIOS EQU   TCBFBYT1                                                 06822000
TCBACTIV EQU   TCBFBYT1                                                 06823000
TCBEOTFM EQU   TCBFBYT1                                                 06824000
TCBAFFN  EQU   TCB+274                                                  06825000
TCBCCPVI EQU   TCB+272                                                  06826000
TCBUKYSP EQU   TCB+268                                                  06827000
TCBMODE  EQU   TCBESTAE+3                                               06828000
TCBERTYP EQU   TCBESTAE+2                                               06829000
TCBRV314 EQU   TCBESTRM                                                 06830000
TCBRV313 EQU   TCBESTRM                                                 06831000
TCBRV312 EQU   TCBESTRM                                                 06832000
TCBRV311 EQU   TCBESTRM                                                 06833000
TCBRV310 EQU   TCBESTRM                                                 06834000
TCBRV309 EQU   TCBESTRM                                                 06835000
TCBRV308 EQU   TCBESTRM                                                 06836000
TCBETERM EQU   TCBESTRM                                                 06837000
TCBSCBKY EQU   TCBESTAE                                                 06838000
TCBRTM12 EQU   TCB+260                                                  06839000
TCBTCBID EQU   TCB+256                                                  06840000
TCBRSV96 EQU   TCB+252                                                  06841000
TCBSWA   EQU   TCB+248                                                  06842000
TCBFOEA  EQU   TCBFOE+1                                                 06843000
TCBRSV42 EQU   TCBFOE                                                   06844000
TCBRV306 EQU   TCB+240                                                  06845000
TCBRSV41 EQU   TCB+239                                                  06846000
TCBTID   EQU   TCB+238                                                  06847000
TCBRSVAA EQU   TCB+237                                                  06848000
TCBABCUR EQU   TCB+236                                                  06849000
TCBTMSAV EQU   TCB+232                                                  06850000
TCBIOTIM EQU   TCB+228                                                  06851000
TCBRTWA  EQU   TCB+224                                                  06852000
TCBBACK  EQU   TCB+220                                                  06853000
TCBTIRB  EQU   TCB+216                                                  06854000
TCBAECB  EQU   TCB+212                                                  06855000
TCBEXT2A EQU   TCBEXT2+1                                                06856000
TCBRSV39 EQU   TCBEXT2                                                  06857000
TCBSTMCT EQU   TCB+207                                                  06858000
TCBSYSCT EQU   TCB+206                                                  06859000
TCBRSV37 EQU   TCB+205                                                  06860000
TCBEXSVC EQU   TCBDAR                                                   06861000
TCBDARMS EQU   TCBDAR                                                   06862000
TCBDARWT EQU   TCBDAR                                                   06863000
TCBDARO  EQU   TCBDAR                                                   06864000
TCBDARMC EQU   TCBDARC                                                  06865000
TCBDARD  EQU   TCBDAR                                                   06866000
TCBDARS  EQU   TCBDAR                                                   06867000
TCBDARP  EQU   TCBDAR                                                   06868000
TCBGTOFM EQU   TCBFLGS7                                                 06869000
TCBADMP  EQU   TCBFLGS7                                                 06870000
TCBRSTSK EQU   TCBFLGS7                                                 06871000
TCBSVCS  EQU   TCBFLGS7                                                 06872000
TCBSTACK EQU   TCBFLGS7                                                 06873000
TCBRSV34 EQU   TCBFLGS7                                                 06874000
TCBRSV33 EQU   TCBFLGS7                                                 06875000
TCBGPECB EQU   TCBFLGS7                                                 06876000
TCBNTJS  EQU   TCBFLGS6                                                 06877000
TCBAPG   EQU   TCBFLGS6                                                 06878000
TCBMIGR  EQU   TCBFLGS6                                                 06879000
TCBRV303 EQU   TCBFLGS6                                                 06880000
TCBSPVLK EQU   TCBFLGS6                                                 06881000
TCBCPU   EQU   TCBFLGS6                                                 06882000
TCBPIE17 EQU   TCBFLGS6                                                 06883000
TCBRV    EQU   TCBFLGS6                                                 06884000
TCBRSV79 EQU   TCBNDSP5                                                 06885000
TCBRSV78 EQU   TCBNDSP5                                                 06886000
TCBRSV77 EQU   TCBNDSP5                                                 06887000
TCBRSV76 EQU   TCBNDSP5                                                 06888000
TCBRSV75 EQU   TCBNDSP5                                                 06889000
TCBRSV74 EQU   TCBNDSP5                                                 06890000
TCBRSV95 EQU   TCBNDSP5                                                 06891000
TCBRSV94 EQU   TCBNDSP5                                                 06892000
TCBRSV93 EQU   TCBNDSP4                                                 06893000
TCBRSV92 EQU   TCBNDSP4                                                 06894000
TCBRSV91 EQU   TCBNDSP4                                                 06895000
TCBRSV90 EQU   TCBNDSP4                                                 06896000
TCBRSV89 EQU   TCBNDSP4                                                 06897000
TCBRSV88 EQU   TCBNDSP4                                                 06898000
TCBRSV87 EQU   TCBNDSP4                                                 06899000
TCBRSV86 EQU   TCBNDSP4                                                 06900000
TCBEXT1A EQU   TCBEXT1+1                                                06901000
TCBRSV32 EQU   TCBEXT1                                                  06902000
TCBEXCPD EQU   TCB+192                                                  06903000
TCBIOBRC EQU   TCB+188                                                  06904000
TCBDDWTC EQU   TCB+186                                                  06905000
TCBDDEXC EQU   TCB+184                                                  06906000
TCBJSCBB EQU   TCBJSCB+1                                                06907000
@NM00064 EQU   TCBRECDE                                                 06908000
TCBREC   EQU   TCBRECDE                                                 06909000
TCBMDIDS EQU   TCB+176                                                  06910000
TCBNDINT EQU   TCBNDSP3                                                 06911000
TCBRSV27 EQU   TCBNDSP3                                                 06912000
TCBRSV26 EQU   TCBNDSP3                                                 06913000
TCBRSV25 EQU   TCBNDSP3                                                 06914000
TCBRSV24 EQU   TCBNDSP3                                                 06915000
TCBSRBND EQU   TCBNDSP3                                                 06916000
TCBRV302 EQU   TCBNDSP3                                                 06917000
TCBLJSND EQU   TCBNDSP3                                                 06918000
TCBABE   EQU   TCBNDSP2                                                 06919000
TCBDSS   EQU   TCBNDSP2                                                 06920000
TCBOWAIT EQU   TCBNDSP2                                                 06921000
TCBIWAIT EQU   TCBNDSP2                                                 06922000
TCBNDTS  EQU   TCBNDSP2                                                 06923000
TCBNDSVC EQU   TCBNDSP2                                                 06924000
TCBSTPP  EQU   TCBNDSP2                                                 06925000
TCBABD   EQU   TCBNDSP2                                                 06926000
TCBRSV22 EQU   TCBNDSP1                                                 06927000
TCBPIEND EQU   TCBNDSP1                                                 06928000
TCBTPSP  EQU   TCBNDSP1                                                 06929000
TCBDDRND EQU   TCBNDSP1                                                 06930000
TCBRSPND EQU   TCBNDSP1                                                 06931000
TCBRSTND EQU   TCBNDSP1                                                 06932000
TCBDARPN EQU   TCBNDSP1                                                 06933000
TCBDARTN EQU   TCBNDSP1                                                 06934000
TCBNDSP0 EQU   TCBNDSP                                                  06935000
TCBUSER  EQU   TCB+168                                                  06936000
TCBTCTB  EQU   TCBTCT+1                                                 06937000
TCBRSV9C EQU   TCBTCTGF                                                 06938000
TCBRSV9B EQU   TCBTCTGF                                                 06939000
TCBRSV9A EQU   TCBTCTGF                                                 06940000
TCBRSV99 EQU   TCBTCTGF                                                 06941000
TCBRSV98 EQU   TCBTCTGF                                                 06942000
TCBRSV97 EQU   TCBTCTGF                                                 06943000
TCBRSV20 EQU   TCBTCTGF                                                 06944000
TCBSMFGF EQU   TCBTCTGF                                                 06945000
TCBSTABB EQU   TCBSTAB+1                                                06946000
TCBSTCUR EQU   TCBNSTAE                                                 06947000
TCBRV301 EQU   TCBNSTAE                                                 06948000
TCBSYNCH EQU   TCBNSTAE                                                 06949000
TCBHALT  EQU   TCBNSTAE                                                 06950000
TCBPPSUP EQU   TCBNSTAE                                                 06951000
TCB33E   EQU   TCBNSTAE                                                 06952000
TCBQUIES EQU   TCBNSTAE                                                 06953000
TCBSTABE EQU   TCBNSTAE                                                 06954000
TCBAQE   EQU   TCB+156                                                  06955000
TCBPQE   EQU   TCB+152                                                  06956000
TCBTSDP  EQU   TCB+151                                                  06957000
TCBTSLP  EQU   TCB+150                                                  06958000
TCBSTPCT EQU   TCB+149                                                  06959000
TCBCPUBN EQU   TCBTSFLG                                                 06960000
TCBDYDSP EQU   TCBTSFLG                                                 06961000
TCBRSV18 EQU   TCBTSFLG                                                 06962000
TCBRSV17 EQU   TCBTSFLG                                                 06963000
TCBTIOTG EQU   TCBTSFLG                                                 06964000
TCBATT   EQU   TCBTSFLG                                                 06965000
TCBSTPPR EQU   TCBTSFLG                                                 06966000
TCBRV300 EQU   TCBTSTSK                                                 06967000
TCBECB   EQU   TCB+144                                                  06968000
TCBIQE   EQU   TCB+140                                                  06969000
TCBLTC   EQU   TCB+136                                                  06970000
TCBOTC   EQU   TCB+132                                                  06971000
TCBNTC   EQU   TCB+128                                                  06972000
TCBJSTCA EQU   TCBJSTCB+1                                               06973000
TCBRSV16 EQU   TCBJSTCB                                                 06974000
TCBTQET  EQU   TCBTME                                                   06975000
TCBTCB   EQU   TCB+116                                                  06976000
TCBFSAB  EQU   TCBFSA+1                                                 06977000
TCBQEL   EQU   TCBFSA                                                   06978000
TCBGRS15 EQU   TCBGRS+60                                                06979000
TCBGRS14 EQU   TCBGRS+56                                                06980000
TCBGRS13 EQU   TCBGRS+52                                                06981000
TCBGRS12 EQU   TCBGRS+48                                                06982000
TCBGRS11 EQU   TCBGRS+44                                                06983000
TCBGRS10 EQU   TCBGRS+40                                                06984000
TCBGRS9  EQU   TCBGRS+36                                                06985000
TCBGRS8  EQU   TCBGRS+32                                                06986000
TCBGRS7  EQU   TCBGRS+28                                                06987000
TCBGRS6  EQU   TCBGRS+24                                                06988000
TCBGRS5  EQU   TCBGRS+20                                                06989000
TCBGRS4  EQU   TCBGRS+16                                                06990000
TCBGRS3  EQU   TCBGRS+12                                                06991000
TCBGRS2  EQU   TCBGRS+8                                                 06992000
TCBGRS1  EQU   TCBGRS+4                                                 06993000
TCBGRS0  EQU   TCBGRS                                                   06994000
TCBJPQB  EQU   TCBJPQ+1                                                 06995000
TCBRSV15 EQU   TCBPURGE                                                 06996000
TCBRSV14 EQU   TCBPURGE                                                 06997000
TCBRSV13 EQU   TCBPURGE                                                 06998000
TCBRSV12 EQU   TCBPURGE                                                 06999000
TCBRSV11 EQU   TCBPURGE                                                 07000000
TCBRSV10 EQU   TCBPURGE                                                 07001000
TCBRSV09 EQU   TCBPURGE                                                 07002000
TCBJPQF  EQU   TCBPURGE                                                 07003000
TCBJLB   EQU   TCB+40                                                   07004000
TCBLLS   EQU   TCB+36                                                   07005000
TCBDSP   EQU   TCB+35                                                   07006000
TCBLMP   EQU   TCB+34                                                   07007000
TCBPNDSP EQU   TCBFLGS5                                                 07008000
TCBFCD1  EQU   TCBFLGS5                                                 07009000
TCBSTP   EQU   TCBFLGS5                                                 07010000
TCBSYS   EQU   TCBFLGS5                                                 07011000
TCBANDSP EQU   TCBFLGS5                                                 07012000
TCBPAGE  EQU   TCBFLGS5                                                 07013000
TCBUXNDF EQU   TCBABWF                                                  07014000
TCBFC    EQU   TCBFLGS5                                                 07015000
TCBONDSP EQU   TCBFLGS4                                                 07016000
TCBMPCND EQU   TCBFLGS4                                                 07017000
TCBMPCVQ EQU   TCBFLGS4                                                 07018000
TCBUXNDV EQU   TCBFLGS4                                                 07019000
TCBHNDSP EQU   TCBFLGS4                                                 07020000
TCBRQENA EQU   TCBFLGS4                                                 07021000
TCBSER   EQU   TCBFLGS4                                                 07022000
TCBNDUMP EQU   TCBFLGS4                                                 07023000
TCBDWSTA EQU   TCBFLGS3                                                 07024000
TCBRSV08 EQU   TCBFLGS3                                                 07025000
TCBRSV07 EQU   TCBFLGS3                                                 07026000
TCBRSV06 EQU   TCBFLGS3                                                 07027000
TCBABGM  EQU   TCBFLGS3                                                 07028000
TCBABTRM EQU   TCBFLGS3                                                 07029000
TCBADINP EQU   TCBFLGS3                                                 07030000
TCBFSM   EQU   TCBFLGS3                                                 07031000
TCBFTS   EQU   TCBFLGS2                                                 07032000
TCBFETXR EQU   TCBFLGS2                                                 07033000
TCBFDSOP EQU   TCBFLGS2                                                 07034000
TCBFJMC  EQU   TCBFLGS2                                                 07035000
TCBFSMC  EQU   TCBFLGS2                                                 07036000
TCBFABOP EQU   TCBFLGS2                                                 07037000
TCBFSTI  EQU   TCBFLGS2                                                 07038000
TCBFOINP EQU   TCBFLGS2                                                 07039000
TCBFX    EQU   TCBFLGS1                                                 07040000
TCBFS    EQU   TCBFLGS1                                                 07041000
TCBFT    EQU   TCBFLGS1                                                 07042000
TCBPDUMP EQU   TCBFLGS1                                                 07043000
TCBNONPR EQU   TCBFLGS1                                                 07044000
TCBFERA  EQU   TCBFLGS1                                                 07045000
TCBFE    EQU   TCBFLGS1                                                 07046000
TCBFA    EQU   TCBFLGS1                                                 07047000
TCBZERO  EQU   TCBPKF                                                   07048000
TCBFLAG  EQU   TCBPKF                                                   07049000
TCBMSSB  EQU   TCBMSS+1                                                 07050000
TCBRSV03 EQU   TCBMSS                                                   07051000
TCBTRNB  EQU   TCBTRN+1                                                 07052000
TCBRSV02 EQU   TCBABF                                                   07053000
TCBOLTEP EQU   TCBABF                                                   07054000
TCBTCP   EQU   TCBABF                                                   07055000
TCBTCPP  EQU   TCBABF                                                   07056000
TCBRSV01 EQU   TCBABF                                                   07057000
TCBGRPH  EQU   TCBABF                                                   07058000
TCBNOCHK EQU   TCBABF                                                   07059000
TCBMOD91 EQU   TCBABF                                                   07060000
TCBCMPC  EQU   TCBCMP+1                                                 07061000
TCBRV318 EQU   TCBCMSG                                                  07062000
TCBRV317 EQU   TCBCIND                                                  07063000
TCBRV316 EQU   TCBCWTO                                                  07064000
TCBCASID EQU   TCBCDBL                                                  07065000
TCBNOCC  EQU   TCBSTCC                                                  07066000
TCBDMPO  EQU   TCBCPP                                                   07067000
TCBCSTEP EQU   TCBCMPF                                                  07068000
TCBCREQ  EQU   TCBCMPF                                                  07069000
TCBPIEA  EQU   TCBPIE+1                                                 07070000
TCBPM    EQU   TCBPMASK                                                 07071000
@NM00063 EQU   TCBPMASK                                                 07072000
TCBRBP   EQU   TCB                                                      07073000
TCBFRS6  EQU   TCBFRS+24                                                07074000
TCBFRS4  EQU   TCBFRS+16                                                07075000
TCBFRS2  EQU   TCBFRS+8                                                 07076000
TCBFRS0  EQU   TCBFRS                                                   07077000
@NM00062 EQU   TCBWORDS                                                 07078000
DEBXSAMB EQU   DEBXTN+28                                                07079000
DEBXOPNJ EQU   DEBXTN+24                                                07080000
DEBXXARG EQU   DEBXTN+20                                                07081000
DEBXMCF2 EQU   DEBXTN+19                                                07082000
DEBXMCF1 EQU   DEBXTN+18                                                07083000
DEBXDSO2 EQU   DEBXTN+17                                                07084000
DEBXDSO1 EQU   DEBXTN+16                                                07085000
DEBXDBPR EQU   DEBXTN+12                                                07086000
DEBXDCBM EQU   DEBXTN+8                                                 07087000
DEBXDSAB EQU   DEBXTN+4                                                 07088000
DEBXRV48 EQU   DEBXTN+3                                                 07089000
DEBXRV47 EQU   DEBXFLG1                                                 07090000
DEBXRV46 EQU   DEBXFLG1                                                 07091000
DEBXRV45 EQU   DEBXFLG1                                                 07092000
DEBXRV44 EQU   DEBXFLG1                                                 07093000
DEBXRV43 EQU   DEBXFLG1                                                 07094000
DEBXDSSI EQU   DEBXFLG1                                                 07095000
DEBXTSKC EQU   DEBXFLG1                                                 07096000
DEBXCDCB EQU   DEBXFLG1                                                 07097000
DEBXLNGH EQU   DEBXTN                                                   07098000
DEBTBLOF EQU   DEBPREFX+14                                              07099000
DEBAMTYP EQU   DEBPREFX+13                                              07100000
DEBDCBMK EQU   DEBXTNP                                                  07101000
DEBDSCBA EQU   DEBPREFX+1                                               07102000
DEBWKARA EQU   DEBPREFX                                                 07103000
DEBXCEAD EQU   DEBXCEA+1                                                07104000
DEBRSV35 EQU   DEBXCEAB                                                 07105000
DEBRSV34 EQU   DEBXCEAB                                                 07106000
DEBRSV33 EQU   DEBXCEAB                                                 07107000
DEBRSV32 EQU   DEBXCEAB                                                 07108000
DEBCEAD  EQU   DEBCEA+1                                                 07109000
DEBCENP  EQU   DEBCEAB                                                  07110000
DEBRSV31 EQU   DEBCEAB                                                  07111000
DEBRSV30 EQU   DEBCEAB                                                  07112000
DEBRSV29 EQU   DEBCEAB                                                  07113000
DEBRSV28 EQU   DEBCEAB                                                  07114000
DEBPCIAD EQU   DEBPCIA+1                                                07115000
DEBPCINP EQU   DEBPCIAB                                                 07116000
DEBRSV27 EQU   DEBPCIAB                                                 07117000
DEBRSV26 EQU   DEBPCIAB                                                 07118000
DEBRSV25 EQU   DEBPCIAB                                                 07119000
DEBRSV24 EQU   DEBPCIAB                                                 07120000
DEBSIOAD EQU   DEBSIOA+1                                                07121000
DEBFIX   EQU   DEBSIOAB                                                 07122000
DEBIOVR  EQU   DEBSIOAB                                                 07123000
DEBSIOX  EQU   DEBSIOAB                                                 07124000
DEBEOEAD EQU   DEBEOEA+1                                                07125000
DEBEOENP EQU   DEBEOEAB                                                 07126000
DEBRSV22 EQU   DEBEOEAB                                                 07127000
DEBRSV21 EQU   DEBEOEAB                                                 07128000
DEBRSV20 EQU   DEBEOEAB                                                 07129000
DEBESMVR EQU   DEBEOEAB                                                 07130000
DEBSUBID EQU   DEBSUBNM                                                 07131000
DEBSIOA2 EQU   DEBACS08+24                                              07132000
DEBRPSIO EQU   DEBACS08+20                                              07133000
DEBFREED EQU   DEBACS08+16                                              07134000
@NM00037 EQU   DEBACS08+12                                              07135000
@NM00036 EQU   DEBACS08+8                                               07136000
DEBDISAD EQU   DEBACS08+4                                               07137000
@NM00035 EQU   DEBACS08                                                 07138000
DEBRPSST EQU   DEBACS07+64                                              07139000
DEBARECK EQU   DEBACS07+60                                              07140000
DEBAREWT EQU   DEBACS07+56                                              07141000
DEBACHK  EQU   DEBACS07+52                                              07142000
DEBAWRIT EQU   DEBACS07+48                                              07143000
DEBASETL EQU   DEBACS07+44                                              07144000
DEBAREAD EQU   DEBACS07+40                                              07145000
DEBCRECK EQU   DEBACS07+36                                              07146000
DEBCREWT EQU   DEBACS07+32                                              07147000
DEBCCHK  EQU   DEBACS07+28                                              07148000
DEBCWRIT EQU   DEBACS07+24                                              07149000
DEBCSETL EQU   DEBACS07+20                                              07150000
DEBCREAD EQU   DEBACS07+16                                              07151000
DEBWKPT5 EQU   DEBACS07+12                                              07152000
DEBWKPT4 EQU   DEBACS07+8                                               07153000
DEBGET   EQU   DEBACS07+4                                               07154000
@NM00034 EQU   DEBACS07                                                 07155000
DEBPUT   EQU   DEBACS06+4                                               07156000
DEBDCBFA EQU   DEBACS06                                                 07157000
DEBLUCBB EQU   DEBLUCBA+1                                               07158000
DEBRSV18 EQU   DEBLUCBA                                                 07159000
DEBFUCBB EQU   DEBFUCBA+1                                               07160000
DEBRSV17 EQU   DEBFUCBA                                                 07161000
DEBTCCWB EQU   DEBTCCWA+1                                               07162000
DEBRSV16 EQU   DEBTCCWA                                                 07163000
DEBTBFRB EQU   DEBTBFRA+1                                               07164000
DEBRSV15 EQU   DEBTBFRA                                                 07165000
DEBDBPEF EQU   DEBACS03+8                                               07166000
DEBDBPP  EQU   DEBACS03+4                                               07167000
DEBDTPP  EQU   DEBACS03                                                 07168000
DEBDBPE  EQU   DEBDBLK+1                                                07169000
DEBDBPT  EQU   DEBDBLK                                                  07170000
DEBEXTNM EQU   DEBDSNAM                                                 07171000
DEBLRECL EQU   DEBACSMD+14                                              07172000
DEBBLKSI EQU   DEBACSMD+12                                              07173000
DEBRSV14 EQU   DEBDSNM+4                                                07174000
DEBUTSAB EQU   DEBUTSAA+1                                               07175000
DEBRSV13 EQU   DEBUTSAA                                                 07176000
DEBVOLNM EQU   DEBACSMD+2                                               07177000
DEBVLSEQ EQU   DEBVOLSQ+1                                               07178000
DEBRSV42 EQU   DEBVOLBT                                                 07179000
DEBRSV41 EQU   DEBVOLBT                                                 07180000
DEBRSV40 EQU   DEBVOLBT                                                 07181000
DEBRSV39 EQU   DEBVOLBT                                                 07182000
DEBRSV38 EQU   DEBVOLBT                                                 07183000
DEBRSV37 EQU   DEBVOLBT                                                 07184000
DEBRSV36 EQU   DEBVOLBT                                                 07185000
DEBEXFUL EQU   DEBVOLBT                                                 07186000
DEBNMTRK EQU   DEBDASD+14                                               07187000
DEBBINUM EQU   DEBDASD+4                                                07188000
DEBUCBA  EQU   DEBUCBAD+1                                               07189000
DEBDCBB  EQU   DEBDCBAD+1                                               07190000
DEBECBB  EQU   DEBECBAD+1                                               07191000
DEBPRIOR EQU   DEBECBAD                                                 07192000
DEBUSRPB EQU   DEBUSRPG+1                                               07193000
DEBRSV05 EQU   DEBBASIC+15                                              07194000
DEBXTNIN EQU   DEBFLGS1                                                 07195000
DEBAPFIN EQU   DEBFLGS1                                                 07196000
DEBF1CEV EQU   DEBFLGS1                                                 07197000
DEBCINDI EQU   DEBFLGS1                                                 07198000
DEBRSV02 EQU   DEBFLGS1                                                 07199000
DEBRSIOA EQU   DEBFLGS1                                                 07200000
DEBEOFDF EQU   DEBFLGS1                                                 07201000
DEBPWCKD EQU   DEBFLGS1                                                 07202000
DEBQSCNT EQU   DEBBASIC+13                                              07203000
DEBACCS  EQU   DEBOPATB                                                 07204000
DEBPOSIT EQU   DEBOPATB                                                 07205000
DEBZERO  EQU   DEBOPATB                                                 07206000
DEBABEND EQU   DEBOPATB                                                 07207000
DEBIRBB  EQU   DEBIRBAD+1                                               07208000
DEBRERR  EQU   DEBOFLGS                                                 07209000
DEBLABEL EQU   DEBOFLGS                                                 07210000
DEBSPLIT EQU   DEBOFLGS                                                 07211000
DEBDCB   EQU   DEBOFLGS                                                 07212000
DEBRLSE  EQU   DEBOFLGS                                                 07213000
DEBEOF   EQU   DEBOFLGS                                                 07214000
DEBDISP  EQU   DEBOFLGS                                                 07215000
DEBAMLNG EQU   DEBDEBAD                                                 07216000
DEBTCBB  EQU   DEBTCBAD+1                                               07217000
DEBNMSUB EQU   DEBTCBAD                                                 07218000
IOBERRCT EQU   IOBSTDRD+30                                              07219000
IOBRSV19 EQU   IOBINCAM+1                                               07220000
IOBOLTST EQU   IOBBTAMF                                                 07221000
IOBRFTMG EQU   IOBBTAMF                                                 07222000
IOBRSV17 EQU   IOBBTAMF                                                 07223000
IOBRSV16 EQU   IOBBTAMF                                                 07224000
IOBRSV15 EQU   IOBBTAMF                                                 07225000
IOBRSV14 EQU   IOBBTAMF                                                 07226000
IOBINUSE EQU   IOBBTAMF                                                 07227000
IOBPRMER EQU   IOBBTAMF                                                 07228000
IOBRSTRB EQU   IOBRESTR+1                                               07229000
IOBREPOS EQU   IOBRESTR                                                 07230000
IOBDCBPB EQU   IOBDCBPT+1                                               07231000
IOBRSV44 EQU   IOBFLAG4                                                 07232000
IOBJES3I EQU   IOBFLAG4                                                 07233000
IOBRSV42 EQU   IOBFLAG4                                                 07234000
IOBRSV41 EQU   IOBFLAG4                                                 07235000
IOBRSV40 EQU   IOBFLAG4                                                 07236000
IOBPMERR EQU   IOBFLAG4                                                 07237000
IOBCC3WE EQU   IOBFLAG4                                                 07238000
IOBGDPOL EQU   IOBFLAG4                                                 07239000
IOBSTRTB EQU   IOBSTART+1                                               07240000
IOBSIOCC EQU   IOBSTART                                                 07241000
IOBCSB7  EQU   IOBCSTAT                                                 07242000
IOBCSB6  EQU   IOBCSTAT                                                 07243000
IOBCSB5  EQU   IOBCSTAT                                                 07244000
IOBCSB4  EQU   IOBCSTAT                                                 07245000
IOBCSB3  EQU   IOBCSTAT                                                 07246000
IOBCSB2  EQU   IOBCSTAT                                                 07247000
IOBCSB1  EQU   IOBCSTAT                                                 07248000
IOBCSB0  EQU   IOBCSTAT                                                 07249000
IOBUSB7  EQU   IOBUSTAT                                                 07250000
IOBUSB6  EQU   IOBUSTAT                                                 07251000
IOBUSB5  EQU   IOBUSTAT                                                 07252000
IOBUSB4  EQU   IOBUSTAT                                                 07253000
IOBUSB3  EQU   IOBUSTAT                                                 07254000
IOBUSB2  EQU   IOBUSTAT                                                 07255000
IOBUSB1  EQU   IOBUSTAT                                                 07256000
IOBUSB0  EQU   IOBUSTAT                                                 07257000
IOBCMDA  EQU   IOBIOCSW                                                 07258000
IOBLOG   EQU   IOBFL3                                                   07259000
IOBJAM   EQU   IOBICL                                                   07260000
IOBMSG   EQU   IOBFL3                                                   07261000
IOBSDR   EQU   IOBCNC                                                   07262000
IOBACU   EQU   IOBFL3                                                   07263000
IOBCDC   EQU   IOBFL3                                                   07264000
IOBICC   EQU   IOBFL3                                                   07265000
IOBCCC   EQU   IOBFL3                                                   07266000
IOBECBPB EQU   IOBECBPT+1                                               07267000
IOBECBCC EQU   IOBECBPT                                                 07268000
IOBS1B7  EQU   IOBSENS1                                                 07269000
IOBS1B6  EQU   IOBSENS1                                                 07270000
IOBS1B5  EQU   IOBSENS1                                                 07271000
IOBS1B4  EQU   IOBSENS1                                                 07272000
IOBS1B3  EQU   IOBSENS1                                                 07273000
IOBS1B2  EQU   IOBSENS1                                                 07274000
IOBS1B1  EQU   IOBSENS1                                                 07275000
IOBS1B0  EQU   IOBSENS1                                                 07276000
IOBSNSC9 EQU   IOBS0B7                                                  07277000
IOBS0B6  EQU   IOBSENS0                                                 07278000
IOBS0B5  EQU   IOBSENS0                                                 07279000
IOBS0B4  EQU   IOBSENS0                                                 07280000
IOBS0B3  EQU   IOBSENS0                                                 07281000
IOBS0B2  EQU   IOBSENS0                                                 07282000
IOBS0B1  EQU   IOBSENS0                                                 07283000
IOBS0B0  EQU   IOBSENS0                                                 07284000
IOBPNCH  EQU   IOBFLAG2                                                 07285000
IOBSTATO EQU   IOBFLAG2                                                 07286000
IOBSKUPD EQU   IOBFLAG2                                                 07287000
IOBALTTR EQU   IOBFLAG2                                                 07288000
IOBRRT2  EQU   IOBRDHA0                                                 07289000
IOBRRT3  EQU   IOBPURGE                                                 07290000
IOBSENSE EQU   IOBFLAG2                                                 07291000
IOBHALT  EQU   IOBFLAG2                                                 07292000
IOBSPSVC EQU   IOBRSTRT                                                 07293000
IOBIOERR EQU   IOBFLAG1                                                 07294000
IOBFCREX EQU   IOBCYCCK                                                 07295000
IOBRPSTN EQU   IOBFLAG1                                                 07296000
IOBERRTN EQU   IOBFLAG1                                                 07297000
IOBDATCH EQU   IOBFLAG1                                                 07298000
IOBCNOPA EQU   IOBPREFX+12                                              07299000
IOBCICB  EQU   IOBPREFX+8                                               07300000
IOBCECB  EQU   IOBPREFX+4                                               07301000
IOBCONOP EQU   IOBPREFX+3                                               07302000
IOBCINOP EQU   IOBPREFX+2                                               07303000
IOBRSV05 EQU   IOBPREFX+1                                               07304000
IOBPCI   EQU   IOBCFLG1                                                 07305000
IOBRSTCH EQU   IOBCFLG1                                                 07306000
IOBABAPP EQU   IOBCFLG1                                                 07307000
IOBPTST  EQU   IOBCFLG1                                                 07308000
IOBRSV04 EQU   IOBCFLG1                                                 07309000
IOBRSV03 EQU   IOBCFLG1                                                 07310000
IOBRSV02 EQU   IOBCFLG1                                                 07311000
IOBRSV01 EQU   IOBCFLG1                                                 07312000
DCBEOB   EQU   IHADCS40+20                                              07313000
DCBPRECL EQU   IHADCS40+18                                              07314000
@NM00033 EQU   IHADCS40+16                                              07315000
DCBCNTRA EQU   DCBCNTRL+1                                               07316000
@NM00032 EQU   DCBEROPT                                                 07317000
DCBERABE EQU   DCBEROPT                                                 07318000
DCBERSKP EQU   DCBEROPT                                                 07319000
DCBERACC EQU   DCBEROPT                                                 07320000
DCBLRECL EQU   IHADCS40+10                                              07321000
@NM00031 EQU   IHADCS40+9                                               07322000
@NM00030 EQU   IHADCS40+8                                               07323000
DCBRECA  EQU   DCBRECAD+1                                               07324000
@NM00029 EQU   DCBRECBT                                                 07325000
DCBRCFGT EQU   DCBRCREL                                                 07326000
DCBRCTRU EQU   DCBRCREL                                                 07327000
DCBLCCW  EQU   DCBEOBAD                                                 07328000
@NM00028 EQU   DCBFLAG1                                                 07329000
DCBSTFLS EQU   DCBFLAG1                                                 07330000
DCBSTQCK EQU   DCBFLAG1                                                 07331000
DCBDIRCQ EQU   DCBBUFOF                                                 07332000
DCBQSTRU EQU   DCBUSASI                                                 07333000
@NM00027 EQU   DCBUSASI                                                 07334000
DCBQADF3 EQU   DCBQADFS                                                 07335000
DCBQADF2 EQU   DCBQADFS                                                 07336000
DCBQADF1 EQU   DCBQADFS                                                 07337000
DCBBLBP  EQU   DCBUSASI                                                 07338000
@NM00026 EQU   DCBUSASI                                                 07339000
DCBCICBA EQU   DCBCICB+1                                                07340000
@NM00025 EQU   DCBCICB                                                  07341000
DCBOFFSW EQU   IHADCS36+15                                              07342000
DCBOFFSR EQU   IHADCS36+14                                              07343000
DCBWCPL  EQU   IHADCS36+13                                              07344000
DCBWCPO  EQU   IHADCS36+12                                              07345000
DCBBLKSI EQU   IHADCS36+10                                              07346000
DCBCNQSM EQU   DCBCIND2                                                 07347000
DCBCNFEO EQU   DCBCIND2                                                 07348000
DCBCNCHS EQU   DCBCIND2                                                 07349000
DCBCNBFP EQU   DCBCIND2                                                 07350000
DCBCNIOE EQU   DCBCIND2                                                 07351000
DCBCNCLO EQU   DCBCIND2                                                 07352000
DCBCNWRO EQU   DCBCIND2                                                 07353000
DCBCNSTO EQU   DCBCIND2                                                 07354000
DCBCNEXB EQU   DCBCIND1                                                 07355000
@NM00024 EQU   DCBCIND1                                                 07356000
DCBCNBRM EQU   DCBCIND1                                                 07357000
@NM00023 EQU   DCBCIND1                                                 07358000
DCBCNEVA EQU   DCBCIND1                                                 07359000
DCBCNEVB EQU   DCBCIND1                                                 07360000
DCBCNSRD EQU   DCBCIND1                                                 07361000
DCBCNTOV EQU   DCBCIND1                                                 07362000
DCBSYNA  EQU   DCBSYNAD+1                                               07363000
DCBIOBL  EQU   DCBSYNAD                                                 07364000
DCBCHCKA EQU   DCBPERRA                                                 07365000
DCBOPTJ  EQU   DCBOPTCD                                                 07366000
DCBOPTT  EQU   DCBOPTCD                                                 07367000
DCBSRCHD EQU   DCBOPTZ                                                  07368000
DCBOPTQ  EQU   DCBOPTCD                                                 07369000
DCBBCKPT EQU   DCBOPTO                                                  07370000
DCBOPTC  EQU   DCBOPTCD                                                 07371000
DCBOPTU  EQU   DCBOPTCD                                                 07372000
DCBOPTW  EQU   DCBOPTCD                                                 07373000
@NM00022 EQU   IHADCS44+10                                              07374000
DCBXENDA EQU   IHADCS44+8                                               07375000
DCBCENDA EQU   IHADCS44+6                                               07376000
DCBSIOA  EQU   IHADCS44+4                                               07377000
DCBPCIA  EQU   IHADCS44+2                                               07378000
DCBEOEA  EQU   IHADCS44                                                 07379000
@NM00021 EQU   IHADCS28+1                                               07380000
@NM00020 EQU   IHADCS28                                                 07381000
DCBPUTA  EQU   DCBGETA                                                  07382000
@NM00019 EQU   DCBPUT                                                   07383000
DCBDEBA  EQU   DCBDEBAD+1                                               07384000
@NM00018 EQU   DCBIFLGS                                                 07385000
DCBIFIOE EQU   DCBIFLGS                                                 07386000
DCBCH12  EQU   DCBIFPCT                                                 07387000
DCBCH9   EQU   DCBIFPCT                                                 07388000
DCBIFEC  EQU   DCBIFLGS                                                 07389000
DCBMFSTI EQU   DCBMFDMD                                                 07390000
DCBMFAWR EQU   DCBMFSTK                                                 07391000
DCBMFUIP EQU   DCBMFTMD                                                 07392000
DCBMFIDW EQU   DCBMFLCP                                                 07393000
DCBMFWRK EQU   DCBMFMVP                                                 07394000
DCBMFRDQ EQU   DCBMFWRT                                                 07395000
DCBMFGTQ EQU   DCBMFPUT                                                 07396000
DCBMFSTL EQU   DCBMACF2                                                 07397000
DCBMFCK  EQU   DCBMFDMG                                                 07398000
DCBMFRDX EQU   DCBMFCHK                                                 07399000
DCBMFDBF EQU   DCBMFSBG                                                 07400000
DCBMFRDI EQU   DCBMFLCG                                                 07401000
DCBMFRDK EQU   DCBMFMVG                                                 07402000
DCBMFWRQ EQU   DCBMFRD                                                  07403000
DCBMFPTQ EQU   DCBMFGET                                                 07404000
DCBMFECP EQU   DCBMACF1                                                 07405000
DCBMRSTI EQU   DCBMRDMD                                                 07406000
DCBMRAWR EQU   DCBMRSTK                                                 07407000
DCBMRUIP EQU   DCBMRTMD                                                 07408000
DCBMRIDW EQU   DCBMRLCP                                                 07409000
DCBMRWRK EQU   DCBMRMVP                                                 07410000
DCBMRRDQ EQU   DCBMRWRT                                                 07411000
DCBMRGTQ EQU   DCBMRPUT                                                 07412000
DCBMRSTL EQU   DCBMACR2                                                 07413000
DCBMRCK  EQU   DCBMRDMG                                                 07414000
DCBPGFXA EQU   DCBMRRDX                                                 07415000
DCBMRDBF EQU   DCBMRSBG                                                 07416000
DCBMRRDI EQU   DCBMRLCG                                                 07417000
DCBMRRDK EQU   DCBMRMVG                                                 07418000
DCBMRWRQ EQU   DCBMRRD                                                  07419000
DCBMRPTQ EQU   DCBMRGET                                                 07420000
DCBMRECP EQU   DCBMACR1                                                 07421000
@NM00017 EQU   DCBIFLG                                                  07422000
DCBIBIOE EQU   DCBIFLG                                                  07423000
DCBICH12 EQU   DCBIBPCT                                                 07424000
DCBICH9  EQU   DCBIBPCT                                                 07425000
DCBIBEC  EQU   DCBIFLG                                                  07426000
DCBOFIOF EQU   DCBOFLGS                                                 07427000
DCBOFUEX EQU   DCBOFLGS                                                 07428000
DCBOFTM  EQU   DCBOFLGS                                                 07429000
DCBOFPPC EQU   DCBOFLGS                                                 07430000
DCBOFEOV EQU   DCBOFLGS                                                 07431000
DCBOFLRB EQU   DCBOFLGS                                                 07432000
DCBOFIOD EQU   DCBOFLWR                                                 07433000
DCBDDNAM EQU   IHADCS24                                                 07434000
DCBEXLSA EQU   DCBEXLST+1                                               07435000
DCBRECKL EQU   DCBRECFM                                                 07436000
DCBRECCC EQU   DCBRECFM                                                 07437000
DCBRECSB EQU   DCBRECFM                                                 07438000
DCBRECBR EQU   DCBRECFM                                                 07439000
DCBRECTO EQU   DCBRECLA                                                 07440000
DCBRECL  EQU   DCBRECLA                                                 07441000
DCBEODA  EQU   DCBEODAD+1                                               07442000
DCBBFA   EQU   DCBBFTEK                                                 07443000
DCBH0    EQU   DCBBFTEK                                                 07444000
DCBBFTKD EQU   DCBBFTEK                                                 07445000
DCBBFTE  EQU   DCBBFT                                                   07446000
DCBBFTKR EQU   DCBBFT                                                   07447000
DCBBFTS  EQU   DCBBFT                                                   07448000
DCBH1    EQU   DCBBFTEK                                                 07449000
DCBSVCXA EQU   DCBSVCXL+1                                               07450000
@NM00016 EQU   DCBSVCXL                                                 07451000
DCBODEBA EQU   DCBIOBAA                                                 07452000
@NM00015 EQU   DCBQSLM                                                  07453000
DCBUPDBT EQU   DCBQSLM                                                  07454000
DCBUPDCM EQU   DCBQSLM                                                  07455000
DCB1DVDS EQU   DCBQSLM                                                  07456000
@NM00014 EQU   DCBDSRG2                                                 07457000
DCBDSGTR EQU   DCBDSRG2                                                 07458000
DCBACBM  EQU   DCBDSRG2                                                 07459000
@NM00013 EQU   DCBDSRG2                                                 07460000
DCBDSGTQ EQU   DCBDSRG2                                                 07461000
DCBDSGTX EQU   DCBDSRG2                                                 07462000
DCBDSGGS EQU   DCBDSRG2                                                 07463000
DCBDSGU  EQU   DCBDSRG1                                                 07464000
DCBDSGPO EQU   DCBDSRG1                                                 07465000
@NM00012 EQU   DCBDSRG1                                                 07466000
@NM00011 EQU   DCBDSRG1                                                 07467000
DCBDSGCX EQU   DCBDSRG1                                                 07468000
DCBDSGDA EQU   DCBDSRG1                                                 07469000
DCBDSGPS EQU   DCBDSRG1                                                 07470000
DCBDSGIS EQU   DCBDSRG1                                                 07471000
DCBBUFL  EQU   IHADCS11+8                                               07472000
DCBBUFCA EQU   DCBBUFCB+1                                               07473000
DCBBUFNO EQU   DCBBUFCB                                                 07474000
DCBDEVT  EQU   DCBREL                                                   07475000
DCBKEYLE EQU   DCBRELB                                                  07476000
DCBTRBAL EQU   IHADCS01+6                                               07477000
@NM00010 EQU   IHADCS01+5                                               07478000
@NM00009 EQU   IHADCS01+4                                               07479000
DCBDVTBA EQU   DCBDVTBL+1                                               07480000
@NM00008 EQU   DCBDVTBL                                                 07481000
DCBKEYCN EQU   IHADCS00+4                                               07482000
DCBRELAD EQU   IHADCS00                                                 07483000
@NM00007 EQU   IHADCB                                                   07484000
CVTLEVL  EQU   CVTRELNO+2                                               07485000
CVTNUMB  EQU   CVTRELNO                                                 07486000
CVTMDL   EQU   CVTFIX+250                                               07487000
@NM00006 EQU   CVTFIX+248                                               07488000
@NM00005 EQU   CVTFIX                                                   07489000
CVTRV482 EQU   CVTXTNT2+128                                             07490000
CVTRV481 EQU   CVTXTNT2+124                                             07491000
CVTRV480 EQU   CVTXTNT2+120                                             07492000
CVTRV479 EQU   CVTXTNT2+118                                             07493000
CVTRV478 EQU   CVTXTNT2+117                                             07494000
CVTRV477 EQU   CVTXTNT2+116                                             07495000
CVTRV476 EQU   CVTXTNT2+115                                             07496000
CVTRV475 EQU   CVTXTNT2+114                                             07497000
CVTRV474 EQU   CVTRV466                                                 07498000
CVTRV473 EQU   CVTRV466                                                 07499000
CVTRV472 EQU   CVTRV466                                                 07500000
CVTRV471 EQU   CVTRV466                                                 07501000
CVTRV470 EQU   CVTRV466                                                 07502000
CVTRV469 EQU   CVTRV466                                                 07503000
CVTRV468 EQU   CVTRV466                                                 07504000
CVTRV467 EQU   CVTRV466                                                 07505000
CVTRV465 EQU   CVTRV457                                                 07506000
CVTRV464 EQU   CVTRV457                                                 07507000
CVTRV463 EQU   CVTRV457                                                 07508000
CVTRV462 EQU   CVTRV457                                                 07509000
CVTRV461 EQU   CVTRV457                                                 07510000
CVTRV460 EQU   CVTRV457                                                 07511000
CVTRV459 EQU   CVTRV457                                                 07512000
CVTRV458 EQU   CVTRV457                                                 07513000
CVTRV456 EQU   CVTXTNT2+108                                             07514000
CVTRV455 EQU   CVTXTNT2+104                                             07515000
CVTRV454 EQU   CVTXTNT2+100                                             07516000
CVTRV453 EQU   CVTXTNT2+96                                              07517000
CVTRV452 EQU   CVTXTNT2+94                                              07518000
CVTRV451 EQU   CVTXTNT2+92                                              07519000
CVTRV450 EQU   CVTXTNT2+90                                              07520000
CVTRV449 EQU   CVTXTNT2+88                                              07521000
CVTRV448 EQU   CVTXTNT2+87                                              07522000
CVTRV447 EQU   CVTXTNT2+86                                              07523000
CVTRV446 EQU   CVTRV438                                                 07524000
CVTRV445 EQU   CVTRV438                                                 07525000
CVTRV444 EQU   CVTRV438                                                 07526000
CVTRV443 EQU   CVTRV438                                                 07527000
CVTRV442 EQU   CVTRV438                                                 07528000
CVTRV441 EQU   CVTRV438                                                 07529000
CVTRV440 EQU   CVTRV438                                                 07530000
CVTRV439 EQU   CVTRV438                                                 07531000
CVTRV437 EQU   CVTRV429                                                 07532000
CVTRV436 EQU   CVTRV429                                                 07533000
CVTRV435 EQU   CVTRV429                                                 07534000
CVTRV434 EQU   CVTRV429                                                 07535000
CVTRV433 EQU   CVTRV429                                                 07536000
CVTRV432 EQU   CVTRV429                                                 07537000
CVTRV431 EQU   CVTRV429                                                 07538000
CVTRV430 EQU   CVTRV429                                                 07539000
CVTRV428 EQU   CVTXTNT2+80                                              07540000
CVTRV427 EQU   CVTXTNT2+76                                              07541000
CVTRV426 EQU   CVTXTNT2+72                                              07542000
CVTRV425 EQU   CVTXTNT2+68                                              07543000
CVTATACT EQU   CVTATCVT                                                 07544000
CVTRV423 EQU   CVTXTNT2+62                                              07545000
CVTRV422 EQU   CVTXTNT2+60                                              07546000
CVTRV421 EQU   CVTXTNT2+58                                              07547000
CVTRV420 EQU   CVTXTNT2+56                                              07548000
CVTRV419 EQU   CVTXTNT2+55                                              07549000
CVTRV418 EQU   CVTXTNT2+54                                              07550000
CVTRV417 EQU   CVTRV409                                                 07551000
CVTRV416 EQU   CVTRV409                                                 07552000
CVTRV415 EQU   CVTRV409                                                 07553000
CVTRV414 EQU   CVTRV409                                                 07554000
CVTRV413 EQU   CVTRV409                                                 07555000
CVTRV412 EQU   CVTRV409                                                 07556000
CVTRV411 EQU   CVTRV409                                                 07557000
CVTRV410 EQU   CVTRV409                                                 07558000
CVTRV408 EQU   CVTRV400                                                 07559000
CVTRV407 EQU   CVTRV400                                                 07560000
CVTRV406 EQU   CVTRV400                                                 07561000
CVTRV405 EQU   CVTRV400                                                 07562000
CVTRV404 EQU   CVTRV400                                                 07563000
CVTRV403 EQU   CVTRV400                                                 07564000
CVTRV402 EQU   CVTRV400                                                 07565000
CVTRV401 EQU   CVTRV400                                                 07566000
CVTICB   EQU   CVTXTNT2+48                                              07567000
CVTSKTA  EQU   CVTXTNT2+44                                              07568000
CVTRSV99 EQU   CVTXTNT2+40                                              07569000
CVTRSV98 EQU   CVTXTNT2+36                                              07570000
CVTRSV97 EQU   CVTXTNT2+34                                              07571000
CVTRSV96 EQU   CVTXTNT2+32                                              07572000
CVTOLTEP EQU   CVTXTNT2+28                                              07573000
CVTQIDA  EQU   CVTQID+1                                                 07574000
CVTRSV95 EQU   CVTQID                                                   07575000
CVTRSV94 EQU   CVTXTNT2+20                                              07576000
CVTRSV93 EQU   CVTXTNT2+16                                              07577000
CVTRSV92 EQU   CVTXTNT2+12                                              07578000
CVTDEBVR EQU   CVTXTNT2+8                                               07579000
CVTRSV91 EQU   CVTXTNT2+6                                               07580000
CVTRSV9H EQU   CVTFLGBT                                                 07581000
CVTRSV9G EQU   CVTFLGBT                                                 07582000
CVTRSV9F EQU   CVTFLGBT                                                 07583000
CVTRSV9E EQU   CVTFLGBT                                                 07584000
CVTRSV9D EQU   CVTFLGBT                                                 07585000
CVTRSV9C EQU   CVTFLGBT                                                 07586000
CVTVME   EQU   CVTFLGBT                                                 07587000
CVTNPE   EQU   CVTFLGBT                                                 07588000
CVTNUCLS EQU   CVTXTNT2+4                                               07589000
CVTDSSVA EQU   CVTDSSV+1                                                07590000
CVTRSV89 EQU   CVTDSSV                                                  07591000
CVTRSV88 EQU   CVTXTNT1+8                                               07592000
CVTRSV87 EQU   CVTXTNT1+4                                               07593000
CVTFACHN EQU   CVTXTNT1                                                 07594000
CVTRV488 EQU   CVTMAP+412                                               07595000
CVTRV487 EQU   CVTMAP+408                                               07596000
CVTRV486 EQU   CVTMAP+404                                               07597000
CVTRV485 EQU   CVTMAP+400                                               07598000
CVTACTAP EQU   CVTMAP+396                                               07599000
CVTAUTH  EQU   CVTMAP+392                                               07600000
CVTATMCA EQU   CVTATMCT+1                                               07601000
CVTATMST EQU   CVTATMCT                                                 07602000
CVTRSV61 EQU   CVTMAP+384                                               07603000
CVTVOLT1 EQU   CVTVOLM1+1                                               07604000
CVTVOLI1 EQU   CVTVOLF1                                                 07605000
CVTSTOA  EQU   CVTMAP+376                                               07606000
CVTRSV58 EQU   CVTMAP+374                                               07607000
CVTRSV57 EQU   CVTMAP+372                                               07608000
CVTDDCE  EQU   CVTMAP+368                                               07609000
CVTPNWFR EQU   CVTMAP+364                                               07610000
CVTSMF   EQU   CVTMAP+360                                               07611000
CVTSULK  EQU   CVTMAP+358                                               07612000
CVTSLKO  EQU   CVTSYSK                                                  07613000
CVTSLKP  EQU   CVTSYSK                                                  07614000
CVTSLKQ  EQU   CVTSYSK                                                  07615000
CVTSLKR  EQU   CVTSYSK                                                  07616000
CVTRSV56 EQU   CVTSYSK                                                  07617000
CVTRSV55 EQU   CVTSYSK                                                  07618000
CVTRSV54 EQU   CVTSYSK                                                  07619000
CVTRSV53 EQU   CVTSYSK                                                  07620000
CVTRSV52 EQU   CVTA1F1                                                  07621000
CVTRSV51 EQU   CVTA1F1                                                  07622000
CVTRSV50 EQU   CVTA1F1                                                  07623000
CVTRSV49 EQU   CVTA1F1                                                  07624000
CVTRSV48 EQU   CVTA1F1                                                  07625000
CVTRSV47 EQU   CVTA1F1                                                  07626000
CVTSRSW  EQU   CVTA1F1                                                  07627000
CVTPFSW  EQU   CVTA1F1                                                  07628000
CVTPCVT  EQU   CVTMAP+352                                               07629000
CVTRSV46 EQU   CVTMAP+344                                               07630000
CVTRSV45 EQU   CVTMAP+340                                               07631000
CVTRSV44 EQU   CVTMAP+338                                               07632000
CVTRSV43 EQU   CVTMAP+336                                               07633000
CVTHJESA EQU   CVTHJES+1                                                07634000
CVTRSV42 EQU   CVTHJES                                                  07635000
CVTEXT2A EQU   CVTEXT2+1                                                07636000
CVTRSV41 EQU   CVTEXT2                                                  07637000
CVTAPFA  EQU   CVTAPF+1                                                 07638000
CVTRSV40 EQU   CVTAPF                                                   07639000
CVTRV518 EQU   CVTINTLA                                                 07640000
CVTRV517 EQU   CVTERPV                                                  07641000
CVTEORM  EQU   CVTMAP+312                                               07642000
CVTMCHPR EQU   CVTMAP+308                                               07643000
CVTTZ    EQU   CVTMAP+304                                               07644000
CVTJEPS  EQU   CVTMAP+300                                               07645000
CVTJESCT EQU   CVTMAP+296                                               07646000
CVTMODE  EQU   CVTMAP+292                                               07647000
CVTPTRV  EQU   CVTMAP+288                                               07648000
CVTREAL  EQU   CVTMAP+284                                               07649000
CVTRSV39 EQU   CVTMAP+280                                               07650000
CVTRSV38 EQU   CVTMAP+276                                               07651000
CVTDMSRA EQU   CVTDMSR+1                                                07652000
CVTRV634 EQU   CVTDMSRF                                                 07653000
CVTRV633 EQU   CVTDMSRF                                                 07654000
CVTRV632 EQU   CVTDMSRF                                                 07655000
CVTRV631 EQU   CVTDMSRF                                                 07656000
CVTRV630 EQU   CVTDMSRF                                                 07657000
CVTRV629 EQU   CVTDMSRF                                                 07658000
CVTUDUMP EQU   CVTDMSRF                                                 07659000
CVTSDUMP EQU   CVTDMSRF                                                 07660000
CVTQMSGA EQU   CVTQMSG+1                                                07661000
CVTRSV36 EQU   CVTQMSG                                                  07662000
CVTAMFF  EQU   CVTMAP+264                                               07663000
CVTPURGA EQU   CVTPURG+1                                                07664000
CVTRSV35 EQU   CVTPURG                                                  07665000
CVTCBSP  EQU   CVTMAP+256                                               07666000
CVTATERA EQU   CVTATER+1                                                07667000
CVTSYST  EQU   CVTATER                                                  07668000
CVTVOLT2 EQU   CVTTAT                                                   07669000
CVTVOLI2 EQU   CVTVOLF2                                                 07670000
CVTAQAVB EQU   CVTAQAVT+1                                               07671000
CVTRSV34 EQU   CVTTCMFG                                                 07672000
CVTRSV33 EQU   CVTTCMFG                                                 07673000
CVTRSV32 EQU   CVTTCMFG                                                 07674000
CVTRSV31 EQU   CVTTCMFG                                                 07675000
CVTRSV30 EQU   CVTTCMFG                                                 07676000
CVTRSV29 EQU   CVTTCMFG                                                 07677000
CVTRSV28 EQU   CVTTCMFG                                                 07678000
CVTTCRDY EQU   CVTTCMFG                                                 07679000
CVTGTFA  EQU   CVTGTF+1                                                 07680000
CVTRSV27 EQU   CVTGTFST                                                 07681000
CVTRNIO  EQU   CVTGTFST                                                 07682000
CVTUSR   EQU   CVTGTFST                                                 07683000
CVTRV318 EQU   CVTFORM                                                  07684000
CVTRV317 EQU   CVTTMODE                                                 07685000
CVTRV316 EQU   CVTSTATE                                                 07686000
CVTRV315 EQU   CVTGTFS                                                  07687000
CVTGTFAV EQU   CVTGTFS                                                  07688000
CVT0SCR1 EQU   CVTMAP+232                                               07689000
CVTRV515 EQU   CVTMAP+228                                               07690000
CVTRMS   EQU   CVTMAP+224                                               07691000
CVTPATCH EQU   CVTMAP+220                                               07692000
CVTTSCE  EQU   CVTMAP+216                                               07693000
CVTLNKSC EQU   CVTMAP+214                                               07694000
CVTQABST EQU   CVTMAP+212                                               07695000
CVTMDLDS EQU   CVTMAP+208                                               07696000
CVTUSER  EQU   CVTMAP+204                                               07697000
CVTABEND EQU   CVTMAP+200                                               07698000
CVTSMCA  EQU   CVTMAP+196                                               07699000
CVTRSV18 EQU   CVTMAP+192                                               07700000
CVTQLPAQ EQU   CVTMAP+188                                               07701000
CVTQCDSR EQU   CVTMAP+184                                               07702000
CVTRSV17 EQU   CVTOPTB                                                  07703000
CVTRSV16 EQU   CVTOPTB                                                  07704000
CVTFP    EQU   CVTOPTB                                                  07705000
CVTAPTHR EQU   CVTOPTB                                                  07706000
CVTNLOG  EQU   CVTOPTB                                                  07707000
CVTTOD   EQU   CVTOPTB                                                  07708000
CVTCTIMS EQU   CVTOPTB                                                  07709000
CVTPROT  EQU   CVTOPTB                                                  07710000
CVTXPFP  EQU   CVTOPTA                                                  07711000
CVTASCII EQU   CVTOPTA                                                  07712000
CVTRSV13 EQU   CVTOPTA                                                  07713000
CVTRSV12 EQU   CVTOPTA                                                  07714000
CVTNIP   EQU   CVTOPTA                                                  07715000
CVTDDR   EQU   CVTOPTA                                                  07716000
CVTAPR   EQU   CVTOPTA                                                  07717000
CVTCCH   EQU   CVTOPTA                                                  07718000
CVTSNCTR EQU   CVTMAP+180                                               07719000
CVTQMWR  EQU   CVTMAP+176                                               07720000
CVTQOCR  EQU   CVTMAP+172                                               07721000
CVT1EF00 EQU   CVTMAP+168                                               07722000
CVTMZ00  EQU   CVTMAP+164                                               07723000
CVTSV76Q EQU   CVTSV76C                                                 07724000
CVTRSV11 EQU   CVTMAP+156                                               07725000
CVT0PT01 EQU   CVTMAP+152                                               07726000
CVTMSER  EQU   CVTMAP+148                                               07727000
CVTRV516 EQU   CVTIERLC                                                 07728000
CVTILCH  EQU   CVTMAP+140                                               07729000
CVT0DS   EQU   CVTMAP+136                                               07730000
CVTFBOSV EQU   CVTMAP+132                                               07731000
CVTNUCB  EQU   CVTMAP+128                                               07732000
CVTIXAVL EQU   CVTMAP+124                                               07733000
CVTSV76M EQU   CVTIOQET                                                 07734000
CVTDCBA  EQU   CVTMAP+117                                               07735000
CVTMVS2  EQU   CVTDCB                                                   07736000
CVT6DAT  EQU   CVTDCB                                                   07737000
CVT4MPS  EQU   CVTDCB                                                   07738000
CVTRSV09 EQU   CVTDCB                                                   07739000
CVT4MS1  EQU   CVTDCB                                                   07740000
CVT2SPS  EQU   CVTDCB                                                   07741000
CVT1SSS  EQU   CVTDCB                                                   07742000
CVTRSV08 EQU   CVTDCB                                                   07743000
CVTSTB   EQU   CVTMAP+112                                               07744000
CVTQTD00 EQU   CVTMAP+108                                               07745000
CVTQTE00 EQU   CVTMAP+104                                               07746000
CVTCUCB  EQU   CVTMAP+100                                               07747000
CVTSJQ   EQU   CVTMAP+96                                                07748000
CVTPBLDL EQU   CVTMAP+92                                                07749000
CVTTPC   EQU   CVTMAP+88                                                07750000
CVTSVDCB EQU   CVTMAP+84                                                07751000
CVTEXIT  EQU   CVTMAP+80                                                07752000
CVT0FN00 EQU   CVTMAP+76                                                07753000
CVTDARA  EQU   CVTDAR+1                                                 07754000
CVTRSV07 EQU   CVTFLGS1                                                 07755000
CVTRSV06 EQU   CVTFLGS1                                                 07756000
CVTRSV05 EQU   CVTFLGS1                                                 07757000
CVTRSV04 EQU   CVTFLGS1                                                 07758000
CVTRSV03 EQU   CVTFLGS1                                                 07759000
CVTRSV02 EQU   CVTFLGS1                                                 07760000
CVTRSV01 EQU   CVTFLGS1                                                 07761000
CVTDMPLK EQU   CVTFLGS1                                                 07762000
CVTXITP  EQU   CVTMAP+68                                                07763000
CVTZDTAB EQU   CVTMAP+64                                                07764000
CVTMSLT  EQU   CVTMAP+60                                                07765000
CVTDATE  EQU   CVTMAP+56                                                07766000
CVTBTERM EQU   CVTMAP+52                                                07767000
CVTSYSAD EQU   CVTMAP+48                                                07768000
CVTXTLER EQU   CVTMAP+44                                                07769000
CVTILK2  EQU   CVTMAP+40                                                07770000
CVTILK1  EQU   CVTMAP+36                                                07771000
CVTPRLTV EQU   CVTMAP+32                                                07772000
CVTPCNVT EQU   CVTMAP+28                                                07773000
CVT0VL00 EQU   CVTMAP+24                                                07774000
CVTXAPG  EQU   CVTMAP+20                                                07775000
CVTBUF   EQU   CVTMAP+16                                                07776000
CVTJOB   EQU   CVTMAP+12                                                07777000
CVTLINK  EQU   CVTMAP+8                                                 07778000
CVT0EF00 EQU   CVTMAP+4                                                 07779000
CVT      EQU   CVTMAP                                                   07780000
AP1END   EQU   AP1BLOCK+360                                             07781000
AP1SKCNT EQU   AP1BLOCK+256                                             07782000
@NM00004 EQU   AP1BLOCK+247                                             07783000
AP1PTRN2 EQU   AP1FLG3                                                  07784000
AP1NOERP EQU   AP1FLG2                                                  07785000
AP1FHF   EQU   AP1FLG2                                                  07786000
AP1NOWR  EQU   AP1FLG2                                                  07787000
CER      EQU   CECCHHR+4                                                07788000
CEHH     EQU   CECCHH+2                                                 07789000
CECC     EQU   CECCHH                                                   07790000
CEBB     EQU   AP1CESK                                                  07791000
BB       EQU   AP1SEEK+1                                                07792000
M        EQU   AP1SEEK                                                  07793000
@NM00003 EQU   AP1BUFAD                                                 07794000
AP1CCWAB EQU   AP1CCWA+1                                                07795000
@NM00002 EQU   AP1CCWA                                                  07796000
@NM00001 EQU   AP1BLOCK+150                                             07797000
@NM00061 EQU   PSA+3668                                                 07798000
PSASTAK  EQU   PSA+3072                                                 07799000
@NM00060 EQU   PSA+1048                                                 07800000
PSAUSEND EQU   PSA+1048                                                 07801000
PSARV062 EQU   PSA+1044                                                 07802000
PSACDAL  EQU   PSA+1040                                                 07803000
PSAWTCOD EQU   PSA+1036                                                 07804000
PSAATCVT EQU   PSA+1032                                                 07805000
PSAPCPSW EQU   PSA+1024                                                 07806000
PSAPIR2  EQU   PSA+1020                                                 07807000
PSARV059 EQU   PSA+1018                                                 07808000
PSASVC13 EQU   PSA+1016                                                 07809000
PSALSFCC EQU   PSA+1012                                                 07810000
PSASFACC EQU   PSA+1008                                                 07811000
PSASTOP  EQU   PSA+992                                                  07812000
PSASTART EQU   PSA+976                                                  07813000
PSARSPSW EQU   PSA+968                                                  07814000
PSASRPSW EQU   PSA+960                                                  07815000
PSARV045 EQU   PSA+892                                                  07816000
PSARV044 EQU   PSA+888                                                  07817000
PSARV043 EQU   PSA+884                                                  07818000
PSARV042 EQU   PSA+880                                                  07819000
PSARV041 EQU   PSA+876                                                  07820000
PSARV040 EQU   PSA+872                                                  07821000
PSARV025 EQU   PSA+868                                                  07822000
PSADSSED EQU   PSA+868                                                  07823000
PSADSSPR EQU   PSA+864                                                  07824000
PSADSSFW EQU   PSA+860                                                  07825000
PSADSS14 EQU   PSA+856                                                  07826000
PSADSSPP EQU   PSA+848                                                  07827000
PSADSSRP EQU   PSA+840                                                  07828000
PSADSS05 EQU   PSADSSF4                                                 07829000
PSADSS10 EQU   PSADSSF4                                                 07830000
PSADSSVE EQU   PSADSSF4                                                 07831000
PSADSSDE EQU   PSADSSF4                                                 07832000
PSADSSC0 EQU   PSADSSF4                                                 07833000
PSADSSIE EQU   PSADSSF4                                                 07834000
PSADSS12 EQU   PSADSSF4                                                 07835000
PSADSSRC EQU   PSADSSF4                                                 07836000
PSARV057 EQU   PSADSSF3                                                 07837000
PSARV056 EQU   PSADSSF3                                                 07838000
PSARV055 EQU   PSADSSF3                                                 07839000
PSADSSMC EQU   PSADSSF3                                                 07840000
PSADSSRW EQU   PSADSSF3                                                 07841000
PSADSSNM EQU   PSADSSF3                                                 07842000
PSADSSES EQU   PSADSSF3                                                 07843000
PSADSSGP EQU   PSADSSF3                                                 07844000
PSADSSF2 EQU   PSADSSFL+1                                               07845000
PSADSSPI EQU   PSADSSF1                                                 07846000
PSADSSOI EQU   PSADSSF1                                                 07847000
PSADSSSP EQU   PSADSSF1                                                 07848000
PSADSSTP EQU   PSADSSF1                                                 07849000
PSADSSDW EQU   PSADSSF1                                                 07850000
PSADSSDD EQU   PSADSSF1                                                 07851000
PSADSSDM EQU   PSADSSF1                                                 07852000
PSADSSMV EQU   PSADSSF1                                                 07853000
PSADSSTS EQU   PSA+816                                                  07854000
PSADSSWK EQU   PSA+812                                                  07855000
PSADSSR3 EQU   PSA+808                                                  07856000
PSADSSR2 EQU   PSA+804                                                  07857000
PSADSSRS EQU   PSA+800                                                  07858000
PSASTOR  EQU   PSA+796                                                  07859000
PSACPUSA EQU   PSA+794                                                  07860000
PSAVSTAP EQU   PSA+792                                                  07861000
PSAWKVAP EQU   PSA+788                                                  07862000
PSAWKRAP EQU   PSA+784                                                  07863000
PSAMCHIC EQU   PSA+783                                                  07864000
PSARV061 EQU   PSA+782                                                  07865000
PSASYMSK EQU   PSA+781                                                  07866000
PSAMCHFL EQU   PSA+780                                                  07867000
PSACR0   EQU   PSA+776                                                  07868000
PSAPSWSV EQU   PSA+768                                                  07869000
PSACLHS  EQU   PSAHLHI                                                  07870000
PSALKR15 EQU   PSALKSA+60                                               07871000
PSALKR14 EQU   PSALKSA+56                                               07872000
PSALKR13 EQU   PSALKSA+52                                               07873000
PSALKR12 EQU   PSALKSA+48                                               07874000
PSALKR11 EQU   PSALKSA+44                                               07875000
PSALKR10 EQU   PSALKSA+40                                               07876000
PSALKR9  EQU   PSALKSA+36                                               07877000
PSALKR8  EQU   PSALKSA+32                                               07878000
PSALKR7  EQU   PSALKSA+28                                               07879000
PSALKR6  EQU   PSALKSA+24                                               07880000
PSALKR5  EQU   PSALKSA+20                                               07881000
PSALKR4  EQU   PSALKSA+16                                               07882000
PSALKR3  EQU   PSALKSA+12                                               07883000
PSALKR2  EQU   PSALKSA+8                                                07884000
PSALKR1  EQU   PSALKSA+4                                                07885000
PSALKR0  EQU   PSALKSA                                                  07886000
PSARV023 EQU   PSACLHT+52                                               07887000
PSALOCAL EQU   PSACLHT+48                                               07888000
PSACMSL  EQU   PSACLHT+44                                               07889000
PSAOPTL  EQU   PSACLHT+40                                               07890000
PSATPACL EQU   PSACLHT+36                                               07891000
PSATPDNL EQU   PSACLHT+32                                               07892000
PSATPNCL EQU   PSACLHT+28                                               07893000
PSAIOSLL EQU   PSACLHT+24                                               07894000
PSAIOSUL EQU   PSACLHT+20                                               07895000
PSAIOSCL EQU   PSACLHT+16                                               07896000
PSAIOSSL EQU   PSACLHT+12                                               07897000
PSASALCL EQU   PSACLHT+8                                                07898000
PSAASML  EQU   PSACLHT+4                                                07899000
PSADISPL EQU   PSACLHT                                                  07900000
PSASRSA  EQU   PSA+636                                                  07901000
PSARV050 EQU   PSA+634                                                  07902000
PSADSSGO EQU   PSA+633                                                  07903000
PSARECUR EQU   PSA+632                                                  07904000
PSAHLHIS EQU   PSA+628                                                  07905000
PSAIPCSA EQU   PSA+624                                                  07906000
@NM00059 EQU   PSA+621                                                  07907000
PSAIPCDM EQU   PSA+620                                                  07908000
PSAIPCD  EQU   PSA+616                                                  07909000
@NM00058 EQU   PSA+613                                                  07910000
PSAIPCRM EQU   PSA+612                                                  07911000
PSAIPCR  EQU   PSA+608                                                  07912000
PSAMCHEX EQU   PSA+600                                                  07913000
PSAMPSW  EQU   PSA+592                                                  07914000
PSAEXPS2 EQU   PSA+584                                                  07915000
PSAEXPS1 EQU   PSA+576                                                  07916000
PSAPIREG EQU   PSA+572                                                  07917000
PSARSREG EQU   PSA+568                                                  07918000
PSAGPREG EQU   PSA+556                                                  07919000
PSARV022 EQU   PSASUP4                                                  07920000
PSARV021 EQU   PSASUP4                                                  07921000
PSARV020 EQU   PSASUP4                                                  07922000
PSARV019 EQU   PSASUP4                                                  07923000
PSARV018 EQU   PSASUP4                                                  07924000
PSARV017 EQU   PSASUP4                                                  07925000
PSARV016 EQU   PSASUP4                                                  07926000
PSARV015 EQU   PSASUP4                                                  07927000
PSARV014 EQU   PSASUP3                                                  07928000
PSARV013 EQU   PSASUP3                                                  07929000
PSARV012 EQU   PSASUP3                                                  07930000
PSAESTA  EQU   PSASUP3                                                  07931000
PSASPR   EQU   PSASUP3                                                  07932000
PSAPSREG EQU   PSASUP3                                                  07933000
PSAPI2   EQU   PSASUP3                                                  07934000
PSAIOSUP EQU   PSASUP3                                                  07935000
PSALCR   EQU   PSASUP2                                                  07936000
PSARTM   EQU   PSASUP2                                                  07937000
PSAACR   EQU   PSASUP2                                                  07938000
PSAIPCE2 EQU   PSASUP2                                                  07939000
PSAIPCES EQU   PSASUP2                                                  07940000
PSAIPCEC EQU   PSASUP2                                                  07941000
PSAGTF   EQU   PSASUP2                                                  07942000
PSAIPCRI EQU   PSASUP2                                                  07943000
PSATYPE6 EQU   PSASUP1                                                  07944000
PSATCTL  EQU   PSASUP1                                                  07945000
PSADISP  EQU   PSASUP1                                                  07946000
PSALOCK  EQU   PSASUP1                                                  07947000
PSAPI    EQU   PSASUP1                                                  07948000
PSAEXT   EQU   PSASUP1                                                  07949000
PSASVC   EQU   PSASUP1                                                  07950000
PSAIO    EQU   PSASUP1                                                  07951000
PSAAOLD  EQU   PSA+548                                                  07952000
PSAANEW  EQU   PSA+544                                                  07953000
PSATOLD  EQU   PSA+540                                                  07954000
PSATNEW  EQU   PSA+536                                                  07955000
PSALCCAR EQU   PSA+532                                                  07956000
PSALCCAV EQU   PSA+528                                                  07957000
PSAPCCAR EQU   PSA+524                                                  07958000
PSAPCCAV EQU   PSA+520                                                  07959000
PSACPULA EQU   PSA+518                                                  07960000
PSACPUPA EQU   PSA+516                                                  07961000
PSAPSA   EQU   PSA+512                                                  07962000
FLCHDEND EQU   PSA+512                                                  07963000
FLCCRSAV EQU   FLCMCLA+280                                              07964000
FLCGRSAV EQU   FLCMCLA+216                                              07965000
FLCFPSAV EQU   FLCMCLA+184                                              07966000
FLCFLA   EQU   FLCMCLA+88                                               07967000
FLCRGNCD EQU   FLCMCLA+84                                               07968000
FLCFSAA  EQU   FLCFSA+1                                                 07969000
@NM00057 EQU   FLCFSA                                                   07970000
@NM00056 EQU   FLCMCLA+72                                               07971000
FLCMCIC  EQU   FLCMCLA+64                                               07972000
@NM00055 EQU   FLCMCLA+20                                               07973000
FLCIOAA  EQU   FLCIOA+1                                                 07974000
@NM00054 EQU   FLCIOA                                                   07975000
@NM00053 EQU   FLCMCLA+15                                               07976000
@NM00052 EQU   FLCMCLA+14                                               07977000
@NM00051 EQU   FLCMCLA+12                                               07978000
FLCLCL   EQU   FLCMCLA+8                                                07979000
FLCIOELA EQU   FLCIOEL+1                                                07980000
@NM00050 EQU   FLCIOEL                                                  07981000
FLCCHNID EQU   FLCMCLA                                                  07982000
@NM00049 EQU   PSA+160                                                  07983000
FLCMTRCD EQU   PSA+157                                                  07984000
@NM00048 EQU   PSA+156                                                  07985000
FLCPERA  EQU   FLCPER+1                                                 07986000
@NM00047 EQU   FLCPER                                                   07987000
@NM00046 EQU   PSA+151                                                  07988000
FLCPERCD EQU   PSA+150                                                  07989000
FLCMCNUM EQU   PSA+149                                                  07990000
@NM00045 EQU   PSA+148                                                  07991000
FLCTEAA  EQU   FLCTEA+1                                                 07992000
@NM00044 EQU   FLCTEA                                                   07993000
PSAPIPC  EQU   PSAPICOD                                                 07994000
PSAPIMC  EQU   PSAPICOD                                                 07995000
PSAPIPER EQU   PSAPICOD                                                 07996000
PSARV049 EQU   FLCPICOD                                                 07997000
FLCPILCB EQU   FLCPIILC                                                 07998000
@NM00043 EQU   FLCPIILC                                                 07999000
@NM00042 EQU   PSAEPPSW                                                 08000000
FLCSVCN  EQU   PSAESPSW+2                                               08001000
FLCSILCB EQU   FLCSVILC                                                 08002000
@NM00041 EQU   FLCSVILC                                                 08003000
@NM00040 EQU   PSAESPSW                                                 08004000
FLCEICOD EQU   PSAEEPSW+2                                               08005000
PSASPAD  EQU   PSAEEPSW                                                 08006000
@NM00039 EQU   PSA+128                                                  08007000
FLCINPSW EQU   PSA+120                                                  08008000
FLCMNPSW EQU   PSA+112                                                  08009000
FLCPNPSW EQU   PSA+104                                                  08010000
FLCSNPSW EQU   PSA+96                                                   08011000
FLCENPSW EQU   PSA+88                                                   08012000
FLCTRACE EQU   PSA+84                                                   08013000
FLCTIMER EQU   PSA+80                                                   08014000
FLCCVT2  EQU   PSA+76                                                   08015000
FLCCAW   EQU   PSA+72                                                   08016000
FLCCSW   EQU   PSA+64                                                   08017000
FLCIOPSW EQU   PSA+56                                                   08018000
FLCMOPSW EQU   PSA+48                                                   08019000
FLCPOPSW EQU   PSA+40                                                   08020000
FLCSOPSW EQU   PSA+32                                                   08021000
FLCEOPSW EQU   PSA+24                                                   08022000
@NM00038 EQU   FLCICCW2+4                                               08023000
FLCICCW1 EQU   FLCROPSW                                                 08024000
FLCIPPSW EQU   FLCRNPSW                                                 08025000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      08026000
@RC00425 EQU   @RC00422                                                 08027000
@RC00632 EQU   @RC00631                                                 08028000
@RC00704 EQU   @RC00683                                                 08029000
@RC00684 EQU   @RC00683                                                 08030000
@RC00769 EQU   @RC00768                                                 08031000
@RC00791 EQU   @RC00645                                                 08032000
@RC00783 EQU   @RC00645                                                 08033000
@RC01134 EQU   @EL00007                                                 08034000
@RC01159 EQU   @EL00008                                                 08035000
@PB00008 EQU   @EL00006                                                 08036000
@RC01249 EQU   @EL00010                                                 08037000
@RC01281 EQU   @EL00012                                                 08038000
@RC01286 EQU   @EL00013                                                 08039000
@RC00685 EQU   @RC00684                                                 08040000
@RC00770 EQU   @RC00769                                                 08041000
@PB00007 EQU   @PB00008                                                 08042000
@RC01100 EQU   @PB00007                                                 08043000
@ENDDATA EQU   *                                                        08044000
         END   IAPCNTRL,(C'PLS1733',0701,77308)                         08045000
./  ADD  SSI=73080185,NAME=IAPPFXAP
         TITLE 'IAPPFXAP - AP-1 PAGE FIX APPENDAGE                     *00001000
                        '                                               00002000
IAPPFXAP CSECT ,                                                01S0001 00003000
@PROLOG  DS    0H                                               01S0002 00004000
           B   0(GPR14P)                                                00005000
*                                                               01S0050 00006000
           USING  IAPPFXAP,GPR15P                                       00007000
*   /*****************************************************************/ 00008000
*   /*                                                               */ 00009000
*   /* BUILD FIX LIST FOR AP1BLOCK                                   */ 00010000
*   /*                                                               */ 00011000
*   /*****************************************************************/ 00012000
*                                                               01S0051 00013000
*   PFXSTART=IOBAP1PT;              /* FIRST BYTE TO BE FIXED        */ 00014000
         L     @09,IOBAP1PT(,GPR02P)                            01S0051 00015000
         ST    @09,PFXSTART(,GPR10P)                            01S0051 00016000
*   PFXEND=IOBAP1PT+LENGTH(AP1BLOCK);/* LAST BYTE TO BE FIXED PLUS      00017000
*                                      ONE                           */ 00018000
         AL    @09,@CF00475                                     01S0052 00019000
         ST    @09,PFXEND(,GPR10P)                              01S0052 00020000
*   GPR11F=1;                       /* ONE ENTRY                     */ 00021000
*                                                               01S0053 00022000
         LA    GPR11F,1                                         01S0053 00023000
*   /*****************************************************************/ 00024000
*   /*                                                               */ 00025000
*   /* EPILOG                                                        */ 00026000
*   /*                                                               */ 00027000
*   /*****************************************************************/ 00028000
*                                                               01S0054 00029000
*   RFY                                                         01S0054 00030000
*     GPR09P RSTD;                                              01S0054 00031000
*   GPR09P=0;                       /* RESTORE REG 9                 */ 00032000
         SLR   GPR09P,GPR09P                                    01S0055 00033000
*   GEN(  BR  GPR14P  );            /* RETURN                        */ 00034000
           BR  GPR14P                                                   00035000
*   GEN DATA DEFS(PATCH);                                       01S0057 00036000
*   END                             /* OF IAPPFXAP PROC              */ 00037000
*                                                               01S0058 00038000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00039000
*/*%INCLUDE SYSLIB  (AP1BLOCK)                                       */ 00040000
*/*%INCLUDE SYSLIB  (IEZIOB  )                                       */ 00041000
*                                                               01S0058 00042000
*       ;                                                       01S0058 00043000
@EL00001 DS    0H                                               01S0058 00044000
@EF00001 DS    0H                                               01S0058 00045000
@ER00001 BR    @14                                              01S0058 00046000
@DATA    DS    0H                                                       00047000
@DATD    DSECT                                                          00048000
         DS    0F                                                       00049000
IAPPFXAP CSECT                                                          00050000
         DS    0F                                                       00051000
@CF00475 DC    F'360'                                                   00052000
@DATD    DSECT                                                          00053000
         DS    0D                                                       00054000
IAPPFXAP CSECT                                                          00055000
         NOPR  ((@ENDDATD-@DATD)*16)                                    00056000
         DS    0F                                                       00057000
@SIZDATD DC    AL1(0)                                                   00058000
         DC    AL3(@ENDDATD-@DATD)                                      00059000
         DS    0D                                                       00060000
IAPPFXAP CSECT                                                          00061000
*                                /*  PATCH AREA  */                     00062000
PATCH    DC    13F'0'            THIRTEEN WORD PATCH AREA               00063000
@DATD    DSECT                                                          00064000
@ENDDATD EQU   *                                                        00065000
IAPPFXAP CSECT                                                          00066000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00067000
@01      EQU   01                                                       00068000
@02      EQU   02                                                       00069000
@03      EQU   03                                                       00070000
@04      EQU   04                                                       00071000
@05      EQU   05                                                       00072000
@06      EQU   06                                                       00073000
@07      EQU   07                                                       00074000
@08      EQU   08                                                       00075000
@09      EQU   09                                                       00076000
@10      EQU   10                                                       00077000
@11      EQU   11                                                       00078000
@12      EQU   12                                                       00079000
@13      EQU   13                                                       00080000
@14      EQU   14                                                       00081000
@15      EQU   15                                                       00082000
GPR02P   EQU   @02                                                      00083000
GPR00P   EQU   @00                                                      00084000
GPR01P   EQU   @01                                                      00085000
GPR03P   EQU   @03                                                      00086000
GPR04P   EQU   @04                                                      00087000
GPR05P   EQU   @05                                                      00088000
GPR06P   EQU   @06                                                      00089000
GPR07P   EQU   @07                                                      00090000
GPR08P   EQU   @08                                                      00091000
GPR09P   EQU   @09                                                      00092000
GPR12P   EQU   @12                                                      00093000
GPR14P   EQU   @14                                                      00094000
GPR15P   EQU   @15                                                      00095000
GPR10P   EQU   @10                                                      00096000
GPR11F   EQU   @11                                                      00097000
GPR00F   EQU   @00                                                      00098000
GPR10F   EQU   @10                                                      00099000
GPR11P   EQU   @11                                                      00100000
GPR12F   EQU   @12                                                      00101000
GPR13P   EQU   @13                                                      00102000
AP1BLOCK EQU   0                                                        00103000
AP1PRINT EQU   AP1BLOCK+8                                               00104000
AP1PFLG1 EQU   AP1BLOCK+144                                             00105000
AP1CCWA  EQU   AP1BLOCK+160                                             00106000
AP1BUFAD EQU   AP1BLOCK+164                                             00107000
AP1TIMFL EQU   AP1BLOCK+176                                             00108000
AP1TIMFA EQU   AP1TIMFL                                                 00109000
AP1SEEK  EQU   AP1BLOCK+213                                             00110000
CCHHR    EQU   AP1SEEK+3                                                00111000
CCHH     EQU   CCHHR                                                    00112000
HH       EQU   CCHH+2                                                   00113000
AP1CESK  EQU   AP1BLOCK+221                                             00114000
CECCHHR  EQU   AP1CESK+2                                                00115000
CECCHH   EQU   CECCHHR                                                  00116000
AP1FLG2  EQU   AP1BLOCK+244                                             00117000
AP1FLG3  EQU   AP1BLOCK+245                                             00118000
AP1FLG4  EQU   AP1BLOCK+246                                             00119000
IOBPREFX EQU   0                                                        00120000
IOBCFLG1 EQU   IOBPREFX                                                 00121000
IOBSTDRD EQU   0                                                        00122000
IOBFLAG1 EQU   IOBSTDRD                                                 00123000
IOBCYCCK EQU   IOBFLAG1                                                 00124000
IOBRSTRT EQU   IOBFLAG1                                                 00125000
IOBFLAG2 EQU   IOBSTDRD+1                                               00126000
IOBPURGE EQU   IOBFLAG2                                                 00127000
IOBRDHA0 EQU   IOBFLAG2                                                 00128000
IOBSENS0 EQU   IOBSTDRD+2                                               00129000
IOBS0B7  EQU   IOBSENS0                                                 00130000
IOBSENS1 EQU   IOBSTDRD+3                                               00131000
IOBECBPT EQU   IOBSTDRD+4                                               00132000
IOBFLAG3 EQU   IOBSTDRD+8                                               00133000
IOBFL3   EQU   IOBFLAG3                                                 00134000
IOBCNC   EQU   IOBFL3                                                   00135000
IOBICL   EQU   IOBFL3                                                   00136000
IOBCSW   EQU   IOBSTDRD+9                                               00137000
IOBIOCSW EQU   IOBCSW                                                   00138000
IOBSTBYT EQU   IOBIOCSW+3                                               00139000
IOBUSTAT EQU   IOBSTBYT                                                 00140000
IOBCSTAT EQU   IOBSTBYT+1                                               00141000
IOBSTART EQU   IOBSTDRD+16                                              00142000
IOBDCBPT EQU   IOBSTDRD+20                                              00143000
IOBFLAG4 EQU   IOBDCBPT                                                 00144000
IOBRESTR EQU   IOBSTDRD+24                                              00145000
IOBINCAM EQU   IOBSTDRD+28                                              00146000
IOBBTAMF EQU   IOBINCAM                                                 00147000
PFXLIST  EQU   0                                                        00148000
PFXSTART EQU   PFXLIST                                                  00149000
PFXEND   EQU   PFXLIST+4                                                00150000
IOBEXTEN EQU   IOBSTDRD+32                                              00151000
IOBSEEK  EQU   IOBEXTEN                                                 00152000
IOBBB    EQU   IOBSEEK+1                                                00153000
IOBCC    EQU   IOBSEEK+3                                                00154000
IOBHH    EQU   IOBSEEK+5                                                00155000
IOBAP1PT EQU   IOBSEEK+8                                                00156000
IOBORG01 EQU   IOBPREFX+8                                               00157000
IOBNIOBA EQU   IOBORG01                                                 00158000
IOBNFLG1 EQU   IOBNIOBA                                                 00159000
IOBPRTOV EQU   IOBNFLG1                                                 00160000
IOBORG02 EQU   IOBPREFX+8                                               00161000
IOBDQADA EQU   IOBORG02                                                 00162000
IOBDEQIN EQU   IOBDQADA                                                 00163000
IOBORG03 EQU   IOBPREFX+12                                              00164000
IOBORG04 EQU   IOBINCAM                                                 00165000
IOBORG12 EQU   IOBINCAM                                                 00166000
IOBFL4   EQU   IOBORG12                                                 00167000
IOBORG05 EQU   IOBEXTEN                                                 00168000
IOBORG06 EQU   IOBEXTEN                                                 00169000
IOBNXTPT EQU   IOBORG06+4                                               00170000
IOBSTATA EQU   IOBNXTPT                                                 00171000
IOBORG07 EQU   IOBEXTEN+8                                               00172000
W1IEXTEN EQU   IOBORG07                                                 00173000
IOBORG08 EQU   IOBEXTEN+8                                               00174000
IOBINDCT EQU   IOBORG08+4                                               00175000
IOBUNSQR EQU   IOBORG08+5                                               00176000
IOBFCHAD EQU   IOBORG08+8                                               00177000
IOBORG09 EQU   IOBEXTEN+8                                               00178000
IOBDPLAD EQU   IOBORG09+4                                               00179000
IOBDTYPE EQU   IOBORG09+8                                               00180000
IOBDTYP2 EQU   IOBORG09+9                                               00181000
IOBDSTAT EQU   IOBORG09+10                                              00182000
IOBSTAT1 EQU   IOBDSTAT                                                 00183000
IOBORG10 EQU   IOBEXTEN+8                                               00184000
IOBSEEK2 EQU   IOBORG10                                                 00185000
IOBORG11 EQU   IOBEXTEN                                                 00186000
IOBERCT  EQU   IOBORG11                                                 00187000
IOBUCBXV EQU   IOBERCT                                                  00188000
IOBNAME  EQU   IOBORG11+4                                               00189000
IOBORG13 EQU   IOBEXTEN                                                 00190000
IOBSKADR EQU   IOBORG13                                                 00191000
HHR      EQU   HH                                                       00192000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00193000
IOBSKSS  EQU   IOBSKADR+3                                               00194000
IOBSK0   EQU   IOBSKADR+2                                               00195000
IOBSKTT  EQU   IOBSKADR+1                                               00196000
IOBSKRV  EQU   IOBSKADR                                                 00197000
IOBCSWSV EQU   IOBORG11+17                                              00198000
IOBSENSV EQU   IOBORG11+16                                              00199000
IOBRCD   EQU   IOBORG11+12                                              00200000
IOBMDREC EQU   IOBORG11+8                                               00201000
IOBNAMEA EQU   IOBNAME+1                                                00202000
IOBNAMSZ EQU   IOBNAME                                                  00203000
IOBERCTA EQU   IOBERCT+1                                                00204000
IOBRTYPE EQU   IOBUCBXV                                                 00205000
IOBRDCHP EQU   IOBORG10+20                                              00206000
IOBNEXTA EQU   IOBORG10+16                                              00207000
IOBREADA EQU   IOBORG10+12                                              00208000
IOBBUFC  EQU   IOBORG10+8                                               00209000
IOBSK2R  EQU   IOBSEEK2+7                                               00210000
IOBSK2HH EQU   IOBSEEK2+5                                               00211000
IOBSK2CC EQU   IOBSEEK2+3                                               00212000
IOBSK2BB EQU   IOBSEEK2+1                                               00213000
IOBSK2M  EQU   IOBSEEK2                                                 00214000
IOBCHNPR EQU   IOBORG09+40                                              00215000
IOBDNCRF EQU   IOBORG09+32                                              00216000
IOBRSV35 EQU   IOBORG09+24                                              00217000
IOBDQPTR EQU   IOBORG09+20                                              00218000
IOBRSV34 EQU   IOBORG09+18                                              00219000
IOBDBYTN EQU   IOBORG09+16                                              00220000
IOBDCPND EQU   IOBORG09+12                                              00221000
IOBSTAT2 EQU   IOBDSTAT+1                                               00222000
IOBSIORT EQU   IOBSTAT1                                                 00223000
IOBADDVU EQU   IOBSTAT1                                                 00224000
IOBBUFF  EQU   IOBSTAT1                                                 00225000
IOBENQUE EQU   IOBSTAT1                                                 00226000
IOBPASS2 EQU   IOBSTAT1                                                 00227000
IOBSYNCH EQU   IOBSTAT1                                                 00228000
IOBNEWVL EQU   IOBSTAT1                                                 00229000
IOBABNRM EQU   IOBSTAT1                                                 00230000
IOBRELEX EQU   IOBDTYP2                                                 00231000
IOBADDTY EQU   IOBDTYP2                                                 00232000
IOBTYPE  EQU   IOBDTYP2                                                 00233000
IOBRQUST EQU   IOBDTYP2                                                 00234000
IOBSUFFX EQU   IOBDTYP2                                                 00235000
IOBSBLKL EQU   IOBDTYP2                                                 00236000
IOBSKEY  EQU   IOBDTYP2                                                 00237000
IOBRELBL EQU   IOBDTYPE                                                 00238000
IOBRDEXC EQU   IOBDTYPE                                                 00239000
IOBDYNBF EQU   IOBDTYPE                                                 00240000
IOBACTAD EQU   IOBDTYPE                                                 00241000
IOBFDBCK EQU   IOBDTYPE                                                 00242000
IOBEXTSC EQU   IOBDTYPE                                                 00243000
IOBOVFLO EQU   IOBDTYPE                                                 00244000
IOBVERFY EQU   IOBDTYPE                                                 00245000
IOBDPLB  EQU   IOBDPLAD+1                                               00246000
IOBDAYLI EQU   IOBDPLAD                                                 00247000
IOBDIOBS EQU   IOBORG09+2                                               00248000
IOBDBYTR EQU   IOBORG09                                                 00249000
IOBBCHAD EQU   IOBORG08+12                                              00250000
IOBFCHNB EQU   IOBFCHAD+1                                               00251000
IOBCOUNT EQU   IOBFCHAD                                                 00252000
IOBASYN  EQU   IOBORG08+7                                               00253000
IOBAPP   EQU   IOBORG08+6                                               00254000
IOBRSV32 EQU   IOBUNSQR                                                 00255000
IOBRSV31 EQU   IOBUNSQR                                                 00256000
IOBRSV30 EQU   IOBUNSQR                                                 00257000
IOBKNRWR EQU   IOBUNSQR                                                 00258000
IOBKNWR  EQU   IOBUNSQR                                                 00259000
IOBNTAV2 EQU   IOBUNSQR                                                 00260000
IOBNTAV1 EQU   IOBUNSQR                                                 00261000
IOBCPBSY EQU   IOBUNSQR                                                 00262000
IOBCHNNL EQU   IOBINDCT                                                 00263000
IOBRSV29 EQU   IOBINDCT                                                 00264000
IOBRSV28 EQU   IOBINDCT                                                 00265000
IOBRSV27 EQU   IOBINDCT                                                 00266000
IOBKEYAD EQU   IOBINDCT                                                 00267000
IOBOVPTR EQU   IOBINDCT                                                 00268000
IOBUNSCH EQU   IOBINDCT                                                 00269000
IOBDEQCP EQU   IOBINDCT                                                 00270000
IOBCCWAD EQU   IOBORG08                                                 00271000
W1OEXTEN EQU   W1IEXTEN                                                 00272000
IOBCCW   EQU   IOBORG06+8                                               00273000
IOBNXTPB EQU   IOBNXTPT+1                                               00274000
IOBRSV26 EQU   IOBSTATA                                                 00275000
IOBRSV25 EQU   IOBSTATA                                                 00276000
IOBRSV24 EQU   IOBSTATA                                                 00277000
IOBRSV23 EQU   IOBSTATA                                                 00278000
IOBRSV22 EQU   IOBSTATA                                                 00279000
IOBRSV21 EQU   IOBSTATA                                                 00280000
IOBRSV20 EQU   IOBSTATA                                                 00281000
IOBAVLFL EQU   IOBSTATA                                                 00282000
IOBRSV37 EQU   IOBORG06+1                                               00283000
IOBUCBXG EQU   IOBORG06                                                 00284000
IOBCPA   EQU   IOBORG05+32                                              00285000
IOBERINF EQU   IOBORG05+16                                              00286000
IOBERCCW EQU   IOBORG05+8                                               00287000
IOBSNDPT EQU   IOBORG05+7                                               00288000
IOBRCVPT EQU   IOBORG05+6                                               00289000
IOBWORK  EQU   IOBORG05+1                                               00290000
IOBUCBX  EQU   IOBORG05                                                 00291000
IOBRSV46 EQU   IOBFL4                                                   00292000
IOBRSV47 EQU   IOBFL4                                                   00293000
IOBENT   EQU   IOBFL4                                                   00294000
IOBEQP   EQU   IOBFL4                                                   00295000
IOBBUS   EQU   IOBFL4                                                   00296000
IOBDCK   EQU   IOBFL4                                                   00297000
IOBREJ   EQU   IOBFL4                                                   00298000
IOBOVR   EQU   IOBFL4                                                   00299000
IOBCRILC EQU   IOBORG04+1                                               00300000
IOBCRDCC EQU   IOBORG04                                                 00301000
IOBGQECB EQU   IOBORG03                                                 00302000
IOBSWAP  EQU   IOBORG02+4                                               00303000
IOBDQADB EQU   IOBDQADA+1                                               00304000
IOBRSV13 EQU   IOBDEQIN                                                 00305000
IOBRSV12 EQU   IOBDEQIN                                                 00306000
IOBRSV11 EQU   IOBDEQIN                                                 00307000
IOBRSV10 EQU   IOBDEQIN                                                 00308000
IOBRSV09 EQU   IOBDEQIN                                                 00309000
IOBRSV08 EQU   IOBDEQIN                                                 00310000
IOBRSV07 EQU   IOBDEQIN                                                 00311000
IOBDEQ   EQU   IOBDEQIN                                                 00312000
IOBNECB  EQU   IOBORG01+4                                               00313000
IOBNIOBB EQU   IOBNIOBA+1                                               00314000
IOBFIRST EQU   IOBNFLG1                                                 00315000
IOBUPERR EQU   IOBNFLG1                                                 00316000
IOBSPAN  EQU   IOBNFLG1                                                 00317000
IOBBKSPC EQU   IOBNFLG1                                                 00318000
IOBUPDAT EQU   IOBNFLG1                                                 00319000
IOBREAD  EQU   IOBNFLG1                                                 00320000
IOBWRITE EQU   IOBNFLG1                                                 00321000
IOBSEGMT EQU   IOBPRTOV                                                 00322000
IOBR     EQU   IOBSEEK+7                                                00323000
IOBHH2   EQU   IOBHH+1                                                  00324000
IOBHH1   EQU   IOBHH                                                    00325000
IOBCC2   EQU   IOBCC+1                                                  00326000
IOBCC1   EQU   IOBCC                                                    00327000
IOBBB2   EQU   IOBBB+1                                                  00328000
IOBBB1   EQU   IOBBB                                                    00329000
IOBM     EQU   IOBSEEK                                                  00330000
IOBERRCT EQU   IOBSTDRD+30                                              00331000
IOBRSV19 EQU   IOBINCAM+1                                               00332000
IOBOLTST EQU   IOBBTAMF                                                 00333000
IOBRFTMG EQU   IOBBTAMF                                                 00334000
IOBRSV17 EQU   IOBBTAMF                                                 00335000
IOBRSV16 EQU   IOBBTAMF                                                 00336000
IOBRSV15 EQU   IOBBTAMF                                                 00337000
IOBRSV14 EQU   IOBBTAMF                                                 00338000
IOBINUSE EQU   IOBBTAMF                                                 00339000
IOBPRMER EQU   IOBBTAMF                                                 00340000
IOBRSTRB EQU   IOBRESTR+1                                               00341000
IOBREPOS EQU   IOBRESTR                                                 00342000
IOBDCBPB EQU   IOBDCBPT+1                                               00343000
IOBRSV44 EQU   IOBFLAG4                                                 00344000
IOBJES3I EQU   IOBFLAG4                                                 00345000
IOBRSV42 EQU   IOBFLAG4                                                 00346000
IOBRSV41 EQU   IOBFLAG4                                                 00347000
IOBRSV40 EQU   IOBFLAG4                                                 00348000
IOBPMERR EQU   IOBFLAG4                                                 00349000
IOBCC3WE EQU   IOBFLAG4                                                 00350000
IOBGDPOL EQU   IOBFLAG4                                                 00351000
IOBSTRTB EQU   IOBSTART+1                                               00352000
IOBSIOCC EQU   IOBSTART                                                 00353000
IOBCSB7  EQU   IOBCSTAT                                                 00354000
IOBCSB6  EQU   IOBCSTAT                                                 00355000
IOBCSB5  EQU   IOBCSTAT                                                 00356000
IOBCSB4  EQU   IOBCSTAT                                                 00357000
IOBCSB3  EQU   IOBCSTAT                                                 00358000
IOBCSB2  EQU   IOBCSTAT                                                 00359000
IOBCSB1  EQU   IOBCSTAT                                                 00360000
IOBCSB0  EQU   IOBCSTAT                                                 00361000
IOBUSB7  EQU   IOBUSTAT                                                 00362000
IOBUSB6  EQU   IOBUSTAT                                                 00363000
IOBUSB5  EQU   IOBUSTAT                                                 00364000
IOBUSB4  EQU   IOBUSTAT                                                 00365000
IOBUSB3  EQU   IOBUSTAT                                                 00366000
IOBUSB2  EQU   IOBUSTAT                                                 00367000
IOBUSB1  EQU   IOBUSTAT                                                 00368000
IOBUSB0  EQU   IOBUSTAT                                                 00369000
IOBCMDA  EQU   IOBIOCSW                                                 00370000
IOBLOG   EQU   IOBFL3                                                   00371000
IOBJAM   EQU   IOBICL                                                   00372000
IOBMSG   EQU   IOBFL3                                                   00373000
IOBSDR   EQU   IOBCNC                                                   00374000
IOBACU   EQU   IOBFL3                                                   00375000
IOBCDC   EQU   IOBFL3                                                   00376000
IOBICC   EQU   IOBFL3                                                   00377000
IOBCCC   EQU   IOBFL3                                                   00378000
IOBECBPB EQU   IOBECBPT+1                                               00379000
IOBECBCC EQU   IOBECBPT                                                 00380000
IOBS1B7  EQU   IOBSENS1                                                 00381000
IOBS1B6  EQU   IOBSENS1                                                 00382000
IOBS1B5  EQU   IOBSENS1                                                 00383000
IOBS1B4  EQU   IOBSENS1                                                 00384000
IOBS1B3  EQU   IOBSENS1                                                 00385000
IOBS1B2  EQU   IOBSENS1                                                 00386000
IOBS1B1  EQU   IOBSENS1                                                 00387000
IOBS1B0  EQU   IOBSENS1                                                 00388000
IOBSNSC9 EQU   IOBS0B7                                                  00389000
IOBS0B6  EQU   IOBSENS0                                                 00390000
IOBS0B5  EQU   IOBSENS0                                                 00391000
IOBS0B4  EQU   IOBSENS0                                                 00392000
IOBS0B3  EQU   IOBSENS0                                                 00393000
IOBS0B2  EQU   IOBSENS0                                                 00394000
IOBS0B1  EQU   IOBSENS0                                                 00395000
IOBS0B0  EQU   IOBSENS0                                                 00396000
IOBPNCH  EQU   IOBFLAG2                                                 00397000
IOBSTATO EQU   IOBFLAG2                                                 00398000
IOBSKUPD EQU   IOBFLAG2                                                 00399000
IOBALTTR EQU   IOBFLAG2                                                 00400000
IOBRRT2  EQU   IOBRDHA0                                                 00401000
IOBRRT3  EQU   IOBPURGE                                                 00402000
IOBSENSE EQU   IOBFLAG2                                                 00403000
IOBHALT  EQU   IOBFLAG2                                                 00404000
IOBSPSVC EQU   IOBRSTRT                                                 00405000
IOBUNREL EQU   IOBFLAG1                                                 00406000
IOBIOERR EQU   IOBFLAG1                                                 00407000
IOBFCREX EQU   IOBCYCCK                                                 00408000
IOBRPSTN EQU   IOBFLAG1                                                 00409000
IOBERRTN EQU   IOBFLAG1                                                 00410000
IOBCMDCH EQU   IOBFLAG1                                                 00411000
IOBDATCH EQU   IOBFLAG1                                                 00412000
IOBCNOPA EQU   IOBPREFX+12                                              00413000
IOBCICB  EQU   IOBPREFX+8                                               00414000
IOBCECB  EQU   IOBPREFX+4                                               00415000
IOBCONOP EQU   IOBPREFX+3                                               00416000
IOBCINOP EQU   IOBPREFX+2                                               00417000
IOBRSV05 EQU   IOBPREFX+1                                               00418000
IOBPCI   EQU   IOBCFLG1                                                 00419000
IOBRSTCH EQU   IOBCFLG1                                                 00420000
IOBABAPP EQU   IOBCFLG1                                                 00421000
IOBPTST  EQU   IOBCFLG1                                                 00422000
IOBRSV04 EQU   IOBCFLG1                                                 00423000
IOBRSV03 EQU   IOBCFLG1                                                 00424000
IOBRSV02 EQU   IOBCFLG1                                                 00425000
IOBRSV01 EQU   IOBCFLG1                                                 00426000
AP1END   EQU   AP1BLOCK+360                                             00427000
AP1ERRTF EQU   AP1BLOCK+300                                             00428000
AP1ERRTM EQU   AP1BLOCK+270                                             00429000
AP1ENQAD EQU   AP1BLOCK+266                                             00430000
AP1DEVAD EQU   AP1BLOCK+262                                             00431000
AP1LSTHH EQU   AP1BLOCK+260                                             00432000
AP1LSTCC EQU   AP1BLOCK+258                                             00433000
AP1SKCNT EQU   AP1BLOCK+256                                             00434000
AP1ETABA EQU   AP1BLOCK+252                                             00435000
AP1RET   EQU   AP1BLOCK+251                                             00436000
AP1DEVTP EQU   AP1BLOCK+250                                             00437000
AP1TSTNO EQU   AP1BLOCK+249                                             00438000
AP1DCCNT EQU   AP1BLOCK+248                                             00439000
@NM00004 EQU   AP1BLOCK+247                                             00440000
AP1ENQD  EQU   AP1FLG4                                                  00441000
AP1DEBCH EQU   AP1FLG4                                                  00442000
AP1READ  EQU   AP1FLG4                                                  00443000
AP1NORD  EQU   AP1FLG4                                                  00444000
AP1RDERR EQU   AP1FLG3                                                  00445000
AP1RDTST EQU   AP1FLG3                                                  00446000
AP1VERIF EQU   AP1FLG3                                                  00447000
AP1QUIT  EQU   AP1FLG3                                                  00448000
AP1PRERR EQU   AP1FLG3                                                  00449000
AP1ERROR EQU   AP1FLG3                                                  00450000
AP1LST   EQU   AP1FLG3                                                  00451000
AP1PTRN2 EQU   AP1FLG3                                                  00452000
AP1NOERP EQU   AP1FLG2                                                  00453000
AP1FHF   EQU   AP1FLG2                                                  00454000
AP1EDP   EQU   AP1FLG2                                                  00455000
AP1IOC   EQU   AP1FLG2                                                  00456000
AP1NOWR  EQU   AP1FLG2                                                  00457000
AP1IOECB EQU   AP1BLOCK+240                                             00458000
AP1IOBA  EQU   AP1BLOCK+236                                             00459000
AP1DEBA  EQU   AP1BLOCK+232                                             00460000
AP1DCBA  EQU   AP1BLOCK+228                                             00461000
CER      EQU   CECCHHR+4                                                00462000
CEHH     EQU   CECCHH+2                                                 00463000
CECC     EQU   CECCHH                                                   00464000
CEBB     EQU   AP1CESK                                                  00465000
R        EQU   CCHHR+4                                                  00466000
CC       EQU   CCHH                                                     00467000
BB       EQU   AP1SEEK+1                                                00468000
M        EQU   AP1SEEK                                                  00469000
AP1FM    EQU   AP1BLOCK+212                                             00470000
AP1SNS   EQU   AP1BLOCK+188                                             00471000
AP1CSW   EQU   AP1BLOCK+181                                             00472000
AP1PCODE EQU   AP1BLOCK+180                                             00473000
AP1TIMIN EQU   AP1TIMFA                                                 00474000
AP1IOACT EQU   AP1TIMFA                                                 00475000
AP1TCBAD EQU   AP1BLOCK+172                                             00476000
AP1TIMEA EQU   AP1BLOCK+168                                             00477000
AP1BUFAB EQU   AP1BUFAD+1                                               00478000
@NM00003 EQU   AP1BUFAD                                                 00479000
AP1CCWAB EQU   AP1CCWA+1                                                00480000
@NM00002 EQU   AP1CCWA                                                  00481000
AP1WRKA  EQU   AP1BLOCK+156                                             00482000
AP1RECB  EQU   AP1BLOCK+152                                             00483000
@NM00001 EQU   AP1BLOCK+150                                             00484000
AP1CNRPL EQU   AP1BLOCK+146                                             00485000
AP1CNCOD EQU   AP1BLOCK+145                                             00486000
AP1PRCLS EQU   AP1PFLG1                                                 00487000
AP1PRNP  EQU   AP1PFLG1                                                 00488000
AP1PROPN EQU   AP1PFLG1                                                 00489000
AP1PRLIN EQU   AP1BLOCK+142                                             00490000
AP1PRPAG EQU   AP1BLOCK+140                                             00491000
AP1PRCOD EQU   AP1BLOCK+139                                             00492000
AP1PRMSG EQU   AP1PRINT+1                                               00493000
AP1PRASA EQU   AP1PRINT                                                 00494000
AP1PDCBA EQU   AP1BLOCK+4                                               00495000
AP1HDR   EQU   AP1BLOCK                                                 00496000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00497000
@ENDDATA EQU   *                                                        00498000
         END   IAPPFXAP,(C'PLS1801',0701,77308)                         00499000
./  ADD  SSI=73080186,NAME=IAPTIMER
         TITLE 'IAPTIMER - AP-1 TIMER SUBTASK                          *00001000
                        '                                               00002000
IAPTIMER CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(16)                                          01S0001 00007000
         DC    C'IAPTIMER  77.308'                              01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @12,0                                            01S0001 00011000
@PSTART  DS    0H                                               01S0001 00012000
         USING @PSTART,@12                                      01S0001 00013000
         L     @00,@SIZDATD                                     01S0001 00014000
         GETMAIN  R,LV=(0)                                              00015000
         LR    @11,@01                                          01S0001 00016000
         USING @DATD,@11                                        01S0001 00017000
         ST    @13,@SA00001+4                                   01S0001 00018000
         LM    @00,@01,20(@13)                                  01S0001 00019000
         ST    @11,8(,@13)                                      01S0001 00020000
         LR    @13,@11                                          01S0001 00021000
         MVC   @PC00001(4),0(@01)                               01S0001 00022000
         EJECT                                                          00023000
*                                                               01S0015 00024000
*   /*****************************************************************/ 00025000
*   /*                                                               */ 00026000
*   /* SET UP AP1REG                                                 */ 00027000
*   /*                                                               */ 00028000
*   /*****************************************************************/ 00029000
*                                                               01S0015 00030000
*   AP1REG=ADDR(AP1BLK);            /* ADDRESS OF AP1BLOCK AS PASSED    00031000
*                                      BY IAPCNTRL                   */ 00032000
*                                                               01S0015 00033000
         L     AP1REG,@PC00001                                  01S0015 00034000
*   /*****************************************************************/ 00035000
*   /*                                                               */ 00036000
*   /* LOOP TO CHECK FOR TIMEOUT                                     */ 00037000
*   /*                                                               */ 00038000
*   /*****************************************************************/ 00039000
*                                                               01S0016 00040000
*   DO COUNTER=1 BY 1;              /* INFINITE LOOP                 */ 00041000
*                                                               01S0016 00042000
         LA    COUNTER,1                                        01S0016 00043000
@DL00016 DS    0H                                               01S0017 00044000
*     /***************************************************************/ 00045000
*     /*                                                             */ 00046000
*     /* STIMER FOR INTERVAL                                         */ 00047000
*     /*                                                             */ 00048000
*     /***************************************************************/ 00049000
*                                                               01S0017 00050000
*     GENERATE REFS(TIMEINTV);                                  01S0017 00051000
*                                                               01S0017 00052000
         STIMER WAIT,DINTVL=TIMEINTV  TIME FOR INTERVAL--WAIT           00053000
*     /***************************************************************/ 00054000
*     /*                                                             */ 00055000
*     /* SEE IF I/O HAS TIMED OUT                                    */ 00056000
*     /*                                                             */ 00057000
*     /***************************************************************/ 00058000
*                                                               01S0018 00059000
*     IF AP1TIMIN=ON THEN           /* I/O HASENT RESPONDED          */ 00060000
         TM    AP1TIMIN(AP1REG),B'01000000'                     01S0018 00061000
         BNO   @RF00018                                         01S0018 00062000
*       DO;                                                     01S0019 00063000
*                                                               01S0019 00064000
*         /***********************************************************/ 00065000
*         /*                                                         */ 00066000
*         /* PURGE I/O                                               */ 00067000
*         /*                                                         */ 00068000
*         /***********************************************************/ 00069000
*                                                               01S0020 00070000
*         PRGOPT=PRGOPTS;           /* SET OPTION FLAGS              */ 00071000
         MVC   PRGOPT(1),PRGOPTS                                01S0020 00072000
*         PRGDEB=AP1DEBA;           /* OUR DEB                       */ 00073000
         MVC   PRGDEB(3),AP1DEBA+1(AP1REG)                      01S0021 00074000
*         PRGCOD=0;                 /* CLEAR COMP CODE               */ 00075000
         MVI   PRGCOD,X'00'                                     01S0022 00076000
*         PRGTCB=AP1TCBAD;          /* MAIN TASK TCB                 */ 00077000
         MVC   PRGTCB(3),AP1TCBAD+1(AP1REG)                     01S0023 00078000
*         PRGRES=0;                 /* RESERVED                      */ 00079000
         MVI   PRGRES,X'00'                                     01S0024 00080000
*         PRGANCR=0;                /* ZERO ANCHOR                   */ 00081000
         SLR   @10,@10                                          01S0025 00082000
         ST    @10,PRGANCR                                      01S0025 00083000
*         PRGPIRL=ADDR(PRGANCR);    /* POINT TO ANCHOR               */ 00084000
         LA    @10,PRGANCR                                      01S0026 00085000
         STCM  @10,7,PRGPIRL                                    01S0026 00086000
*         RFY                                                   01S0027 00087000
*           GPR01P RSTD;                                        01S0027 00088000
*         GPR01P=ADDR(PPL);         /* ADDRESS OF PPL                */ 00089000
         LA    GPR01P,PPL                                       01S0028 00090000
*         GENERATE;                                             01S0029 00091000
         PURGE  (GPR01P)         DO PURGE                               00092000
*         RFY                                                   01S0030 00093000
*           GPR01P UNRSTD;                                      01S0030 00094000
*       END;                                                    01S0031 00095000
*     ELSE                                                      01S0032 00096000
*       ;                           /* I/O HAS RESPONDED             */ 00097000
*                                                               01S0032 00098000
@RF00018 DS    0H                                               01S0033 00099000
*     /***************************************************************/ 00100000
*     /*                                                             */ 00101000
*     /* SET AP1TIMIN ON IF AP1IOACT IS ON                           */ 00102000
*     /*                                                             */ 00103000
*     /***************************************************************/ 00104000
*                                                               01S0033 00105000
*     DO;                                                       01S0033 00106000
*       CSOP1=AP1TIMFL;             /* INIT CS OPERAND               */ 00107000
         MVC   CSOP1(4),AP1TIMFL(AP1REG)                        01S0034 00108000
*       CSOP2=AP1TIMFL;             /* INIT CS OPERAND               */ 00109000
         MVC   CSOP2(4),AP1TIMFL(AP1REG)                        01S0035 00110000
*       CSPTR=ADDR(CSOP1)-ADDR(AP1TIMFL)+ADDR(AP1BLOCK);/* ADDRESS      00111000
*                                      CSOP1 AS IF IT WERE AP1TIMFL  */ 00112000
         LA    CSPTR,CSOP1                                      01S0036 00113000
         LA    @10,AP1TIMFL(,AP1REG)                            01S0036 00114000
         SLR   CSPTR,@10                                        01S0036 00115000
         ALR   CSPTR,AP1REG                                     01S0036 00116000
*       CSPTR->AP1IOACT=ON;         /* SET I/O ACTIVE ON             */ 00117000
*       CSPTR->AP1TIMIN=OFF;        /* SET TIMING OFF                */ 00118000
         OI    AP1IOACT(CSPTR),B'10000000'                      01S0038 00119000
         NI    AP1TIMIN(CSPTR),B'10111111'                      01S0038 00120000
*       CSPTR=ADDR(CSOP2)-ADDR(AP1TIMFL)+ADDR(AP1BLOCK);/* ADDRESS      00121000
*                                      CSOP2 AS IF IT WERE AP1TIMFL  */ 00122000
         LA    CSPTR,CSOP2                                      01S0039 00123000
         SLR   CSPTR,@10                                        01S0039 00124000
         ALR   CSPTR,AP1REG                                     01S0039 00125000
*       CSPTR->AP1IOACT=ON;         /* SET I/O ACTIVE ON             */ 00126000
*       CSPTR->AP1TIMIN=ON;         /* SET TIMING ON                 */ 00127000
*                                                               01S0041 00128000
         OI    AP1IOACT(CSPTR),B'11000000'                      01S0041 00129000
*       /*************************************************************/ 00130000
*       /*                                                           */ 00131000
*       /* THIS INSTRUCTION WILL TEST TO SEE IF IOACT IS ON, IF SO,  */ 00132000
*       /* SET TIMIN ON                                              */ 00133000
*       /*                                                           */ 00134000
*       /*************************************************************/ 00135000
*                                                               01S0042 00136000
*       CS(CSOP1,CSOP2,AP1TIMFL);   /* COMPARE AND SWAP              */ 00137000
         L     @10,CSOP1                                        01S0042 00138000
         L     @09,CSOP2                                        01S0042 00139000
         CS    @10,@09,AP1TIMFL(AP1REG)                         01S0042 00140000
         BZ    @BC00042                                         01S0042 00141000
         ST    @10,CSOP1                                        01S0042 00142000
@BC00042 DS    0H                                               01S0043 00143000
*     END;                                                      01S0043 00144000
*   END;                            /* OF DO WHILE                   */ 00145000
         AL    COUNTER,@CF00042                                 01S0044 00146000
         B     @DL00016                                         01S0044 00147000
*   GEN DATA DEFS(PATCH);                                       01S0045 00148000
*   END                             /* OF IAPTIMER PROC              */ 00149000
*                                                               01S0046 00150000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00151000
*/*%INCLUDE SYSLIB  (AP1BLOCK)                                       */ 00152000
*                                                               01S0046 00153000
*       ;                                                       01S0046 00154000
@EL00001 L     @13,4(,@13)                                      01S0046 00155000
@EF00001 L     @00,@SIZDATD                                     01S0046 00156000
         LR    @01,@11                                          01S0046 00157000
         FREEMAIN R,LV=(0),A=(1)                                        00158000
@ER00001 LM    @14,@12,12(@13)                                  01S0046 00159000
         BR    @14                                              01S0046 00160000
@DATA    DS    0H                                                       00161000
@DATD    DSECT                                                          00162000
         DS    0F                                                       00163000
@SA00001 DS    18F                                                      00164000
@PC00001 DS    1F                                                       00165000
IAPTIMER CSECT                                                          00166000
         DS    0F                                                       00167000
@CF00042 DC    F'1'                                                     00168000
@DATD    DSECT                                                          00169000
         DS    0D                                                       00170000
CSOP1    DS    CL4                                                      00171000
CSOP2    DS    CL4                                                      00172000
PPL      DS    CL16                                                     00173000
         ORG   PPL                                                      00174000
PRGOPT   DS    BL1                                                      00175000
PRGDEB   DS    AL3                                                      00176000
PRGCOD   DS    BL1                                                      00177000
PRGTCB   DS    AL3                                                      00178000
PRGRES   DS    BL1                                                      00179000
PRGPIRL  DS    AL3                                                      00180000
PRGANCR  DS    AL4                                                      00181000
         ORG   PPL+16                                                   00182000
IAPTIMER CSECT                                                          00183000
         DS    0F                                                       00184000
@SIZDATD DC    AL1(0)                                                   00185000
         DC    AL3(@ENDDATD-@DATD)                                      00186000
         DS    0D                                                       00187000
TIMEINTV DC    CL8'00010000'                                            00188000
PRGOPTS  DC    B'11100000'                                              00189000
IAPTIMER CSECT                                                          00190000
*                                /*  PATCH AREA  */                     00191000
PATCH    DC    13F'0'            THIRTEEN WORD PATCH AREA               00192000
@DATD    DSECT                                                          00193000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00194000
@ENDDATD EQU   *                                                        00195000
IAPTIMER CSECT                                                          00196000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00197000
@01      EQU   01                                                       00198000
@02      EQU   02                                                       00199000
@03      EQU   03                                                       00200000
@04      EQU   04                                                       00201000
@05      EQU   05                                                       00202000
@06      EQU   06                                                       00203000
@07      EQU   07                                                       00204000
@08      EQU   08                                                       00205000
@09      EQU   09                                                       00206000
@10      EQU   10                                                       00207000
@11      EQU   11                                                       00208000
@12      EQU   12                                                       00209000
@13      EQU   13                                                       00210000
@14      EQU   14                                                       00211000
@15      EQU   15                                                       00212000
COUNTER  EQU   @03                                                      00213000
CSPTR    EQU   @02                                                      00214000
AP1REG   EQU   @08                                                      00215000
GPR01P   EQU   @01                                                      00216000
AP1BLOCK EQU   0                                                        00217000
AP1PRINT EQU   AP1BLOCK+8                                               00218000
AP1PFLG1 EQU   AP1BLOCK+144                                             00219000
AP1CCWA  EQU   AP1BLOCK+160                                             00220000
AP1BUFAD EQU   AP1BLOCK+164                                             00221000
AP1TCBAD EQU   AP1BLOCK+172                                             00222000
AP1TIMFL EQU   AP1BLOCK+176                                             00223000
AP1TIMFA EQU   AP1TIMFL                                                 00224000
AP1IOACT EQU   AP1TIMFA                                                 00225000
AP1TIMIN EQU   AP1TIMFA                                                 00226000
AP1SEEK  EQU   AP1BLOCK+213                                             00227000
CCHHR    EQU   AP1SEEK+3                                                00228000
CCHH     EQU   CCHHR                                                    00229000
HH       EQU   CCHH+2                                                   00230000
AP1CESK  EQU   AP1BLOCK+221                                             00231000
CECCHHR  EQU   AP1CESK+2                                                00232000
CECCHH   EQU   CECCHHR                                                  00233000
AP1DEBA  EQU   AP1BLOCK+232                                             00234000
AP1FLG2  EQU   AP1BLOCK+244                                             00235000
AP1FLG3  EQU   AP1BLOCK+245                                             00236000
AP1FLG4  EQU   AP1BLOCK+246                                             00237000
AP1BLK   EQU   0                                                        00238000
HHR      EQU   HH                                                       00239000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00240000
AP1END   EQU   AP1BLOCK+360                                             00241000
AP1ERRTF EQU   AP1BLOCK+300                                             00242000
AP1ERRTM EQU   AP1BLOCK+270                                             00243000
AP1ENQAD EQU   AP1BLOCK+266                                             00244000
AP1DEVAD EQU   AP1BLOCK+262                                             00245000
AP1LSTHH EQU   AP1BLOCK+260                                             00246000
AP1LSTCC EQU   AP1BLOCK+258                                             00247000
AP1SKCNT EQU   AP1BLOCK+256                                             00248000
AP1ETABA EQU   AP1BLOCK+252                                             00249000
AP1RET   EQU   AP1BLOCK+251                                             00250000
AP1DEVTP EQU   AP1BLOCK+250                                             00251000
AP1TSTNO EQU   AP1BLOCK+249                                             00252000
AP1DCCNT EQU   AP1BLOCK+248                                             00253000
@NM00004 EQU   AP1BLOCK+247                                             00254000
AP1ENQD  EQU   AP1FLG4                                                  00255000
AP1DEBCH EQU   AP1FLG4                                                  00256000
AP1READ  EQU   AP1FLG4                                                  00257000
AP1NORD  EQU   AP1FLG4                                                  00258000
AP1RDERR EQU   AP1FLG3                                                  00259000
AP1RDTST EQU   AP1FLG3                                                  00260000
AP1VERIF EQU   AP1FLG3                                                  00261000
AP1QUIT  EQU   AP1FLG3                                                  00262000
AP1PRERR EQU   AP1FLG3                                                  00263000
AP1ERROR EQU   AP1FLG3                                                  00264000
AP1LST   EQU   AP1FLG3                                                  00265000
AP1PTRN2 EQU   AP1FLG3                                                  00266000
AP1NOERP EQU   AP1FLG2                                                  00267000
AP1FHF   EQU   AP1FLG2                                                  00268000
AP1EDP   EQU   AP1FLG2                                                  00269000
AP1IOC   EQU   AP1FLG2                                                  00270000
AP1NOWR  EQU   AP1FLG2                                                  00271000
AP1IOECB EQU   AP1BLOCK+240                                             00272000
AP1IOBA  EQU   AP1BLOCK+236                                             00273000
AP1DCBA  EQU   AP1BLOCK+228                                             00274000
CER      EQU   CECCHHR+4                                                00275000
CEHH     EQU   CECCHH+2                                                 00276000
CECC     EQU   CECCHH                                                   00277000
CEBB     EQU   AP1CESK                                                  00278000
R        EQU   CCHHR+4                                                  00279000
CC       EQU   CCHH                                                     00280000
BB       EQU   AP1SEEK+1                                                00281000
M        EQU   AP1SEEK                                                  00282000
AP1FM    EQU   AP1BLOCK+212                                             00283000
AP1SNS   EQU   AP1BLOCK+188                                             00284000
AP1CSW   EQU   AP1BLOCK+181                                             00285000
AP1PCODE EQU   AP1BLOCK+180                                             00286000
AP1TIMEA EQU   AP1BLOCK+168                                             00287000
AP1BUFAB EQU   AP1BUFAD+1                                               00288000
@NM00003 EQU   AP1BUFAD                                                 00289000
AP1CCWAB EQU   AP1CCWA+1                                                00290000
@NM00002 EQU   AP1CCWA                                                  00291000
AP1WRKA  EQU   AP1BLOCK+156                                             00292000
AP1RECB  EQU   AP1BLOCK+152                                             00293000
@NM00001 EQU   AP1BLOCK+150                                             00294000
AP1CNRPL EQU   AP1BLOCK+146                                             00295000
AP1CNCOD EQU   AP1BLOCK+145                                             00296000
AP1PRCLS EQU   AP1PFLG1                                                 00297000
AP1PRNP  EQU   AP1PFLG1                                                 00298000
AP1PROPN EQU   AP1PFLG1                                                 00299000
AP1PRLIN EQU   AP1BLOCK+142                                             00300000
AP1PRPAG EQU   AP1BLOCK+140                                             00301000
AP1PRCOD EQU   AP1BLOCK+139                                             00302000
AP1PRMSG EQU   AP1PRINT+1                                               00303000
AP1PRASA EQU   AP1PRINT                                                 00304000
AP1PDCBA EQU   AP1BLOCK+4                                               00305000
AP1HDR   EQU   AP1BLOCK                                                 00306000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00307000
@ENDDATA EQU   *                                                        00308000
         END   IAPTIMER,(C'PLS1807',0701,77308)                         00309000
