./  ADD  SSI=40441010,NAME=HEWAPT
         MACRO                                                          00050021
         HEWAPT &PARM                                                   00100021
         EJECT                                                          00150021
*********************************************************************** 00200021
*                                                                     * 00210000
*    10/02/73          LEVEL=06                                       * 00220002
*                                                                     * 00230000
*                                ------------                         * 00250021
*            CODE GENERATION FOR - 10/02/73 - HEWAPT MACRO FOLLOWS    * 00300002
*                                ------------                         * 00350021
*********************************************************************** 00400021
         AIF   ('&PARM' EQ 'A').CSECT                                   00450021
*** EQUATES FOR DSECT DEFINITIONS                                       00500021
HEWLKLED EQU  0                                                         00550021
HEWLCLDB EQU   0                                                        00600021
APTDSECT DSECT                                                          00650021
.CSECT   ANOP                                                           00700021
         DC    C'STARTAPT'                                              00710000
PDSE1    DS    CL8       MEMBER OR ALIAS NAME                           00750021
PDSE2    DS    CL3       RELATIVE DA OF FIRST RECORD-TTR                00800021
PDSE3    DS    CL1       C-BYTE                                         00850021
*INITIAL VALUE=0    BIT   0   ALIAS INDICATOR                           00900021
*INITIAL VALUE=0    BITS 1-2  NUMBER OF TTR'S IN USERS DATA             00950021
*INITIAL VALUE=0    BITS 3-7  LENGTH OF USERS DATA IN HALF WORDS        01000021
PDSE4    DS    CL4       RELATIVE DA OF FIRST TEXT RECORD TTR0          01050021
PDSE5    DS    CL3       RELATIVE DA OF NOTE LIST OR SCTR-XLATION TABLE 01100021
PDSE6    DS    CL1       L-BYTE-NUMBER OF TTR'S IF NOTE LIST PRESENT    01150021
*                                                                       01200021
PDSE7    DS    CL1       FIRST ATTRIBUTE BYTE                           01250021
*                                                                       01300021
*INITIAL VALUE=0    BIT 0     REENTERABLE                               01350021
*INITIAL VALUE=0    BIT 1     RESUABLE                                  01400021
*INITIAL VALUE=0    BIT 2     OVERLAY                                   01450021
*INITIAL VALUE=0    BIT 3     TEST                                      01500021
*INITIAL VALUE=0    BIT 4     ONLY LOADABLE                             01550021
*INITIAL VALUE=0    BIT 5     BLOCK-SCATTER                             01600021
*INITIAL VALUE=1    BIT 6     EXECUTABLE                                01650021
*INITIAL VALUE=0    BIT 7     MODULE CONTAINS 1 TEXT RECORD + NO RLD'S  01700021
*                                                                       01750021
PDSE8    DS    CL1       SECOND ATTRIBUTE BYTE                          01800021
*                                                                       01850021
*INITIAL VALUE=1    BIT 0     ON MEANS OUTPUT LOAD MOD NOT DC           01900021
*INITIAL VALUE=1    BIT 1     ORIGIN OF FIRST TEXT RECORD IS ZERO       01950021
*INITIAL VALUE=1    BIT 2     ENTRY POINT ASSIGN BY LINKAGE EDITOR IS 0 02000021
*INITIAL VALUE=1    BIT 3     MODULE CONTAINS NO RLD ITEMS              02050021
*INITIAL VALUE=0    BIT 4     MODULE CAN BE RE-PROCESSED BY LINKAGE ED. 02100021
*INITIAL VALUE=0    BIT 5     MODULE DOES NOT CONTAIN SYMBOL CARDS      02150021
*INITIAL VALUE=1    BIT 6     MODULE WAS CREATED BY LINK EDITOR F V2    02200021
*INITIAL VALUE=0    BIT 7     REFRESHABLE                               02250021
*                                                                       02300021
PDSE9    DS    CL3       TOTAL CONTIGUOUS MAIN STORAGE REQUIREMENTS OF  02350021
*                        THIS MODULE                                    02400021
PDSE10   DS    CL2       LENGTH OF FIRST TEXT RECORD                    02450021
PDSE11   DS    CL3       ENTRY POINT ADDRESS                            02500021
PDSE12   DS    CL3       EDITOR ASSIGN ORIGIN OF FIRST TEXT RECORD      02550021
PDSAPFLG EQU   X'08'     THIS BIT ON IN FIRST BYTE OF PDSE12     Y01048 02560000
*                        INDICATES AUTH CODE IN LAST 2 BYTES     Y01048 02570000
*                        OF PDS DIRECTORY                        Y01048 02580000
****                                                                    02600021
**** THE FOLLOWING 4 ITEMS ARE FOR SCATTER FORMAT ONLY                  02650021
****                                                                    02700021
PDSE13   DS    CL2       NUMBER OF BYTES IN SCATTER LIST                02750021
PDSE14   DS    CL2       NUMBER OF BYTES IN THE TRANSLATION TABLE       02800021
PDSE15   DS    CL2       ESDID OF THE FIRST TEXT RECORD                 02850021
PDSE16   DS    CL2       ESDID OF THE CONTROL SECTION CONTAINING THE    02900021
*                        ENTRY POINT                                    02950021
****                                                                    03000021
**** THE FOLLOWING TWO ITEMS ARE INCLUDED WHEN AN ALIAS NAME IS SPECIFI 03050021
**** ED AND EITHER THE REENTERABLE OR REUSABLE OPTION IS SPECIFIED      03100021
****                                                                    03150021
PDSE17   DS    CL3       ENTRY POINT OF MAIN MEMBER NAME                03200021
PDSE18   DS    CL8       MEMBER NAME OF MODULE                          03250021
****                                                                    03300021
**** THIS ENDS THE PARTITION DATA SET DIRECTORY                         03350021
****                                                                    03400021
         SPACE 2                                                        03450021
REGSA    DS    18F       18 FULL WORD SAVE AREA FOR DATA MANAGEMENT     03500021
IOCT     DS    6F        I/O CONTROL TABLE 4 BYTES PER ENTRY            03550021
*              ALSO USED AS STORAGE AREA BY HEWLFSCD AND HEWLFREL       03600021
*                                                                       03650021
APT0     DS    CL1       FIRST BYTE--ALL PURPOSE INDICATORS             03700021
*                                                                       03750021
*INITIAL VALUE=0    BIT 0     NCAL                                      03800021
*INITIAL VALUE=0    BIT 1     XREF                                      03850021
*INITIAL VALUE=0    BIT 2     MAP                                       03900021
*INITIAL VALUE=0    BIT 3     LET                                       03950021
*INITIAL VALUE=0    BIT 4     LOG                                       04000021
*INITIAL VALUE=0    BIT 5     XCAL                                      04050021
*INITIAL VALUE=0    BIT 6     TXT/RLD                                   04100021
*INITIAL VALUE=0   BIT 7     SOME LIBRARY CARD WAS READ                 04150021
*                                                                       04200021
APT1     DS    CL1       SECOND BYTE--ALL PURPOSE INDICATORS            04250021
*                                                                       04300021
*INITIAL VALUE=0    BIT 0     MORE INCLUDE TO COME                      04350021
*INITIAL VALUE=0    BIT 1     AUTO-LIB CALL IN OPERATION                04400021
*INITIAL VALUE=0    BIT 2     OBJECT OR LOAD MODULE                     04450021
*INITIAL VALUE=0    BIT 3     DELETE INDICATOR                          04500021
*INITIAL VALUE=0    BIT 4     ENTRY POINT RECEIVED                      04550021
*INITIAL VALUE=1    BIT 5     SYMBOLIC OR ABSOLUTE ENTRY                04600021
*INITIAL VALUE=0    BIT 6     ENTRY CARD RECEIVED                       04650021
*INITIAL VALUE=0    BIT 7     ESD-WRITE INDICATOR                       04700021
*                                                                       04750021
APT2     DS    CL1       THIRD BYTE--ALL PURPOSE INDICATORS             04800021
*                                                                       04850021
*INITIAL VALUE=0    BIT 0     NO LENGTH RECEIVED                        04900021
*INITIAL VALUE=0    BIT 1     NO LENGTH INDICATION                      04950021
*INITIAL VALUE=0    BIT 2     FIRST TEXT RECORD                         05000021
*INITIAL VALUE=0    BIT 3     STATUS INDICATOR RECEIVED                 05050021
*INITIAL VALUE=0    BIT 4    INCLUDE PREVIOUSLY INITIATED               05100021
*INITIAL VALUE=0    BIT 5     I/O OVERLAP BIT                           05150021
*INITIAL VALUE=0    BIT 6     IN MODULE INDICATOR                       05200021
*INITIAL VALUE=0    BIT 7     PROGRAMMER PUNCHED CARD CONTINUATION      05250021
*                                                                       05300021
APT3     DS    CL1       FOURTH BYTE--ALL PURPOSE INDICATORS            05350021
*                                                                       05400021
*INITIAL VALUE=0    BIT 0     END OF FILE                               05450021
*INITIAL VALUE=0    BIT 1     NAME CARD RECEIVED-END OF INPUT FOR L.M.  05500021
*INITIAL VALUE=0    BIT 2      END OF INPUT  (/*) -END OF SYSLIN INPUT  05550021
*INITIAL VALUE=0    BIT 3     TO STOW AS REPLACEMENT                    05600021
*INITIAL VALUE=0    BIT5      FIRST TEXT OF SEGMENT                     05650021
*INITIAL VALUE=0    BIT 4     FIRST TEXT OF LOAD MODULE                 05700021
*INITIAL VALUE=0    BIT 6     RLDS FOR GROUP                            05750021
*INITIAL VALUE=0   BIT  7    SYSLIB OPENED                              05800021
         SPACE 2                                                        05850021
CTTR     DS    F         TTR0 FOR CESD(1ST RECORD) IF MAP OR XREF       05900021
CSNO     DS    H         CURRENT SEGMENT NUMBER                         05950021
CRNO     DS    H         CURRENT REGION NUMBER                          06000021
PRAL     DS    F         PSUEDO REGISTER ACCUMULATIVE LENGTH            06050021
         SPACE 2                                                        06100021
*                                                                       06150021
***  ADDRESSES OF ALL TABLES USED DURING PROCESSING                 *** 06200021
*                                                                       06250021
FLCD     DS    F         ADDRESS OF FIRST LINE CESD LINES DELETED       06300021
RCCE     DS    F         ADDRESS OF END OF REPLACE/CHANGE CHAIN         06350021
RCCB     DS    F         ADDRESS OF REPLACE/CHANGE CHAIN BEGINNING      06400021
ALCB     DS    F         ADDRESS OF ALIAS CHAIN BEGINNING               06450021
OVCMBGAD DS    1F        ADDRESS OF OVERLAY CHAIN BEGINNING             06500021
SGT1     DS    1F        ADDRESS OF SEGTAB1 - 1                         06550021
CLLT     DS    1F        ADDRESS OF CALLS LIST TABLE                    06600021
TNT1     DS    1F        ADDRESS OF TEXT NOTE LIST 1                    06650021
RNT1     DS    1F        ADDRESS OF RLD NOTE LIST 1                     06700021
RLDINPAD DS    1F        ADDR. OR RLD INPUT BUFFER 1ST PASS             06750021
RECNT    DS    1F        ADDRESS OF RELOCATION CONSTANT TABLE - 4       06800021
*                        ALSO RENUMBERING TABLE - 4                     06850021
TXTIO    DS    1F        ADDRESS OF TEXT I/O TABLE                      06900021
ALAS     DS    1F        ADDRESS OF ALIAS TABLE                         06950021
DLKT     DS    1F        ADDRESS OF DELINK TABLE - 5                    07000021
CHESD    DS    1F        ADDRESS OF COMPOSITE ESD - 16                  07050021
SELST    DS    1F        ADDRESS OF SECOND PASS ENTRY LIST              07100021
TNLS2    DS    1F        ADDRESS OF TEXT NOTE LIST 2                    07150021
RNLS2    DS    1F        ADDRESS OF RLD NOTE LIST 2                     07200021
TTRLIST  DS    1F        ADDRESS OF TTR LIST                            07250021
RLDOUTBF DS    1F        ADDR. OF OUTPUT RLD BUFFER-2ND PASS            07300021
HIARADD  DS    1F        ADDRESS OF HIAR (HIERARCHY) TABLE              07350021
ORDRADR  DS    1F        ADDRESS OF ORDER TABLE                  S01904 07360021
         SPACE 2                                                        07400021
INCBRKPT DS    1F         ADDRESS OF BREAKING POINT IN INCL CHAIN       07700021
CRRTINCL DS    1F       ADDRESS OF CURRENTLY INCLUDED ESD ITEM          07750021
         SPACE 2                                                        07800021
*                                                                       07850021
***  CAPACITIES OF ALL TABLES USED DURING PROCESSING                    07900021
*                                                                       07950021
ENRNX    DS    1H        MAX. NO. OF ENTRIES IN RNT TABLE               07960002
ENCDX    DS    1H        MAX. NO. OF ENTRIES IN C/HESD TABLES           08000021
ENT1X    DS    1H        MAX. NO. OF ENTRIES IN TEXT NOTE LIST 1        08050021
ENR1X    DS    1H        MAX. NO. OF ENTRIES IN RLD NOTE LIST 1         08100021
ENT2X    DS    1H        MAX. NO. OF ENTRIES IN TEXT NOTE LIST 2        08150021
ENR2X    DS    1H        MAX. NO. OF ENTRIES IN RLD NOTE LIST 2         08200021
ENTOX    DS    1H        MAX. NO. OF BYTES IN TEXT I/O TABLE            08250021
ENCLX    DS    1H        MAX. NO. OF BYTES IN CALLS LIST                08300021
ENDTX    DS    1H        MAX. NO. OF ENTRIES IN DELINK TABLE            08350021
ENS1X    DS    1H        MAX. NO. OF SEGMENTS                           08400021
BUFSIZ   DS    1H        SIZE OF BUFFER                                 08450021
HESD     DS    1F        ADDRESS OF HESD TABLE - 8                      08500021
ENELTX   DS    1H        MAX. NUMBER OF ENTRIES IN 2ND PASS ENTRY LIST  08550021
ENT1X1   DS    1H            MAX. NO. OF ENTRIES IN TEXT NOTE LIST 1    08560021
*        BEFORE REALLOCATION - USED ONLY IF TABLES WERE REALLOCATED     08570021
ENR1X1   DS    1H            MAX. NO. OF ENTRIES IN RLD NOTE LIST 1     08580021
*        BEFORE REALLOCATION - USED ONLY IF TABLES WERE REALLOCATED     08590021
         SPACE 2                                                 S21016 08600021
*********************************************************************** 08650021
*                                                                     * 08700021
*          ADDITIONS TO THE ALL PURPOSE TABLE FOR IDR SUPPORT         * 08750021
*                                                              S21016 * 08800021
*********************************************************************** 08850021
         SPACE 2                                                 S21016 08900021
IDRTRLEN DS    H                       MAXIMUM LENGTH OF IDR     S21016 08950021
*                                      TRANSLATOR DATA TABLE     S21016 09000021
IDRTILEN DS    H                       MAXIMUM LENGTH OF IDR    OX04245 09010002
*                                      TRANSLATOR ID TABLE      OX04245 09020002
IDRUDLEN DS    H                       MAXIMUM LENGTH OF IDR     S21016 09050021
*                                      USER DATA TABLE           S21016 09100021
IDRZPLEN DS    H                       MAXIMUM LENGTH OF IDR     S21016 09150021
*                                      IMASPZAP DATA TABLE       S21016 09200021
* THE FOLLOWING FOUR WORDS CAN NOT BE MOVED AFTER THEIR          XM4950 09210002
* RELATED IDR CONSTANTS AND CAN NOT BE SHUFFLED AS TO            XM4950 09220003
* ORDER WITHOUT SHUFFLING ALL OTHER IDR CONTANTS IN THE APT      XM4950 09230003
IDRTRTAB DS    F                       STARTING ADDRESS OF IDR   S21016 09250021
*                                      TRANSLATOR DATA TABLE     S21016 09300021
IDRTITAB DS    F                       STARTING ADDRESS OF IDR  OX04245 09302002
*                                      TRNSLATOR ID TABLE       OX04245 09304002
IDRUDTAB DS    F                       STARTING ADDRESS OF IDR   S21016 09310003
*                                      USER DATA TABLE           S21016 09320003
IDRZPTAB DS    F                       STARTING ADDRESS OF IDR   S21016 09330003
*                                      IMASPZAP DATA TABLE       S21016 09340003
IDRTREND DS    F                       ADDRESS OF NEXT AVAILABLE S21016 09350021
*                                      (UNUSED) BYTE OF IDR      S21016 09400021
*                                      TRANSLATOR DATA TABLE     S21016 09450021
IDRTIEND DS    F                       ADDRESS OF NEXT AVAIL    OX04245 09500002
*                                      (UNUSED) BYTE OF IDR     OX04245 09550002
*                                      TRANSLATOR ID TABLE      OX04245 09560002
IDRUDEND DS    F                       ADDRESS OF NEXT AVAILABLE S21016 09600021
*                                      (UNUSED) BYTE OF IDR USER S21016 09650021
*                                      DATA TABLE                S21016 09700021
IDRZPEND DS    F                       ADDRESS OF NEXT AVAILABLE S21016 09850021
*                                      (UNUSED) BYTE OF IDR      S21016 09900021
*                                      IMASPZAP DATA TABLE       S21016 09950021
         SPACE 2                                                 S21016 10000021
ENRLD2X  DS    1H        MAX. SIZE OF INPUT RLD BUFFER-1ST PASS         10050021
ENSPX    DC    H'0'      2 BYTES USED BY HEWLKOUT                       10100021
LSTS     DS    1F L      LAST SEGMENT IN EACH REGION (REGION 1-4)       10150021
EPSM     DS    CL8       ENTRY POINT SYMBOL OR END CARD ADDRESS/SYMBOL  10200021
*              ALSO USED AS STORAGE AREA BY HEWLFSCD AND HEWLFREL       10250021
         SPACE 2                                                        10300021
*                                                                       10350021
***  CURRENT USAGE OF ALL TABLES USED DURING PROCESSING             *** 10400021
*                                                                       10450021
ENT1C    DS    H         CURRENT NUMBER OF ENTRIES IN TXT NOTE LIST 1   10500021
ENR1C    DS    H         CURRENT NUMBER OF ENTRIES IN RLD NOTE LIST 1   10550021
ENITC    DS    H         CURRENT NUMBER OF BYTES IN TXT I/O CNTL TABLE  10600021
ENIRC    DS    H         CURRENT NUMBER OF BYTES IN RLD I/O CNTL TABLE  10650021
ENTOC    DS    H         CURRENT NUMBER OF BYTES IN TXT I/O TABLE       10700021
ENCLC    DS    H         CURRENT NUMBER OF BYTES IN CALLS LIST          10750021
ENS1C    DS    H         CURRENT NUMBER OF ENTRIES IN SEGTAB1           10800021
ENASC    DS    H         CURRENT NUMBER OF ENTRIES IN ALIAS TABLE       10850021
ENDTC    DS    H         CURRENT NUMBER OF ENTRIES IN DELINK TABLE      10900021
ENRNC    DS    H         CURRENT NUMBER OF ENTRIES IN RNT TABLE  XM1692 10910000
*                        ALWAYS EQUAL TO MAXIMUM NUMBER DUE TO LR       10920002
*                        PROCESSING WHICH MUST TURN ON DEPEND FLAGS     10930002
*                        FOR SD ITEMS NOT YET RECEIVED                  10940002
ENCDC    DS    H         CURRENT NUMBER OF ENTRIES IN H/CESD TABLE      10950021
ENELTC   DS    H         CURRENT NUMBER OF ENTRIES IN 2PASS ENTRY LIST  11000021
ENT2C    DS    H         CURRENT NUMBER OF ENTRIES IN TXT NOTE LIST 2   11050021
ENR2C    DS    H         CURRENT NUMBER OF ENTRIES IN RLD NOTE LIST 2   11100021
ENSPC    DC    H'00'    HIGHEST SEGMENT NUMBER WITH TEXT                11150021
* THE FOLLOWING FOUR FIELDS MAY NOT BE MOVED IN THE APT                 11152002
* TO A LOCATION THAT IS BEFORE THEIR RELATED IDR CONSTANTS              11154003
* THE HALFWORD FILLERS MUST BE LEFT IN AND THE ORDER OF                 11156003
* THE OCCURRENCE OF THESE FIELDS CAN NOT BE CHANGED WITHOUT             11158003
* CHANGING THE ORDER OF ALL OTHER IDR CONSTANTS                         11158403
         DS    0F                                                       11158803
IDRTRCUR DS    H         CURR # BYTES IN IDR TRANS DATA TABLE    XM4950 11160003
         DS    0F                                                       11162003
IDRTICUR DS    H         CURR # BYTES IN IDR TRANS ID TABLE     OX04245 11164002
         DS    0F                                               OX04245 11168002
IDRUDCUR DS    H         CURR # BYTES IN IDR USER DATA TABLE     XM4950 11170003
         DS    0F                                                       11172003
IDRZPCUR DS    H         CURR # BYTES IN IDR ZAP DATA TABLE      XM4950 11180003
ORDRCUR  DS    H        CURRENT NUMBER OF BYTES IN ORDER TABLE   S01904 11200021
ORDRMAX  DS    H        MAX. NO. OF BYTES IN ORDER TABLE         S01904 11210021
BITMAP   DS    2F        BIT SWITCHES DENOTING ERROR MESSAGES LOGGED    11220003
BITMAP2  DS    2F        ADDITIONAL BIT SWITCHES DENOTING ERROR  S21016 11230003
*                        MESSAGES LOGGED                         S21016 11240003
LINECNT  DS    1H        LINES ON THIS PAGE                             11242003
HISEV    DS    1H        HIGHEST SEVERITY MESSAGE                       11244003
         SPACE 2                                                        11250021
SYSRTN   DS    2F        TWO WDS FOR REGISTER 13-14 TO RETURN TO SCHED. 11300021
SPACES   DS    18F       SAVE AREA FOR TEMPORARY DEBUGGING              11350021
*              ALSO USED AS STORAGE AREA BY HEWLFSCD AND HEWLFREL       11400021
         AIF   ('&PARM' EQ 'A').DC3                                     11450021
ERDIG    DS    F         ADDRESS OF HEWLFLOG                            11500021
         AGO   .DC4                                                     11550021
.DC3     ANOP                                                           11600021
ERDIG    DC    V(HEWLFLOG) ADDRESS OF HEWLFLOG                          11650021
.DC4     ANOP                                                           11700021
         AIF   ('&PARM' EQ 'A').DC31                                    11710021
ERDIGA   DS    F        ADDRESS OF HEWLFALK                      S01904 11720021
         AGO   .DC41                                                    11730021
.DC31    ANOP                                                           11740021
ERDIGA   DC    V(HEWLFALK)   ADDRESS OF HEWLFALK                 S01904 11742021
.DC41    ANOP                                                           11744021
SSI      DS    1F        SYSTEM STATUS INDICATOR (FOR APT)              11750021
FFCADR   DS    1F        HIGHEST ADDRESS RETAINED BY ALLOCATOR          11800021
LIBNAME  DS    8C        NAME OF LIBRARY                                11850021
LIBOPEN  DS    8C        NAME OF LIBRARY NOW OPEN                       11900021
         AIF   ('&PARM' EQ 'A').DC11                                    11950021
         DS    H                                                        12000021
         AGO   .DC12                                                    12050021
.DC11    ANOP                                                           12100021
APT000   BR    14         SYNAD FOR PRINTER                             12150021
.DC12    ANOP                                                           12200021
SAVATS   DS    3C        ATTRIBUTES SAVE AREA                           12250021
         SPACE 2                                                        12300021
APTSWS   DS    1C        SWITCHES                                       12350021
*                   BITS 0-3  SPARE                                     12400021
*INITIAL VALUE=0    BIT 4     BIT MAP PROCESSED                         12450021
*INITIAL VALUE=0    BIT 5     LINKAGE EDITOR INPUT RECEIVED             12500021
*INITIAL VALUE=0    BIT 6     SYM RECEIVED                              12550021
*INITIAL VALUE=0    BIT 7     ESD RECEIVED                              12600021
TSOBIT   EQU   X'80'         TSO OR NOT                          S99999 12650021
CSTOW    EQU   X'40'         RESERVED FOR CSTOW OPTION           S99999 12700021
ABSREL   EQU   X'20'         0 -- RELOCATABLE                    S99999 12750021
*                            1 -- ABSOLUTE                       S99999 12800021
OVRDE    EQU   X'10'         DCBS OVERRIDE                       S99999 12850021
         SPACE 2                                                        12900021
*                                                                       12950021
NEWSW    DC    XL1'00'        SWITCHES FOR DETERMINING CONTROL          13000021
*                                                                       13050021
*INITIAL VALUE=0    BIT 0     IF OFF INDICATES 1ST TIME IN INT          13100021
*INITIAL VALUE=1    BIT 1     MAP/XREF ENTERED FROM INTERMEDIATE PROC.  13150021
*                             IF 0, ENTERED FROM FINAL PROCESSOR        13200021
*INITIAL VALUE=0    BIT 2     ALL RLDS IN CORE                          13250021
*                             IF 1, THE RLDS ARE NOT IN CORE            13300021
*INITIAL VALUE=0    BIT 3     MAP/XREF NOT IN CONTROL                   13350021
*                             IF 1, MAP/XREF IN CONTROL                 13400021
*INITIAL VALUE=0    BIT 4     NORMAL PRINTING ON SYSPRINT               13450021
*                             IF 1, ABORT IMMEDIATELY-NO PRINTING       13500021
*INITIAL VALUE=0    BIT 5     HIERARCHY                                 13550021
*INITIAL VALUE=0    BIT 6     SPARE                                     13600021
*INITIAL VALUE=0    BIT 7     INDICATES PURGE TO TXT/RLD PROCESSOR      13650021
         SPACE 2                                                        13700021
*                                                                       13750021
NEWSW2   DC    XL1'00'        SWITCHES FOR SECOND PASS PROCESSING       13800021
*                                                                       13850021
*INITIAL VALUE=0    BIT0      MORE RLDS EXIST FOR CURRENT ID            13900021
*INITIAL VALUE=0    BIT1      SPLIT RLD IN OUTPUT BUFFER                13950021
*INITIAL VALUE=0    BIT2      R AND P POINTER HAS BEEN SAVED            14000021
*INITIAL VALUE=0    BIT3      RELATIVE RELOCATION FACTOR NEEDED         14050021
*                             IF 1, ABSOLUTE RELOCATION FACTOR NEEDED   14100021
*INITIAL VALUE=0    BIT4      SPLIT RLD HAS BEEN SAVED IN HESD PREFIX   14150021
*INITAIL VALUE=0    BIT5      NO RLDS EXIST FOR LAST TEXT OF SEGMENT    14200021
*                             OR LAST TEXT OF MODULE                    14250021
*INITIAL VALUE=0    BIT6      SPLIT RLD IS PRECEDED BY R AND P PTRS.    14300021
*INITIAL VALUE=0    BIT7      R AND P PTRS FOR CURRENT CHAIN ARE IN BFR 14350021
         SPACE 2                                                        14400021
APTSW2   DS    XL1           SWITCHES                            S99999 14450021
ENQBIT   EQU   X'80'         OFF=ENQ'ED; ON=NO ENQ               S99999 14500021
*        EQU   X'40'                   RESERVED                         14510000
SHRSYSMD EQU   X'20'                   OFF = SYSLMOD NOT SHARED  A49330 14520000
*                                      ON = SYSLMOD SHARED DASD  A49330 14530000
REINTRY  EQU   X'10'                   OFF = FIRST TIME THRU INT A51444 14540000
*                                      ON = NOT FIRST TIME THRU  A51444 14542000
         SPACE 2                                                 S99999 14550021
APTSW3   DS    XL1           SWITCHES                            S99999 14600021
         SPACE 2                                                 S99999 14650021
APTSW4   DS    XL1           SWITCHES                            S99999 14700021
         EJECT                                                          14710000
*****                                                                   14720000
*                                                                       14730000
*   EQUATES TO SUPPORT THE REALLOCATE CODE AND TO STANDARDIZE           14740000
*      THE CONSTANTS FOR TABLE SIZE AND WEIGHT COMPUTATION              14744000
*                                                                       14746000
*****                                                                   14748000
WT1      EQU   X'0000' WEIGHT FOR RLD INP BUF TABLE (1ST PASS)          14748400
WT2      EQU   X'0000' WEIGHT FOR ALIAS TABLE                           14749200
WT3      EQU   X'0120' WEIGHT FOR CESD TABLE                            14749600
WT4      EQU   X'0000' WEIGHT FOR HESD TABLE                            14749700
WT5      EQU   X'0090' WEIGHT FOR HESD TABLE (SECOND)                   14749800
WT6      EQU   X'0054' WEIGHT FOR TEXT NOTE LIST 2 TABLE                14749900
WT7      EQU   X'003A' WEIGHT FOR RLD NOTE LIST 2 TABLE                 14766600
WT8      EQU   X'0030' WEIGHT FOR TEXT I/O TABLE                        14776600
WT9      EQU   X'0048' WEIGHT FOR RNT/RELOC CONSTANT TABLES             14778600
WT10     EQU   X'0018' WEIGHT FOR DELINK TABLE                          14780600
WT11     EQU   X'0000' WEIGHT FOR RLD O/P BUF TABLE (2ND PASS)          14782600
WT12     EQU   X'0015' WEIGHT FOR TEXT NOTE LIST 1 TABLE                14783000
WT13     EQU   X'000E' WEIGHT FOR RLD NOTE LIST 1 TABLE                 14783100
WT14     EQU   X'001C' WEIGHT FOR ORDER TABLE                           14783200
WT15     EQU   X'0012' WEIGHT FOR HIERARCHY TABLE                       14788800
WT16     EQU   X'0000' WEIGHT FOR SEGMENT TABLE                         14790800
WT17     EQU   X'0060' WEIGHT FOR CALLS LIST TABLE                      14792800
WT18     EQU   X'0060' WEIGHT FOR ENTRY LIST TABLE                      14793200
WT19     EQU   X'000C' WEIGHT FOR IDR TRANSLATOR DATA TABLE     OX04245 14793602
WT20     EQU   X'0058' WEIGHT FOR IDR USER DATA TABLE                   14794000
WT21     EQU   X'002C' WEIGHT FOR IDR ZAP DATA TABLE                    14794100
WT22     EQU   X'002D' WEIGHT FOR TRANSLATOR ID TABLE           OX04245 14797602
MIN1     EQU   X'0100' MINSIZE FOR RLD INP BUF TABLE (1ST PASS)         14801202
MIN2     EQU   X'00A0' MINSIZE FOR ALIAS TABLE                          14804702
MIN3     EQU   X'1200' MINSIZE FOR CESD TABLE                           14808200
MIN4     EQU   X'0008' MINSIZE FOR HESD TABLE                           14818200
MIN5     EQU   X'0900' MINSIZE FOR HESD TABLE (SECOND)                  14820200
MIN6     EQU   X'0540' MINSIZE FOR TEXT NOTE LIST 2 TABLE               14820600
MIN7     EQU   X'03A0' MINSIZE FOR RLD NOTE LIST 2 TABLE                14821000
MIN8     EQU   X'0300' MINSIZE FOR TEXT I/O TABLE                       14821400
MIN9     EQU   X'0480' MINSIZE FOR RNT/RELOC CONSTANT TABLES            14821800
MIN10    EQU   X'0180' MINSIZE FOR DELINK TABLE                         14821900
MIN11    EQU   X'0300' MINSIZE FOR RLD O/P BUF TABLE (2ND PASS)         14822000
MIN12    EQU   X'0150' MINSIZE FOR TEXT NOTE LIST 1 TABLE               14822100
MIN13    EQU   X'00E8' MINSIZE FOR RLD NOTE LIST 1 TABLE                14826700
MIN14    EQU   X'01C8' MINSIZE FOR ORDER TABLE                          14828700
MIN15    EQU   X'0120' MINSIZE FOR HIERARCHY TABLE                      14830700
MIN16    EQU   X'0100' MINSIZE FOR SEGMENT TABLE                        14831100
MIN17    EQU   X'0600' MINSIZE FOR CALLS LIST TABLE                     14831200
MIN18    EQU   X'0600' MINSIZE FOR ENTRY LIST TABLE                     14831300
MIN19    EQU   X'00C0' MINSIZE FOR IDR TRANSLATOR DATA TABLE    OX04245 14831402
MIN20    EQU   X'03C0' MINSIZE FOR IDR USER DATA TABLE                  14836000
MIN21    EQU   X'01C7' MINSIZE FOR IDR ZAP DATA TABLE                   14838100
MIN22    EQU   X'00D0' MINSIZE FOR TRANSLATOR ID TABLE          OX04245 14838502
ADDSIMP  EQU   WT1+WT3+WT8+WT9+WT10+WT12+WT13+WT14+WT19+WT20+WT21+WT22  14840102
*  ADDSIMP IS THE SUM OF THE WEIGHTS OF THE 'NORMAL' OR         OX04245 14840502
*   'ALWAYS USED' TABLES                                                14840600
ROUNDSIM EQU   ((ADDSIMP+15)/16)*16 ROUNDS UP ADDSIMP TO FW BDY         14840700
ADDHIAR  EQU   ADDSIMP+WT15  TOTAL WEIGHTS FOR HIARCHY                  14852500
ROUNHIAR EQU   ((ADDHIAR+15)/16)*16 ROUNDS UP ADDHIAR TO FW BDY         14862500
ADDOVLY  EQU   ADDSIMP+WT16+WT17+WT18  TOTAL WEIGHTS FOR OVLY           14864500
ROUNOVLY EQU   ((ADDOVLY+15)/16)*16 ROUNDS UP ADDOVLY TO FW BDY         14868400
ADDSIMPM EQU   MIN1+MIN3+MIN8+MIN9+MIN10+MIN12+MIN13+MIN14+MIN19+MIN20+*14870400
               MIN21+MIN22   ADDSIMPM SUMS THE MINIMUM SIZES FOR THE    14872402
*                       'NORMAL' TABLES                         OX04245 14876302
NORMTABS EQU   ((ADDSIMPM+15)/16)*16  ROUNDS TO FW BDY                  14878400
ADDOVLYM EQU   ADDSIMPM+MIN16+WT17+WT18  SUM SIZES FOR OVLY             14878800
OVLATABS EQU   ((ADDOVLYM+15)/16)*16  ROUNDS TO FW BDY                  14879200
ADDHIARM EQU   ADDSIMPM+MIN15  SUM OF SIZES FOR HIAR TABLES             14879600
HIARTABS EQU   ((ADDHIARM+15)/16)*16  ROUNDS TO FW BDY                  14880000
         EJECT ,                                                 S21016 14880400
IDRSWS   DS    XL1                     IDR SWITCHES              S21016 14884300
*     ******************************************************     S21016 14888200
*     *                BIT DESCRIPTIONS                    *     S21016 14900021
*     ******************************************************     S21016 14950021
*     *  SYMBOLIC  *       *        *    MEANING OF BIT    *     S21016 15000021
*     *  NAME  OF  *  BIT  *  MASK  *    WHEN TURNED ON    *     S21016 15050021
*     *    MASK    *       *        *     (VALUE = 1)      *     S21016 15100021
*     ******************************************************     S21016 15150021
*     *    N/A     *   0   *  X'80' *  RESERVED            *     S21016 15200021
*     ******************************************************     S21016 15250021
*     *    N/A     *   1   *  X'40' *  RESERVED            *     S21016 15300021
*     ******************************************************     S21016 15350021
*     *    N/A     *   2   *  X'20' *  RESERVED            *     S21016 15400021
*     ******************************************************     S21016 15450021
*     *            *       *        *  THE LAST  IDR ITEM  *     S21016 15500021
*     *            *       *        *  PROCESSED  WAS NOT  *     S21016 15550021
*     *   PARTENT  *   3   *  X'10' *   COMPLETE  (IT IS   *     S21016 15600021
*     *            *       *        *    EXPECTED TO BE    *     S21016 15650021
*     *            *       *        *   CONTINUED ON THE   *     S21016 15700021
*     *            *       *        *  NEXT INPUT RECORD)  *     S21016 15750021
*     ******************************************************     S21016 15800021
*     *            *       *        * DOUBLE IDR  ENTRY ON *     S21016 15850021
*     *   DBLOBJ   *   4   *  X'08' *  AN OBJ MOD END REC  *     S21016 15900021
*     *            *       *        *   BEING PROCESSED    *     S21016 15950021
*     ******************************************************     S21016 16000021
*     *   USEIDR   *   5   *  X'04' *   IDENTIFY CONTROL   *     S21016 16050021
*     *            *       *        * CARD BEING PROCESSED *     S21016 16100021
*     ******************************************************     S21016 16150021
*     *            *       *        *  OBJECT MODULE END   *     S21016 16200021
*     *   OBJIDR   *   6   *  X'02' * CARD BEING PROCESSED *     S21016 16250021
*     *            *       *        *  FOR IDR INPUT DATA  *     S21016 16300021
*     ******************************************************     S21016 16350021
*     *   LMDIDR   *   7   *  X'01' *   LOAD MODULE IDR    *     S21016 16400021
*     *            *       *        *   BEING PROCESSED    *     S21016 16450021
*     ******************************************************     S21016 16500021
*   NOTE--INITIAL VALUE OF ALL BITS IS ZERO (SET BY HEWLFINT)    S21016 16550021
*RESVRD  EQU   X'80'                   EQUATES OF                S21016 16600021
*RESVRD  EQU   X'40'                   SYMBOLIC                  S21016 16650021
*RESVRD  EQU   X'20'                   NAMES                     S21016 16700021
PARTENT  EQU   X'10'                   FOR                       S21016 16750021
DBLOBJ   EQU   X'08'                   MASKS                     S21016 16800021
USEIDR   EQU   X'04'                   AS                        S21016 16850021
OBJIDR   EQU   X'02'                   SPECIFIED                 S21016 16900021
LMDIDR   EQU   X'01'                   ABOVE                     S21016 16950021
***                                                              ***    16960002
***            MAP OF INTERNAL TRANSLATOR IDR DATA TABLE         ***    16980002
***                                                              ***    16990002
TRNAME   EQU   0                        TRANSLATOR NAME         OX04245 16992002
VVMM     EQU   10                       VERSION/MOD LEVEL       OX04245 16994002
*                                       OF TRANSLATOR           OX04245 16996002
TRNAME2  EQU   12                       2ND TRANSLATOR NAME     OX04245 16998002
VVMM2    EQU   22                       VERSION/MOD LEVEL       OX04245 16998402
*                                       OF 2ND TRANSLATOR       OX04245 16998802
***                                                              ***    16999202
***            MAP OF INTERNAL TRANSLATOR IDR ID TABLE           ***    16999602
***                                                              ***    16999702
INDCTR   EQU   0                        INDICATOR               OX04245 16999802
*                                       X'00' = ONE TRANSLATOR  OX04245 16999902
*                                       DESCRIPTION             OX04245 17003202
*                                       X'01' = TWO TRANSLATOR  OX04245 17005202
*                                       DESCRIPTIONS            OX04245 17005602
NAMEPTR  EQU   1                        POINTER TO CORRESPOND   OX04245 17006002
*                                       ENTRY IN TRANS IDR DATA OX04245 17006402
*                                       TABLE                   OX04245 17006502
YYDDD    EQU   3                        DATE OF TRANSLATION     OX04245 17006602
YYDDD2   EQU   6                        2ND DATE OF TRANSLATION OX04245 17009902
         EJECT ,                                                 S21016 17013402
APT4     DS   XL1       ALL PURPOSE INDICATOR                    S01904 17016702
*                                                                       17020021
*INITIAL  VALUE=0     BIT0     TABLES INITIALLY ALLOCATED        S01904 17030021
*INITIAL  VALUE=0     BIT1     TABLES REALLOCATED                S01904 17040021
*INITIAL  VALUE=0     BIT2     INTERMEDIATE PASS PROCESSING      S01904 17042021
*INITIAL  VALUE=0     BIT3     SECOND PASS PROCESSING            S01904 17044021
*INITIAL  VALUE=0     BIT4     ORDERING REQUIRED                 S01904 17046021
*INITIAL  VALUE=0     BIT5     PAGE BOUNDARY ALIGNMENT REQUIRED  S01904 17048021
*INITIAL  VALUE=0     BIT6     ALIGN ON 2K PAGE BOUNDARY         S01904 17048421
*INITIAL  VALUE=0     BIT7     SPARE                             S01904 17048821
*                                                                       17048921
*THE FOLLOWING ARE THE SYMBOLS USED IN REFERENCING APT4                 17049021
REALOCTE EQU   X'C0'    ALL ALLOCATION DONE                      S01904 17049121
INALOCTD EQU   X'80'    TABLES INITIALLY ALLOCATED               S01904 17059221
REALOCTD EQU   X'40'    TABLES REALLOCATED                       S01904 17069221
INTRPS   EQU   X'20'    INTERMEDIATE PASS PROCESSING             S01904 17069621
SCDPS    EQU   X'10'    SECOND PASS PROCESSING                   S01904 17073021
ORDERR   EQU   X'08'    ORDERING REQUIRED                        S01904 17075021
PAGEE    EQU   X'04'    PAGE ALIGNMENT REQUIRED                  S01904 17075821
ALIGN2   EQU   X'02'    ALIGN OF 2K PAGE BOUNDARY                S01904 17076221
*                                                                       17076321
         SPACE 3                                                        17076421
*                                                                       17079821
MAXBF    DC    H'40'          MAXIMUM BLOCKING FACTOR                   17089921
*                                                                       17100021
         SPACE 2                                                        17150021
***                                                                     17200021
***   I/O CONTROL BLOCKS FOR BUFFER LOCATIONS AND CAPACITIES        *** 17250021
***                                                                     17300021
HEWLCRBB DC    A(DECBLIB)          ADDRESS OF SYSLIB DECB               17350021
         DC    F'0'                1ST LIBRARY BUFFER                   17400021
         DC    F'0'                2ND LIBRARY BUFFER                   17450021
         DC    H'0'                BLKSIZE                              17500021
         DC    H'80'               LRECL                                17550021
         DC    H'1'                BLKFCTR                              17600021
         DC    H'1'                NUMBER OF RECORDS LEFT IN BUFFER     17650021
         DC    F'0'                ADDRESS OF CURRENT RECORD            17700021
         DC    X'80000000'         READSW SET TO FIRST READ             17750021
*                                                                       17800021
HEWLCRBN DC    A(DECBLIN)          ADDRESS OF SYSLIN DECB               17850021
         DC    F'0'                1ST SYSLIN BUFFER                    17900021
         DC    F'0'                2ND SYSLIN BUFFER                    17950021
         DC    H'0'                BLKSIZE                              18000021
         DC    H'80'               LRECL                                18050021
         DC    H'1'                BLKFCTR                              18100021
         DC    H'1'                NUMBER OF RECORDS LEFT IN BUFFER     18150021
         DC    F'0'                ADDRESS OF CURRENT RECORD            18200021
         DC    X'80000000'         READSW SET TO FIRST READ             18250021
*                                                                       18300021
         AIF   ('&PARM' EQ 'A').DC9                                     18350021
HEWLCWBB  DS  F                                                         18400021
         AGO   .DC10                                                    18450021
.DC9     ANOP                                                           18500021
HEWLCWBB DC    A(HEWLCPDB)        ADDRESS OF SYSPRINT DCB               18550021
.DC10    ANOP                                                           18600021
         DC    F'0'                1ST SYSPRINT BUFFER                  18650021
         DC    F'0'                2ND SYSPRINT BUFFER                  18700021
         DC    H'0'                BLKSIZE                              18750021
         DC    H'121'              LRECL                                18800021
         DC    H'1'                BLKFCTR                              18850021
         DC    H'1'                NUMBER OF RECORDS LEFT IN BUFFER     18900021
         DC    F'0'                ADDRESS OF CURRENT RECORD            18950021
         DC    X'80000000'         WRITESW SET TO FIRST WRITE           19000021
*                                                                       19050021
         SPACE 2                                                        19100021
RLDOUT1  DC    F'0'           ADDR OF FIRST RLD OUTPUT BUFFER-1ST PASS  19150021
RLDINBF1 EQU   RLDOUT1        ADDR OF FIRST RLD INPUT BUFFER-2ND PASS   19200021
RLDOUT2  DC    F'0'           ADDR OF SECOND RLD OUTPUT BUFFER-1ST PASS 19250021
RLDINBF2 EQU   RLDOUT2        ADDR OF SECOND RLD INPUT BUFFER-2ND PASS  19300021
TXTBFBEG DC    F'0'           ADDR OF START OF TEXT BUFFER              19350021
TXTBFEND DC    F'0'           ADDR OF END OF TEXT BUFFER                19400021
MULTSIZE DC    F'0'           SIZE OF SYSLMOD MULTIPLICITY-OR RECORD    19450021
UT1SIZE  DC    F'0'           SIZE OF SYSUT1 RECORD                     19500021
SZSYSUT1 DC    F'0'           SYSUT1 MAX. NUMBER BYTES PER TRACK        19550021
RLDSIZE  DC    F'0'           SIZE OF EACH RLD BUFFER 1ST PASS-IN       19600021
*                             2ND PASS-OUT                              19650021
VALUE1   DC    F'0'           SIZE VALUE1 FOR LE MAX. ALLOWABLE STORAGE 19700021
VALUE2   DC    F'0'           SIZE VALUE2 FOR LE LOAD MODULE BUFFER     19750021
MSGONE   DC    X'00000000'    INDICATES 1ST MESSAGE FROM MOPT           19800021
MSGTWO   DC    X'00000000'    INDICATES 2ND MESSAGE FROM MOPT           19850021
MSGTHREE DC    X'00000000'    INDICATES 3RD MESSAGE FROM MOPT           19900021
*                                                                       19950021
HEWLCLAC DC    A(HEWLCRBN)    ADDRESS OF CURRENT READ BLOCK             20000021
         SPACE 2                                                        20050021
         DS    0F                                                       20100021
         AIF   ('&PARM' EQ 'A').DC7                                     20150021
         READ  DECBLIN,SF,HEWLKLED,,,MF=L                               20200021
*                                                                       20250021
         READ  DECBLIB,SF,HEWLCLDB,,,MF=L   CREATE DECB FOR SYSLIB      20300021
         AGO   .DC8                                                     20350021
.DC7     ANOP                                                           20400021
         READ  DECBLIN,SF,HEWLCSDB,,,MF=L  CREATE DECB FOR SYSLIN       20450021
*                                                                       20500021
         READ  DECBLIB,SF,HEWLFLDB,,,MF=L        CREATE DECB FOR SYSLIB 20550021
.DC8     ANOP                                                           20600021
         DS    0F                                                       20650021
         SPACE 3                                                        20660021
******************************************************************      20662021
COREADR  DS   F    ADDRESS OF STORAGE AREA OBTAINED THROUGH GETMAIN     20670021
CORELEN  DS   F    LENGTH OF STORAGE AREA OBTAINED                      20680021
BRNCHSV  DS   16F  SAVE AREA                                            20690021
APTAPF   DS   0CL2       DEFAULT LGTH AND AUTH CODE              Y01048 20692000
APTAPFCT DS   CL1        FOR THIS LKED STEP                      Y01048 20694000
APTAPFAC DS   CL1        ONE BYTE LGTH & ONE BYTE CODE           Y01048 20696000
PDSAPF   DS   0CL2       CURRENT AUTH CODE FOR THIS              Y01048 20698000
PDSAPFCT DS   CL1        ITERATION OF THE LINK EDIT              Y01048 20698400
PDSAPFAC DS   CL1        CAN BE CHANGED BY SETCODE               Y01048 20698800
         DC    C'MAPT'        END OF HEWLFAPT INDICATOR                 20700021
*********************************************************************** 20750021
*                                ------------                         * 20800021
*            CODE GENERATION FOR - 10/02/73 - HEWAPT MACRO ENDS       * 20850002
*                                ------------                         * 20900021
*********************************************************************** 20950021
         MEND                                                           21000021
./  ADD  SSI=31990035,NAME=HEWLDCOM
         MACRO                                                          00050021
         HEWLDCOM  &MAXEXT=32,&EXTSIZ=32                                00100021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00150021
*                                                                       00160000
*    02/25/72          LEVEL=21                                         00170000
*                                                                       00180000
*STATUS - CHANGE LEVEL 021                                            * 00200000
*         TSO CHANGES FOR SYSTERM,INCORE DATA SET, PASSED SYSLIB,     * 00250021
*                         AND IDENTIFICATION                          * 00300021
*         APAR FIX 27445 - ZERO-LENGTH CSECTS OKAY                    * 00350021
*FUNCTION/OPERATION: TO PROVIDE A COMMUNICATIONS AREA FOR THE LOADER. * 00400021
*    ALL DYNAMIC DATA USED BY THE PROCESSING PORTION OF THE LOADER    * 00450021
*    IS CONTAINED IN THIS AREA. IEWLIOCA ALLOCATES SPACE FOR THIS     * 00500021
*    DATA AREA AND INITIALIZES IT. IT IS REFERENCED THROUGH REGISTER  * 00550021
*    11.                                                              * 00600021
*ENTRY POINTS: NOT APPLICABLE                                         * 00650021
*INPUT/OUTPUT: NOT APPLICABLE                                         * 00700021
*EXTERNAL ROUTINES: NOT APPLICABLE                                    * 00750021
*EXITS: NOT APPLICABLE                                                * 00800021
*TABLES/WORKAREAS:                                                    * 00850021
*ATTRIBUTES: NOT APPLICABLE                                           * 00900021
*NOTES: THE ADDRESS OF IEWLDCOM IS PLACED IN REGISTER 11 BY IEWLIOCA  * 00950021
*    AND KEPT THERE FOR USE BY ALL MODULES IN THE PROCESSING PORTION  * 01000021
*    OF THE LOADER                                                    * 01050021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01100021
         SPACE 3                                                        01150021
HEWLDCOM DSECT                                                          01200021
CMXDBLWD DS    D         TEMPORARY DOUBLE WORD                          01250021
CMADCON  EQU   CMXDBLWD  ALIGNMENT AREA FOR RELOCATION                  01300021
CMFSTSAV DS    F         POINTER TO FIRST SAVE AREA                     01350021
CMBEGADR DS    F         DEFAULT ENTRY POINT TO MODULE                  01400021
CMRDCBPT DS    F         INPUT DCB POINTER                              01450021
CMWDCBPT DS    F         OUTPUT DCB POINTER                             01500021
CMTDCBPT DS    F         SYSTERM DCB POINTER                            01550021
CMRDECPT DS    F         INPUT DECB POINTER                             01600021
CMWDECPT DS    F         OUTPUT DECB POINTER                            01650021
CMGETREC DS    F         INPUT LOGICAL RECORD POINTER                   01700021
CMPUTREC DS    F         OUTPUT LOGICAL RECORD POINTER                  01750021
CMTRMREC DS    F         SYSTERM BUFFER POINTER                         01800021
CMNXTTXT DS    F         NEXT ADDRESS TO BE ASSIGNED TO A CSECT         01850021
CMLSTTXT DS    F         HIGHEST TEXT ADDRESS ASSIGNED TO CURRENT CSECT 01900021
CMLOWTBL DS    F         LOWEST ADDRESS ASSIGNED FOR LOADER TABLES      01950021
CMHITBL  DS    F         HIGHEST STORAGE ADDRESS AVAILABLE TO LOADER    02000021
CMIOLST1 DS    F         OPEN LIST DCB POINTER                          02050021
CMIOLST2 DS    F         OPEN LIST DCB POINTER                          02100021
CMIOLST3 DS    F         OPEN LIST DCB POINTER                          02150021
CMCORE1  DS    F         CORRESPONDS TO CMNXTTXT FOR PRE-LOADED TEXT    02200021
CMCORE2  DS    F         CORRESPONDS TO CMLSTTXT FOR PRE-LOADED TEXT    02250021
CMTOPCOD DS    F         TOP OF LOADED CODE BEFORE COMMON ALLOCATED     02300021
CMLIBEOD DS    F         PASSED SYSLIB EXIT ROUTINE ADDRESSES           02350021
CMLIBSYN DS    F             - SYNAD ERROR ROUTINE POINTER              02400021
CMLIBEXL DS    F             - EXIT LIST POINTER                        02450021
CMBLKSIZ DS    H         BLOCKSIZE OF CURRENT INPUT OBJECT MODULE       02500021
CMMAXLNE DS    H         MAXIMUM LINE-COUNT  (SYSPRINT)                 02550021
*            NEXT THREE OPTIONS MUST STAY IN THIS ORDER.  THEY          02600021
*                          ARE REFERENCED TOGETHER.                     02650021
CMMAPLIN DS    H         LENGTH OF MAP LINE                             02700021
CMWLRECL DS    H         SYSPRINT RECORD SIZE                           02750021
CMMAXLST DS    H         MAXIMUM LENGTH OF INVALID OPTIONS LIST         02800021
         DS    0D                                                       02850021
*                                                                       02900021
CMINITCM EQU   *         BEGINNING OF AREA COMMON TO INITMAIN           02950021
*                                                                       03000021
CMMAINPT DS    F         VARIABLE-CONDITIONAL GETMAIN ADDRESS           03050021
CMMAINSZ DS    F         VARIABLE-CONDITIONAL GETMAIN SIZE              03100021
CMPRNTDD DS    CL8       PRINT DDNAME                                   03150021
CMLINDD  DS    CL8       PRIMARY INPUT DDNAME                           03200021
CMLIBDD  DS    CL8       LIBRARY DDNAME                                 03250021
CMTERMDD DS    CL8       DIAGNOSTIC DDNAME                              03300021
CMEPNAME DS    CL8       ENTRY POINT NAME                               03350021
CMPGMNM  DS    CL8       PROGRAM NAME                                   03400021
CMLINDCB DS    F         PASSED SYSLIN DCB POINTER                      03450021
CMLIBDCB DS    F         PASSED SYSLIB DCB POINTER                      03500021
*                                                                       03550021
*    PARAMETER FLAGS PASSED FROM PARAMETER LIST                         03600021
*                                                                       03650021
CMPRMFLG DS    X         PARAMETER FLAGS                                03700021
CQRES    EQU   X'01'     RES/NORES                                      03750021
CQMAP    EQU   X'02'     MAP/NOMAP                                      03800021
CQPRINT  EQU   X'04'     PRINT/NOPRINT                                  03850021
CQLET    EQU   X'08'     LET/NOLET                                      03900021
CQCALL   EQU   X'10'     CALL/NOCALL                                    03950021
CQEPNAME EQU   X'20'     ENTRY POINT NAME DEFINED                       04000021
CQEPADDR EQU   X'40'     ENTRY POINT ADDRESS DEFINED                    04050021
CQTERM   EQU   X'80'     TERM/NOTERM                                    04100021
*                                                                       04150021
*    INPUT - OUTPUT FLAGS                                               04200021
*                                                                       04250021
CMIOFLGS DS    X         I/O FLAGS                                      04300021
CQEOCB   EQU   X'01'     END OF CONCATENATION                           04350021
CQEOFB   EQU   X'02'     END OF FILE                                    04400021
CQEOFSB  EQU   X'04'     END OF FILE SIGNIFICANCE                       04450021
CQRECFM  EQU   X'08'     INPUT RECORD FORMAT -- 0 - FIXED               04500021
*                                               1 - UNDEFINED           04550021
CQUNDEF  EQU   CQRECFM   SEPARATE NAME IN ALLOCATION FOR UNDEFINED      04600021
CQFIXED  EQU   X'10'     FIXED RECORD FORMAT                            04650021
CQIGNCR  EQU   X'20'     IGNORE CONTROL RECORD ON LOAD MODULE           04700021
CQIOERR  EQU   X'40'     AN I/O ERROR HAS OCCURRED                      04750021
*                                                                       04800021
CMFLAG3  DS    X         ASSORTED FLAGS                                 04850021
CQTS     EQU   X'02'     TIME-SHARING ENVIRONMENT                       04900021
CQPGMNM  EQU   X'04'     PROGRAM NAME PASSED                            04950021
CQPASLIN EQU   X'08'     SYSLIN DCB PASSED                              05000021
CQPASLIB EQU   X'10'     SYSLIB DCB PASSED                              05050021
CQINCORE EQU   X'20'     WE'RE PROCESSING INCORE SYSLIN                 05100021
CQIDEN   EQU   X'40'     ENTERED AT IEWLOAD. IDENTIFICATION WANTED      05150021
CMFLAG4  DS    X         ASSORTED FLAGS                                 05300021
CQESDS   EQU   X'01'     ESDS HAVE BEEN ENCOUNTERED                     05350021
CQMOD    EQU   X'02'     MOD CARD HAS BEEN ENCOUNTERED                  05400021
CQNOEX   EQU   X'04'     EXECUTION NOT SCHEDULED                        05450021
CQMINI   EQU   X'08'     MINI-CESD BUILT                                05500021
CQMVT    EQU   X'10'     MVT OPERATING                                  05550021
CQCOMMON EQU   X'20'     COMMON RECEIVED                                05600021
CQTRMOPN EQU   X'40'     SYSTERM OPEN                                   05650021
CQIDONE  EQU   X'80'     IDENTIFICATION ACCOMPLISHED                    05700021
CMSYSTYP DS    F         SYSTEM TYPE STORED HERE BY HEWLDLIB     YM2946 05710000
*                        LAST THREE BYTES ARE UNUSED SPACE              05720000
CMRSAVE  DS    9F        LIB WILL SAVE REGS HERE WHEN CALLING    YM2946 05730000
*                        LPA SEARCH ROUTINE (IEAVVMSR) IN VS2           05740000
*                        REGS ARE IN ORDER 2-10                         05742000
*                                                                       05750021
         DS    0D                                                       05800021
*                                                                       05850021
CMINTZRO EQU   *      ALL FOLLOWING THIS POINT IS INITIALIZED TO ZERO   05900021
*                                                                       05950021
CMXLCHN  DS    F         POINTER TO CHAIN OF EXTENTS                    06000021
CMBITMAP DS    F         ERROR BIT MAP                                  06050021
CMERLIST DS    F         POINTER TO ERRORS ENCOUNTERED DURING OPEN      06100021
CMRLDCHN DS    F         FREE RLD ENTRY CHAIN (8 BYTES/ENTRY)           06150021
CMESDCHN DS    F         FREE CESD ENTRY CHAIN (20 BYTES/ENTRY)         06200021
CMEPADDR DS    F         ENTRY POINT ADDRESS TO LOADED PROGRAM          06250021
CMTRCTRL DS    &MAXEXT.F      TRANSLATE CONTROL LIST                    06300021
CMBLDLPT DS    F         BLDL POINTER                                   06350021
CMCXDPT  DS    F         POINTER TO CXD ADDRESSES                       06400021
CMFRECOR DS    F         FREE STORAGE CHAIN                             06450021
CMMODLNG DS    F         LENGTH OF MODULE CURRENTLY BEING PROCESSED     06500021
CMOBJST  DS    F         STARTING POINT FOR OBJECT MODULE       SA49491 06510000
CMTEMPCH DS    F         POINTER TO LOAD CHAIN ENTRY TO BE FREED        06550021
CMEPCESD DS    F         CESD LINE ADDRESS OF THE ENTRY POINT NAME      06600021
CMPREVPT DS    F         PREVIOUS ELEMENT IN A CHAIN FOR INSERT-DELETE  06650021
CMLOADCH DS    F         TEMPORARY CHAIN FOR ESD'S IN A LOAD MODULE     06700021
CMESDSAV DS    F         CESD REG SAVE AREA FOR REL             SA56381 06710000
*                                                                       06750021
*    CESD TYPE CHAIN POINTERS -- THEY MUST REMAIN IN ORDER OF           06800021
*   TYPE NUMBER FOR INDEXING PURPOSES                                   06850021
*                                                                       06900021
CMTYPCHN EQU   *         INDEX POINT FOR THE VECTOR TABLE               06950021
CMSDCHN  DS    F         TYPE 0 - SECTION DEFINITION                    07000021
CMLDCHN  DS    F         TYPE 1 - LABLE DEFINITION                      07050021
CMERCHN  DS    F         TYPE 2 - EXTERNAL REFERENCE                    07100021
CMLRCHN  DS    F         TYPE 3 - LABLE REFERENCE                       07150021
CMPCCHN  DS    F         TYPE 4 - PRIVATE CODE                          07200021
CMCMCHN  DS    F         TYPE 5 - COMMON                                07250021
CMPRCHN  DS    F         TYPE 6 - PSEUDO REGISTER                       07300021
CMNULCHN DS    F         TYPE 7 - NULL ENTRY                            07350021
*                                                                       07400021
CMCURRID DS    H         ESDID COUNTER                                  07450021
CMLNECNT DS    H         CURRENT LINE-COUNT  (SYSPRINT)                 07500021
CMBLDLNO DS    H         NUMBER OF BLDL ENTRIES                         07550021
CMWTBFCT DS    H         HORIZONTAL BYTE COUNT IN PRINT RECORD          07600021
CMNUMXS  DS    H         NUMBER OF EXTENTS                              07650021
*                                                                       07700021
CQMAXEXT EQU   &MAXEXT   MAXIMUM TRANSLATION TABLE EXTENTS              07750021
CQEXTSIZ EQU   &EXTSIZ   TRANSLATION TABLE EXTENT SIZE (NUMBER OF ENT)  07800021
*                                                                       07850021
CMLIBFLG DS    X         AUTO-CALL AND LOAD MODULE PROCESSOR FLAGS      07900021
CQKEEPS  EQU   X'01'     KEEP SOME TEXT FROM THIS RECORD                07950021
CQDELETE EQU   X'02'     DELETE SOME TEXT FROM THIS RECORD              08000021
CQAUTOC  EQU   X'04'     AUTO-CALL IS IN PROCESS                        08050021
CQCESDR  EQU   X'08'     CESD HAS BEEN RECEIVED FOR LOAD MODULE         08100021
CQNOTXT  EQU   X'10'     TEXT HAS BEEN RECEIVED                         08150021
CQLPASRH EQU   X'20'     LPA RESOLUTION POSSIBLE                        08200021
CQFIRST  EQU   X'40'     FIRST REC FROM LOAD MODULE WAS CESD            08250021
CQMFTLPA EQU   X'80'     MFT LINK PACK AREA                             08300021
*                                                                       08350021
CMRELFLG DS    X         RELOCATION AND OBJECT MODULE PROCESSOR FLAGS   08400021
CQESD    EQU   X'01'     ESD ROUTINE IS CALLER TO ID TRANSLATE ROUTINE  08450021
CQNOLNG  EQU   X'02'     LENGTH NOT YET RECEIVED FOR CURRENT CSECT      08500021
CQDELINK EQU   X'04'     DELINKING IS REQUIRED FOR COMMON               08550021
CQLIB    EQU   X'08'     RESOLUTION FROM SYSLIB IN PROCESS              08600021
CQNOEND  EQU   X'10'     END CARD HAS BEEN RECEIVED                     08650021
CQINPUT  EQU   X'20'     INPUT HAS BEEN RECEIVED                        08700021
CQENTRY  EQU   X'40'     RLD IS FOR ENTRY POINT                         08750021
CQNOLNTX EQU   X'80'     TEXT RECEIVED FOR NO-LENGTH CSECT      27445   08800021
*                                                                       08850021
CMSTATUS DS    X         LOADER STATUS FLAG                             08900021
CQPRTOPN EQU   X'01'     PRINT DCB ALLOCATED FOR                        08950021
CQLIBOPN EQU   X'02'     LIBRARY DCB OPEN                               09000021
CQABORT  EQU   X'04'     ABORT LOADING                                  09050021
CQREJOPT EQU   X'08'     INVALID OPTIONS ARE TO BE PRINTED              09100021
CQOPNERR EQU   X'10'     ERRORS WERE ENCOUNTERED DURING OPEN            09150021
CQRETURN EQU   X'20'     CALLER TO ERROR ROUTINE MUST REGAIN CONTROL    09200021
CQMSGSAV EQU   X'40'     REQUEST OPEN-EXIT TO SAVE ERROR MESSAGES       09250021
CQPRTDCB EQU   X'80'     PRINT DCB IS OPEN                              09300021
*                                                                       09350021
CMPRTCTL DS    X         INDEX FOR PRINTER CARRIAGE CONTROL             09400021
*                                                                       09450021
CMOPTECT DS    X         COUNT OF INVALID OPTIONS TO BE PRINTED         09500021
         DS    0D                                                       09550021
CQINTSIZ EQU   *-CMINTZRO SIZE OF ZERO INITIALIZATION AREA              09600021
*                                                                       09650021
CQCMSIZE EQU *-HEWLDCOM SIZE OF COMMUNICATION AREA                      09700021
         EJECT                                                          09750021
*    ERROR CODE DEFINITIONS --- THESE CODES CORRESPOND TO BIT POSITIONS 09800021
*   IN THE ERROR BIT-MAP NUMBERED FROM RIGHT TO LEFT BEGINNING WITH 0.  09850021
*   THE CODES (AND CORRESPONDING BIT-MAP POSITIONS) ARE IN ORDER OF     09900021
*   INCREASING SEVERITY.                                                09950021
*                                                                       10000021
ERCODES  DSECT                                                          10050021
*                                                                       10100021
ERRELO1  DS    X    WARNING - UNRESOLVED ER (NCAL SPECIFIED)          1 10150021
ERENTR1  DS    X    NO ENTRY POINT RECEIVED                           1 10200021
ERINPT8  DS    X    CARD RECEIVED NOT AN OBJECT CARD                  1 10250021
*                                                                       10300021
ERINPT10 DS    X    END CARD MISSING                                  2 10350021
ERINPT2  DS    X    LENGTH NOT SPECIFIED                              2 10400021
ERRELO2  DS    X    ERROR - UNRESOLVED ER                             2 10450021
ERINPT4  DS    X    DOUBLY DEFINED ESD                                2 10500021
ERINPT5  DS    X    INVALID 2 BYTE ADCON                              2 10550021
ERINPT7  DS    X    INVALID ID RECEIVED                               2 10600021
ERINPT9  DS    X    INVALID OBJECT CARD RECEIVED                      2 10650021
ERINPT1  DS    X    INPUT BLKSIZE IS INVALID                          2 10700021
*                                                                       10750021
ERINPT3  DS    X    NO TEXT                                           3 10800021
ERENTR2  DS    X    ENTRY POINT RECEIVED BUT NOT MATCHED              3 10850021
ERIOUT4  DS    X    ERROR ON BLDL                                     3 10900021
ERINPT6  DS    X    INVALID RECORD FROM LOAD MODULE                   3 10950021
*                                                                       11000021
ERIOUT3  DS    X    UNACCEPTABLE RECFM (VARIABLE ON INPUT)            4 11050021
ERIOUT1  DS    X    DDNAME CANNOT BE OPENED                           4 11100021
ERIOUT2  DS    X    SYNCHRONOUS ERROR                                 4 11150021
ERSIZE2  DS    X    PROGRAM TOO LARGE                                 4 11200021
ERSIZE3  DS    X    INPUT ESDID TOO LARGE                             4 11250021
ERIDEN1  DS    X    IDENTIFY FAILED. DUPLICATE PROGRAM NAME           4 11300021
ERIDEN2  DS    X    IDENTIFY FAILED.  ALL OTHER RETURN CODES          4 11350021
         EJECT                                                          11400021
*   PRINTER CARRIAGE CONTROL DEFINITIONS FOR ASA CODE                   11450021
*                                                                       11500021
*   ANY CHANGE IN THE DISPLACEMENTS DEFINED HERE REQUIRES A             11550021
*  CORRESPONDING CHANGE IN THE 'PRTCNTRL' TABLE IN IEWLIOCA             11600021
*                                                                       11650021
*                                                                       11700021
*                                                                       11750021
CTSPACE1 EQU   0         SPACE 1 BEFORE PRINTING                        11800021
CTSPACE2 EQU   2         SPACE 2 BEFORE PRINTING                        11850021
CTSPACE3 EQU   4         SPACE 3 BEFORE PRINTING                        11900021
CTEJECT  EQU   6         EJECT BEFORE PRINTING                          11950021
         MEND                                                           12000021
./  ADD  SSI=61030372,NAME=IEWFTNIP
         TITLE 'PROGRAM FETCH    IEWFTMIN'                              00170003
*                                                                       00200003
*2356 041400-041600                                                2125 00250003
*     093000,095800                                                3625 00300003
*0931095260                                                      A31918 00350003
*0931065000                                                      M6119  00400003
*058600-059299                                                   XM6366 00450003
*044420-044784,087020-087100                                     XM5009 00500003
*STATUS CHANGE LEVEL 003                                                00550003
*                                                                       00600003
*FUNCTION/OPERATION  PROGRAM FETCH IS PART OF THE RESIDENT NUCLEUS. ITS 00650003
*     FUNCTION IS THE LOADING AND RELOCATING OF EXECUTABLE MODULES INTO 00700003
*     CORE STORAGE.                                                     00750003
*                                                                       00800003
*ENTRY POINTS  THE ENTRY POINT FOR FINCH (SUPERVISOR) IS IEWMSEPT.  THE 00850003
*     ENTRY POINT FOR OVERLAY SUPERVISOR IS IEWFBOSV. BOTH THESE        00900003
*     ROUTINES ENTER PROGRAM FETCH VIA A BRANCH AND LINK                00950003
*                                                                       01000003
*INPUT  SEE NOTES                                                       01050003
*                                                                       01100003
*OUTPUT  SEE NOTES                                                      01150003
*                                                                       01200003
*EXTERNAL ROUTINES  SEE NOTES                                           01250003
*                                                                       01300003
*EXITS  SEE NOTES                                                       01350003
*                                                                       01400003
*TABLES/WORK AREAS  PROGRAM FETCH USES A WORK AREA THAT IS ALLOCATED AS 01450003
*     FOLLOWS  56 BYTES   CHANNEL PROGRAM                               01500003
*               4 BYTES   ECB                                           01550003
*              32 BYTES   IOB                                           01600003
*               8 BYTES   I/O SEEK ADDRESS                              01650003
*              12 BYTES   FETCH SEEK BUFFER                             01700003
*              40 BYTES   REGISTER SAVE AREA                            01750003
*             256 BYTES   RLD BUFFER                                    01800003
*                                                                       01850003
*ATTRIBUTES  READ ONLY - REENTRANT - PRIVELEGED - ENABLED - RESIDENT    01900003
*                                                                       01950003
*NOTES                                                                  02000003
*                                                                       02050003
*              ON ENTERING FETCH FINCH WILL PROVIDE THE FOLLOWING       02100003
*              PARAMETERS                                               02150003
*                                                                       02200003
*                         ADDRESS OF FETCH WORK CORE IN REG 3           02250003
*                         ADDRESS OF FETCH PARAMETER LIST IN REG 1      02300003
*                         RETURN ADDRESS IN REG 14                      02350003
*                                                                       02400003
         EJECT                                                          02450003
*              WHEN RETURNING TO FINCH FETCH WILL PROVIDE THE           02500003
*              FOLLOWING PARAMETERS                                     02550003
*                                                                       02600003
*                         REG 6 WILL BE SAVED ACROSS FETCH              02650003
*                         RELOCATED ENTRY POINT                         02700003
*                             (LAST ENTRY IN FETCH PARAMETER LIST)      02750003
*                         RETURN CONDITION CODE IN REG 15               02800003
*                         IF PROGRAM IS IN OVEFLAY SEGTAB WILL BE       02850003
*                         INITIALIZED WITH DCB AND NOTE LIST            02900003
*                         ADDRESS AND THE TESTRAN BIT WILL BE SET       02950003
*                         IF REQUIRED                                   03000003
*                                                                       03050003
*                                                                       03100003
*                                                                       03150003
*                             FETCH PARAMETER LIST                      03200003
*                                                                       03250003
*                   ****************************************            03300003
*                   *                                      *            03350003
*                0  *           DCB  ADDRESS               *            03400003
*                   *                                      *            03450003
*                   ****************************************            03500003
*                   *                                      *            03550003
*                4  *        CORE ADDRESS OF NOTE LIST     *            03600003
*                   *                                      *            03650003
*                   ****************************************            03700003
*                   *                                      *            03750003
*                8  *         ADDRESS OF BLDL ENTRY        *            03800003
*                   *                                      *            03850003
*                   ****************************************            03900003
*                   *                                      *            03950003
*               12  *       NUMBER OF RELOCATION FACTORS   *            04000003
*                   *                                      *            04050003
*                   ****************************************            04100003
*                   *                                      *            04150003
*               16  *       ADDRESS OF PROB PROG CORE      *            04200003
*                   *                                      *            04250003
*                   ****************************************            04300003
*                   *                                      *            04350003
*               20  *         RELOCATED ENTRY POINT        *            04400003
*                   *                                      *            04450003
*                   ****************************************            04500003
*                                                                       04550003
*                                                                       04600003
         EJECT                                                          04650003
*                                                                       04700003
*                                                                       04750003
*                                                                       04800003
*              DURING THE EXECTION OF FETCH THE FOLLOWING ROUTINES      04850003
*              ARE REFERENCED                                           04900003
*                                                                       04950003
*                         TTR CONVERT ROUTINE                           05000003
*                            CONVERT RELATIVE TRACK ADDRESS             05050003
*                            TO ABSOLUTE TRACK ADDRESS                  05100003
*                                                                       05150003
*                         SUPERVISOR VALIDITY CHECK ROUTINE             05200003
*                            VALIDITY CHECK ADDRESS INTO                05250003
*                            WHICH FETCH LOADS A MODULE                 05300003
*                                                                       05350003
*                         GETMAIN                                       05400003
*                                                                       05450003
*                         FREEMAIN                                      05500003
*                                                                       05550003
*                         EXCP  EXECUTE CHANNEL PROGRAM                 05600003
*                                                                       05650003
*                         WAIT                                          05700003
*                                                                       05750003
*                                                                       05800003
*                                                                       05850003
*              THE FOLLOWING TERMINATION CODES ARE RETURNED BY          05900003
*              FETCH TO CONTENTS SUPERVISOR AND OVERLAY                 05950003
*              SUPERVISOR IN REG 15  (LOW ORDER BYTE)                   06000003
*                                                                       06050003
*                         X'00'  SUCCESSFUL LOAD                        06100003
*                         X'0F'  PERMANENT IO ERROR                     06150003
*                         X'0E'  INVALID ADDRESS                        06200003
*                         X'0D'  INVALID RECORD TYPE                    06250003
         EJECT                                                          06300003
*              AN ERROR CODE RETURNED BY FETCH TO EITHER THE SUPERVISOR 06350003
*              OR OVERLAY SUPERVISOR RESULTS IN AN ABEND. IN THE CASE   06400003
*              OF A PERMANENT IO ERROR THE EXACT NATURE OF THE ERROR    06450003
*              CAN BE DETERMINED AS FOLLOWS                             06500003
*                                                                       06550003
*                         REG 3 OF THE ABEND DUMP WILL CONTAIN THE      06600003
*                         ADDRESS OF THE WORK CORE USED BY FETCH        06650003
*                                                                       06700003
*                         60 BYTES FROM THE START OF THIS WORK CORE IS  06750003
*                         THE IOB USED BY FETCH                         06800003
*                                                                       06850003
*                         IN THE IOB PLUS 8 BYTES IS THE CHANNEL STATUS 06900003
*                         WORD STORED BY IOS. AN ANALYSIS OF THE TWO    06950003
*                         BYTES OF STATUS INFORMATION WILL REVEAL       07000003
*                         THE EXACT NATURE OF THE IO ERROR              07050003
*                                                                       07100003
         EJECT                                                          07150003
*                                                                       07200003
*                                                                       07250003
WKREGF   EQU   0                             WORK REG                   07300003
ENDREG EQU   0                                                          07350003
WKREGA   EQU   1                             WORK REG                   07400003
PTRREG   EQU   1                                                        07450003
WKREGB   EQU   2                             WORK REG                   07500003
*MINBASE2 EQU   3                             BASE FOR DSECT            07550003
GREG3    EQU   3                       GENERAL REGISTER 3        PREMVM 07600003
MINBASE2 EQU   5                             BASE FOR DSECT      PREMVM 07650003
MINBASE1 EQU   4                             FETCH BASE REG             07700003
*PARREG   EQU   5                             PARAM. LIST ADDR          07750003
RELFACRG EQU   7                                                        07800003
DCBREG   EQU   7                             DCB ADDR                   07850003
NOTEREG  EQU   8                             NOTE LIST                  07900003
PDSREG   EQU   9                             PARTITIONED DATA SET ADDR  07950003
CDEREG   EQU   9                       PTR TO CDE (ADDR IS IN    PREMVM 08000003
*                                      COMPLIMENT FORM ON ENTRY  PREMVM 08050003
*                                      FROM PROGRAM MANAGER)     PREMVM 08100003
WKREGD   EQU   10                            WORK REG                   08150003
WKREGC   EQU   11                            WORK REG                   08200003
WKREGE   EQU   12                            WORK REG                   08250003
SEGREG   EQU   13                            SEGMENT NUMBER REG         08300003
LINKREG  EQU   14                            LINK/RETURN                08350003
CODEREG  EQU   15                            ERROR/TERMINATION CODE     08400003
RECONE   EQU   1                       REC NU FOR MBBCCHHR FLD   A31918 08450003
RECZERO  EQU   0                       REC NU FOR MBBCCHHR FLD  OS57172 08500003
EXCP     EQU   0                                                        08550003
* CVTPTR   EQU   16                      LOC OF CVT POINTER     ZA00857 08600003
* CVTTCBP  EQU   0                     OFSET FRM TCB TO TCB PTR ZA00857 08650003
CURRENT  EQU   4                       OFFSET FROM TCB PTR TO CURRENT   08700003
*                                       TCB POINTER                     08750003
VEQR     EQU   X'80'                   VIRTUAL=REAL SWITCH              08800003
PRIVDCB  EQU   X'40'                    PRIV DCB IN USE SW.             08850003
KEYZERO  EQU   X'0F'                   MASK FOR DEB KEY ZERO     PREMVM 08900003
ADDR     EQU   B'0111'                  ADDR PART OF REG MASK           08950003
*                                                                       09000003
*                                                                       09050003
******   FETCH COMPLETION CODE DEFINITIONS                       PREMVM 09100003
*                                                                       09150003
SUCCESS  EQU   X'00'                   SUCCESSFUL FETCH          PREMVM 09200003
GMFAIL   EQU   X'0C'                   GETMAIN FAILED            PREMVM 09250003
INVREC   EQU   X'0D'                   INVALID CTL/RLD RECORD    PREMVM 09300003
INVADDR  EQU   X'0E'                   INVALID ADDRESS           PREMVM 09350003
*                  ABOVE RETURN CODE NOT SUPPORTED IN THIS VERSION      09400003
PERMIO   EQU   X'0F'                   PERMANENT I/O ERROR       PREMVM 09450003
*                                                                       09500003
         EJECT                                                          09550003
*                                                                       09600003
*        INITIALIZATION ROUTINE                                         09650003
*                                                                       09700003
* IEWFTMIN CSECT                                                ZA00857 09750003
         ENTRY IEWFTMIN                                                 09760003
         ENTRY IEWMSEPT                                                 09800003
         ENTRY MINAPNDG                      APPENDAGE TABLE ENTRY PT   09850003
         SPACE                                                          09900003
         SPACE                                                          09950003
*IEWMSEPT LR    WKREGB,MINBASE1     CURRENT TCB ADDRESS                 10000003
IEWMSEPT EQU   *                                                 PREMVM 10050003
IEWFTMIN EQU   *                                                ZA00857 10060003
         BALR  MINBASE1,0          FINCH (SUPERVISOR) ENTRY POINT       10100003
         USING MIN004,MINBASE1               FETCH BASE                 10150003
*        USING WKCORE,MINBASE2               DSECT BASE                 10200003
         USING WKAREA,MINBASE2               DSECT BASE          PREMVM 10250003
*MIN004  LR    PARREG,WKREGA                 PARAM ADDR TO PERM REG     10300003
*        LM    DCBREG,PDSREG,0(PARREG)       SET DCB,NOTE LIST + BLDL   10350003
MIN004   EQU   *                                                 PREMVM 10400003
         LR    MINBASE2,SEGREG         SET WORKAREA BASE         PREMVM 10450003
******   GETMAIN FOR EXTENT LIST/NOTE LIST AND PROB PROG SPACE          10500003
         LA    WKREGC,EXLSIZE          LENGTH OF EXTENT LIST     PREMVM 10550003
         LCR   WKREGB,CDEREG           ADDRESS OF CDE            PREMVM 10600003
         USING CDENTRY,WKREGB                                    PREMVM 10650003
         TM    CDATTR,X'04'            MINOR CDE?               ZA00857 10700003
         BZ    MIN004B                 BRANCH IF NOT             PREMVM 10750003
         L     WKREGB,CDXLMJP          ADDRESS OF MAJOR CDE      PREMVM 10800003
MIN004B  EQU   *                                                 PREMVM 10850003
         LA    WKREGB,CDXLMJP          PTR TO EXTENT LIST PTR    PREMVM 10900003
         DROP  WKREGB                                            PREMVM 10950003
         LA    1,XGMLIST               POINT TO GETMAIN PARMLIST PREMVM 11000003
         GETMAIN  EC,LV=(WKREGC),A=(WKREGB),SP=255,MF=(E,(1))    PREMVM 11050003
         LTR   CODEREG,CODEREG         TEST RETURN CODE          PREMVM 11100003
         BZ    MIN004C                 BRANCH IF SUCCESSFUL      PREMVM 11150003
         LA    CODEREG,GMFAIL          SET ERROR CODE            PREMVM 11200003
         BR    LINKREG                 RETURN                    PREMVM 11250003
MIN004C  EQU   *                                                 PREMVM 11300003
         L     WKREGB,0(WKREGB)        GET ADDR OF XLIST/NLIST   PREMVM 11350003
         USING EXLNL,WKREGB                                      PREMVM 11400003
         ST    WKREGC,EXLLNTH          STORE TOTAL LIST LENGTH   PREMVM 11450003
         LA    WKREGC,1                NO. OF REL. FACTORS       PREMVM 11500003
         ST    WKREGC,EXLRELFC         STORE NO. OF BLOCKS       PREMVM 11550003
         SPACE                                                          11600003
*    OBTAIN MAIN STORAGE FOR LOAD MODULE                                11650003
         SPACE                                                          11700003
         L     WKREGC,WKLNTH           MODULE LENGTH             PREMVM 11750003
         SRL   WKREGC,8                SHIFT OUT EXTRANEOUS BYTE PREMVM 11800003
         ST    WKREGC,EXLCORSZ         STORE MODULE SIZE         PREMVM 11850003
         MVI   EXLSZIND,SZIND          INDICATE A SIZE FIELD     PREMVM 11900003
         NC    WKIOADDR,WKIOADDR       TEST FOR PROBLEM PROGRAM  PREMVM 11950003
*                                      SPACE ALREADY ALLOCATED   PREMVM 12000003
         BNZ   MIN004D                 IF SO, BRANCH             PREMVM 12050003
         LA    WKREGE,EXLCORAD         POINT TO ADDR FIELD       PREMVM 12100003
         LA    1,XGMLIST               POINT TO GETMAIN PARMLIST PREMVM 12150003
         SPACE                                                          12200003
*    TEST IF GETMAIN IS REQUIRED ON A PAGE BOUNDARY                     12250003
         SPACE                                                          12300003
         TM    WKATTR+1,PDS2ORG0       TEXT ORG'ED AT ZERO?      YM4612 12350003
         BZ    MIN004C5                NO, SKIP ALIGN TEST       YM4612 12400003
         TM    WKTXORG,PDS2PAGA        PAGE ALIGN REQD?          YM4612 12450003
         BZ    MIN004C5                GO IF NO                  YM4612 12500003
*                                      ELSE ISSUE GM ON PAGE BDY YM4612 12550003
         SPACE                                                          12600003
         GETMAIN  EC,LV=(WKREGC),A=(WKREGE),SP=(WKREGD),MF=(E,(1)),    X12650003
               BNDRY=PAGE                                        YM4612 12700003
         SPACE                                                          12750003
         B     MIN004C7                AND CONTINUE              YM4612 12800003
         SPACE                                                          12850003
MIN004C5 EQU   *                                                        12900003
         SPACE                                                          12950003
         GETMAIN  EC,LV=(WKREGC),A=(WKREGE),SP=(WKREGD),MF=(E,(1))      13000003
         SPACE                                                          13050003
MIN004C7 EQU   *                                                        13100003
         L     WKREGE,0(WKREGE)        GET P/P RELOC FACTOR      PREMVM 13150003
         LTR   CODEREG,CODEREG         TEST RETURN CODE          PREMVM 13200003
         BZ    MIN004E                 BRANCH IF SUCCESSFUL      PREMVM 13250003
         LA    CODEREG,GMFAIL          SET ERROR CODE            PREMVM 13300003
         BR    LINKREG                 RETURN                    PREMVM 13350003
MIN004D  EQU   *                                                 PREMVM 13400003
         L     WKREGE,WKIOADDR         GET ADDR OF P/P SPACE     PREMVM 13450003
         ST    WKREGE,EXLCORAD         STORE IT IN EXTENT LIST   PREMVM 13500003
MIN004E  EQU   *                                                 PREMVM 13550003
         ST    WKREGE,PPADDR           SAVE P/P RELOC FACTOR     PREMVM 13600003
         MVI   EXLADIND,ADIND          INDICATE AN ADDR FIELD    PREMVM 13650003
         LA    NOTEREG,NOTELIST        SET NOTELIST POINTER      PREMVM 13700003
         ST    NOTEREG,NOTESAVE        SAVE NOTELIST ADDRESS     PREMVM 13750003
         DROP  WKREGB                                            PREMVM 13800003
         LCR   WKREGB,CDEREG           GET CDE ADDR              PREMVM 13850003
         USING CDENTRY,WKREGB                                    PREMVM 13900003
         OI    CDATTR2,X'20'          INDICATE EXTENT LIST BILT ZA00857 13950003
         DROP  WKREGB                                            PREMVM 14000003
         LA    PDSREG,WKNAME           SET PTR TO BLDL ENTRY     PREMVM 14050003
         LA    SEGREG,1                      SET SEG NO. TO 1           14100003
*        TM    31(WKREGB),X'02'    TEST XCTL TO PROBLEM PROGRAM         14150003
*        BZ    MIN005                                                   14200003
*        NI    31(WKREGB),X'FD'    CLEAR FLAG                           14250003
         BC    15,MIN005                                                14300003
         EJECT                                                          14350003
MIN005   BALR  MINBASE1,0                    RESET BASE                 14400003
         USING *,MINBASE1                                               14450003
         OI    IOB,X'03'                     INIT IOB FLAGS             14500003
         ST    MINBASE2,IOB+16               INIT IOB CHAN PRG POINTER  14550003
         ST    DCBREG,IOB+20                 DCB ADDR INIOB             14600003
         ST    DCBREG,DCBSAVE          SAVE DCB ADDRESS          PREMVM 14650003
         NI    SWITCH,X'00'            INITIALIZE SWITCH TO ZERO PREMVM 14700003
MIN0053  L     WKREGA,44(DCBREG)        POINT TO DEB                    14750003
MIN0053A EQU   *                                                 PREMVM 14800003
         USING DEBBASIC,WKREGA         ESTABLISH DSECT BASE      PREMVM 14850003
         TM    DEBFLGS1,X'02'          AUTHORIZED LIBRARY?      ZA00857 14900003
         BZ    MIN0053B                IF NOT, BRANCH            PREMVM 14950003
         OI    WKFLG1,WKAUTH           SET AUTH. LIBRARY SWITCH  PREMVM 15000003
         DROP  WKREGA                  DROP DSECT BASE           PREMVM 15050003
MIN0053B EQU   *                                                 PREMVM 15100003
*        LA    WKREGB,MINAPNDG               GET APENDG. ADDR   ZA00857 15150003
         L     WKREGB,MINAPTAB         LOAD APPG ADDRESS        ZA00857 15160003
         O     WKREGB,MINDBMSK         SET DEBEXSCL TO 04 IN REG 22125  15200003
         ST    WKREGB,28(WKREGA)       STOR APNDG ADDR IN DEB    22125  15250003
         LA    WKREGA,ECB                    ADDR OF ECB                15300003
         ST    WKREGA,IOB+4                  ECB ADDR IN IOB            15350003
         XC    IOB+28(2),IOB+28              CLEAR IOB BLOCK COUNT      15400003
         LA    WKREGA,IOBSKBUF+3             TO SET  SEARCH ADDR        15450003
         ST    WKREGA,CHPG1                                             15500003
         MVI   CHPG1,X'31'                   RESET OP CODE              15550003
         ST    MINBASE2,CHPG1+8              SET TIC TO ADDR            15600003
         MVC   CHPG1+4(5),CPROG1             SET SRCH FLGS+CNT & TIC OP 15650003
         MVC   CHPG1+40(16),CPROG2           SET READ COUNT AND DATA    15700003
         MVC   CHPG1+20(4),CHPG1+4            SET CC&COUNT IN T/N       15750003
         LA    WKREGA,SEEKBUF+3                                         15800003
         ST    WKREGA,CHPG1+40                                          15850003
         MVI   CHPG1+40,X'9E'                                           15900003
         MVC   CHPG1+24(8),CHPG1+40                                     15950003
MIN0055  LR    WKREGA,SEGREG                 SEG NO. TO WORK REG        16000003
*        L     RELFACRG,16(PARREG)           GET REL FAC NON-OVER       16050003
         L     RELFACRG,PPADDR         GET REL FAC FOR 1ST LOAD  PREMVM 16100003
         LA    RELFACRG,0(RELFACRG)                                     16150003
MIN009   LM    WKREGF,WKREGA,12(PDSREG)      GET TTR FOR TEXT           16200003
         SLDL  WKREGF,16                     SET TTR IN REG             16250003
         IC    WKREGF,11(PDSREG)             CONCAT. FACTOR             16300003
         BAL   WKREGE,MIN0201                TO CONVERT RTN SET UP      16350003
         EJECT                                                          16400003
*                                                                       16450003
*        FETCH LOADING ROUTINE                                          16500003
*                                                                       16550003
         LA    WKREGC,CHPG1+32               ADDR OF TIC TO LOC         16600003
         BAL   WKREGE,MIN020+4                                          16650003
         TM    23(PDSREG),X'40'              ED ASSIG ORIGIN IS ZERO    16700003
         BC    8,MIN0091                                                16750003
         ST    RELFACRG,CHPG1+32             STOR ADDR FOR FIRST TXT    16800003
         BC    15,MIN0092                                               16850003
MIN0091  L     WKREGA,32(PDSREG)             ORIGIN OF FIRST TXT        16900003
         SRL   WKREGA,8                                                 16950003
         AR    WKREGA,RELFACRG               ADD RELOCATION FAC         17000003
         ST    WKREGA,CHPG1+32               STOR IN CHAN PROG          17050003
MIN0092  MVI   CHPG1+32,X'06'                RESTOR OP CODE             17100003
         MVC   CHPG1+38(2),27(PDSREG)        SET COUNT IN TEXT CCW      17150003
         TM    22(PDSREG),X'01'              TEST 1TXT (3 RLD           17200003
         BC    8,MIN010                                                 17250003
         MVI   CHPG1+36,X'00'                CLEAR CHAIN FLAG           17300003
         MVI   RLDBUF,X'FF'                  SET FETCH LAST INDIC       17350003
         BC    15,MIN0101                                               17400003
MIN010   MVI   CHPG1+36,X'40'                SET CC BIT IN RD TEXT CCW  17450003
         LA    WKREGA,RLDBUF                 ADDR OF RLD BUF            17500003
         ST    WKREGA,CHPG1+48               STOR ADDR IN CHAN PROG     17550003
         MVI   CHPG1+48,X'06'                RESTOR OP CODE             17600003
         MVC   CHPG1+53(3),CPROG3+5          RESET RD DATA COUNT CCW    17650003
MIN0101  LA    WKREGE,MIN014                 SET RET FOR EXCP           17700003
MIN011   MVC   IOBSKBUF+1(7),SEEKBUF+1       SEEK ADDR TO IOB SEEK BUFF 17750003
         MVI   ECB,X'00'                     CLEAR ECB FLAGS            17800003
MIN01015 LA    WKREGA,IOB                    SET FOR EXCP               17850003
         SVC   EXCP                                                     17900003
MIN0121  WAIT  1,ECB=ECB                                                17950003
MIN013   TM    ECB,X'20'                     TEST PERM IO ERROR         18000003
         BCR   1,WKREGE                      BRANCH X'20' NO ERROR      18050003
         LA    CODEREG,X'0F'                                            18100003
         B     MIN0320                       RETURN IO ERROR            18150003
MIN014   TM    RLDBUF,X'FF'                  TEST FETCH LAST INDIC      18200003
         BC    1,MIN032                      TO TERM                    18250003
         BAL   WKREGE,MIN018                 CHK CORR LENGTH            18300003
         MVC   CHPG1+52(4),CPROG3+4          RESET CCW                  18350003
         TM    RLDBUF,X'02'                  TEST FOR RLD TYPE REC      18400003
         BC    1,MIN021                      BRANCH RLD TYPE            18450003
         TM    RLDBUF,X'01'                  TEST CCW TYPE              18500003
         BC    1,MIN016                      BRANCH CCW                 18550003
         LA    CODEREG,X'0D'                                            18600003
         B     MIN0320                       RETURN INVALID RLD         18650003
MIN016   TM    RLDBUF,X'04'                  TEST NEXT REC LAST         18700003
         BC    8,MIN017                      BRANCH NEXT NOT LAST       18750003
         MVI   CHPG1+36,X'00'                PULL CC BIT                18800003
         MVI   RLDBUF,X'FF'                  SET FETCH LAST INDIC       18850003
MIN017   L     WKREGA,RLDBUF+8               GET CCW DATA ADDR          18900003
         LA    WKREGA,0(RELFACRG,WKREGA)     RELOCATE DATA ADDR         18950003
         LR    WKREGB,WKREGA                 SET ADDR TO VAL CHK        19000003
         BAL   WKREGE,MIN0202                TO VAL CHK SET-UP          19050003
         AH    WKREGB,RLDBUF+14              VAL CHK END TXT ADDR       19100003
         BCTR  WKREGB,0            ADJ TO ADDRESS LAST TXT BYTE         19150003
         BAL   WKREGE,MIN0202                TO VAL CHK SET-UP          19200003
         ST    WKREGA,CHPG1+32               STOR CHKED ADDR IN CCW     19250003
         MVI   CHPG1+32,X'06'                RESTOR OP CODE             19300003
         MVC   CHPG1+37(3),RLDBUF+13         COUNT TO RD TEXT CCW       19350003
         LA    WKREGC,CHPG1+24          TIC TO FIRST '9E'        M6119  19400003
         BAL   WKREGE,MIN020+4          IN C. P. CHAIN.          M6119  19450003
         BC    15,MIN0101                                               19500003
MIN018   LH    WKREGA,IOB+14                 GET RESID CT FROM IOB      19550003
         LTR   WKREGA,WKREGA                 TEST FOR ZERO CT           19600003
         BCR   8,WKREGE                                                 19650003
         LA    WKREGB,256                    GET MAX COUNT              19700003
         SR    WKREGB,WKREGA                 SUB RESID COUNT            19750003
         LA    WKREGA,16                                                19800003
         AH    WKREGA,RLDBUF+6               CALC CORR LENGTH           19850003
         AH    WKREGA,RLDBUF+4               ADD NO. OF BYTES OF ESDID  19900003
         CR    WKREGA,WKREGB                 DO BYTES READ=CALC COUNT   19950003
         BCR   8,WKREGE                      READ OK                    20000003
         LA    WKREGA,0(WKREGA)                                         20050003
         ST    WKREGA,CHPG1+52               PULL SILI+SET EX CNT       20100003
         BAL   WKREGE,MIN020                 TO SET CHAN PROG           20150003
         BC    15,MIN0101                                               20200003
MIN019   TM    RLDBUF,X'01'                  TEST REC FOR RLD+CCW       20250003
         BC    1,MIN016                      BRANCH YES                 20300003
         TM    RLDBUF,X'04'                  THIS REC LAST              20350003
         BC    1,MIN032                      LAST-TO NORMAL TERM        20400003
         LA    WKREGC,CHPG1+40                                          20450003
         BAL   WKREGE,MIN020+4                                          20500003
         BC    15,MIN0101                                               20550003
         EJECT                                                          20600003
*                                                                       20650003
*        THIS IS THE SET CHANNEL PROGRAM SUBROUTINE                     20700003
*                                                                       20750003
MIN020   LA    WKREGC,CHPG1+48               GET ADDR RD DATA CCW       20800003
         ST    WKREGC,CHPG1+16               SET TIC ADDR               20850003
         MVI   CHPG1+16,X'08'                RESTOR OP CODE             20900003
         BCR   15,WKREGE                     RETURN                     20950003
*                                                                       21000003
*        THIS IS THE SUBROUTINE THAT SETS PARAMS. FOR TTR CONVERT RTN   21050003
*                                                                       21100003
MIN0201  STM   PDSREG,CODEREG,REGSAVE+12     SAVE REG 9-15              21150003
*   VALIDITY CHECK THE DEB AS WE DIDN'T COPY IT                         21200003
*        L     WKREGA,44(DCBREG)        R1=DEB FOR TTR CONV             21250003
         L     WKREGA,DCBSAVE          GET DCB ADDRESS           PREMVM 21300003
         L     WKREGA,44(WKREGA)       GET DEB ADDRESS IN R1     PREMVM 21350003
         TM    SWITCH,PRIVDCB           IS IT A PRIVATE DCB?            21400003
         BZ    MIN02015                 GO IF NO                        21450003
*        ST    WKREGF,REGSAVE+4         SAVE R0                         21500003
*VALIDAT DEBCHK (LINKREG),TYPE=VERIFY        DEBPTR IS RETD IN R1       21550003
*        L     WKREGF,REGSAVE+4         RESTORE R0                      21600003
         L     WKREGA,DEBSAVE          USE VALIDATED DEB PTR     PREMVM 21650003
MIN02015 LA    WKREGB,SEEKBUF                ADDR OF SEEK BUF           21700003
         L     CODEREG,CVTRTN                ADDR OF CONVERT RTN        21750003
         BALR  LINKREG,CODEREG                                          21800003
         MVC   IOBSKBUF(1),SEEKBUF           M TO IOB                   21850003
         LM    PDSREG,CODEREG,REGSAVE+12     RESTOR REG                 21900003
         BCR   15,WKREGE                     RETURN                     21950003
CVTRTN   DC    V(IECPCNVT)                                              22000003
MINDBMSK DC    X'04000000'             MASK FOR DEBEXSCL         22125  22050003
*                                                                       22100003
*        VALIDITY CHECK SET UP ROUTINE                                  22150003
*                                                                       22200003
*        THIS ROUTINE SAVES AND RESTORES THE REGISTERS USED             22250003
*        BY THE VALIDITY CHECK ROUTINE. IT ALSO SETS UP THE             22300003
*        REQUIRED PARAMETERS AND TESTS THE CONDITION CODE               22350003
*        RETURNED BY THE VALIDITY CHECK ROUTINE                         22400003
*                                                                       22450003
*MIN0202 LR    WKREGD,SEGREG                 TEST FOR OVERLAY           22500003
*        BCT   WKREGD,MIN02021               OVERLAY VAL CHK            22550003
*  TM  16(PARREG),X'FF'           TEST FOR PROG TO PP CORE              22600003
*        BCR   8,WKREGE                      NOT PP CORE SKIP VAL CHK   22650003
*MIN02021 STM   7,10,REGSAVE+12               SAVE REGS FOR VAL CHK     22700003
*        LR    7,WKREGB                      ADDR TO BE VAL CHK'D       22750003
*        L     8,16                          ADDR OF CVT                22800003
*        L     8,24(8)                       ADDR OF VAL CHK RTN        22850003
*        SR    9,9                           NO TCB ADDR                22900003
*        BALR  10,8                          TO VAL CHK RTN             22950003
*        BC    8,MIN0203                     BRANCH ADDRESS VALID       23000003
*        LA    CODEREG,X'0E'                                            23050003
*        B     MIN0320                       RETURN                     23100003
*MIN0203 LM    7,10,REGSAVE+12               RESTOR REGS                23150003
MIN0202  EQU   *                                                 PREMVM 23200003
         BCR   15,WKREGE                     RETURN                     23250003
         EJECT                                                          23300003
*                                                                       23350003
*        FETCH RELOCATION ROUTINE                                       23400003
*                                                                       23450003
MIN021   LA    PTRREG,RLDBUF+16              SET PTR TO FIRST RPFA      23500003
         LR    ENDREG,PTRREG                                            23550003
         AH    ENDREG,RLDBUF+6               CALC SIZE OF BUFF          23600003
MIN022 LA    PTRREG,4(PTRREG)              SKIP R+P POINTERS            23650003
MIN023 TM    0(PTRREG),X'E0'               TEST RELOCATION REQUIRED     23700003
       BC    7,MIN026                      BRANCH NOT REQUIRED          23750003
       L     WKREGB,0(PTRREG)              ADDR OF LOAD CONSTANT        23800003
         LA    WKREGB,0(RELFACRG,WKREGB)     ADD RELOCATION             23850003
         BAL   WKREGE,MIN0202                TO VAL CHK SET-UP          23900003
         SR    WKREGD,WKREGD                 CLEAR REG                  23950003
       ST    WKREGD,REGSAVE                CLEAR REG SAVE AREA          24000003
       NI    0(PTRREG),X'0F'               CLEAR UNWANTED FLAGS         24050003
       IC    WKREGD,0(PTRREG)              COUNT INTO REG               24100003
       SRL   WKREGD,2                                                   24150003
       LA    WKREGC,REGSAVE+3              SET ADDR OF BOUNDARY WORD    24200003
       SR    WKREGC,WKREGD                 SET BOUND. WORD TO ' BYTES   24250003
       EX    WKREGD,MIN027                 MOVE ADCON TO BOUND WRD      24300003
       L     WKREGE,REGSAVE                LOAD FROM BUND WRD           24350003
         TM    0(PTRREG),X'02'               ADD OR SUB RELOC FACTOR    24400003
         BC    8,MIN024                      BRANCH TO ADD              24450003
       SR    WKREGE,RELFACRG               SUB RELOCATION FACTOR        24500003
         BC    15,MIN025                                                24550003
MIN024   AR    WKREGE,RELFACRG               ADD RELOC FACTOR           24600003
MIN025 ST    WKREGE,REGSAVE                RET TO BOUNDARY WORD         24650003
       EX    WKREGD,MIN028                 RET ADCON                    24700003
MIN026 LR    WKREGC,PTRREG                 SAVE POINTER                 24750003
       LA    PTRREG,4(PTRREG)              ADD 4 TO COUNT               24800003
       CR    PTRREG,ENDREG                 DOES PTR =END                24850003
       BC    8,MIN019                      COMPLETE  BRANCH OUT         24900003
       TM    0(WKREGC),X'01'               TEST TERM FLAG               24950003
       BC    1,MIN023                      SAME R++                     25000003
       BC    15,MIN022                     DIFF R+P POINTERS  INDEX+4   25050003
         SPACE                                                          25100003
MIN027 MVC   0(1,WKREGC),0(WKREGB)                                      25150003
MIN028 MVC   0(1,WKREGB),0(WKREGC)                                      25200003
         EJECT                                                          25250003
*                                                                       25300003
*        FETCH TERMINATION                                              25350003
*                                                                       25400003
MIN032   SR    CODEREG,CODEREG               SET SUCCESSFUL LOAD CODE   25450003
MIN0320  EQU   *                                                 PREMVM 25500003
MIN0320A EQU   *                                                 PREMVM 25550003
         LTR   CODEREG,CODEREG          TEST IF ERROR IN FETCH   PREMVM 25600003
         BCR   7,LINKREG                AND BR IF YES            XM5009 25650003
MIN0321  TM    23(PDSREG),X'20'              ED ASIGN ENT PT = ZERO     25700003
         BC    1,MIN033                                                 25750003
         L     WKREGA,28(PDSREG)             GET ENTRY POINT            25800003
         LA    RELFACRG,0(RELFACRG,WKREGA)   GET RELOCATED EP    PREMVM 25850003
*MIN033   ST    RELFACRG,20(PARREG)           REL ENT PT TO FETCH LIST  25900003
MIN033   LR    WKREGE,RELFACRG               PASS RELOCATED EP   PREMVM 25950003
         BCR   15,LINKREG                    RETURN                     26000003
         EJECT                                                          26050003
*                                                                       26100003
*    PAGE FIX LIST                                                      26150003
*                                                                       26200003
         CNOP  0,8                     INSURE DBL WRD BOUNDARY   M6455  26250003
FIXLIST  DC    X'00'                                                    26300003
         DC    AL3(MINAPNDG)           BEGINNING OF FIX AREA            26350003
         DC    X'80'                   LAST OF LIST INDICATOR           26400003
         DC    AL3(MINAPG02+2)         END OF FIX AREA                  26450003
*                                                                       26500003
         SPACE                                                          26550003
         SPACE                                                          26600003
*                                                                       26650003
*        END OF EXTENT APPENDAGE                                        26700003
*                                                                       26750003
*        THIS ROUTINE WILL RECEIVE CONTROL FROM IOS WHEN                26800003
*        IOS DETECTS AN END OF EXTENT CONDITION ON AN EXCP              26850003
*        BY FETCH. THE FUNCTION OF THIS ROUTINE IS TO UPDATE            26900003
*        THE SEEK ADDRESS IN THE IOB AND UCB WITH THE                   26950003
*        NEXT EXTENT ADDRESS FROM THE DEB.                              27000003
*                                                                       27050003
         SPACE                                                          27100003
MINAPTAB DC    A(MINAPNDG)             ADDRESS OF APPENDAGES    ZA00857 27110003
MINAPNDG DC    A(MINAPG00)                   END OF EXTENT              27150003
         DC    A(MINAPG02)                   RETURN                     27200003
         DC    A(MINAPG02)                   RETURN                     27250003
         DC    A(MINAPG02)             C.E.                      23625  27300003
         DC    A(MINAPG02)                   RETURN                     27350003
         SPACE                                                          27400003
MINAPG00 SR    WKREGE,WKREGE                 CLEAR REG FOR M            27450003
*        IC    WKREGE,48(7)                  GET M FROM UCB             27500003
         IC    WKREGE,0(6)                   GET M FROM MBBCCHHR PREMVM 27550003
         LA    WKREGE,1(WKREGE)              INDEX M BY 1               27600003
*        STC   WKREGE,48(7)                  STOR NEW M IN UCB          27650003
         STC   WKREGE,0(6)                   STOR NEW M IN SEEK@ PREMVM 27700003
*        CLC   16(1,3),48(7)                 CHK FOR LAST EXTENT        27750003
         CLC   16(1,3),0(6)                  CHK FOR LAST EXTENT PREMVM 27800003
         BCR   12,LINKREG                    ERROR RETURN               27850003
         SLL   WKREGE,4                      USE M AS INDEX FACTOR      27900003
         LA    WKREGE,32(WKREGE,3)           CALC PTR TO NEW EXTENT     27950003
*        MVC   49(6,7),4(WKREGE)             BBCCHH TO UCB              28000003
         MVC   1(6,6),4(WKREGE)              BBCCHH TO SEEK FLD  PREMVM 28050003
*        MVI   55(7),RECONE             R IN CCHHR IN UCB TO ONE A31918 28100003
         MVI   7(6),RECZERO          SET R IN CCHHR IN   PREMVM,OS57172 28150003
*                                    SEEK ADDR TO ZERO   PREMVM,OS57172 28200003
*        MVC   32(8,2),48(7)           SET IOBSEEK = UCB         23625  28250003
         MVC   32(8,2),0(6)            SET IOBSEEK = SEEK FIELD  PREMVM 28300003
         SPACE                                                          28350003
****************                                                        28400003
*  SET THE 2ND TIC FOLLOWING THE SEARCH-ID CCW TO POINT TO THE          28450003
*  CORRECT READ COUNT CCW IN CASE THE CHANNEL PROGRAM IS RESTARTED      28500003
*  BY THE DASD ERP AFTER A CORRECTABLE I/O ERROR ON THE 1ST RECORD      28550003
*  OF THE NEW EXTENT. THIS PREVENTS RECROSSING THE END-OF-EXTENT        28600003
*  AND TRYING TO UPDATE TO THE NEXT EXTENT PREMATURELY, WHICH           28650003
*  WOULD BE DISASTROUS.                                         OS57172 28700003
****************                                                        28750003
         SPACE                                                          28800003
         LR    WKREGE,WKREGB           POINT TO THE IOB         OS57172 28850003
         LA    WKREGC,IOB-(CHPG1+17)   OFFSET FROM TIC ADDR FLD OS57172 28900003
*                                      TO START OF IOB          OS57172 28950003
         SR    WKREGE,WKREGC           POINT TO TIC ADDR FLD    OS57172 29000003
         L     WKREGC,8(WKREGB)        GET CURRENT CCW POINTER  OS57172 29050003
*                                      FROM CSW IN IOB          OS57172 29100003
         LA    WKREGD,8                WIDTH OF ONE CCW         OS57172 29150003
         SR    WKREGC,WKREGD           BACK UP CSW PTR TO POINT OS57172 29200003
*                                      TO START OF LAST CCW     OS57172 29250003
*                                      EXECUTED                 OS57172 29300003
         STCM  WKREGC,ADDR,0(WKREGE)   SET TIC-TO ADDRESS       OS57172 29350003
         BC    15,8(LINKREG)                 RETURN                     29400003
         SPACE                                                          29450003
         SPACE                                                          29500003
MINAPG02 BCR   15,LINKREG                    NORMAL RETURN              29550003
MINAPEND DS    0H                                               ZA00857 29560003
         EJECT                                                          29600003
*                                                                       29650003
*        FETCH CHANNEL PROGRAM                                          29700003
*                                                                       29750003
CPROG1   DC    XL1'60'                                                  29800003
         DC    XL3'05'                                                  29850003
         DC    XL1'08'                                                  29900003
*                                                                       29950003
*                                                                       30000003
*                                                                       30050003
CPROG2   DC    XL1'9E'                                                  30100003
         DC    AL3(0)                                                   30150003
         DC    XL1'A0'                                                  30200003
         DC    XL3'08'                                                  30250003
*                                                                       30300003
*                                                                       30350003
*                                                                       30400003
CPROG3   DC    XL1'06'                                                  30450003
         DC    XL3'0'                                                   30500003
         DC    XL1'20'                                                  30550003
         DC    XL3'100'                                                 30600003
*                                                                       30650003
*                                                                       30700003
*                                                                       30750003
*        FETCH CONSTANTS                                                30800003
LINKDCB  DC    V(IEFLINK)                                               30850003
SVCDCB   DC    V(IEASVDCB)                                              30900003
         EJECT                                                          30950003
*        IKJTCB   SYS=AOS1                                      ZA00857 31000003
*        IKJTCB   SYS=AOS2                                      ZA00857 31050003
         EJECT                                                          31100003
**************************************************************** PREMVM 31150003
*                                                                       31200003
*     COMBINED EXTENT LIST / NOTE LIST CONSTRUCTED BY FETCH             31250003
*     WHEN INVOKED BY CONTENTS SUPERVISOR. THE NOTE LIST                31300003
*     PORTION EXISTS ONLY FOR MODULES IN OVERLAY STRUCTURE.             31350003
*                                                                       31400003
EXLNL    DSECT                                                          31450003
EXLIST   DS    0F        START OF EXTENT LIST                           31500003
EXLLNTH  DS    F              LENGTH OF EXTENT (PLUS NOTE) LIST         31550003
EXLRELFC DS    F              NUMBER OF CORE BLKS FOR MODULE            31600003
EXLCORSZ DS    0F             SIZE OF CORE BLK ALLOC TO MODULE          31650003
EXLSZIND DS    XL1              - FLAG TO IND A SIZE FIELD              31700003
EXLSZBLK DS    FL3              - SIZE IN BYTES                         31750003
EXLCORAD DS    0F             ADDRESS OF CORE BLOCK ALLOCATED           31800003
EXLADIND DS    XL1              - FLAG TO IND AN ADDRESS FIELD          31850003
EXLADBLK DS    AL3              - ADDRESS OF FIRST BYTE                 31900003
*                                                                       31950003
SZIND    EQU   X'80'          SIZE INDICATOR                            32000003
ADIND    EQU   X'00'          ADDR INDICATOR                            32050003
EXLSIZE  EQU   *-EXLIST       LENGTH OF XTENT LIST PORTION              32100003
*                                                                       32150003
*        NOTE LIST FOR OVERLAY MODULES.                                 32200003
*                                                                       32250003
NOTELIST DS    0F        BEGINNING OF NOTELIST                          32300003
NLRELFAC DS    F         RELOCATION FACTOR FOR THE MODULE               32350003
*                        (ALSO, THE ADDRESSS OF THE SEGTAB)             32400003
NLCORSIZ DS    XL3       MS CORE REQUIREMENT OF THE MODULE              32450003
NLCONCAT DS    XL1       CONCATENATION NUMBER OF MODULE DATA SET        32500003
NLENTRYS DS    0F        NOTELIST ENTRIES(ONE/SEGMENT)...               32550003
NLSEGTTR DS    XL3            TTR FOR READING THE SEGMENT               32600003
NLZERO   DC    X'00'          ZERO                                      32650003
*--------                                                               32700003
NLENTSZ  EQU   2         ENTRY SIZE (FOR SHIFT-MULTIPLY)                32750003
NLPFXSZ EQU   8          LENGTH OF NL PREFIX PORTION                    32800003
         EJECT                                                          32850003
*        IHACDE                                                 ZA00857 32900003
         EJECT                                                          32950003
*        IEZDEB                                                 ZA00857 33000003
**************************************************************** PREMVM 33050003
         EJECT                                                          33100003
         IHAFETWK                                                       33150003
         SPACE                                                          33200003
*                                                                       33250003
*                                                                       33300003
         ORG   WKFETCH                                           PREMVM 33350003
*WKCORE   DSECT                                                         33400003
WKCORE   EQU   *                                                 PREMVM 33450003
CHPG1    DS    7D                            CHANNEL PROG               33500003
ECB      DS    1F                            EVENT CONTROL BLOCK        33550003
IOB      DS    8F                            IO BLOCK                   33600003
IOBSKBUF DS    2F                            IOB SEEK BUFFER            33650003
SEEKBUF  DS    3F                            SEEK BUFFER                33700003
REGSAVE  DS    10F                           REG SAVE AREA              33750003
RLDBUF   DS    64F                           RLD BUFFER                 33800003
DCBSAVE  DS    1F                      SAVE DCB ADDRESS          PREMVM 33850003
NOTESAVE DS    1F                      SAVE NOTELIST ADDRESS     PREMVM 33900003
PPADDR   DS    1F                      SAVE P/P RELOC FACTOR     PREMVM 33950003
PSDCB    EQU   *-44                    PSEUDO DCB TO LOCATE DEB  PREMVM 34000003
*                                      COPY AFTER VALIDATION     PREMVM 34050003
DEBSAVE  DS    1F                      ADDRESS OF DEB COPY       PREMVM 34100003
DEBLEN   DS    1F                      SIZE OF COPIED DEB        PREMVM 34150003
*                                                                       34200003
*                                                                       34250003
SWITCH   EQU   CHPG1+13                SWITCH BYTE                      34300003
*                                       X'80' TASK IS RUNNING V=R       34350003
PGFIXECB EQU   REGSAVE                 ECB USED TO FIX THE AVT          34400003
*                                       AND EOX APPENDAGE               34450003
*                                                                       34500003
*                                                                       34550003
*        REGSAVE                                                        34600003
*           1-4  BOUNDARY WORD FOR RELOCATION RTN                       34650003
*           5-8                                                         34700003
*           9-12                                                        34750003
*          13-40 REG SAVE AREA  9-15                                    34800003
*                                                                       34850003
         SPACE 3                                                        34900003
         ORG   WKNAME                                            PREMVM 34950003
         IHAPDS  DSECT=NO                                        PREMVM 35000003
